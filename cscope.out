cscope 15 $HOME/Documents/robocup/rUNSWift               0002444866
	@robot/Eigen/src/Array/BooleanRedux.h

25 #iâdeà
EIGEN_ALLANDANY_H


26 
	#EIGEN_ALLANDANY_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gUÄŞlCouÁ
>

29 
	sei_®l_uÄŞËr


32 
	mcŞ
 = (
UÄŞlCouÁ
-1è/ 
D”ived
::
RowsAtCompeTime
,

33 
	mrow
 = (
UÄŞlCouÁ
-1è% 
D”ived
::
RowsAtCompeTime


36 
šlše
 
boŞ
 
run
(cÚ¡ 
D”ived
 &
m©
)

38  
	mei_®l_uÄŞËr
<
	mD”ived
, 
	mUÄŞlCouÁ
-1>::
run
(
m©
è&& m©.
cÛff
(
row
, 
cŞ
);

42 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

43 
	gei_®l_uÄŞËr
<
	gD”ived
, 1>

45 
šlše
 
boŞ
 
run
(cÚ¡ 
D”ived
 &
m©
è{  
	gm©
.
cÛff
(0, 0); }

48 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

49 
	gei_®l_uÄŞËr
<
	gD”ived
, 
	gDyÇmic
>

51 
šlše
 
boŞ
 
run
(cÚ¡ 
D”ived
 &è{  
	gçl£
; }

54 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gUÄŞlCouÁ
>

55 
	sei_ªy_uÄŞËr


58 
	mcŞ
 = (
UÄŞlCouÁ
-1è/ 
D”ived
::
RowsAtCompeTime
,

59 
	mrow
 = (
UÄŞlCouÁ
-1è% 
D”ived
::
RowsAtCompeTime


62 
šlše
 
boŞ
 
run
(cÚ¡ 
D”ived
 &
m©
)

64  
	mei_ªy_uÄŞËr
<
	mD”ived
, 
	mUÄŞlCouÁ
-1>::
run
(
m©
è|| m©.
cÛff
(
row
, 
cŞ
);

68 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

69 
	gei_ªy_uÄŞËr
<
	gD”ived
, 1>

71 
šlše
 
boŞ
 
run
(cÚ¡ 
D”ived
 &
m©
è{  
	gm©
.
cÛff
(0, 0); }

74 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

75 
	gei_ªy_uÄŞËr
<
	gD”ived
, 
	gDyÇmic
>

77 
šlše
 
boŞ
 
run
(cÚ¡ 
D”ived
 &è{  
	gçl£
; }

91 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

92 
šlše
 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
	$®l
() const

94 cÚ¡ 
boŞ
 
uÄŞl
 = 
SizeAtCompeTime
 * (
CÛffR—dCo¡
 + 
NumT¿™s
<
SÿÏr
>::
AddCo¡
)

95 <ğ
EIGEN_UNROLLING_LIMIT
;

96 if(
uÄŞl
)

97  
ei_®l_uÄŞËr
<
D”ived
,

98 
uÄŞl
 ? (
SizeAtCompeTime
è: 
DyÇmic


99 >::
	`run
(
	`d”ived
());

102 
j
 = 0; j < 
	`cŞs
(); ++j)

103 
i
 = 0; i < 
	`rows
(); ++i)

104 ià(!
	`cÛff
(
i
, 
j
)è 
çl£
;

105  
Œue
;

107 
	}
}

115 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

116 
šlše
 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
	$ªy
() const

118 cÚ¡ 
boŞ
 
uÄŞl
 = 
SizeAtCompeTime
 * (
CÛffR—dCo¡
 + 
NumT¿™s
<
SÿÏr
>::
AddCo¡
)

119 <ğ
EIGEN_UNROLLING_LIMIT
;

120 if(
uÄŞl
)

121  
ei_ªy_uÄŞËr
<
D”ived
,

122 
uÄŞl
 ? (
SizeAtCompeTime
è: 
DyÇmic


123 >::
	`run
(
	`d”ived
());

126 
j
 = 0; j < 
	`cŞs
(); ++j)

127 
i
 = 0; i < 
	`rows
(); ++i)

128 ià(
	`cÛff
(
i
, 
j
)è 
Œue
;

129  
çl£
;

131 
	}
}

139 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

140 
šlše
 
	gM©rixBa£
<
	gD”ived
>::
	$couÁ
() const

142  
this
->
ÿ¡
<
boŞ
>().
‹m¶©e
 ca¡<>().
	`sum
();

143 
	}
}

	@robot/Eigen/src/Array/CwiseOperators.h

25 #iâdeà
EIGEN_ARRAY_CWISE_OPERATORS_H


26 
	#EIGEN_ARRAY_CWISE_OPERATORS_H


	)

39 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

40 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_sq¹_İ
)

41 
Cwi£
<
Ex´essiÚTy³
>::
	$sq¹
() const

43  
	`_ex´essiÚ
();

44 
	}
}

55 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

56 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_exp_İ
)

57 
Cwi£
<
Ex´essiÚTy³
>::
	$exp
() const

59  
	`_ex´essiÚ
();

60 
	}
}

71 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

72 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_log_İ
)

73 
Cwi£
<
Ex´essiÚTy³
>::
	$log
() const

75  
	`_ex´essiÚ
();

76 
	}
}

87 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

88 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_cos_İ
)

89 
Cwi£
<
Ex´essiÚTy³
>::
	$cos
() const

91  
	`_ex´essiÚ
();

92 
	}
}

104 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

105 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_sš_İ
)

106 
Cwi£
<
Ex´essiÚTy³
>::
	$sš
() const

108  
	`_ex´essiÚ
();

109 
	}
}

121 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

122 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_pow_İ
)

123 
Cwi£
<
Ex´essiÚTy³
>::
	$pow
(cÚ¡ 
SÿÏr
& 
expÚ’t
) const

125  
	`EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_pow_İ
)(
	`_ex´essiÚ
(),ƒi_sÿÏr_pow_İ<
SÿÏr
>(
expÚ’t
));

126 
	}
}

138 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

139 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_šv”£_İ
)

140 
Cwi£
<
Ex´essiÚTy³
>::
	$šv”£
() const

142  
	`_ex´essiÚ
();

143 
	}
}

154 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

155 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_squ¬e_İ
)

156 
Cwi£
<
Ex´essiÚTy³
>::
	$squ¬e
() const

158  
	`_ex´essiÚ
();

159 
	}
}

170 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

171 
šlše
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_cube_İ
)

172 
Cwi£
<
Ex´essiÚTy³
>::
	$cube
() const

174  
	`_ex´essiÚ
();

175 
	}
}

189 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

190 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

191 
šlše
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
Ëss
)

192 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
<(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

194  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
Ëss
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

195 
	}
}

206 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

207 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

208 
šlše
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
Ëss_equ®
)

209 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
<=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

211  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
Ëss_equ®
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

212 
	}
}

223 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

224 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

225 
šlše
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
g»©”
)

226 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
>(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

228  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
g»©”
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

229 
	}
}

240 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

241 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

242 
šlše
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
g»©”_equ®
)

243 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
>=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

245  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
g»©”_equ®
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

246 
	}
}

262 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

263 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

264 
šlše
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
equ®_to
)

265 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
==(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

267  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
equ®_to
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

268 
	}
}

284 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

285 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

286 
šlše
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
nÙ_equ®_to
)

287 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
!=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

289  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
nÙ_equ®_to
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

290 
	}
}

300 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

301 
šlše
 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
Ëss
)

302 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
<(
SÿÏr
 
s
) const

304  
	`EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
Ëss
)(
	`_ex´essiÚ
(),

305 
ty³Çme
 
Ex´essiÚTy³
::
	`CÚ¡ªtR‘uºTy³
(
	`_ex´essiÚ
().
	`rows
(), _ex´essiÚ().
	`cŞs
(), 
s
));

306 
	}
}

314 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

315 
šlše
 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
Ëss_equ®
)

316 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
<=(
SÿÏr
 
s
) const

318  
	`EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
Ëss_equ®
)(
	`_ex´essiÚ
(),

319 
ty³Çme
 
Ex´essiÚTy³
::
	`CÚ¡ªtR‘uºTy³
(
	`_ex´essiÚ
().
	`rows
(), _ex´essiÚ().
	`cŞs
(), 
s
));

320 
	}
}

328 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

329 
šlše
 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
g»©”
)

330 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
>(
SÿÏr
 
s
) const

332  
	`EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
g»©”
)(
	`_ex´essiÚ
(),

333 
ty³Çme
 
Ex´essiÚTy³
::
	`CÚ¡ªtR‘uºTy³
(
	`_ex´essiÚ
().
	`rows
(), _ex´essiÚ().
	`cŞs
(), 
s
));

334 
	}
}

342 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

343 
šlše
 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
g»©”_equ®
)

344 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
>=(
SÿÏr
 
s
) const

346  
	`EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
g»©”_equ®
)(
	`_ex´essiÚ
(),

347 
ty³Çme
 
Ex´essiÚTy³
::
	`CÚ¡ªtR‘uºTy³
(
	`_ex´essiÚ
().
	`rows
(), _ex´essiÚ().
	`cŞs
(), 
s
));

348 
	}
}

361 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

362 
šlše
 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
equ®_to
)

363 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
==(
SÿÏr
 
s
) const

365  
	`EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
equ®_to
)(
	`_ex´essiÚ
(),

366 
ty³Çme
 
Ex´essiÚTy³
::
	`CÚ¡ªtR‘uºTy³
(
	`_ex´essiÚ
().
	`rows
(), _ex´essiÚ().
	`cŞs
(), 
s
));

367 
	}
}

380 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

381 
šlše
 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
nÙ_equ®_to
)

382 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
!=(
SÿÏr
 
s
) const

384  
	`EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
nÙ_equ®_to
)(
	`_ex´essiÚ
(),

385 
ty³Çme
 
Ex´essiÚTy³
::
	`CÚ¡ªtR‘uºTy³
(
	`_ex´essiÚ
().
	`rows
(), _ex´essiÚ().
	`cŞs
(), 
s
));

386 
	}
}

399 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

400 
šlše
 cÚ¡ 
ty³Çme
 
	gCwi£
<
	gEx´essiÚTy³
>::
SÿÏrAddR‘uºTy³


401 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
+(cÚ¡ 
SÿÏr
& 
sÿÏr
) const

403  
ty³Çme
 
Cwi£
<
Ex´essiÚTy³
>::
SÿÏrAddR‘uºTy³
(
m_m©rix
, 
ei_sÿÏr_add_İ
<
SÿÏr
>(
sÿÏr
));

415 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

416 
šlše
 
	gEx´essiÚTy³
& 
	gCwi£
<Ex´essiÚTy³>::
İ”©Ü
+=(cÚ¡ 
SÿÏr
& 
sÿÏr
)

418  
m_m©rix
.
cÚ¡_ÿ¡_d”ived
(èğ*
this
 + 
sÿÏr
;

430 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

431 
šlše
 cÚ¡ 
ty³Çme
 
	gCwi£
<
	gEx´essiÚTy³
>::
SÿÏrAddR‘uºTy³


432 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
-(cÚ¡ 
SÿÏr
& 
sÿÏr
) const

434  *
this
 + (-
sÿÏr
);

447 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

448 
šlše
 
	gEx´essiÚTy³
& 
	gCwi£
<Ex´essiÚTy³>::
İ”©Ü
-=(cÚ¡ 
SÿÏr
& 
sÿÏr
)

450  
m_m©rix
.
cÚ¡_ÿ¡_d”ived
(èğ*
this
 - 
sÿÏr
;

	@robot/Eigen/src/Array/Functors.h

25 #iâdeà
EIGEN_ARRAY_FUNCTORS_H


26 
	#EIGEN_ARRAY_FUNCTORS_H


	)

36 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

37 
	sei_sÿÏr_add_İ
 {

38 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

40 
šlše
 
ei_sÿÏr_add_İ
(cÚ¡ƒi_sÿÏr_add_İ& 
Ùh”
è: 
m_Ùh”
(other.m_other) { }

41 
šlše
 
ei_sÿÏr_add_İ
(cÚ¡ 
SÿÏr
& 
Ùh”
è: 
m_Ùh”
(other) { }

42 
šlše
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ SÿÏr& 
a
ècÚ¡ { ‡ + 
m_Ùh”
; }

43 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
) const

44 {  
ei_·dd
(
a
, 
ei_p£t1
(
m_Ùh”
)); }

45 cÚ¡ 
SÿÏr
 
	mm_Ùh”
;

46 
	m´iv©e
:

47 
ei_sÿÏr_add_İ
& 
İ”©Ü
=(constƒi_scalar_add_op&);

49 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

50 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_add_İ
<
	gSÿÏr
> >

51 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
, 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<SÿÏr>::
size
>1 }; };

61 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_sq¹_İ
 
	gEIGEN_EMPTY_STRUCT
 {

62 
šlše
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_sq¹
(
a
); }

64 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

65 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_sq¹_İ
<
	gSÿÏr
> >

66 {ƒnum { 
	gCo¡
 = 5 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

76 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_exp_İ
 
	gEIGEN_EMPTY_STRUCT
 {

77 
šlše
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_exp
(
a
); }

79 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

80 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_exp_İ
<
	gSÿÏr
> >

81 {ƒnum { 
	gCo¡
 = 5 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

91 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_log_İ
 
	gEIGEN_EMPTY_STRUCT
 {

92 
šlše
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_log
(
a
); }

94 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

95 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_log_İ
<
	gSÿÏr
> >

96 {ƒnum { 
	gCo¡
 = 5 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

106 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_cos_İ
 
	gEIGEN_EMPTY_STRUCT
 {

107 
šlše
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_cos
(
a
); }

109 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

110 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_cos_İ
<
	gSÿÏr
> >

111 {ƒnum { 
	gCo¡
 = 5 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

121 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_sš_İ
 
	gEIGEN_EMPTY_STRUCT
 {

122 
šlše
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_sš
(
a
); }

124 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

125 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_sš_İ
<
	gSÿÏr
> >

126 {ƒnum { 
	gCo¡
 = 5 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

136 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

137 
	sei_sÿÏr_pow_İ
 {

139 
šlše
 
ei_sÿÏr_pow_İ
(cÚ¡ƒi_sÿÏr_pow_İ& 
Ùh”
è: 
m_expÚ’t
(other.m_exponent) { }

140 
šlše
 
ei_sÿÏr_pow_İ
(cÚ¡ 
SÿÏr
& 
expÚ’t
è: 
m_expÚ’t
(exponent) {}

141 
šlše
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ SÿÏr& 
a
ècÚ¡ {  
ei_pow
×, 
m_expÚ’t
); }

142 cÚ¡ 
SÿÏr
 
	mm_expÚ’t
;

143 
	m´iv©e
:

144 
ei_sÿÏr_pow_İ
& 
İ”©Ü
=(constƒi_scalar_pow_op&);

146 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

147 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_pow_İ
<
	gSÿÏr
> >

148 {ƒnum { 
	gCo¡
 = 5 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

158 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

159 
	sei_sÿÏr_šv”£_İ
 {

160 
šlše
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	mSÿÏr
& 
	ma
) const {  Scalar(1)/a; }

161 
	m‹m¶©e
<
ty³Çme
 
	mPack‘SÿÏr
>

162 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
) const

163 {  
ei_pdiv
(
ei_p£t1
(
SÿÏr
(1)),
a
); }

165 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

166 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_šv”£_İ
<
	gSÿÏr
> >

167 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = (
ei_·ck‘_Œa™s
<SÿÏr>::
size
)>1 }; };

177 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

178 
	sei_sÿÏr_squ¬e_İ
 {

179 
šlše
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	mSÿÏr
& 
	ma
ècÚ¡ {  
a
*a; }

180 
	m‹m¶©e
<
ty³Çme
 
	mPack‘SÿÏr
>

181 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
) const

182 {  
ei_pmul
(
a
,a); }

184 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

185 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_squ¬e_İ
<
	gSÿÏr
> >

186 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = (
ei_·ck‘_Œa™s
<SÿÏr>::
size
)>1 }; };

196 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

197 
	sei_sÿÏr_cube_İ
 {

198 
šlše
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	mSÿÏr
& 
	ma
ècÚ¡ {  
a
*a*a; }

199 
	m‹m¶©e
<
ty³Çme
 
	mPack‘SÿÏr
>

200 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
) const

201 {  
ei_pmul
(
a
,ei_pmul(a,a)); }

203 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

204 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_cube_İ
<
	gSÿÏr
> >

205 {ƒnum { 
	gCo¡
 = 2*
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = (
ei_·ck‘_Œa™s
<SÿÏr>::
size
)>1 }; };

209 
	g‹m¶©e
<
ty³Çme
 
	gT
>

210 
	gei_funùÜ_Œa™s
<
	g¡d
::
muÉl›s
<
T
> >

211 {ƒnum { 
Co¡
 = 
NumT¿™s
<
T
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

213 
	g‹m¶©e
<
ty³Çme
 
	gT
>

214 
	gei_funùÜ_Œa™s
<
	g¡d
::
divides
<
T
> >

215 {ƒnum { 
Co¡
 = 
NumT¿™s
<
T
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

217 
	g‹m¶©e
<
ty³Çme
 
	gT
>

218 
	gei_funùÜ_Œa™s
<
	g¡d
::
¶us
<
T
> >

219 {ƒnum { 
Co¡
 = 
NumT¿™s
<
T
>::
AddCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

221 
	g‹m¶©e
<
ty³Çme
 
	gT
>

222 
	gei_funùÜ_Œa™s
<
	g¡d
::
mšus
<
T
> >

223 {ƒnum { 
Co¡
 = 
NumT¿™s
<
T
>::
AddCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

225 
	g‹m¶©e
<
ty³Çme
 
	gT
>

226 
	gei_funùÜ_Œa™s
<
	g¡d
::
Ãg©e
<
T
> >

227 {ƒnum { 
Co¡
 = 
NumT¿™s
<
T
>::
AddCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

229 
	g‹m¶©e
<
ty³Çme
 
	gT
>

230 
	gei_funùÜ_Œa™s
<
	g¡d
::
logiÿl_Ü
<
T
> >

231 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

233 
	g‹m¶©e
<
ty³Çme
 
	gT
>

234 
	gei_funùÜ_Œa™s
<
	g¡d
::
logiÿl_ªd
<
T
> >

235 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

237 
	g‹m¶©e
<
ty³Çme
 
	gT
>

238 
	gei_funùÜ_Œa™s
<
	g¡d
::
logiÿl_nÙ
<
T
> >

239 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

241 
	g‹m¶©e
<
ty³Çme
 
	gT
>

242 
	gei_funùÜ_Œa™s
<
	g¡d
::
g»©”
<
T
> >

243 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

245 
	g‹m¶©e
<
ty³Çme
 
	gT
>

246 
	gei_funùÜ_Œa™s
<
	g¡d
::
Ëss
<
T
> >

247 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

249 
	g‹m¶©e
<
ty³Çme
 
	gT
>

250 
	gei_funùÜ_Œa™s
<
	g¡d
::
g»©”_equ®
<
T
> >

251 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

253 
	g‹m¶©e
<
ty³Çme
 
	gT
>

254 
	gei_funùÜ_Œa™s
<
	g¡d
::
Ëss_equ®
<
T
> >

255 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

257 
	g‹m¶©e
<
ty³Çme
 
	gT
>

258 
	gei_funùÜ_Œa™s
<
	g¡d
::
equ®_to
<
T
> >

259 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

261 
	g‹m¶©e
<
ty³Çme
 
	gT
>

262 
	gei_funùÜ_Œa™s
<
	g¡d
::
nÙ_equ®_to
<
T
> >

263 {ƒnum { 
Co¡
 = 1, 
	gPack‘Acûss
 = 
çl£
 }; };

265 
	g‹m¶©e
<
ty³Çme
 
	gT
>

266 
	gei_funùÜ_Œa™s
<
	g¡d
::
bšd”2nd
<
T
> >

267 {ƒnum { 
Co¡
 = 
ei_funùÜ_Œa™s
<
T
>::Co¡, 
	gPack‘Acûss
 = 
çl£
 }; };

269 
	g‹m¶©e
<
ty³Çme
 
	gT
>

270 
	gei_funùÜ_Œa™s
<
	g¡d
::
bšd”1¡
<
T
> >

271 {ƒnum { 
Co¡
 = 
ei_funùÜ_Œa™s
<
T
>::Co¡, 
	gPack‘Acûss
 = 
çl£
 }; };

273 
	g‹m¶©e
<
ty³Çme
 
	gT
>

274 
	gei_funùÜ_Œa™s
<
	g¡d
::
uÇry_Ãg©e
<
T
> >

275 {ƒnum { 
Co¡
 = 1 + 
ei_funùÜ_Œa™s
<
T
>::Co¡, 
	gPack‘Acûss
 = 
çl£
 }; };

277 
	g‹m¶©e
<
ty³Çme
 
	gT
>

278 
	gei_funùÜ_Œa™s
<
	g¡d
::
bš¬y_Ãg©e
<
T
> >

279 {ƒnum { 
Co¡
 = 1 + 
ei_funùÜ_Œa™s
<
T
>::Co¡, 
	gPack‘Acûss
 = 
çl£
 }; };

281 #ifdeà
EIGEN_STDEXT_SUPPORT


283 
	g‹m¶©e
<
ty³Çme
 
	gT0
,ty³Çm
	gT1
>

284 
	gei_funùÜ_Œa™s
<
	g¡d
::
´ojeù1¡
<
T0
,
	gT1
> >

285 {ƒnum { 
	gCo¡
 = 0, 
	gPack‘Acûss
 = 
çl£
 }; };

287 
	g‹m¶©e
<
ty³Çme
 
	gT0
,ty³Çm
	gT1
>

288 
	gei_funùÜ_Œa™s
<
	g¡d
::
´ojeù2nd
<
T0
,
	gT1
> >

289 {ƒnum { 
	gCo¡
 = 0, 
	gPack‘Acûss
 = 
çl£
 }; };

291 
	g‹m¶©e
<
ty³Çme
 
	gT0
,ty³Çm
	gT1
>

292 
	gei_funùÜ_Œa™s
<
	g¡d
::
£Ëù2nd
<
¡d
::
·œ
<
T0
,
	gT1
> > >

293 {ƒnum { 
	gCo¡
 = 0, 
	gPack‘Acûss
 = 
çl£
 }; };

295 
	g‹m¶©e
<
ty³Çme
 
	gT0
,ty³Çm
	gT1
>

296 
	gei_funùÜ_Œa™s
<
	g¡d
::
£Ëù1¡
<
¡d
::
·œ
<
T0
,
	gT1
> > >

297 {ƒnum { 
	gCo¡
 = 0, 
	gPack‘Acûss
 = 
çl£
 }; };

299 
	g‹m¶©e
<
ty³Çme
 
	gT0
,ty³Çm
	gT1
>

300 
	gei_funùÜ_Œa™s
<
	g¡d
::
uÇry_compo£
<
T0
,
	gT1
> >

301 {ƒnum { 
	gCo¡
 = 
ei_funùÜ_Œa™s
<
T0
>::
Co¡
 +ƒi_funùÜ_Œa™s<
T1
>::Co¡, 
	gPack‘Acûss
 = 
çl£
 }; };

303 
	g‹m¶©e
<
ty³Çme
 
	gT0
,ty³Çm
	gT1
,ty³Çm
	gT2
>

304 
	gei_funùÜ_Œa™s
<
	g¡d
::
bš¬y_compo£
<
T0
,
	gT1
,
	gT2
> >

305 {ƒnum { 
	gCo¡
 = 
ei_funùÜ_Œa™s
<
T0
>::
Co¡
 +ƒi_funùÜ_Œa™s<
T1
>::Co¡ +ƒi_funùÜ_Œa™s<
T2
>::Co¡, 
	gPack‘Acûss
 = 
çl£
 }; };

	@robot/Eigen/src/Array/Norms.h

25 #iâdeà
EIGEN_ARRAY_NORMS_H


26 
	#EIGEN_ARRAY_NORMS_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gp
>

29 
	sei_ÍNÜm_£ËùÜ


31 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

32 
šlše
 
R—lSÿÏr
 
run
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
)

34  
ei_pow
(
m
.
cwi£
().
abs
().cwi£().
pow
(
p
).
sum
(), 
R—lSÿÏr
(1)/p);

38 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

39 
	gei_ÍNÜm_£ËùÜ
<
	gD”ived
, 1>

41 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l
 
run
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
)

43  
m
.
cwi£
().
abs
().
sum
();

47 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

48 
	gei_ÍNÜm_£ËùÜ
<
	gD”ived
, 2>

50 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l
 
run
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
)

52  
m
.
nÜm
();

56 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

57 
	gei_ÍNÜm_£ËùÜ
<
	gD”ived
, 
	gInfš™y
>

59 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l
 
run
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
)

61  
m
.
cwi£
().
abs
().
maxCÛff
();

73 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

74 
	g‹m¶©e
<
	gp
>

75 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l
 
M©rixBa£
<
D”ived
>::
	$ÍNÜm
() const

77  
ei_ÍNÜm_£ËùÜ
<
D”ived
, 
p
>::
	`run
(*
this
);

78 
	}
}

	@robot/Eigen/src/Array/PartialRedux.h

26 #iâdeà
EIGEN_PARTIAL_REDUX_H


27 
	#EIGEN_PARTIAL_REDUX_H


	)

46 
	g‹m¶©e
< 
ty³Çme
 
	gM©rixTy³
,y³Çm
	gMemb”Op
, 
	gDœeùiÚ
>

47 
şass
 
	gP¬tŸlReduxEx´
;

49 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
,y³Çm
	gMemb”Op
, 
	gDœeùiÚ
>

50 
	gei_Œa™s
<
	gP¬tŸlReduxEx´
<
	gM©rixTy³
, 
	gMemb”Op
, 
	gDœeùiÚ
> >

52 
ty³Çme
 
	tMemb”Op
::
	t»suÉ_ty³
 
	tSÿÏr
;

53 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 
	tIÅutSÿÏr
;

54 
ty³Çme
 
	tei_Ã¡ed
<
	tM©rixTy³
>::
	tty³
 
	tM©rixTy³Ne¡ed
;

55 
ty³Çme
 
	tei_ş—Áy³
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

57 
	gRowsAtCompeTime
 = 
DœeùiÚ
==
V”tiÿl
 ? 1 : 
M©rixTy³
::
RowsAtCompeTime
,

58 
	gCŞsAtCompeTime
 = 
DœeùiÚ
==
HÜizÚl
 ? 1 : 
M©rixTy³
::
CŞsAtCompeTime
,

59 
	gMaxRowsAtCompeTime
 = 
DœeùiÚ
==
V”tiÿl
 ? 1 : 
M©rixTy³
::
MaxRowsAtCompeTime
,

60 
	gMaxCŞsAtCompeTime
 = 
DœeùiÚ
==
HÜizÚl
 ? 1 : 
M©rixTy³
::
MaxCŞsAtCompeTime
,

61 
	gFÏgs
 = ()
_M©rixTy³Ne¡ed
::
FÏgs
 & 
H”ed™¬yB™s
,

62 
	gT¿v”§lSize
 = 
DœeùiÚ
==
V”tiÿl
 ? 
RowsAtCompeTime
 : 
CŞsAtCompeTime


64 #ià
EIGEN_GNUC_AT_LEAST
(3,4)

65 
ty³Çme
 
	tMemb”Op
::
	t‹m¶©e
 
	tCo¡
<
	tIÅutSÿÏr
,(
	tT¿v”§lSize
)> 
	tCo¡OpTy³
;

67 
ty³Çme
 
	tMemb”Op
::
	t‹m¶©e
 
	tCo¡
<
	tIÅutSÿÏr
,
	tT¿v”§lSize
> 
	tCo¡OpTy³
;

70 
	gCÛffR—dCo¡
 = 
T¿v”§lSize
 * 
ei_Œa™s
<
_M©rixTy³Ne¡ed
>::
CÛffR—dCo¡
 + (
Co¡OpTy³
::
v®ue
)

74 
	g‹m¶©e
< 
ty³Çme
 
	gM©rixTy³
,y³Çm
	gMemb”Op
, 
	gDœeùiÚ
>

75 
şass
 
	gP¬tŸlReduxEx´
 : 
ei_no_assignm’t_İ”©Ü
,

76 
public
 
	gM©rixBa£
<
	gP¬tŸlReduxEx´
<
	gM©rixTy³
, 
	gMemb”Op
, 
	gDœeùiÚ
> >

78 
	gpublic
:

80 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
P¬tŸlReduxEx´
)

81 
ty³Çme
 
	tei_Œa™s
<
	tP¬tŸlReduxEx´
>::
	tM©rixTy³Ne¡ed
 MatrixTypeNested;

82 
ty³Çme
 
	tei_Œa™s
<
	tP¬tŸlReduxEx´
>::
	t_M©rixTy³Ne¡ed
 _MatrixTypeNested;

84 
P¬tŸlReduxEx´
(cÚ¡ 
M©rixTy³
& 
m©
, cÚ¡ 
Memb”Op
& 
func
 = MemberOp())

85 : 
m_m©rix
(
m©
), 
m_funùÜ
(
func
) {}

87 
rows
(ècÚ¡ {  (
	gDœeùiÚ
==
V”tiÿl
 ? 1 : 
m_m©rix
.rows()); }

88 
cŞs
(ècÚ¡ {  (
	gDœeùiÚ
==
HÜizÚl
 ? 1 : 
m_m©rix
.cols()); }

90 cÚ¡ 
SÿÏr
 
cÛff
(
i
, 
j
) const

92 ià(
	gDœeùiÚ
==
V”tiÿl
)

93  
m_funùÜ
(
m_m©rix
.
cŞ
(
j
));

95  
m_funùÜ
(
m_m©rix
.
row
(
i
));

98 
	g´Ùeùed
:

99 cÚ¡ 
M©rixTy³Ne¡ed
 
m_m©rix
;

100 cÚ¡ 
Memb”Op
 
	gm_funùÜ
;

103 
	#EIGEN_MEMBER_FUNCTOR
(
MEMBER
,
COST
) \

104 
‹m¶©e
 <
ty³Çme
 
ResuÉTy³
> \

105 
ei_memb”_
##
MEMBER
 
EIGEN_EMPTY_STRUCT
 { \

106 
ResuÉTy³
 
	t»suÉ_ty³
; \

107 
‹m¶©e
<
ty³Çme
 
SÿÏr
, 
Size
> 
Co¡
 \

108 {ƒnum { 
v®ue
 = 
COST
 }; }; \

109 
‹m¶©e
<
ty³Çme
 
D”ived
> \

110 
šlše
 
ResuÉTy³
 
	`İ”©Ü
()(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m©
) const \

111 {  
m©
.
	`MEMBER
(); } \

112 }

	)

114 
EIGEN_MEMBER_FUNCTOR
(
squ¬edNÜm
, 
Size
 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
 + (Size-1)*NumT¿™s<SÿÏr>::
AddCo¡
);

115 
EIGEN_MEMBER_FUNCTOR
(
nÜm
, (
Size
+5è* 
NumT¿™s
<
SÿÏr
>::
MulCo¡
 + (Size-1)*NumT¿™s<SÿÏr>::
AddCo¡
);

116 
EIGEN_MEMBER_FUNCTOR
(
sum
, (
Size
-1)*
NumT¿™s
<
SÿÏr
>::
AddCo¡
);

117 
EIGEN_MEMBER_FUNCTOR
(
mšCÛff
, (
Size
-1)*
NumT¿™s
<
SÿÏr
>::
AddCo¡
);

118 
EIGEN_MEMBER_FUNCTOR
(
maxCÛff
, (
Size
-1)*
NumT¿™s
<
SÿÏr
>::
AddCo¡
);

119 
EIGEN_MEMBER_FUNCTOR
(
®l
, (
Size
-1)*
NumT¿™s
<
SÿÏr
>::
AddCo¡
);

120 
EIGEN_MEMBER_FUNCTOR
(
ªy
, (
Size
-1)*
NumT¿™s
<
SÿÏr
>::
AddCo¡
);

121 
EIGEN_MEMBER_FUNCTOR
(
couÁ
, (
Size
-1)*
NumT¿™s
<
SÿÏr
>::
AddCo¡
);

124 
	g‹m¶©e
 <
ty³Çme
 
	gBš¬yOp
,y³Çm
	gSÿÏr
>

125 
	sei_memb”_»dux
 {

126 
ty³Çme
 
	tei_»suÉ_of
<

127 
	tBš¬yOp
(
	tSÿÏr
)

128 >::
	tty³
 
	t»suÉ_ty³
;

129 
	m‹m¶©e
<
ty³Çme
 
	m_SÿÏr
, 
	mSize
> 
	sCo¡


130 {ƒnum { 
	mv®ue
 = (
Size
-1è* 
ei_funùÜ_Œa™s
<
Bš¬yOp
>::
Co¡
 }; };

131 
ei_memb”_»dux
(cÚ¡ 
Bš¬yOp
 
func
è: 
m_funùÜ
(func) {}

132 
‹m¶©e
<
ty³Çme
 
D”ived
>

133 
šlše
 
»suÉ_ty³
 
İ”©Ü
()(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m©
) const

134 {  
m©
.
»dux
(
m_funùÜ
); }

135 cÚ¡ 
Bš¬yOp
 
	mm_funùÜ
;

136 
	m´iv©e
:

137 
ei_memb”_»dux
& 
İ”©Ü
=(constƒi_member_redux&);

158 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gDœeùiÚ
> cÏs 
	cP¬tŸlRedux


160 
	mpublic
:

162 
ty³Çme
 
	tei_Œa™s
<
	tEx´essiÚTy³
>::
	tSÿÏr
 Scalar;

163 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

164 
ty³Çme
 
	tei_m‘a_if
<
	tei_mu¡_Ã¡_by_v®ue
<
	tEx´essiÚTy³
>::
	t»t
,

165 
	tEx´essiÚTy³
, cÚ¡ Ex´essiÚTy³&>::
	t»t
 
	tEx´essiÚTy³Ne¡ed
;

167 
	m‹m¶©e
<‹m¶©e<
ty³Çme
 
	m_SÿÏr
> 
şass
 
	mFunùÜ
,

168 
ty³Çme
 
	mSÿÏr
 =y³Çm
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
> 
	sR‘uºTy³


170 
P¬tŸlReduxEx´
<
	tEx´essiÚTy³
,

171 
	tFunùÜ
<
	tSÿÏr
>,

172 
	tDœeùiÚ


173 > 
	tTy³
;

176 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
> 
	sReduxR‘uºTy³


178 
	gP¬tŸlReduxEx´
<
	tEx´essiÚTy³
,

179 
	tei_memb”_»dux
<
	tBš¬yOp
,
	tty³Çme
 
	tei_Œa™s
<
	tEx´essiÚTy³
>::
	tSÿÏr
>,

180 
	tDœeùiÚ


181 > 
	tTy³
;

184 
ty³Çme
 
	tEx´essiÚTy³
::
	tPÏšM©rixTy³
 
	tCrossR‘uºTy³
;

186 
šlše
 
	$P¬tŸlRedux
(cÚ¡ 
Ex´essiÚTy³
& 
m©rix
è: 
	$m_m©rix
(
m©rix
è{
	}
}

189 
šlše
 cÚ¡ 
Ex´essiÚTy³
& 
	$_ex´essiÚ
(ècÚ¡ {  
m_m©rix
; 
	}
}

191 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
>

192 cÚ¡ 
ty³Çme
 
	gReduxR‘uºTy³
<
	gBš¬yOp
>::
Ty³


193 
»dux
(cÚ¡ 
Bš¬yOp
& 
func
 = 
	$Bš¬yOp
()) const;

202 cÚ¡ 
ty³Çme
 
R‘uºTy³
<
ei_memb”_mšCÛff
>::
Ty³
 
	$mšCÛff
() const

203 {  
	`_ex´essiÚ
(); 
	}
}

212 cÚ¡ 
ty³Çme
 
	gR‘uºTy³
<
	gei_memb”_maxCÛff
>::
Ty³
 
	$maxCÛff
() const

213 {  
	`_ex´essiÚ
(); 
	}
}

222 cÚ¡ 
ty³Çme
 
	gR‘uºTy³
<
	gei_memb”_squ¬edNÜm
,
	gR—lSÿÏr
>::
Ty³
 
	$squ¬edNÜm
() const

223 {  
	`_ex´essiÚ
(); 
	}
}

232 cÚ¡ 
ty³Çme
 
	gR‘uºTy³
<
	gei_memb”_nÜm
,
	gR—lSÿÏr
>::
Ty³
 
	$nÜm
() const

233 {  
	`_ex´essiÚ
(); 
	}
}

242 cÚ¡ 
ty³Çme
 
	gR‘uºTy³
<
	gei_memb”_sum
>::
Ty³
 
	$sum
() const

243 {  
	`_ex´essiÚ
(); 
	}
}

249 cÚ¡ 
ty³Çme
 
	gR‘uºTy³
<
	gei_memb”_®l
>::
Ty³
 
	$®l
() const

250 {  
	`_ex´essiÚ
(); 
	}
}

256 cÚ¡ 
ty³Çme
 
	gR‘uºTy³
<
	gei_memb”_ªy
>::
Ty³
 
	$ªy
() const

257 {  
	`_ex´essiÚ
(); 
	}
}

266 cÚ¡ 
	gP¬tŸlReduxEx´
<
	gEx´essiÚTy³
, 
	gei_memb”_couÁ
<>, 
	gDœeùiÚ
> 
	$couÁ
() const

267 {  
	`_ex´essiÚ
(); 
	}
}

275 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

276 cÚ¡ 
CrossR‘uºTy³
 
üoss
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const

278 
EIGEN_STATIC_ASSERT_MATRIX_SPECIFIC_SIZE
(
CrossR‘uºTy³
,3,3)

279 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
Oth”D”ived
,3)

280 
EIGEN_STATIC_ASSERT
((
ei_is_§me_ty³
<
SÿÏr
, 
ty³Çme
 
Oth”D”ived
::SÿÏr>::
»t
),

281 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

283 if(
	gDœeùiÚ
==
V”tiÿl
)

284  (
CrossR‘uºTy³
()

285 << 
_ex´essiÚ
().
cŞ
(0).
üoss
(
Ùh”
),

286 
_ex´essiÚ
().
cŞ
(1).
üoss
(
Ùh”
),

287 
_ex´essiÚ
().
cŞ
(2).
üoss
(
Ùh”
)).
fšished
();

289  (
CrossR‘uºTy³
()

290 << 
_ex´essiÚ
().
row
(0).
üoss
(
Ùh”
),

291 
_ex´essiÚ
().
row
(1).
üoss
(
Ùh”
),

292 
_ex´essiÚ
().
row
(2).
üoss
(
Ùh”
)).
fšished
();

295 
	g´Ùeùed
:

296 
Ex´essiÚTy³Ne¡ed
 
m_m©rix
;

298 
	g´iv©e
:

299 
P¬tŸlRedux
& 
İ”©Ü
=(const PartialRedux&);

311 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

312 
šlše
 cÚ¡ 
	gP¬tŸlRedux
<
	gD”ived
,
	gV”tiÿl
>

313 
	gM©rixBa£
<
	gD”ived
>::
	$cŞwi£
() const

315  
	`d”ived
();

316 
	}
}

327 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

328 
šlše
 cÚ¡ 
	gP¬tŸlRedux
<
	gD”ived
,
	gHÜizÚl
>

329 
	gM©rixBa£
<
	gD”ived
>::
	$rowwi£
() const

331  
	`d”ived
();

332 
	}
}

341 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gDœeùiÚ
>

342 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
>

343 cÚ¡ 
ty³Çme
 
	gP¬tŸlRedux
<
	gEx´essiÚTy³
,
	gDœeùiÚ
>::
‹m¶©e
 
ReduxR‘uºTy³
<
Bš¬yOp
>::
Ty³


344 
P¬tŸlRedux
<
Ex´essiÚTy³
,
	gDœeùiÚ
>::
	$»dux
(cÚ¡ 
Bš¬yOp
& 
func
) const

346  
ty³Çme
 
ReduxR‘uºTy³
<
Bš¬yOp
>::
	`Ty³
(
	`_ex´essiÚ
(), 
func
);

347 
	}
}

	@robot/Eigen/src/Array/Random.h

25 #iâdeà
EIGEN_RANDOM_H


26 
	#EIGEN_RANDOM_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_¿ndom_İ
 
	gEIGEN_EMPTY_STRUCT
 {

29 
šlše
 
ei_sÿÏr_¿ndom_İ
() {}

30 
šlše
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(, ècÚ¡ {  
	gei_¿ndom
<
	gSÿÏr
>(); }

32 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

33 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_¿ndom_İ
<
	gSÿÏr
> >

34 {ƒnum { 
	gCo¡
 = 5 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
, 
	gIsR•—bË
 = false }; };

54 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

55 
šlše
 cÚ¡ 
	gCwi£NuÎ¬yOp
<
	gei_sÿÏr_¿ndom_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

56 
	gM©rixBa£
<
	gD”ived
>::
	$Rªdom
(
rows
, 
cŞs
)

58  
	`NuÎ¬yEx´
(
rows
, 
cŞs
, 
ei_sÿÏr_¿ndom_İ
<
SÿÏr
>());

59 
	}
}

79 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

80 
šlše
 cÚ¡ 
	gCwi£NuÎ¬yOp
<
	gei_sÿÏr_¿ndom_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

81 
	gM©rixBa£
<
	gD”ived
>::
	$Rªdom
(
size
)

83  
	`NuÎ¬yEx´
(
size
, 
ei_sÿÏr_¿ndom_İ
<
SÿÏr
>());

84 
	}
}

99 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

100 
šlše
 cÚ¡ 
	gCwi£NuÎ¬yOp
<
	gei_sÿÏr_¿ndom_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

101 
	gM©rixBa£
<
	gD”ived
>::
	$Rªdom
()

103  
	`NuÎ¬yEx´
(
RowsAtCompeTime
, 
CŞsAtCompeTime
, 
ei_sÿÏr_¿ndom_İ
<
SÿÏr
>());

104 
	}
}

115 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

116 
šlše
 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
	$£tRªdom
()

118  *
this
 = 
	`Rªdom
(
	`rows
(), 
	`cŞs
());

119 
	}
}

130 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

131 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

132 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tRªdom
(
size
)

134 
	`»size
(
size
);

135  
	`£tRªdom
();

136 
	}
}

148 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

149 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

150 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tRªdom
(
rows
, 
cŞs
)

152 
	`»size
(
rows
, 
cŞs
);

153  
	`£tRªdom
();

154 
	}
}

	@robot/Eigen/src/Array/Select.h

25 #iâdeà
EIGEN_SELECT_H


26 
	#EIGEN_SELECT_H


	)

44 
	g‹m¶©e
<
ty³Çme
 
	gCÚd™iÚM©rixTy³
,y³Çm
	gTh’M©rixTy³
,y³Çm
	gEl£M©rixTy³
>

45 
	gei_Œa™s
<
	gS–eù
<
	gCÚd™iÚM©rixTy³
, 
	gTh’M©rixTy³
, 
	gEl£M©rixTy³
> >

47 
ty³Çme
 
	tei_Œa™s
<
	tTh’M©rixTy³
>::
	tSÿÏr
 Scalar;

48 
ty³Çme
 
	tCÚd™iÚM©rixTy³
::
	tNe¡ed
 
	tCÚd™iÚM©rixNe¡ed
;

49 
ty³Çme
 
	tTh’M©rixTy³
::
	tNe¡ed
 
	tTh’M©rixNe¡ed
;

50 
ty³Çme
 
	tEl£M©rixTy³
::
	tNe¡ed
 
	tEl£M©rixNe¡ed
;

52 
	gRowsAtCompeTime
 = 
CÚd™iÚM©rixTy³
::
RowsAtCompeTime
,

53 
	gCŞsAtCompeTime
 = 
CÚd™iÚM©rixTy³
::
CŞsAtCompeTime
,

54 
	gMaxRowsAtCompeTime
 = 
CÚd™iÚM©rixTy³
::
MaxRowsAtCompeTime
,

55 
	gMaxCŞsAtCompeTime
 = 
CÚd™iÚM©rixTy³
::
MaxCŞsAtCompeTime
,

56 
	gFÏgs
 = ()
Th’M©rixTy³
::
FÏgs
 & 
El£M©rixTy³
::FÏg & 
H”ed™¬yB™s
,

57 
	gCÛffR—dCo¡
 = 
ei_Œa™s
<
ty³Çme
 
ei_ş—Áy³
<
CÚd™iÚM©rixNe¡ed
>::
ty³
>::
CÛffR—dCo¡


58 + 
EIGEN_ENUM_MAX
(
ei_Œa™s
<
ty³Çme
 
ei_ş—Áy³
<
Th’M©rixNe¡ed
>::
ty³
>::
CÛffR—dCo¡
,

59 
ei_Œa™s
<
ty³Çme
 
ei_ş—Áy³
<
El£M©rixNe¡ed
>::
ty³
>::
CÛffR—dCo¡
)

63 
	g‹m¶©e
<
ty³Çme
 
	gCÚd™iÚM©rixTy³
,y³Çm
	gTh’M©rixTy³
,y³Çm
	gEl£M©rixTy³
>

64 
şass
 
	gS–eù
 : 
ei_no_assignm’t_İ”©Ü
,

65 
public
 
	gM©rixBa£
<
	gS–eù
<
	gCÚd™iÚM©rixTy³
, 
	gTh’M©rixTy³
, 
	gEl£M©rixTy³
> >

67 
	gpublic
:

69 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
S–eù
)

71 
S–eù
(cÚ¡ 
CÚd™iÚM©rixTy³
& 
cÚd™iÚM©rix
,

72 cÚ¡ 
Th’M©rixTy³
& 
th’M©rix
,

73 cÚ¡ 
El£M©rixTy³
& 
–£M©rix
)

74 : 
m_cÚd™iÚ
(
cÚd™iÚM©rix
), 
m_th’
(
th’M©rix
), 
m_–£
(
–£M©rix
)

76 
ei_as£¹
(
m_cÚd™iÚ
.
rows
(è=ğ
m_th’
.rows(è&& m_cÚd™iÚ.rows(è=ğ
m_–£
.rows());

77 
ei_as£¹
(
m_cÚd™iÚ
.
cŞs
(è=ğ
m_th’
.cŞs(è&& m_cÚd™iÚ.cŞs(è=ğ
m_–£
.cols());

80 
rows
(ècÚ¡ {  
	gm_cÚd™iÚ
.rows(); }

81 
cŞs
(ècÚ¡ {  
	gm_cÚd™iÚ
.cols(); }

83 cÚ¡ 
SÿÏr
 
cÛff
(
i
, 
j
) const

85 ià(
	gm_cÚd™iÚ
.
cÛff
(
i
,
j
))

86  
	gm_th’
.
cÛff
(
i
,
j
);

88  
	gm_–£
.
cÛff
(
i
,
j
);

91 cÚ¡ 
SÿÏr
 
cÛff
(
i
) const

93 ià(
	gm_cÚd™iÚ
.
cÛff
(
i
))

94  
	gm_th’
.
cÛff
(
i
);

96  
	gm_–£
.
cÛff
(
i
);

99 
	g´Ùeùed
:

100 cÚ¡ 
ty³Çme
 
CÚd™iÚM©rixTy³
::
Ne¡ed
 
m_cÚd™iÚ
;

101 cÚ¡ 
ty³Çme
 
	gTh’M©rixTy³
::
Ne¡ed
 
m_th’
;

102 cÚ¡ 
ty³Çme
 
	gEl£M©rixTy³
::
Ne¡ed
 
m_–£
;

116 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

117 
	g‹m¶©e
<
ty³Çme
 
	gTh’D”ived
,ty³Çm
	gEl£D”ived
>

118 
šlše
 cÚ¡ 
	gS–eù
<
	gD”ived
,
	gTh’D”ived
,
	gEl£D”ived
>

119 
	gM©rixBa£
<
	gD”ived
>::
£Ëù
(cÚ¡ 
M©rixBa£
<
Th’D”ived
>& 
th’M©rix
,

120 cÚ¡ 
M©rixBa£
<
El£D”ived
>& 
–£M©rix
) const

122  
	gS–eù
<
	gD”ived
,
	gTh’D”ived
,
	gEl£D”ived
>(
d”ived
(), 
	gth’M©rix
.d”ived(), 
	g–£M©rix
.derived());

132 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

133 
	g‹m¶©e
<
ty³Çme
 
	gTh’D”ived
>

134 
šlše
 cÚ¡ 
	gS–eù
<
	gD”ived
,
	gTh’D”ived
, 
	gNe¡ByV®ue
<
ty³Çme
 Th’D”ived::
CÚ¡ªtR‘uºTy³
> >

135 
M©rixBa£
<
D”ived
>::
£Ëù
(cÚ¡ M©rixBa£<
Th’D”ived
>& 
th’M©rix
,

136 
ty³Çme
 
Th’D”ived
::
SÿÏr
 
–£SÿÏr
) const

138  
S–eù
<
D”ived
,
	gTh’D”ived
,
	gNe¡ByV®ue
<
ty³Çme
 Th’D”ived::
CÚ¡ªtR‘uºTy³
> >(

139 
d”ived
(), 
	gth’M©rix
.d”ived(), 
	gTh’D”ived
::
CÚ¡ªt
(
rows
(),
cŞs
(),
–£SÿÏr
));

149 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

150 
	g‹m¶©e
<
ty³Çme
 
	gEl£D”ived
>

151 
šlše
 cÚ¡ 
	gS–eù
<
	gD”ived
, 
	gNe¡ByV®ue
<
ty³Çme
 
	gEl£D”ived
::
CÚ¡ªtR‘uºTy³
>, ElseDerived >

152 
	gM©rixBa£
<
	gD”ived
>::
£Ëù
(
ty³Çme
 
El£D”ived
::
SÿÏr
 
th’SÿÏr
,

153 cÚ¡ 
M©rixBa£
<
El£D”ived
>& 
–£M©rix
) const

155  
	gS–eù
<
	gD”ived
,
	gNe¡ByV®ue
<
ty³Çme
 
	gEl£D”ived
::
CÚ¡ªtR‘uºTy³
>,ElseDerived>(

156 
d”ived
(), 
	gEl£D”ived
::
CÚ¡ªt
(
rows
(),
cŞs
(),
th’SÿÏr
), 
	g–£M©rix
.derived());

	@robot/Eigen/src/Cholesky/CholeskyInstantiations.cpp

25 #iâdeà
EIGEN_EXTERN_INSTANTIATIONS


26 
	#EIGEN_EXTERN_INSTANTIATIONS


	)

28 
	~"../../CÜe
"

29 #undeà
EIGEN_EXTERN_INSTANTIATIONS


31 
	~"../../ChŞesky
"

33 
Çme¥aû
 
	gEig’
 {

34 
EIGEN_CHOLESKY_MODULE_INSTANTIATE
();

	@robot/Eigen/src/Cholesky/LDLT.h

25 #iâdeà
EIGEN_LDLT_H


26 
	#EIGEN_LDLT_H


	)

48 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> cÏs 
	cLDLT


50 
	mpublic
:

52 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

53 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

54 
	mM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, 1> 
	tVeùÜTy³
;

56 
	$LDLT
(cÚ¡ 
M©rixTy³
& 
m©rix
)

57 : 
	`m_m©rix
(
m©rix
.
	`rows
(), m©rix.
	$cŞs
())

59 
	`compu‹
(
m©rix
);

63 
šlše
 
P¬t
<
M©rixTy³
, 
Un™Low”TrŸnguÏr
> 
	$m©rixL
(ècÚ¡ {  
m_m©rix
; 
	}
}

66 
šlše
 
	gDŸgÚ®CÛffs
<
	gM©rixTy³
> 
	$veùÜD
(ècÚ¡ {  
m_m©rix
.
	`dŸgÚ®
(); 
	}
}

69 
šlše
 
boŞ
 
	$isPos™iveDefš™e
(ècÚ¡ {  
m_isPos™iveDefš™e
; 
	}
}

71 
	g‹m¶©e
<
ty³Çme
 
	gRhsD”ived
,y³Çm
	gResuÉTy³
>

72 
boŞ
 
sŞve
(cÚ¡ 
M©rixBa£
<
RhsD”ived
> &
b
, 
ResuÉTy³
 *
»suÉ
) const;

74 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

75 
boŞ
 
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
bAndX
) const;

77 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

79 
	g´Ùeùed
:

86 
M©rixTy³
 
m_m©rix
;

88 
boŞ
 
	gm_isPos™iveDefš™e
;

93 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

94 
	gLDLT
<
	gM©rixTy³
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

96 
	`as£¹
(
a
.
	`rows
()=÷.
	`cŞs
());

97 cÚ¡ 
size
 = 
a
.
	`rows
();

98 
m_m©rix
.
	`»size
(
size
, size);

99 
m_isPos™iveDefš™e
 = 
Œue
;

101 ià(
size
<=1)

103 
m_m©rix
 = 
a
;

111 
M©rix
<
SÿÏr
,
M©rixTy³
::
RowsAtCompeTime
,1> 
	`_‹mpÜ¬y
(
size
);

116 
m_m©rix
.
	`row
(0èğ
a
.row(0).
	`cÚjug©e
();

117 
m_m©rix
.
	`cŞ
(0).
	`’d
(
size
-1èğm_m©rix.
	`row
(0).’d(size-1è/ m_m©rix.
	`cÛff
(0,0);

118 
j
 = 1; j < 
size
; ++j)

120 
R—lSÿÏr
 
tmp
 = 
	`ei_»®
(
a
.
	`cÛff
(
j
,jè- (
m_m©rix
.
	`row
(j).
	`¡¬t
(jè* m_m©rix.
	`cŞ
(j).¡¬t(j).
	`cÚjug©e
()).coeff(0,0));

121 
m_m©rix
.
	`cÛffRef
(
j
,jèğ
tmp
;

123 
’dSize
 = 
size
-
j
-1;

124 ià(
’dSize
>0)

126 
_‹mpÜ¬y
.
	`’d
(
’dSize
èğĞ
m_m©rix
.
	`block
(
j
+1,0,ƒndSize, j)

127 * 
m_m©rix
.
	`cŞ
(
j
).
	`¡¬t
(j).
	`cÚjug©e
(è).
	`Ïzy
();

129 
m_m©rix
.
	`row
(
j
).
	`’d
(
’dSize
èğ
a
.row(j).’dÓndSize).
	`cÚjug©e
()

130 - 
_‹mpÜ¬y
.
	`’d
(
’dSize
).
	`Œª¥o£
();

132 if(
tmp
 !ğ
	`R—lSÿÏr
(0))

133 
m_m©rix
.
	`cŞ
(
j
).
	`’d
(
’dSize
èğm_m©rix.
	`row
(j).’dÓndSizeè/ 
tmp
;

136 
	}
}

148 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

149 
	g‹m¶©e
<
ty³Çme
 
	gRhsD”ived
,y³Çm
	gResuÉTy³
>

150 
boŞ
 
	gLDLT
<
	gM©rixTy³
>

151 ::
sŞve
(cÚ¡ 
M©rixBa£
<
RhsD”ived
> &
b
, 
ResuÉTy³
 *
»suÉ
) const

153 cÚ¡ 
	gsize
 = 
m_m©rix
.
rows
();

154 
ei_as£¹
(
size
==
b
.
rows
() && "LLT::solve(): invalid‚umber of„ows ofhe„ight hand side matrix b");

155 *
	g»suÉ
 = 
b
;

156  
sŞveInPÏû
(*
»suÉ
);

168 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

169 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

170 
boŞ
 
	gLDLT
<
	gM©rixTy³
>::
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
bAndX
) const

172 cÚ¡ 
size
 = 
m_m©rix
.
rows
();

173 
ei_as£¹
(
size
==
bAndX
.
rows
());

174 ià(!
	gm_isPos™iveDefš™e
)

175  
	gçl£
;

176 
m©rixL
().
sŞveTrŸnguÏrInPÏû
(
bAndX
);

177 
	gbAndX
 = (
m_m©rix
.
cwi£
().
šv”£
().
‹m¶©e
 
·¹
<
DŸgÚ®
>(è* 
bAndX
).
Ïzy
();

178 
	gm_m©rix
.
adjošt
().
‹m¶©e
 
	g·¹
<
	gUn™Uµ”TrŸnguÏr
>().
sŞveTrŸnguÏrInPÏû
(
bAndX
);

179  
	gŒue
;

185 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

186 
šlše
 cÚ¡ 
	gLDLT
<
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³
>

187 
M©rixBa£
<
D”ived
>::
	$ldÉ
() const

189  
LDLT
<
PÏšM©rixTy³
>(
	`d”ived
());

190 
	}
}

	@robot/Eigen/src/Cholesky/LLT.h

25 #iâdeà
EIGEN_LLT_H


26 
	#EIGEN_LLT_H


	)

54 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> cÏs 
	cLLT


56 
	m´iv©e
:

57 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

58 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

59 
	mM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, 1> 
	tVeùÜTy³
;

62 
	mPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
,

63 
	mAlignm’tMask
 = (
Pack‘Size
)-1

66 
	gpublic
:

74 
	$LLT
(è: 
	`m_m©rix
(), 
	$m_isIn™Ÿlized
(
çl£
è{
	}
}

76 
	$LLT
(cÚ¡ 
M©rixTy³
& 
m©rix
)

77 : 
	`m_m©rix
(
m©rix
.
	`rows
(), m©rix.
	`cŞs
()),

78 
	$m_isIn™Ÿlized
(
çl£
)

80 
	`compu‹
(
m©rix
);

81 
	}
}

84 
šlše
 
	gP¬t
<
	gM©rixTy³
, 
	gLow”TrŸnguÏr
> 
	$m©rixL
() const

86 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "LLT is‚ot initialized.");

87  
m_m©rix
;

88 
	}
}

91 
šlše
 
boŞ
 
	$isPos™iveDefš™e
(ècÚ¡ {  
m_isIn™Ÿlized
 && 
m_isPos™iveDefš™e
; 
	}
}

93 
	g‹m¶©e
<
ty³Çme
 
	gRhsD”ived
,y³Çm
	gResuÉTy³
>

94 
boŞ
 
sŞve
(cÚ¡ 
M©rixBa£
<
RhsD”ived
> &
b
, 
ResuÉTy³
 *
»suÉ
) const;

96 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

97 
boŞ
 
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
bAndX
) const;

99 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

101 
	g´Ùeùed
:

106 
M©rixTy³
 
m_m©rix
;

107 
boŞ
 
	gm_isIn™Ÿlized
;

108 
boŞ
 
	gm_isPos™iveDefš™e
;

113 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

114 
	gLLT
<
	gM©rixTy³
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

116 
	`as£¹
(
a
.
	`rows
()=÷.
	`cŞs
());

117 
m_isPos™iveDefš™e
 = 
Œue
;

118 cÚ¡ 
size
 = 
a
.
	`rows
();

119 
m_m©rix
.
	`»size
(
size
, size);

126 cÚ¡ 
R—lSÿÏr
 
cutoff
 = 
machše_•sÚ
<
SÿÏr
>(è* 
size
 * 
a
.
	`dŸgÚ®
().
	`cwi£
().
	`abs
().
	`maxCÛff
();

127 
R—lSÿÏr
 
x
;

128 
x
 = 
	`ei_»®
(
a
.
	`cÛff
(0,0));

129 
m_m©rix
.
	`cÛffRef
(0,0èğ
	`ei_sq¹
(
x
);

130 if(
size
==1)

132 
m_isIn™Ÿlized
 = 
Œue
;

135 if(
	`ei_»®
(
m_m©rix
.
	`cÛff
(0,0))>0)

136 
m_m©rix
.
	`cŞ
(0).
	`’d
(
size
-1èğ
a
.
	`row
(0).’d(size-1).
	`adjošt
(è/ 
	`ei_»®
(m_m©rix.
	`cÛff
(0,0));

137 
j
 = 1; j < 
size
; ++j)

139 
x
 = 
	`ei_»®
(
a
.
	`cÛff
(
j
,j)è- 
m_m©rix
.
	`row
(j).
	`¡¬t
(j).
	`squ¬edNÜm
();

140 ià(
x
 <ğ
cutoff
)

142 
m_isPos™iveDefš™e
 = 
çl£
;

146 
m_m©rix
.
	`cÛffRef
(
j
,jèğ
x
 = 
	`ei_sq¹
(x);

148 
’dSize
 = 
size
-
j
-1;

149 ià(
’dSize
>0) {

152 
m_m©rix
.
	`cŞ
(
j
).
	`’d
(
’dSize
) =

153 (
m_m©rix
.
	`block
(
j
+1, 0, 
’dSize
, jè* m_m©rix.
	`row
(j).
	`¡¬t
(j).
	`adjošt
()).
	`Ïzy
();

156 
m_m©rix
.
	`cŞ
(
j
).
	`’d
(
’dSize
èğ(
a
.
	`row
(j).’dÓndSize).
	`adjošt
()

157 - 
m_m©rix
.
	`cŞ
(
j
).
	`’d
(
’dSize
èè/ 
x
;

161 
m_isIn™Ÿlized
 = 
Œue
;

162 
	}
}

177 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

178 
	g‹m¶©e
<
ty³Çme
 
	gRhsD”ived
,y³Çm
	gResuÉTy³
>

179 
boŞ
 
	gLLT
<
	gM©rixTy³
>::
sŞve
(cÚ¡ 
M©rixBa£
<
RhsD”ived
> &
b
, 
ResuÉTy³
 *
»suÉ
) const

181 
ei_as£¹
(
m_isIn™Ÿlized
 && "LLT is‚ot initialized.");

182 cÚ¡ 
	gsize
 = 
m_m©rix
.
rows
();

183 
ei_as£¹
(
size
==
b
.
rows
() && "LLT::solve(): invalid‚umber of„ows ofhe„ight hand side matrix b");

184  
sŞveInPÏû
((*
»suÉ
èğ
b
);

198 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

199 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

200 
boŞ
 
	gLLT
<
	gM©rixTy³
>::
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
bAndX
) const

202 
ei_as£¹
(
m_isIn™Ÿlized
 && "LLT is‚ot initialized.");

203 cÚ¡ 
	gsize
 = 
m_m©rix
.
rows
();

204 
ei_as£¹
(
size
==
bAndX
.
rows
());

205 
m©rixL
().
sŞveTrŸnguÏrInPÏû
(
bAndX
);

206 
	gm_m©rix
.
adjošt
().
‹m¶©e
 
	g·¹
<
	gUµ”TrŸnguÏr
>().
sŞveTrŸnguÏrInPÏû
(
bAndX
);

207  
	gŒue
;

213 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

214 
šlše
 cÚ¡ 
	gLLT
<
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³
>

215 
M©rixBa£
<
D”ived
>::
	$Ît
() const

217  
LLT
<
PÏšM©rixTy³
>(
	`d”ived
());

218 
	}
}

	@robot/Eigen/src/Core/Assign.h

27 #iâdeà
EIGEN_ASSIGN_H


28 
	#EIGEN_ASSIGN_H


	)

34 
	g‹m¶©e
 <
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

35 
	sei_assign_Œa™s


37 
	mpublic
:

39 
D¡IsAligÃd
 = 
D”ived
::
FÏgs
 & 
AligÃdB™
,

40 
	mSrcIsAligÃd
 = 
Oth”D”ived
::
FÏgs
 & 
AligÃdB™
,

41 
	mSrcAlignm’t
 = 
D¡IsAligÃd
 && 
SrcIsAligÃd
 ? 
AligÃd
 : 
UÇligÃd


44 
	m´iv©e
:

46 
IÂ”Size
 = (
D”ived
::
FÏgs
)&
RowMajÜB™


47 ? 
D”ived
::
CŞsAtCompeTime


48 : 
D”ived
::
RowsAtCompeTime
,

49 
	mIÂ”MaxSize
 = (
D”ived
::
FÏgs
)&
RowMajÜB™


50 ? 
D”ived
::
MaxCŞsAtCompeTime


51 : 
D”ived
::
MaxRowsAtCompeTime
,

52 
	mPack‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived
::
SÿÏr
>::
size


56 
	mMightVeùÜize
 = ((
D”ived
::
FÏgs
è& (
Oth”D”ived
::FÏgsè& 
Aùu®Pack‘AcûssB™
)

57 && (((
D”ived
::
FÏgs
)&
RowMajÜB™
)==((
Oth”D”ived
::Flags)&RowMajorBit)),

58 
	mMayIÂ”VeùÜize
 = 
MightVeùÜize
 && (
IÂ”Size
)!=
DyÇmic
 && (IÂ”Size)%(
Pack‘Size
)==0

59 && (
D¡IsAligÃd
è&& (
SrcIsAligÃd
),

60 
	mMayLš—rVeùÜize
 = 
MightVeùÜize
 && ((
D”ived
::
FÏgs
è& (
Oth”D”ived
::FÏgsè& 
Lš—rAcûssB™
),

61 
	mMaySliûVeùÜize
 = 
MightVeùÜize
 && (
IÂ”MaxSize
)>=3*
Pack‘Size


66 
	mpublic
:

68 
VeùÜiz©iÚ
 = (
MayIÂ”VeùÜize
è? (
IÂ”VeùÜiz©iÚ
)

69 : (
MayLš—rVeùÜize
è? (
Lš—rVeùÜiz©iÚ
)

70 : (
MaySliûVeùÜize
è? (
SliûVeùÜiz©iÚ
)

71 : (
NoVeùÜiz©iÚ
)

74 
	m´iv©e
:

76 
UÄŞlšgLim™
 = 
EIGEN_UNROLLING_LIMIT
 * ((
VeùÜiz©iÚ
è=ğ(
NoVeùÜiz©iÚ
è? 1 : (
Pack‘Size
)),

77 
	mMayUÄŞlCom¶‘–y
 = (
D”ived
::
SizeAtCompeTime
è* (
Oth”D”ived
::
CÛffR—dCo¡
è<ğ(
UÄŞlšgLim™
),

78 
	mMayUÄŞlIÂ”
 = (
IÂ”Size
 * 
Oth”D”ived
::
CÛffR—dCo¡
è<ğ(
UÄŞlšgLim™
)

81 
	mpublic
:

83 
UÄŞlšg
 = ((
VeùÜiz©iÚ
è=ğ(
IÂ”VeùÜiz©iÚ
è|| (VeùÜiz©iÚè=ğ(
NoVeùÜiz©iÚ
))

85 (
MayUÄŞlCom¶‘–y
è? (
Com¶‘eUÄŞlšg
)

86 : (
MayUÄŞlIÂ”
è? (
IÂ”UÄŞlšg
)

87 : (
NoUÄŞlšg
)

89 : (
VeùÜiz©iÚ
è=ğ(
Lš—rVeùÜiz©iÚ
)

90 ? ( (
MayUÄŞlCom¶‘–y
è&& (
D¡IsAligÃd
è? (
Com¶‘eUÄŞlšg
è: (
NoUÄŞlšg
) )

91 : (
NoUÄŞlšg
)

94 #ifdeà
EIGEN_DEBUG_ASSIGN


95 
	#EIGEN_DEBUG_VAR
(
x
è
¡d
::
û¼
 << #x << " = " << x << std::
’dl
;

	)

96 
debug
()

98 
EIGEN_DEBUG_VAR
(
D¡IsAligÃd
)

99 
EIGEN_DEBUG_VAR
(
SrcIsAligÃd
)

100 
EIGEN_DEBUG_VAR
(
SrcAlignm’t
)

101 
EIGEN_DEBUG_VAR
(
IÂ”Size
)

102 
EIGEN_DEBUG_VAR
(
IÂ”MaxSize
)

103 
EIGEN_DEBUG_VAR
(
Pack‘Size
)

104 
EIGEN_DEBUG_VAR
(
MightVeùÜize
)

105 
EIGEN_DEBUG_VAR
(
MayIÂ”VeùÜize
)

106 
EIGEN_DEBUG_VAR
(
MayLš—rVeùÜize
)

107 
EIGEN_DEBUG_VAR
(
MaySliûVeùÜize
)

108 
EIGEN_DEBUG_VAR
(
VeùÜiz©iÚ
)

109 
EIGEN_DEBUG_VAR
(
UÄŞlšgLim™
)

110 
EIGEN_DEBUG_VAR
(
MayUÄŞlCom¶‘–y
)

111 
EIGEN_DEBUG_VAR
(
MayUÄŞlIÂ”
)

112 
EIGEN_DEBUG_VAR
(
UÄŞlšg
)

125 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gIndex
, 
	gStİ
>

126 
	sei_assign_novec_Com¶‘eUÄŞlšg


129 
	mrow
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™


130 ? 
Index
 / (
D”ived1
::
CŞsAtCompeTime
)

131 : 
Index
 % 
D”ived1
::
RowsAtCompeTime
,

132 
	mcŞ
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™


133 ? 
Index
 % (
D”ived1
::
CŞsAtCompeTime
)

134 : 
Index
 / 
D”ived1
::
RowsAtCompeTime


137 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

139 
	md¡
.
cİyCÛff
(
row
, 
cŞ
, 
¤c
);

140 
	mei_assign_novec_Com¶‘eUÄŞlšg
<
	mD”ived1
, 
	mD”ived2
, 
	mIndex
+1, 
	mStİ
>::
run
(
d¡
, 
¤c
);

144 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gStİ
>

145 
	gei_assign_novec_Com¶‘eUÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 
	gStİ
, Stop>

147 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &, cÚ¡ 
D”ived2
 &) {}

150 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gIndex
, 
	gStİ
>

151 
	sei_assign_novec_IÂ”UÄŞlšg


153 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
, 
row_Ü_cŞ
)

155 cÚ¡ 
boŞ
 
	mrowMajÜ
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™
;

156 cÚ¡ 
	mrow
 = 
rowMajÜ
 ? 
row_Ü_cŞ
 : 
Index
;

157 cÚ¡ 
	mcŞ
 = 
rowMajÜ
 ? 
Index
 : 
row_Ü_cŞ
;

158 
	md¡
.
cİyCÛff
(
row
, 
cŞ
, 
¤c
);

159 
	mei_assign_novec_IÂ”UÄŞlšg
<
	mD”ived1
, 
	mD”ived2
, 
	mIndex
+1, 
	mStİ
>::
run
(
d¡
, 
¤c
, 
row_Ü_cŞ
);

163 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gStİ
>

164 
	gei_assign_novec_IÂ”UÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 
	gStİ
, Stop>

166 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &, cÚ¡ 
D”ived2
 &, ) {}

173 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gIndex
, 
	gStİ
>

174 
	sei_assign_šÃrvec_Com¶‘eUÄŞlšg


177 
	mrow
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™


178 ? 
Index
 / (
D”ived1
::
CŞsAtCompeTime
)

179 : 
Index
 % 
D”ived1
::
RowsAtCompeTime
,

180 
	mcŞ
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™


181 ? 
Index
 % (
D”ived1
::
CŞsAtCompeTime
)

182 : 
Index
 / 
D”ived1
::
RowsAtCompeTime
,

183 
	mSrcAlignm’t
 = 
ei_assign_Œa™s
<
D”ived1
,
	mD”ived2
>::
SrcAlignm’t


186 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

188 
	md¡
.
‹m¶©e
 
	mcİyPack‘
<
	mD”ived2
, 
	mAligÃd
, 
	mSrcAlignm’t
>(
	mrow
, 
	mcŞ
, 
	m¤c
);

189 
	mei_assign_šÃrvec_Com¶‘eUÄŞlšg
<
	mD”ived1
, 
	mD”ived2
,

190 
	mIndex
+
	mei_·ck‘_Œa™s
<
ty³Çme
 
	mD”ived1
::
SÿÏr
>::
size
, 
	mStİ
>::
run
(
d¡
, 
¤c
);

194 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gStİ
>

195 
	gei_assign_šÃrvec_Com¶‘eUÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 
	gStİ
, Stop>

197 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &, cÚ¡ 
D”ived2
 &) {}

200 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gIndex
, 
	gStİ
>

201 
	sei_assign_šÃrvec_IÂ”UÄŞlšg


203 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
, 
row_Ü_cŞ
)

205 cÚ¡ 
	mrow
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™
 ? 
row_Ü_cŞ
 : 
Index
;

206 cÚ¡ 
	mcŞ
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™
 ? 
Index
 : 
row_Ü_cŞ
;

207 
	md¡
.
‹m¶©e
 
	mcİyPack‘
<
	mD”ived2
, 
	mAligÃd
, AligÃd>(
	mrow
, 
	mcŞ
, 
	m¤c
);

208 
	mei_assign_šÃrvec_IÂ”UÄŞlšg
<
	mD”ived1
, 
	mD”ived2
,

209 
	mIndex
+
	mei_·ck‘_Œa™s
<
ty³Çme
 
	mD”ived1
::
SÿÏr
>::
size
, 
	mStİ
>::
run
(
d¡
, 
¤c
, 
row_Ü_cŞ
);

213 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gStİ
>

214 
	gei_assign_šÃrvec_IÂ”UÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 
	gStİ
, Stop>

216 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &, cÚ¡ 
D”ived2
 &, ) {}

223 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
,

224 
	gVeùÜiz©iÚ
 = 
ei_assign_Œa™s
<
D”ived1
, 
	gD”ived2
>::
VeùÜiz©iÚ
,

225 
	gUÄŞlšg
 = 
ei_assign_Œa™s
<
D”ived1
, 
	gD”ived2
>::
UÄŞlšg
>

226 
ei_assign_im¶
;

232 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

233 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gNoVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

235 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

237 cÚ¡ 
	gšÃrSize
 = 
d¡
.
šÃrSize
();

238 cÚ¡ 
	gou‹rSize
 = 
d¡
.
ou‹rSize
();

239 
	gj
 = 0; j < 
	gou‹rSize
; ++j)

240 
	gi
 = 0; i < 
	gšÃrSize
; ++i)

242 if((
	gD”ived1
::
FÏgs
)&
RowMajÜB™
)

243 
d¡
.
cİyCÛff
(
j
, 
i
, 
¤c
);

245 
	gd¡
.
cİyCÛff
(
i
, 
j
, 
¤c
);

250 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

251 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gNoVeùÜiz©iÚ
, 
	gCom¶‘eUÄŞlšg
>

253 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

255 
	gei_assign_novec_Com¶‘eUÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 0, D”ived1::
SizeAtCompeTime
>

256 ::
run
(
d¡
, 
¤c
);

260 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

261 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gNoVeùÜiz©iÚ
, 
	gIÂ”UÄŞlšg
>

263 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

265 cÚ¡ 
boŞ
 
	growMajÜ
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™
;

266 cÚ¡ 
	gšÃrSize
 = 
rowMajÜ
 ? 
D”ived1
::
CŞsAtCompeTime
 : D”ived1::
RowsAtCompeTime
;

267 cÚ¡ 
	gou‹rSize
 = 
d¡
.
ou‹rSize
();

268 
	gj
 = 0; j < 
	gou‹rSize
; ++j)

269 
	gei_assign_novec_IÂ”UÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 0, 
	gšÃrSize
>

270 ::
run
(
d¡
, 
¤c
, 
j
);

278 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

279 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gIÂ”VeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

281 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

283 cÚ¡ 
	gšÃrSize
 = 
d¡
.
šÃrSize
();

284 cÚ¡ 
	gou‹rSize
 = 
d¡
.
ou‹rSize
();

285 cÚ¡ 
	g·ck‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived1
::
SÿÏr
>::
size
;

286 
	gj
 = 0; j < 
	gou‹rSize
; ++j)

287 
	gi
 = 0; i < 
	gšÃrSize
; i+=
·ck‘Size
)

289 if((
D”ived1
::
FÏgs
)&
RowMajÜB™
)

290 
d¡
.
‹m¶©e
 
cİyPack‘
<
D”ived2
, 
AligÃd
, AligÃd>(
j
, 
i
, 
¤c
);

292 
	gd¡
.
‹m¶©e
 
	gcİyPack‘
<
	gD”ived2
, 
	gAligÃd
, AligÃd>(
	gi
, 
	gj
, 
	g¤c
);

297 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

298 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gIÂ”VeùÜiz©iÚ
, 
	gCom¶‘eUÄŞlšg
>

300 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

302 
	gei_assign_šÃrvec_Com¶‘eUÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 0, D”ived1::
SizeAtCompeTime
>

303 ::
run
(
d¡
, 
¤c
);

307 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

308 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gIÂ”VeùÜiz©iÚ
, 
	gIÂ”UÄŞlšg
>

310 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

312 cÚ¡ 
boŞ
 
	growMajÜ
 = (
D”ived1
::
FÏgs
)&
RowMajÜB™
;

313 cÚ¡ 
	gšÃrSize
 = 
rowMajÜ
 ? 
D”ived1
::
CŞsAtCompeTime
 : D”ived1::
RowsAtCompeTime
;

314 cÚ¡ 
	gou‹rSize
 = 
d¡
.
ou‹rSize
();

315 
	gj
 = 0; j < 
	gou‹rSize
; ++j)

316 
	gei_assign_šÃrvec_IÂ”UÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 0, 
	gšÃrSize
>

317 ::
run
(
d¡
, 
¤c
, 
j
);

325 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

326 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gLš—rVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

328 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

330 cÚ¡ 
	gsize
 = 
d¡
.
size
();

331 cÚ¡ 
	g·ck‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived1
::
SÿÏr
>::
size
;

332 cÚ¡ 
	g®igÃdS¹
 = 
ei_assign_Œa™s
<
D”ived1
,
	gD”ived2
>::
D¡IsAligÃd
 ? 0

333 : 
ei_®ignm’tOff£t
(&
d¡
.
cÛffRef
(0), 
size
);

334 cÚ¡ 
	g®igÃdEnd
 = 
®igÃdS¹
 + ((
size
-®igÃdS¹)/
·ck‘Size
)*packetSize;

336 
	gšdex
 = 0; index < 
	g®igÃdS¹
; ++index)

337 
	gd¡
.
cİyCÛff
(
šdex
, 
¤c
);

339 
	gšdex
 = 
®igÃdS¹
; index < 
	g®igÃdEnd
; index +ğ
·ck‘Size
)

341 
d¡
.
‹m¶©e
 
cİyPack‘
<
D”ived2
, 
AligÃd
, 
ei_assign_Œa™s
<
D”ived1
,D”ived2>::
SrcAlignm’t
>(
šdex
, 
¤c
);

344 
	gšdex
 = 
®igÃdEnd
; index < 
	gsize
; ++index)

345 
	gd¡
.
cİyCÛff
(
šdex
, 
¤c
);

349 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

350 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gLš—rVeùÜiz©iÚ
, 
	gCom¶‘eUÄŞlšg
>

352 
EIGEN_STRONG_INLINE
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

354 cÚ¡ 
	gsize
 = 
D”ived1
::
SizeAtCompeTime
;

355 cÚ¡ 
	g·ck‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived1
::
SÿÏr
>::
size
;

356 cÚ¡ 
	g®igÃdSize
 = (
size
/
·ck‘Size
)*packetSize;

358 
	gei_assign_šÃrvec_Com¶‘eUÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 0, 
	g®igÃdSize
>::
run
(
d¡
, 
¤c
);

359 
	gei_assign_novec_Com¶‘eUÄŞlšg
<
	gD”ived1
, 
	gD”ived2
, 
	g®igÃdSize
, 
	gsize
>::
run
(
d¡
, 
¤c
);

367 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

368 
	gei_assign_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gSliûVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

370 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

372 cÚ¡ 
	g·ck‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived1
::
SÿÏr
>::
size
;

373 cÚ¡ 
	g·ck‘AligÃdMask
 = 
·ck‘Size
 - 1;

374 cÚ¡ 
	gšÃrSize
 = 
d¡
.
šÃrSize
();

375 cÚ¡ 
	gou‹rSize
 = 
d¡
.
ou‹rSize
();

376 cÚ¡ 
	g®igÃdS‹p
 = (
·ck‘Size
 - 
d¡
.
¡ride
(è%…ack‘Sizeè& 
·ck‘AligÃdMask
;

377 
	g®igÃdS¹
 = 
ei_assign_Œa™s
<
D”ived1
,
	gD”ived2
>::
D¡IsAligÃd
 ? 0

378 : 
ei_®ignm’tOff£t
(&
d¡
.
cÛffRef
(0,0), 
šÃrSize
);

380 
	gi
 = 0; i < 
	gou‹rSize
; ++i)

382 cÚ¡ 
	g®igÃdEnd
 = 
®igÃdS¹
 + ((
šÃrSize
-®igÃdS¹è& ~
·ck‘AligÃdMask
);

385 
	gšdex
 = 0; index<
	g®igÃdS¹
 ; ++index)

387 if(
	gD”ived1
::
FÏgs
&
RowMajÜB™
)

388 
d¡
.
cİyCÛff
(
i
, 
šdex
, 
¤c
);

390 
	gd¡
.
cİyCÛff
(
šdex
, 
i
, 
¤c
);

394 
	gšdex
 = 
®igÃdS¹
; index<
	g®igÃdEnd
; index+=
·ck‘Size
)

396 if(
D”ived1
::
FÏgs
&
RowMajÜB™
)

397 
d¡
.
‹m¶©e
 
cİyPack‘
<
D”ived2
, 
AligÃd
, 
UÇligÃd
>(
i
, 
šdex
, 
¤c
);

399 
	gd¡
.
‹m¶©e
 
	gcİyPack‘
<
	gD”ived2
, 
	gAligÃd
, 
	gUÇligÃd
>(
	gšdex
, 
	gi
, 
	g¤c
);

403 
	gšdex
 = 
®igÃdEnd
; index<
	gšÃrSize
 ; ++index)

405 if(
	gD”ived1
::
FÏgs
&
RowMajÜB™
)

406 
d¡
.
cİyCÛff
(
i
, 
šdex
, 
¤c
);

408 
	gd¡
.
cİyCÛff
(
šdex
, 
i
, 
¤c
);

411 
	g®igÃdS¹
 = 
¡d
::
mš
<>((
®igÃdS¹
+
®igÃdS‹p
)%
·ck‘Size
, 
	gšÃrSize
);

420 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

421 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

422 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gM©rixBa£
<Derived>

423 ::
ÏzyAssign
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

425 #ifdeà
EIGEN_DEBUG_ASSIGN


426 
ei_assign_Œa™s
<
D”ived
, 
	gOth”D”ived
>::
debug
();

428 
EIGEN_STATIC_ASSERT_SAME_MATRIX_SIZE
(
D”ived
,
Oth”D”ived
)

429 
EIGEN_STATIC_ASSERT
((
ei_is_§me_ty³
<
ty³Çme
 
D”ived
::
SÿÏr
,y³Çm
Oth”D”ived
::SÿÏr>::
»t
),

430 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

431 
ei_as£¹
(
rows
(è=ğ
Ùh”
.rows(è&& 
cŞs
() == other.cols());

432 
	gei_assign_im¶
<
	gD”ived
, 
	gOth”D”ived
>::
run
(
d”ived
(),
Ùh”
.derived());

433  
d”ived
();

436 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
,

437 
boŞ
 
	gEv®BefÜeAssignšg
 = ((
Oth”D”ived
::
FÏgs
è& 
Ev®BefÜeAssignšgB™
) != 0,

438 
boŞ
 
	gN“dToT¿n¥o£
 = 
D”ived
::
IsVeùÜAtCompeTime


439 && 
Oth”D”ived
::
IsVeùÜAtCompeTime


440 && (
D”ived
::
RowsAtCompeTime
è=ğ(
Oth”D”ived
::
CŞsAtCompeTime
)

441 && (
D”ived
::
CŞsAtCompeTime
è=ğ(
Oth”D”ived
::
RowsAtCompeTime
)

442 && (
D”ived
::
SizeAtCompeTime
) != 1>

443 
ei_assign_£ËùÜ
;

445 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

446 
	gei_assign_£ËùÜ
<
	gD”ived
,
	gOth”D”ived
,
	gçl£
,false> {

447 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
run
(
D”ived
& 
d¡
, cÚ¡ 
Oth”D”ived
& 
Ùh”
è{  
	gd¡
.
ÏzyAssign
(Ùh”.
d”ived
()); }

449 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

450 
	gei_assign_£ËùÜ
<
	gD”ived
,
	gOth”D”ived
,
	gŒue
,
	gçl£
> {

451 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
run
(
D”ived
& 
d¡
, cÚ¡ 
Oth”D”ived
& 
Ùh”
è{  
	gd¡
.
ÏzyAssign
(Ùh”.
ev®
()); }

453 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

454 
	gei_assign_£ËùÜ
<
	gD”ived
,
	gOth”D”ived
,
	gçl£
,
	gŒue
> {

455 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
run
(
D”ived
& 
d¡
, cÚ¡ 
Oth”D”ived
& 
Ùh”
è{  
	gd¡
.
ÏzyAssign
(Ùh”.
Œª¥o£
()); }

457 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

458 
	gei_assign_£ËùÜ
<
	gD”ived
,
	gOth”D”ived
,
	gŒue
,true> {

459 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
run
(
D”ived
& 
d¡
, cÚ¡ 
Oth”D”ived
& 
Ùh”
è{  
	gd¡
.
ÏzyAssign
(Ùh”.
Œª¥o£
().
ev®
()); }

462 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

463 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

464 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gM©rixBa£
<Derived>

465 ::
İ”©Ü
=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

467  
ei_assign_£ËùÜ
<
D”ived
,
Oth”D”ived
>::
run
(
d”ived
(), 
Ùh”
.derived());

	@robot/Eigen/src/Core/Block.h

26 #iâdeà
EIGEN_BLOCK_H


27 
	#EIGEN_BLOCK_H


	)

65 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBlockRows
, 
	gBlockCŞs
, 
	g_Pack‘Acûss
, 
	g_DœeùAcûssStus
>

66 
	gei_Œa™s
<
	gBlock
<
	gM©rixTy³
, 
	gBlockRows
, 
	gBlockCŞs
, 
	g_Pack‘Acûss
, 
	g_DœeùAcûssStus
> >

68 
ty³Çme
 
	tei_Œa™s
<
	tM©rixTy³
>::
	tSÿÏr
 Scalar;

69 
ty³Çme
 
	tei_Ã¡ed
<
	tM©rixTy³
>::
	tty³
 
	tM©rixTy³Ne¡ed
;

70 
ty³Çme
 
	tei_uÄef
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

72 
	gRowsAtCompeTime
 = 
ei_Œa™s
<
M©rixTy³
>::
RowsAtCompeTime
 =ğ1 ? 1 : 
BlockRows
,

73 
	gCŞsAtCompeTime
 = 
ei_Œa™s
<
M©rixTy³
>::
CŞsAtCompeTime
 =ğ1 ? 1 : 
BlockCŞs
,

74 
	gMaxRowsAtCompeTime
 = 
RowsAtCompeTime
 == 1 ? 1

75 : (
BlockRows
==
DyÇmic
 ? (
ei_Œa™s
<
M©rixTy³
>::
MaxRowsAtCompeTime
) : BlockRows),

76 
	gMaxCŞsAtCompeTime
 = 
CŞsAtCompeTime
 == 1 ? 1

77 : (
BlockCŞs
==
DyÇmic
 ? (
ei_Œa™s
<
M©rixTy³
>::
MaxCŞsAtCompeTime
) : BlockCols),

78 
	gRowMajÜ
 = (
ei_Œa™s
<
M©rixTy³
>::
FÏgs
)&
RowMajÜB™
,

79 
	gIÂ”Size
 = 
RowMajÜ
 ? (
CŞsAtCompeTime
è: (
RowsAtCompeTime
),

80 
	gIÂ”MaxSize
 = 
RowMajÜ
 ? (
MaxCŞsAtCompeTime
è: (
MaxRowsAtCompeTime
),

81 
	gMaskPack‘AcûssB™
 = (
IÂ”MaxSize
 =ğ
DyÇmic
 || (
IÂ”Size
 >ğ
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
))

82 ? 
Pack‘AcûssB™
 : 0,

83 
	gFÏgsLš—rAcûssB™
 = (
RowsAtCompeTime
 =ğ1 || 
CŞsAtCompeTime
 =ğ1è? 
Lš—rAcûssB™
 : 0,

84 
	gFÏgs
 = (
ei_Œa™s
<
M©rixTy³
>::
FÏgs
 & (
H”ed™¬yB™s
 | 
MaskPack‘AcûssB™
 | 
DœeùAcûssB™
)è| 
FÏgsLš—rAcûssB™
,

85 
	gCÛffR—dCo¡
 = 
ei_Œa™s
<
M©rixTy³
>::
CÛffR—dCo¡
,

86 
	gPack‘Acûss
 = 
_Pack‘Acûss


88 
ty³Çme
 
	tei_m‘a_if
<(
	tPack‘Acûss
)==
	tFÜûAligÃd
,

89 
	tBlock
<
	tM©rixTy³
, 
	tBlockRows
, 
	tBlockCŞs
, 
	t_Pack‘Acûss
, 
	t_DœeùAcûssStus
>&,

90 
	tBlock
<
	tM©rixTy³
, 
	tBlockRows
, 
	tBlockCŞs
, 
	tFÜûAligÃd
, 
	t_DœeùAcûssStus
> >::
	t»t
 
	tAligÃdD”ivedTy³
;

93 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBlockRows
, 
	gBlockCŞs
, 
	gPack‘Acûss
, 
	g_DœeùAcûssStus
> 
şass
 
	gBlock


94 : 
public
 
M©rixBa£
<
Block
<
M©rixTy³
, 
	gBlockRows
, 
	gBlockCŞs
, 
	gPack‘Acûss
, 
	g_DœeùAcûssStus
> >

96 
	gpublic
:

98 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Block
)

100 
şass
 
IÂ”I‹¿tÜ
;

104 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
i
)

105 : 
m_m©rix
(
m©rix
),

110 
m_¡¬tRow
Ğ(
BlockRows
==1è&& (
BlockCŞs
==
M©rixTy³
::
CŞsAtCompeTime
è? 
i
 : 0),

111 
m_¡¬tCŞ
Ğ(
BlockRows
==
M©rixTy³
::
RowsAtCompeTime
è&& (
BlockCŞs
==1è? 
i
 : 0),

112 
m_blockRows
(
m©rix
.
rows
()),

113 
m_blockCŞs
(
m©rix
.
cŞs
())

115 
ei_as£¹
Ğ(
i
>=0) && (

116 ((
BlockRows
==1è&& (
BlockCŞs
==
M©rixTy³
::
CŞsAtCompeTime
è&& 
i
<
m©rix
.
rows
())

117 ||((
BlockRows
==
M©rixTy³
::
RowsAtCompeTime
è&& (
BlockCŞs
==1è&& 
i
<
m©rix
.
cŞs
())));

122 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
¡¬tRow
, 
¡¬tCŞ
)

123 : 
m_m©rix
(
m©rix
), 
m_¡¬tRow
(
¡¬tRow
), 
m_¡¬tCŞ
(
¡¬tCŞ
),

124 
m_blockRows
(
m©rix
.
rows
()), 
m_blockCŞs
(m©rix.
cŞs
())

126 
EIGEN_STATIC_ASSERT
(
RowsAtCompeTime
!=
DyÇmic
 && 
CŞsAtCompeTime
!=DyÇmic,
THIS_METHOD_IS_ONLY_FOR_FIXED_SIZE
)

127 
ei_as£¹
(
¡¬tRow
 >ğ0 && 
BlockRows
 >ğ1 && s¹Row + BlockRow <ğ
m©rix
.
rows
()

128 && 
¡¬tCŞ
 >ğ0 && 
BlockCŞs
 >ğ1 && s¹CŞ + BlockCŞ <ğ
m©rix
.
cŞs
());

133 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
,

134 
¡¬tRow
, 
¡¬tCŞ
,

135 
blockRows
, 
blockCŞs
)

136 : 
m_m©rix
(
m©rix
), 
m_¡¬tRow
(
¡¬tRow
), 
m_¡¬tCŞ
(
¡¬tCŞ
),

137 
m_blockRows
(
blockRows
), 
m_blockCŞs
(
blockCŞs
)

139 
ei_as£¹
((
RowsAtCompeTime
==
DyÇmic
 || RowsAtCompeTime==
blockRows
)

140 && (
CŞsAtCompeTime
==
DyÇmic
 || CŞsAtCompeTime==
blockCŞs
));

141 
ei_as£¹
(
¡¬tRow
 >ğ0 && 
blockRows
 >ğ1 && s¹Row + blockRow <ğ
m©rix
.
rows
()

142 && 
¡¬tCŞ
 >ğ0 && 
blockCŞs
 >ğ1 && s¹CŞ + blockCŞ <ğ
m©rix
.
cŞs
());

145 
EIGEN_INHERIT_ASSIGNMENT_OPERATORS
(
Block
)

147 
šlše
 
rows
(ècÚ¡ {  
	gm_blockRows
.
v®ue
(); }

148 
šlše
 
cŞs
(ècÚ¡ {  
	gm_blockCŞs
.
v®ue
(); }

150 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

152  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
()

153 .
cÛffRef
(
row
 + 
m_¡¬tRow
.
v®ue
(), 
cŞ
 + 
m_¡¬tCŞ
.value());

156 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

158  
	gm_m©rix
.
cÛff
(
row
 + 
m_¡¬tRow
.
v®ue
(), 
cŞ
 + 
m_¡¬tCŞ
.value());

161 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

163  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
()

164 .
cÛffRef
(
m_¡¬tRow
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 0 : 
šdex
),

165 
m_¡¬tCŞ
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 
šdex
 : 0));

168 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

170  
	gm_m©rix


171 .
cÛff
(
m_¡¬tRow
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 0 : 
šdex
),

172 
m_¡¬tCŞ
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 
šdex
 : 0));

175 
	g‹m¶©e
<
	gLßdMode
>

176 
šlše
 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

178  
	gm_m©rix
.
‹m¶©e
 
	g·ck‘
<
	gUÇligÃd
>

179 (
	grow
 + 
	gm_¡¬tRow
.
v®ue
(), 
	gcŞ
 + 
	gm_¡¬tCŞ
.value());

182 
	g‹m¶©e
<
	gLßdMode
>

183 
šlše
 
wr™ePack‘
(
row
, 
cŞ
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

185 
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gUÇligÃd
>

186 (
	grow
 + 
	gm_¡¬tRow
.
v®ue
(), 
	gcŞ
 + 
	gm_¡¬tCŞ
.v®ue(), 
	gx
);

189 
	g‹m¶©e
<
	gLßdMode
>

190 
šlše
 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

192  
	gm_m©rix
.
‹m¶©e
 
	g·ck‘
<
	gUÇligÃd
>

193 (
	gm_¡¬tRow
.
v®ue
(è+ (
	gRowsAtCompeTime
 =ğ1 ? 0 : 
šdex
),

194 
	gm_¡¬tCŞ
.
v®ue
(è+ (
	gRowsAtCompeTime
 =ğ1 ? 
šdex
 : 0));

197 
	g‹m¶©e
<
	gLßdMode
>

198 
šlše
 
wr™ePack‘
(
šdex
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

200 
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gUÇligÃd
>

201 (
	gm_¡¬tRow
.
v®ue
(è+ (
	gRowsAtCompeTime
 =ğ1 ? 0 : 
šdex
),

202 
	gm_¡¬tCŞ
.
v®ue
(è+ (
	gRowsAtCompeTime
 =ğ1 ? 
šdex
 : 0), 
	gx
);

205 
	g´Ùeùed
:

207 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

208 cÚ¡ 
	gei_št_if_dyÇmic
<
	gM©rixTy³
::
RowsAtCompeTime
 =ğ1 ? 0 : 
DyÇmic
> 
m_¡¬tRow
;

209 cÚ¡ 
	gei_št_if_dyÇmic
<
	gM©rixTy³
::
CŞsAtCompeTime
 =ğ1 ? 0 : 
DyÇmic
> 
m_¡¬tCŞ
;

210 cÚ¡ 
	gei_št_if_dyÇmic
<
	gRowsAtCompeTime
> 
	gm_blockRows
;

211 cÚ¡ 
	gei_št_if_dyÇmic
<
	gCŞsAtCompeTime
> 
	gm_blockCŞs
;

215 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBlockRows
, 
	gBlockCŞs
, 
	gPack‘Acûss
>

216 
şass
 
	gBlock
<
	gM©rixTy³
,
	gBlockRows
,
	gBlockCŞs
,
	gPack‘Acûss
,
	gHasDœeùAcûss
>

217 : 
public
 
M­Ba£
<
Block
<
M©rixTy³
, 
	gBlockRows
, 
	gBlockCŞs
,
	gPack‘Acûss
,
	gHasDœeùAcûss
> >

219 
	gpublic
:

221 
_EIGEN_GENERIC_PUBLIC_INTERFACE
(
Block
, 
M­Ba£
<Block>)

223 
şass
 
	gIÂ”I‹¿tÜ
;

224 
ty³Çme
 
	tei_Œa™s
<
	tBlock
>::
	tAligÃdD”ivedTy³
 AlignedDerivedType;

225 
ä›nd
 
şass
 
	gBlock
<
	gM©rixTy³
,
	gBlockRows
,
	gBlockCŞs
,
	gPack‘Acûss
==(
AsReque¡ed
)?
FÜûAligÃd
:AsReque¡ed,
	gHasDœeùAcûss
>;

227 
EIGEN_INHERIT_ASSIGNMENT_OPERATORS
(
Block
)

229 
AligÃdD”ivedTy³
 
_cÚv”tToFÜûAligÃd
()

231  
	gBlock
<
	gM©rixTy³
,
	gBlockRows
,
	gBlockCŞs
,
	gFÜûAligÃd
,
	gHasDœeùAcûss
>

232 (
	gm_m©rix
, 
	gBa£
::
m_d©a
, Ba£::
m_rows
.
v®ue
(), Ba£::
m_cŞs
.value());

237 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
i
)

238 : 
Ba£
(&
m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(

239 (
BlockRows
==1è&& (
BlockCŞs
==
M©rixTy³
::
CŞsAtCompeTime
è? 
i
 : 0,

240 (
BlockRows
==
M©rixTy³
::
RowsAtCompeTime
è&& (
BlockCŞs
==1è? 
i
 : 0),

241 
BlockRows
==1 ? 1 : 
m©rix
.
rows
(),

242 
BlockCŞs
==1 ? 1 : 
m©rix
.
cŞs
()),

243 
m_m©rix
(
m©rix
)

245 
ei_as£¹
Ğ(
i
>=0) && (

246 ((
BlockRows
==1è&& (
BlockCŞs
==
M©rixTy³
::
CŞsAtCompeTime
è&& 
i
<
m©rix
.
rows
())

247 ||((
BlockRows
==
M©rixTy³
::
RowsAtCompeTime
è&& (
BlockCŞs
==1è&& 
i
<
m©rix
.
cŞs
())));

252 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
¡¬tRow
, 
¡¬tCŞ
)

253 : 
Ba£
(&
m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
¡¬tRow
,
¡¬tCŞ
)), 
m_m©rix
(matrix)

255 
ei_as£¹
(
¡¬tRow
 >ğ0 && 
BlockRows
 >ğ1 && s¹Row + BlockRow <ğ
m©rix
.
rows
()

256 && 
¡¬tCŞ
 >ğ0 && 
BlockCŞs
 >ğ1 && s¹CŞ + BlockCŞ <ğ
m©rix
.
cŞs
());

261 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
,

262 
¡¬tRow
, 
¡¬tCŞ
,

263 
blockRows
, 
blockCŞs
)

264 : 
Ba£
(&
m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
¡¬tRow
,
¡¬tCŞ
), 
blockRows
, 
blockCŞs
),

265 
m_m©rix
(
m©rix
)

267 
ei_as£¹
((
RowsAtCompeTime
==
DyÇmic
 || RowsAtCompeTime==
blockRows
)

268 && (
CŞsAtCompeTime
==
DyÇmic
 || CŞsAtCompeTime==
blockCŞs
));

269 
ei_as£¹
(
¡¬tRow
 >ğ0 && 
blockRows
 >ğ1 && s¹Row + blockRow <ğ
m©rix
.
rows
()

270 && 
¡¬tCŞ
 >ğ0 && 
blockCŞs
 >ğ1 && s¹CŞ + blockCŞ <ğ
m©rix
.
cŞs
());

273 
šlše
 
¡ride
(ècÚ¡ {  
	gm_m©rix
.stride(); }

275 
	g´Ùeùed
:

278 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
, cÚ¡ 
SÿÏr
* 
d©a
, 
blockRows
, 
blockCŞs
)

279 : 
Ba£
(
d©a
, 
blockRows
, 
blockCŞs
), 
m_m©rix
(
m©rix
)

282 cÚ¡ 
ty³Çme
 
	gM©rixTy³
::
Ne¡ed
 
m_m©rix
;

303 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

304 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
>::
Ty³
 
M©rixBa£
<
D”ived
>

305 ::
	$block
(
¡¬tRow
, 
¡¬tCŞ
, 
blockRows
, 
blockCŞs
)

307  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 
¡¬tRow
, 
¡¬tCŞ
, 
blockRows
, 
blockCŞs
);

308 
	}
}

311 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

312 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
>::
Ty³
 
M©rixBa£
<
D”ived
>

313 ::
	$block
(
¡¬tRow
, 
¡¬tCŞ
, 
blockRows
, 
blockCŞs
) const

315  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 
¡¬tRow
, 
¡¬tCŞ
, 
blockRows
, 
blockCŞs
);

316 
	}
}

336 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

337 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
>::
SubVeùÜTy³
 
M©rixBa£
<
D”ived
>

338 ::
	$£gm’t
(
¡¬t
, 
size
)

340 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

341  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`SubVeùÜTy³
(
	`d”ived
(), 
RowsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
,

342 
CŞsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
,

343 
RowsAtCompeTime
 =ğ1 ? 1 : 
size
,

344 
CŞsAtCompeTime
 =ğ1 ? 1 : 
size
);

345 
	}
}

348 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

349 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
>::
SubVeùÜTy³


350 
M©rixBa£
<
D”ived
>::
	$£gm’t
(
¡¬t
, 
size
) const

352 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

353  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`SubVeùÜTy³
(
	`d”ived
(), 
RowsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
,

354 
CŞsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
,

355 
RowsAtCompeTime
 =ğ1 ? 1 : 
size
,

356 
CŞsAtCompeTime
 =ğ1 ? 1 : 
size
);

357 
	}
}

376 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

377 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gDyÇmic
>::
SubVeùÜTy³


378 
M©rixBa£
<
D”ived
>::
	$¡¬t
(
size
)

380 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

381  
Block
<
D”ived
,

382 
RowsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
,

383 
CŞsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
>

384 (
	`d”ived
(), 0, 0,

385 
RowsAtCompeTime
 =ğ1 ? 1 : 
size
,

386 
CŞsAtCompeTime
 =ğ1 ? 1 : 
size
);

387 
	}
}

390 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

391 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gDyÇmic
>::
SubVeùÜTy³


392 
M©rixBa£
<
D”ived
>::
	$¡¬t
(
size
) const

394 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

395  
Block
<
D”ived
,

396 
RowsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
,

397 
CŞsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
>

398 (
	`d”ived
(), 0, 0,

399 
RowsAtCompeTime
 =ğ1 ? 1 : 
size
,

400 
CŞsAtCompeTime
 =ğ1 ? 1 : 
size
);

401 
	}
}

420 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

421 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gDyÇmic
>::
SubVeùÜTy³


422 
M©rixBa£
<
D”ived
>::
	$’d
(
size
)

424 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

425  
Block
<
D”ived
,

426 
RowsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
,

427 
CŞsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
>

428 (
	`d”ived
(),

429 
RowsAtCompeTime
 =ğ1 ? 0 : 
	`rows
(è- 
size
,

430 
CŞsAtCompeTime
 =ğ1 ? 0 : 
	`cŞs
(è- 
size
,

431 
RowsAtCompeTime
 =ğ1 ? 1 : 
size
,

432 
CŞsAtCompeTime
 =ğ1 ? 1 : 
size
);

433 
	}
}

436 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

437 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gDyÇmic
>::
SubVeùÜTy³


438 
M©rixBa£
<
D”ived
>::
	$’d
(
size
) const

440 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

441  
Block
<
D”ived
,

442 
RowsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
,

443 
CŞsAtCompeTime
 =ğ1 ? 1 : 
DyÇmic
>

444 (
	`d”ived
(),

445 
RowsAtCompeTime
 =ğ1 ? 0 : 
	`rows
(è- 
size
,

446 
CŞsAtCompeTime
 =ğ1 ? 0 : 
	`cŞs
(è- 
size
,

447 
RowsAtCompeTime
 =ğ1 ? 1 : 
size
,

448 
CŞsAtCompeTime
 =ğ1 ? 1 : 
size
);

449 
	}
}

464 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

465 
	g‹m¶©e
<
	gSize
>

466 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gSize
>::
SubVeùÜTy³


467 
M©rixBa£
<
D”ived
>::
	$£gm’t
(
¡¬t
)

469 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

470  
Block
<
D”ived
, (
RowsAtCompeTime
 =ğ1 ? 1 : 
Size
),

471 (
CŞsAtCompeTime
 =ğ1 ? 1 : 
Size
)>

472 (
	`d”ived
(), 
RowsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
,

473 
CŞsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
);

474 
	}
}

477 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

478 
	g‹m¶©e
<
	gSize
>

479 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gSize
>::
SubVeùÜTy³


480 
M©rixBa£
<
D”ived
>::
	$£gm’t
(
¡¬t
) const

482 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

483  
Block
<
D”ived
, (
RowsAtCompeTime
 =ğ1 ? 1 : 
Size
),

484 (
CŞsAtCompeTime
 =ğ1 ? 1 : 
Size
)>

485 (
	`d”ived
(), 
RowsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
,

486 
CŞsAtCompeTime
 =ğ1 ? 0 : 
¡¬t
);

487 
	}
}

502 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

503 
	g‹m¶©e
<
	gSize
>

504 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gSize
>::
SubVeùÜTy³


505 
M©rixBa£
<
D”ived
>::
	$¡¬t
()

507 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

508  
Block
<
D”ived
, (
RowsAtCompeTime
 =ğ1 ? 1 : 
Size
),

509 (
CŞsAtCompeTime
 =ğ1 ? 1 : 
Size
)>(
	`d”ived
(), 0, 0);

510 
	}
}

513 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

514 
	g‹m¶©e
<
	gSize
>

515 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gSize
>::
SubVeùÜTy³


516 
M©rixBa£
<
D”ived
>::
	$¡¬t
() const

518 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

519  
Block
<
D”ived
, (
RowsAtCompeTime
 =ğ1 ? 1 : 
Size
),

520 (
CŞsAtCompeTime
 =ğ1 ? 1 : 
Size
)>(
	`d”ived
(), 0, 0);

521 
	}
}

534 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

535 
	g‹m¶©e
<
	gSize
>

536 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gSize
>::
SubVeùÜTy³


537 
M©rixBa£
<
D”ived
>::
	$’d
()

539 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

540  
Block
<
D”ived
, 
RowsAtCompeTime
 =ğ1 ? 1 : 
Size
,

541 
CŞsAtCompeTime
 =ğ1 ? 1 : 
Size
>

542 (
	`d”ived
(),

543 
RowsAtCompeTime
 =ğ1 ? 0 : 
	`rows
(è- 
Size
,

544 
CŞsAtCompeTime
 =ğ1 ? 0 : 
	`cŞs
(è- 
Size
);

545 
	}
}

548 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

549 
	g‹m¶©e
<
	gSize
>

550 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
,
	gSize
>::
SubVeùÜTy³


551 
M©rixBa£
<
D”ived
>::
	$’d
() const

553 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

554  
Block
<
D”ived
, 
RowsAtCompeTime
 =ğ1 ? 1 : 
Size
,

555 
CŞsAtCompeTime
 =ğ1 ? 1 : 
Size
>

556 (
	`d”ived
(),

557 
RowsAtCompeTime
 =ğ1 ? 0 : 
	`rows
(è- 
Size
,

558 
CŞsAtCompeTime
 =ğ1 ? 0 : 
	`cŞs
(è- 
Size
);

559 
	}
}

579 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

580 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
>::
Ty³
 
M©rixBa£
<
D”ived
>

581 ::
	$cÜÃr
(
CÜÃrTy³
 
ty³
, 
cRows
, 
cCŞs
)

583 
ty³
)

586 
	`ei_as£¹
(
çl£
 && "Bad cornerype.");

587 
TİLeá
:

588  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 0, 0, 
cRows
, 
cCŞs
);

589 
TİRight
:

590  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 0, 
	`cŞs
(è- 
cCŞs
, 
cRows
, cCols);

591 
BÙtomLeá
:

592  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 
	`rows
(è- 
cRows
, 0, cRows, 
cCŞs
);

593 
BÙtomRight
:

594  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 
	`rows
(è- 
cRows
, 
	`cŞs
(è- 
cCŞs
, cRows, cCols);

596 
	}
}

599 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

600 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
>::
Ty³


601 
M©rixBa£
<
D”ived
>::
	$cÜÃr
(
CÜÃrTy³
 
ty³
, 
cRows
, 
cCŞs
) const

603 
ty³
)

606 
	`ei_as£¹
(
çl£
 && "Bad cornerype.");

607 
TİLeá
:

608  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 0, 0, 
cRows
, 
cCŞs
);

609 
TİRight
:

610  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 0, 
	`cŞs
(è- 
cCŞs
, 
cRows
, cCols);

611 
BÙtomLeá
:

612  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 
	`rows
(è- 
cRows
, 0, cRows, 
cCŞs
);

613 
BÙtomRight
:

614  
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
	`Ty³
(
	`d”ived
(), 
	`rows
(è- 
cRows
, 
	`cŞs
(è- 
cCŞs
, cRows, cCols);

616 
	}
}

630 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

631 
	g‹m¶©e
<
	gCRows
, 
	gCCŞs
>

632 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
, 
	gCRows
, 
	gCCŞs
>::
Ty³


633 
M©rixBa£
<
D”ived
>::
	$cÜÃr
(
CÜÃrTy³
 
ty³
)

635 
ty³
)

638 
	`ei_as£¹
(
çl£
 && "Bad cornerype.");

639 
TİLeá
:

640  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 0, 0);

641 
TİRight
:

642  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 0, 
	`cŞs
() - CCols);

643 
BÙtomLeá
:

644  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 
	`rows
() - CRows, 0);

645 
BÙtomRight
:

646  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 
	`rows
(è- CRows, 
	`cŞs
() - CCols);

648 
	}
}

651 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

652 
	g‹m¶©e
<
	gCRows
, 
	gCCŞs
>

653 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
, 
	gCRows
, 
	gCCŞs
>::
Ty³


654 
M©rixBa£
<
D”ived
>::
	$cÜÃr
(
CÜÃrTy³
 
ty³
) const

656 
ty³
)

659 
	`ei_as£¹
(
çl£
 && "Bad cornerype.");

660 
TİLeá
:

661  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 0, 0);

662 
TİRight
:

663  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 0, 
	`cŞs
() - CCols);

664 
BÙtomLeá
:

665  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 
	`rows
() - CRows, 0);

666 
BÙtomRight
:

667  
Block
<
D”ived
, 
CRows
, 
CCŞs
>(
	`d”ived
(), 
	`rows
(è- CRows, 
	`cŞs
() - CCols);

669 
	}
}

689 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

690 
	g‹m¶©e
<
	gBlockRows
, 
	gBlockCŞs
>

691 
šlše
 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
, 
	gBlockRows
, 
	gBlockCŞs
>::
Ty³


692 
M©rixBa£
<
D”ived
>::
	$block
(
¡¬tRow
, 
¡¬tCŞ
)

694  
Block
<
D”ived
, 
BlockRows
, 
BlockCŞs
>(
	`d”ived
(), 
¡¬tRow
, 
¡¬tCŞ
);

695 
	}
}

698 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

699 
	g‹m¶©e
<
	gBlockRows
, 
	gBlockCŞs
>

700 
šlše
 cÚ¡ 
ty³Çme
 
	gBlockR‘uºTy³
<
	gD”ived
, 
	gBlockRows
, 
	gBlockCŞs
>::
Ty³


701 
M©rixBa£
<
D”ived
>::
	$block
(
¡¬tRow
, 
¡¬tCŞ
) const

703  
Block
<
D”ived
, 
BlockRows
, 
BlockCŞs
>(
	`d”ived
(), 
¡¬tRow
, 
¡¬tCŞ
);

704 
	}
}

714 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

715 
šlše
 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CŞX´


716 
M©rixBa£
<
D”ived
>::
	$cŞ
(
i
)

718  
	`CŞX´
(
	`d”ived
(), 
i
);

719 
	}
}

722 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

723 
šlše
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CŞX´


724 
M©rixBa£
<
D”ived
>::
	$cŞ
(
i
) const

726  
	`CŞX´
(
	`d”ived
(), 
i
);

727 
	}
}

737 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

738 
šlše
 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
RowX´


739 
M©rixBa£
<
D”ived
>::
	$row
(
i
)

741  
	`RowX´
(
	`d”ived
(), 
i
);

742 
	}
}

745 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

746 
šlše
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
RowX´


747 
M©rixBa£
<
D”ived
>::
	$row
(
i
) const

749  
	`RowX´
(
	`d”ived
(), 
i
);

750 
	}
}

	@robot/Eigen/src/Core/CacheFriendlyProduct.h

25 #iâdeà
EIGEN_CACHE_FRIENDLY_PRODUCT_H


26 
	#EIGEN_CACHE_FRIENDLY_PRODUCT_H


	)

28 
	g‹m¶©e
 <
	gL2MemÜySize
,
ty³Çme
 
	gSÿÏr
>

29 
	sei_L2_block_Œa™s
 {

30 ’um {
	mwidth
 = 8 * 
ei_m‘a_sq¹
<
L2MemÜySize
/(64*(
SÿÏr
))>::
»t
 };

33 #iâdeà
EIGEN_EXTERN_INSTANTIATIONS


35 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

36 
	$ei_ÿche_ä›ndly_´oduù
(

37 
_rows
, 
_cŞs
, 
d•th
,

38 
boŞ
 
_lhsRowMajÜ
, cÚ¡ 
SÿÏr
* 
_lhs
, 
_lhsSŒide
,

39 
boŞ
 
_rhsRowMajÜ
, cÚ¡ 
SÿÏr
* 
_rhs
, 
_rhsSŒide
,

40 
boŞ
 
»sRowMajÜ
, 
SÿÏr
* 
»s
, 
»sSŒide
)

42 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
lhs
;

43 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
rhs
;

44 
lhsSŒide
, 
rhsSŒide
, 
rows
, 
cŞs
;

45 
boŞ
 
lhsRowMajÜ
;

47 ià(
»sRowMajÜ
)

49 
lhs
 = 
_rhs
;

50 
rhs
 = 
_lhs
;

51 
lhsSŒide
 = 
_rhsSŒide
;

52 
rhsSŒide
 = 
_lhsSŒide
;

53 
cŞs
 = 
_rows
;

54 
rows
 = 
_cŞs
;

55 
lhsRowMajÜ
 = !
_rhsRowMajÜ
;

56 
	`ei_as£¹
(
_lhsRowMajÜ
);

60 
lhs
 = 
_lhs
;

61 
rhs
 = 
_rhs
;

62 
lhsSŒide
 = 
_lhsSŒide
;

63 
rhsSŒide
 = 
_rhsSŒide
;

64 
rows
 = 
_rows
;

65 
cŞs
 = 
_cŞs
;

66 
lhsRowMajÜ
 = 
_lhsRowMajÜ
;

67 
	`ei_as£¹
(!
_rhsRowMajÜ
);

70 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘Ty³
;

73 
Pack‘Size
 = (
Pack‘Ty³
)/(
SÿÏr
),

74 #ià(
defšed
 
__i386__
)

77 
MaxBlockRows
 = 4,

78 
MaxBlockRows_CÏmpšgMask
 = 0xFFFFFC,

80 
MaxBlockRows
 = 8,

81 
MaxBlockRows_CÏmpšgMask
 = 0xFFFFF8,

84 
MaxL2BlockSize
 = 
ei_L2_block_Œa™s
<
EIGEN_TUNE_FOR_CPU_CACHE_SIZE
,
SÿÏr
>::
width


87 cÚ¡ 
boŞ
 
»sIsAligÃd
 = (
Pack‘Size
==1è|| (((
»sSŒide
%Pack‘Sizeè=ğ0è&& (
¡d
::
	`size_t
(
»s
)%16==0));

89 cÚ¡ 
»maššgSize
 = 
d•th
 % 
Pack‘Size
;

90 cÚ¡ 
size
 = 
d•th
 - 
»maššgSize
;

91 cÚ¡ 
l2BlockRows
 = 
MaxL2BlockSize
 > 
rows
 ?„ows : MaxL2BlockSize;

92 cÚ¡ 
l2BlockCŞs
 = 
MaxL2BlockSize
 > 
cŞs
 ? cols : MaxL2BlockSize;

93 cÚ¡ 
l2BlockSize
 = 
MaxL2BlockSize
 > 
size
 ? size : MaxL2BlockSize;

94 cÚ¡ 
l2BlockSizeAligÃd
 = (1 + 
¡d
::
	`max
(
l2BlockSize
,
l2BlockCŞs
)/
Pack‘Size
)*PacketSize;

95 cÚ¡ 
boŞ
 
ÃedRhsCİy
 = (
Pack‘Size
>1è&& ((
rhsSŒide
%Pack‘Size!=0è|| (
¡d
::
	`size_t
(
rhs
)%16!=0));

96 
SÿÏr
* 
EIGEN_RESTRICT
 
block
 = 0;

97 cÚ¡ 
®locBlockSize
 = 
l2BlockRows
*
size
;

98 
block
 = 
	`ei_®igÃd_¡ack_Ãw
(
SÿÏr
, 
®locBlockSize
);

99 
SÿÏr
* 
EIGEN_RESTRICT
 
rhsCİy


100 ğ
	`ei_®igÃd_¡ack_Ãw
(
SÿÏr
, 
l2BlockSizeAligÃd
*l2BlockSizeAligned);

103 
l2i
=0;†2i<
rows
;†2i+=
l2BlockRows
)

105 cÚ¡ 
l2blockRowEnd
 = 
¡d
::
	`mš
(
l2i
+
l2BlockRows
, 
rows
);

106 cÚ¡ 
l2blockRowEndBW
 = 
l2blockRowEnd
 & 
MaxBlockRows_CÏmpšgMask
;

107 cÚ¡ 
l2blockRemaššgRows
 = 
l2blockRowEnd
 - 
l2blockRowEndBW
;

111 
couÁ
 = 0;

114 
l2k
=0;†2k<
size
;†2k+=
l2BlockSize
)

116 cÚ¡ 
l2blockSizeEnd
 = 
¡d
::
	`mš
(
l2k
+
l2BlockSize
, 
size
);

118 
i
 = 
l2i
; i<
l2blockRowEndBW
 ; i+=
MaxBlockRows
)

123 
k
=
l2k
; k<
l2blockSizeEnd
; k+=
Pack‘Size
)

127 ià(
lhsRowMajÜ
)

129 
w
=0; w<
MaxBlockRows
; ++w)

130 
s
=0; s<
Pack‘Size
; ++s)

131 
block
[
couÁ
++] = 
lhs
[(
i
+
w
)*
lhsSŒide
 + (
k
+
s
)];

135 
w
=0; w<
MaxBlockRows
; ++w)

136 
s
=0; s<
Pack‘Size
; ++s)

137 
block
[
couÁ
++] = 
lhs
[(
i
+
w
è+ (
k
+
s
)*
lhsSŒide
];

141 ià(
l2blockRemaššgRows
>0)

143 
k
=
l2k
; k<
l2blockSizeEnd
; k+=
Pack‘Size
)

145 ià(
lhsRowMajÜ
)

147 
w
=0; w<
l2blockRemaššgRows
; ++w)

148 
s
=0; s<
Pack‘Size
; ++s)

149 
block
[
couÁ
++] = 
lhs
[(
l2blockRowEndBW
+
w
)*
lhsSŒide
 + (
k
+
s
)];

153 
w
=0; w<
l2blockRemaššgRows
; ++w)

154 
s
=0; s<
Pack‘Size
; ++s)

155 
block
[
couÁ
++] = 
lhs
[(
l2blockRowEndBW
+
w
è+ (
k
+
s
)*
lhsSŒide
];

161 
l2j
=0;†2j<
cŞs
;†2j+=
l2BlockCŞs
)

163 
l2blockCŞEnd
 = 
¡d
::
	`mš
(
l2j
+
l2BlockCŞs
, 
cŞs
);

165 
l2k
=0;†2k<
size
;†2k+=
l2BlockSize
)

168 
l2blockSizeEnd
 = 
¡d
::
	`mš
(
l2k
+
l2BlockSize
, 
size
);

171 ià(
ÃedRhsCİy
)

172 
l1j
=
l2j
;†1j<
l2blockCŞEnd
;†1j+=1)

174 
	`ei_š‹º®_as£¹
(
l2BlockSizeAligÃd
*(
l1j
-
l2j
)+(
l2blockSizeEnd
-
l2k
) <†2BlockSizeAligned*l2BlockSizeAligned);

175 
¡d
::
	`memıy
(
rhsCİy
+
l2BlockSizeAligÃd
*(
l1j
-
l2j
),&(
rhs
[l1j*
rhsSŒide
+
l2k
]),(
l2blockSizeEnd
-l2k)*(
SÿÏr
));

179 
l1i
=
l2i
;†1i<
l2blockRowEndBW
;†1i+=
MaxBlockRows
)

181 
off£tblock
 = 
l2k
 * (
l2blockRowEnd
-
l2i
è+ (
l1i
-l2i)*(
l2blockSizeEnd
-l2kè-†2k*
MaxBlockRows
;

182 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
loÿlB
 = &
block
[
off£tblock
];

184 
l1j
=
l2j
;†1j<
l2blockCŞEnd
;†1j+=1)

186 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
rhsCŞumn
;

187 ià(
ÃedRhsCİy
)

188 
rhsCŞumn
 = &(
rhsCİy
[
l2BlockSizeAligÃd
*(
l1j
-
l2j
)-
l2k
]);

190 
rhsCŞumn
 = &(
rhs
[
l1j
*
rhsSŒide
]);

192 
Pack‘Ty³
 
d¡
[
MaxBlockRows
];

193 
d¡
[3] = d¡[2] = d¡[1] = d¡[0] = 
	`ei_p£t1
(
	`SÿÏr
(0.));

194 ià(
MaxBlockRows
==8)

195 
d¡
[7] = dst[6] = dst[5] = dst[4] = dst[0];

197 
Pack‘Ty³
 
tmp
;

199 
k
=
l2k
; k<
l2blockSizeEnd
; k+=
Pack‘Size
)

201 
tmp
 = 
	`ei_¶ßdu
(&
rhsCŞumn
[
k
]);

202 
Pack‘Ty³
 
A0
, 
A1
, 
A2
, 
A3
, 
A4
, 
A5
;

203 
A0
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*
MaxBlockRows
);

204 
A1
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*
MaxBlockRows
+1*
Pack‘Size
);

205 
A2
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*
MaxBlockRows
+2*
Pack‘Size
);

206 
A3
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*
MaxBlockRows
+3*
Pack‘Size
);

207 ià(
MaxBlockRows
==8è
A4
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*MaxBlockRows+4*
Pack‘Size
);

208 ià(
MaxBlockRows
==8è
A5
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*MaxBlockRows+5*
Pack‘Size
);

209 
d¡
[0] = 
	`ei_pmadd
(
tmp
, 
A0
, dst[0]);

210 ià(
MaxBlockRows
==8è
A0
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*MaxBlockRows+6*
Pack‘Size
);

211 
d¡
[1] = 
	`ei_pmadd
(
tmp
, 
A1
, dst[1]);

212 ià(
MaxBlockRows
==8è
A1
 = 
	`ei_¶ßd
(
loÿlB
 + 
k
*MaxBlockRows+7*
Pack‘Size
);

213 
d¡
[2] = 
	`ei_pmadd
(
tmp
, 
A2
, dst[2]);

214 
d¡
[3] = 
	`ei_pmadd
(
tmp
, 
A3
, dst[3]);

215 ià(
MaxBlockRows
==8)

217 
d¡
[4] = 
	`ei_pmadd
(
tmp
, 
A4
, dst[4]);

218 
d¡
[5] = 
	`ei_pmadd
(
tmp
, 
A5
, dst[5]);

219 
d¡
[6] = 
	`ei_pmadd
(
tmp
, 
A0
, dst[6]);

220 
d¡
[7] = 
	`ei_pmadd
(
tmp
, 
A1
, dst[7]);

224 
SÿÏr
* 
EIGEN_RESTRICT
 
loÿlRes
 = &(
»s
[
l1i
 + 
l1j
*
»sSŒide
]);

226 ià(
Pack‘Size
>1 && 
»sIsAligÃd
)

229 
	`ei_p¡Üe
(&(
loÿlRes
[0]), 
	`ei_·dd
(
	`ei_¶ßd
(&ÖoÿlRes[0])), 
	`ei_´eduxp
(&
d¡
[0])));

230 ià(
Pack‘Size
==2)

231 
	`ei_p¡Üe
(&(
loÿlRes
[2]), 
	`ei_·dd
(
	`ei_¶ßd
(&ÖoÿlRes[2])), 
	`ei_´eduxp
(&(
d¡
[2]))));

232 ià(
MaxBlockRows
==8)

234 
	`ei_p¡Üe
(&(
loÿlRes
[4]), 
	`ei_·dd
(
	`ei_¶ßd
(&ÖoÿlRes[4])), 
	`ei_´eduxp
(&(
d¡
[4]))));

235 ià(
Pack‘Size
==2)

236 
	`ei_p¡Üe
(&(
loÿlRes
[6]), 
	`ei_·dd
(
	`ei_¶ßd
(&ÖoÿlRes[6])), 
	`ei_´eduxp
(&(
d¡
[6]))));

242 
loÿlRes
[0] +ğ
	`ei_´edux
(
d¡
[0]);

243 
loÿlRes
[1] +ğ
	`ei_´edux
(
d¡
[1]);

244 
loÿlRes
[2] +ğ
	`ei_´edux
(
d¡
[2]);

245 
loÿlRes
[3] +ğ
	`ei_´edux
(
d¡
[3]);

246 ià(
MaxBlockRows
==8)

248 
loÿlRes
[4] +ğ
	`ei_´edux
(
d¡
[4]);

249 
loÿlRes
[5] +ğ
	`ei_´edux
(
d¡
[5]);

250 
loÿlRes
[6] +ğ
	`ei_´edux
(
d¡
[6]);

251 
loÿlRes
[7] +ğ
	`ei_´edux
(
d¡
[7]);

256 ià(
l2blockRemaššgRows
>0)

258 
off£tblock
 = 
l2k
 * (
l2blockRowEnd
-
l2i
è+ (
l2blockRowEndBW
-l2i)*(
l2blockSizeEnd
-l2kè-†2k*
l2blockRemaššgRows
;

259 cÚ¡ 
SÿÏr
* 
loÿlB
 = &
block
[
off£tblock
];

261 
l1j
=
l2j
;†1j<
l2blockCŞEnd
;†1j+=1)

263 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
rhsCŞumn
;

264 ià(
ÃedRhsCİy
)

265 
rhsCŞumn
 = &(
rhsCİy
[
l2BlockSizeAligÃd
*(
l1j
-
l2j
)-
l2k
]);

267 
rhsCŞumn
 = &(
rhs
[
l1j
*
rhsSŒide
]);

269 
Pack‘Ty³
 
d¡
[
MaxBlockRows
];

270 
d¡
[3] = d¡[2] = d¡[1] = d¡[0] = 
	`ei_p£t1
(
	`SÿÏr
(0.));

271 ià(
MaxBlockRows
==8)

272 
d¡
[7] = dst[6] = dst[5] = dst[4] = dst[0];

275 
Pack‘Ty³
 
tmp
;

277 
k
=
l2k
; k<
l2blockSizeEnd
; k+=
Pack‘Size
)

279 
tmp
 = 
	`ei_¶ßd
(&
rhsCŞumn
[
k
]);

281 
d¡
[0] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*
l2blockRemaššgRows
 ])), dst[0]);

282 ià(
l2blockRemaššgRows
>=2è
d¡
[1] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*l2blockRemaššgRows+ 
Pack‘Size
])), dst[1]);

283 ià(
l2blockRemaššgRows
>=3è
d¡
[2] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*l2blockRemaššgRows+2*
Pack‘Size
])), dst[2]);

284 ià(
l2blockRemaššgRows
>=4è
d¡
[3] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*l2blockRemaššgRows+3*
Pack‘Size
])), dst[3]);

285 ià(
MaxBlockRows
==8)

287 ià(
l2blockRemaššgRows
>=5è
d¡
[4] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*l2blockRemaššgRows+4*
Pack‘Size
])), dst[4]);

288 ià(
l2blockRemaššgRows
>=6è
d¡
[5] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*l2blockRemaššgRows+5*
Pack‘Size
])), dst[5]);

289 ià(
l2blockRemaššgRows
>=7è
d¡
[6] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*l2blockRemaššgRows+6*
Pack‘Size
])), dst[6]);

290 ià(
l2blockRemaššgRows
>=8è
d¡
[7] = 
	`ei_pmadd
(
tmp
, 
	`ei_¶ßd
(&(
loÿlB
[
k
*l2blockRemaššgRows+7*
Pack‘Size
])), dst[7]);

294 
SÿÏr
* 
EIGEN_RESTRICT
 
loÿlRes
 = &(
»s
[
l2blockRowEndBW
 + 
l1j
*
»sSŒide
]);

297 
loÿlRes
[0] +ğ
	`ei_´edux
(
d¡
[0]);

298 ià(
l2blockRemaššgRows
>=2è
loÿlRes
[1] +ğ
	`ei_´edux
(
d¡
[1]);

299 ià(
l2blockRemaššgRows
>=3è
loÿlRes
[2] +ğ
	`ei_´edux
(
d¡
[2]);

300 ià(
l2blockRemaššgRows
>=4è
loÿlRes
[3] +ğ
	`ei_´edux
(
d¡
[3]);

301 ià(
MaxBlockRows
==8)

303 ià(
l2blockRemaššgRows
>=5è
loÿlRes
[4] +ğ
	`ei_´edux
(
d¡
[4]);

304 ià(
l2blockRemaššgRows
>=6è
loÿlRes
[5] +ğ
	`ei_´edux
(
d¡
[5]);

305 ià(
l2blockRemaššgRows
>=7è
loÿlRes
[6] +ğ
	`ei_´edux
(
d¡
[6]);

306 ià(
l2blockRemaššgRows
>=8è
loÿlRes
[7] +ğ
	`ei_´edux
(
d¡
[7]);

314 ià(
Pack‘Size
>1 && 
»maššgSize
)

316 ià(
lhsRowMajÜ
)

318 
j
=0; j<
cŞs
; ++j)

319 
i
=0; i<
rows
; ++i)

321 
SÿÏr
 
tmp
 = 
lhs
[
i
*
lhsSŒide
+
size
] * 
rhs
[
j
*
rhsSŒide
+size];

323 
k
=1; k<
»maššgSize
; ++k)

324 
tmp
 +ğ
lhs
[
i
*
lhsSŒide
+
size
+
k
] * 
rhs
[
j
*
rhsSŒide
+size+k];

325 
»s
[
i
+
j
*
»sSŒide
] +ğ
tmp
;

330 
j
=0; j<
cŞs
; ++j)

331 
i
=0; i<
rows
; ++i)

333 
SÿÏr
 
tmp
 = 
lhs
[
i
+
size
*
lhsSŒide
] * 
rhs
[
j
*
rhsSŒide
+size];

334 
k
=1; k<
»maššgSize
; ++k)

335 
tmp
 +ğ
lhs
[
i
+(
size
+
k
)*
lhsSŒide
] * 
rhs
[
j
*
rhsSŒide
+size+k];

336 
»s
[
i
+
j
*
»sSŒide
] +ğ
tmp
;

341 
	`ei_®igÃd_¡ack_d–‘e
(
SÿÏr
, 
block
, 
®locBlockSize
);

342 
	`ei_®igÃd_¡ack_d–‘e
(
SÿÏr
, 
rhsCİy
, 
l2BlockSizeAligÃd
*l2BlockSizeAligned);

343 
	}
}

354 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gRhsTy³
>

355 
EIGEN_DONT_INLINE
 
	$ei_ÿche_ä›ndly_´oduù_cŞmajÜ_times_veùÜ
(

356 
size
,

357 cÚ¡ 
SÿÏr
* 
lhs
, 
lhsSŒide
,

358 cÚ¡ 
RhsTy³
& 
rhs
,

359 
SÿÏr
* 
»s
)

361 #ifdeà
_EIGEN_ACCUMULATE_PACKETS


362 #”rÜ 
_EIGEN_ACCUMULATE_PACKETS
 
has
 
®»ady
 
b“n
 
defšed


364 
	#_EIGEN_ACCUMULATE_PACKETS
(
A0
,
A13
,
A2
) \

365 
	`ei_p¡Üe
(&
»s
[
j
], \

366 
	`ei_·dd
(
	`ei_¶ßd
(&
»s
[
j
]), \

367 
	`ei_·dd
( \

368 
	`ei_·dd
(
	`ei_pmul
(
±mp0
,
	`EIGEN_CAT
(
ei_¶ß
 , 
A0
)(&
lhs0
[
j
])), \

369 
	`ei_pmul
(
±mp1
,
	`EIGEN_CAT
(
ei_¶ß
 , 
A13
)(&
lhs1
[
j
]))), \

370 
	`ei_·dd
(
	`ei_pmul
(
±mp2
,
	`EIGEN_CAT
(
ei_¶ß
 , 
A2
)(&
lhs2
[
j
])), \

371 
	`ei_pmul
(
±mp3
,
	`EIGEN_CAT
(
ei_¶ß
 , 
A13
)(&
lhs3
[
j
]))è)))

	)

373 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘
;

374 cÚ¡ 
Pack‘Size
 = (
Pack‘
)/(
SÿÏr
);

376 ’um { 
AÎAligÃd
 = 0, 
Ev’AligÃd
, 
Fœ¡AligÃd
, 
NÚeAligÃd
 };

377 cÚ¡ 
cŞumnsAtOnû
 = 4;

378 cÚ¡ 
³–s
 = 2;

379 cÚ¡ 
Pack‘AligÃdMask
 = 
Pack‘Size
-1;

380 cÚ¡ 
P“lAligÃdMask
 = 
Pack‘Size
*
³–s
-1;

384 cÚ¡ 
®igÃdS¹
 = 
	`ei_®ignm’tOff£t
(
»s
,
size
);

385 cÚ¡ 
®igÃdSize
 = 
Pack‘Size
>1 ? 
®igÃdS¹
 + ((
size
-®igÃdS¹è& ~
Pack‘AligÃdMask
) : 0;

386 cÚ¡ 
³–edSize
 = 
³–s
>1 ? 
®igÃdS¹
 + ((
®igÃdSize
-®igÃdS¹è& ~
P“lAligÃdMask
) :‡lignedStart;

388 cÚ¡ 
®ignm’tS‹p
 = 
Pack‘Size
>1 ? (Pack‘Siz- 
lhsSŒide
 % Pack‘Sizeè& 
Pack‘AligÃdMask
 : 0;

389 
®ignm’tP©‹º
 = 
®ignm’tS‹p
==0 ? 
AÎAligÃd


390 : 
®ignm’tS‹p
==(
Pack‘Size
/2è? 
Ev’AligÃd


391 : 
Fœ¡AligÃd
;

394 cÚ¡ 
lhsAlignm’tOff£t
 = 
	`ei_®ignm’tOff£t
(
lhs
,
size
);

397 
skCŞumns
 = 0;

398 ià(
Pack‘Size
>1)

400 
	`ei_š‹º®_as£¹
(
¡d
::
	`size_t
(
lhs
+
lhsAlignm’tOff£t
)%(
Pack‘
)==0 || 
size
<
Pack‘Size
);

402 
skCŞumns
<
Pack‘Size
 &&

403 
®igÃdS¹
 !ğ((
lhsAlignm’tOff£t
 + 
®ignm’tS‹p
*
skCŞumns
)%
Pack‘Size
))

404 ++
skCŞumns
;

405 ià(
skCŞumns
==
Pack‘Size
)

408 
®ignm’tP©‹º
 = 
NÚeAligÃd
;

409 
skCŞumns
 = 0;

413 
skCŞumns
 = 
¡d
::
	`mš
(skCŞumns,
rhs
.
	`size
());

417 
	`ei_š‹º®_as£¹
((
®ignm’tP©‹º
==
NÚeAligÃd
è|| (
¡d
::
	`size_t
(
lhs
+
®igÃdS¹
+
lhsSŒide
*
skCŞumns
)%(
Pack‘
))==0);

420 
off£t1
 = (
Fœ¡AligÃd
 && 
®ignm’tS‹p
==1?3:1);

421 
off£t3
 = (
Fœ¡AligÃd
 && 
®ignm’tS‹p
==1?1:3);

423 
cŞumnBound
 = ((
rhs
.
	`size
()-
skCŞumns
)/
cŞumnsAtOnû
)*columnsAtOnce + skipColumns;

424 
i
=
skCŞumns
; i<
cŞumnBound
; i+=
cŞumnsAtOnû
)

426 
Pack‘
 
±mp0
 = 
	`ei_p£t1
(
rhs
[
i
]), 
±mp1
 =ƒi_p£t1Ôhs[i+
off£t1
]),

427 
±mp2
 = 
	`ei_p£t1
(
rhs
[
i
+2]), 
±mp3
 =ƒi_p£t1Ôhs[i+
off£t3
]);

430 cÚ¡ 
SÿÏr
 *
lhs0
 = 
lhs
 + 
i
*
lhsSŒide
, *
lhs1
 =†h + (i+
off£t1
)*lhsStride,

431 *
lhs2
 = 
lhs
 + (
i
+2)*
lhsSŒide
, *
lhs3
 =†h + (i+
off£t3
)*lhsStride;

433 ià(
Pack‘Size
>1)

437 
j
=0; j<
®igÃdS¹
; ++j)

438 
»s
[
j
] +ğ
	`ei_pfœ¡
(
±mp0
)*
lhs0
[j] +ƒi_pfœ¡(
±mp1
)*
lhs1
[j] +ƒi_pfœ¡(
±mp2
)*
lhs2
[j] +ƒi_pfœ¡(
±mp3
)*
lhs3
[j];

440 ià(
®igÃdSize
>
®igÃdS¹
)

442 
®ignm’tP©‹º
)

444 
AÎAligÃd
:

445 
j
 = 
®igÃdS¹
; j<
®igÃdSize
; j+=
Pack‘Size
)

446 
	`_EIGEN_ACCUMULATE_PACKETS
(
d
,d,d);

448 
Ev’AligÃd
:

449 
j
 = 
®igÃdS¹
; j<
®igÃdSize
; j+=
Pack‘Size
)

450 
	`_EIGEN_ACCUMULATE_PACKETS
(
d
,
du
,d);

452 
Fœ¡AligÃd
:

453 if(
³–s
>1)

455 
Pack‘
 
A00
, 
A01
, 
A02
, 
A03
, 
A10
, 
A11
, 
A12
, 
A13
;

457 
A01
 = 
	`ei_¶ßd
(&
lhs1
[
®igÃdS¹
-1]);

458 
A02
 = 
	`ei_¶ßd
(&
lhs2
[
®igÃdS¹
-2]);

459 
A03
 = 
	`ei_¶ßd
(&
lhs3
[
®igÃdS¹
-3]);

461 
j
 = 
®igÃdS¹
; j<
³–edSize
; j+=
³–s
*
Pack‘Size
)

463 
A11
 = 
	`ei_¶ßd
(&
lhs1
[
j
-1+
Pack‘Size
]); 
ei_·lign
<1>(
A01
,A11);

464 
A12
 = 
	`ei_¶ßd
(&
lhs2
[
j
-2+
Pack‘Size
]); 
ei_·lign
<2>(
A02
,A12);

465 
A13
 = 
	`ei_¶ßd
(&
lhs3
[
j
-3+
Pack‘Size
]); 
ei_·lign
<3>(
A03
,A13);

467 
A00
 = 
	`ei_¶ßd
 (&
lhs0
[
j
]);

468 
A10
 = 
	`ei_¶ßd
 (&
lhs0
[
j
+
Pack‘Size
]);

469 
A00
 = 
	`ei_pmadd
(
±mp0
, A00, 
	`ei_¶ßd
(&
»s
[
j
]));

470 
A10
 = 
	`ei_pmadd
(
±mp0
, A10, 
	`ei_¶ßd
(&
»s
[
j
+
Pack‘Size
]));

472 
A00
 = 
	`ei_pmadd
(
±mp1
, 
A01
, A00);

473 
A01
 = 
	`ei_¶ßd
(&
lhs1
[
j
-1+2*
Pack‘Size
]); 
ei_·lign
<1>(
A11
,A01);

474 
A00
 = 
	`ei_pmadd
(
±mp2
, 
A02
, A00);

475 
A02
 = 
	`ei_¶ßd
(&
lhs2
[
j
-2+2*
Pack‘Size
]); 
ei_·lign
<2>(
A12
,A02);

476 
A00
 = 
	`ei_pmadd
(
±mp3
, 
A03
, A00);

477 
	`ei_p¡Üe
(&
»s
[
j
],
A00
);

478 
A03
 = 
	`ei_¶ßd
(&
lhs3
[
j
-3+2*
Pack‘Size
]); 
ei_·lign
<3>(
A13
,A03);

479 
A10
 = 
	`ei_pmadd
(
±mp1
, 
A11
, A10);

480 
A10
 = 
	`ei_pmadd
(
±mp2
, 
A12
, A10);

481 
A10
 = 
	`ei_pmadd
(
±mp3
, 
A13
, A10);

482 
	`ei_p¡Üe
(&
»s
[
j
+
Pack‘Size
],
A10
);

485 
j
 = 
³–edSize
; j<
®igÃdSize
; j+=
Pack‘Size
)

486 
	`_EIGEN_ACCUMULATE_PACKETS
(
d
,
du
,du);

489 
j
 = 
®igÃdS¹
; j<
®igÃdSize
; j+=
Pack‘Size
)

490 
	`_EIGEN_ACCUMULATE_PACKETS
(
du
,du,du);

497 
j
=
®igÃdSize
; j<
size
; ++j)

498 
»s
[
j
] +ğ
	`ei_pfœ¡
(
±mp0
)*
lhs0
[j] +ƒi_pfœ¡(
±mp1
)*
lhs1
[j] +ƒi_pfœ¡(
±mp2
)*
lhs2
[j] +ƒi_pfœ¡(
±mp3
)*
lhs3
[j];

502 
’d
 = 
rhs
.
	`size
();

503 
¡¬t
 = 
cŞumnBound
;

506 
i
=
¡¬t
; i<
’d
; ++i)

508 
Pack‘
 
±mp0
 = 
	`ei_p£t1
(
rhs
[
i
]);

509 cÚ¡ 
SÿÏr
* 
lhs0
 = 
lhs
 + 
i
*
lhsSŒide
;

511 ià(
Pack‘Size
>1)

515 
j
=0; j<
®igÃdS¹
; ++j)

516 
»s
[
j
] +ğ
	`ei_pfœ¡
(
±mp0
è* 
lhs0
[j];

519 ià((
¡d
::
	`size_t
(
lhs0
+
®igÃdS¹
)%(
Pack‘
))==0)

520 
j
 = 
®igÃdS¹
;j<
®igÃdSize
;j+=
Pack‘Size
)

521 
	`ei_p¡Üe
(&
»s
[
j
], 
	`ei_pmadd
(
±mp0
,
	`ei_¶ßd
(&
lhs0
[j]),ei_pload(&res[j])));

523 
j
 = 
®igÃdS¹
;j<
®igÃdSize
;j+=
Pack‘Size
)

524 
	`ei_p¡Üe
(&
»s
[
j
], 
	`ei_pmadd
(
±mp0
,
	`ei_¶ßdu
(&
lhs0
[j]),
	`ei_¶ßd
(&res[j])));

528 
j
=
®igÃdSize
; j<
size
; ++j)

529 
»s
[
j
] +ğ
	`ei_pfœ¡
(
±mp0
è* 
lhs0
[j];

531 ià(
skCŞumns
)

533 
¡¬t
 = 0;

534 
’d
 = 
skCŞumns
;

535 
skCŞumns
 = 0;

539 } 
Pack‘Size
>1);

540 #undeà
_EIGEN_ACCUMULATE_PACKETS


541 
	}
}

544 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gResTy³
>

545 
EIGEN_DONT_INLINE
 
	$ei_ÿche_ä›ndly_´oduù_rowmajÜ_times_veùÜ
(

546 cÚ¡ 
SÿÏr
* 
lhs
, 
lhsSŒide
,

547 cÚ¡ 
SÿÏr
* 
rhs
, 
rhsSize
,

548 
ResTy³
& 
»s
)

550 #ifdeà
_EIGEN_ACCUMULATE_PACKETS


551 #”rÜ 
_EIGEN_ACCUMULATE_PACKETS
 
has
 
®»ady
 
b“n
 
defšed


554 
	#_EIGEN_ACCUMULATE_PACKETS
(
A0
,
A13
,
A2
) {\

555 
Pack‘
 
b
 = 
	`ei_¶ßd
(&
rhs
[
j
]); \

556 
±mp0
 = 
	`ei_pmadd
(
b
, 
	`EIGEN_CAT
(
ei_¶ß
,
A0
è(&
lhs0
[
j
]),…tmp0); \

557 
±mp1
 = 
	`ei_pmadd
(
b
, 
	`EIGEN_CAT
(
ei_¶ß
,
A13
)(&
lhs1
[
j
]),…tmp1); \

558 
±mp2
 = 
	`ei_pmadd
(
b
, 
	`EIGEN_CAT
(
ei_¶ß
,
A2
è(&
lhs2
[
j
]),…tmp2); \

559 
±mp3
 = 
	`ei_pmadd
(
b
, 
	`EIGEN_CAT
(
ei_¶ß
,
A13
)(&
lhs3
[
j
]),…tmp3); }

	)

561 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘
;

562 cÚ¡ 
Pack‘Size
 = (
Pack‘
)/(
SÿÏr
);

564 ’um { 
AÎAligÃd
=0, 
Ev’AligÃd
=1, 
Fœ¡AligÃd
=2, 
NÚeAligÃd
=3 };

565 cÚ¡ 
rowsAtOnû
 = 4;

566 cÚ¡ 
³–s
 = 2;

567 cÚ¡ 
Pack‘AligÃdMask
 = 
Pack‘Size
-1;

568 cÚ¡ 
P“lAligÃdMask
 = 
Pack‘Size
*
³–s
-1;

569 cÚ¡ 
size
 = 
rhsSize
;

573 cÚ¡ 
®igÃdS¹
 = 
	`ei_®ignm’tOff£t
(
rhs
, 
size
);

574 cÚ¡ 
®igÃdSize
 = 
Pack‘Size
>1 ? 
®igÃdS¹
 + ((
size
-®igÃdS¹è& ~
Pack‘AligÃdMask
) : 0;

575 cÚ¡ 
³–edSize
 = 
³–s
>1 ? 
®igÃdS¹
 + ((
®igÃdSize
-®igÃdS¹è& ~
P“lAligÃdMask
) :‡lignedStart;

577 cÚ¡ 
®ignm’tS‹p
 = 
Pack‘Size
>1 ? (Pack‘Siz- 
lhsSŒide
 % Pack‘Sizeè& 
Pack‘AligÃdMask
 : 0;

578 
®ignm’tP©‹º
 = 
®ignm’tS‹p
==0 ? 
AÎAligÃd


579 : 
®ignm’tS‹p
==(
Pack‘Size
/2è? 
Ev’AligÃd


580 : 
Fœ¡AligÃd
;

583 cÚ¡ 
lhsAlignm’tOff£t
 = 
	`ei_®ignm’tOff£t
(
lhs
,
size
);

586 
skRows
 = 0;

587 ià(
Pack‘Size
>1)

589 
	`ei_š‹º®_as£¹
(
¡d
::
	`size_t
(
lhs
+
lhsAlignm’tOff£t
)%(
Pack‘
)==0 || 
size
<
Pack‘Size
);

591 
skRows
<
Pack‘Size
 &&

592 
®igÃdS¹
 !ğ((
lhsAlignm’tOff£t
 + 
®ignm’tS‹p
*
skRows
)%
Pack‘Size
))

593 ++
skRows
;

594 ià(
skRows
==
Pack‘Size
)

597 
®ignm’tP©‹º
 = 
NÚeAligÃd
;

598 
skRows
 = 0;

602 
skRows
 = 
¡d
::
	`mš
(skRows,
»s
.
	`size
());

605 
	`ei_š‹º®_as£¹
((
®ignm’tP©‹º
==
NÚeAligÃd
è|| 
Pack‘Size
==1

606 || (
¡d
::
	`size_t
(
lhs
+
®igÃdS¹
+
lhsSŒide
*
skRows
)%(
Pack‘
))==0);

609 
off£t1
 = (
Fœ¡AligÃd
 && 
®ignm’tS‹p
==1?3:1);

610 
off£t3
 = (
Fœ¡AligÃd
 && 
®ignm’tS‹p
==1?1:3);

612 
rowBound
 = ((
»s
.
	`size
()-
skRows
)/
rowsAtOnû
)*rowsAtOnce + skipRows;

613 
i
=
skRows
; i<
rowBound
; i+=
rowsAtOnû
)

615 
SÿÏr
 
tmp0
 = 
	`SÿÏr
(0), 
tmp1
 = SÿÏr(0), 
tmp2
 = SÿÏr(0), 
tmp3
 = Scalar(0);

618 cÚ¡ 
SÿÏr
 *
lhs0
 = 
lhs
 + 
i
*
lhsSŒide
, *
lhs1
 =†h + (i+
off£t1
)*lhsStride,

619 *
lhs2
 = 
lhs
 + (
i
+2)*
lhsSŒide
, *
lhs3
 =†h + (i+
off£t3
)*lhsStride;

621 ià(
Pack‘Size
>1)

624 
Pack‘
 
±mp0
 = 
	`ei_p£t1
(
	`SÿÏr
(0)), 
±mp1
 =ƒi_p£t1(SÿÏr(0)), 
±mp2
 =ƒi_p£t1(SÿÏr(0)), 
±mp3
 =ƒi_pset1(Scalar(0));

628 
j
=0; j<
®igÃdS¹
; ++j)

630 
SÿÏr
 
b
 = 
rhs
[
j
];

631 
tmp0
 +ğ
b
*
lhs0
[
j
]; 
tmp1
 +ğb*
lhs1
[j]; 
tmp2
 +ğb*
lhs2
[j]; 
tmp3
 +ğb*
lhs3
[j];

634 ià(
®igÃdSize
>
®igÃdS¹
)

636 
®ignm’tP©‹º
)

638 
AÎAligÃd
:

639 
j
 = 
®igÃdS¹
; j<
®igÃdSize
; j+=
Pack‘Size
)

640 
	`_EIGEN_ACCUMULATE_PACKETS
(
d
,d,d);

642 
Ev’AligÃd
:

643 
j
 = 
®igÃdS¹
; j<
®igÃdSize
; j+=
Pack‘Size
)

644 
	`_EIGEN_ACCUMULATE_PACKETS
(
d
,
du
,d);

646 
Fœ¡AligÃd
:

647 ià(
³–s
>1)

655 
Pack‘
 
A01
, 
A02
, 
A03
, 
b
, 
A11
, 
A12
, 
A13
;

656 
A01
 = 
	`ei_¶ßd
(&
lhs1
[
®igÃdS¹
-1]);

657 
A02
 = 
	`ei_¶ßd
(&
lhs2
[
®igÃdS¹
-2]);

658 
A03
 = 
	`ei_¶ßd
(&
lhs3
[
®igÃdS¹
-3]);

660 
j
 = 
®igÃdS¹
; j<
³–edSize
; j+=
³–s
*
Pack‘Size
)

662 
b
 = 
	`ei_¶ßd
(&
rhs
[
j
]);

663 
A11
 = 
	`ei_¶ßd
(&
lhs1
[
j
-1+
Pack‘Size
]); 
ei_·lign
<1>(
A01
,A11);

664 
A12
 = 
	`ei_¶ßd
(&
lhs2
[
j
-2+
Pack‘Size
]); 
ei_·lign
<2>(
A02
,A12);

665 
A13
 = 
	`ei_¶ßd
(&
lhs3
[
j
-3+
Pack‘Size
]); 
ei_·lign
<3>(
A03
,A13);

667 
±mp0
 = 
	`ei_pmadd
(
b
, 
	`ei_¶ßd
 (&
lhs0
[
j
]),…tmp0);

668 
±mp1
 = 
	`ei_pmadd
(
b
, 
A01
,…tmp1);

669 
A01
 = 
	`ei_¶ßd
(&
lhs1
[
j
-1+2*
Pack‘Size
]); 
ei_·lign
<1>(
A11
,A01);

670 
±mp2
 = 
	`ei_pmadd
(
b
, 
A02
,…tmp2);

671 
A02
 = 
	`ei_¶ßd
(&
lhs2
[
j
-2+2*
Pack‘Size
]); 
ei_·lign
<2>(
A12
,A02);

672 
±mp3
 = 
	`ei_pmadd
(
b
, 
A03
,…tmp3);

673 
A03
 = 
	`ei_¶ßd
(&
lhs3
[
j
-3+2*
Pack‘Size
]); 
ei_·lign
<3>(
A13
,A03);

675 
b
 = 
	`ei_¶ßd
(&
rhs
[
j
+
Pack‘Size
]);

676 
±mp0
 = 
	`ei_pmadd
(
b
, 
	`ei_¶ßd
 (&
lhs0
[
j
+
Pack‘Size
]),…tmp0);

677 
±mp1
 = 
	`ei_pmadd
(
b
, 
A11
,…tmp1);

678 
±mp2
 = 
	`ei_pmadd
(
b
, 
A12
,…tmp2);

679 
±mp3
 = 
	`ei_pmadd
(
b
, 
A13
,…tmp3);

682 
j
 = 
³–edSize
; j<
®igÃdSize
; j+=
Pack‘Size
)

683 
	`_EIGEN_ACCUMULATE_PACKETS
(
d
,
du
,du);

686 
j
 = 
®igÃdS¹
; j<
®igÃdSize
; j+=
Pack‘Size
)

687 
	`_EIGEN_ACCUMULATE_PACKETS
(
du
,du,du);

690 
tmp0
 +ğ
	`ei_´edux
(
±mp0
);

691 
tmp1
 +ğ
	`ei_´edux
(
±mp1
);

692 
tmp2
 +ğ
	`ei_´edux
(
±mp2
);

693 
tmp3
 +ğ
	`ei_´edux
(
±mp3
);

699 
j
=
®igÃdSize
; j<
size
; ++j)

701 
SÿÏr
 
b
 = 
rhs
[
j
];

702 
tmp0
 +ğ
b
*
lhs0
[
j
]; 
tmp1
 +ğb*
lhs1
[j]; 
tmp2
 +ğb*
lhs2
[j]; 
tmp3
 +ğb*
lhs3
[j];

704 
»s
[
i
] +ğ
tmp0
;„es[i+
off£t1
] +ğ
tmp1
;„es[i+2] +ğ
tmp2
;„es[i+
off£t3
] +ğ
tmp3
;

708 
’d
 = 
»s
.
	`size
();

709 
¡¬t
 = 
rowBound
;

712 
i
=
¡¬t
; i<
’d
; ++i)

714 
SÿÏr
 
tmp0
 = 
	`SÿÏr
(0);

715 
Pack‘
 
±mp0
 = 
	`ei_p£t1
(
tmp0
);

716 cÚ¡ 
SÿÏr
* 
lhs0
 = 
lhs
 + 
i
*
lhsSŒide
;

719 
j
=0; j<
®igÃdS¹
; ++j)

720 
tmp0
 +ğ
rhs
[
j
] * 
lhs0
[j];

722 ià(
®igÃdSize
>
®igÃdS¹
)

725 ià((
¡d
::
	`size_t
(
lhs0
+
®igÃdS¹
)%(
Pack‘
))==0)

726 
j
 = 
®igÃdS¹
;j<
®igÃdSize
;j+=
Pack‘Size
)

727 
±mp0
 = 
	`ei_pmadd
(
	`ei_¶ßd
(&
rhs
[
j
]),ƒi_¶ßd(&
lhs0
[j]),…tmp0);

729 
j
 = 
®igÃdS¹
;j<
®igÃdSize
;j+=
Pack‘Size
)

730 
±mp0
 = 
	`ei_pmadd
(
	`ei_¶ßd
(&
rhs
[
j
]), 
	`ei_¶ßdu
(&
lhs0
[j]),…tmp0);

731 
tmp0
 +ğ
	`ei_´edux
(
±mp0
);

736 
j
=
®igÃdSize
; j<
size
; ++j)

737 
tmp0
 +ğ
rhs
[
j
] * 
lhs0
[j];

738 
»s
[
i
] +ğ
tmp0
;

740 ià(
skRows
)

742 
¡¬t
 = 0;

743 
’d
 = 
skRows
;

744 
skRows
 = 0;

748 } 
Pack‘Size
>1);

750 #undeà
_EIGEN_ACCUMULATE_PACKETS


751 
	}
}

	@robot/Eigen/src/Core/Coeffs.h

25 #iâdeà
EIGEN_COEFFS_H


26 
	#EIGEN_COEFFS_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

43 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

44 ::
	$cÛff
(
row
, 
cŞ
) const

46 
	`ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
	`rows
()

47 && 
cŞ
 >ğ0 && cŞ < 
	`cŞs
());

48  
	`d”ived
().
	`cÛff
(
row
, 
cŞ
);

49 
	}
}

55 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

56 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

57 ::
	$İ”©Ü
()(
row
, 
cŞ
) const

59 
	`ei_as£¹
(
row
 >ğ0 &&„ow < 
	`rows
()

60 && 
cŞ
 >ğ0 && cŞ < 
	`cŞs
());

61  
	`d”ived
().
	`cÛff
(
row
, 
cŞ
);

62 
	}
}

78 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

79 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

80 ::
	$cÛffRef
(
row
, 
cŞ
)

82 
	`ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
	`rows
()

83 && 
cŞ
 >ğ0 && cŞ < 
	`cŞs
());

84  
	`d”ived
().
	`cÛffRef
(
row
, 
cŞ
);

85 
	}
}

91 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

92 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

93 ::
	$İ”©Ü
()(
row
, 
cŞ
)

95 
	`ei_as£¹
(
row
 >ğ0 &&„ow < 
	`rows
()

96 && 
cŞ
 >ğ0 && cŞ < 
	`cŞs
());

97  
	`d”ived
().
	`cÛffRef
(
row
, 
cŞ
);

98 
	}
}

114 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

115 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

116 ::
	$cÛff
(
šdex
) const

118 
	`ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
	`size
());

119  
	`d”ived
().
	`cÛff
(
šdex
);

120 
	}
}

129 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

130 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

131 ::
İ”©Ü
[](
šdex
) const

133 
ei_as£¹
(
šdex
 >ğ0 && index < 
size
());

134  
d”ived
().
cÛff
(
šdex
);

146 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

147 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

148 ::
	$İ”©Ü
()(
šdex
) const

150 
	`ei_as£¹
(
šdex
 >ğ0 && index < 
	`size
());

151  
	`d”ived
().
	`cÛff
(
šdex
);

152 
	}
}

168 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

169 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

170 ::
	$cÛffRef
(
šdex
)

172 
	`ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
	`size
());

173  
	`d”ived
().
	`cÛffRef
(
šdex
);

174 
	}
}

182 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

183 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

184 ::
İ”©Ü
[](
šdex
)

186 
ei_as£¹
(
šdex
 >ğ0 && index < 
size
());

187  
d”ived
().
cÛffRef
(
šdex
);

198 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

199 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

200 ::
	$İ”©Ü
()(
šdex
)

202 
	`ei_as£¹
(
šdex
 >ğ0 && index < 
	`size
());

203  
	`d”ived
().
	`cÛffRef
(
šdex
);

204 
	}
}

207 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

208 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

209 ::
	$x
(ècÚ¡ {  (*
this
)[0]; 
	}
}

212 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

213 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

214 ::
	$y
(ècÚ¡ {  (*
this
)[1]; 
	}
}

217 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

218 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

219 ::
	$z
(ècÚ¡ {  (*
this
)[2]; 
	}
}

222 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

223 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>

224 ::
	$w
(ècÚ¡ {  (*
this
)[3]; 
	}
}

227 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

228 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

229 ::
	$x
(è{  (*
this
)[0]; 
	}
}

232 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

233 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

234 ::
	$y
(è{  (*
this
)[1]; 
	}
}

237 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

238 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

239 ::
	$z
(è{  (*
this
)[2]; 
	}
}

242 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

243 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
& 
M©rixBa£
<
D”ived
>

244 ::
	$w
(è{  (*
this
)[3]; 
	}
}

254 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

255 
	g‹m¶©e
<
	gLßdMode
>

256 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_·ck‘_Œa™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
ty³


257 
M©rixBa£
<
D”ived
>::
	$·ck‘
(
row
, 
cŞ
) const

259 
	`ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
	`rows
()

260 && 
cŞ
 >ğ0 && cŞ < 
	`cŞs
());

261  
	`d”ived
().
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
,
cŞ
);

262 
	}
}

272 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

273 
	g‹m¶©e
<
	gStÜeMode
>

274 
EIGEN_STRONG_INLINE
 
	gM©rixBa£
<
	gD”ived
>::
wr™ePack‘


275 (
row
, 
	gcŞ
, cÚ¡ 
ty³Çme
 
	gei_·ck‘_Œa™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
ty³
& 
x
)

277 
ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
rows
()

278 && 
cŞ
 >ğ0 && cŞ < 
cŞs
());

279 
d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gStÜeMode
>(
	grow
,
	gcŞ
,
	gx
);

290 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

291 
	g‹m¶©e
<
	gLßdMode
>

292 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gei_·ck‘_Œa™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
ty³


293 
M©rixBa£
<
D”ived
>::
	$·ck‘
(
šdex
) const

295 
	`ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
	`size
());

296  
	`d”ived
().
‹m¶©e
 
·ck‘
<
LßdMode
>(
šdex
);

297 
	}
}

307 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

308 
	g‹m¶©e
<
	gStÜeMode
>

309 
EIGEN_STRONG_INLINE
 
	gM©rixBa£
<
	gD”ived
>::
wr™ePack‘


310 (
šdex
, cÚ¡ 
ty³Çme
 
	gei_·ck‘_Œa™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
ty³
& 
x
)

312 
ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
size
());

313 
d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gStÜeMode
>(
	gšdex
,
	gx
);

316 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


325 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

326 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

327 
EIGEN_STRONG_INLINE
 
	gM©rixBa£
<
	gD”ived
>::
cİyCÛff
(
row
, 
cŞ
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

329 
ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
rows
()

330 && 
cŞ
 >ğ0 && cŞ < 
cŞs
());

331 
d”ived
().
cÛffRef
(
row
, 
cŞ
èğ
Ùh”
.d”ived().
cÛff
(row, col);

341 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

342 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

343 
EIGEN_STRONG_INLINE
 
	gM©rixBa£
<
	gD”ived
>::
cİyCÛff
(
šdex
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

345 
ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
size
());

346 
d”ived
().
cÛffRef
(
šdex
èğ
Ùh”
.d”ived().
cÛff
(index);

356 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

357 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
, 
	gStÜeMode
, 
	gLßdMode
>

358 
EIGEN_STRONG_INLINE
 
	gM©rixBa£
<
	gD”ived
>::
cİyPack‘
(
row
, 
cŞ
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

360 
ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
rows
()

361 && 
cŞ
 >ğ0 && cŞ < 
cŞs
());

362 
d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gStÜeMode
>(
	grow
, 
	gcŞ
,

363 
	gÙh”
.
d”ived
().
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	grow
, 
	gcŞ
));

373 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

374 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
, 
	gStÜeMode
, 
	gLßdMode
>

375 
EIGEN_STRONG_INLINE
 
	gM©rixBa£
<
	gD”ived
>::
cİyPack‘
(
šdex
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

377 
ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
size
());

378 
d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gStÜeMode
>(
	gšdex
,

379 
	gÙh”
.
d”ived
().
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	gšdex
));

	@robot/Eigen/src/Core/CommaInitializer.h

26 #iâdeà
EIGEN_COMMAINITIALIZER_H


27 
	#EIGEN_COMMAINITIALIZER_H


	)

39 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

40 
	sCommaIn™Ÿliz”


42 
ty³Çme
 
	tei_Œa™s
<
	tM©rixTy³
>::
	tSÿÏr
 Scalar;

43 
šlše
 
CommaIn™Ÿliz”
(
M©rixTy³
& 
m©
, cÚ¡ 
SÿÏr
& 
s
)

44 : 
m_m©rix
(
m©
), 
m_row
(0), 
m_cŞ
(1), 
m_cu¼’tBlockRows
(1)

46 
	mm_m©rix
.
cÛffRef
(0,0èğ
s
;

49 
	m‹m¶©e
<
ty³Çme
 
	mOth”D”ived
>

50 
šlše
 
CommaIn™Ÿliz”
(
M©rixTy³
& 
m©
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

51 : 
m_m©rix
(
m©
), 
m_row
(0), 
m_cŞ
(
Ùh”
.
cŞs
()), 
m_cu¼’tBlockRows
(Ùh”.
rows
())

53 
	mm_m©rix
.
block
(0, 0, 
Ùh”
.
rows
(), oth”.
cŞs
()) = other;

57 
	mCommaIn™Ÿliz”
& 
	mİ”©Ü
,(cÚ¡ 
	mSÿÏr
& 
	ms
)

59 ià(
	mm_cŞ
==
m_m©rix
.
cŞs
())

61 
m_row
+=
m_cu¼’tBlockRows
;

62 
	mm_cŞ
 = 0;

63 
	mm_cu¼’tBlockRows
 = 1;

64 
ei_as£¹
(
m_row
<
m_m©rix
.
rows
()

67 
ei_as£¹
(
m_cŞ
<
m_m©rix
.
cŞs
()

69 
ei_as£¹
(
m_cu¼’tBlockRows
==1);

70 
	mm_m©rix
.
cÛffRef
(
m_row
, 
m_cŞ
++èğ
s
;

71  *
	mthis
;

75 
	m‹m¶©e
<
ty³Çme
 
	mOth”D”ived
>

76 
	mCommaIn™Ÿliz”
& 
	mİ”©Ü
,(cÚ¡ 
	mM©rixBa£
<
	mOth”D”ived
>& 
	mÙh”
)

78 ià(
	mm_cŞ
==
m_m©rix
.
cŞs
())

80 
m_row
+=
m_cu¼’tBlockRows
;

81 
	mm_cŞ
 = 0;

82 
	mm_cu¼’tBlockRows
 = 
Ùh”
.
rows
();

83 
ei_as£¹
(
m_row
+
m_cu¼’tBlockRows
<=
m_m©rix
.
rows
()

86 
ei_as£¹
(
m_cŞ
<
m_m©rix
.
cŞs
()

88 
ei_as£¹
(
m_cu¼’tBlockRows
==
Ùh”
.
rows
());

89 ià(
	mOth”D”ived
::
SizeAtCompeTime
 !ğ
DyÇmic
)

90 
m_m©rix
.
‹m¶©e
 
block
<
Oth”D”ived
::
RowsAtCompeTime
 !ğ
DyÇmic
 ? OtherDerived::RowsAtCompileTime : 1,

91 
	mOth”D”ived
::
CŞsAtCompeTime
 !ğ
DyÇmic
 ? 
Oth”D”ived
::ColsAtCompileTime : 1>

92 (
m_row
, 
	mm_cŞ
èğ
Ùh”
;

94 
	mm_m©rix
.
block
(
m_row
, 
m_cŞ
, 
Ùh”
.
rows
(), oth”.
cŞs
()) = other;

95 
	mm_cŞ
 +ğ
Ùh”
.
cŞs
();

96  *
	mthis
;

99 
	mšlše
 ~
CommaIn™Ÿliz”
()

101 
ei_as£¹
((
m_row
+
m_cu¼’tBlockRows
è=ğ
m_m©rix
.
rows
()

102 && 
m_cŞ
 =ğ
m_m©rix
.
cŞs
()

113 
šlše
 
	mM©rixTy³
& 
fšished
(è{  
	mm_m©rix
; }

115 
	mM©rixTy³
& 
	mm_m©rix
;

116 
	mm_row
;

117 
	mm_cŞ
;

118 
	mm_cu¼’tBlockRows
;

120 
	m´iv©e
:

121 
CommaIn™Ÿliz”
& 
İ”©Ü
=(const CommaInitializer&);

137 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

138 
šlše
 
	gCommaIn™Ÿliz”
<
	gD”ived
> 
	gM©rixBa£
<D”ived>::
İ”©Ü
<< (cÚ¡ 
SÿÏr
& 
s
)

140  
CommaIn™Ÿliz”
<
D”ived
>(*
¡©ic_ÿ¡
<D”ived*>(
this
), 
	gs
);

144 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

145 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

146 
šlše
 
	gCommaIn™Ÿliz”
<
	gD”ived
>

147 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
<<(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

149  
CommaIn™Ÿliz”
<
D”ived
>(*
¡©ic_ÿ¡
<D”ived *>(
this
), 
	gÙh”
);

	@robot/Eigen/src/Core/CoreInstantiations.cpp

25 #ifdeà
EIGEN_EXTERN_INSTANTIATIONS


26 #undeà
EIGEN_EXTERN_INSTANTIATIONS


29 
	~"../../CÜe
"

31 
Çme¥aû
 
	gEig’


34 
	#EIGEN_INSTANTIATE_PRODUCT
(
TYPE
) \

35 
‹m¶©e
 
ei_ÿche_ä›ndly_´oduù
<
TYPE
>( \

36 
_rows
, 
_cŞs
, 
d•th
, \

37 
boŞ
 
_lhsRowMajÜ
, cÚ¡ 
TYPE
* 
_lhs
, 
_lhsSŒide
, \

38 
boŞ
 
_rhsRowMajÜ
, cÚ¡ 
TYPE
* 
_rhs
, 
_rhsSŒide
, \

39 
boŞ
 
»sRowMajÜ
, 
TYPE
* 
»s
, 
»sSŒide
)

	)

41 
EIGEN_INSTANTIATE_PRODUCT
();

42 
EIGEN_INSTANTIATE_PRODUCT
();

43 
EIGEN_INSTANTIATE_PRODUCT
();

44 
EIGEN_INSTANTIATE_PRODUCT
(
¡d
::
com¶ex
<>);

45 
EIGEN_INSTANTIATE_PRODUCT
(
¡d
::
com¶ex
<>);

	@robot/Eigen/src/Core/Cwise.h

26 #iâdeà
EIGEN_CWISE_H


27 
	#EIGEN_CWISE_H


	)

31 
	#EIGEN_CWISE_BINOP_RETURN_TYPE
(
OP
) \

32 
Cwi£Bš¬yOp
<
OP
<
ty³Çme
 
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
>, Ex´essiÚTy³, 
Oth”D”ived
>

	)

34 
	#EIGEN_CWISE_PRODUCT_RETURN_TYPE
 \

35 
Cwi£Bš¬yOp
< \

36 
ei_sÿÏr_´oduù_İ
< \

37 
ty³Çme
 
ei_sÿÏr_´oduù_Œa™s
< \

38 
ty³Çme
 
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
, \

39 
ty³Çme
 
ei_Œa™s
<
Oth”D”ived
>::
SÿÏr
 \

40 >::
R‘uºTy³
 \

42 
Ex´essiÚTy³
, \

43 
Oth”D”ived
 \

44 >

	)

48 
	#EIGEN_CWISE_UNOP_RETURN_TYPE
(
OP
) \

49 
Cwi£UÇryOp
<
OP
<
ty³Çme
 
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
>, Ex´essiÚTy³>

	)

53 
	#EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
OP
) \

54 
Cwi£Bš¬yOp
<
OP
<
ty³Çme
 
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
>, ExpressionType, \

55 
Ne¡ByV®ue
<
ty³Çme
 
Ex´essiÚTy³
::
CÚ¡ªtR‘uºTy³
> >

	)

74 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> cÏs 
	cCwi£


76 
	mpublic
:

78 
ty³Çme
 
	tei_Œa™s
<
	tEx´essiÚTy³
>::
	tSÿÏr
 Scalar;

79 
ty³Çme
 
	tei_m‘a_if
<
	tei_mu¡_Ã¡_by_v®ue
<
	tEx´essiÚTy³
>::
	t»t
,

80 
	tEx´essiÚTy³
, cÚ¡ Ex´essiÚTy³&>::
	t»t
 
	tEx´essiÚTy³Ne¡ed
;

81 
	mCwi£UÇryOp
<
	tei_sÿÏr_add_İ
<
	tSÿÏr
>, 
	tEx´essiÚTy³
> 
	tSÿÏrAddR‘uºTy³
;

83 
šlše
 
	$Cwi£
(cÚ¡ 
Ex´essiÚTy³
& 
m©rix
è: 
	$m_m©rix
(
m©rix
) {}

86 
šlše
 cÚ¡ 
Ex´essiÚTy³
& 
	$_ex´essiÚ
(ècÚ¡ {  
m_m©rix
; 
	}
}

88 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

89 cÚ¡ 
EIGEN_CWISE_PRODUCT_RETURN_TYPE


90 
	gİ”©Ü
*(cÚ¡ 
	gM©rixBa£
<
	gOth”D”ived
> &
	gÙh”
) const;

92 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

93 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_quÙ›Á_İ
)

94 
İ”©Ü
/(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

96 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

97 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_mš_İ
)

98 
	`mš
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

100 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

101 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_max_İ
)

102 
	`max
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

104 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs_İ
è
	$abs
() const;

105 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs2_İ
è
	$abs2
() const;

106 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_squ¬e_İ
è
	$squ¬e
() const;

107 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_cube_İ
è
	$cube
() const;

108 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_šv”£_İ
è
	$šv”£
() const;

109 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_sq¹_İ
è
	$sq¹
() const;

110 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_exp_İ
è
	$exp
() const;

111 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_log_İ
è
	$log
() const;

112 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_cos_İ
è
	$cos
() const;

113 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_sš_İ
è
	$sš
() const;

114 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_pow_İ
è
	$pow
(cÚ¡ 
SÿÏr
& 
expÚ’t
) const;

116 cÚ¡ 
SÿÏrAddR‘uºTy³


117 
İ”©Ü
+(cÚ¡ 
SÿÏr
& 
sÿÏr
) const;

120 
ä›nd
 cÚ¡ 
SÿÏrAddR‘uºTy³


121 
İ”©Ü
+(cÚ¡ 
SÿÏr
& 
sÿÏr
, cÚ¡ 
Cwi£
& 
m©
)

122 {  
m©
 + 
sÿÏr
; 
	}
}

124 
	gEx´essiÚTy³
& 
	gİ”©Ü
+=(cÚ¡ 
SÿÏr
& 
sÿÏr
);

126 cÚ¡ 
SÿÏrAddR‘uºTy³


127 
	gİ”©Ü
-(cÚ¡ 
	gSÿÏr
& 
	gsÿÏr
) const;

129 
	gEx´essiÚTy³
& 
	gİ”©Ü
-=(cÚ¡ 
SÿÏr
& 
sÿÏr
);

131 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

132 
šlše
 
	gEx´essiÚTy³
& 
	gİ”©Ü
*=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
);

134 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

135 
šlše
 
	gEx´essiÚTy³
& 
	gİ”©Ü
/=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
);

137 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
> cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
Ëss
)

138 
İ”©Ü
<(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

140 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
> cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
Ëss_equ®
)

141 
İ”©Ü
<=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

143 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
> cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
g»©”
)

144 
İ”©Ü
>(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

146 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
> cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
g»©”_equ®
)

147 
İ”©Ü
>=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

149 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
> cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
equ®_to
)

150 
İ”©Ü
==(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

152 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
> cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
¡d
::
nÙ_equ®_to
)

153 
İ”©Ü
!=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

156 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
Ëss
)

157 
İ”©Ü
<(
SÿÏr
 
s
) const;

159 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
Ëss_equ®
)

160 
İ”©Ü
<=(
SÿÏr
 
s
) const;

162 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
g»©”
)

163 
İ”©Ü
>(
SÿÏr
 
s
) const;

165 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
g»©”_equ®
)

166 
İ”©Ü
>=(
SÿÏr
 
s
) const;

168 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
equ®_to
)

169 
İ”©Ü
==(
SÿÏr
 
s
) const;

171 cÚ¡ 
	$EIGEN_CWISE_COMP_TO_SCALAR_RETURN_TYPE
(
¡d
::
nÙ_equ®_to
)

172 
İ”©Ü
!=(
SÿÏr
 
s
) const;

175 #ifdeà
EIGEN_CWISE_PLUGIN


176 #šşud
EIGEN_CWISE_PLUGIN


179 
´Ùeùed
:

180 
Ex´essiÚTy³Ne¡ed
 
m_m©rix
;

182 
´iv©e
:

183 
Cwi£
& 
İ”©Ü
=(const Cwise&);

184 
	}
};

193 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

194 
šlše
 cÚ¡ 
	gCwi£
<
	gD”ived
>

195 
	gM©rixBa£
<
	gD”ived
>::
	$cwi£
() const

197  
	`d”ived
();

198 
	}
}

207 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

208 
šlše
 
	gCwi£
<
	gD”ived
>

209 
	gM©rixBa£
<
	gD”ived
>::
	$cwi£
()

211  
	`d”ived
();

212 
	}
}

	@robot/Eigen/src/Core/CwiseBinaryOp.h

26 #iâdeà
EIGEN_CWISE_BINARY_OP_H


27 
	#EIGEN_CWISE_BINARY_OP_H


	)

46 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
>

47 
	gei_Œa™s
<
	gCwi£Bš¬yOp
<
	gBš¬yOp
, 
	gLhs
, 
	gRhs
> >

51 
ty³Çme
 
	tei_»suÉ_of
<

52 
	tBš¬yOp
(

53 
	tty³Çme
 
	tLhs
::
	tSÿÏr
,

54 
	tty³Çme
 
	tRhs
::
	tSÿÏr


56 >::
	tty³
 
	tSÿÏr
;

57 
ty³Çme
 
	tLhs
::
	tNe¡ed
 
	tLhsNe¡ed
;

58 
ty³Çme
 
	tRhs
::
	tNe¡ed
 
	tRhsNe¡ed
;

59 
ty³Çme
 
	tei_uÄef
<
	tLhsNe¡ed
>::
	tty³
 
	t_LhsNe¡ed
;

60 
ty³Çme
 
	tei_uÄef
<
	tRhsNe¡ed
>::
	tty³
 
	t_RhsNe¡ed
;

62 
	gLhsCÛffR—dCo¡
 = 
_LhsNe¡ed
::
CÛffR—dCo¡
,

63 
	gRhsCÛffR—dCo¡
 = 
_RhsNe¡ed
::
CÛffR—dCo¡
,

64 
	gLhsFÏgs
 = 
_LhsNe¡ed
::
FÏgs
,

65 
	gRhsFÏgs
 = 
_RhsNe¡ed
::
FÏgs
,

66 
	gRowsAtCompeTime
 = 
Lhs
::
RowsAtCompeTime
,

67 
	gCŞsAtCompeTime
 = 
Lhs
::
CŞsAtCompeTime
,

68 
	gMaxRowsAtCompeTime
 = 
Lhs
::
MaxRowsAtCompeTime
,

69 
	gMaxCŞsAtCompeTime
 = 
Lhs
::
MaxCŞsAtCompeTime
,

70 
	gFÏgs
 = ((
LhsFÏgs
è| (
RhsFÏgs
)) & (

71 
H”ed™¬yB™s


72 | ((
LhsFÏgs
è& (
RhsFÏgs
è& (
Lš—rAcûssB™
 | 
AligÃdB™
))

73 | (
ei_funùÜ_Œa™s
<
Bš¬yOp
>::
Pack‘Acûss
 && (((
LhsFÏgs
è& 
RowMajÜB™
)==((
RhsFÏgs
) & RowMajorBit))

74 ? ((
LhsFÏgs
è& (
RhsFÏgs
è& 
Pack‘AcûssB™
) : 0)),

75 
	gCÛffR—dCo¡
 = 
LhsCÛffR—dCo¡
 + 
RhsCÛffR—dCo¡
 + 
ei_funùÜ_Œa™s
<
Bš¬yOp
>::
Co¡


79 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
>

80 
şass
 
	gCwi£Bš¬yOp
 : 
ei_no_assignm’t_İ”©Ü
,

81 
public
 
	gM©rixBa£
<
	gCwi£Bš¬yOp
<
	gBš¬yOp
, 
	gLhs
, 
	gRhs
> >

83 
	gpublic
:

85 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Cwi£Bš¬yOp
)

86 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yOp
>::
	tLhsNe¡ed
 LhsNested;

87 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yOp
>::
	tRhsNe¡ed
 RhsNested;

89 
EIGEN_STRONG_INLINE
 
Cwi£Bš¬yOp
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, cÚ¡ 
Bš¬yOp
& 
func
 = BinaryOp())

90 : 
m_lhs
(
lhs
), 
m_rhs
(
rhs
), 
m_funùÜ
(
func
)

99 
EIGEN_STATIC_ASSERT
((
ei_funùÜ_®lows_mixšg_»®_ªd_com¶ex
<
Bš¬yOp
>::
»t


100 ? (
ei_is_§me_ty³
<
ty³Çme
 
Lhs
::
R—lSÿÏr
,y³Çm
Rhs
::R—lSÿÏr>::
»t
)

101 : (
ei_is_§me_ty³
<
ty³Çme
 
Lhs
::
SÿÏr
,y³Çm
Rhs
::SÿÏr>::
»t
)),

102 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

104 
EIGEN_STATIC_ASSERT_SAME_MATRIX_SIZE
(
Lhs
, 
Rhs
)

105 
ei_as£¹
(
lhs
.
rows
(è=ğ
rhs
.rows(è&&†hs.
cŞs
() ==„hs.cols());

108 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_lhs
.rows(); }

109 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_lhs
.cols(); }

111 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

113  
m_funùÜ
(
m_lhs
.
cÛff
(
row
, 
cŞ
), 
m_rhs
.coeff(row, col));

116 
	g‹m¶©e
<
	gLßdMode
>

117 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

119  
	gm_funùÜ
.
·ck‘Op
(
m_lhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
, 
cŞ
), 
m_rhs
.template…acket<LoadMode>(row, col));

122 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

124  
m_funùÜ
(
m_lhs
.
cÛff
(
šdex
), 
m_rhs
.coeff(index));

127 
	g‹m¶©e
<
	gLßdMode
>

128 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

130  
	gm_funùÜ
.
·ck‘Op
(
m_lhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
šdex
), 
m_rhs
.template…acket<LoadMode>(index));

133 
	g´Ùeùed
:

134 cÚ¡ 
LhsNe¡ed
 
m_lhs
;

135 cÚ¡ 
RhsNe¡ed
 
	gm_rhs
;

136 cÚ¡ 
Bš¬yOp
 
	gm_funùÜ
;

145 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

146 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

147 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£Bš¬yOp
<
	gei_sÿÏr_difã»nû_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>,

148 
	gD”ived
, 
	gOth”D”ived
>

149 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
-(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

151  
Cwi£Bš¬yOp
<
ei_sÿÏr_difã»nû_İ
<
SÿÏr
>,

152 
	gD”ived
, 
	gOth”D”ived
>(
d”ived
(), 
	gÙh”
.derived());

159 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

160 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

161 
EIGEN_STRONG_INLINE
 
	gD”ived
 &

162 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
-=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

164  *
this
 = *thi - 
Ùh”
;

175 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

176 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

177 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£Bš¬yOp
<
	gei_sÿÏr_sum_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, D”ived, 
	gOth”D”ived
>

178 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
+(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

180  
Cwi£Bš¬yOp
<
ei_sÿÏr_sum_İ
<
SÿÏr
>, 
	gD”ived
, 
	gOth”D”ived
>(
d”ived
(), 
	gÙh”
.derived());

187 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

188 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

189 
EIGEN_STRONG_INLINE
 
	gD”ived
 &

190 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
+=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

192  *
this
 = *thi + 
Ùh”
;

202 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

203 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

204 
EIGEN_STRONG_INLINE
 cÚ¡ 
EIGEN_CWISE_PRODUCT_RETURN_TYPE


205 
	gCwi£
<
	gEx´essiÚTy³
>::
İ”©Ü
*(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

207  
EIGEN_CWISE_PRODUCT_RETURN_TYPE
(
_ex´essiÚ
(), 
Ùh”
.
d”ived
());

217 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

218 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

219 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_quÙ›Á_İ
)

220 
Cwi£
<
Ex´essiÚTy³
>::
İ”©Ü
/(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

222  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_quÙ›Á_İ
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

223 
	}
}

232 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

233 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

234 
šlše
 
	gEx´essiÚTy³
& 
	gCwi£
<Ex´essiÚTy³>::
İ”©Ü
*=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

236  
m_m©rix
.
cÚ¡_ÿ¡_d”ived
(èğ*
this
 * 
Ùh”
;

246 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

247 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

248 
šlše
 
	gEx´essiÚTy³
& 
	gCwi£
<Ex´essiÚTy³>::
İ”©Ü
/=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

250  
m_m©rix
.
cÚ¡_ÿ¡_d”ived
(èğ*
this
 / 
Ùh”
;

260 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

261 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

262 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_mš_İ
)

263 
Cwi£
<
Ex´essiÚTy³
>::
	`mš
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

265  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_mš_İ
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

266 
	}
}

275 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

276 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

277 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_max_İ
)

278 
Cwi£
<
Ex´essiÚTy³
>::
	`max
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

280  
	`EIGEN_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_max_İ
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

281 
	}
}

296 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

297 
	g‹m¶©e
<
ty³Çme
 
	gCu¡omBš¬yOp
,y³Çm
	gOth”D”ived
>

298 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£Bš¬yOp
<
	gCu¡omBš¬yOp
, 
	gD”ived
, 
	gOth”D”ived
>

299 
	gM©rixBa£
<
	gD”ived
>::
bš¬yEx´
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
, cÚ¡ 
Cu¡omBš¬yOp
& 
func
) const

301  
	gCwi£Bš¬yOp
<
	gCu¡omBš¬yOp
, 
	gD”ived
, 
	gOth”D”ived
>(
d”ived
(), 
	gÙh”
.d”ived(), 
	gfunc
);

	@robot/Eigen/src/Core/CwiseNullaryOp.h

25 #iâdeà
EIGEN_CWISE_NULLARY_OP_H


26 
	#EIGEN_CWISE_NULLARY_OP_H


	)

43 
	g‹m¶©e
<
ty³Çme
 
	gNuÎ¬yOp
,y³Çm
	gM©rixTy³
>

44 
	gei_Œa™s
<
	gCwi£NuÎ¬yOp
<
	gNuÎ¬yOp
, 
	gM©rixTy³
> > : 
ei_Œa™s
<
M©rixTy³
>

47 
FÏgs
 = (
ei_Œa™s
<
M©rixTy³
>::Flags

48 & ( 
H”ed™¬yB™s


49 | (
ei_funùÜ_has_lš—r_acûss
<
NuÎ¬yOp
>::
»t
 ? 
Lš—rAcûssB™
 : 0)

50 | (
ei_funùÜ_Œa™s
<
NuÎ¬yOp
>::
Pack‘Acûss
 ? 
Pack‘AcûssB™
 : 0)))

51 | (
ei_funùÜ_Œa™s
<
NuÎ¬yOp
>::
IsR•—bË
 ? 0 : 
Ev®BefÜeNe¡šgB™
),

52 
	gCÛffR—dCo¡
 = 
ei_funùÜ_Œa™s
<
NuÎ¬yOp
>::
Co¡


56 
	g‹m¶©e
<
ty³Çme
 
	gNuÎ¬yOp
,y³Çm
	gM©rixTy³
>

57 
şass
 
	gCwi£NuÎ¬yOp
 : 
ei_no_assignm’t_İ”©Ü
,

58 
public
 
	gM©rixBa£
<
	gCwi£NuÎ¬yOp
<
	gNuÎ¬yOp
, 
	gM©rixTy³
> >

60 
	gpublic
:

62 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Cwi£NuÎ¬yOp
)

64 
Cwi£NuÎ¬yOp
(
rows
, 
cŞs
, cÚ¡ 
NuÎ¬yOp
& 
func
 = NullaryOp())

65 : 
m_rows
(
rows
), 
m_cŞs
(
cŞs
), 
m_funùÜ
(
func
)

67 
ei_as£¹
(
rows
 > 0

68 && (
RowsAtCompeTime
 =ğ
DyÇmic
 || RowsAtCompeTim=ğ
rows
)

69 && 
cŞs
 > 0

70 && (
CŞsAtCompeTime
 =ğ
DyÇmic
 || CŞsAtCompeTim=ğ
cŞs
));

73 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_rows
.
v®ue
(); }

74 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_cŞs
.
v®ue
(); }

76 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
rows
, 
cŞs
) const

78  
m_funùÜ
(
rows
, 
cŞs
);

81 
	g‹m¶©e
<
	gLßdMode
>

82 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
(, ) const

84  
	gm_funùÜ
.
·ck‘Op
();

87 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

89 if(
	gRowsAtCompeTime
 == 1)

90  
m_funùÜ
(0, 
šdex
);

92  
m_funùÜ
(
šdex
, 0);

95 
	g‹m¶©e
<
	gLßdMode
>

96 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
() const

98  
	gm_funùÜ
.
·ck‘Op
();

101 
	g´Ùeùed
:

102 cÚ¡ 
ei_št_if_dyÇmic
<
RowsAtCompeTime
> 
m_rows
;

103 cÚ¡ 
	gei_št_if_dyÇmic
<
	gCŞsAtCompeTime
> 
	gm_cŞs
;

104 cÚ¡ 
NuÎ¬yOp
 
	gm_funùÜ
;

121 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

122 
	g‹m¶©e
<
ty³Çme
 
	gCu¡omNuÎ¬yOp
>

123 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£NuÎ¬yOp
<
	gCu¡omNuÎ¬yOp
, 
	gD”ived
>

124 
	gM©rixBa£
<
	gD”ived
>::
	$NuÎ¬yEx´
(
rows
, 
cŞs
, cÚ¡ 
Cu¡omNuÎ¬yOp
& 
func
)

126  
Cwi£NuÎ¬yOp
<
Cu¡omNuÎ¬yOp
, 
D”ived
>(
rows
, 
cŞs
, 
func
);

127 
	}
}

144 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

145 
	g‹m¶©e
<
ty³Çme
 
	gCu¡omNuÎ¬yOp
>

146 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£NuÎ¬yOp
<
	gCu¡omNuÎ¬yOp
, 
	gD”ived
>

147 
	gM©rixBa£
<
	gD”ived
>::
	$NuÎ¬yEx´
(
size
, cÚ¡ 
Cu¡omNuÎ¬yOp
& 
func
)

149 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

150 
	`ei_as£¹
(
IsVeùÜAtCompeTime
);

151 if(
RowsAtCompeTime
 =ğ1è 
Cwi£NuÎ¬yOp
<
Cu¡omNuÎ¬yOp
, 
D”ived
>(1, 
size
, 
func
);

152  
Cwi£NuÎ¬yOp
<
Cu¡omNuÎ¬yOp
, 
D”ived
>(
size
, 1, 
func
);

153 
	}
}

164 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

165 
	g‹m¶©e
<
ty³Çme
 
	gCu¡omNuÎ¬yOp
>

166 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£NuÎ¬yOp
<
	gCu¡omNuÎ¬yOp
, 
	gD”ived
>

167 
	gM©rixBa£
<
	gD”ived
>::
	$NuÎ¬yEx´
(cÚ¡ 
Cu¡omNuÎ¬yOp
& 
func
)

169  
Cwi£NuÎ¬yOp
<
Cu¡omNuÎ¬yOp
, 
D”ived
>(
RowsAtCompeTime
, 
CŞsAtCompeTime
, 
func
);

170 
	}
}

185 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

186 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


187 
M©rixBa£
<
D”ived
>::
	$CÚ¡ªt
(
rows
, 
cŞs
, cÚ¡ 
SÿÏr
& 
v®ue
)

189  
	`NuÎ¬yEx´
(
rows
, 
cŞs
, 
ei_sÿÏr_cÚ¡ªt_İ
<
SÿÏr
>(
v®ue
));

190 
	}
}

207 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

208 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


209 
M©rixBa£
<
D”ived
>::
	$CÚ¡ªt
(
size
, cÚ¡ 
SÿÏr
& 
v®ue
)

211  
	`NuÎ¬yEx´
(
size
, 
ei_sÿÏr_cÚ¡ªt_İ
<
SÿÏr
>(
v®ue
));

212 
	}
}

223 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

224 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


225 
M©rixBa£
<
D”ived
>::
	$CÚ¡ªt
(cÚ¡ 
SÿÏr
& 
v®ue
)

227 
	`EIGEN_STATIC_ASSERT_FIXED_SIZE
(
D”ived
)

228  
	`NuÎ¬yEx´
(
RowsAtCompeTime
, 
CŞsAtCompeTime
, 
ei_sÿÏr_cÚ¡ªt_İ
<
SÿÏr
>(
v®ue
));

229 
	}
}

232 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

233 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isAµroxToCÚ¡ªt


234 (cÚ¡ 
SÿÏr
& 
v®ue
, 
R—lSÿÏr
 
	g´ec
) const

236 
	gj
 = 0; j < 
cŞs
(); ++j)

237 
	gi
 = 0; i < 
rows
(); ++i)

238 if(!
ei_isAµrox
(
cÛff
(
i
, 
j
), 
v®ue
, 
´ec
))

239  
	gçl£
;

240  
	gŒue
;

246 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

247 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isCÚ¡ªt


248 (cÚ¡ 
SÿÏr
& 
v®ue
, 
R—lSÿÏr
 
	g´ec
) const

250  
isAµroxToCÚ¡ªt
(
v®ue
, 
´ec
);

257 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

258 
EIGEN_STRONG_INLINE
 
	gM©rixBa£
<
	gD”ived
>::
	$fl
(cÚ¡ 
SÿÏr
& 
v®ue
)

260 
	`£tCÚ¡ªt
(
v®ue
);

261 
	}
}

267 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

268 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
	$£tCÚ¡ªt
(cÚ¡ 
SÿÏr
& 
v®ue
)

270  
	`d”ived
(èğ
	`CÚ¡ªt
(
	`rows
(), 
	`cŞs
(), 
v®ue
);

271 
	}
}

282 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

283 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

284 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tCÚ¡ªt
(
size
, cÚ¡ 
SÿÏr
& 
v®ue
)

286 
	`»size
(
size
);

287  
	`£tCÚ¡ªt
(
v®ue
);

288 
	}
}

300 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

301 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

302 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tCÚ¡ªt
(
rows
, 
cŞs
, cÚ¡ 
SÿÏr
& 
v®ue
)

304 
	`»size
(
rows
, 
cŞs
);

305  
	`£tCÚ¡ªt
(
v®ue
);

306 
	}
}

327 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

328 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


329 
M©rixBa£
<
D”ived
>::
	$Z”o
(
rows
, 
cŞs
)

331  
	`CÚ¡ªt
(
rows
, 
cŞs
, 
	`SÿÏr
(0));

332 
	}
}

350 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

351 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


352 
M©rixBa£
<
D”ived
>::
	$Z”o
(
size
)

354  
	`CÚ¡ªt
(
size
, 
	`SÿÏr
(0));

355 
	}
}

367 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

368 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


369 
M©rixBa£
<
D”ived
>::
	$Z”o
()

371  
	`CÚ¡ªt
(
	`SÿÏr
(0));

372 
	}
}

382 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

383 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
	$isZ”o
(
R—lSÿÏr
 
´ec
) const

385 
j
 = 0; j < 
	`cŞs
(); ++j)

386 
i
 = 0; i < 
	`rows
(); ++i)

387 if(!
	`ei_isMuchSm®ËrThª
(
	`cÛff
(
i
, 
j
), 
¡©ic_ÿ¡
<
SÿÏr
>(1), 
´ec
))

388  
çl£
;

389  
Œue
;

390 
	}
}

399 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

400 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
	$£tZ”o
()

402  
	`£tCÚ¡ªt
(
	`SÿÏr
(0));

403 
	}
}

414 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

415 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

416 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tZ”o
(
size
)

418 
	`»size
(
size
);

419  
	`£tCÚ¡ªt
(
	`SÿÏr
(0));

420 
	}
}

432 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

433 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

434 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tZ”o
(
rows
, 
cŞs
)

436 
	`»size
(
rows
, 
cŞs
);

437  
	`£tCÚ¡ªt
(
	`SÿÏr
(0));

438 
	}
}

458 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

459 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


460 
M©rixBa£
<
D”ived
>::
	$OÃs
(
rows
, 
cŞs
)

462  
	`CÚ¡ªt
(
rows
, 
cŞs
, 
	`SÿÏr
(1));

463 
	}
}

481 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

482 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


483 
M©rixBa£
<
D”ived
>::
	$OÃs
(
size
)

485  
	`CÚ¡ªt
(
size
, 
	`SÿÏr
(1));

486 
	}
}

498 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

499 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚ¡ªtR‘uºTy³


500 
M©rixBa£
<
D”ived
>::
	$OÃs
()

502  
	`CÚ¡ªt
(
	`SÿÏr
(1));

503 
	}
}

513 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

514 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isOÃs


515 (
R—lSÿÏr
 
´ec
) const

517  
isAµroxToCÚ¡ªt
(
SÿÏr
(1), 
´ec
);

527 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

528 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
	$£tOÃs
()

530  
	`£tCÚ¡ªt
(
	`SÿÏr
(1));

531 
	}
}

542 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

543 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

544 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tOÃs
(
size
)

546 
	`»size
(
size
);

547  
	`£tCÚ¡ªt
(
	`SÿÏr
(1));

548 
	}
}

560 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

561 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

562 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tOÃs
(
rows
, 
cŞs
)

564 
	`»size
(
rows
, 
cŞs
);

565  
	`£tCÚ¡ªt
(
	`SÿÏr
(1));

566 
	}
}

586 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

587 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
Id’t™yR‘uºTy³


588 
M©rixBa£
<
D”ived
>::
	$Id’t™y
(
rows
, 
cŞs
)

590  
	`NuÎ¬yEx´
(
rows
, 
cŞs
, 
ei_sÿÏr_id’t™y_İ
<
SÿÏr
>());

591 
	}
}

603 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

604 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
Id’t™yR‘uºTy³


605 
M©rixBa£
<
D”ived
>::
	$Id’t™y
()

607 
	`EIGEN_STATIC_ASSERT_FIXED_SIZE
(
D”ived
)

608  
	`NuÎ¬yEx´
(
RowsAtCompeTime
, 
CŞsAtCompeTime
, 
ei_sÿÏr_id’t™y_İ
<
SÿÏr
>());

609 
	}
}

620 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

621 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isId’t™y


622 (
R—lSÿÏr
 
´ec
) const

624 
j
 = 0; 
	gj
 < 
cŞs
(); ++j)

626 
	gi
 = 0; i < 
rows
(); ++i)

628 if(
	gi
 =ğ
j
)

630 if(!
ei_isAµrox
(
cÛff
(
i
, 
j
), 
¡©ic_ÿ¡
<
SÿÏr
>(1), 
´ec
))

631  
çl£
;

635 if(!
ei_isMuchSm®ËrThª
(
cÛff
(
i
, 
j
), 
¡©ic_ÿ¡
<
R—lSÿÏr
>(1), 
´ec
))

636  
	gçl£
;

640  
	gŒue
;

643 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
boŞ
 
	gBig
 = (
D”ived
::
SizeAtCompeTime
>=16)>

644 
	sei_£tId’t™y_im¶


646 
EIGEN_STRONG_INLINE
 
D”ived
& 
run
(D”ived& 
m
)

648  
m
 = 
D”ived
::
Id’t™y
(m.
rows
(), m.
cŞs
());

652 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

653 
	gei_£tId’t™y_im¶
<
	gD”ived
, 
	gŒue
>

655 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
run
(
D”ived
& 
m
)

657 
	gm
.
£tZ”o
();

658 cÚ¡ 
	gsize
 = 
¡d
::
mš
(
m
.
rows
(), m.
cŞs
());

659 
	gi
 = 0; i < 
	gsize
; ++iè
	gm
.
cÛffRef
(
i
,ièğ
ty³Çme
 
D”ived
::
SÿÏr
(1);

660  
	gm
;

671 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

672 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
	$£tId’t™y
()

674  
ei_£tId’t™y_im¶
<
D”ived
>::
	`run
(
	`d”ived
());

675 
	}
}

687 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

688 
EIGEN_STRONG_INLINE
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

689 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
	$£tId’t™y
(
rows
, 
cŞs
)

691 
	`»size
(
rows
, 
cŞs
);

692  
	`£tId’t™y
();

693 
	}
}

701 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

702 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
BasisR‘uºTy³
 
M©rixBa£
<
D”ived
>::
	$Un™
(
size
, 
i
)

704 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

705  
	`BasisR‘uºTy³
(
Squ¬eM©rixTy³
::
	`Id’t™y
(
size
,size), 
i
);

706 
	}
}

716 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

717 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
BasisR‘uºTy³
 
M©rixBa£
<
D”ived
>::
	$Un™
(
i
)

719 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

720  
	`BasisR‘uºTy³
(
Squ¬eM©rixTy³
::
	`Id’t™y
(),
i
);

721 
	}
}

729 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

730 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
BasisR‘uºTy³
 
M©rixBa£
<
D”ived
>::
	$Un™X
()

731 {  
D”ived
::
	`Un™
(0); 
	}
}

739 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

740 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
BasisR‘uºTy³
 
M©rixBa£
<
D”ived
>::
	$Un™Y
()

741 {  
D”ived
::
	`Un™
(1); 
	}
}

749 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

750 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
BasisR‘uºTy³
 
M©rixBa£
<
D”ived
>::
	$Un™Z
()

751 {  
D”ived
::
	`Un™
(2); 
	}
}

759 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

760 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
BasisR‘uºTy³
 
M©rixBa£
<
D”ived
>::
	$Un™W
()

761 {  
D”ived
::
	`Un™
(3); 
	}
}

	@robot/Eigen/src/Core/CwiseUnaryOp.h

26 #iâdeà
EIGEN_CWISE_UNARY_OP_H


27 
	#EIGEN_CWISE_UNARY_OP_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	gUÇryOp
,y³Çm
	gM©rixTy³
>

43 
	gei_Œa™s
<
	gCwi£UÇryOp
<
	gUÇryOp
, 
	gM©rixTy³
> >

44 : 
ei_Œa™s
<
M©rixTy³
>

46 
ty³Çme
 
	tei_»suÉ_of
<

47 
	tUÇryOp
(
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
)

48 >::
	tty³
 
	tSÿÏr
;

49 
ty³Çme
 
	tM©rixTy³
::
	tNe¡ed
 
	tM©rixTy³Ne¡ed
;

50 
ty³Çme
 
	tei_uÄef
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

52 
	gFÏgs
 = (
_M©rixTy³Ne¡ed
::
FÏgs
 & (

53 
H”ed™¬yB™s
 | 
Lš—rAcûssB™
 | 
AligÃdB™


54 | (
ei_funùÜ_Œa™s
<
UÇryOp
>::
Pack‘Acûss
 ? 
Pack‘AcûssB™
 : 0))),

55 
	gCÛffR—dCo¡
 = 
_M©rixTy³Ne¡ed
::
CÛffR—dCo¡
 + 
ei_funùÜ_Œa™s
<
UÇryOp
>::
Co¡


59 
	g‹m¶©e
<
ty³Çme
 
	gUÇryOp
,y³Çm
	gM©rixTy³
>

60 
şass
 
	gCwi£UÇryOp
 : 
ei_no_assignm’t_İ”©Ü
,

61 
public
 
	gM©rixBa£
<
	gCwi£UÇryOp
<
	gUÇryOp
, 
	gM©rixTy³
> >

63 
	gpublic
:

65 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Cwi£UÇryOp
)

67 
šlše
 
Cwi£UÇryOp
(cÚ¡ 
M©rixTy³
& 
m©
, cÚ¡ 
UÇryOp
& 
func
 = UnaryOp())

68 : 
m_m©rix
(
m©
), 
m_funùÜ
(
func
) {}

70 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_m©rix
.rows(); }

71 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.cols(); }

73 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

75  
m_funùÜ
(
m_m©rix
.
cÛff
(
row
, 
cŞ
));

78 
	g‹m¶©e
<
	gLßdMode
>

79 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

81  
	gm_funùÜ
.
·ck‘Op
(
m_m©rix
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
, 
cŞ
));

84 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

86  
m_funùÜ
(
m_m©rix
.
cÛff
(
šdex
));

89 
	g‹m¶©e
<
	gLßdMode
>

90 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

92  
	gm_funùÜ
.
·ck‘Op
(
m_m©rix
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
šdex
));

95 
	g´Ùeùed
:

96 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

97 cÚ¡ 
UÇryOp
 
	gm_funùÜ
;

113 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

114 
	g‹m¶©e
<
ty³Çme
 
	gCu¡omUÇryOp
>

115 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£UÇryOp
<
	gCu¡omUÇryOp
, 
	gD”ived
>

116 
	gM©rixBa£
<
	gD”ived
>::
	$uÇryEx´
(cÚ¡ 
Cu¡omUÇryOp
& 
func
) const

118  
Cwi£UÇryOp
<
Cu¡omUÇryOp
, 
D”ived
>(
	`d”ived
(), 
func
);

119 
	}
}

123 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

124 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£UÇryOp
<
	gei_sÿÏr_İpos™e_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>,Derived>

125 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
-() const

127  
d”ived
();

137 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

138 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs_İ
)

139 
Cwi£
<
Ex´essiÚTy³
>::
	$abs
() const

141  
	`_ex´essiÚ
();

142 
	}
}

151 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

152 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs2_İ
)

153 
Cwi£
<
Ex´essiÚTy³
>::
	$abs2
() const

155  
	`_ex´essiÚ
();

156 
	}
}

161 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

162 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
CÚjug©eR‘uºTy³


163 
M©rixBa£
<
D”ived
>::
	$cÚjug©e
() const

165  
	`CÚjug©eR‘uºTy³
(
	`d”ived
());

166 
	}
}

171 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

172 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
R—lR‘uºTy³


173 
M©rixBa£
<
D”ived
>::
	$»®
(ècÚ¡ {  
	`d”ived
(); 
	}
}

178 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

179 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
ImagR‘uºTy³


180 
M©rixBa£
<
D”ived
>::
	$imag
(ècÚ¡ {  
	`d”ived
(); 
	}
}

189 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

190 
	g‹m¶©e
<
ty³Çme
 
	gNewTy³
>

191 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£UÇryOp
<
	gei_sÿÏr_ÿ¡_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
, 
	gNewTy³
>, Derived>

192 
	gM©rixBa£
<
	gD”ived
>::
	$ÿ¡
() const

194  
	`d”ived
();

195 
	}
}

198 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

199 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
SÿÏrMuÉËR‘uºTy³


200 
M©rixBa£
<
D”ived
>::
İ”©Ü
*(cÚ¡ 
SÿÏr
& 
sÿÏr
) const

202  
Cwi£UÇryOp
<
ei_sÿÏr_muÉË_İ
<
SÿÏr
>, 
	gD”ived
>

203 (
d”ived
(), 
	gei_sÿÏr_muÉË_İ
<
	gSÿÏr
>(
	gsÿÏr
));

207 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

208 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gCwi£UÇryOp
<
	gei_sÿÏr_quÙ›Á1_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

209 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
/(cÚ¡ 
SÿÏr
& 
sÿÏr
) const

211  
Cwi£UÇryOp
<
ei_sÿÏr_quÙ›Á1_İ
<
SÿÏr
>, 
	gD”ived
>

212 (
d”ived
(), 
	gei_sÿÏr_quÙ›Á1_İ
<
	gSÿÏr
>(
	gsÿÏr
));

215 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

216 
EIGEN_STRONG_INLINE
 
	gD”ived
&

217 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
*=(cÚ¡ 
SÿÏr
& 
Ùh”
)

219  *
this
 = *thi * 
Ùh”
;

222 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

223 
EIGEN_STRONG_INLINE
 
	gD”ived
&

224 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
/=(cÚ¡ 
SÿÏr
& 
Ùh”
)

226  *
this
 = *thi / 
Ùh”
;

	@robot/Eigen/src/Core/DiagonalCoeffs.h

25 #iâdeà
EIGEN_DIAGONALCOEFFS_H


26 
	#EIGEN_DIAGONALCOEFFS_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

43 
	gei_Œa™s
<
	gDŸgÚ®CÛffs
<
	gM©rixTy³
> >

45 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

46 
ty³Çme
 
	tei_Ã¡ed
<
	tM©rixTy³
>::
	tty³
 
	tM©rixTy³Ne¡ed
;

47 
ty³Çme
 
	tei_uÄef
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

49 
	gRowsAtCompeTime
 = (
M©rixTy³
::
SizeAtCompeTime
è=ğ
DyÇmic
 ? Dynamic

50 : 
EIGEN_SIZE_MIN
(
M©rixTy³
::
RowsAtCompeTime
,

51 
M©rixTy³
::
CŞsAtCompeTime
),

52 
	gCŞsAtCompeTime
 = 1,

53 
	gMaxRowsAtCompeTime
 = (
M©rixTy³
::
MaxSizeAtCompeTime
è=ğ
DyÇmic
 ? Dynamic

54 : 
EIGEN_SIZE_MIN
(
M©rixTy³
::
MaxRowsAtCompeTime
,

55 
M©rixTy³
::
MaxCŞsAtCompeTime
),

56 
	gMaxCŞsAtCompeTime
 = 1,

57 
	gFÏgs
 = ()
_M©rixTy³Ne¡ed
::
FÏgs
 & (
H”ed™¬yB™s
 | 
Lš—rAcûssB™
),

58 
	gCÛffR—dCo¡
 = 
_M©rixTy³Ne¡ed
::
CÛffR—dCo¡


62 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gDŸgÚ®CÛffs


63 : 
public
 
M©rixBa£
<
DŸgÚ®CÛffs
<
M©rixTy³
> >

65 
public
:

67 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
DŸgÚ®CÛffs
)

69 
šlše
 
DŸgÚ®CÛffs
(cÚ¡ 
M©rixTy³
& 
m©rix
è: 
m_m©rix
(matrix) {}

71 
EIGEN_INHERIT_ASSIGNMENT_OPERATORS
(
DŸgÚ®CÛffs
)

73 
šlše
 
rows
(ècÚ¡ {  
¡d
::
mš
(
m_m©rix
.rows(), m_m©rix.
cŞs
()); }

74 
šlše
 
cŞs
() const {  1; }

76 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, )

78  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
row
,„ow);

81 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, ) const

83  
	gm_m©rix
.
cÛff
(
row
,„ow);

86 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

88  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
šdex
, index);

91 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

93  
	gm_m©rix
.
cÛff
(
šdex
, index);

96 
	g´Ùeùed
:

98 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

109 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

110 
šlše
 
	gDŸgÚ®CÛffs
<
	gD”ived
>

111 
	gM©rixBa£
<
	gD”ived
>::
	$dŸgÚ®
()

113  
DŸgÚ®CÛffs
<
D”ived
>(
	`d”ived
());

114 
	}
}

117 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

118 
šlše
 cÚ¡ 
	gDŸgÚ®CÛffs
<
	gD”ived
>

119 
	gM©rixBa£
<
	gD”ived
>::
	$dŸgÚ®
() const

121  
DŸgÚ®CÛffs
<
D”ived
>(
	`d”ived
());

122 
	}
}

	@robot/Eigen/src/Core/DiagonalMatrix.h

25 #iâdeà
EIGEN_DIAGONALMATRIX_H


26 
	#EIGEN_DIAGONALMATRIX_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	gCÛffsVeùÜTy³
>

43 
	gei_Œa™s
<
	gDŸgÚ®M©rix
<
	gCÛffsVeùÜTy³
> >

45 
ty³Çme
 
	tCÛffsVeùÜTy³
::
	tSÿÏr
 Scalar;

46 
ty³Çme
 
	tei_Ã¡ed
<
	tCÛffsVeùÜTy³
>::
	tty³
 
	tCÛffsVeùÜTy³Ne¡ed
;

47 
ty³Çme
 
	tei_uÄef
<
	tCÛffsVeùÜTy³Ne¡ed
>::
	tty³
 
	t_CÛffsVeùÜTy³Ne¡ed
;

49 
	gRowsAtCompeTime
 = 
CÛffsVeùÜTy³
::
SizeAtCompeTime
,

50 
	gCŞsAtCompeTime
 = 
CÛffsVeùÜTy³
::
SizeAtCompeTime
,

51 
	gMaxRowsAtCompeTime
 = 
CÛffsVeùÜTy³
::
MaxSizeAtCompeTime
,

52 
	gMaxCŞsAtCompeTime
 = 
CÛffsVeùÜTy³
::
MaxSizeAtCompeTime
,

53 
	gFÏgs
 = (
_CÛffsVeùÜTy³Ne¡ed
::
FÏgs
 & 
H”ed™¬yB™s
è| 
DŸgÚ®
,

54 
	gCÛffR—dCo¡
 = 
_CÛffsVeùÜTy³Ne¡ed
::
CÛffR—dCo¡


58 
	g‹m¶©e
<
ty³Çme
 
	gCÛffsVeùÜTy³
>

59 
şass
 
	gDŸgÚ®M©rix
 : 
ei_no_assignm’t_İ”©Ü
,

60 
public
 
	gM©rixBa£
<
	gDŸgÚ®M©rix
<
	gCÛffsVeùÜTy³
> >

62 
	gpublic
:

64 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
DŸgÚ®M©rix
)

65 
CÛffsVeùÜTy³
 
	t_CÛffsVeùÜTy³
;

68 
	g‹m¶©e
<
ty³Çme
 
	gOth”CÛffsVeùÜTy³
>

69 
šlše
 
DŸgÚ®M©rix
(cÚ¡ DŸgÚ®M©rix<
Oth”CÛffsVeùÜTy³
>& 
Ùh”
è: 
m_cÛffs
(Ùh”.
dŸgÚ®
())

71 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
CÛffsVeùÜTy³
);

72 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
Oth”CÛffsVeùÜTy³
);

73 
ei_as£¹
(
m_cÛffs
.
size
() > 0);

76 
šlše
 
DŸgÚ®M©rix
(cÚ¡ 
CÛffsVeùÜTy³
& 
cÛffs
è: 
m_cÛffs
(coeffs)

78 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
CÛffsVeùÜTy³
);

79 
ei_as£¹
(
cÛffs
.
size
() > 0);

82 
šlše
 
rows
(ècÚ¡ {  
	gm_cÛffs
.
size
(); }

83 
šlše
 
cŞs
(ècÚ¡ {  
	gm_cÛffs
.
size
(); }

85 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

87  
	grow
 =ğ
cŞ
 ? 
m_cÛffs
.
cÛff
(
row
è: 
¡©ic_ÿ¡
<
SÿÏr
>(0);

90 
šlše
 cÚ¡ 
	gCÛffsVeùÜTy³
& 
dŸgÚ®
(ècÚ¡ {  
	gm_cÛffs
; }

92 
	g´Ùeùed
:

93 cÚ¡ 
ty³Çme
 
CÛffsVeùÜTy³
::
Ne¡ed
 
m_cÛffs
;

108 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

109 
šlše
 cÚ¡ 
	gDŸgÚ®M©rix
<
	gD”ived
>

110 
	gM©rixBa£
<
	gD”ived
>::
	$asDŸgÚ®
() const

112  
	`d”ived
();

113 
	}
}

124 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

125 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isDŸgÚ®


126 (
R—lSÿÏr
 
´ec
) const

128 if(
cŞs
(è!ğ
rows
()è 
çl£
;

129 
R—lSÿÏr
 
	gmaxAbsOnDŸgÚ®
 = 
¡©ic_ÿ¡
<RealScalar>(-1);

130 
	gj
 = 0; j < 
cŞs
(); ++j)

132 
R—lSÿÏr
 
	gabsOnDŸgÚ®
 = 
ei_abs
(
cÛff
(
j
,j));

133 if(
	gabsOnDŸgÚ®
 > 
	gmaxAbsOnDŸgÚ®
èmaxAbsOnDŸgÚ® = 
absOnDŸgÚ®
;

135 
	gj
 = 0; j < 
cŞs
(); ++j)

136 
	gi
 = 0; i < 
	gj
; ++i)

138 if(!
ei_isMuchSm®ËrThª
(
cÛff
(
i
, 
j
), 
maxAbsOnDŸgÚ®
, 
´ec
)è 
	gçl£
;

139 if(!
ei_isMuchSm®ËrThª
(
cÛff
(
j
, 
i
), 
maxAbsOnDŸgÚ®
, 
´ec
)è 
	gçl£
;

141  
	gŒue
;

	@robot/Eigen/src/Core/DiagonalProduct.h

26 #iâdeà
EIGEN_DIAGONALPRODUCT_H


27 
	#EIGEN_DIAGONALPRODUCT_H


	)

33 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gN
> 
	gei_Ã¡ed_dŸgÚ®
 : 
ei_Ã¡ed
<
T
,N> {};

34 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gN
> 
	gei_Ã¡ed_dŸgÚ®
<
	gDŸgÚ®M©rix
<T>,N >

35 : 
ei_Ã¡ed
<
DŸgÚ®M©rix
<
T
>, 
	gN
, 
	gDŸgÚ®M©rix
<
	gNe¡ByV®ue
<
ty³Çme
 
	gei_¶aš_m©rix_ty³
<
	gT
>::
ty³
> > >

39 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

40 
	gProduùR‘uºTy³
<
	gLhs
,
	gRhs
,
	gDŸgÚ®Produù
>

42 
ty³Çme
 
	tei_Ã¡ed_dŸgÚ®
<
	tLhs
,
	tRhs
::
	tCŞsAtCompeTime
>::
	tty³
 
	tLhsNe¡ed
;

43 
ty³Çme
 
	tei_Ã¡ed_dŸgÚ®
<
	tRhs
,
	tLhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tRhsNe¡ed
;

45 
	gProduù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
, 
	tDŸgÚ®Produù
> 
	tTy³
;

48 
	g‹m¶©e
<
ty³Çme
 
	gLhsNe¡ed
,y³Çm
	gRhsNe¡ed
>

49 
	gei_Œa™s
<
	gProduù
<
	gLhsNe¡ed
, 
	gRhsNe¡ed
, 
	gDŸgÚ®Produù
> >

52 
ty³Çme
 
	tei_ş—Áy³
<
	tLhsNe¡ed
>::
	tty³
 
	t_LhsNe¡ed
;

53 
ty³Çme
 
	tei_ş—Áy³
<
	tRhsNe¡ed
>::
	tty³
 
	t_RhsNe¡ed
;

54 
ty³Çme
 
	t_LhsNe¡ed
::
	tSÿÏr
 Scalar;

57 
	gLhsFÏgs
 = 
_LhsNe¡ed
::
FÏgs
,

58 
	gRhsFÏgs
 = 
_RhsNe¡ed
::
FÏgs
,

59 
	gRowsAtCompeTime
 = 
_LhsNe¡ed
::
RowsAtCompeTime
,

60 
	gCŞsAtCompeTime
 = 
_RhsNe¡ed
::
CŞsAtCompeTime
,

61 
	gMaxRowsAtCompeTime
 = 
_LhsNe¡ed
::
MaxRowsAtCompeTime
,

62 
	gMaxCŞsAtCompeTime
 = 
_RhsNe¡ed
::
MaxCŞsAtCompeTime
,

64 
	gLhsIsDŸgÚ®
 = (
_LhsNe¡ed
::
FÏgs
&
DŸgÚ®
)==Diagonal,

65 
	gRhsIsDŸgÚ®
 = (
_RhsNe¡ed
::
FÏgs
&
DŸgÚ®
)==Diagonal,

67 
	gCªVeùÜizeRhs
 = (!
RhsIsDŸgÚ®
è&& (
RhsFÏgs
 & 
RowMajÜB™
è&& (RhsFÏg & 
Pack‘AcûssB™
)

68 && (
CŞsAtCompeTime
 % 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 == 0),

70 
	gCªVeùÜizeLhs
 = (!
LhsIsDŸgÚ®
è&& (!(
LhsFÏgs
 & 
RowMajÜB™
)è&& (LhsFÏg & 
Pack‘AcûssB™
)

71 && (
RowsAtCompeTime
 % 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 == 0),

73 
	gRemovedB™s
 = ~((
RhsFÏgs
 & 
RowMajÜB™
è&& (!
CªVeùÜizeLhs
) ? 0 : RowMajorBit),

75 
	gFÏgs
 = (()(
LhsFÏgs
 | 
RhsFÏgs
è& 
H”ed™¬yB™s
 & 
RemovedB™s
)

76 | (((
CªVeùÜizeLhs
&&
RhsIsDŸgÚ®
è|| (
CªVeùÜizeRhs
&&
LhsIsDŸgÚ®
)è? 
Pack‘AcûssB™
 : 0),

78 
	gCÛffR—dCo¡
 = 
NumT¿™s
<
SÿÏr
>::
MulCo¡
 + 
_LhsNe¡ed
::
CÛffR—dCo¡
 + 
_RhsNe¡ed
::CoeffReadCost

82 
	g‹m¶©e
<
ty³Çme
 
	gLhsNe¡ed
,y³Çm
	gRhsNe¡ed
> 
şass
 
	gProduù
<LhsNe¡ed, RhsNe¡ed, 
	gDŸgÚ®Produù
> : 
ei_no_assignm’t_İ”©Ü
,

83 
public
 
	gM©rixBa£
<
	gProduù
<
	gLhsNe¡ed
, 
	gRhsNe¡ed
, 
	gDŸgÚ®Produù
> >

85 
ty³Çme
 
	tei_Œa™s
<
	tProduù
>::
	t_LhsNe¡ed
 _LhsNested;

86 
ty³Çme
 
	tei_Œa™s
<
	tProduù
>::
	t_RhsNe¡ed
 _RhsNested;

89 
	gRhsIsDŸgÚ®
 = (
_RhsNe¡ed
::
FÏgs
&
DŸgÚ®
)==Diagonal

92 
	gpublic
:

94 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Produù
)

96 
‹m¶©e
<
ty³Çme
 
Lhs
,y³Çm
	gRhs
>

97 
šlše
 
Produù
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
)

98 : 
m_lhs
(
lhs
), 
m_rhs
(
rhs
)

100 
ei_as£¹
(
lhs
.
cŞs
(è=ğ
rhs
.
rows
());

103 
šlše
 
rows
(ècÚ¡ {  
	gm_lhs
.rows(); }

104 
šlše
 
cŞs
(ècÚ¡ {  
	gm_rhs
.cols(); }

106 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

108 cÚ¡ 
	gunique
 = 
RhsIsDŸgÚ®
 ? 
cŞ
 : 
row
;

109  
	gm_lhs
.
cÛff
(
row
, 
unique
è* 
	gm_rhs
.cÛff(unique, 
cŞ
);

112 
	g‹m¶©e
<
	gLßdMode
>

113 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

115 ià(
	gRhsIsDŸgÚ®
)

117  
ei_pmul
(
m_lhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
, 
cŞ
), 
ei_p£t1
(
m_rhs
.
cÛff
(col, col)));

121  
ei_pmul
(
ei_p£t1
(
m_lhs
.
cÛff
(
row
,„ow)), 
m_rhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>Ôow, 
cŞ
));

125 
	g´Ùeùed
:

126 cÚ¡ 
LhsNe¡ed
 
m_lhs
;

127 cÚ¡ 
RhsNe¡ed
 
	gm_rhs
;

	@robot/Eigen/src/Core/Dot.h

25 #iâdeà
EIGEN_DOT_H


26 
	#EIGEN_DOT_H


	)

32 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

33 
	sei_dÙ_Œa™s


35 
	mpublic
:

37 
VeùÜiz©iÚ
 = ((
D”ived1
::
FÏgs
)&(
D”ived2
::FÏgs)&
Aùu®Pack‘AcûssB™
)

38 && ((
D”ived1
::
FÏgs
)&(
D”ived2
::FÏgs)&
Lš—rAcûssB™
)

39 ? 
Lš—rVeùÜiz©iÚ


40 : 
NoVeùÜiz©iÚ


43 
	m´iv©e
:

44 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

46 
	mPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
,

47 
	mCo¡
 = 
D”ived1
::
SizeAtCompeTime
 * (D”ived1::
CÛffR—dCo¡
 + 
D”ived2
::CÛffR—dCo¡ + 
NumT¿™s
<
SÿÏr
>::
MulCo¡
)

48 + (
D”ived1
::
SizeAtCompeTime
-1è* 
NumT¿™s
<
SÿÏr
>::
AddCo¡
,

49 
	mUÄŞlšgLim™
 = 
EIGEN_UNROLLING_LIMIT
 * ((
VeùÜiz©iÚ
è=ğ(
NoVeùÜiz©iÚ
è? 1 : (
Pack‘Size
))

52 
	mpublic
:

54 
UÄŞlšg
 = 
Co¡
 <ğ
UÄŞlšgLim™


55 ? 
Com¶‘eUÄŞlšg


56 : 
NoUÄŞlšg


66 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gS¹
, 
	gL’gth
>

67 
	sei_dÙ_novec_uÄŞËr


70 
	mH®fL’gth
 = 
L’gth
/2

73 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

75 
šlše
 
SÿÏr
 
run
(cÚ¡ 
D”ived1
& 
v1
, cÚ¡ 
D”ived2
& 
v2
)

77  
	mei_dÙ_novec_uÄŞËr
<
	mD”ived1
, 
	mD”ived2
, 
	mS¹
, 
	mH®fL’gth
>::
run
(
v1
, 
v2
)

78 + 
	mei_dÙ_novec_uÄŞËr
<
	mD”ived1
, 
	mD”ived2
, 
	mS¹
+
	mH®fL’gth
, 
	mL’gth
-H®fL’gth>::
run
(
v1
, 
v2
);

82 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gS¹
>

83 
	gei_dÙ_novec_uÄŞËr
<
	gD”ived1
, 
	gD”ived2
, 
	gS¹
, 1>

85 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

87 
šlše
 
SÿÏr
 
run
(cÚ¡ 
D”ived1
& 
v1
, cÚ¡ 
D”ived2
& 
v2
)

89  
	gv1
.
cÛff
(
S¹
è* 
ei_cÚj
(
v2
.coeff(Start));

95 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gIndex
, 
	gStİ
,

96 
boŞ
 
	gLa¡Pack‘
 = (
Stİ
-
Index
 =ğ
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived1
::
SÿÏr
>::
size
)>

97 
	sei_dÙ_vec_uÄŞËr


99 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

100 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

103 
	mrow1
 = 
D”ived1
::
RowsAtCompeTime
 =ğ1 ? 0 : 
Index
,

104 
	mcŞ1
 = 
D”ived1
::
RowsAtCompeTime
 =ğ1 ? 
Index
 : 0,

105 
	mrow2
 = 
D”ived2
::
RowsAtCompeTime
 =ğ1 ? 0 : 
Index
,

106 
	mcŞ2
 = 
D”ived2
::
RowsAtCompeTime
 =ğ1 ? 
Index
 : 0

109 
šlše
 
Pack‘SÿÏr
 
run
(cÚ¡ 
D”ived1
& 
v1
, cÚ¡ 
D”ived2
& 
v2
)

111  
ei_pmadd
(

112 
v1
.
‹m¶©e
 
·ck‘
<
AligÃd
>(
row1
, 
cŞ1
),

113 
v2
.
‹m¶©e
 
·ck‘
<
AligÃd
>(
row2
, 
cŞ2
),

114 
ei_dÙ_vec_uÄŞËr
<
D”ived1
, 
D”ived2
, 
Index
+
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
, 
Stİ
>::
run
(
v1
, 
v2
)

119 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gIndex
, 
	gStİ
>

120 
	gei_dÙ_vec_uÄŞËr
<
	gD”ived1
, 
	gD”ived2
, 
	gIndex
, 
	gStİ
, 
	gŒue
>

123 
	grow1
 = 
D”ived1
::
RowsAtCompeTime
 =ğ1 ? 0 : 
Index
,

124 
	gcŞ1
 = 
D”ived1
::
RowsAtCompeTime
 =ğ1 ? 
Index
 : 0,

125 
	grow2
 = 
D”ived2
::
RowsAtCompeTime
 =ğ1 ? 0 : 
Index
,

126 
	gcŞ2
 = 
D”ived2
::
RowsAtCompeTime
 =ğ1 ? 
Index
 : 0,

127 
	g®ignm’t1
 = (
D”ived1
::
FÏgs
 & 
AligÃdB™
è? 
AligÃd
 : 
UÇligÃd
,

128 
	g®ignm’t2
 = (
D”ived2
::
FÏgs
 & 
AligÃdB™
è? 
AligÃd
 : 
UÇligÃd


131 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

132 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

134 
šlše
 
Pack‘SÿÏr
 
run
(cÚ¡ 
D”ived1
& 
v1
, cÚ¡ 
D”ived2
& 
v2
)

136  
ei_pmul
(
v1
.
‹m¶©e
 
·ck‘
<
®ignm’t1
>(
row1
, 
cŞ1
), 
v2
.‹m¶©·ck‘<
®ignm’t2
>(
row2
, 
cŞ2
));

144 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
,

145 
	gVeùÜiz©iÚ
 = 
ei_dÙ_Œa™s
<
D”ived1
, 
	gD”ived2
>::
VeùÜiz©iÚ
,

146 
	gUÄŞlšg
 = 
ei_dÙ_Œa™s
<
D”ived1
, 
	gD”ived2
>::
UÄŞlšg


148 
ei_dÙ_im¶
;

150 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

151 
	gei_dÙ_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gNoVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

153 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

154 
SÿÏr
 
run
(cÚ¡ 
D”ived1
& 
v1
, cÚ¡ 
D”ived2
& 
v2
)

156 
ei_as£¹
(
v1
.
size
()>0 && "you‡re using‡‚on initialized vector");

157 
SÿÏr
 
	g»s
;

158 
	g»s
 = 
v1
.
cÛff
(0è* 
ei_cÚj
(
v2
.coeff(0));

159 
	gi
 = 1; i < 
	gv1
.
size
(); ++i)

160 
	g»s
 +ğ
v1
.
cÛff
(
i
è* 
ei_cÚj
(
v2
.coeff(i));

161  
	g»s
;

165 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

166 
	gei_dÙ_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gNoVeùÜiz©iÚ
, 
	gCom¶‘eUÄŞlšg
>

167 : 
public
 
ei_dÙ_novec_uÄŞËr
<
D”ived1
, 
	gD”ived2
, 0, 
	gD”ived1
::
SizeAtCompeTime
>

170 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

171 
	gei_dÙ_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gLš—rVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

173 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

174 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

176 
SÿÏr
 
run
(cÚ¡ 
D”ived1
& 
v1
, cÚ¡ 
D”ived2
& 
v2
)

178 cÚ¡ 
	gsize
 = 
v1
.
size
();

179 cÚ¡ 
	g·ck‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
;

180 cÚ¡ 
	g®igÃdSize
 = (
size
/
·ck‘Size
)*packetSize;

182 
	g®ignm’t1
 = (
D”ived1
::
FÏgs
 & 
AligÃdB™
è? 
AligÃd
 : 
UÇligÃd
,

183 
	g®ignm’t2
 = (
D”ived2
::
FÏgs
 & 
AligÃdB™
è? 
AligÃd
 : 
UÇligÃd


185 
SÿÏr
 
	g»s
;

188 if(
	gsize
 >ğ
·ck‘Size
)

190 
Pack‘SÿÏr
 
·ck‘_»s
 = 
ei_pmul
(

191 
v1
.
‹m¶©e
 
·ck‘
<
®ignm’t1
>(0),

192 
v2
.
‹m¶©e
 
·ck‘
<
®ignm’t2
>(0)

194 
	gšdex
 = 
·ck‘Size
; index<
	g®igÃdSize
; index +=…acketSize)

196 
·ck‘_»s
 = 
ei_pmadd
(

197 
v1
.
‹m¶©e
 
·ck‘
<
®ignm’t1
>(
šdex
),

198 
v2
.
‹m¶©e
 
·ck‘
<
®ignm’t2
>(
šdex
),

199 
·ck‘_»s


202 
	g»s
 = 
ei_´edux
(
·ck‘_»s
);

205 if(
	g®igÃdSize
 =ğ
size
è 
»s
;

210 
	g»s
 = 
SÿÏr
(0);

214 
	gšdex
 = 
®igÃdSize
; index < 
	gsize
; ++index)

216 
	g»s
 +ğ
v1
.
cÛff
(
šdex
è* 
v2
.coeff(index);

219  
	g»s
;

223 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

224 
	gei_dÙ_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gLš—rVeùÜiz©iÚ
, 
	gCom¶‘eUÄŞlšg
>

226 
ty³Çme
 
	tD”ived1
::
	tSÿÏr
 Scalar;

227 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

229 
	gPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
,

230 
	gSize
 = 
D”ived1
::
SizeAtCompeTime
,

231 
	gVeùÜiz©iÚSize
 = (
Size
 / 
Pack‘Size
) * PacketSize

233 
SÿÏr
 
run
(cÚ¡ 
D”ived1
& 
v1
, cÚ¡ 
D”ived2
& 
v2
)

235 
SÿÏr
 
	g»s
 = 
ei_´edux
(
ei_dÙ_vec_uÄŞËr
<
D”ived1
, 
D”ived2
, 0, 
VeùÜiz©iÚSize
>::
run
(
v1
, 
v2
));

236 ià(
	gVeùÜiz©iÚSize
 !ğ
Size
)

237 
»s
 +ğ
ei_dÙ_novec_uÄŞËr
<
D”ived1
, 
	gD”ived2
, 
	gVeùÜiz©iÚSize
, 
	gSize
-VeùÜiz©iÚSize>::
run
(
v1
, 
v2
);

238  
	g»s
;

256 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

257 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

258 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


259 
M©rixBa£
<
D”ived
>::
dÙ
(cÚ¡ M©rixBa£<
Oth”D”ived
>& 
Ùh”
) const

261 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

262 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
Oth”D”ived
)

263 
EIGEN_STATIC_ASSERT_SAME_VECTOR_SIZE
(
D”ived
,
Oth”D”ived
)

264 
EIGEN_STATIC_ASSERT
((
ei_is_§me_ty³
<
SÿÏr
, 
ty³Çme
 
Oth”D”ived
::SÿÏr>::
»t
),

265 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

267 
ei_as£¹
(
size
(è=ğ
Ùh”
.size());

269  
	gei_dÙ_im¶
<
	gD”ived
, 
	gOth”D”ived
>::
run
(
d”ived
(), 
Ùh”
.derived());

276 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

277 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l
 
M©rixBa£
<
D”ived
>::
	$squ¬edNÜm
() const

279  
	`ei_»®
((*
this
).
	`cwi£
().
	`abs2
().
	`sum
());

280 
	}
}

286 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

287 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l
 
M©rixBa£
<
D”ived
>::
	$nÜm
() const

289  
	`ei_sq¹
(
	`squ¬edNÜm
());

290 
	}
}

298 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

299 
šlše
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³


300 
M©rixBa£
<
D”ived
>::
	$nÜm®ized
() const

302 
ty³Çme
 
	tei_Ã¡ed
<
	tD”ived
>::
	tty³
 
	tNe¡ed
;

303 
ty³Çme
 
	tei_uÄef
<
	tNe¡ed
>::
	tty³
 
	t_Ne¡ed
;

304 
_Ne¡ed
 
	`n
(
	`d”ived
());

305  
n
 /‚.
	`nÜm
();

306 
	}
}

314 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

315 
šlše
 
	gM©rixBa£
<
	gD”ived
>::
	$nÜm®ize
()

317 *
this
 /ğ
	`nÜm
();

318 
	}
}

326 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

327 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

328 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isO¹hogÚ®


329 (cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
, 
R—lSÿÏr
 
	g´ec
) const

331 
ty³Çme
 
	gei_Ã¡ed
<
	gD”ived
,2>::
ty³
 
Ã¡ed
(
d”ived
());

332 
ty³Çme
 
	gei_Ã¡ed
<
	gOth”D”ived
,2>::
ty³
 
Ùh”Ne¡ed
(
Ùh”
.
d”ived
());

333  
ei_abs2
(
Ã¡ed
.
dÙ
(
Ùh”Ne¡ed
)è<ğ
´ec
 *…»ø*‚e¡ed.
squ¬edNÜm
() * otherNested.squaredNorm();

347 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

348 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
	$isUn™¬y
(
R—lSÿÏr
 
´ec
) const

350 
ty³Çme
 
D”ived
::
Ne¡ed
 
	`Ã¡ed
(
	`d”ived
());

351 
i
 = 0; i < 
	`cŞs
(); ++i)

353 if(!
	`ei_isAµrox
(
Ã¡ed
.
	`cŞ
(
i
).
	`squ¬edNÜm
(), 
¡©ic_ÿ¡
<
SÿÏr
>(1), 
´ec
))

354  
çl£
;

355 
j
 = 0; j < 
i
; ++j)

356 if(!
	`ei_isMuchSm®ËrThª
(
Ã¡ed
.
	`cŞ
(
i
).
	`dÙ
Òe¡ed.cŞ(
j
)), 
¡©ic_ÿ¡
<
SÿÏr
>(1), 
´ec
))

357  
çl£
;

359  
Œue
;

360 
	}
}

	@robot/Eigen/src/Core/Flagged.h

25 #iâdeà
EIGEN_FLAGGED_H


26 
	#EIGEN_FLAGGED_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
>

43 
	gei_Œa™s
<
	gFÏgged
<
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
> > : 
ei_Œa™s
<
Ex´essiÚTy³
>

45 ’um { 
FÏgs
 = (
Ex´essiÚTy³
::FÏg | 
Added
è& ~
Removed
 };

48 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
> 
şass
 
	gFÏgged


49 : 
public
 
M©rixBa£
<
FÏgged
<
Ex´essiÚTy³
, 
	gAdded
, 
	gRemoved
> >

51 
	gpublic
:

53 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
FÏgged
)

54 
ty³Çme
 
	tei_m‘a_if
<
	tei_mu¡_Ã¡_by_v®ue
<
	tEx´essiÚTy³
>::
	t»t
,

55 
	tEx´essiÚTy³
, cÚ¡ Ex´essiÚTy³&>::
	t»t
 
	tEx´essiÚTy³Ne¡ed
;

56 
ty³Çme
 
	tEx´essiÚTy³
::
	tIÂ”I‹¿tÜ
 InnerIterator;

58 
šlše
 
FÏgged
(cÚ¡ 
Ex´essiÚTy³
& 
m©rix
è: 
m_m©rix
(matrix) {}

60 
šlše
 
rows
(ècÚ¡ {  
m_m©rix
.rows(); }

61 
šlše
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.cols(); }

62 
šlše
 
¡ride
(ècÚ¡ {  
	gm_m©rix
.stride(); }

64 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

66  
	gm_m©rix
.
cÛff
(
row
, 
cŞ
);

69 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

71  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
row
, 
cŞ
);

74 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

76  
	gm_m©rix
.
cÛff
(
šdex
);

79 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

81  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
šdex
);

84 
	g‹m¶©e
<
	gLßdMode
>

85 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

87  
	gm_m©rix
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	grow
, 
	gcŞ
);

90 
	g‹m¶©e
<
	gLßdMode
>

91 
šlše
 
wr™ePack‘
(
row
, 
cŞ
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

93 
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	grow
, 
	gcŞ
, 
	gx
);

96 
	g‹m¶©e
<
	gLßdMode
>

97 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

99  
	gm_m©rix
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	gšdex
);

102 
	g‹m¶©e
<
	gLßdMode
>

103 
šlše
 
wr™ePack‘
(
šdex
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

105 
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	gšdex
, 
	gx
);

108 cÚ¡ 
	gEx´essiÚTy³
& 
_ex´essiÚ
(ècÚ¡ {  
	gm_m©rix
; }

110 
	g´Ùeùed
:

111 
Ex´essiÚTy³Ne¡ed
 
m_m©rix
;

113 
	g´iv©e
:

114 
FÏgged
& 
İ”©Ü
=(const Flagged&);

126 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

127 
	g‹m¶©e
<
	gAdded
>

128 
šlše
 cÚ¡ 
	gFÏgged
<
	gD”ived
, 
	gAdded
, 0>

129 
	gM©rixBa£
<
	gD”ived
>::
	$m¬ked
() const

131  
	`d”ived
();

132 
	}
}

142 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

143 
šlše
 cÚ¡ 
	gFÏgged
<
	gD”ived
, 0, 
	gEv®BefÜeNe¡šgB™
 | 
	gEv®BefÜeAssignšgB™
>

144 
	gM©rixBa£
<
	gD”ived
>::
	$Ïzy
() const

146  
	`d”ived
();

147 
	}
}

	@robot/Eigen/src/Core/Functors.h

25 #iâdeà
EIGEN_FUNCTORS_H


26 
	#EIGEN_FUNCTORS_H


	)

35 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_sum_İ
 
	gEIGEN_EMPTY_STRUCT
 {

36 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
, cÚ¡ SÿÏr& 
	gb
) const { ‡ + b; }

37 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

38 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
, cÚ¡ Pack‘SÿÏr& 
b
) const

39 {  
ei_·dd
(
a
,
b
); }

41 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

42 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_sum_İ
<
	gSÿÏr
> > {

44 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
,

45 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
>1

54 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_´oduù_İ
 
	gEIGEN_EMPTY_STRUCT
 {

55 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
, cÚ¡ SÿÏr& 
	gb
ècÚ¡ {  
a
 * b; }

56 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

57 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
, cÚ¡ Pack‘SÿÏr& 
b
) const

58 {  
ei_pmul
(
a
,
b
); }

60 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

61 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_´oduù_İ
<
	gSÿÏr
> > {

63 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
MulCo¡
,

64 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
>1

73 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_mš_İ
 
	gEIGEN_EMPTY_STRUCT
 {

74 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
, cÚ¡ SÿÏr& 
	gb
ècÚ¡ {  
	g¡d
::
mš
(
a
, 
b
); }

75 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

76 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
, cÚ¡ Pack‘SÿÏr& 
b
) const

77 {  
ei_pmš
(
a
,
b
); }

79 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

80 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_mš_İ
<
	gSÿÏr
> > {

82 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
,

83 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
>1

92 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_max_İ
 
	gEIGEN_EMPTY_STRUCT
 {

93 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
, cÚ¡ SÿÏr& 
	gb
ècÚ¡ {  
	g¡d
::
max
(
a
, 
b
); }

94 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

95 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
, cÚ¡ Pack‘SÿÏr& 
b
) const

96 {  
ei_pmax
(
a
,
b
); }

98 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

99 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_max_İ
<
	gSÿÏr
> > {

101 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
,

102 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
>1

114 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_difã»nû_İ
 
	gEIGEN_EMPTY_STRUCT
 {

115 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
, cÚ¡ SÿÏr& 
	gb
) const { ‡ - b; }

116 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

117 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
, cÚ¡ Pack‘SÿÏr& 
b
) const

118 {  
ei_psub
(
a
,
b
); }

120 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

121 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_difã»nû_İ
<
	gSÿÏr
> > {

123 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
,

124 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
>1

133 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_quÙ›Á_İ
 
	gEIGEN_EMPTY_STRUCT
 {

134 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
, cÚ¡ SÿÏr& 
	gb
) const { ‡ / b; }

135 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

136 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
, cÚ¡ Pack‘SÿÏr& 
b
) const

137 {  
ei_pdiv
(
a
,
b
); }

139 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

140 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_quÙ›Á_İ
<
	gSÿÏr
> > {

142 
	gCo¡
 = 2 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
,

143 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
>1

144 #ià(
defšed
 
EIGEN_VECTORIZE_SSE
)

145 && 
NumT¿™s
<
SÿÏr
>::
HasFlßtšgPošt


157 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_İpos™e_İ
 
	gEIGEN_EMPTY_STRUCT
 {

158 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
) const {  -a; }

160 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

161 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_İpos™e_İ
<
	gSÿÏr
> >

162 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

169 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_abs_İ
 
	gEIGEN_EMPTY_STRUCT
 {

170 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	t»suÉ_ty³
;

171 
EIGEN_STRONG_INLINE
 cÚ¡ 
»suÉ_ty³
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_abs
(
a
); }

173 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

174 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_abs_İ
<
	gSÿÏr
> >

177 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
,

178 
	gPack‘Acûss
 = 
çl£


187 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_abs2_İ
 
	gEIGEN_EMPTY_STRUCT
 {

188 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	t»suÉ_ty³
;

189 
EIGEN_STRONG_INLINE
 cÚ¡ 
»suÉ_ty³
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_abs2
(
a
); }

190 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

191 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
) const

192 {  
ei_pmul
(
a
,a); }

194 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

195 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_abs2_İ
<
	gSÿÏr
> >

196 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = (
ei_·ck‘_Œa™s
<SÿÏr>::
size
)>1 }; };

203 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_cÚjug©e_İ
 
	gEIGEN_EMPTY_STRUCT
 {

204 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_cÚj
(
a
); }

205 
	g‹m¶©e
<
ty³Çme
 
	gPack‘SÿÏr
>

206 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
ècÚ¡ {  
	ga
; }

208 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

209 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_cÚjug©e_İ
<
	gSÿÏr
> >

212 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
IsCom¶ex
 ? NumT¿™s<SÿÏr>::
AddCo¡
 : 0,

213 
	gPack‘Acûss
 = (
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
)>1

222 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gNewTy³
>

223 
ei_sÿÏr_ÿ¡_İ
 
	gEIGEN_EMPTY_STRUCT
 {

224 
NewTy³
 
	t»suÉ_ty³
;

225 
EIGEN_STRONG_INLINE
 cÚ¡ 
NewTy³
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gNewTy³
>(a); }

227 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gNewTy³
>

228 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_ÿ¡_İ
<
	gSÿÏr
,
	gNewTy³
> >

229 {ƒnum { 
	gCo¡
 = 
ei_is_§me_ty³
<
SÿÏr
, 
	gNewTy³
>::
»t
 ? 0 : 
NumT¿™s
<
NewTy³
>::
AddCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

236 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

237 
ei_sÿÏr_»®_İ
 
	gEIGEN_EMPTY_STRUCT
 {

238 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	t»suÉ_ty³
;

239 
EIGEN_STRONG_INLINE
 
»suÉ_ty³
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_»®
(
a
); }

241 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

242 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_»®_İ
<
	gSÿÏr
> >

243 {ƒnum { 
	gCo¡
 = 0, 
	gPack‘Acûss
 = 
çl£
 }; };

250 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

251 
ei_sÿÏr_imag_İ
 
	gEIGEN_EMPTY_STRUCT
 {

252 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	t»suÉ_ty³
;

253 
EIGEN_STRONG_INLINE
 
»suÉ_ty³
 
İ”©Ü
(è(cÚ¡ 
	gSÿÏr
& 
	ga
ècÚ¡ {  
ei_imag
(
a
); }

255 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

256 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_imag_İ
<
	gSÿÏr
> >

257 {ƒnum { 
	gCo¡
 = 0, 
	gPack‘Acûss
 = 
çl£
 }; };

272 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

273 
	sei_sÿÏr_muÉË_İ
 {

274 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

276 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_muÉË_İ
(cÚ¡ƒi_sÿÏr_muÉË_İ& 
Ùh”
è: 
m_Ùh”
(other.m_other) { }

277 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_muÉË_İ
(cÚ¡ 
SÿÏr
& 
Ùh”
è: 
m_Ùh”
(other) { }

278 
EIGEN_STRONG_INLINE
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ SÿÏr& 
a
ècÚ¡ { ‡ * 
m_Ùh”
; }

279 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
) const

280 {  
ei_pmul
(
a
, 
ei_p£t1
(
m_Ùh”
)); }

281 cÚ¡ 
SÿÏr
 
	mm_Ùh”
;

282 
	m´iv©e
:

283 
ei_sÿÏr_muÉË_İ
& 
İ”©Ü
=(constƒi_scalar_multiple_op&);

285 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

286 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_muÉË_İ
<
	gSÿÏr
> >

287 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<SÿÏr>::
size
>1 }; };

289 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
boŞ
 
	gHasFlßtšgPošt
>

290 
	sei_sÿÏr_quÙ›Á1_im¶
 {

291 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

293 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_quÙ›Á1_im¶
(cÚ¡ƒi_sÿÏr_quÙ›Á1_im¶& 
Ùh”
è: 
m_Ùh”
(other.m_other) { }

294 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_quÙ›Á1_im¶
(cÚ¡ 
SÿÏr
& 
Ùh”
è: 
m_Ùh”
(
¡©ic_ÿ¡
<Scalar>(1) / other) {}

295 
EIGEN_STRONG_INLINE
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ SÿÏr& 
a
ècÚ¡ { ‡ * 
m_Ùh”
; }

296 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(cÚ¡ Pack‘SÿÏr& 
a
) const

297 {  
ei_pmul
(
a
, 
ei_p£t1
(
m_Ùh”
)); }

298 cÚ¡ 
SÿÏr
 
	mm_Ùh”
;

299 
	m´iv©e
:

300 
ei_sÿÏr_quÙ›Á1_im¶
& 
İ”©Ü
=(constƒi_scalar_quotient1_impl&);

302 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

303 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_quÙ›Á1_im¶
<
	gSÿÏr
,
	gŒue
> >

304 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<SÿÏr>::
size
>1 }; };

306 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

307 
	gei_sÿÏr_quÙ›Á1_im¶
<
	gSÿÏr
,
	gçl£
> {

309 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_quÙ›Á1_im¶
(cÚ¡ƒi_sÿÏr_quÙ›Á1_im¶& 
Ùh”
è: 
m_Ùh”
(other.m_other) { }

310 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_quÙ›Á1_im¶
(cÚ¡ 
SÿÏr
& 
Ùh”
è: 
m_Ùh”
(other) {}

311 
EIGEN_STRONG_INLINE
 
SÿÏr
 
İ”©Ü
(è(cÚ¡ SÿÏr& 
a
ècÚ¡ { ‡ / 
m_Ùh”
; }

312 cÚ¡ 
SÿÏr
 
	gm_Ùh”
;

313 
	g´iv©e
:

314 
ei_sÿÏr_quÙ›Á1_im¶
& 
İ”©Ü
=(constƒi_scalar_quotient1_impl&);

316 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

317 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_quÙ›Á1_im¶
<
	gSÿÏr
,
	gçl£
> >

318 {ƒnum { 
	gCo¡
 = 2 * 
NumT¿™s
<
SÿÏr
>::
MulCo¡
, 
	gPack‘Acûss
 = 
çl£
 }; };

328 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

329 
	gei_sÿÏr_quÙ›Á1_İ
 : 
ei_sÿÏr_quÙ›Á1_im¶
<
SÿÏr
, 
	gNumT¿™s
<
	gSÿÏr
>::
HasFlßtšgPošt
 > {

330 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_quÙ›Á1_İ
(cÚ¡ 
SÿÏr
& 
Ùh”
)

331 : 
ei_sÿÏr_quÙ›Á1_im¶
<
SÿÏr
, 
	gNumT¿™s
<
	gSÿÏr
>::
HasFlßtšgPošt
 >(
Ùh”
) {}

332 
´iv©e
:

333 
ei_sÿÏr_quÙ›Á1_İ
& 
İ”©Ü
=(constƒi_scalar_quotient1_op&);

338 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

339 
	sei_sÿÏr_cÚ¡ªt_İ
 {

340 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

341 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_cÚ¡ªt_İ
(cÚ¡ƒi_sÿÏr_cÚ¡ªt_İ& 
Ùh”
è: 
m_Ùh”
(other.m_other) { }

342 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_cÚ¡ªt_İ
(cÚ¡ 
SÿÏr
& 
Ùh”
è: 
m_Ùh”
(other) { }

343 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(, ğ0ècÚ¡ {  
m_Ùh”
; }

344 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘Op
(ècÚ¡ {  
ei_p£t1
(
m_Ùh”
); }

345 cÚ¡ 
SÿÏr
 
	mm_Ùh”
;

346 
	m´iv©e
:

347 
ei_sÿÏr_cÚ¡ªt_İ
& 
İ”©Ü
=(constƒi_scalar_constant_op&);

349 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

350 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_cÚ¡ªt_İ
<
	gSÿÏr
> >

351 {ƒnum { 
	gCo¡
 = 1, 
	gPack‘Acûss
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
>1, 
	gIsR•—bË
 = 
Œue
 }; };

353 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
ei_sÿÏr_id’t™y_İ
 
	gEIGEN_EMPTY_STRUCT
 {

354 
EIGEN_STRONG_INLINE
 
ei_sÿÏr_id’t™y_İ
() {}

355 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
İ”©Ü
(è(
	grow
, 
	gcŞ
ècÚ¡ { „ow==
cŞ
 ? Scalar(1) : Scalar(0); }

357 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

358 
	gei_funùÜ_Œa™s
<
	gei_sÿÏr_id’t™y_İ
<
	gSÿÏr
> >

359 {ƒnum { 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡
, 
	gPack‘Acûss
 = 
çl£
, 
	gIsR•—bË
 = 
Œue
 }; };

363 #ifdeà
EIGEN_FUNCTORS_PLUGIN


364 #šşud
EIGEN_FUNCTORS_PLUGIN


370 
	g‹m¶©e
<
ty³Çme
 
	gFunùÜ
> 
	sei_funùÜ_has_lš—r_acûss
 {ƒnum { 
	m»t
 = 1 }; };

371 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_funùÜ_has_lš—r_acûss
<
	gei_sÿÏr_id’t™y_İ
<SÿÏr> > {ƒnum { 
	g»t
 = 0 }; };

375 
	g‹m¶©e
<
ty³Çme
 
	gFunùÜ
> 
	sei_funùÜ_®lows_mixšg_»®_ªd_com¶ex
 {ƒnum { 
	m»t
 = 0 }; };

376 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_funùÜ_®lows_mixšg_»®_ªd_com¶ex
<
	gei_sÿÏr_´oduù_İ
<SÿÏr> > {ƒnum { 
	g»t
 = 1 }; };

	@robot/Eigen/src/Core/Fuzzy.h

26 #iâdeà
EIGEN_FUZZY_H


27 
	#EIGEN_FUZZY_H


	)

29 #iâdeà
EIGEN_LEGACY_COMPARES


48 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

49 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

50 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isAµrox
(

51 cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

52 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec


55 cÚ¡ 
ty³Çme
 
ei_Ã¡ed
<
D”ived
,2>::
ty³
 
Ã¡ed
(
d”ived
());

56 cÚ¡ 
ty³Çme
 
	gei_Ã¡ed
<
	gOth”D”ived
,2>::
ty³
 
Ùh”Ne¡ed
(
Ùh”
.
d”ived
());

57  (
	gÃ¡ed
 - 
	gÙh”Ne¡ed
).
cwi£
().
abs2
().
sum
(è<ğ
´ec
 *…»ø* 
¡d
::
mš
(
Ã¡ed
.cwi£().abs2().sum(), 
Ùh”Ne¡ed
.cwise().abs2().sum());

73 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

74 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isMuchSm®ËrThª
(

75 cÚ¡ 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
& 
Ùh”
,

76 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec


79  
cwi£
().
abs2
().
sum
(è<ğ
´ec
 *…»ø* 
Ùh”
 * other;

92 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

93 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

94 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isMuchSm®ËrThª
(

95 cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

96 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec


99  
this
->
cwi£
().
abs2
().
sum
(è<ğ
´ec
 *…»ø* 
Ùh”
.cwise().abs2().sum();

104 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
=
D”ived
, 
boŞ
 
	gIsVeùÜ
=D”ived::
IsVeùÜAtCompeTime
>

105 
ei_fuzzy_£ËùÜ
;

123 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

124 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

125 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isAµrox
(

126 cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

127 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec


130  
ei_fuzzy_£ËùÜ
<
D”ived
,
	gOth”D”ived
>::
isAµrox
(
d”ived
(), 
Ùh”
.d”ived(), 
´ec
);

143 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

144 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isMuchSm®ËrThª
(

145 cÚ¡ 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
& 
Ùh”
,

146 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec


149  
ei_fuzzy_£ËùÜ
<
D”ived
>::
isMuchSm®ËrThª
(
d”ived
(), 
Ùh”
, 
´ec
);

162 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

163 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

164 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
isMuchSm®ËrThª
(

165 cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

166 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec


169  
ei_fuzzy_£ËùÜ
<
D”ived
,
	gOth”D”ived
>::
isMuchSm®ËrThª
(
d”ived
(), 
Ùh”
.d”ived(), 
´ec
);

173 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

174 
	gei_fuzzy_£ËùÜ
<
	gD”ived
,
	gOth”D”ived
,
	gŒue
>

176 
ty³Çme
 
	tD”ived
::
	tR—lSÿÏr
 RealScalar;

177 
boŞ
 
isAµrox
(cÚ¡ 
D”ived
& 
£lf
, cÚ¡ 
Oth”D”ived
& 
Ùh”
, 
R—lSÿÏr
 
´ec
)

179 
EIGEN_STATIC_ASSERT_SAME_VECTOR_SIZE
(
D”ived
,
Oth”D”ived
)

180 
ei_as£¹
(
£lf
.
size
(è=ğ
Ùh”
.size());

181 ((
	g£lf
 - 
	gÙh”
).
squ¬edNÜm
(è<ğ
¡d
::
mš
(
£lf
.squ¬edNÜm(), 
Ùh”
.squ¬edNÜm()è* 
´ec
 * 
	g´ec
);

183 
boŞ
 
isMuchSm®ËrThª
(cÚ¡ 
D”ived
& 
£lf
, cÚ¡ 
R—lSÿÏr
& 
Ùh”
, R—lSÿÏ¸
´ec
)

185 (
	g£lf
.
squ¬edNÜm
(è<ğ
ei_abs2
(
Ùh”
 * 
´ec
));

187 
boŞ
 
isMuchSm®ËrThª
(cÚ¡ 
D”ived
& 
£lf
, cÚ¡ 
Oth”D”ived
& 
Ùh”
, 
R—lSÿÏr
 
´ec
)

189 
EIGEN_STATIC_ASSERT_SAME_VECTOR_SIZE
(
D”ived
,
Oth”D”ived
)

190 
ei_as£¹
(
£lf
.
size
(è=ğ
Ùh”
.size());

191 (
	g£lf
.
squ¬edNÜm
(è<ğ
Ùh”
.squ¬edNÜm(è* 
´ec
 *…rec);

195 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

196 
	gei_fuzzy_£ËùÜ
<
	gD”ived
,
	gOth”D”ived
,
	gçl£
>

198 
ty³Çme
 
	tD”ived
::
	tR—lSÿÏr
 RealScalar;

199 
boŞ
 
isAµrox
(cÚ¡ 
D”ived
& 
£lf
, cÚ¡ 
Oth”D”ived
& 
Ùh”
, 
R—lSÿÏr
 
´ec
)

201 
EIGEN_STATIC_ASSERT_SAME_MATRIX_SIZE
(
D”ived
,
Oth”D”ived
)

202 
ei_as£¹
(
£lf
.
rows
(è=ğ
Ùh”
.rows(è&& s–f.
cŞs
() == other.cols());

203 
ty³Çme
 
	gD”ived
::
Ne¡ed
 
Ã¡ed
(
£lf
);

204 
ty³Çme
 
	gOth”D”ived
::
Ne¡ed
 
Ùh”Ne¡ed
(
Ùh”
);

205 
	gi
 = 0; i < 
	g£lf
.
cŞs
(); ++i)

206 if((
	gÃ¡ed
.
cŞ
(
i
è- 
	gÙh”Ne¡ed
.cŞ(i)).
squ¬edNÜm
()

207 > 
	g¡d
::
mš
(
Ã¡ed
.
cŞ
(
i
).
squ¬edNÜm
(), 
Ùh”Ne¡ed
.cŞ(i).squ¬edNÜm()è* 
´ec
 * 
	g´ec
)

208  
	gçl£
;

209  
	gŒue
;

211 
boŞ
 
isMuchSm®ËrThª
(cÚ¡ 
D”ived
& 
£lf
, cÚ¡ 
R—lSÿÏr
& 
Ùh”
, R—lSÿÏ¸
´ec
)

213 
ty³Çme
 
	gD”ived
::
Ne¡ed
 
Ã¡ed
(
£lf
);

214 
	gi
 = 0; i < 
	g£lf
.
cŞs
(); ++i)

215 if(
	gÃ¡ed
.
cŞ
(
i
).
squ¬edNÜm
(è> 
ei_abs2
(
Ùh”
 * 
´ec
))

216  
	gçl£
;

217  
	gŒue
;

219 
boŞ
 
isMuchSm®ËrThª
(cÚ¡ 
D”ived
& 
£lf
, cÚ¡ 
Oth”D”ived
& 
Ùh”
, 
R—lSÿÏr
 
´ec
)

221 
EIGEN_STATIC_ASSERT_SAME_MATRIX_SIZE
(
D”ived
,
Oth”D”ived
)

222 
ei_as£¹
(
£lf
.
rows
(è=ğ
Ùh”
.rows(è&& s–f.
cŞs
() == other.cols());

223 
ty³Çme
 
	gD”ived
::
Ne¡ed
 
Ã¡ed
(
£lf
);

224 
ty³Çme
 
	gOth”D”ived
::
Ne¡ed
 
Ùh”Ne¡ed
(
Ùh”
);

225 
	gi
 = 0; i < 
	g£lf
.
cŞs
(); ++i)

226 if(
	gÃ¡ed
.
cŞ
(
i
).
squ¬edNÜm
(è> 
	gÙh”Ne¡ed
.cŞ(i).squ¬edNÜm(è* 
´ec
 * 
	g´ec
)

227  
	gçl£
;

228  
	gŒue
;

	@robot/Eigen/src/Core/GenericPacketMath.h

26 #iâdeà
EIGEN_GENERIC_PACKET_MATH_H


27 
	#EIGEN_GENERIC_PACKET_MATH_H


	)

38 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


39 
	$ei_·dd
(cÚ¡ 
Pack‘
& 
a
,

40 cÚ¡ 
Pack‘
& 
b
è{  
a
+b; 
	}
}

43 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


44 
	$ei_psub
(cÚ¡ 
Pack‘
& 
a
,

45 cÚ¡ 
Pack‘
& 
b
è{  
a
-b; 
	}
}

48 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


49 
	$ei_pmul
(cÚ¡ 
Pack‘
& 
a
,

50 cÚ¡ 
Pack‘
& 
b
è{  
a
*b; 
	}
}

53 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


54 
	$ei_pdiv
(cÚ¡ 
Pack‘
& 
a
,

55 cÚ¡ 
Pack‘
& 
b
è{  
a
/b; 
	}
}

58 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


59 
	$ei_pmš
(cÚ¡ 
Pack‘
& 
a
,

60 cÚ¡ 
Pack‘
& 
b
è{  
¡d
::
	`mš
(
a
, b); 
	}
}

63 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


64 
	$ei_pmax
(cÚ¡ 
Pack‘
& 
a
,

65 cÚ¡ 
Pack‘
& 
b
è{  
¡d
::
	`max
(
a
, b); 
	}
}

68 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
šlše
y³Çm
	gei_·ck‘_Œa™s
<SÿÏr>::
ty³


69 
	$ei_¶ßd
(cÚ¡ 
SÿÏr
* 
äom
è{  *äom; 
	}
}

72 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
šlše
y³Çm
	gei_·ck‘_Œa™s
<SÿÏr>::
ty³


73 
	$ei_¶ßdu
(cÚ¡ 
SÿÏr
* 
äom
è{  *äom; 
	}
}

76 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
šlše
y³Çm
	gei_·ck‘_Œa™s
<SÿÏr>::
ty³


77 
	$ei_p£t1
(cÚ¡ 
SÿÏr
& 
a
è{ ‡; 
	}
}

80 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gPack‘
> 
šlše
 
	$ei_p¡Üe
(
SÿÏr
* 
to
, cÚ¡ 
Pack‘
& 
äom
)

81 { (*
to
èğ
äom
; 
	}
}

84 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gPack‘
> 
šlše
 
	$ei_p¡Üeu
(
SÿÏr
* 
to
, cÚ¡ 
Pack‘
& 
äom
)

85 { (*
to
èğ
äom
; 
	}
}

88 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
y³Çm
	gei_uÅack‘_Œa™s
<Pack‘>::
ty³
 
	$ei_pfœ¡
(cÚ¡ 
Pack‘
& 
a
)

89 {  
a
; 
	}
}

92 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


93 
	$ei_´eduxp
(cÚ¡ 
Pack‘
* 
vecs
è{  vecs[0]; 
	}
}

96 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
y³Çm
	gei_uÅack‘_Œa™s
<Pack‘>::
ty³
 
	$ei_´edux
(cÚ¡ 
Pack‘
& 
a
)

97 {  
a
; 
	}
}

105 
	g‹m¶©e
<
ty³Çme
 
	gPack‘
> 
šlše
 
Pack‘


106 
	$ei_pmadd
(cÚ¡ 
Pack‘
& 
a
,

107 cÚ¡ 
Pack‘
& 
b
,

108 cÚ¡ 
Pack‘
& 
c
)

109 {  
	`ei_·dd
(
	`ei_pmul
(
a
, 
b
),
c
); 
	}
}

113 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gLßdMode
>

114 
šlše
 
ty³Çme
 
	gei_·ck‘_Œa™s
<
	gSÿÏr
>::
ty³
 
	$ei_¶ßdt
(cÚ¡ 
SÿÏr
* 
äom
)

116 if(
LßdMode
 =ğ
AligÃd
)

117  
	`ei_¶ßd
(
äom
);

119  
	`ei_¶ßdu
(
äom
);

120 
	}
}

124 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gPack‘
, 
	gLßdMode
>

125 
šlše
 
	$ei_p¡Ü‘
(
SÿÏr
* 
to
, cÚ¡ 
Pack‘
& 
äom
)

127 if(
LßdMode
 =ğ
AligÃd
)

128 
	`ei_p¡Üe
(
to
, 
äom
);

130 
	`ei_p¡Üeu
(
to
, 
äom
);

131 
	}
}

134 
	g‹m¶©e
<
	gOff£t
,
ty³Çme
 
	gPack‘Ty³
>

135 
	sei_·lign_im¶


138 
šlše
 
run
(
Pack‘Ty³
&, const PacketType&) {}

143 
	g‹m¶©e
<
	gOff£t
,
ty³Çme
 
	gPack‘Ty³
>

144 
šlše
 
	$ei_·lign
(
Pack‘Ty³
& 
fœ¡
, cÚ¡ Pack‘Ty³& 
£cÚd
)

146 
ei_·lign_im¶
<
Off£t
,
Pack‘Ty³
>::
	`run
(
fœ¡
,
£cÚd
);

147 
	}
}

	@robot/Eigen/src/Core/IO.h

26 #iâdeà
EIGEN_IO_H


27 
	#EIGEN_IO_H


	)

29 ’um { 
	mRaw
, 
	mAlignCŞs
 };

50 
	sIOFÜm©


53 
IOFÜm©
(
_´ecisiÚ
=4, 
_æags
=
Raw
,

54 cÚ¡ 
¡d
::
¡ršg
& 
_cÛffS•¬©Ü
 = " ",

55 cÚ¡ 
¡d
::
¡ršg
& 
_rowS•¬©Ü
 = "\n", cÚ¡ std::¡ršg& 
_rowP»fix
="", cÚ¡ std::¡ršg& 
_rowSuffix
="",

56 cÚ¡ 
¡d
::
¡ršg
& 
_m©P»fix
="", cÚ¡ std::¡ršg& 
_m©Suffix
="")

57 : 
m©P»fix
(
_m©P»fix
), 
m©Suffix
(
_m©Suffix
), 
rowP»fix
(
_rowP»fix
), 
rowSuffix
(
_rowSuffix
), 
rowS•¬©Ü
(
_rowS•¬©Ü
),

58 
cÛffS•¬©Ü
(
_cÛffS•¬©Ü
), 
´ecisiÚ
(
_´ecisiÚ
), 
æags
(
_æags
)

60 
	mrowS·ûr
 = "";

61 
	mi
 = (
m©Suffix
.
Ëngth
())-1;

62 
	mi
>=0 && 
m©Suffix
[
i
]!='\n')

64 
rowS·ûr
 += ' ';

65 
	mi
--;

68 
	m¡d
::
¡ršg
 
m©P»fix
, 
	mm©Suffix
;

69 
	m¡d
::
¡ršg
 
rowP»fix
, 
	mrowSuffix
, 
	mrowS•¬©Ü
, 
	mrowS·ûr
;

70 
	m¡d
::
¡ršg
 
cÛffS•¬©Ü
;

71 
	m´ecisiÚ
;

72 
	mæags
;

89 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

90 şas 
	cW™hFÜm©


92 
	mpublic
:

94 
	$W™hFÜm©
(cÚ¡ 
Ex´essiÚTy³
& 
m©rix
, cÚ¡ 
IOFÜm©
& 
fÜm©
)

95 : 
	`m_m©rix
(
m©rix
), 
	$m_fÜm©
(
fÜm©
)

98 
ä›nd
 
¡d
::
o¡»am
 & 
İ”©Ü
 << (¡d::o¡»am & 
s
, cÚ¡ 
W™hFÜm©
& 
wf
)

100  
	`ei_´št_m©rix
(
s
, 
wf
.
m_m©rix
.
	`ev®
(), wf.
m_fÜm©
);

101 
	}
}

103 
	g´Ùeùed
:

104 cÚ¡ 
ty³Çme
 
Ex´essiÚTy³
::
Ne¡ed
 
m_m©rix
;

105 
IOFÜm©
 
	gm_fÜm©
;

115 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

116 
šlše
 cÚ¡ 
	gW™hFÜm©
<
	gD”ived
>

117 
	gM©rixBa£
<
	gD”ived
>::
	$fÜm©
(cÚ¡ 
IOFÜm©
& 
fmt
) const

119  
W™hFÜm©
<
D”ived
>(
	`d”ived
(), 
fmt
);

120 
	}
}

124 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

125 
	g¡d
::
o¡»am
 & 
	$ei_´št_m©rix
(
¡d
::
o¡»am
 & 
s
, cÚ¡ 
D”ived
& 
_m
, cÚ¡ 
IOFÜm©
& 
fmt
)

127 cÚ¡ 
ty³Çme
 
D”ived
::
Ne¡ed
 
m
 = 
_m
;

129 
width
 = 0;

130 ià(
fmt
.
æags
 & 
AlignCŞs
)

133 
j
 = 1; j < 
m
.
	`cŞs
(); ++j)

134 
i
 = 0; i < 
m
.
	`rows
(); ++i)

136 
¡d
::
¡ršg¡»am
 
s¡r
;

137 
s¡r
.
	`´ecisiÚ
(
fmt
.
´ecisiÚ
);

138 
s¡r
 << 
m
.
	`cÛff
(
i
,
j
);

139 
width
 = 
¡d
::
max
<>(width, (
s¡r
.
	`¡r
().
	`Ëngth
()));

142 
s
.
	`´ecisiÚ
(
fmt
.
´ecisiÚ
);

143 
s
 << 
fmt
.
m©P»fix
;

144 
i
 = 0; i < 
m
.
	`rows
(); ++i)

146 ià(
i
)

147 
s
 << 
fmt
.
rowS·ûr
;

148 
s
 << 
fmt
.
rowP»fix
;

149 if(
width
è
s
.
	`width
(width);

150 
s
 << 
m
.
	`cÛff
(
i
, 0);

151 
j
 = 1; j < 
m
.
	`cŞs
(); ++j)

153 
s
 << 
fmt
.
cÛffS•¬©Ü
;

154 ià(
width
è
s
.
	`width
(width);

155 
s
 << 
m
.
	`cÛff
(
i
, 
j
);

157 
s
 << 
fmt
.
rowSuffix
;

158 ifĞ
i
 < 
m
.
	`rows
() - 1)

159 
s
 << 
fmt
.
rowS•¬©Ü
;

161 
s
 << 
fmt
.
m©Suffix
;

162  
s
;

163 
	}
}

176 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

177 
	g¡d
::
o¡»am
 & 
İ”©Ü
 <<

178 (
¡d
::
o¡»am
 & 
s
,

179 cÚ¡ 
	gM©rixBa£
<
	gD”ived
> & 
	gm
)

181  
ei_´št_m©rix
(
s
, 
m
.
ev®
(), 
EIGEN_DEFAULT_IO_FORMAT
);

	@robot/Eigen/src/Core/Map.h

26 #iâdeà
EIGEN_MAP_H


27 
	#EIGEN_MAP_H


	)

47 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	g_Pack‘Acûss
>

48 
	gei_Œa™s
<
	gM­
<
	gM©rixTy³
, 
	g_Pack‘Acûss
> > : 
public
 
ei_Œa™s
<
M©rixTy³
>

51 
Pack‘Acûss
 = 
_Pack‘Acûss
,

52 
	gFÏgs
 = 
ei_Œa™s
<
M©rixTy³
>::
FÏgs
 & ~
AligÃdB™


54 
ty³Çme
 
	tei_m‘a_if
<(
	tPack‘Acûss
)==
	tFÜûAligÃd
,

55 
	tM­
<
	tM©rixTy³
, 
	t_Pack‘Acûss
>&,

56 
	tM­
<
	tM©rixTy³
, 
	tFÜûAligÃd
> >::
	t»t
 
	tAligÃdD”ivedTy³
;

59 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gPack‘Acûss
> 
şass
 
	gM­


60 : 
public
 
M­Ba£
<
M­
<
M©rixTy³
, 
	gPack‘Acûss
> >

62 
	gpublic
:

64 
_EIGEN_GENERIC_PUBLIC_INTERFACE
(
M­
, 
M­Ba£
<Map>)

65 
ty³Çme
 
	tei_Œa™s
<
	tM­
>::
	tAligÃdD”ivedTy³
 AlignedDerivedType;

67 
šlše
 
¡ride
(ècÚ¡ {  
	gthis
->
šÃrSize
(); }

69 
AligÃdD”ivedTy³
 
_cÚv”tToFÜûAligÃd
()

71  
	gM­
<
	gM©rixTy³
,
	gFÜûAligÃd
>(
	gBa£
::
m_d©a
, Ba£::
m_rows
.
v®ue
(), Ba£::
m_cŞs
.value());

74 
šlše
 
M­
(cÚ¡ 
SÿÏr
* 
d©a
è: 
Ba£
(data) {}

76 
šlše
 
M­
(cÚ¡ 
SÿÏr
* 
d©a
, 
size
è: 
Ba£
(data, size) {}

78 
šlše
 
M­
(cÚ¡ 
SÿÏr
* 
d©a
, 
rows
, 
cŞs
è: 
Ba£
(data,„ows, cols) {}

80 
šlše
 
»size
(
rows
, 
cŞs
)

82 
EIGEN_ONLY_USED_FOR_DEBUG
(
rows
);

83 
EIGEN_ONLY_USED_FOR_DEBUG
(
cŞs
);

84 
ei_as£¹
(
rows
 =ğ
this
->rows());

85 
ei_as£¹
(
cŞs
 =ğ
this
->cols());

88 
šlše
 
»size
(
size
)

90 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
M©rixTy³
)

91 
EIGEN_ONLY_USED_FOR_DEBUG
(
size
);

92 
ei_as£¹
(
size
 =ğ
this
->size());

95 
EIGEN_INHERIT_ASSIGNMENT_OPERATORS
(
M­
)

104 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜageOrd”
, 
	g_MaxRows
, 
	g_MaxCŞs
>

105 
šlše
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜageOrd”
, 
	g_MaxRows
, 
	g_MaxCŞs
>

106 ::
	$M©rix
(cÚ¡ 
SÿÏr
 *
d©a
)

108 
	`_£t_nßlŸs
(
Eig’
::
M­
<
M©rix
>(
d©a
));

109 
	}
}

	@robot/Eigen/src/Core/MapBase.h

26 #iâdeà
EIGEN_MAPBASE_H


27 
	#EIGEN_MAPBASE_H


	)

43 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
şass
 
	gM­Ba£


44 : 
public
 
M©rixBa£
<
D”ived
>

46 
public
:

48 
M©rixBa£
<
	tD”ived
> 
	tBa£
;

50 
	gIsRowMajÜ
 = ((
ei_Œa™s
<
D”ived
>::
FÏgs
è& 
RowMajÜB™
) ? 1 : 0,

51 
	gPack‘Acûss
 = 
ei_Œa™s
<
D”ived
>::
Pack‘Acûss
,

52 
	gRowsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
RowsAtCompeTime
,

53 
	gCŞsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
CŞsAtCompeTime
,

54 
	gSizeAtCompeTime
 = 
Ba£
::
SizeAtCompeTime


57 
ty³Çme
 
	tei_Œa™s
<
	tD”ived
>::
	tAligÃdD”ivedTy³
 AlignedDerivedType;

58 
ty³Çme
 
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
 Scalar;

59 
ty³Çme
 
	tBa£
::
	tPack‘SÿÏr
 PacketScalar;

60 
usšg
 
	gBa£
::
d”ived
;

62 
šlše
 
rows
(ècÚ¡ {  
	gm_rows
.
v®ue
(); }

63 
šlše
 
cŞs
(ècÚ¡ {  
	gm_cŞs
.
v®ue
(); }

65 
šlše
 
¡ride
(ècÚ¡ {  
d”ived
().stride(); }

66 
šlše
 cÚ¡ 
SÿÏr
* 
d©a
(ècÚ¡ {  
	gm_d©a
; }

68 
	g‹m¶©e
<
boŞ
 
	gIsFÜûAligÃd
,
ty³Çme
 
	gDummy
> 
	sfÜû_®igÃd_im¶
 {

69 
AligÃdD”ivedTy³
 
run
(
M­Ba£
& 
a
è{  
	ga
.
d”ived
(); }

72 
	g‹m¶©e
<
ty³Çme
 
	gDummy
> 
	gfÜû_®igÃd_im¶
<
	gçl£
,Dummy> {

73 
AligÃdD”ivedTy³
 
run
(
M­Ba£
& 
a
è{  
	ga
.
d”ived
().
_cÚv”tToFÜûAligÃd
(); }

78 
AligÃdD”ivedTy³
 
fÜûAligÃd
()

80  
	gfÜû_®igÃd_im¶
<(
	gPack‘Acûss
)==(
FÜûAligÃd
),
	gD”ived
>::
run
(*
this
);

83 
šlše
 cÚ¡ 
	gSÿÏr
& 
cÛff
(
row
, 
cŞ
) const

85 if(
	gIsRowMajÜ
)

86  
	gm_d©a
[
cŞ
 + 
row
 * 
¡ride
()];

88  
	gm_d©a
[
row
 + 
cŞ
 * 
¡ride
()];

91 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

93 if(
	gIsRowMajÜ
)

94  
	gcÚ¡_ÿ¡
<
	gSÿÏr
*>(
	gm_d©a
)[
cŞ
 + 
row
 * 
¡ride
()];

96  
	gcÚ¡_ÿ¡
<
	gSÿÏr
*>(
	gm_d©a
)[
row
 + 
cŞ
 * 
¡ride
()];

99 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

101 
ei_as£¹
(
D”ived
::
IsVeùÜAtCompeTime
 || (
ei_Œa™s
<D”ived>::
FÏgs
 & 
Lš—rAcûssB™
));

102 iàĞ((
	gRowsAtCompeTime
 =ğ1è=ğ
IsRowMajÜ
è|| !(
D”ived
::
IsVeùÜAtCompeTime
) )

103  
m_d©a
[
šdex
];

105  
	gm_d©a
[
šdex
*
¡ride
()];

108 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

110 
ei_as£¹
(
D”ived
::
IsVeùÜAtCompeTime
 || (
ei_Œa™s
<D”ived>::
FÏgs
 & 
Lš—rAcûssB™
));

111 iàĞ((
	gRowsAtCompeTime
 =ğ1è=ğ
IsRowMajÜ
è|| !(
D”ived
::
IsVeùÜAtCompeTime
) )

112  
cÚ¡_ÿ¡
<
SÿÏr
*>(
m_d©a
)[
šdex
];

114  
	gcÚ¡_ÿ¡
<
	gSÿÏr
*>(
	gm_d©a
)[
šdex
*
¡ride
()];

117 
	g‹m¶©e
<
	gLßdMode
>

118 
šlše
 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

120  
	gei_¶ßdt
<
	gSÿÏr
, (
	gPack‘Acûss
è=ğ
FÜûAligÃd
 ? 
AligÃd
 : 
LßdMode
>

121 (
m_d©a
 + (
IsRowMajÜ
 ? 
cŞ
 + 
row
 * 
¡ride
()

122 : 
row
 + 
cŞ
 * 
¡ride
()));

125 
	g‹m¶©e
<
	gLßdMode
>

126 
šlše
 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

128  
	gei_¶ßdt
<
	gSÿÏr
, (
	gPack‘Acûss
è=ğ
FÜûAligÃd
 ? 
AligÃd
 : 
LßdMode
>(
m_d©a
 + 
šdex
);

131 
	g‹m¶©e
<
	gStÜeMode
>

132 
šlše
 
wr™ePack‘
(
row
, 
cŞ
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

134 
	gei_p¡Ü‘
<
	gSÿÏr
, 
	gPack‘SÿÏr
, (
	gPack‘Acûss
è=ğ
FÜûAligÃd
 ? 
AligÃd
 : 
StÜeMode
>

135 (
cÚ¡_ÿ¡
<
SÿÏr
*>(
m_d©a
è+ (
IsRowMajÜ
 ? 
cŞ
 + 
row
 * 
¡ride
()

136 : 
row
 + 
cŞ
 * 
¡ride
()), 
	gx
);

139 
	g‹m¶©e
<
	gStÜeMode
>

140 
šlše
 
wr™ePack‘
(
šdex
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

142 
	gei_p¡Ü‘
<
	gSÿÏr
, 
	gPack‘SÿÏr
, (
	gPack‘Acûss
è=ğ
FÜûAligÃd
 ? 
AligÃd
 : 
StÜeMode
>

143 (
cÚ¡_ÿ¡
<
SÿÏr
*>(
m_d©a
è+ 
šdex
, 
	gx
);

146 
šlše
 
M­Ba£
(cÚ¡ 
SÿÏr
* 
d©a
è: 
m_d©a
(d©a), 
m_rows
(
RowsAtCompeTime
), 
m_cŞs
(
CŞsAtCompeTime
)

148 
EIGEN_STATIC_ASSERT_FIXED_SIZE
(
D”ived
)

151 
šlše
 
M­Ba£
(cÚ¡ 
SÿÏr
* 
d©a
, 
size
)

152 : 
m_d©a
(
d©a
),

153 
m_rows
(
RowsAtCompeTime
 =ğ
DyÇmic
 ? 
size
 : RowsAtCompileTime),

154 
m_cŞs
(
CŞsAtCompeTime
 =ğ
DyÇmic
 ? 
size
 : ColsAtCompileTime)

156 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

157 
ei_as£¹
(
size
 > 0 || 
d©a
 == 0);

158 
ei_as£¹
(
SizeAtCompeTime
 =ğ
DyÇmic
 || SizeAtCompeTim=ğ
size
);

161 
šlše
 
M­Ba£
(cÚ¡ 
SÿÏr
* 
d©a
, 
rows
, 
cŞs
)

162 : 
m_d©a
(
d©a
), 
m_rows
(
rows
), 
m_cŞs
(
cŞs
)

164 
ei_as£¹
Ğ(
d©a
 == 0)

165 || ( 
rows
 > 0 && (
RowsAtCompeTime
 =ğ
DyÇmic
 || RowsAtCompileTime ==„ows)

166 && 
cŞs
 > 0 && (
CŞsAtCompeTime
 =ğ
DyÇmic
 || ColsAtCompileTime == cols)));

169 
	gD”ived
& 
	gİ”©Ü
=(cÚ¡ 
M­Ba£
& 
Ùh”
)

171  
Ba£
::
İ”©Ü
=(
Ùh”
);

174 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

175 
	gD”ived
& 
	gİ”©Ü
=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

177  
Ba£
::
İ”©Ü
=(
Ùh”
);

180 
usšg
 
	gBa£
::
İ”©Ü
*=;

182 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

183 
	gD”ived
& 
	gİ”©Ü
+=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

184 {  
d”ived
(èğ
fÜûAligÃd
(è+ 
Ùh”
; }

186 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

187 
	gD”ived
& 
	gİ”©Ü
-=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

188 {  
d”ived
(èğ
fÜûAligÃd
(è- 
Ùh”
; }

190 
	gD”ived
& 
	gİ”©Ü
*=(cÚ¡ 
SÿÏr
& 
Ùh”
)

191 {  
d”ived
(èğ
fÜûAligÃd
(è* 
Ùh”
; }

193 
	gD”ived
& 
	gİ”©Ü
/=(cÚ¡ 
SÿÏr
& 
Ùh”
)

194 {  
d”ived
(èğ
fÜûAligÃd
(è/ 
Ùh”
; }

196 
	g´Ùeùed
:

197 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
m_d©a
;

198 cÚ¡ 
	gei_št_if_dyÇmic
<
	gRowsAtCompeTime
> 
	gm_rows
;

199 cÚ¡ 
	gei_št_if_dyÇmic
<
	gCŞsAtCompeTime
> 
	gm_cŞs
;

	@robot/Eigen/src/Core/MathFunctions.h

25 #iâdeà
EIGEN_MATHFUNCTIONS_H


26 
	#EIGEN_MATHFUNCTIONS_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
y³Çm
	gNumT¿™s
<T>::
R—l
 
´ecisiÚ
();

29 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
y³Çm
	gNumT¿™s
<T>::
R—l
 
machše_•sÚ
();

30 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
 
ei_¿ndom
(T 
a
, T 
b
);

31 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
 
ei_¿ndom
();

32 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
 
	$ei_¿ndom_am¶™ude
()

34 if(
NumT¿™s
<
T
>::
HasFlßtšgPošt
è 
¡©ic_ÿ¡
<T>(1);

35  
¡©ic_ÿ¡
<
T
>(10);

36 
	}
}

42 
	g‹m¶©e
<> 
šlše
 
	g´ecisiÚ
<>() {  0; }

43 
	g‹m¶©e
<> 
šlše
 
	gmachše_•sÚ
<>() {  0; }

44 
šlše
 
	$ei_»®
(
x
è{  x; 
	}
}

45 
šlše
 
	$ei_imag
(è{  0; 
	}
}

46 
šlše
 
	$ei_cÚj
(
x
è{  x; 
	}
}

47 
šlše
 
	$ei_abs
(
x
è{  
¡d
::
	`abs
(x); 
	}
}

48 
šlše
 
	$ei_abs2
(
x
è{  x*x; 
	}
}

49 
šlše
 
	$ei_sq¹
(è{ 
	`ei_as£¹
(
çl£
);  0; 
	}
}

50 
šlše
 
	$ei_exp
(è{ 
	`ei_as£¹
(
çl£
);  0; 
	}
}

51 
šlše
 
	$ei_log
(è{ 
	`ei_as£¹
(
çl£
);  0; 
	}
}

52 
šlše
 
	$ei_sš
(è{ 
	`ei_as£¹
(
çl£
);  0; 
	}
}

53 
šlše
 
	$ei_cos
(è{ 
	`ei_as£¹
(
çl£
);  0; 
	}
}

54 
šlše
 
	$ei_©ª2
(, è{ 
	`ei_as£¹
(
çl£
);  0; 
	}
}

55 
šlše
 
	$ei_pow
(
x
, 
y
è{  (
¡d
::
	`pow
((x), y)); 
	}
}

57 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
(
a
, 
b
)

60  
a
 + 
¡©ic_ÿ¡
<>((
b
-a+1è* (
¡d
::
	`¿nd
(è/ (
RAND_MAX
 + 1.0)));

61 
	}
}

62 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
()

64  
ei_¿ndom
<>(-
ei_¿ndom_am¶™ude
<>(),ƒi_random_amplitude<>());

65 
	}
}

66 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(
a
, , ğ
´ecisiÚ
<>())

68  
a
 == 0;

70 
šlše
 
boŞ
 
ei_isAµrox
(
a
, 
b
, ğ
´ecisiÚ
<>())

72  
a
 =ğ
b
;

74 
šlše
 
boŞ
 
ei_isAµroxOrLessThª
(
a
, 
b
, ğ
´ecisiÚ
<>())

76  
a
 <ğ
b
;

83 
	g‹m¶©e
<> 
šlše
 
	g´ecisiÚ
<>() {  1e-5f; }

84 
	g‹m¶©e
<> 
šlše
 
	gmachše_•sÚ
<>() {  1.192e-07f; }

85 
šlše
 
	$ei_»®
(
x
è{  x; 
	}
}

86 
šlše
 
	$ei_imag
(è{  0.f; 
	}
}

87 
šlše
 
	$ei_cÚj
(
x
è{  x; 
	}
}

88 
šlše
 
	$ei_abs
(
x
è{  
¡d
::
	`abs
(x); 
	}
}

89 
šlše
 
	$ei_abs2
(
x
è{  x*x; 
	}
}

90 
šlše
 
	$ei_sq¹
(
x
è{  
¡d
::
	`sq¹
(x); 
	}
}

91 
šlše
 
	$ei_exp
(
x
è{  
¡d
::
	`exp
(x); 
	}
}

92 
šlše
 
	$ei_log
(
x
è{  
¡d
::
	`log
(x); 
	}
}

93 
šlše
 
	$ei_sš
(
x
è{  
¡d
::
	`sš
(x); 
	}
}

94 
šlše
 
	$ei_cos
(
x
è{  
¡d
::
	`cos
(x); 
	}
}

95 
šlše
 
	$ei_©ª2
(
y
, 
x
è{  
¡d
::
	`©ª2
(y,x); 
	}
}

96 
šlše
 
	$ei_pow
(
x
, 
y
è{  
¡d
::
	`pow
(x, y); 
	}
}

98 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
(
a
, 
b
)

100 #ifdeà
EIGEN_NICE_RANDOM


101 
i
;

102 dØ{ 
i
 = 
ei_¿ndom
<>(256*(
a
),256*(
b
));

103 } 
i
==0);

104  (
i
)/256.f;

106  
a
 + (
b
-aè* (
¡d
::
	`¿nd
()è/ (
RAND_MAX
);

108 
	}
}

109 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
()

111  
ei_¿ndom
<>(-
ei_¿ndom_am¶™ude
<>(),ƒi_random_amplitude<>());

112 
	}
}

113 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

115  
ei_abs
(
a
è<ğei_abs(
b
è* 
´ec
;

117 
šlše
 
boŞ
 
ei_isAµrox
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

119  
ei_abs
(
a
 - 
b
è<ğ
¡d
::
mš
Ói_abs×),ƒi_abs(b)è* 
	g´ec
;

121 
šlše
 
boŞ
 
ei_isAµroxOrLessThª
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

123  
a
 <ğ
b
 || 
ei_isAµrox
×, b, 
´ec
);

130 
	g‹m¶©e
<> 
šlše
 
	g´ecisiÚ
<>() {  1e-11; }

131 
	g‹m¶©e
<> 
šlše
 
	gmachše_•sÚ
<>() {  2.220e-16; }

133 
šlše
 
	$ei_»®
(
x
è{  x; 
	}
}

134 
šlše
 
	$ei_imag
(è{  0.; 
	}
}

135 
šlše
 
	$ei_cÚj
(
x
è{  x; 
	}
}

136 
šlše
 
	$ei_abs
(
x
è{  
¡d
::
	`abs
(x); 
	}
}

137 
šlše
 
	$ei_abs2
(
x
è{  x*x; 
	}
}

138 
šlše
 
	$ei_sq¹
(
x
è{  
¡d
::
	`sq¹
(x); 
	}
}

139 
šlše
 
	$ei_exp
(
x
è{  
¡d
::
	`exp
(x); 
	}
}

140 
šlše
 
	$ei_log
(
x
è{  
¡d
::
	`log
(x); 
	}
}

141 
šlše
 
	$ei_sš
(
x
è{  
¡d
::
	`sš
(x); 
	}
}

142 
šlše
 
	$ei_cos
(
x
è{  
¡d
::
	`cos
(x); 
	}
}

143 
šlše
 
	$ei_©ª2
(
y
, 
x
è{  
¡d
::
	`©ª2
(y,x); 
	}
}

144 
šlše
 
	$ei_pow
(
x
, 
y
è{  
¡d
::
	`pow
(x, y); 
	}
}

146 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
(
a
, 
b
)

148 #ifdeà
EIGEN_NICE_RANDOM


149 
i
;

150 dØ{ 
i
ğ
ei_¿ndom
<>(256*(
a
),256*(
b
));

151 } 
i
==0);

152  
i
/256.;

154  
a
 + (
b
-aè* 
¡d
::
	`¿nd
(è/ 
RAND_MAX
;

156 
	}
}

157 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
()

159  
ei_¿ndom
<>(-
ei_¿ndom_am¶™ude
<>(),ƒi_random_amplitude<>());

160 
	}
}

161 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

163  
ei_abs
(
a
è<ğei_abs(
b
è* 
´ec
;

165 
šlše
 
boŞ
 
ei_isAµrox
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

167  
ei_abs
(
a
 - 
b
è<ğ
¡d
::
mš
Ói_abs×),ƒi_abs(b)è* 
	g´ec
;

169 
šlše
 
boŞ
 
ei_isAµroxOrLessThª
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

171  
a
 <ğ
b
 || 
ei_isAµrox
×, b, 
´ec
);

178 
	g‹m¶©e
<> 
šlše
 
	g´ecisiÚ
<
	g¡d
::
com¶ex
<> >(è{  
´ecisiÚ
<>(); }

179 
	g‹m¶©e
<> 
šlše
 
	gmachše_•sÚ
<
	g¡d
::
com¶ex
<> >(è{  
machše_•sÚ
<>(); }

180 
šlše
 
ei_»®
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
»®
(x); }

181 
šlše
 
ei_imag
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
imag
(x); }

182 
šlše
 
	g¡d
::
com¶ex
<> 
ei_cÚj
(cÚ¡ 
¡d
::com¶ex<>& 
x
è{  std::
cÚj
(x); }

183 
šlše
 
ei_abs
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
abs
(x); }

184 
šlše
 
ei_abs2
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
nÜm
(x); }

185 
šlše
 
	g¡d
::
com¶ex
<> 
ei_exp
(
¡d
::com¶ex<> 
x
è{  std::
exp
(x); }

186 
šlše
 
	g¡d
::
com¶ex
<> 
ei_sš
(
¡d
::com¶ex<> 
x
è{  std::
sš
(x); }

187 
šlše
 
	g¡d
::
com¶ex
<> 
ei_cos
(
¡d
::com¶ex<> 
x
è{  std::
cos
(x); }

188 
šlše
 
	g¡d
::
com¶ex
<> 
ei_©ª2
(
¡d
::com¶ex<>, std::com¶ex<> ) { 
ei_as£¹
(
çl£
);  0; }

190 
	g‹m¶©e
<> 
šlše
 
	g¡d
::
com¶ex
<> 
	$ei_¿ndom
()

192  
¡d
::
com¶ex
<>(
ei_¿ndom
<>(),ƒi_random<>());

193 
	}
}

194 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(cÚ¡ 
¡d
::
com¶ex
<>& 
a
, cÚ¡ std::com¶ex<>& 
b
, 
´ec
 = 
´ecisiÚ
<>())

196  
ei_abs2
(
a
è<ğei_abs2(
b
è* 
´ec
 *…rec;

198 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(cÚ¡ 
¡d
::
com¶ex
<>& 
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

200  
ei_abs2
(
a
è<ğei_abs2(
b
è* 
´ec
 *…rec;

202 
šlše
 
boŞ
 
ei_isAµrox
(cÚ¡ 
¡d
::
com¶ex
<>& 
a
, cÚ¡ std::com¶ex<>& 
b
, 
´ec
 = 
´ecisiÚ
<>())

204  
ei_isAµrox
(
ei_»®
(
a
),ƒi_»®(
b
), 
´ec
)

205 && 
ei_isAµrox
(
ei_imag
(
a
),ƒi_imag(
b
), 
´ec
);

213 
	g‹m¶©e
<> 
šlše
 
	g´ecisiÚ
<
	g¡d
::
com¶ex
<> >(è{  
´ecisiÚ
<>(); }

214 
	g‹m¶©e
<> 
šlše
 
	gmachše_•sÚ
<
	g¡d
::
com¶ex
<> >(è{  
machše_•sÚ
<>(); }

215 
šlše
 
ei_»®
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
»®
(x); }

216 
šlše
 
ei_imag
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
imag
(x); }

217 
šlše
 
	g¡d
::
com¶ex
<> 
ei_cÚj
(cÚ¡ 
¡d
::com¶ex<>& 
x
è{  std::
cÚj
(x); }

218 
šlše
 
ei_abs
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
abs
(x); }

219 
šlše
 
ei_abs2
(cÚ¡ 
¡d
::
com¶ex
<>& 
x
è{  std::
nÜm
(x); }

220 
šlše
 
	g¡d
::
com¶ex
<> 
ei_exp
(
¡d
::com¶ex<> 
x
è{  std::
exp
(x); }

221 
šlše
 
	g¡d
::
com¶ex
<> 
ei_sš
(
¡d
::com¶ex<> 
x
è{  std::
sš
(x); }

222 
šlše
 
	g¡d
::
com¶ex
<> 
ei_cos
(
¡d
::com¶ex<> 
x
è{  std::
cos
(x); }

223 
šlše
 
	g¡d
::
com¶ex
<> 
ei_©ª2
(
¡d
::com¶ex<>, std::com¶ex<>è{ 
ei_as£¹
(
çl£
);  0; }

225 
	g‹m¶©e
<> 
šlše
 
	g¡d
::
com¶ex
<> 
	$ei_¿ndom
()

227  
¡d
::
com¶ex
<>(
ei_¿ndom
<>(),ƒi_random<>());

228 
	}
}

229 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(cÚ¡ 
¡d
::
com¶ex
<>& 
a
, cÚ¡ std::com¶ex<>& 
b
, 
´ec
 = 
´ecisiÚ
<>())

231  
ei_abs2
(
a
è<ğei_abs2(
b
è* 
´ec
 *…rec;

233 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(cÚ¡ 
¡d
::
com¶ex
<>& 
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

235  
ei_abs2
(
a
è<ğei_abs2(
b
è* 
´ec
 *…rec;

237 
šlše
 
boŞ
 
ei_isAµrox
(cÚ¡ 
¡d
::
com¶ex
<>& 
a
, cÚ¡ std::com¶ex<>& 
b
, 
´ec
 = 
´ecisiÚ
<>())

239  
ei_isAµrox
(
ei_»®
(
a
),ƒi_»®(
b
), 
´ec
)

240 && 
ei_isAµrox
(
ei_imag
(
a
),ƒi_imag(
b
), 
´ec
);

249 
	g‹m¶©e
<> 
šlše
 
	g´ecisiÚ
<>() { …recision<>(); }

250 
	g‹m¶©e
<> 
šlše
 
	gmachše_•sÚ
<>() {  1.084e-19l; }

251 
šlše
 
	$ei_»®
(
x
è{  x; 
	}
}

252 
šlše
 
	$ei_imag
(è{  0.; 
	}
}

253 
šlše
 
	$ei_cÚj
(
x
è{  x; 
	}
}

254 
šlše
 
	$ei_abs
(
x
è{  
¡d
::
	`abs
(x); 
	}
}

255 
šlše
 
	$ei_abs2
(
x
è{  x*x; 
	}
}

256 
šlše
 
	$ei_sq¹
(
x
è{  
¡d
::
	`sq¹
(x); 
	}
}

257 
šlše
 
	$ei_exp
(
x
è{  
¡d
::
	`exp
(x); 
	}
}

258 
šlše
 
	$ei_log
(
x
è{  
¡d
::
	`log
(x); 
	}
}

259 
šlše
 
	$ei_sš
(
x
è{  
¡d
::
	`sš
(x); 
	}
}

260 
šlše
 
	$ei_cos
(
x
è{  
¡d
::
	`cos
(x); 
	}
}

261 
šlše
 
	$ei_©ª2
(
y
, 
x
è{  
¡d
::
	`©ª2
(y,x); 
	}
}

262 
šlše
 
	$ei_pow
(
x
, 
y
è{  
¡d
::
	`pow
(x, y); 
	}
}

264 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
(
a
, 
b
)

266  
ei_¿ndom
<>(
¡©ic_ÿ¡
<>(
a
),¡©ic_ÿ¡<>(
b
));

267 
	}
}

268 
	g‹m¶©e
<> 
šlše
 
	$ei_¿ndom
()

270  
ei_¿ndom
<>(-
ei_¿ndom_am¶™ude
<>(),ƒi_random_amplitude<>());

271 
	}
}

272 
šlše
 
boŞ
 
ei_isMuchSm®ËrThª
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

274  
ei_abs
(
a
è<ğei_abs(
b
è* 
´ec
;

276 
šlše
 
boŞ
 
ei_isAµrox
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

278  
ei_abs
(
a
 - 
b
è<ğ
¡d
::
mš
Ói_abs×),ƒi_abs(b)è* 
	g´ec
;

280 
šlše
 
boŞ
 
ei_isAµroxOrLessThª
(
a
, 
b
, 
´ec
 = 
´ecisiÚ
<>())

282  
a
 <ğ
b
 || 
ei_isAµrox
×, b, 
´ec
);

285 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
 
	$ei_hypÙ
(
T
 
x
, T 
y
)

287 
T
 
_x
 = 
	`ei_abs
(
x
);

288 
T
 
_y
 = 
	`ei_abs
(
y
);

289 
T
 
p
 = 
¡d
::
	`max
(
_x
, 
_y
);

290 
T
 
q
 = 
¡d
::
	`mš
(
_x
, 
_y
);

291 
T
 
qp
 = 
q
/
p
;

292  
p
 * 
	`ei_sq¹
(
	`T
(1è+ 
qp
*qp);

293 
	}
}

	@robot/Eigen/src/Core/Matrix.h

25 #iâdeà
EIGEN_MATRIX_H


26 
	#EIGEN_MATRIX_H


	)

28 #ifdeà
EIGEN_INITIALIZE_MATRICES_BY_ZERO


29 
	#EIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED
 
i
=0;i<
	`ba£
().
	`size
();++iè
	`cÛffRef
(i)=
	`SÿÏr
(0);

	)

31 
	#EIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED


	)

112 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

113 
	gei_Œa™s
<
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
> >

115 
_SÿÏr
 
	tSÿÏr
;

117 
	gRowsAtCompeTime
 = 
_Rows
,

118 
	gCŞsAtCompeTime
 = 
_CŞs
,

119 
	gMaxRowsAtCompeTime
 = 
_MaxRows
,

120 
	gMaxCŞsAtCompeTime
 = 
_MaxCŞs
,

121 
	gFÏgs
 = 
ei_compu‹_m©rix_æags
<
_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
»t
,

122 
	gCÛffR—dCo¡
 = 
NumT¿™s
<
SÿÏr
>::
R—dCo¡


126 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

127 
şass
 
	gM©rix


128 : 
public
 
M©rixBa£
<
M©rix
<
_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
> >

130 
	gpublic
:

131 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
M©rix
)

132 ’um { 
O±iÚs
 = 
_O±iÚs
 };

133 
ä›nd
 
şass
 
	gEig’
::
M­
<
M©rix
, 
	gUÇligÃd
>;

134 
şass
 
	tEig’
::
	tM­
<
	tM©rix
, 
	tUÇligÃd
> 
	tUÇligÃdM­Ty³
;

135 
ä›nd
 
şass
 
	gEig’
::
M­
<
M©rix
, 
	gAligÃd
>;

136 
şass
 
	tEig’
::
	tM­
<
	tM©rix
, 
	tAligÃd
> 
	tAligÃdM­Ty³
;

138 
	g´Ùeùed
:

139 
ei_m©rix_¡Üage
<
SÿÏr
, 
	gMaxSizeAtCompeTime
, 
	gRowsAtCompeTime
, 
	gCŞsAtCompeTime
, 
	gO±iÚs
> 
	gm_¡Üage
;

141 
	gpublic
:

142 ’um { 
N“dsToAlign
 = (
O±iÚs
&
AutoAlign
) == AutoAlign

143 && 
SizeAtCompeTime
!=
DyÇmic
 && (((
SÿÏr
)*SizeAtCompileTime)%16)==0 };

144 
EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF
(
N“dsToAlign
)

146 
	gBa£
& 
ba£
(è{  *
	g¡©ic_ÿ¡
<Ba£*>(
	gthis
); }

147 cÚ¡ 
	gBa£
& 
ba£
(ècÚ¡ {  *
	g¡©ic_ÿ¡
<cÚ¡ Ba£*>(
	gthis
); }

149 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_¡Üage
.rows(); }

150 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_¡Üage
.cols(); }

152 
EIGEN_STRONG_INLINE
 
¡ride
() const

154 if(
	gFÏgs
 & 
	gRowMajÜB™
)

155  
	gm_¡Üage
.
cŞs
();

157  
	gm_¡Üage
.
rows
();

160 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gSÿÏr
& 
cÛff
(
row
, 
cŞ
) const

162 if(
	gFÏgs
 & 
	gRowMajÜB™
)

163  
	gm_¡Üage
.
d©a
()[
cŞ
 + 
row
 * 
m_¡Üage
.
cŞs
()];

165  
	gm_¡Üage
.
d©a
()[
row
 + 
cŞ
 * 
m_¡Üage
.
rows
()];

168 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gSÿÏr
& 
cÛff
(
šdex
) const

170  
	gm_¡Üage
.
d©a
()[
šdex
];

173 
EIGEN_STRONG_INLINE
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

175 if(
	gFÏgs
 & 
	gRowMajÜB™
)

176  
	gm_¡Üage
.
d©a
()[
cŞ
 + 
row
 * 
m_¡Üage
.
cŞs
()];

178  
	gm_¡Üage
.
d©a
()[
row
 + 
cŞ
 * 
m_¡Üage
.
rows
()];

181 
EIGEN_STRONG_INLINE
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

183  
	gm_¡Üage
.
d©a
()[
šdex
];

186 
	g‹m¶©e
<
	gLßdMode
>

187 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

189  
	gei_¶ßdt
<
	gSÿÏr
, 
	gLßdMode
>

190 (
	gm_¡Üage
.
d©a
(è+ (
	gFÏgs
 & 
	gRowMajÜB™


191 ? 
	gcŞ
 + 
row
 * 
	gm_¡Üage
.
cŞs
()

192 : 
row
 + 
cŞ
 * 
m_¡Üage
.
rows
()));

195 
	g‹m¶©e
<
	gLßdMode
>

196 
EIGEN_STRONG_INLINE
 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

198  
	gei_¶ßdt
<
	gSÿÏr
, 
	gLßdMode
>(
	gm_¡Üage
.
d©a
(è+ 
	gšdex
);

201 
	g‹m¶©e
<
	gStÜeMode
>

202 
EIGEN_STRONG_INLINE
 
wr™ePack‘
(
row
, 
cŞ
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

204 
	gei_p¡Ü‘
<
	gSÿÏr
, 
	gPack‘SÿÏr
, 
	gStÜeMode
>

205 (
	gm_¡Üage
.
d©a
(è+ (
	gFÏgs
 & 
	gRowMajÜB™


206 ? 
	gcŞ
 + 
row
 * 
	gm_¡Üage
.
cŞs
()

207 : 
row
 + 
cŞ
 * 
m_¡Üage
.
rows
()), 
	gx
);

210 
	g‹m¶©e
<
	gStÜeMode
>

211 
EIGEN_STRONG_INLINE
 
wr™ePack‘
(
šdex
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

213 
	gei_p¡Ü‘
<
	gSÿÏr
, 
	gPack‘SÿÏr
, 
	gStÜeMode
>(
	gm_¡Üage
.
d©a
(è+ 
	gšdex
, 
	gx
);

217 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 *
d©a
() const

218 {  
	gm_¡Üage
.
d©a
(); }

221 
EIGEN_STRONG_INLINE
 
SÿÏr
 *
d©a
()

222 {  
	gm_¡Üage
.
d©a
(); }

235 
šlše
 
»size
(
rows
, 
cŞs
)

237 
ei_as£¹
((
MaxRowsAtCompeTime
 =ğ
DyÇmic
 || MaxRowsAtCompeTim>ğ
rows
)

238 && (
RowsAtCompeTime
 =ğ
DyÇmic
 || RowsAtCompeTim=ğ
rows
)

239 && (
MaxCŞsAtCompeTime
 =ğ
DyÇmic
 || MaxCŞsAtCompeTim>ğ
cŞs
)

240 && (
CŞsAtCompeTime
 =ğ
DyÇmic
 || CŞsAtCompeTim=ğ
cŞs
));

241 #ifdeà
EIGEN_INITIALIZE_MATRICES_BY_ZERO


242 
	gsize
 = 
rows
*
cŞs
;

243 
boŞ
 
	gsize_chªged
 = 
size
 !ğ
this
->size();

244 
	gm_¡Üage
.
»size
(
size
, 
rows
, 
cŞs
);

245 if(
	gsize_chªged
è
	gEIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED


247 
	gm_¡Üage
.
»size
(
rows
*
cŞs
,„ows, cols);

255 
šlše
 
»size
(
size
)

257 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
M©rix
)

258 
ei_as£¹
(
SizeAtCompeTime
 =ğ
DyÇmic
 || SizeAtCompeTim=ğ
size
);

259 #ifdeà
EIGEN_INITIALIZE_MATRICES_BY_ZERO


260 
boŞ
 
	gsize_chªged
 = 
size
 !ğ
this
->size();

262 if(
	gRowsAtCompeTime
 == 1)

263 
m_¡Üage
.
»size
(
size
, 1, size);

265 
	gm_¡Üage
.
»size
(
size
, size, 1);

266 #ifdeà
EIGEN_INITIALIZE_MATRICES_BY_ZERO


267 if(
	gsize_chªged
è
	gEIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED


280 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

281 
EIGEN_STRONG_INLINE
 
	gM©rix
& 
	gİ”©Ü
=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

283  
_£t
(
Ùh”
);

289 
EIGEN_STRONG_INLINE
 
	gM©rix
& 
	gİ”©Ü
=(cÚ¡ 
M©rix
& 
Ùh”
)

291  
_£t
(
Ùh”
);

294 
EIGEN_INHERIT_ASSIGNMENT_OPERATOR
(
M©rix
, +=)

295 
EIGEN_INHERIT_ASSIGNMENT_OPERATOR
(
M©rix
, -=)

296 
EIGEN_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
M©rix
, *=)

297 
EIGEN_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
M©rix
, /=)

309 
EIGEN_STRONG_INLINE
 
ex¶ic™
 
M©rix
(è: 
m_¡Üage
()

311 
_check_‹m¶©e_·¿ms
();

312 
	gEIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED


315 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


317 
M©rix
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
)

318 : 
m_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
())

319 {
EIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED
}

328 
EIGEN_STRONG_INLINE
 
ex¶ic™
 
M©rix
(
dim
)

329 : 
m_¡Üage
(
dim
, 
RowsAtCompeTime
 =ğ1 ? 1 : dim, 
CŞsAtCompeTime
 == 1 ? 1 : dim)

331 
_check_‹m¶©e_·¿ms
();

332 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
M©rix
)

333 
ei_as£¹
(
dim
 > 0);

334 
ei_as£¹
(
SizeAtCompeTime
 =ğ
DyÇmic
 || SizeAtCompeTim=ğ
dim
);

335 
	gEIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED


348 
EIGEN_STRONG_INLINE
 
M©rix
(
x
, 
y
è: 
m_¡Üage
(x*y, x, y)

350 
_check_‹m¶©e_·¿ms
();

351 if((
	gRowsAtCompeTime
 =ğ1 && 
CŞsAtCompeTime
 == 2)

352 || (
RowsAtCompeTime
 =ğ2 && 
CŞsAtCompeTime
 == 1))

354 
m_¡Üage
.
d©a
()[0] = 
SÿÏr
(
x
);

355 
	gm_¡Üage
.
d©a
()[1] = 
SÿÏr
(
y
);

359 
ei_as£¹
(
x
 > 0 && (
RowsAtCompeTime
 =ğ
DyÇmic
 || RowsAtCompileTime == x)

360 && 
y
 > 0 && (
CŞsAtCompeTime
 =ğ
DyÇmic
 || ColsAtCompileTime == y));

361 
	gEIGEN_INITIALIZE_BY_ZERO_IF_THAT_OPTION_IS_ENABLED


365 
EIGEN_STRONG_INLINE
 
M©rix
(cÚ¡ & 
x
, cÚ¡ & 
y
)

367 
_check_‹m¶©e_·¿ms
();

368 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
M©rix
, 2)

369 
	gm_¡Üage
.
d©a
()[0] = 
x
;

370 
	gm_¡Üage
.
d©a
()[1] = 
y
;

373 
EIGEN_STRONG_INLINE
 
M©rix
(cÚ¡ & 
x
, cÚ¡ & 
y
)

375 
_check_‹m¶©e_·¿ms
();

376 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
M©rix
, 2)

377 
	gm_¡Üage
.
d©a
()[0] = 
x
;

378 
	gm_¡Üage
.
d©a
()[1] = 
y
;

381 
EIGEN_STRONG_INLINE
 
M©rix
(cÚ¡ 
SÿÏr
& 
x
, cÚ¡ SÿÏr& 
y
, cÚ¡ SÿÏr& 
z
)

383 
_check_‹m¶©e_·¿ms
();

384 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
M©rix
, 3)

385 
	gm_¡Üage
.
d©a
()[0] = 
x
;

386 
	gm_¡Üage
.
d©a
()[1] = 
y
;

387 
	gm_¡Üage
.
d©a
()[2] = 
z
;

390 
EIGEN_STRONG_INLINE
 
M©rix
(cÚ¡ 
SÿÏr
& 
x
, cÚ¡ SÿÏr& 
y
, cÚ¡ SÿÏr& 
z
, cÚ¡ SÿÏr& 
w
)

392 
_check_‹m¶©e_·¿ms
();

393 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
M©rix
, 4)

394 
	gm_¡Üage
.
d©a
()[0] = 
x
;

395 
	gm_¡Üage
.
d©a
()[1] = 
y
;

396 
	gm_¡Üage
.
d©a
()[2] = 
z
;

397 
	gm_¡Üage
.
d©a
()[3] = 
w
;

400 
ex¶ic™
 
M©rix
(cÚ¡ 
SÿÏr
 *
d©a
);

403 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

404 
EIGEN_STRONG_INLINE
 
M©rix
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

405 : 
m_¡Üage
(
Ùh”
.
rows
(è* oth”.
cŞs
(), other.rows(), other.cols())

407 
_check_‹m¶©e_·¿ms
();

408 
_£t_nßlŸs
(
Ùh”
);

411 
EIGEN_STRONG_INLINE
 
M©rix
(cÚ¡ M©rix& 
Ùh”
)

412 : 
Ba£
(), 
m_¡Üage
(
Ùh”
.
rows
(è* oth”.
cŞs
(), other.rows(), other.cols())

414 
_check_‹m¶©e_·¿ms
();

415 
_£t_nßlŸs
(
Ùh”
);

418 
	gšlše
 ~
M©rix
() {}

423 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

424 
sw­
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

435 
šlše
 cÚ¡ 
UÇligÃdM­Ty³
 
M­
(cÚ¡ 
SÿÏr
* 
d©a
)

436 {  
UÇligÃdM­Ty³
(
d©a
); }

437 
šlše
 
UÇligÃdM­Ty³
 
M­
(
SÿÏr
* 
d©a
)

438 {  
UÇligÃdM­Ty³
(
d©a
); }

439 
šlše
 cÚ¡ 
UÇligÃdM­Ty³
 
M­
(cÚ¡ 
SÿÏr
* 
d©a
, 
size
)

440 {  
UÇligÃdM­Ty³
(
d©a
, 
size
); }

441 
šlše
 
UÇligÃdM­Ty³
 
M­
(
SÿÏr
* 
d©a
, 
size
)

442 {  
UÇligÃdM­Ty³
(
d©a
, 
size
); }

443 
šlše
 cÚ¡ 
UÇligÃdM­Ty³
 
M­
(cÚ¡ 
SÿÏr
* 
d©a
, 
rows
, 
cŞs
)

444 {  
UÇligÃdM­Ty³
(
d©a
, 
rows
, 
cŞs
); }

445 
šlše
 
UÇligÃdM­Ty³
 
M­
(
SÿÏr
* 
d©a
, 
rows
, 
cŞs
)

446 {  
UÇligÃdM­Ty³
(
d©a
, 
rows
, 
cŞs
); }

448 
šlše
 cÚ¡ 
AligÃdM­Ty³
 
M­AligÃd
(cÚ¡ 
SÿÏr
* 
d©a
)

449 {  
AligÃdM­Ty³
(
d©a
); }

450 
šlše
 
AligÃdM­Ty³
 
M­AligÃd
(
SÿÏr
* 
d©a
)

451 {  
AligÃdM­Ty³
(
d©a
); }

452 
šlše
 cÚ¡ 
AligÃdM­Ty³
 
M­AligÃd
(cÚ¡ 
SÿÏr
* 
d©a
, 
size
)

453 {  
AligÃdM­Ty³
(
d©a
, 
size
); }

454 
šlše
 
AligÃdM­Ty³
 
M­AligÃd
(
SÿÏr
* 
d©a
, 
size
)

455 {  
AligÃdM­Ty³
(
d©a
, 
size
); }

456 
šlše
 cÚ¡ 
AligÃdM­Ty³
 
M­AligÃd
(cÚ¡ 
SÿÏr
* 
d©a
, 
rows
, 
cŞs
)

457 {  
AligÃdM­Ty³
(
d©a
, 
rows
, 
cŞs
); }

458 
šlše
 
AligÃdM­Ty³
 
M­AligÃd
(
SÿÏr
* 
d©a
, 
rows
, 
cŞs
)

459 {  
AligÃdM­Ty³
(
d©a
, 
rows
, 
cŞs
); }

462 
usšg
 
	gBa£
::
£tCÚ¡ªt
;

463 
	gM©rix
& 
£tCÚ¡ªt
(
size
, cÚ¡ 
SÿÏr
& 
v®ue
);

464 
	gM©rix
& 
£tCÚ¡ªt
(
rows
, 
cŞs
, cÚ¡ 
SÿÏr
& 
v®ue
);

466 
usšg
 
	gBa£
::
£tZ”o
;

467 
	gM©rix
& 
£tZ”o
(
size
);

468 
	gM©rix
& 
£tZ”o
(
rows
, 
cŞs
);

470 
usšg
 
	gBa£
::
£tOÃs
;

471 
	gM©rix
& 
£tOÃs
(
size
);

472 
	gM©rix
& 
£tOÃs
(
rows
, 
cŞs
);

474 
usšg
 
	gBa£
::
£tRªdom
;

475 
	gM©rix
& 
£tRªdom
(
size
);

476 
	gM©rix
& 
£tRªdom
(
rows
, 
cŞs
);

478 
usšg
 
	gBa£
::
£tId’t™y
;

479 
	gM©rix
& 
£tId’t™y
(
rows
, 
cŞs
);

483 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

484 
ex¶ic™
 
M©rix
(cÚ¡ 
RÙ©iÚBa£
<
Oth”D”ived
,
CŞsAtCompeTime
>& 
r
);

485 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

486 
	gM©rix
& 
	gİ”©Ü
=(cÚ¡ 
RÙ©iÚBa£
<
Oth”D”ived
,
	gCŞsAtCompeTime
>& 
	gr
);

489 #ifdeà
EIGEN_MATRIX_PLUGIN


490 #šşud
EIGEN_MATRIX_PLUGIN


493 
	g´iv©e
:

501 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

502 
EIGEN_STRONG_INLINE
 
_»size_to_m©ch
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

504 if(
RowsAtCompeTime
 == 1)

506 
ei_as£¹
(
Ùh”
.
isVeùÜ
());

507 
»size
(1, 
Ùh”
.
size
());

509 if(
	gCŞsAtCompeTime
 == 1)

511 
ei_as£¹
(
Ùh”
.
isVeùÜ
());

512 
»size
(
Ùh”
.
size
(), 1);

514 
»size
(
Ùh”
.
rows
(), oth”.
cŞs
());

528 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

529 
EIGEN_STRONG_INLINE
 
	gM©rix
& 
_£t
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

532 ’um { 
	gcÚd
 = (
Oth”D”ived
::
FÏgs
è& 
Ev®BefÜeAssignšgB™
 };

533 
_£t_£ËùÜ
(
Ùh”
.
d”ived
(), 
ty³Çme
 
ei_m‘a_if
<
boŞ
(
cÚd
), 
ei_m‘a_Œue
, 
ei_m‘a_çl£
>::
»t
());

534  *
	gthis
;

537 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

538 
EIGEN_STRONG_INLINE
 
_£t_£ËùÜ
(cÚ¡ 
Oth”D”ived
& 
Ùh”
, cÚ¡ 
ei_m‘a_Œue
&è{ 
_£t_nßlŸs
(Ùh”.
ev®
()); }

540 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

541 
EIGEN_STRONG_INLINE
 
_£t_£ËùÜ
(cÚ¡ 
Oth”D”ived
& 
Ùh”
, cÚ¡ 
ei_m‘a_çl£
&è{ 
_£t_nßlŸs
(other); }

548 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

549 
EIGEN_STRONG_INLINE
 
	gM©rix
& 
_£t_nßlŸs
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

551 
_»size_to_m©ch
(
Ùh”
);

554  
	gei_assign_£ËùÜ
<
	gM©rix
,
	gOth”D”ived
,
	gçl£
>::
run
(*
this
, 
Ùh”
.
d”ived
());

557 
EIGEN_STRONG_INLINE
 
_check_‹m¶©e_·¿ms
()

559 
EIGEN_STATIC_ASSERT
((
_Rows
 > 0

560 && 
_CŞs
 > 0

561 && 
_MaxRows
 <ğ
_Rows


562 && 
_MaxCŞs
 <ğ
_CŞs


563 && (
_O±iÚs
 & (
AutoAlign
|
RowMajÜ
)) == _Options),

564 
INVALID_MATRIX_TEMPLATE_PARAMETERS
)

567 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
,y³Çm
	gOth”D”ived
, 
boŞ
 
	gIsSameTy³
, boŞ 
	gIsDyÇmicSize
>

568 
ä›nd
 
	gei_m©rix_sw­_im¶
;

571 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
,y³Çm
	gOth”D”ived
,

572 
boŞ
 
	gIsSameTy³
 = 
ei_is_§me_ty³
<
M©rixTy³
, 
	gOth”D”ived
>::
»t
,

573 
boŞ
 
	gIsDyÇmicSize
 = 
M©rixTy³
::
SizeAtCompeTime
==
DyÇmic
>

574 
	sei_m©rix_sw­_im¶


576 
šlše
 
run
(
M©rixTy³
& 
m©rix
, 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

578 
m©rix
.
ba£
().
sw­
(
Ùh”
);

582 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
,y³Çm
	gOth”D”ived
>

583 
	gei_m©rix_sw­_im¶
<
	gM©rixTy³
, 
	gOth”D”ived
, 
	gŒue
,rue>

585 
šlše
 
run
(
M©rixTy³
& 
m©rix
, 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

587 
	gm©rix
.
	gm_¡Üage
.
sw­
(
Ùh”
.
d”ived
().
m_¡Üage
);

591 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>

592 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

593 
šlše
 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
, 
	g_MaxRows
, 
	g_MaxCŞs
>::
sw­
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

596 
Eig’
::
ei_m©rix_sw­_im¶
<
M©rix
, 
	gOth”D”ived
>::
run
(*
this
, *
cÚ¡_ÿ¡
<
M©rixBa£
<
Oth”D”ived
>*>(&
Ùh”
));

620 
	#EIGEN_MAKE_TYPEDEFS
(
Ty³
, 
Ty³Suffix
, 
Size
, 
SizeSuffix
) \

622 
M©rix
<
	tTy³
, 
	tSize
, Size> 
	tM©rix
##
	tSizeSuffix
##
	tTy³Suffix
; \

624 
M©rix
<
	tTy³
, 
	tSize
, 1> 
	tVeùÜ
##
	tSizeSuffix
##
	tTy³Suffix
; \

626 
M©rix
<
	tTy³
, 1, 
	tSize
> 
	tRowVeùÜ
##
	tSizeSuffix
##
	tTy³Suffix
;

	)

628 
	#EIGEN_MAKE_TYPEDEFS_ALL_SIZES
(
Ty³
, 
Ty³Suffix
) \

629 
	`EIGEN_MAKE_TYPEDEFS
(
Ty³
, 
Ty³Suffix
, 2, 2) \

630 
	`EIGEN_MAKE_TYPEDEFS
(
Ty³
, 
Ty³Suffix
, 3, 3) \

631 
	`EIGEN_MAKE_TYPEDEFS
(
Ty³
, 
Ty³Suffix
, 4, 4) \

632 
	`EIGEN_MAKE_TYPEDEFS
(
Ty³
, 
Ty³Suffix
, 
DyÇmic
, 
X
)

	)

634 
	$EIGEN_MAKE_TYPEDEFS_ALL_SIZES
(, 
i
)

635 
	$EIGEN_MAKE_TYPEDEFS_ALL_SIZES
(, 
f
)

636 
	$EIGEN_MAKE_TYPEDEFS_ALL_SIZES
(, 
d
)

637 
	`EIGEN_MAKE_TYPEDEFS_ALL_SIZES
(
¡d
::
com¶ex
<>, 
cf
)

638 
	`EIGEN_MAKE_TYPEDEFS_ALL_SIZES
(
¡d
::
com¶ex
<>, 
cd
)

640 #undeà
EIGEN_MAKE_TYPEDEFS_ALL_SIZES


641 #undeà
EIGEN_MAKE_TYPEDEFS


643 #undeà
EIGEN_MAKE_TYPEDEFS_LARGE


645 
	#EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE_AND_SIZE
(
Ty³Suffix
, 
SizeSuffix
) \

646 
usšg
 
Eig’
::
M©rix
##
SizeSuffix
##
Ty³Suffix
; \

647 
usšg
 
Eig’
::
VeùÜ
##
SizeSuffix
##
Ty³Suffix
; \

648 
usšg
 
Eig’
::
RowVeùÜ
##
SizeSuffix
##
Ty³Suffix
;

	)

650 
	#EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE
(
Ty³Suffix
) \

651 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE_AND_SIZE
(
Ty³Suffix
, 2) \

652 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE_AND_SIZE
(
Ty³Suffix
, 3) \

653 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE_AND_SIZE
(
Ty³Suffix
, 4) \

654 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE_AND_SIZE
(
Ty³Suffix
, 
X
) \

655 

	)

656 
	#EIGEN_USING_MATRIX_TYPEDEFS
 \

657 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE
(
i
) \

658 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE
(
f
) \

659 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE
(
d
) \

660 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE
(
cf
) \

661 
	`EIGEN_USING_MATRIX_TYPEDEFS_FOR_TYPE
(
cd
)

	)

	@robot/Eigen/src/Core/MatrixBase.h

26 #iâdeà
EIGEN_MATRIXBASE_H


27 
	#EIGEN_MATRIXBASE_H


	)

55 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> cÏs 
	cM©rixBa£


57 
	mpublic
:

59 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


60 
şass
 
IÂ”I‹¿tÜ
;

62 
ty³Çme
 
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
 Scalar;

63 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

68 
	mRowsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
RowsAtCompeTime
,

74 
	mCŞsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
CŞsAtCompeTime
,

81 
	mSizeAtCompeTime
 = (
ei_size_©_compe_time
<
ei_Œa™s
<
D”ived
>::
RowsAtCompeTime
,

82 
	mei_Œa™s
<
	mD”ived
>::
CŞsAtCompeTime
>::
»t
),

87 
	mMaxRowsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
MaxRowsAtCompeTime
,

98 
	mMaxCŞsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
MaxCŞsAtCompeTime
,

109 
	mMaxSizeAtCompeTime
 = (
ei_size_©_compe_time
<
ei_Œa™s
<
D”ived
>::
MaxRowsAtCompeTime
,

110 
	mei_Œa™s
<
	mD”ived
>::
MaxCŞsAtCompeTime
>::
»t
),

121 
	mIsVeùÜAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
RowsAtCompeTime
 == 1

122 || 
ei_Œa™s
<
D”ived
>::
CŞsAtCompeTime
 == 1,

128 
	mFÏgs
 = 
ei_Œa™s
<
D”ived
>::
FÏgs
,

133 
	mCÛffR—dCo¡
 = 
ei_Œa™s
<
D”ived
>::
CÛffR—dCo¡


139 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


146 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

149 
	gM©rix
<
	tSÿÏr
,
	tEIGEN_ENUM_MAX
(
	tRowsAtCompeTime
,
	tCŞsAtCompeTime
),

150 
	tEIGEN_ENUM_MAX
(
	tRowsAtCompeTime
,
	tCŞsAtCompeTime
)> 
	tSqu¬eM©rixTy³
;

154 
šlše
 
	$rows
(ècÚ¡ {  
	`d”ived
().
	`rows
(); 
	}
}

156 
šlše
 
	$cŞs
(ècÚ¡ {  
	`d”ived
().
	`cŞs
(); 
	}
}

159 
šlše
 
	$size
(ècÚ¡ {  
	`rows
(è* 
	`cŞs
(); 
	}
}

162 
šlše
 
	$nÚZ”os
(ècÚ¡ {  
	`size
(); 
	}
}

167 
šlše
 
boŞ
 
	$isVeùÜ
(ècÚ¡ {  
	`rows
()==1 || 
	`cŞs
()==1; 
	}
}

170 
	$ou‹rSize
(ècÚ¡ {  ((
FÏgs
)&
RowMajÜB™
è? 
this
->
	`rows
(è:his->
	`cŞs
(); 
	}
}

173 
	$šÃrSize
(ècÚ¡ {  ((
FÏgs
)&
RowMajÜB™
è? 
this
->
	`cŞs
(è:his->
	`rows
(); 
	}
}

175 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


181 
ty³Çme
 
	tei_¶aš_m©rix_ty³
<
	tD”ived
>::
	tty³
 
	tPÏšM©rixTy³
;

187 
ty³Çme
 
	tei_¶aš_m©rix_ty³
<
	tD”ived
>::
	tty³
 
	tPÏšM©rixTy³_CŞMajÜ
;

190 
	gCwi£NuÎ¬yOp
<
	tei_sÿÏr_cÚ¡ªt_İ
<
	tSÿÏr
>,
	tD”ived
> 
	tCÚ¡ªtR‘uºTy³
;

192 
	gCwi£UÇryOp
<
	tei_sÿÏr_muÉË_İ
<
	tSÿÏr
>, 
	tD”ived
> 
	tSÿÏrMuÉËR‘uºTy³
;

194 
	gCwi£UÇryOp
<
	tei_sÿÏr_quÙ›Á1_İ
<
	tSÿÏr
>, 
	tD”ived
> 
	tSÿÏrQuÙ›Á1R‘uºTy³
;

196 
ty³Çme
 
	tei_m‘a_if
<
	tNumT¿™s
<
	tSÿÏr
>::
	tIsCom¶ex
,

197 cÚ¡ 
	tCwi£UÇryOp
<
	tei_sÿÏr_cÚjug©e_İ
<
	tSÿÏr
>, 
	tD”ived
>,

198 cÚ¡ 
	tD”ived
&

199 >::
	t»t
 
	tCÚjug©eR‘uºTy³
;

201 
	gCwi£UÇryOp
<
	tei_sÿÏr_»®_İ
<
	tSÿÏr
>, 
	tD”ived
> 
	tR—lR‘uºTy³
;

203 
	gCwi£UÇryOp
<
	tei_sÿÏr_imag_İ
<
	tSÿÏr
>, 
	tD”ived
> 
	tImagR‘uºTy³
;

205 
	gEig’
::
	tT¿n¥o£
<
	tNe¡ByV®ue
<
	tty³Çme
 
	tei_ş—Áy³
<
	tCÚjug©eR‘uºTy³
>::
	tty³
> >

206 
	tAdjoštR‘uºTy³
;

208 
	gM©rix
<
	tty³Çme
 
	tNumT¿™s
<ty³Çm
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
>::
	tR—l
,ƒi_Œa™s<D”ived>::
	tCŞsAtCompeTime
, 1> 
	tEig’v®uesR‘uºTy³
;

210 
	gBlock
<
	tD”ived
, 
	tei_Œa™s
<D”ived>::
	tRowsAtCompeTime
, 1> 
	tCŞX´
;

212 
	gBlock
<
	tD”ived
, 1, 
	tei_Œa™s
<D”ived>::
	tCŞsAtCompeTime
> 
	tRowX´
;

214 
	gCwi£NuÎ¬yOp
<
	tei_sÿÏr_id’t™y_İ
<
	tSÿÏr
>,
	tD”ived
> 
	tId’t™yR‘uºTy³
;

216 
	gBlock
<
	tCwi£NuÎ¬yOp
<
	tei_sÿÏr_id’t™y_İ
<
	tSÿÏr
>, 
	tSqu¬eM©rixTy³
>,

217 
	tei_Œa™s
<
	tD”ived
>::
	tRowsAtCompeTime
,

218 
	tei_Œa™s
<
	tD”ived
>::
	tCŞsAtCompeTime
> 
	tBasisR‘uºTy³
;

223 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

224 
	gD”ived
& 
	gİ”©Ü
=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

229 
šlše
 
	gD”ived
& 
	gİ”©Ü
=(cÚ¡ 
M©rixBa£
& 
Ùh”
)

231  
this
->
İ”©Ü
=<
D”ived
>(
Ùh”
);

234 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


236 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

237 
	gD”ived
& 
ÏzyAssign
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

240 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

241 
	gD”ived
& 
ÏzyAssign
(cÚ¡ 
Produù
<
Lhs
,
Rhs
,
CacheFr›ndlyProduù
>& 
´oduù
);

244 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

245 
	gD”ived
& 
ÏzyAssign
(cÚ¡ 
FÏgged
<
Oth”D”ived
, 0, 
Ev®BefÜeNe¡šgB™
 | 
Ev®BefÜeAssignšgB™
>& 
Ùh”
)

246 {  
ÏzyAssign
(
Ùh”
.
_ex´essiÚ
()); }

249 
	gCommaIn™Ÿliz”
<
	gD”ived
> 
	gİ”©Ü
<< (cÚ¡ 
	gSÿÏr
& 
	gs
);

251 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

252 
	gCommaIn™Ÿliz”
<
	gD”ived
> 
	gİ”©Ü
<< (cÚ¡ 
	gM©rixBa£
<
	gOth”D”ived
>& 
	gÙh”
);

254 cÚ¡ 
SÿÏr
 
	$cÛff
(
row
, 
cŞ
) const;

255 cÚ¡ 
SÿÏr
 
	$İ”©Ü
()(
row
, 
cŞ
) const;

257 
SÿÏr
& 
	`cÛffRef
(
row
, 
cŞ
);

258 
SÿÏr
& 
	$İ”©Ü
()(
row
, 
cŞ
);

260 cÚ¡ 
SÿÏr
 
	$cÛff
(
šdex
) const;

261 cÚ¡ 
SÿÏr
 
İ”©Ü
[](
šdex
) const;

262 cÚ¡ 
SÿÏr
 
	$İ”©Ü
()(
šdex
) const;

264 
SÿÏr
& 
	`cÛffRef
(
šdex
);

265 
SÿÏr
& 
İ”©Ü
[](
šdex
);

266 
SÿÏr
& 
	$İ”©Ü
()(
šdex
);

268 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


269 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

270 
	`cİyCÛff
(
row
, 
cŞ
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

271 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

272 
	`cİyCÛff
(
šdex
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

273 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
, 
StÜeMode
, 
LßdMode
>

274 
	`cİyPack‘
(
row
, 
cŞ
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

275 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
, 
StÜeMode
, 
LßdMode
>

276 
	`cİyPack‘
(
šdex
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

279 
‹m¶©e
<
LßdMode
>

280 
Pack‘SÿÏr
 
	$·ck‘
(
row
, 
cŞ
) const;

281 
‹m¶©e
<
StÜeMode
>

282 
	`wr™ePack‘
(
row
, 
cŞ
, cÚ¡ 
Pack‘SÿÏr
& 
x
);

284 
‹m¶©e
<
LßdMode
>

285 
Pack‘SÿÏr
 
	$·ck‘
(
šdex
) const;

286 
‹m¶©e
<
StÜeMode
>

287 
	`wr™ePack‘
(
šdex
, cÚ¡ 
Pack‘SÿÏr
& 
x
);

289 cÚ¡ 
SÿÏr
 
	$x
() const;

290 cÚ¡ 
SÿÏr
 
	$y
() const;

291 cÚ¡ 
SÿÏr
 
	$z
() const;

292 cÚ¡ 
SÿÏr
 
	$w
() const;

293 
SÿÏr
& 
	`x
();

294 
SÿÏr
& 
	`y
();

295 
SÿÏr
& 
	`z
();

296 
SÿÏr
& 
	`w
();

299 cÚ¡ 
Cwi£UÇryOp
<
ei_sÿÏr_İpos™e_İ
<
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
>,D”ived> 
İ”©Ü
-() const;

301 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

302 cÚ¡ 
Cwi£Bš¬yOp
<
ei_sÿÏr_sum_İ
<
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
>, D”ived, 
Oth”D”ived
>

303 
İ”©Ü
+(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

305 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

306 cÚ¡ 
Cwi£Bš¬yOp
<
ei_sÿÏr_difã»nû_İ
<
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
>, D”ived, 
Oth”D”ived
>

307 
İ”©Ü
-(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

309 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

310 
D”ived
& 
İ”©Ü
+=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

311 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

312 
D”ived
& 
İ”©Ü
-=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

314 
‹m¶©e
<
ty³Çme
 
Lhs
,ty³Çm
Rhs
>

315 
D”ived
& 
İ”©Ü
+=(cÚ¡ 
FÏgged
<
Produù
<
Lhs
,
Rhs
,
CacheFr›ndlyProduù
>, 0, 
Ev®BefÜeNe¡šgB™
 | 
Ev®BefÜeAssignšgB™
>& 
Ùh”
);

317 
D”ived
& 
İ”©Ü
*=(cÚ¡ 
SÿÏr
& 
Ùh”
);

318 
D”ived
& 
İ”©Ü
/=(cÚ¡ 
SÿÏr
& 
Ùh”
);

320 cÚ¡ 
SÿÏrMuÉËR‘uºTy³
 
İ”©Ü
*(cÚ¡ 
SÿÏr
& 
sÿÏr
) const;

321 cÚ¡ 
Cwi£UÇryOp
<
ei_sÿÏr_quÙ›Á1_İ
<
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
>, Derived>

322 
İ”©Ü
/(cÚ¡ 
SÿÏr
& 
sÿÏr
) const;

324 
šlše
 
ä›nd
 cÚ¡ 
Cwi£UÇryOp
<
ei_sÿÏr_muÉË_İ
<
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
>, Derived>

325 
İ”©Ü
*(cÚ¡ 
SÿÏr
& 
sÿÏr
, cÚ¡ 
M©rixBa£
& 
m©rix
)

326 {  
m©rix
*
sÿÏr
; 
	}
}

329 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

330 cÚ¡ 
ty³Çme
 
	gProduùR‘uºTy³
<
	gD”ived
,
	gOth”D”ived
>::
Ty³


331 
İ”©Ü
*(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

333 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

334 
	gD”ived
& 
	gİ”©Ü
*=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

336 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

337 
ty³Çme
 
	gei_¶aš_m©rix_ty³_cŞumn_majÜ
<
	gOth”D”ived
>::
ty³


338 
sŞveTrŸnguÏr
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

340 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

341 
sŞveTrŸnguÏrInPÏû
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

344 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

345 
SÿÏr
 
dÙ
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

346 
R—lSÿÏr
 
	$squ¬edNÜm
() const;

347 
R—lSÿÏr
 
	$nÜm
() const;

348 cÚ¡ 
PÏšM©rixTy³
 
	$nÜm®ized
() const;

349 
	`nÜm®ize
();

351 
Eig’
::
T¿n¥o£
<
D”ived
> 
	`Œª¥o£
();

352 cÚ¡ 
Eig’
::
T¿n¥o£
<
D”ived
> 
	$Œª¥o£
() const;

353 
	`Œª¥o£InPÏû
();

354 cÚ¡ 
AdjoštR‘uºTy³
 
	$adjošt
() const;

357 
RowX´
 
	`row
(
i
);

358 cÚ¡ 
RowX´
 
	$row
(
i
) const;

360 
CŞX´
 
	`cŞ
(
i
);

361 cÚ¡ 
CŞX´
 
	$cŞ
(
i
) const;

363 
MšÜ
<
D”ived
> 
	`mšÜ
(
row
, 
cŞ
);

364 cÚ¡ 
MšÜ
<
D”ived
> 
	$mšÜ
(
row
, 
cŞ
) const;

366 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
Ty³
 
	`block
(
¡¬tRow
, 
¡¬tCŞ
, 
blockRows
, 
blockCŞs
);

367 cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
Ty³


368 
	$block
(
¡¬tRow
, 
¡¬tCŞ
, 
blockRows
, 
blockCŞs
) const;

370 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
SubVeùÜTy³
 
	`£gm’t
(
¡¬t
, 
size
);

371 cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
SubVeùÜTy³
 
	$£gm’t
(
¡¬t
, 
size
) const;

373 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,
DyÇmic
>::
SubVeùÜTy³
 
	`¡¬t
(
size
);

374 cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,
DyÇmic
>::
SubVeùÜTy³
 
	$¡¬t
(
size
) const;

376 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,
DyÇmic
>::
SubVeùÜTy³
 
	`’d
(
size
);

377 cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,
DyÇmic
>::
SubVeùÜTy³
 
	$’d
(
size
) const;

379 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
Ty³
 
	`cÜÃr
(
CÜÃrTy³
 
ty³
, 
cRows
, 
cCŞs
);

380 cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
>::
Ty³
 
	$cÜÃr
(
CÜÃrTy³
 
ty³
, 
cRows
, 
cCŞs
) const;

382 
‹m¶©e
<
BlockRows
, 
BlockCŞs
>

383 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
, 
BlockRows
, 
BlockCŞs
>::
Ty³
 
	`block
(
¡¬tRow
, 
¡¬tCŞ
);

384 
‹m¶©e
<
BlockRows
, 
BlockCŞs
>

385 cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
, 
BlockRows
, 
BlockCŞs
>::
Ty³
 
	$block
(
¡¬tRow
, 
¡¬tCŞ
) const;

387 
‹m¶©e
<
CRows
, 
CCŞs
>

388 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
, 
CRows
, 
CCŞs
>::
Ty³
 
	`cÜÃr
(
CÜÃrTy³
 
ty³
);

389 
‹m¶©e
<
CRows
, 
CCŞs
>

390 cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
, 
CRows
, 
CCŞs
>::
Ty³
 
	$cÜÃr
(
CÜÃrTy³
 
ty³
) const;

392 
‹m¶©e
<
Size
> 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,Size>::
SubVeùÜTy³
 
	`¡¬t
();

393 
‹m¶©e
<
Size
> cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,Size>::
SubVeùÜTy³
 
	$¡¬t
() const;

395 
‹m¶©e
<
Size
> 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,Size>::
SubVeùÜTy³
 
	`’d
();

396 
‹m¶©e
<
Size
> cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,Size>::
SubVeùÜTy³
 
	$’d
() const;

398 
‹m¶©e
<
Size
> 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,Size>::
SubVeùÜTy³
 
	`£gm’t
(
¡¬t
);

399 
‹m¶©e
<
Size
> cÚ¡ 
ty³Çme
 
BlockR‘uºTy³
<
D”ived
,Size>::
SubVeùÜTy³
 
	$£gm’t
(
¡¬t
) const;

401 
DŸgÚ®CÛffs
<
D”ived
> 
	`dŸgÚ®
();

402 cÚ¡ 
DŸgÚ®CÛffs
<
D”ived
> 
	$dŸgÚ®
() const;

404 
‹m¶©e
<
Mode
> 
P¬t
<
D”ived
, Mode> 
	`·¹
();

405 
‹m¶©e
<
Mode
> cÚ¡ 
P¬t
<
D”ived
, Mode> 
	$·¹
() const;

408 cÚ¡ 
CÚ¡ªtR‘uºTy³


409 
	`CÚ¡ªt
(
rows
, 
cŞs
, cÚ¡ 
SÿÏr
& 
v®ue
);

410 cÚ¡ 
CÚ¡ªtR‘uºTy³


411 
	`CÚ¡ªt
(
size
, cÚ¡ 
SÿÏr
& 
v®ue
);

412 cÚ¡ 
CÚ¡ªtR‘uºTy³


413 
	`CÚ¡ªt
(cÚ¡ 
SÿÏr
& 
v®ue
);

415 
‹m¶©e
<
ty³Çme
 
Cu¡omNuÎ¬yOp
>

416 cÚ¡ 
Cwi£NuÎ¬yOp
<
Cu¡omNuÎ¬yOp
, 
D”ived
>

417 
	`NuÎ¬yEx´
(
rows
, 
cŞs
, cÚ¡ 
Cu¡omNuÎ¬yOp
& 
func
);

418 
‹m¶©e
<
ty³Çme
 
Cu¡omNuÎ¬yOp
>

419 cÚ¡ 
Cwi£NuÎ¬yOp
<
Cu¡omNuÎ¬yOp
, 
D”ived
>

420 
	`NuÎ¬yEx´
(
size
, cÚ¡ 
Cu¡omNuÎ¬yOp
& 
func
);

421 
‹m¶©e
<
ty³Çme
 
Cu¡omNuÎ¬yOp
>

422 cÚ¡ 
Cwi£NuÎ¬yOp
<
Cu¡omNuÎ¬yOp
, 
D”ived
>

423 
	`NuÎ¬yEx´
(cÚ¡ 
Cu¡omNuÎ¬yOp
& 
func
);

425 cÚ¡ 
CÚ¡ªtR‘uºTy³
 
	`Z”o
(
rows
, 
cŞs
);

426 cÚ¡ 
CÚ¡ªtR‘uºTy³
 
	`Z”o
(
size
);

427 cÚ¡ 
CÚ¡ªtR‘uºTy³
 
	`Z”o
();

428 cÚ¡ 
CÚ¡ªtR‘uºTy³
 
	`OÃs
(
rows
, 
cŞs
);

429 cÚ¡ 
CÚ¡ªtR‘uºTy³
 
	`OÃs
(
size
);

430 cÚ¡ 
CÚ¡ªtR‘uºTy³
 
	`OÃs
();

431 cÚ¡ 
Id’t™yR‘uºTy³
 
	`Id’t™y
();

432 cÚ¡ 
Id’t™yR‘uºTy³
 
	`Id’t™y
(
rows
, 
cŞs
);

433 cÚ¡ 
BasisR‘uºTy³
 
	`Un™
(
size
, 
i
);

434 cÚ¡ 
BasisR‘uºTy³
 
	`Un™
(
i
);

435 cÚ¡ 
BasisR‘uºTy³
 
	`Un™X
();

436 cÚ¡ 
BasisR‘uºTy³
 
	`Un™Y
();

437 cÚ¡ 
BasisR‘uºTy³
 
	`Un™Z
();

438 cÚ¡ 
BasisR‘uºTy³
 
	`Un™W
();

440 cÚ¡ 
DŸgÚ®M©rix
<
D”ived
> 
	$asDŸgÚ®
() const;

442 
	`fl
(cÚ¡ 
SÿÏr
& 
v®ue
);

443 
D”ived
& 
	`£tCÚ¡ªt
(cÚ¡ 
SÿÏr
& 
v®ue
);

444 
D”ived
& 
	`£tZ”o
();

445 
D”ived
& 
	`£tOÃs
();

446 
D”ived
& 
	`£tRªdom
();

447 
D”ived
& 
	`£tId’t™y
();

450 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

451 
boŞ
 
	`isAµrox
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

452 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

453 
boŞ
 
	`isMuchSm®ËrThª
(cÚ¡ 
R—lSÿÏr
& 
Ùh”
,

454 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

455 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

456 
boŞ
 
	`isMuchSm®ËrThª
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

457 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

459 
boŞ
 
	`isAµroxToCÚ¡ªt
(cÚ¡ 
SÿÏr
& 
v®ue
, 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<Scalar>()) const;

460 
boŞ
 
	`isCÚ¡ªt
(cÚ¡ 
SÿÏr
& 
v®ue
, 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<Scalar>()) const;

461 
boŞ
 
	`isZ”o
(
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

462 
boŞ
 
	`isOÃs
(
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

463 
boŞ
 
	`isId’t™y
(
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

464 
boŞ
 
	`isDŸgÚ®
(
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

466 
boŞ
 
	`isUµ”TrŸnguÏr
(
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

467 
boŞ
 
	`isLow”TrŸnguÏr
(
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

469 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

470 
boŞ
 
	`isO¹hogÚ®
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

471 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

472 
boŞ
 
	`isUn™¬y
(
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const;

474 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

475 
šlše
 
boŞ
 
İ”©Ü
==(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const

476 {  (
	`cwi£
(è=ğ
Ùh”
).
	`®l
(); 
	}
}

478 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

479 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const

480 {  (
cwi£
(è!ğ
Ùh”
).
ªy
(); }

483 
	g‹m¶©e
<
ty³Çme
 
	gNewTy³
>

484 cÚ¡ 
	gCwi£UÇryOp
<
	gei_sÿÏr_ÿ¡_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
, 
	gNewTy³
>, D”ived> 
	$ÿ¡
() const;

491 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
ei_ev®
<
D”ived
>::
ty³
 
	$ev®
() const

492 {  
ty³Çme
 
ei_ev®
<
D”ived
>::
	`ty³
(
	`d”ived
()); 
	}
}

494 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

495 
sw­
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

497 
	g‹m¶©e
<
	gAdded
>

498 cÚ¡ 
	gFÏgged
<
	gD”ived
, 
	gAdded
, 0> 
	$m¬ked
() const;

499 cÚ¡ 
FÏgged
<
D”ived
, 0, 
Ev®BefÜeNe¡šgB™
 | 
Ev®BefÜeAssignšgB™
> 
	$Ïzy
() const;

506 
šlše
 
	$¡ride
(ècÚ¡ {  
	`d”ived
().
	`¡ride
(); 
	}
}

508 
šlše
 cÚ¡ 
	gNe¡ByV®ue
<
	gD”ived
> 
	$Ã¡ByV®ue
() const;

511 
CÚjug©eR‘uºTy³
 
	$cÚjug©e
() const;

512 cÚ¡ 
R—lR‘uºTy³
 
	$»®
() const;

513 cÚ¡ 
ImagR‘uºTy³
 
	$imag
() const;

515 
‹m¶©e
<
ty³Çme
 
Cu¡omUÇryOp
>

516 cÚ¡ 
Cwi£UÇryOp
<
Cu¡omUÇryOp
, 
D”ived
> 
	`uÇryEx´
(cÚ¡ Cu¡omUÇryOp& 
func
 = 
	$Cu¡omUÇryOp
()) const;

518 
‹m¶©e
<
ty³Çme
 
Cu¡omBš¬yOp
,y³Çm
Oth”D”ived
>

519 cÚ¡ 
Cwi£Bš¬yOp
<
Cu¡omBš¬yOp
, 
D”ived
, 
Oth”D”ived
>

520 
	`bš¬yEx´
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
, cÚ¡ 
Cu¡omBš¬yOp
& 
func
 = 
	$Cu¡omBš¬yOp
()) const;

523 
SÿÏr
 
	$sum
() const;

524 
SÿÏr
 
	$Œaû
() const;

526 
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
 
	$mšCÛff
() const;

527 
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
 
	$maxCÛff
() const;

529 
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
 
	$mšCÛff
(* 
row
, * 
cŞ
) const;

530 
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
 
	$maxCÛff
(* 
row
, * 
cŞ
) const;

532 
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
 
	$mšCÛff
(* 
šdex
) const;

533 
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
 
	$maxCÛff
(* 
šdex
) const;

535 
‹m¶©e
<
ty³Çme
 
Bš¬yOp
>

536 
ty³Çme
 
ei_»suÉ_of
<
	`Bš¬yOp
Ñy³Çm
ei_Œa™s
<
D”ived
>::
SÿÏr
)>::
ty³


537 
	$»dux
(cÚ¡ 
Bš¬yOp
& 
func
) const;

539 
‹m¶©e
<
ty³Çme
 
Vis™Ü
>

540 
	$vis™
(
Vis™Ü
& 
func
) const;

542 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


543 
šlše
 cÚ¡ 
D”ived
& 
	$d”ived
(ècÚ¡ {  *
¡©ic_ÿ¡
<cÚ¡ 
D”ived
*>(
this
); 
	}
}

544 
šlše
 
	gD”ived
& 
	$d”ived
(è{  *
¡©ic_ÿ¡
<
D”ived
*>(
this
); 
	}
}

545 
šlše
 
	gD”ived
& 
	$cÚ¡_ÿ¡_d”ived
() const

546 {  *
¡©ic_ÿ¡
<
D”ived
*>(
cÚ¡_ÿ¡
<
M©rixBa£
*>(
this
)); 
	}
}

549 cÚ¡ 
	gCwi£
<
	gD”ived
> 
	$cwi£
() const;

550 
Cwi£
<
D”ived
> 
	`cwi£
();

552 
šlše
 cÚ¡ 
W™hFÜm©
<
D”ived
> 
	$fÜm©
(cÚ¡ 
IOFÜm©
& 
fmt
) const;

556 
boŞ
 
	$®l
() const;

557 
boŞ
 
	$ªy
() const;

558 
	$couÁ
() const;

560 cÚ¡ 
P¬tŸlRedux
<
D”ived
,
HÜizÚl
> 
	$rowwi£
() const;

561 cÚ¡ 
P¬tŸlRedux
<
D”ived
,
V”tiÿl
> 
	$cŞwi£
() const;

563 cÚ¡ 
Cwi£NuÎ¬yOp
<
ei_sÿÏr_¿ndom_İ
<
SÿÏr
>,
D”ived
> 
	`Rªdom
(
rows
, 
cŞs
);

564 cÚ¡ 
Cwi£NuÎ¬yOp
<
ei_sÿÏr_¿ndom_İ
<
SÿÏr
>,
D”ived
> 
	`Rªdom
(
size
);

565 cÚ¡ 
Cwi£NuÎ¬yOp
<
ei_sÿÏr_¿ndom_İ
<
SÿÏr
>,
D”ived
> 
	`Rªdom
();

567 
‹m¶©e
<
ty³Çme
 
Th’D”ived
,ty³Çm
El£D”ived
>

568 cÚ¡ 
S–eù
<
D”ived
,
Th’D”ived
,
El£D”ived
>

569 
	`£Ëù
(cÚ¡ 
M©rixBa£
<
Th’D”ived
>& 
th’M©rix
,

570 cÚ¡ 
M©rixBa£
<
El£D”ived
>& 
–£M©rix
) const;

572 
‹m¶©e
<
ty³Çme
 
Th’D”ived
>

573 
šlše
 cÚ¡ 
S–eù
<
D”ived
,
Th’D”ived
, 
Ne¡ByV®ue
<
ty³Çme
 Th’D”ived::
CÚ¡ªtR‘uºTy³
> >

574 
	`£Ëù
(cÚ¡ 
M©rixBa£
<
Th’D”ived
>& 
th’M©rix
, 
ty³Çme
 Th’D”ived::
SÿÏr
 
–£SÿÏr
) const;

576 
‹m¶©e
<
ty³Çme
 
El£D”ived
>

577 
šlše
 cÚ¡ 
S–eù
<
D”ived
, 
Ne¡ByV®ue
<
ty³Çme
 
El£D”ived
::
CÚ¡ªtR‘uºTy³
>, ElseDerived >

578 
	`£Ëù
(
ty³Çme
 
El£D”ived
::
SÿÏr
 
th’SÿÏr
, cÚ¡ 
M©rixBa£
<El£D”ived>& 
–£M©rix
) const;

580 
‹m¶©e
<
p
> 
R—lSÿÏr
 
	$ÍNÜm
() const;

584 cÚ¡ 
LU
<
PÏšM©rixTy³
> 
	$lu
() const;

585 cÚ¡ 
PÏšM©rixTy³
 
	$šv”£
() const;

586 
‹m¶©e
<
ty³Çme
 
ResuÉTy³
>

587 
	`compu‹Inv”£
(
M©rixBa£
<
ResuÉTy³
> *
»suÉ
) const;

588 
SÿÏr
 
	$d‘”mšªt
() const;

592 cÚ¡ 
LLT
<
PÏšM©rixTy³
> 
	$Ît
() const;

593 cÚ¡ 
LDLT
<
PÏšM©rixTy³
> 
	$ldÉ
() const;

597 cÚ¡ 
QR
<
PÏšM©rixTy³
> 
	$qr
() const;

599 
Eig’v®uesR‘uºTy³
 
	$eig’v®ues
() const;

600 
R—lSÿÏr
 
	$İ”©ÜNÜm
() const;

604 
SVD
<
PÏšM©rixTy³
> 
	$svd
() const;

608 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

609 
PÏšM©rixTy³
 
	`üoss
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

610 
PÏšM©rixTy³
 
	$un™O¹hogÚ®
() const;

611 
M©rix
<
SÿÏr
,3,1> 
	$euËrAngËs
(
a0
, 
a1
, 
a2
) const;

616 
‹m¶©e
<
ty³Çme
 
D”ived1
,y³Çm
D”ived2
>

617 
D”ived
& 
	`ÏzyAssign
(cÚ¡ 
S·r£Produù
<
D”ived1
,
D”ived2
,
S·r£TimeD’£Produù
>& 
´oduù
);

619 
‹m¶©e
<
ty³Çme
 
D”ived1
,y³Çm
D”ived2
>

620 
D”ived
& 
	`ÏzyAssign
(cÚ¡ 
S·r£Produù
<
D”ived1
,
D”ived2
,
D’£TimeS·r£Produù
>& 
´oduù
);

622 #ifdeà
EIGEN_MATRIXBASE_PLUGIN


623 #šşud
EIGEN_MATRIXBASE_PLUGIN


626 
´Ùeùed
:

628 
	$M©rixBa£
()

633 #ifdeà
EIGEN_INTERNAL_DEBUGGING


634 
	`EIGEN_STATIC_ASSERT
(
ei_¬e_æags_cÚsi¡’t
<
FÏgs
>::
»t
,

635 
INVALID_MATRIXBASE_TEMPLATE_PARAMETERS
)

637 
	}
}

639 
	g´iv©e
:

640 
ex¶ic™
 
M©rixBa£
();

641 
M©rixBa£
(,);

642 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
> 
ex¶ic™
 
M©rixBa£
(cÚ¡ M©rixBa£<
Oth”D”ived
>&);

	@robot/Eigen/src/Core/MatrixStorage.h

26 #iâdeà
EIGEN_MATRIXSTORAGE_H


27 
	#EIGEN_MATRIXSTORAGE_H


	)

29 
	sei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
 {};

34 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gSize
, 
	gM©rixO±iÚs
,

35 
boŞ
 
	gAlign
 = (
M©rixO±iÚs
&
AutoAlign
è&& (((
Size
*(
T
))&0xf)==0)

36 > 
	sei_m©rix_¬¿y


38 
EIGEN_ALIGN_128
 
T
 
¬¿y
[
Size
];

40 
ei_m©rix_¬¿y
()

42 #iâdeà
EIGEN_DISABLE_UNALIGNED_ARRAY_ASSERT


43 
ei_as£¹
((
»š‹½»t_ÿ¡
<
size_t
>(
¬¿y
) & 0xf) == 0

48 
ei_m©rix_¬¿y
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
) {}

51 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gSize
, 
	gM©rixO±iÚs
> 
	gei_m©rix_¬¿y
<T,Size,M©rixO±iÚs,
	gçl£
>

53 
T
 
	g¬¿y
[
Size
];

54 
ei_m©rix_¬¿y
() {}

55 
ei_m©rix_¬¿y
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
) {}

69 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gSize
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
> 
şass
 
	gei_m©rix_¡Üage
;

72 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gSize
, 
	g_Rows
, 
	g_CŞs
, 
	g_O±iÚs
> cÏs 
	cei_m©rix_¡Üage


74 
	mei_m©rix_¬¿y
<
	mT
,
	mSize
,
	m_O±iÚs
> 
	mm_d©a
;

75 
	mpublic
:

76 
šlše
 
ex¶ic™
 
	$ei_m©rix_¡Üage
() {}

77 
šlše
 
	$ei_m©rix_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
)

78 : 
	`m_d©a
(
	$ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
()è{
	}
}

79 
šlše
 
	$ei_m©rix_¡Üage
(,,è{
	}
}

80 
šlše
 
	$sw­
(
ei_m©rix_¡Üage
& 
Ùh”
è{ 
¡d
::
	`sw­
(
m_d©a
,Ùh”.m_d©a); 
	}
}

81 
šlše
 
	$rows
(è{ 
_Rows
;
	}
}

82 
šlše
 
	$cŞs
(è{ 
_CŞs
;
	}
}

83 
šlše
 
	$»size
(,,è{
	}
}

84 
šlše
 cÚ¡ 
T
 *
	$d©a
(ècÚ¡ {  
m_d©a
.
¬¿y
; 
	}
}

85 
šlše
 
T
 *
	$d©a
(è{  
m_d©a
.
¬¿y
; 
	}
}

89 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gSize
, 
	g_O±iÚs
> 
şass
 
	gei_m©rix_¡Üage
<T, Size, 
	gDyÇmic
, Dynamic, _Options>

91 
	gei_m©rix_¬¿y
<
	gT
,
	gSize
,
	g_O±iÚs
> 
	gm_d©a
;

92 
	gm_rows
;

93 
	gm_cŞs
;

94 
	gpublic
:

95 
šlše
 
ex¶ic™
 
ei_m©rix_¡Üage
(è: 
m_rows
(0), 
m_cŞs
(0) {}

96 
šlše
 
ei_m©rix_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
)

97 : 
m_d©a
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
()), 
m_rows
(0), 
m_cŞs
(0) {}

98 
šlše
 
ei_m©rix_¡Üage
(, 
rows
, 
cŞs
è: 
m_rows
Ôows), 
m_cŞs
(cols) {}

99 
	gšlše
 ~
ei_m©rix_¡Üage
() {}

100 
šlše
 
sw­
(
ei_m©rix_¡Üage
& 
Ùh”
)

101 { 
	g¡d
::
sw­
(
m_d©a
,
Ùh”
.m_d©a); std::sw­(
m_rows
,Ùh”.m_rows); std::sw­(
m_cŞs
,other.m_cols); }

102 
šlše
 
rows
(ècÚ¡ { 
	gm_rows
;}

103 
šlše
 
cŞs
(ècÚ¡ { 
	gm_cŞs
;}

104 
šlše
 
»size
(, 
rows
, 
cŞs
)

106 
	gm_rows
 = 
rows
;

107 
	gm_cŞs
 = 
cŞs
;

109 
šlše
 cÚ¡ 
T
 *
d©a
(ècÚ¡ {  
	gm_d©a
.
	g¬¿y
; }

110 
šlše
 
T
 *
d©a
(è{  
	gm_d©a
.
	g¬¿y
; }

114 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gSize
, 
	g_CŞs
, 
	g_O±iÚs
> 
şass
 
	gei_m©rix_¡Üage
<T, Size, 
	gDyÇmic
, _Cols, _Options>

116 
	gei_m©rix_¬¿y
<
	gT
,
	gSize
,
	g_O±iÚs
> 
	gm_d©a
;

117 
	gm_rows
;

118 
	gpublic
:

119 
šlše
 
ex¶ic™
 
ei_m©rix_¡Üage
(è: 
m_rows
(0) {}

120 
šlše
 
ei_m©rix_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
)

121 : 
m_d©a
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
()), 
m_rows
(0) {}

122 
šlše
 
ei_m©rix_¡Üage
(, 
rows
, è: 
m_rows
(rows) {}

123 
šlše
 ~
ei_m©rix_¡Üage
() {}

124 
šlše
 
sw­
(
ei_m©rix_¡Üage
& 
Ùh”
è{ 
¡d
::sw­(
m_d©a
,Ùh”.m_d©a); 
	g¡d
::sw­(
m_rows
,other.m_rows); }

125 
šlše
 
rows
(ècÚ¡ { 
	gm_rows
;}

126 
šlše
 
cŞs
(ècÚ¡ { 
	g_CŞs
;}

127 
šlše
 
»size
(, 
rows
, )

129 
	gm_rows
 = 
rows
;

131 
šlše
 cÚ¡ 
T
 *
d©a
(ècÚ¡ {  
	gm_d©a
.
	g¬¿y
; }

132 
šlše
 
T
 *
d©a
(è{  
	gm_d©a
.
	g¬¿y
; }

136 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gSize
, 
	g_Rows
, 
	g_O±iÚs
> 
şass
 
	gei_m©rix_¡Üage
<T, Size, _Rows, 
	gDyÇmic
, _Options>

138 
	gei_m©rix_¬¿y
<
	gT
,
	gSize
,
	g_O±iÚs
> 
	gm_d©a
;

139 
	gm_cŞs
;

140 
	gpublic
:

141 
šlše
 
ex¶ic™
 
ei_m©rix_¡Üage
(è: 
m_cŞs
(0) {}

142 
šlše
 
ei_m©rix_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
)

143 : 
m_d©a
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
()), 
m_cŞs
(0) {}

144 
šlše
 
ei_m©rix_¡Üage
(, , 
cŞs
è: 
m_cŞs
(cols) {}

145 
šlše
 ~
ei_m©rix_¡Üage
() {}

146 
šlše
 
sw­
(
ei_m©rix_¡Üage
& 
Ùh”
è{ 
¡d
::sw­(
m_d©a
,Ùh”.m_d©a); 
	g¡d
::sw­(
m_cŞs
,other.m_cols); }

147 
šlše
 
rows
(ècÚ¡ { 
	g_Rows
;}

148 
šlše
 
cŞs
(ècÚ¡ { 
	gm_cŞs
;}

149 
šlše
 
»size
(, , 
cŞs
)

151 
	gm_cŞs
 = 
cŞs
;

153 
šlše
 cÚ¡ 
T
 *
d©a
(ècÚ¡ {  
	gm_d©a
.
	g¬¿y
; }

154 
šlše
 
T
 *
d©a
(è{  
	gm_d©a
.
	g¬¿y
; }

158 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	g_O±iÚs
> 
şass
 
	gei_m©rix_¡Üage
<T, 
	gDyÇmic
, Dynamic, Dynamic, _Options>

160 
T
 *
	gm_d©a
;

161 
	gm_rows
;

162 
	gm_cŞs
;

163 
	gpublic
:

164 
šlše
 
ex¶ic™
 
ei_m©rix_¡Üage
(è: 
m_d©a
(0), 
m_rows
(0), 
m_cŞs
(0) {}

165 
šlše
 
ei_m©rix_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
)

166 : 
m_d©a
(0), 
m_rows
(0), 
m_cŞs
(0) {}

167 
šlše
 
ei_m©rix_¡Üage
(
size
, 
rows
, 
cŞs
)

168 : 
m_d©a
(
ei_®igÃd_Ãw
<
T
>(
size
)), 
m_rows
(
rows
), 
m_cŞs
(
cŞs
) {}

169 
	gšlše
 ~
ei_m©rix_¡Üage
(è{ 
ei_®igÃd_d–‘e
(
m_d©a
, 
m_rows
*
m_cŞs
); }

170 
šlše
 
sw­
(
ei_m©rix_¡Üage
& 
Ùh”
)

171 { 
	g¡d
::
sw­
(
m_d©a
,
Ùh”
.m_d©a); std::sw­(
m_rows
,Ùh”.m_rows); std::sw­(
m_cŞs
,other.m_cols); }

172 
šlše
 
rows
(ècÚ¡ { 
	gm_rows
;}

173 
šlše
 
cŞs
(ècÚ¡ { 
	gm_cŞs
;}

174 
»size
(
size
, 
rows
, 
cŞs
)

176 if(
	gsize
 !ğ
m_rows
*
m_cŞs
)

178 
ei_®igÃd_d–‘e
(
m_d©a
, 
m_rows
*
m_cŞs
);

179 ià(
	gsize
)

180 
	gm_d©a
 = 
ei_®igÃd_Ãw
<
T
>(
size
);

182 
	gm_d©a
 = 0;

184 
	gm_rows
 = 
rows
;

185 
	gm_cŞs
 = 
cŞs
;

187 
šlše
 cÚ¡ 
T
 *
d©a
(ècÚ¡ {  
	gm_d©a
; }

188 
šlše
 
T
 *
d©a
(è{  
	gm_d©a
; }

192 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	g_Rows
, 
	g_O±iÚs
> 
şass
 
	gei_m©rix_¡Üage
<T, 
	gDyÇmic
, _Rows, Dynamic, _Options>

194 
T
 *
	gm_d©a
;

195 
	gm_cŞs
;

196 
	gpublic
:

197 
šlše
 
ex¶ic™
 
ei_m©rix_¡Üage
(è: 
m_d©a
(0), 
m_cŞs
(0) {}

198 
šlše
 
ei_m©rix_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
è: 
m_d©a
(0), 
m_cŞs
(0) {}

199 
šlše
 
ei_m©rix_¡Üage
(
size
, , 
cŞs
è: 
m_d©a
(
ei_®igÃd_Ãw
<
T
>(size)), 
m_cŞs
(cols) {}

200 
	gšlše
 ~
ei_m©rix_¡Üage
(è{ 
ei_®igÃd_d–‘e
(
m_d©a
, 
_Rows
*
m_cŞs
); }

201 
šlše
 
sw­
(
ei_m©rix_¡Üage
& 
Ùh”
è{ 
	g¡d
::sw­(
m_d©a
,Ùh”.m_d©a); std::sw­(
m_cŞs
,other.m_cols); }

202 
šlše
 
rows
(è{ 
	g_Rows
;}

203 
šlše
 
cŞs
(ècÚ¡ { 
	gm_cŞs
;}

204 
»size
(
size
, , 
cŞs
)

206 if(
	gsize
 !ğ
_Rows
*
m_cŞs
)

208 
ei_®igÃd_d–‘e
(
m_d©a
, 
_Rows
*
m_cŞs
);

209 ià(
	gsize
)

210 
	gm_d©a
 = 
ei_®igÃd_Ãw
<
T
>(
size
);

212 
	gm_d©a
 = 0;

214 
	gm_cŞs
 = 
cŞs
;

216 
šlše
 cÚ¡ 
T
 *
d©a
(ècÚ¡ {  
	gm_d©a
; }

217 
šlše
 
T
 *
d©a
(è{  
	gm_d©a
; }

221 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	g_CŞs
, 
	g_O±iÚs
> 
şass
 
	gei_m©rix_¡Üage
<T, 
	gDyÇmic
, Dynamic, _Cols, _Options>

223 
T
 *
	gm_d©a
;

224 
	gm_rows
;

225 
	gpublic
:

226 
šlše
 
ex¶ic™
 
ei_m©rix_¡Üage
(è: 
m_d©a
(0), 
m_rows
(0) {}

227 
šlše
 
ei_m©rix_¡Üage
(
ei_cÚ¡ruùÜ_w™hout_uÇligÃd_¬¿y_as£¹
è: 
m_d©a
(0), 
m_rows
(0) {}

228 
šlše
 
ei_m©rix_¡Üage
(
size
, 
rows
, è: 
m_d©a
(
ei_®igÃd_Ãw
<
T
>(size)), 
m_rows
(rows) {}

229 
	gšlše
 ~
ei_m©rix_¡Üage
(è{ 
ei_®igÃd_d–‘e
(
m_d©a
, 
_CŞs
*
m_rows
); }

230 
šlše
 
sw­
(
ei_m©rix_¡Üage
& 
Ùh”
è{ 
	g¡d
::sw­(
m_d©a
,Ùh”.m_d©a); std::sw­(
m_rows
,other.m_rows); }

231 
šlše
 
rows
(ècÚ¡ { 
	gm_rows
;}

232 
šlše
 
cŞs
(è{ 
	g_CŞs
;}

233 
»size
(
size
, 
rows
, )

235 if(
	gsize
 !ğ
m_rows
*
_CŞs
)

237 
ei_®igÃd_d–‘e
(
m_d©a
, 
_CŞs
*
m_rows
);

238 ià(
	gsize
)

239 
	gm_d©a
 = 
ei_®igÃd_Ãw
<
T
>(
size
);

241 
	gm_d©a
 = 0;

243 
	gm_rows
 = 
rows
;

245 
šlše
 cÚ¡ 
T
 *
d©a
(ècÚ¡ {  
	gm_d©a
; }

246 
šlše
 
T
 *
d©a
(è{  
	gm_d©a
; }

	@robot/Eigen/src/Core/Minor.h

25 #iâdeà
EIGEN_MINOR_H


26 
	#EIGEN_MINOR_H


	)

41 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

42 
	gei_Œa™s
<
	gMšÜ
<
	gM©rixTy³
> >

44 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

45 
ty³Çme
 
	tei_Ã¡ed
<
	tM©rixTy³
>::
	tty³
 
	tM©rixTy³Ne¡ed
;

46 
ty³Çme
 
	tei_uÄef
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

48 
	gRowsAtCompeTime
 = (
M©rixTy³
::
RowsAtCompeTime
 !ğ
DyÇmic
) ?

49 (
M©rixTy³
::
RowsAtCompeTime
è- 1 : 
DyÇmic
,

50 
	gCŞsAtCompeTime
 = (
M©rixTy³
::
CŞsAtCompeTime
 !ğ
DyÇmic
) ?

51 (
M©rixTy³
::
CŞsAtCompeTime
è- 1 : 
DyÇmic
,

52 
	gMaxRowsAtCompeTime
 = (
M©rixTy³
::
MaxRowsAtCompeTime
 !ğ
DyÇmic
) ?

53 (
M©rixTy³
::
MaxRowsAtCompeTime
è- 1 : 
DyÇmic
,

54 
	gMaxCŞsAtCompeTime
 = (
M©rixTy³
::
MaxCŞsAtCompeTime
 !ğ
DyÇmic
) ?

55 (
M©rixTy³
::
MaxCŞsAtCompeTime
è- 1 : 
DyÇmic
,

56 
	gFÏgs
 = 
_M©rixTy³Ne¡ed
::
FÏgs
 & 
H”ed™¬yB™s
,

57 
	gCÛffR—dCo¡
 = 
_M©rixTy³Ne¡ed
::
CÛffR—dCo¡


61 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gMšÜ


62 : 
public
 
M©rixBa£
<
MšÜ
<
M©rixTy³
> >

64 
public
:

66 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
MšÜ
)

68 
šlše
 
MšÜ
(cÚ¡ 
M©rixTy³
& 
m©rix
,

69 
row
, 
cŞ
)

70 : 
m_m©rix
(
m©rix
), 
m_row
(
row
), 
m_cŞ
(
cŞ
)

72 
ei_as£¹
(
row
 >ğ0 &&„ow < 
m©rix
.
rows
()

73 && 
cŞ
 >ğ0 && cŞ < 
m©rix
.
cŞs
());

76 
EIGEN_INHERIT_ASSIGNMENT_OPERATORS
(
MšÜ
)

78 
šlše
 
rows
(ècÚ¡ {  
	gm_m©rix
.rows() - 1; }

79 
šlše
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.cols() - 1; }

81 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

83  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
row
 + (row >ğ
m_row
), 
cŞ
 + (cŞ >ğ
m_cŞ
));

86 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

88  
	gm_m©rix
.
cÛff
(
row
 + (row >ğ
m_row
), 
cŞ
 + (cŞ >ğ
m_cŞ
));

91 
	g´Ùeùed
:

92 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

93 cÚ¡ 
	gm_row
, 
	gm_cŞ
;

106 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

107 
šlše
 
	gMšÜ
<
	gD”ived
>

108 
	gM©rixBa£
<
	gD”ived
>::
	$mšÜ
(
row
, 
cŞ
)

110  
MšÜ
<
D”ived
>(
	`d”ived
(), 
row
, 
cŞ
);

111 
	}
}

115 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

116 
šlše
 cÚ¡ 
	gMšÜ
<
	gD”ived
>

117 
	gM©rixBa£
<
	gD”ived
>::
	$mšÜ
(
row
, 
cŞ
) const

119  
MšÜ
<
D”ived
>(
	`d”ived
(), 
row
, 
cŞ
);

120 
	}
}

	@robot/Eigen/src/Core/NestByValue.h

26 #iâdeà
EIGEN_NESTBYVALUE_H


27 
	#EIGEN_NESTBYVALUE_H


	)

40 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

41 
	gei_Œa™s
<
	gNe¡ByV®ue
<
	gEx´essiÚTy³
> > : 
public
 
ei_Œa™s
<
Ex´essiÚTy³
>

44 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> 
şass
 
	gNe¡ByV®ue


45 : 
public
 
M©rixBa£
<
Ne¡ByV®ue
<
Ex´essiÚTy³
> >

47 
public
:

49 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Ne¡ByV®ue
)

51 
šlše
 
Ne¡ByV®ue
(cÚ¡ 
Ex´essiÚTy³
& 
m©rix
è: 
m_ex´essiÚ
(matrix) {}

53 
šlše
 
rows
(ècÚ¡ {  
m_ex´essiÚ
.rows(); }

54 
šlše
 
cŞs
(ècÚ¡ {  
	gm_ex´essiÚ
.cols(); }

55 
šlše
 
¡ride
(ècÚ¡ {  
	gm_ex´essiÚ
.stride(); }

57 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

59  
	gm_ex´essiÚ
.
cÛff
(
row
, 
cŞ
);

62 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

64  
	gm_ex´essiÚ
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
row
, 
cŞ
);

67 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

69  
	gm_ex´essiÚ
.
cÛff
(
šdex
);

72 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

74  
	gm_ex´essiÚ
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
šdex
);

77 
	g‹m¶©e
<
	gLßdMode
>

78 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

80  
	gm_ex´essiÚ
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	grow
, 
	gcŞ
);

83 
	g‹m¶©e
<
	gLßdMode
>

84 
šlše
 
wr™ePack‘
(
row
, 
cŞ
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

86 
	gm_ex´essiÚ
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	grow
, 
	gcŞ
, 
	gx
);

89 
	g‹m¶©e
<
	gLßdMode
>

90 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

92  
	gm_ex´essiÚ
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	gšdex
);

95 
	g‹m¶©e
<
	gLßdMode
>

96 
šlše
 
wr™ePack‘
(
šdex
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

98 
	gm_ex´essiÚ
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	gšdex
, 
	gx
);

101 
	g´Ùeùed
:

102 cÚ¡ 
Ex´essiÚTy³
 
m_ex´essiÚ
;

104 
	g´iv©e
:

105 
Ne¡ByV®ue
& 
İ”©Ü
=(const NestByValue&);

110 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

111 
šlše
 cÚ¡ 
	gNe¡ByV®ue
<
	gD”ived
>

112 
	gM©rixBa£
<
	gD”ived
>::
	$Ã¡ByV®ue
() const

114  
Ne¡ByV®ue
<
D”ived
>(
	`d”ived
());

115 
	}
}

	@robot/Eigen/src/Core/NumTraits.h

25 #iâdeà
EIGEN_NUMTRAITS_H


26 
	#EIGEN_NUMTRAITS_H


	)

49 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gNumT¿™s
;

51 
	g‹m¶©e
<> 
	gNumT¿™s
<>

53 
	tR—l
;

54 
	tFlßtšgPošt
;

56 
	gIsCom¶ex
 = 0,

57 
	gHasFlßtšgPošt
 = 0,

58 
	gR—dCo¡
 = 1,

59 
	gAddCo¡
 = 1,

60 
	gMulCo¡
 = 1

64 
	g‹m¶©e
<> 
	gNumT¿™s
<>

66 
	tR—l
;

67 
	tFlßtšgPošt
;

69 
	gIsCom¶ex
 = 0,

70 
	gHasFlßtšgPošt
 = 1,

71 
	gR—dCo¡
 = 1,

72 
	gAddCo¡
 = 1,

73 
	gMulCo¡
 = 1

77 
	g‹m¶©e
<> 
	gNumT¿™s
<>

79 
	tR—l
;

80 
	tFlßtšgPošt
;

82 
	gIsCom¶ex
 = 0,

83 
	gHasFlßtšgPošt
 = 1,

84 
	gR—dCo¡
 = 1,

85 
	gAddCo¡
 = 1,

86 
	gMulCo¡
 = 1

90 
	g‹m¶©e
<
ty³Çme
 
	g_R—l
> 
	gNumT¿™s
<
	g¡d
::
com¶ex
<
_R—l
> >

92 
_R—l
 
	tR—l
;

93 
	g¡d
::
	tcom¶ex
<
	t_R—l
> 
	tFlßtšgPošt
;

95 
	gIsCom¶ex
 = 1,

96 
	gHasFlßtšgPošt
 = 
NumT¿™s
<
R—l
>::
HasFlßtšgPošt
,

97 
	gR—dCo¡
 = 2 * 
NumT¿™s
<
_R—l
>::
R—dCo¡
,

98 
	gAddCo¡
 = 2 * 
NumT¿™s
<
R—l
>::
AddCo¡
,

99 
	gMulCo¡
 = 4 * 
NumT¿™s
<
R—l
>::
MulCo¡
 + 2 * NumT¿™s<R—l>::
AddCo¡


103 
	g‹m¶©e
<> 
	gNumT¿™s
<>

105 
	tR—l
;

106 
	tFlßtšgPošt
;

108 
	gIsCom¶ex
 = 0,

109 
	gHasFlßtšgPošt
 = 0,

110 
	gR—dCo¡
 = 1,

111 
	gAddCo¡
 = 1,

112 
	gMulCo¡
 = 1

116 
	g‹m¶©e
<> 
	gNumT¿™s
<>

118 
	tR—l
;

119 
	tFlßtšgPošt
;

121 
	gIsCom¶ex
 = 0,

122 
	gHasFlßtšgPošt
 = 1,

123 
	gR—dCo¡
 = 1,

124 
	gAddCo¡
 = 1,

125 
	gMulCo¡
 = 1

129 
	g‹m¶©e
<> 
	gNumT¿™s
<
	gboŞ
>

131 
boŞ
 
	tR—l
;

132 
	tFlßtšgPošt
;

134 
	gIsCom¶ex
 = 0,

135 
	gHasFlßtšgPošt
 = 0,

136 
	gR—dCo¡
 = 1,

137 
	gAddCo¡
 = 1,

138 
	gMulCo¡
 = 1

	@robot/Eigen/src/Core/Part.h

26 #iâdeà
EIGEN_PART_H


27 
	#EIGEN_PART_H


	)

46 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
>

47 
	gei_Œa™s
<
	gP¬t
<
	gM©rixTy³
, 
	gMode
> > : 
ei_Œa™s
<
M©rixTy³
>

49 
ty³Çme
 
	tei_Ã¡ed
<
	tM©rixTy³
>::
	tty³
 
	tM©rixTy³Ne¡ed
;

50 
ty³Çme
 
	tei_uÄef
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

52 
	gFÏgs
 = (
_M©rixTy³Ne¡ed
::
FÏgs
 & (
H”ed™¬yB™s
è& (~(
Pack‘AcûssB™
 | 
DœeùAcûssB™
 | 
Lš—rAcûssB™
))è| 
Mode
,

53 
	gCÛffR—dCo¡
 = 
_M©rixTy³Ne¡ed
::
CÛffR—dCo¡
 + 
CÚd™iÚ®JumpCo¡


57 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
> 
şass
 
	gP¬t


58 : 
public
 
M©rixBa£
<
P¬t
<
M©rixTy³
, 
	gMode
> >

60 
	gpublic
:

62 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
P¬t
)

64 
šlše
 
P¬t
(cÚ¡ 
M©rixTy³
& 
m©rix
è: 
m_m©rix
(matrix)

65 { 
ei_as£¹
(
ei_¬e_æags_cÚsi¡’t
<
Mode
>::
»t
); }

68 
	g‹m¶©e
<
ty³Çme
 
	gOth”
> 
	gP¬t
& 
	gİ”©Ü
+=(cÚ¡ 
Oth”
& 
Ùh”
);

70 
	g‹m¶©e
<
ty³Çme
 
	gOth”
> 
	gP¬t
& 
	gİ”©Ü
-=(cÚ¡ 
Oth”
& 
Ùh”
);

72 
	gP¬t
& 
	gİ”©Ü
*=(cÚ¡ 
ty³Çme
 
ei_Œa™s
<
M©rixTy³
>::
SÿÏr
& 
Ùh”
);

74 
	gP¬t
& 
	gİ”©Ü
/=(cÚ¡ 
ty³Çme
 
ei_Œa™s
<
M©rixTy³
>::
SÿÏr
& 
Ùh”
);

77 
	g‹m¶©e
<
ty³Çme
 
	gOth”
> 
ÏzyAssign
(cÚ¡ 
Oth”
& 
Ùh”
);

79 
	g‹m¶©e
<
ty³Çme
 
	gOth”
> 
	gP¬t
& 
	gİ”©Ü
=(cÚ¡ 
Oth”
& 
Ùh”
);

81 
šlše
 
rows
(ècÚ¡ {  
	gm_m©rix
.rows(); }

82 
šlše
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.cols(); }

83 
šlše
 
¡ride
(ècÚ¡ {  
	gm_m©rix
.stride(); }

85 
šlše
 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

89 ifĞ((
	gFÏgs
 & 
	gLow”TrŸnguÏrB™
è&& (
	gcŞ
>
	grow
)è|| ((FÏg & 
	gUµ”TrŸnguÏrB™
) && (row>col)) )

90  (
	gSÿÏr
)0;

91 if(
	gFÏgs
 & 
	gUn™DŸgB™
)

92  
	gcŞ
==
row
 ? (
SÿÏr
)1 : 
m_m©rix
.
cÛff
Ôow, 
cŞ
);

93 if(
	gFÏgs
 & 
	gZ”oDŸgB™
)

94  
	gcŞ
==
row
 ? (
SÿÏr
)0 : 
m_m©rix
.
cÛff
Ôow, 
cŞ
);

96  
	gm_m©rix
.
cÛff
(
row
, 
cŞ
);

99 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

101 
EIGEN_STATIC_ASSERT
(!(
FÏgs
 & 
Un™DŸgB™
), 
WRITING_TO_TRIANGULAR_PART_WITH_UNIT_DIAGONAL_IS_NOT_SUPPORTED
)

102 
EIGEN_STATIC_ASSERT
(!(
FÏgs
 & 
S–fAdjoštB™
), 
COEFFICIENT_WRITE_ACCESS_TO_SELFADJOINT_NOT_SUPPORTED
)

103 
ei_as£¹
Ğ(
Mode
==
Uµ”TrŸnguÏr
 && 
cŞ
>=
row
)

104 || (
Mode
==
Low”TrŸnguÏr
 && 
cŞ
<=
row
)

105 || (
Mode
==
SŒiùlyUµ”TrŸnguÏr
 && 
cŞ
>
row
)

106 || (
Mode
==
SŒiùlyLow”TrŸnguÏr
 && 
cŞ
<
row
));

107  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
row
, 
cŞ
);

111 cÚ¡ 
	gM©rixTy³
& 
_ex´essiÚ
(ècÚ¡ {  
	gm_m©rix
; }

114 cÚ¡ 
	gBlock
<
	gP¬t
, 1, 
	gCŞsAtCompeTime
> 
row
(
i
è{  
	gBa£
::row(i); }

115 cÚ¡ 
	gBlock
<
	gP¬t
, 1, 
	gCŞsAtCompeTime
> 
row
(
i
ècÚ¡ {  
	gBa£
::row(i); }

117 cÚ¡ 
	gBlock
<
	gP¬t
, 
	gRowsAtCompeTime
, 1> 
cŞ
(
i
è{  
	gBa£
::col(i); }

118 cÚ¡ 
	gBlock
<
	gP¬t
, 
	gRowsAtCompeTime
, 1> 
cŞ
(
i
ècÚ¡ {  
	gBa£
::col(i); }

120 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

121 
sw­
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

123 
	gP¬t
<
	gSw­W¿µ”
<
	gM©rixTy³
>,
	gMode
>(
	gcÚ¡_ÿ¡
<M©rixTy³&>(
	gm_m©rix
)).
ÏzyAssign
(
Ùh”
.
d”ived
());

126 
	g´Ùeùed
:

127 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

129 
	g´iv©e
:

130 
P¬t
& 
İ”©Ü
=(const Part&);

146 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

147 
	g‹m¶©e
<
	gMode
>

148 cÚ¡ 
	gP¬t
<
	gD”ived
, 
	gMode
> 
	gM©rixBa£
<D”ived>::
	$·¹
() const

150  
	`d”ived
();

151 
	}
}

153 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
>

154 
	g‹m¶©e
<
ty³Çme
 
	gOth”
>

155 
šlše
 
	gP¬t
<
	gM©rixTy³
, 
	gMode
>& P¬t<M©rixTy³, Mode>::
İ”©Ü
=(cÚ¡ 
Oth”
& 
Ùh”
)

157 if(
Oth”
::
FÏgs
 & 
Ev®BefÜeAssignšgB™
)

159 
ty³Çme
 
M©rixBa£
<
Oth”
>::
PÏšM©rixTy³
 
Ùh”_ev®u©ed
(
Ùh”
.
rows
(), oth”.
cŞs
());

160 
	gÙh”_ev®u©ed
.
‹m¶©e
 
	g·¹
<
	gMode
>().
ÏzyAssign
(
Ùh”
);

161 
ÏzyAssign
(
Ùh”_ev®u©ed
);

164 
ÏzyAssign
(
Ùh”
.
d”ived
());

165  *
	gthis
;

168 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gMode
, 
	gUÄŞlCouÁ
>

169 
	sei_·¹_assignm’t_im¶


172 
	mcŞ
 = (
UÄŞlCouÁ
-1è/ 
D”ived1
::
RowsAtCompeTime
,

173 
	mrow
 = (
UÄŞlCouÁ
-1è% 
D”ived1
::
RowsAtCompeTime


176 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

178 
	mei_·¹_assignm’t_im¶
<
	mD”ived1
, 
	mD”ived2
, 
	mMode
, 
	mUÄŞlCouÁ
-1>::
run
(
d¡
, 
¤c
);

180 if(
	mMode
 =ğ
S–fAdjošt
)

182 if(
row
 =ğ
cŞ
)

183 
d¡
.
cÛffRef
(
row
, 
cŞ
èğ
ei_»®
(
¤c
.
cÛff
(row, col));

184 if(
	mrow
 < 
	mcŞ
)

185 
	md¡
.
cÛffRef
(
cŞ
, 
row
èğ
ei_cÚj
(
d¡
.cÛffRefÔow, cŞèğ
¤c
.
cÛff
(row, col));

189 
ei_as£¹
(
Mode
 =ğ
Uµ”TrŸnguÏr
 || Mod=ğ
Low”TrŸnguÏr
 || Mod=ğ
SŒiùlyUµ”TrŸnguÏr
 || Mod=ğ
SŒiùlyLow”TrŸnguÏr
);

190 if((
	mMode
 =ğ
Uµ”TrŸnguÏr
 && 
row
 <ğ
cŞ
)

191 || (
Mode
 =ğ
Low”TrŸnguÏr
 && 
row
 >ğ
cŞ
)

192 || (
Mode
 =ğ
SŒiùlyUµ”TrŸnguÏr
 && 
row
 < 
cŞ
)

193 || (
Mode
 =ğ
SŒiùlyLow”TrŸnguÏr
 && 
row
 > 
cŞ
))

194 
d¡
.
cİyCÛff
(
row
, 
cŞ
, 
¤c
);

199 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gMode
>

200 
	gei_·¹_assignm’t_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gMode
, 1>

202 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

204 if(!(
	gMode
 & 
	gZ”oDŸgB™
))

205 
	gd¡
.
cİyCÛff
(0, 0, 
¤c
);

210 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
, 
	gMode
>

211 
	gei_·¹_assignm’t_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gMode
, 0>

213 
šlše
 
run
(
D”ived1
 &, cÚ¡ 
D”ived2
 &) {}

216 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

217 
	gei_·¹_assignm’t_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gUµ”TrŸnguÏr
, 
	gDyÇmic
>

219 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

221 
	gj
 = 0; j < 
	gd¡
.
cŞs
(); ++j)

222 
	gi
 = 0; i <ğ
j
; ++i)

223 
	gd¡
.
cİyCÛff
(
i
, 
j
, 
¤c
);

227 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

228 
	gei_·¹_assignm’t_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gLow”TrŸnguÏr
, 
	gDyÇmic
>

230 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

232 
	gj
 = 0; j < 
	gd¡
.
cŞs
(); ++j)

233 
	gi
 = 
j
; i < 
	gd¡
.
rows
(); ++i)

234 
	gd¡
.
cİyCÛff
(
i
, 
j
, 
¤c
);

238 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

239 
	gei_·¹_assignm’t_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gSŒiùlyUµ”TrŸnguÏr
, 
	gDyÇmic
>

241 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

243 
	gj
 = 0; j < 
	gd¡
.
cŞs
(); ++j)

244 
	gi
 = 0; i < 
	gj
; ++i)

245 
	gd¡
.
cİyCÛff
(
i
, 
j
, 
¤c
);

248 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

249 
	gei_·¹_assignm’t_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gSŒiùlyLow”TrŸnguÏr
, 
	gDyÇmic
>

251 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

253 
	gj
 = 0; j < 
	gd¡
.
cŞs
(); ++j)

254 
	gi
 = 
j
+1; i < 
	gd¡
.
rows
(); ++i)

255 
	gd¡
.
cİyCÛff
(
i
, 
j
, 
¤c
);

258 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

259 
	gei_·¹_assignm’t_im¶
<
	gD”ived1
, 
	gD”ived2
, 
	gS–fAdjošt
, 
	gDyÇmic
>

261 
šlše
 
run
(
D”ived1
 &
d¡
, cÚ¡ 
D”ived2
 &
¤c
)

263 
	gj
 = 0; j < 
	gd¡
.
cŞs
(); ++j)

265 
	gi
 = 0; i < 
	gj
; ++i)

266 
	gd¡
.
cÛffRef
(
j
, 
i
èğ
ei_cÚj
(
d¡
.cÛffRef(i, jèğ
¤c
.
cÛff
(i, j));

267 
	gd¡
.
cÛffRef
(
j
, jèğ
ei_»®
(
¤c
.
cÛff
(j, j));

272 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
>

273 
	g‹m¶©e
<
ty³Çme
 
	gOth”
>

274 
	gP¬t
<
	gM©rixTy³
, 
	gMode
>::
	$ÏzyAssign
(cÚ¡ 
Oth”
& 
Ùh”
)

276 cÚ¡ 
boŞ
 
uÄŞl
 = 
M©rixTy³
::
SizeAtCompeTime
 * 
Oth”
::
CÛffR—dCo¡
 / 2 <ğ
EIGEN_UNROLLING_LIMIT
;

277 
	`ei_as£¹
(
m_m©rix
.
	`rows
(è=ğ
Ùh”
.rows(è&& m_m©rix.
	`cŞs
() == other.cols());

279 
ei_·¹_assignm’t_im¶


280 <
M©rixTy³
, 
Oth”
, 
Mode
,

281 
uÄŞl
 ? (
M©rixTy³
::
SizeAtCompeTime
è: 
DyÇmic


282 >::
	`run
(
m_m©rix
.
	`cÚ¡_ÿ¡_d”ived
(), 
Ùh”
.
	`d”ived
());

283 
	}
}

298 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

299 
	g‹m¶©e
<
	gMode
>

300 
šlše
 
	gP¬t
<
	gD”ived
, 
	gMode
> 
	gM©rixBa£
<D”ived>::
	$·¹
()

302  
P¬t
<
D”ived
, 
Mode
>(
	`d”ived
());

303 
	}
}

310 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

311 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
	$isUµ”TrŸnguÏr
(
R—lSÿÏr
 
´ec
) const

313 if(
	`cŞs
(è!ğ
	`rows
()è 
çl£
;

314 
R—lSÿÏr
 
maxAbsOnUµ”TrŸnguÏrP¬t
 = 
¡©ic_ÿ¡
<RealScalar>(-1);

315 
j
 = 0; j < 
	`cŞs
(); ++j)

316 
i
 = 0; i <ğ
j
; ++i)

318 
R—lSÿÏr
 
absV®ue
 = 
	`ei_abs
(
	`cÛff
(
i
,
j
));

319 if(
absV®ue
 > 
maxAbsOnUµ”TrŸnguÏrP¬t
) maxAbsOnUpperTriangularPart =‡bsValue;

321 
j
 = 0; j < 
	`cŞs
()-1; ++j)

322 
i
 = 
j
+1; i < 
	`rows
(); ++i)

323 if(!
	`ei_isMuchSm®ËrThª
(
	`cÛff
(
i
, 
j
), 
maxAbsOnUµ”TrŸnguÏrP¬t
, 
´ec
)è 
çl£
;

324  
Œue
;

325 
	}
}

332 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

333 
boŞ
 
	gM©rixBa£
<
	gD”ived
>::
	$isLow”TrŸnguÏr
(
R—lSÿÏr
 
´ec
) const

335 if(
	`cŞs
(è!ğ
	`rows
()è 
çl£
;

336 
R—lSÿÏr
 
maxAbsOnLow”TrŸnguÏrP¬t
 = 
¡©ic_ÿ¡
<RealScalar>(-1);

337 
j
 = 0; j < 
	`cŞs
(); ++j)

338 
i
 = 
j
; i < 
	`rows
(); ++i)

340 
R—lSÿÏr
 
absV®ue
 = 
	`ei_abs
(
	`cÛff
(
i
,
j
));

341 if(
absV®ue
 > 
maxAbsOnLow”TrŸnguÏrP¬t
) maxAbsOnLowerTriangularPart =‡bsValue;

343 
j
 = 1; j < 
	`cŞs
(); ++j)

344 
i
 = 0; i < 
j
; ++i)

345 if(!
	`ei_isMuchSm®ËrThª
(
	`cÛff
(
i
, 
j
), 
maxAbsOnLow”TrŸnguÏrP¬t
, 
´ec
)è 
çl£
;

346  
Œue
;

347 
	}
}

349 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
>

350 
	g‹m¶©e
<
ty³Çme
 
	gOth”
>

351 
šlše
 
	gP¬t
<
	gM©rixTy³
, 
	gMode
>& P¬t<M©rixTy³, Mode>::
İ”©Ü
+=(cÚ¡ 
Oth”
& 
Ùh”
)

353  *
this
 = 
m_m©rix
 + 
Ùh”
;

356 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
>

357 
	g‹m¶©e
<
ty³Çme
 
	gOth”
>

358 
šlše
 
	gP¬t
<
	gM©rixTy³
, 
	gMode
>& P¬t<M©rixTy³, Mode>::
İ”©Ü
-=(cÚ¡ 
Oth”
& 
Ùh”
)

360  *
this
 = 
m_m©rix
 - 
Ùh”
;

363 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
>

364 
šlše
 
	gP¬t
<
	gM©rixTy³
, 
	gMode
>& P¬t<M©rixTy³, Mode>::
İ”©Ü
*=

365 (cÚ¡ 
ty³Çme
 
ei_Œa™s
<
M©rixTy³
>::
SÿÏr
& 
Ùh”
)

367  *
this
 = 
m_m©rix
 * 
Ùh”
;

370 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
>

371 
šlše
 
	gP¬t
<
	gM©rixTy³
, 
	gMode
>& P¬t<M©rixTy³, Mode>::
İ”©Ü
/=

372 (cÚ¡ 
ty³Çme
 
ei_Œa™s
<
M©rixTy³
>::
SÿÏr
& 
Ùh”
)

374  *
this
 = 
m_m©rix
 / 
Ùh”
;

	@robot/Eigen/src/Core/Product.h

26 #iâdeà
EIGEN_PRODUCT_H


27 
	#EIGEN_PRODUCT_H


	)

33 
	g‹m¶©e
<
	gVeùÜiz©iÚMode
, 
	gIndex
, 
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gR‘SÿÏr
>

34 
	gei_´oduù_cÛff_im¶
;

36 
	g‹m¶©e
<
	gStÜageOrd”
, 
	gIndex
, 
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
, 
	gLßdMode
>

37 
	gei_´oduù_·ck‘_im¶
;

55 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gProduùMode
>

56 
	sProduùR‘uºTy³


58 
ty³Çme
 
	tei_Ã¡ed
<
	tLhs
,
	tRhs
::
	tCŞsAtCompeTime
>::
	tty³
 
	tLhsNe¡ed
;

59 
ty³Çme
 
	tei_Ã¡ed
<
	tRhs
,
	tLhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tRhsNe¡ed
;

61 
	mProduù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
, 
	tProduùMode
> 
	tTy³
;

66 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

67 
	gProduùR‘uºTy³
<
	gLhs
,
	gRhs
,
	gCacheFr›ndlyProduù
>

69 cÚ¡ 
	tLhs
& 
	tLhsNe¡ed
;

70 cÚ¡ 
	tRhs
& 
	tRhsNe¡ed
;

72 
	gProduù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
, 
	tCacheFr›ndlyProduù
> 
	tTy³
;

80 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
> 
	sei_´oduù_mode


84 
	mv®ue
 = ((
Rhs
::
FÏgs
&
DŸgÚ®
)==DŸgÚ®è|| ((
Lhs
::Flags&Diagonal)==Diagonal)

85 ? 
DŸgÚ®Produù


86 : 
Lhs
::
MaxCŞsAtCompeTime
 =ğ
DyÇmic


87 && ( 
Lhs
::
MaxRowsAtCompeTime
 =ğ
DyÇmic


88 || 
Rhs
::
MaxCŞsAtCompeTime
 =ğ
DyÇmic
 )

89 && (!(
Rhs
::
IsVeùÜAtCompeTime
 && (
Lhs
::
FÏgs
&
RowMajÜB™
è&& (!(Lhs::FÏgs&
DœeùAcûssB™
))))

90 && (!(
Lhs
::
IsVeùÜAtCompeTime
 && (!(
Rhs
::
FÏgs
&
RowMajÜB™
)è&& (!(Rhs::FÏgs&
DœeùAcûssB™
))))

91 && (
ei_is_§me_ty³
<
ty³Çme
 
Lhs
::
SÿÏr
,y³Çm
	mRhs
::SÿÏr>::
»t
)

92 ? 
CacheFr›ndlyProduù


93 : 
NÜm®Produù
 };

112 
	g‹m¶©e
<
ty³Çme
 
	gLhsNe¡ed
,y³Çm
	gRhsNe¡ed
, 
	gProduùMode
>

113 
	gei_Œa™s
<
	gProduù
<
	gLhsNe¡ed
, 
	gRhsNe¡ed
, 
	gProduùMode
> >

116 
ty³Çme
 
	tei_ş—Áy³
<
	tLhsNe¡ed
>::
	tty³
 
	t_LhsNe¡ed
;

117 
ty³Çme
 
	tei_ş—Áy³
<
	tRhsNe¡ed
>::
	tty³
 
	t_RhsNe¡ed
;

118 
ty³Çme
 
	tei_sÿÏr_´oduù_Œa™s
<
	tty³Çme
 
	t_LhsNe¡ed
::
	tSÿÏr
,y³Çm
	t_RhsNe¡ed
::SÿÏr>::
	tR‘uºTy³
 Scalar;

121 
	gLhsCÛffR—dCo¡
 = 
_LhsNe¡ed
::
CÛffR—dCo¡
,

122 
	gRhsCÛffR—dCo¡
 = 
_RhsNe¡ed
::
CÛffR—dCo¡
,

123 
	gLhsFÏgs
 = 
_LhsNe¡ed
::
FÏgs
,

124 
	gRhsFÏgs
 = 
_RhsNe¡ed
::
FÏgs
,

126 
	gRowsAtCompeTime
 = 
_LhsNe¡ed
::
RowsAtCompeTime
,

127 
	gCŞsAtCompeTime
 = 
_RhsNe¡ed
::
CŞsAtCompeTime
,

128 
	gIÂ”Size
 = 
EIGEN_SIZE_MIN
(
_LhsNe¡ed
::
CŞsAtCompeTime
, 
_RhsNe¡ed
::
RowsAtCompeTime
),

130 
	gMaxRowsAtCompeTime
 = 
_LhsNe¡ed
::
MaxRowsAtCompeTime
,

131 
	gMaxCŞsAtCompeTime
 = 
_RhsNe¡ed
::
MaxCŞsAtCompeTime
,

133 
	gLhsRowMajÜ
 = 
LhsFÏgs
 & 
RowMajÜB™
,

134 
	gRhsRowMajÜ
 = 
RhsFÏgs
 & 
RowMajÜB™
,

136 
	gCªVeùÜizeRhs
 = 
RhsRowMajÜ
 && (
RhsFÏgs
 & 
Pack‘AcûssB™
)

137 && (
CŞsAtCompeTime
 % 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 == 0),

139 
	gCªVeùÜizeLhs
 = (!
LhsRowMajÜ
è&& (
LhsFÏgs
 & 
Pack‘AcûssB™
)

140 && (
RowsAtCompeTime
 % 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 == 0),

142 
	gEv®ToRowMajÜ
 = 
RhsRowMajÜ
 && (
ProduùMode
==()
CacheFr›ndlyProduù
 ? 
LhsRowMajÜ
 : (!
CªVeùÜizeLhs
)),

144 
	gRemovedB™s
 = ~((
Ev®ToRowMajÜ
 ? 0 : 
RowMajÜB™
)|
DœeùAcûssB™
),

146 
	gFÏgs
 = (()(
LhsFÏgs
 | 
RhsFÏgs
è& 
H”ed™¬yB™s
 & 
RemovedB™s
)

147 | 
Ev®BefÜeAssignšgB™


148 | 
Ev®BefÜeNe¡šgB™


149 | (
CªVeùÜizeLhs
 || 
CªVeùÜizeRhs
 ? 
Pack‘AcûssB™
 : 0)

150 | (
LhsFÏgs
 & 
RhsFÏgs
 & 
AligÃdB™
),

152 
	gCÛffR—dCo¡
 = 
IÂ”Size
 =ğ
DyÇmic
 ? Dynamic

153 : 
IÂ”Size
 * (
NumT¿™s
<
SÿÏr
>::
MulCo¡
 + 
LhsCÛffR—dCo¡
 + 
RhsCÛffR—dCo¡
)

154 + (
IÂ”Size
 - 1è* 
NumT¿™s
<
SÿÏr
>::
AddCo¡
,

161 
	gCªVeùÜizeIÂ”
 = 
LhsRowMajÜ
 && (!
RhsRowMajÜ
è&& (
LhsFÏgs
 & 
RhsFÏgs
 & 
Aùu®Pack‘AcûssB™
)

162 && (
IÂ”Size
 % 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 == 0)

166 
	g‹m¶©e
<
ty³Çme
 
	gLhsNe¡ed
,y³Çm
	gRhsNe¡ed
, 
	gProduùMode
> 
şass
 
	gProduù
 : 
ei_no_assignm’t_İ”©Ü
,

167 
public
 
	gM©rixBa£
<
	gProduù
<
	gLhsNe¡ed
, 
	gRhsNe¡ed
, 
	gProduùMode
> >

169 
	gpublic
:

171 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Produù
)

173 
´iv©e
:

175 
ty³Çme
 
	tei_Œa™s
<
	tProduù
>::
	t_LhsNe¡ed
 _LhsNested;

176 
ty³Çme
 
	tei_Œa™s
<
	tProduù
>::
	t_RhsNe¡ed
 _RhsNested;

179 
	gPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
,

180 
	gIÂ”Size
 = 
ei_Œa™s
<
Produù
>::
IÂ”Size
,

181 
	gUÄŞl
 = 
CÛffR—dCo¡
 <ğ
EIGEN_UNROLLING_LIMIT
,

182 
	gCªVeùÜizeIÂ”
 = 
ei_Œa™s
<
Produù
>::
CªVeùÜizeIÂ”


185 
	gei_´oduù_cÛff_im¶
<
	tCªVeùÜizeIÂ”
 ? 
	tIÂ”VeùÜiz©iÚ
 : 
	tNoVeùÜiz©iÚ
,

186 
	tUÄŞl
 ? 
	tIÂ”Size
-1 : 
	tDyÇmic
,

187 
	t_LhsNe¡ed
, 
	t_RhsNe¡ed
, 
	tSÿÏr
> 
	tSÿÏrCÛffIm¶
;

189 
	gpublic
:

191 
‹m¶©e
<
ty³Çme
 
Lhs
,y³Çm
	gRhs
>

192 
šlše
 
Produù
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
)

193 : 
m_lhs
(
lhs
), 
m_rhs
(
rhs
)

197 
EIGEN_STATIC_ASSERT
((
ei_is_§me_ty³
<
ty³Çme
 
Lhs
::
R—lSÿÏr
,y³Çm
Rhs
::R—lSÿÏr>::
»t
),

198 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

199 
ei_as£¹
(
lhs
.
cŞs
(è=ğ
rhs
.
rows
()

207 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

208 
_ÿcheFr›ndlyEv®AndAdd
(
De¡D”ived
& 
»s
) const;

213 
EIGEN_STRONG_INLINE
 
boŞ
 
_u£CacheFr›ndlyProduù
() const

215  
	gm_lhs
.
cŞs
()>=
EIGEN_CACHEFRIENDLY_PRODUCT_THRESHOLD


216 && ( 
rows
()>=
EIGEN_CACHEFRIENDLY_PRODUCT_THRESHOLD


217 || 
cŞs
()>=
EIGEN_CACHEFRIENDLY_PRODUCT_THRESHOLD
);

220 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_lhs
.rows(); }

221 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_rhs
.cols(); }

223 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

225 
SÿÏr
 
	g»s
;

226 
	gSÿÏrCÛffIm¶
::
run
(
row
, 
cŞ
, 
m_lhs
, 
m_rhs
, 
»s
);

227  
	g»s
;

233 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

235 
SÿÏr
 
	g»s
;

236 cÚ¡ 
	grow
 = 
RowsAtCompeTime
 =ğ1 ? 0 : 
šdex
;

237 cÚ¡ 
	gcŞ
 = 
RowsAtCompeTime
 =ğ1 ? 
šdex
 : 0;

238 
	gSÿÏrCÛffIm¶
::
run
(
row
, 
cŞ
, 
m_lhs
, 
m_rhs
, 
»s
);

239  
	g»s
;

242 
	g‹m¶©e
<
	gLßdMode
>

243 
EIGEN_STRONG_INLINE
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

245 
Pack‘SÿÏr
 
	g»s
;

246 
	gei_´oduù_·ck‘_im¶
<
	gFÏgs
&
	gRowMajÜB™
 ? 
	gRowMajÜ
 : 
CŞMajÜ
,

247 
	gUÄŞl
 ? 
	gIÂ”Size
-1 : 
DyÇmic
,

248 
	g_LhsNe¡ed
, 
	g_RhsNe¡ed
, 
	gPack‘SÿÏr
, 
	gLßdMode
>

249 ::
run
(
row
, 
cŞ
, 
m_lhs
, 
m_rhs
, 
»s
);

250  
	g»s
;

253 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_LhsNe¡ed
& 
lhs
(ècÚ¡ {  
	gm_lhs
; }

254 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_RhsNe¡ed
& 
rhs
(ècÚ¡ {  
	gm_rhs
; }

256 
	g´Ùeùed
:

257 cÚ¡ 
LhsNe¡ed
 
m_lhs
;

258 cÚ¡ 
RhsNe¡ed
 
	gm_rhs
;

267 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

268 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

269 
šlše
 cÚ¡ 
ty³Çme
 
	gProduùR‘uºTy³
<
	gD”ived
,
	gOth”D”ived
>::
Ty³


270 
M©rixBa£
<
D”ived
>::
İ”©Ü
*(cÚ¡ M©rixBa£<
Oth”D”ived
> &
Ùh”
) const

273 
ProduùIsV®id
 = 
D”ived
::
CŞsAtCompeTime
==
DyÇmic


274 || 
Oth”D”ived
::
RowsAtCompeTime
==
DyÇmic


275 || (
D”ived
::
CŞsAtCompeTime
)==(
Oth”D”ived
::
RowsAtCompeTime
),

276 
	gA»VeùÜs
 = 
D”ived
::
IsVeùÜAtCompeTime
 && 
Oth”D”ived
::IsVectorAtCompileTime,

277 
	gSameSizes
 = 
EIGEN_PREDICATE_SAME_MATRIX_SIZE
(
D”ived
,
Oth”D”ived
)

282 
EIGEN_STATIC_ASSERT
(
ProduùIsV®id
 || !(
A»VeùÜs
 && 
SameSizes
),

283 
INVALID_VECTOR_VECTOR_PRODUCT__IF_YOU_WANTED_A_DOT_OR_COEFF_WISE_PRODUCT_YOU_MUST_USE_THE_EXPLICIT_FUNCTIONS
)

284 
EIGEN_STATIC_ASSERT
(
ProduùIsV®id
 || !(
SameSizes
 && !
A»VeùÜs
),

285 
INVALID_MATRIX_PRODUCT__IF_YOU_WANTED_A_COEFF_WISE_PRODUCT_YOU_MUST_USE_THE_EXPLICIT_FUNCTION
)

286 
EIGEN_STATIC_ASSERT
(
ProduùIsV®id
 || 
SameSizes
, 
INVALID_MATRIX_PRODUCT
)

287  
ty³Çme
 
	gProduùR‘uºTy³
<
	gD”ived
,
	gOth”D”ived
>::
Ty³
(
d”ived
(), 
Ùh”
.derived());

294 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

295 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

296 
šlše
 
	gD”ived
 &

297 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
*=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

299  
d”ived
(èğd”ived(è* 
Ùh”
.derived();

310 
	g‹m¶©e
<
	gIndex
, 
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gR‘SÿÏr
>

311 
	gei_´oduù_cÛff_im¶
<
	gNoVeùÜiz©iÚ
, 
	gIndex
, 
	gLhs
, 
	gRhs
, 
	gR‘SÿÏr
>

313 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
R‘SÿÏr
 &
»s
)

315 
	gei_´oduù_cÛff_im¶
<
	gNoVeùÜiz©iÚ
, 
	gIndex
-1, 
	gLhs
, 
	gRhs
, 
	gR‘SÿÏr
>::
run
(
row
, 
cŞ
, 
lhs
, 
rhs
, 
»s
);

316 
	g»s
 +ğ
lhs
.
cÛff
(
row
, 
Index
è* 
	grhs
.cÛff(Index, 
cŞ
);

320 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gR‘SÿÏr
>

321 
	gei_´oduù_cÛff_im¶
<
	gNoVeùÜiz©iÚ
, 0, 
	gLhs
, 
	gRhs
, 
	gR‘SÿÏr
>

323 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
R‘SÿÏr
 &
»s
)

325 
	g»s
 = 
lhs
.
cÛff
(
row
, 0è* 
	grhs
.cÛff(0, 
cŞ
);

329 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gR‘SÿÏr
>

330 
	gei_´oduù_cÛff_im¶
<
	gNoVeùÜiz©iÚ
, 
	gDyÇmic
, 
	gLhs
, 
	gRhs
, 
	gR‘SÿÏr
>

332 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
R‘SÿÏr
& 
»s
)

334 
ei_as£¹
(
lhs
.
cŞs
()>0 && "you‡re using‡‚on initialized matrix");

335 
	g»s
 = 
lhs
.
cÛff
(
row
, 0è* 
	grhs
.cÛff(0, 
cŞ
);

336 
	gi
 = 1; i < 
	glhs
.
cŞs
(); ++i)

337 
	g»s
 +ğ
lhs
.
cÛff
(
row
, 
i
è* 
	grhs
.cÛff(i, 
cŞ
);

342 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gR‘SÿÏr
>

343 
	gei_´oduù_cÛff_im¶
<
	gNoVeùÜiz©iÚ
, -1, 
	gLhs
, 
	gRhs
, 
	gR‘SÿÏr
>

345 
EIGEN_STRONG_INLINE
 
run
(, , cÚ¡ 
Lhs
&, cÚ¡ 
Rhs
&, 
R‘SÿÏr
&) {}

352 
	g‹m¶©e
<
	gIndex
, 
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
>

353 
	sei_´oduù_cÛff_veùÜized_uÄŞËr


355 ’um { 
	mPack‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
Lhs
::
SÿÏr
>::
size
 };

356 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ty³Çme
 Lhs::
Pack‘SÿÏr
 &
´es
)

358 
ei_´oduù_cÛff_veùÜized_uÄŞËr
<
Index
-
Pack‘Size
, 
	mLhs
, 
	mRhs
, 
	mPack‘SÿÏr
>::
run
(
row
, 
cŞ
, 
lhs
, 
rhs
, 
´es
);

359 
	m´es
 = 
ei_·dd
(
´es
, 
ei_pmul
Ğ
lhs
.
‹m¶©e
 
·ck‘
<
AligÃd
>(
row
, 
Index
è, 
rhs
.‹m¶©·ck‘<AligÃd>(Index, 
cŞ
) ));

363 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
>

364 
	gei_´oduù_cÛff_veùÜized_uÄŞËr
<0, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
>

366 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ty³Çme
 Lhs::
Pack‘SÿÏr
 &
´es
)

368 
´es
 = 
ei_pmul
(
lhs
.
‹m¶©e
 
·ck‘
<
AligÃd
>(
row
, 0è, 
rhs
.‹m¶©·ck‘<AligÃd>(0, 
cŞ
));

372 
	g‹m¶©e
<
	gIndex
, 
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gR‘SÿÏr
>

373 
	gei_´oduù_cÛff_im¶
<
	gIÂ”VeùÜiz©iÚ
, 
	gIndex
, 
	gLhs
, 
	gRhs
, 
	gR‘SÿÏr
>

375 
ty³Çme
 
	tLhs
::
	tPack‘SÿÏr
 PacketScalar;

376 ’um { 
	gPack‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
Lhs
::
SÿÏr
>::
size
 };

377 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
R‘SÿÏr
 &
»s
)

379 
Pack‘SÿÏr
 
	g´es
;

380 
	gei_´oduù_cÛff_veùÜized_uÄŞËr
<
	gIndex
+1-
	gPack‘Size
, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
>::
run
(
row
, 
cŞ
, 
lhs
, 
rhs
, 
´es
);

381 
	gei_´oduù_cÛff_im¶
<
	gNoVeùÜiz©iÚ
,
	gIndex
,
	gLhs
,
	gRhs
,
	gR‘SÿÏr
>::
run
(
row
, 
cŞ
, 
lhs
, 
rhs
, 
»s
);

382 
	g»s
 = 
ei_´edux
(
´es
);

386 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gLhsRows
 = 
Lhs
::
RowsAtCompeTime
, 
	gRhsCŞs
 = 
Rhs
::
CŞsAtCompeTime
>

387 
	sei_´oduù_cÛff_veùÜized_dyn_£ËùÜ


389 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ty³Çme
 Lhs::
SÿÏr
 &
»s
)

391 
»s
 = 
ei_dÙ_im¶
<

392 
Block
<
Lhs
, 1, 
	mei_Œa™s
<
	mLhs
>::
CŞsAtCompeTime
>,

393 
	mBlock
<
	mRhs
, 
	mei_Œa™s
<Rhs>::
RowsAtCompeTime
, 1>,

394 
	mLš—rVeùÜiz©iÚ
, 
	mNoUÄŞlšg
>::
run
(
lhs
.
row
Ôow), 
rhs
.
cŞ
(col));

400 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gRhsCŞs
>

401 
	gei_´oduù_cÛff_veùÜized_dyn_£ËùÜ
<
	gLhs
,
	gRhs
,1,
	gRhsCŞs
>

403 
EIGEN_STRONG_INLINE
 
run
(, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ty³Çme
 Lhs::
SÿÏr
 &
»s
)

405 
»s
 = 
ei_dÙ_im¶
<

406 
Lhs
,

407 
	gBlock
<
	gRhs
, 
	gei_Œa™s
<Rhs>::
RowsAtCompeTime
, 1>,

408 
	gLš—rVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>::
run
(
lhs
, 
rhs
.
cŞ
(col));

412 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gLhsRows
>

413 
	gei_´oduù_cÛff_veùÜized_dyn_£ËùÜ
<
	gLhs
,
	gRhs
,
	gLhsRows
,1>

415 
EIGEN_STRONG_INLINE
 
run
(
row
, , cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ty³Çme
 Lhs::
SÿÏr
 &
»s
)

417 
»s
 = 
ei_dÙ_im¶
<

418 
Block
<
Lhs
, 1, 
	gei_Œa™s
<
	gLhs
>::
CŞsAtCompeTime
>,

419 
	gRhs
,

420 
	gLš—rVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>::
run
(
lhs
.
row
Ôow), 
rhs
);

424 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

425 
	gei_´oduù_cÛff_veùÜized_dyn_£ËùÜ
<
	gLhs
,
	gRhs
,1,1>

427 
EIGEN_STRONG_INLINE
 
run
(, , cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ty³Çme
 Lhs::
SÿÏr
 &
»s
)

429 
»s
 = 
ei_dÙ_im¶
<

430 
Lhs
,

431 
	gRhs
,

432 
	gLš—rVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>::
run
(
lhs
, 
rhs
);

436 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gR‘SÿÏr
>

437 
	gei_´oduù_cÛff_im¶
<
	gIÂ”VeùÜiz©iÚ
, 
	gDyÇmic
, 
	gLhs
, 
	gRhs
, 
	gR‘SÿÏr
>

439 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ty³Çme
 Lhs::
SÿÏr
 &
»s
)

441 
ei_´oduù_cÛff_veùÜized_dyn_£ËùÜ
<
Lhs
,
	gRhs
>::
run
(
row
, 
cŞ
, 
lhs
, 
rhs
, 
»s
);

449 
	g‹m¶©e
<
	gIndex
, 
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
, 
	gLßdMode
>

450 
	gei_´oduù_·ck‘_im¶
<
	gRowMajÜ
, 
	gIndex
, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>

452 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
Pack‘SÿÏr
 &
»s
)

454 
	gei_´oduù_·ck‘_im¶
<
	gRowMajÜ
, 
	gIndex
-1, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>::
run
(
row
, 
cŞ
, 
lhs
, 
rhs
, 
»s
);

455 
	g»s
 = 
ei_pmadd
(
ei_p£t1
(
lhs
.
cÛff
(
row
, 
Index
)), 
rhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(Index, 
cŞ
), 
»s
);

459 
	g‹m¶©e
<
	gIndex
, 
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
, 
	gLßdMode
>

460 
	gei_´oduù_·ck‘_im¶
<
	gCŞMajÜ
, 
	gIndex
, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>

462 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
Pack‘SÿÏr
 &
»s
)

464 
	gei_´oduù_·ck‘_im¶
<
	gCŞMajÜ
, 
	gIndex
-1, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>::
run
(
row
, 
cŞ
, 
lhs
, 
rhs
, 
»s
);

465 
	g»s
 = 
ei_pmadd
(
lhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
, 
Index
), 
ei_p£t1
(
rhs
.
cÛff
(Index, 
cŞ
)), 
»s
);

469 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
, 
	gLßdMode
>

470 
	gei_´oduù_·ck‘_im¶
<
	gRowMajÜ
, 0, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>

472 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
Pack‘SÿÏr
 &
»s
)

474 
	g»s
 = 
ei_pmul
(
ei_p£t1
(
lhs
.
cÛff
(
row
, 0)),
rhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(0, 
cŞ
));

478 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
, 
	gLßdMode
>

479 
	gei_´oduù_·ck‘_im¶
<
	gCŞMajÜ
, 0, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>

481 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
Pack‘SÿÏr
 &
»s
)

483 
	g»s
 = 
ei_pmul
(
lhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
, 0), 
ei_p£t1
(
rhs
.
cÛff
(0, 
cŞ
)));

487 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
, 
	gLßdMode
>

488 
	gei_´oduù_·ck‘_im¶
<
	gRowMajÜ
, 
	gDyÇmic
, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>

490 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
Pack‘SÿÏr
& 
»s
)

492 
ei_as£¹
(
lhs
.
cŞs
()>0 && "you‡re using‡‚on initialized matrix");

493 
	g»s
 = 
ei_pmul
(
ei_p£t1
(
lhs
.
cÛff
(
row
, 0)),
rhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(0, 
cŞ
));

494 
	gi
 = 1; i < 
	glhs
.
cŞs
(); ++i)

495 
	g»s
 = 
ei_pmadd
(
ei_p£t1
(
lhs
.
cÛff
(
row
, 
i
)), 
rhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(i, 
cŞ
), 
»s
);

499 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gPack‘SÿÏr
, 
	gLßdMode
>

500 
	gei_´oduù_·ck‘_im¶
<
	gCŞMajÜ
, 
	gDyÇmic
, 
	gLhs
, 
	gRhs
, 
	gPack‘SÿÏr
, 
	gLßdMode
>

502 
EIGEN_STRONG_INLINE
 
run
(
row
, 
cŞ
, cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
Pack‘SÿÏr
& 
»s
)

504 
ei_as£¹
(
lhs
.
cŞs
()>0 && "you‡re using‡‚on initialized matrix");

505 
	g»s
 = 
ei_pmul
(
lhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
, 0), 
ei_p£t1
(
rhs
.
cÛff
(0, 
cŞ
)));

506 
	gi
 = 1; i < 
	glhs
.
cŞs
(); ++i)

507 
	g»s
 = 
ei_pmadd
(
lhs
.
‹m¶©e
 
·ck‘
<
LßdMode
>(
row
, 
i
), 
ei_p£t1
(
rhs
.
cÛff
(i, 
cŞ
)), 
»s
);

515 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gRhsTy³
>

516 
ei_ÿche_ä›ndly_´oduù_cŞmajÜ_times_veùÜ
(

517 
size
, cÚ¡ 
SÿÏr
* 
lhs
, 
lhsSŒide
, cÚ¡ 
RhsTy³
& 
rhs
, SÿÏr* 
»s
);

519 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gResTy³
>

520 
ei_ÿche_ä›ndly_´oduù_rowmajÜ_times_veùÜ
(

521 cÚ¡ 
SÿÏr
* 
lhs
, 
lhsSŒide
, cÚ¡ SÿÏr* 
rhs
, 
rhsSize
, 
ResTy³
& 
»s
);

523 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
,

524 
	gLhsRows
 = 
ei_Œa™s
<
ProduùTy³
>::
RowsAtCompeTime
,

525 
	gLhsOrd”
 = (
ei_Œa™s
<
ProduùTy³
>::
LhsFÏgs
)&
RowMajÜB™
 ? 
RowMajÜ
 : 
CŞMajÜ
,

526 
	gLhsHasDœeùAcûss
 = (
ei_Œa™s
<
ProduùTy³
>::
LhsFÏgs
)&
DœeùAcûssB™
? 
HasDœeùAcûss
 : 
NoDœeùAcûss
,

527 
	gRhsCŞs
 = 
ei_Œa™s
<
ProduùTy³
>::
CŞsAtCompeTime
,

528 
	gRhsOrd”
 = (
ei_Œa™s
<
ProduùTy³
>::
RhsFÏgs
)&
RowMajÜB™
 ? 
RowMajÜ
 : 
CŞMajÜ
,

529 
	gRhsHasDœeùAcûss
 = (
ei_Œa™s
<
ProduùTy³
>::
RhsFÏgs
)&
DœeùAcûssB™
? 
HasDœeùAcûss
 : 
NoDœeùAcûss
>

530 
	sei_ÿche_ä›ndly_´oduù_£ËùÜ


532 
‹m¶©e
<
ty³Çme
 
De¡D”ived
>

533 
šlše
 
run
(
De¡D”ived
& 
»s
, cÚ¡ 
ProduùTy³
& 
´oduù
)

535 
´oduù
.
_ÿcheFr›ndlyEv®AndAdd
(
»s
);

540 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsRows
, 
	gRhsOrd”
, 
	gRhsAcûss
>

541 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,
	gLhsRows
,
	gCŞMajÜ
,
	gNoDœeùAcûss
,1,
	gRhsOrd”
,
	gRhsAcûss
>

543 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

544 
šlše
 
run
(
De¡D”ived
& 
»s
, cÚ¡ 
ProduùTy³
& 
´oduù
)

546 cÚ¡ 
	gsize
 = 
´oduù
.
rhs
().
rows
();

547 
	gk
=0; k<
	gsize
; ++k)

548 
	g»s
 +ğ
´oduù
.
rhs
().
cÛff
(
k
è*…roduù.
lhs
().
cŞ
(k);

554 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsRows
, 
	gRhsOrd”
, 
	gRhsAcûss
>

555 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,
	gLhsRows
,
	gCŞMajÜ
,
	gHasDœeùAcûss
,1,
	gRhsOrd”
,
	gRhsAcûss
>

557 
ty³Çme
 
	tProduùTy³
::
	tSÿÏr
 Scalar;

559 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

560 
šlše
 
run
(
De¡D”ived
& 
»s
, cÚ¡ 
ProduùTy³
& 
´oduù
)

563 
	gEv®ToRes
 = (
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
==1)

564 ||((
De¡D”ived
::
FÏgs
&
Aùu®Pack‘AcûssB™
è&& (!(De¡D”ived::FÏg & 
RowMajÜB™
))) };

565 
SÿÏr
* 
EIGEN_RESTRICT
 
	g_»s
;

566 ià(
	gEv®ToRes
)

567 
	g_»s
 = &
»s
.
cÛffRef
(0);

570 
	g_»s
 = 
ei_®igÃd_¡ack_Ãw
(
SÿÏr
,
»s
.
size
());

571 
	gM­
<
	gM©rix
<
	gSÿÏr
,
	gDe¡D”ived
::
RowsAtCompeTime
,1,
	gCŞMajÜ
> >(
	g_»s
, 
	g»s
.
size
()èğ
»s
;

573 
ei_ÿche_ä›ndly_´oduù_cŞmajÜ_times_veùÜ
(
»s
.
size
(),

574 &
´oduù
.
lhs
().
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(0,0),…roduù.lhs().
¡ride
(),

575 
´oduù
.
rhs
(), 
_»s
);

577 ià(!
	gEv®ToRes
)

579 
	g»s
 = 
M­
<
M©rix
<
SÿÏr
,
	gDe¡D”ived
::
SizeAtCompeTime
,1,
	gCŞMajÜ
> >(
	g_»s
,„es.
size
());

580 
ei_®igÃd_¡ack_d–‘e
(
SÿÏr
, 
_»s
, 
»s
.
size
());

586 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsOrd”
, 
	gLhsAcûss
, 
	gRhsCŞs
>

587 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,1,
	gLhsOrd”
,
	gLhsAcûss
,
	gRhsCŞs
,
	gRowMajÜ
,
	gNoDœeùAcûss
>

589 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

590 
šlše
 
run
(
De¡D”ived
& 
»s
, cÚ¡ 
ProduùTy³
& 
´oduù
)

592 cÚ¡ 
	gcŞs
 = 
´oduù
.
lhs
().
cŞs
();

593 
	gj
=0; j<
	gcŞs
; ++j)

594 
	g»s
 +ğ
´oduù
.
lhs
().
cÛff
(
j
è*…roduù.
rhs
().
row
(j);

600 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsOrd”
, 
	gLhsAcûss
, 
	gRhsCŞs
>

601 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,1,
	gLhsOrd”
,
	gLhsAcûss
,
	gRhsCŞs
,
	gRowMajÜ
,
	gHasDœeùAcûss
>

603 
ty³Çme
 
	tProduùTy³
::
	tSÿÏr
 Scalar;

605 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

606 
šlše
 
run
(
De¡D”ived
& 
»s
, cÚ¡ 
ProduùTy³
& 
´oduù
)

609 
	gEv®ToRes
 = (
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
==1)

610 ||((
De¡D”ived
::
FÏgs
 & 
Aùu®Pack‘AcûssB™
è&& (De¡D”ived::FÏg & 
RowMajÜB™
)) };

611 
SÿÏr
* 
EIGEN_RESTRICT
 
	g_»s
;

612 ià(
	gEv®ToRes
)

613 
	g_»s
 = &
»s
.
cÛffRef
(0);

616 
	g_»s
 = 
ei_®igÃd_¡ack_Ãw
(
SÿÏr
, 
»s
.
size
());

617 
	gM­
<
	gM©rix
<
	gSÿÏr
,1,
	gDe¡D”ived
::
SizeAtCompeTime
,
	gCŞMajÜ
> >(
	g_»s
, 
	g»s
.
size
()èğ
»s
;

619 
ei_ÿche_ä›ndly_´oduù_cŞmajÜ_times_veùÜ
(
»s
.
size
(),

620 &
´oduù
.
rhs
().
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(0,0),…roduù.rhs().
¡ride
(),

621 
´oduù
.
lhs
().
Œª¥o£
(), 
_»s
);

623 ià(!
	gEv®ToRes
)

625 
	g»s
 = 
M­
<
M©rix
<
SÿÏr
,1,
	gDe¡D”ived
::
SizeAtCompeTime
,
	gCŞMajÜ
> >(
	g_»s
,„es.
size
());

626 
ei_®igÃd_¡ack_d–‘e
(
SÿÏr
, 
_»s
, 
»s
.
size
());

632 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsRows
, 
	gRhsOrd”
, 
	gRhsAcûss
>

633 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,
	gLhsRows
,
	gRowMajÜ
,
	gHasDœeùAcûss
,1,
	gRhsOrd”
,
	gRhsAcûss
>

635 
ty³Çme
 
	tProduùTy³
::
	tSÿÏr
 Scalar;

636 
ty³Çme
 
	tei_Œa™s
<
	tProduùTy³
>::
	t_RhsNe¡ed
 
	tRhs
;

638 
	gU£RhsDœeùly
 = ((
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
==1è|| (
Rhs
::
FÏgs
&
Aùu®Pack‘AcûssB™
))

639 && (
Rhs
::
FÏgs
&
DœeùAcûssB™
)

640 && (!(
Rhs
::
FÏgs
 & 
RowMajÜB™
)) };

642 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

643 
šlše
 
run
(
De¡D”ived
& 
»s
, cÚ¡ 
ProduùTy³
& 
´oduù
)

645 
SÿÏr
* 
EIGEN_RESTRICT
 
	g_rhs
;

646 ià(
	gU£RhsDœeùly
)

647 
	g_rhs
 = &
´oduù
.
rhs
().
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(0);

650 
	g_rhs
 = 
ei_®igÃd_¡ack_Ãw
(
SÿÏr
, 
´oduù
.
rhs
().
size
());

651 
	gM­
<
	gM©rix
<
	gSÿÏr
,
	gRhs
::
SizeAtCompeTime
,1,
	gCŞMajÜ
> >(
	g_rhs
, 
	g´oduù
.
rhs
().
size
()èğ
´oduù
.rhs();

653 
ei_ÿche_ä›ndly_´oduù_rowmajÜ_times_veùÜ
(&
´oduù
.
lhs
().
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(0,0),…roduù.lhs().
¡ride
(),

654 
_rhs
, 
´oduù
.
rhs
().
size
(), 
»s
);

656 ià(!
	gU£RhsDœeùly
è
ei_®igÃd_¡ack_d–‘e
(
SÿÏr
, 
_rhs
, 
´oduù
.
rhs
().
size
());

661 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsOrd”
, 
	gLhsAcûss
, 
	gRhsCŞs
>

662 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,1,
	gLhsOrd”
,
	gLhsAcûss
,
	gRhsCŞs
,
	gCŞMajÜ
,
	gHasDœeùAcûss
>

664 
ty³Çme
 
	tProduùTy³
::
	tSÿÏr
 Scalar;

665 
ty³Çme
 
	tei_Œa™s
<
	tProduùTy³
>::
	t_LhsNe¡ed
 
	tLhs
;

667 
	gU£LhsDœeùly
 = ((
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
==1è|| (
Lhs
::
FÏgs
&
Aùu®Pack‘AcûssB™
))

668 && (
Lhs
::
FÏgs
&
DœeùAcûssB™
)

669 && (
Lhs
::
FÏgs
 & 
RowMajÜB™
) };

671 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

672 
šlše
 
run
(
De¡D”ived
& 
»s
, cÚ¡ 
ProduùTy³
& 
´oduù
)

674 
SÿÏr
* 
EIGEN_RESTRICT
 
	g_lhs
;

675 ià(
	gU£LhsDœeùly
)

676 
	g_lhs
 = &
´oduù
.
lhs
().
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(0);

679 
	g_lhs
 = 
ei_®igÃd_¡ack_Ãw
(
SÿÏr
, 
´oduù
.
lhs
().
size
());

680 
	gM­
<
	gM©rix
<
	gSÿÏr
,1,
	gLhs
::
SizeAtCompeTime
,
	gCŞMajÜ
> >(
	g_lhs
, 
	g´oduù
.
lhs
().
size
()èğ
´oduù
.lhs();

682 
ei_ÿche_ä›ndly_´oduù_rowmajÜ_times_veùÜ
(&
´oduù
.
rhs
().
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(0,0),…roduù.rhs().
¡ride
(),

683 
_lhs
, 
´oduù
.
lhs
().
size
(), 
»s
);

685 if(!
	gU£LhsDœeùly
è
ei_®igÃd_¡ack_d–‘e
(
SÿÏr
, 
_lhs
, 
´oduù
.
lhs
().
size
());

691 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsRows
, 
	gRhsOrd”
, 
	gRhsAcûss
>

692 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,
	gLhsRows
,
	gRowMajÜ
,
	gNoDœeùAcûss
,1,
	gRhsOrd”
,
	gRhsAcûss
>

697 
	g‹m¶©e
<
ty³Çme
 
	gProduùTy³
, 
	gLhsOrd”
, 
	gLhsAcûss
, 
	gRhsCŞs
>

698 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduùTy³
,1,
	gLhsOrd”
,
	gLhsAcûss
,
	gRhsCŞs
,
	gCŞMajÜ
,
	gNoDœeùAcûss
>

703 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

704 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,ty³Çm
	gRhs
>

705 
šlše
 
	gD”ived
&

706 
	gM©rixBa£
<
	gD”ived
>::
İ”©Ü
+=(cÚ¡ 
FÏgged
<
Produù
<
Lhs
,
	gRhs
,
	gCacheFr›ndlyProduù
>, 0, 
	gEv®BefÜeNe¡šgB™
 | 
	gEv®BefÜeAssignšgB™
>& 
	gÙh”
)

708 ià(
	gÙh”
.
_ex´essiÚ
().
_u£CacheFr›ndlyProduù
())

709 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduù
<
	gLhs
,
	gRhs
,
	gCacheFr›ndlyProduù
> >::
run
(
cÚ¡_ÿ¡_d”ived
(), 
Ùh”
.
_ex´essiÚ
());

712 
ty³Çme
 
	tei_ş—Áy³
<
	tLhs
>::
	tty³
 
	t_Lhs
;

713 
ty³Çme
 
	tei_ş—Áy³
<
	tRhs
>::
	tty³
 
	t_Rhs
;

715 
ty³Çme
 
	tei_Ã¡ed
<
	t_Lhs
,
	t_Rhs
::
	tCŞsAtCompeTime
>::
	tty³
 
	tLhsNe¡ed
;

716 
ty³Çme
 
	tei_Ã¡ed
<
	t_Rhs
,
	t_Lhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tRhsNe¡ed
;

718 
	gProduù
<
	gLhsNe¡ed
,
	gRhsNe¡ed
,
	gNÜm®Produù
> 
´od
(
Ùh”
.
_ex´essiÚ
().
lhs
(),Ùh”._ex´essiÚ().
rhs
());

720 
ÏzyAssign
(
d”ived
(è+ 
´od
);

722  
d”ived
();

725 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

726 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

727 
šlše
 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
ÏzyAssign
(cÚ¡ 
Produù
<
Lhs
,
Rhs
,
CacheFr›ndlyProduù
>& 
´oduù
)

729 ià(
	g´oduù
.
_u£CacheFr›ndlyProduù
())

731 
£tZ”o
();

732 
	gei_ÿche_ä›ndly_´oduù_£ËùÜ
<
	gProduù
<
	gLhs
,
	gRhs
,
	gCacheFr›ndlyProduù
> >::
run
(
cÚ¡_ÿ¡_d”ived
(), 
´oduù
);

736 
ty³Çme
 
	tei_ş—Áy³
<
	tLhs
>::
	tty³
 
	t_Lhs
;

737 
ty³Çme
 
	tei_ş—Áy³
<
	tRhs
>::
	tty³
 
	t_Rhs
;

739 
ty³Çme
 
	tei_Ã¡ed
<
	t_Lhs
,
	t_Rhs
::
	tCŞsAtCompeTime
>::
	tty³
 
	tLhsNe¡ed
;

740 
ty³Çme
 
	tei_Ã¡ed
<
	t_Rhs
,
	t_Lhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tRhsNe¡ed
;

742 
	gProduù
<
	tLhsNe¡ed
,
	tRhsNe¡ed
,
	tNÜm®Produù
> NormalProduct;

743 
NÜm®Produù
 
nÜm®_´od
(
´oduù
.
lhs
(),´oduù.
rhs
());

745 
	gÏzyAssign
<
	gNÜm®Produù
>(
	gnÜm®_´od
);

747  
d”ived
();

750 
	g‹m¶©e
<
ty³Çme
 
	gT
,
	gStÜageOrd”
> 
	sei_´oduù_cİy_rhs


752 
ty³Çme
 
	tei_m‘a_if
<

753 (
	tei_Œa™s
<
	tT
>::
	tFÏgs
 & 
	tRowMajÜB™
)

754 || (!(
	tei_Œa™s
<
	tT
>::
	tFÏgs
 & 
	tDœeùAcûssB™
)),

755 
	tty³Çme
 
	tei_¶aš_m©rix_ty³_cŞumn_majÜ
<
	tT
>::
	tty³
,

756 cÚ¡ 
	tT
&

757 >::
	t»t
 
	tty³
;

760 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_´oduù_cİy_rhs
<T,
	gRowMajÜB™
>

762 
ty³Çme
 
	tei_m‘a_if
<

763 (!(
	tei_Œa™s
<
	tT
>::
	tFÏgs
 & 
	tDœeùAcûssB™
)),

764 
	tty³Çme
 
	tei_¶aš_m©rix_ty³
<
	tT
>::
	tty³
,

765 cÚ¡ 
	tT
&

766 >::
	t»t
 
	tty³
;

769 
	g‹m¶©e
<
ty³Çme
 
	gT
,
	gStÜageOrd”
> 
	sei_´oduù_cİy_lhs


771 
ty³Çme
 
	tei_m‘a_if
<

772 (!((
	tei_Œa™s
<
	tT
>::
	tFÏgs
è& 
	tDœeùAcûssB™
)),

773 
	tty³Çme
 
	tei_¶aš_m©rix_ty³_row_majÜ
<
	tT
>::
	tty³
,

774 cÚ¡ 
	tT
&

775 >::
	t»t
 
	tty³
;

778 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_´oduù_cİy_lhs
<T,
	gRowMajÜB™
>

780 
ty³Çme
 
	tei_m‘a_if
<

781 ((
	tei_Œa™s
<
	tT
>::
	tFÏgs
 & 
	tRowMajÜB™
)==0)

782 || (!((
	tei_Œa™s
<
	tT
>::
	tFÏgs
è& 
	tDœeùAcûssB™
)),

783 
	tty³Çme
 
	tei_¶aš_m©rix_ty³_row_majÜ
<
	tT
>::
	tty³
,

784 cÚ¡ 
	tT
&

785 >::
	t»t
 
	tty³
;

788 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gProduùMode
>

789 
	g‹m¶©e
<
ty³Çme
 
	gDe¡D”ived
>

790 
šlše
 
	gProduù
<
	gLhs
,
	gRhs
,
	gProduùMode
>::
	$_ÿcheFr›ndlyEv®AndAdd
(
De¡D”ived
& 
»s
) const

792 
ty³Çme
 
	tei_´oduù_cİy_lhs
<
	t_LhsNe¡ed
,
	tDe¡D”ived
::
	tFÏgs
&
	tRowMajÜB™
>::
	tty³
 
	tLhsCİy
;

793 
ty³Çme
 
	tei_uÄef
<
	tLhsCİy
>::
	tty³
 
	t_LhsCİy
;

794 
ty³Çme
 
	tei_´oduù_cİy_rhs
<
	t_RhsNe¡ed
,
	tDe¡D”ived
::
	tFÏgs
&
	tRowMajÜB™
>::
	tty³
 
	tRhsCİy
;

795 
ty³Çme
 
	tei_uÄef
<
	tRhsCİy
>::
	tty³
 
	t_RhsCİy
;

796 
LhsCİy
 
	`lhs
(
m_lhs
);

797 
RhsCİy
 
	`rhs
(
m_rhs
);

798 
ei_ÿche_ä›ndly_´oduù
<
SÿÏr
>(

799 
	`rows
(), 
	`cŞs
(), 
lhs
.cols(),

800 
_LhsCİy
::
FÏgs
&
RowMajÜB™
, (cÚ¡ 
SÿÏr
*)&(
lhs
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(0,0)),†hs.
	`¡ride
(),

801 
_RhsCİy
::
FÏgs
&
RowMajÜB™
, (cÚ¡ 
SÿÏr
*)&(
rhs
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(0,0)),„hs.
	`¡ride
(),

802 
De¡D”ived
::
FÏgs
&
RowMajÜB™
, (
SÿÏr
*)&(
»s
.
	`cÛffRef
(0,0)),„es.
	`¡ride
()

805 
	}
}

	@robot/Eigen/src/Core/Redux.h

26 #iâdeà
EIGEN_REDUX_H


27 
	#EIGEN_REDUX_H


	)

29 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gD”ived
, 
	gS¹
, 
	gL’gth
>

30 
	sei_»dux_im¶


33 
	mH®fL’gth
 = 
L’gth
/2

36 
ty³Çme
 
	tei_»suÉ_of
<
	tBš¬yOp
(
	tty³Çme
 
	tD”ived
::
	tSÿÏr
)>::
	tty³
 Scalar;

38 
SÿÏr
 
run
(cÚ¡ 
D”ived
 &
m©
, cÚ¡ 
Bš¬yOp
& 
func
)

40  
func
(

41 
ei_»dux_im¶
<
Bš¬yOp
, 
D”ived
, 
S¹
, 
H®fL’gth
>::
run
(
m©
, 
func
),

42 
ei_»dux_im¶
<
Bš¬yOp
, 
D”ived
, 
S¹
+
H®fL’gth
, 
L’gth
 - H®fL’gth>::
run
(
m©
, 
func
));

46 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gD”ived
, 
	gS¹
>

47 
	gei_»dux_im¶
<
	gBš¬yOp
, 
	gD”ived
, 
	gS¹
, 1>

50 
	gcŞ
 = 
S¹
 / 
D”ived
::
RowsAtCompeTime
,

51 
	grow
 = 
S¹
 % 
D”ived
::
RowsAtCompeTime


54 
ty³Çme
 
	tei_»suÉ_of
<
	tBš¬yOp
(
	tty³Çme
 
	tD”ived
::
	tSÿÏr
)>::
	tty³
 Scalar;

56 
SÿÏr
 
run
(cÚ¡ 
D”ived
 &
m©
, cÚ¡ 
Bš¬yOp
 &)

58  
	gm©
.
cÛff
(
row
, 
cŞ
);

62 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gD”ived
, 
	gS¹
>

63 
	gei_»dux_im¶
<
	gBš¬yOp
, 
	gD”ived
, 
	gS¹
, 
	gDyÇmic
>

65 
ty³Çme
 
	tei_»suÉ_of
<
	tBš¬yOp
(
	tty³Çme
 
	tD”ived
::
	tSÿÏr
)>::
	tty³
 Scalar;

66 
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m©
, cÚ¡ 
Bš¬yOp
& 
func
)

68 
ei_as£¹
(
m©
.
rows
()>0 && m©.
cŞs
()>0 && "you‡re using‡‚on initialized matrix");

69 
SÿÏr
 
	g»s
;

70 
	g»s
 = 
m©
.
cÛff
(0,0);

71 
	gi
 = 1; i < 
	gm©
.
rows
(); ++i)

72 
	g»s
 = 
func
(
»s
, 
m©
.
cÛff
(
i
, 0));

73 
	gj
 = 1; j < 
	gm©
.
cŞs
(); ++j)

74 
	gi
 = 0; i < 
	gm©
.
rows
(); ++i)

75 
	g»s
 = 
func
(
»s
, 
m©
.
cÛff
(
i
, 
j
));

76  
	g»s
;

87 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

88 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
>

89 
ty³Çme
 
	gei_»suÉ_of
<
Bš¬yOp
Ñy³Çm
ei_Œa™s
<
D”ived
>::
SÿÏr
)>::
ty³


90 
M©rixBa£
<
D”ived
>::
	$»dux
(cÚ¡ 
Bš¬yOp
& 
func
) const

92 cÚ¡ 
boŞ
 
uÄŞl
 = 
SizeAtCompeTime
 * 
CÛffR—dCo¡


93 + (
SizeAtCompeTime
-1è* 
ei_funùÜ_Œa™s
<
Bš¬yOp
>::
Co¡


94 <ğ
EIGEN_UNROLLING_LIMIT
;

95  
ei_»dux_im¶
<
Bš¬yOp
, 
D”ived
, 0, 
uÄŞl
 ? (
SizeAtCompeTime
è: 
DyÇmic
>

96 ::
	`run
(
	`d”ived
(), 
func
);

97 
	}
}

101 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

102 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


103 
M©rixBa£
<
D”ived
>::
	$mšCÛff
() const

105  
this
->
	`»dux
(
Eig’
::
ei_sÿÏr_mš_İ
<
SÿÏr
>());

106 
	}
}

110 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

111 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


112 
M©rixBa£
<
D”ived
>::
	$maxCÛff
() const

114  
this
->
	`»dux
(
Eig’
::
ei_sÿÏr_max_İ
<
SÿÏr
>());

115 
	}
}

	@robot/Eigen/src/Core/SolveTriangular.h

25 #iâdeà
EIGEN_SOLVETRIANGULAR_H


26 
	#EIGEN_SOLVETRIANGULAR_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gX´Ty³
> 
	sei_is_·¹
 {ƒnum {
	mv®ue
=
çl£
}; };

29 
	g‹m¶©e
<
ty³Çme
 
	gX´Ty³
, 
	gMode
> 
	gei_is_·¹
<
	gP¬t
<X´Ty³,Mode> > {ƒnum {
	gv®ue
=
Œue
}; };

31 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,

32 
	gTrŸnguÏrP¬t
 = ((
Lhs
::
FÏgs
è& 
Low”TrŸnguÏrB™
)

33 ? 
Low”TrŸnguÏr


34 : ((
Lhs
::
FÏgs
è& 
Uµ”TrŸnguÏrB™
)

35 ? 
Uµ”TrŸnguÏr


37 
	gStÜageOrd”
 = 
ei_is_·¹
<
Lhs
>::
v®ue
 ? -1

38 : (
Lhs
::
FÏgs
è& (
RowMajÜB™
|
S·r£B™
)

40 
ei_sŞve_ŒŸnguÏr_£ËùÜ
;

43 
	g‹m¶©e
<
ty³Çme
 
	gLhs
, 
	gLhsMode
,y³Çm
	gRhs
, 
	gUpLo
, 
	gStÜageOrd”
>

44 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gP¬t
<
	gLhs
,
	gLhsMode
>,
	gRhs
,
	gUpLo
,
	gStÜageOrd”
>

46 
run
(cÚ¡ 
P¬t
<
Lhs
,
LhsMode
>& 
lhs
, 
Rhs
& 
Ùh”
)

48 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gFÏgged
<
	gLhs
,
	gLhsMode
,0>,
	gRhs
>::
run
(
lhs
.
_ex´essiÚ
(), 
Ùh”
);

53 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gUpLo
>

54 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gLhs
,
	gRhs
,
	gUpLo
,
	gRowMajÜ
|
	gIsD’£
>

56 
ty³Çme
 
	tRhs
::
	tSÿÏr
 Scalar;

57 
run
(cÚ¡ 
Lhs
& 
lhs
, 
Rhs
& 
Ùh”
)

59 cÚ¡ 
boŞ
 
	gIsLow”TrŸnguÏr
 = (
UpLo
==
Low”TrŸnguÏr
);

60 cÚ¡ 
	gsize
 = 
lhs
.
cŞs
();

65 
	gblockyS¹
 = (
¡d
::
max
(
size
-5,0)/4)*4;

66 ià(
	gIsLow”TrŸnguÏr
)

67 
	gblockyS¹
 = 
size
 - 
blockyS¹
;

69 
	gblockyS¹
 -= 1;

70 
	gc
=0 ; c<
	gÙh”
.
cŞs
() ; ++c)

73 if(!(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
))

75 ià(
IsLow”TrŸnguÏr
)

76 
Ùh”
.
cÛffRef
(0,
c
èğÙh”.
cÛff
(0,c)/
	glhs
.coeff(0, 0);

78 
	gÙh”
.
cÛffRef
(
size
-1,
c
èğ
Ùh”
.
cÛff
(size-1, c)/
	glhs
.coeff(size-1, size-1);

80 
	gi
=(
IsLow”TrŸnguÏr
 ? 1 : 
size
-2); 
	gIsLow”TrŸnguÏr
 ? i<
	gblockyS¹
 : 
i
>
blockyS¹
; i += (IsLowerTriangular ? 1 : -1) )

82 
SÿÏr
 
tmp
 = 
Ùh”
.
cÛff
(
i
,
c
)

83 - (
	gIsLow”TrŸnguÏr
 ? ((
	glhs
.
row
(
i
).
¡¬t
(i)è* 
	gÙh”
.
cŞ
(
c
).¡¬t(i)).
cÛff
(0,0)

84 : ((
lhs
.
row
(
i
).
’d
(
size
-i-1)è* 
Ùh”
.
cŞ
(
c
).’d(size-i-1)).
cÛff
(0,0));

85 ià(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
)

86 
Ùh”
.
cÛffRef
(
i
,
c
èğ
tmp
;

88 
	gÙh”
.
cÛffRef
(
i
,
c
èğ
tmp
/
lhs
.
cÛff
(i,i);

92 
	gi
=
blockyS¹
; 
	gIsLow”TrŸnguÏr
 ? i<
	gsize
 : 
i
>0; )

94 
	g¡¬tBlock
 = 
i
;

95 
	g’dBlock
 = 
¡¬tBlock
 + (
IsLow”TrŸnguÏr
 ? 4 : -4);

99 
	gM©rix
<
	gSÿÏr
,
	gDyÇmic
,1> 
btmp
(4);

100 ià(
	gIsLow”TrŸnguÏr
)

101 
	gbtmp
 = 
lhs
.
block
(
¡¬tBlock
,0,4,
i
è* 
	gÙh”
.
cŞ
(
c
).
¡¬t
(i);

103 
	gbtmp
 = 
lhs
.
block
(
i
-3,i+1,4,
size
-1-iè* 
	gÙh”
.
cŞ
(
c
).
’d
(size-1-i);

109 
SÿÏr
 
	gtmp
 = 
Ùh”
.
cÛff
(
¡¬tBlock
,
c
)-
	gbtmp
.cÛff(
IsLow”TrŸnguÏr
?0:3);

110 ià(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
)

111 
Ùh”
.
cÛffRef
(
i
,
c
èğ
tmp
;

113 
	gÙh”
.
cÛffRef
(
i
,
c
èğ
tmp
/
lhs
.
cÛff
(i,i);

116 
	gi
 +ğ
IsLow”TrŸnguÏr
 ? 1 : -1;

117 ;
	gIsLow”TrŸnguÏr
 ? 
	gi
<
	g’dBlock
 : 
i
>
’dBlock
; i +ğ
IsLow”TrŸnguÏr
 ? 1 : -1)

119 
»maššgSize
 = 
IsLow”TrŸnguÏr
 ? 
i
-
¡¬tBlock
 : startBlock-i;

120 
SÿÏr
 
	gtmp
 = 
Ùh”
.
cÛff
(
i
,
c
)

121 - 
	gbtmp
.
cÛff
(
IsLow”TrŸnguÏr
 ? 
»maššgSize
 : 3-remainingSize)

122 - ( 
lhs
.
row
(
i
).
£gm’t
(
IsLow”TrŸnguÏr
 ? 
¡¬tBlock
 : i+1, 
»maššgSize
)

123 * 
	gÙh”
.
cŞ
(
c
).
£gm’t
(
IsLow”TrŸnguÏr
 ? 
¡¬tBlock
 : 
i
+1, 
»maššgSize
)).
cÛff
(0,0);

125 ià(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
)

126 
Ùh”
.
cÛffRef
(
i
,
c
èğ
tmp
;

128 
	gÙh”
.
cÛffRef
(
i
,
c
èğ
tmp
/
lhs
.
cÛff
(i,i);

140 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gUpLo
>

141 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gLhs
,
	gRhs
,
	gUpLo
,
	gCŞMajÜ
|
	gIsD’£
>

143 
ty³Çme
 
	tRhs
::
	tSÿÏr
 Scalar;

144 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘
;

145 ’um { 
	gPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 };

147 
run
(cÚ¡ 
Lhs
& 
lhs
, 
Rhs
& 
Ùh”
)

149 cÚ¡ 
boŞ
 
	gIsLow”TrŸnguÏr
 = (
UpLo
==
Low”TrŸnguÏr
);

150 cÚ¡ 
	gsize
 = 
lhs
.
cŞs
();

151 
	gc
=0 ; c<
	gÙh”
.
cŞs
() ; ++c)

157 
	gblockyEnd
 = (
¡d
::
max
(
size
-5,0)/4)*4;

158 ià(!
	gIsLow”TrŸnguÏr
)

159 
	gblockyEnd
 = 
size
-1 - 
blockyEnd
;

160 
	gi
=
IsLow”TrŸnguÏr
 ? 0 : 
size
-1; 
	gIsLow”TrŸnguÏr
 ? i<
	gblockyEnd
 : 
i
>
blockyEnd
;)

165 
	g¡¬tBlock
 = 
i
;

166 
	g’dBlock
 = 
¡¬tBlock
 + (
IsLow”TrŸnguÏr
 ? 4 : -4);

167 
	gM©rix
<
	gSÿÏr
,4,1> 
	gbtmp
;

168 ;
	gIsLow”TrŸnguÏr
 ? 
	gi
<
	g’dBlock
 : 
i
>
’dBlock
;

169 
	gi
 +ğ
IsLow”TrŸnguÏr
 ? 1 : -1)

171 if(!(
Lhs
::
FÏgs
 & 
Un™DŸgB™
))

172 
Ùh”
.
cÛffRef
(
i
,
c
è/ğ
lhs
.
cÛff
(i,i);

173 
	g»maššgSize
 = 
IsLow”TrŸnguÏr
 ? 
’dBlock
-
i
-1 : i-endBlock-1;

174 ià(
	g»maššgSize
>0)

175 
	gÙh”
.
cŞ
(
c
).
£gm’t
((
IsLow”TrŸnguÏr
 ? 
i
 : 
’dBlock
è+ 1, 
»maššgSize
) -=

176 
Ùh”
.
cÛffRef
(
i
,
c
)

177 * 
	gBlock
<
	gLhs
,
	gDyÇmic
,1>(
	glhs
, (
	gIsLow”TrŸnguÏr
 ? 
	gi
 : 
’dBlock
è+ 1, i, 
	g»maššgSize
, 1);

178 
	gbtmp
.
cÛffRef
(
IsLow”TrŸnguÏr
 ? 
i
-
¡¬tBlock
 : 
»maššgSize
èğ-
Ùh”
.cÛffRef(i,
c
);

189 
ei_ÿche_ä›ndly_´oduù_cŞmajÜ_times_veùÜ
(

190 
IsLow”TrŸnguÏr
 ? 
size
-
’dBlock
 :ƒndBlock+1,

191 &(
lhs
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
IsLow”TrŸnguÏr
 ? 
’dBlock
 : 0, IsLow”TrŸnguÏ¸? 
¡¬tBlock
 :ƒndBlock+1)),

192 
lhs
.
¡ride
(),

193 
btmp
, &(
Ùh”
.
cÛffRef
(
IsLow”TrŸnguÏr
 ? 
’dBlock
 : 0, 
c
)));

203 
	gi
;

204 
	gi
=
blockyEnd
; 
	gIsLow”TrŸnguÏr
 ? i<
	gsize
-1 : 
i
>0; i +ğ(
IsLow”TrŸnguÏr
 ? 1 : -1) )

206 if(!(
Lhs
::
FÏgs
 & 
Un™DŸgB™
))

207 
Ùh”
.
cÛffRef
(
i
,
c
è/ğ
lhs
.
cÛff
(i,i);

212 if(
	gIsLow”TrŸnguÏr
)

213 
	gÙh”
.
cŞ
(
c
).
’d
(
size
-
i
-1è-ğ
Ùh”
.
cÛffRef
(i,cè* 
	gBlock
<
	gLhs
,
	gDyÇmic
,1>(
	glhs
, 
	gi
+1,i, 
	gsize
-i-1,1);

215 
	gÙh”
.
cŞ
(
c
).
¡¬t
(
i
è-ğ
Ùh”
.
cÛffRef
(i,cè* 
	gBlock
<
	gLhs
,
	gDyÇmic
,1>(
	glhs
, 0,
	gi
, i, 1);

217 if(!(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
))

218 
Ùh”
.
cÛffRef
(
i
,
c
è/ğ
lhs
.
cÛff
(i,i);

232 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

233 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

234 
	gM©rixBa£
<
	gD”ived
>::
sŞveTrŸnguÏrInPÏû
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
_Ùh”
) const

236 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
 = 
_Ùh”
.
cÚ¡_ÿ¡_d”ived
();

237 
ei_as£¹
(
d”ived
().
cŞs
(è=ğd”ived().
rows
());

238 
ei_as£¹
(
d”ived
().
cŞs
(è=ğ
Ùh”
.
rows
());

239 
ei_as£¹
(!(
FÏgs
 & 
Z”oDŸgB™
));

240 
ei_as£¹
(
FÏgs
 & (
Uµ”TrŸnguÏrB™
|
Low”TrŸnguÏrB™
));

242 ’um { 
	gcİy
 = 
ei_Œa™s
<
Oth”D”ived
>::
FÏgs
 & 
RowMajÜB™
 };

244 
ty³Çme
 
	tei_m‘a_if
<
	tcİy
,

245 
	tty³Çme
 
	tei_¶aš_m©rix_ty³_cŞumn_majÜ
<
	tOth”D”ived
>::
	tty³
, Oth”D”ived&>::
	t»t
 
	tOth”Cİy
;

246 
Oth”Cİy
 
Ùh”Cİy
(
Ùh”
.
d”ived
());

248 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gD”ived
, 
ty³Çme
 
	gei_uÄef
<
	gOth”Cİy
>::
ty³
>::
run
(
d”ived
(), 
Ùh”Cİy
);

250 ià(
	gcİy
)

251 
	gÙh”
 = 
Ùh”Cİy
;

287 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

288 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

289 
ty³Çme
 
	gei_¶aš_m©rix_ty³_cŞumn_majÜ
<
	gOth”D”ived
>::
ty³


290 
M©rixBa£
<
D”ived
>::
sŞveTrŸnguÏr
(cÚ¡ M©rixBa£<
Oth”D”ived
>& 
Ùh”
) const

292 
ty³Çme
 
ei_¶aš_m©rix_ty³_cŞumn_majÜ
<
Oth”D”ived
>::
ty³
 
»s
(
Ùh”
);

293 
sŞveTrŸnguÏrInPÏû
(
»s
);

294  
	g»s
;

	@robot/Eigen/src/Core/Sum.h

26 #iâdeà
EIGEN_SUM_H


27 
	#EIGEN_SUM_H


	)

33 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

34 
	sei_sum_Œa™s


36 
	m´iv©e
:

38 
Pack‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived
::
SÿÏr
>::
size


41 
	mpublic
:

43 
VeùÜiz©iÚ
 = ((
D”ived
::
FÏgs
)&
Aùu®Pack‘AcûssB™
)

44 && ((
D”ived
::
FÏgs
)&
Lš—rAcûssB™
)

45 ? 
Lš—rVeùÜiz©iÚ


46 : 
NoVeùÜiz©iÚ


49 
	m´iv©e
:

51 
Co¡
 = 
D”ived
::
SizeAtCompeTime
 * D”ived::
CÛffR—dCo¡


52 + (
D”ived
::
SizeAtCompeTime
-1è* 
NumT¿™s
<
ty³Çme
 D”ived::
SÿÏr
>::
AddCo¡
,

53 
	mUÄŞlšgLim™
 = 
EIGEN_UNROLLING_LIMIT
 * ((
VeùÜiz©iÚ
è=ğ(
NoVeùÜiz©iÚ
è? 1 : (
Pack‘Size
))

56 
	mpublic
:

58 
UÄŞlšg
 = 
Co¡
 <ğ
UÄŞlšgLim™


59 ? 
Com¶‘eUÄŞlšg


60 : 
NoUÄŞlšg


70 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gS¹
, 
	gL’gth
>

71 
	sei_sum_novec_uÄŞËr


74 
	mH®fL’gth
 = 
L’gth
/2

77 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

79 
šlše
 
SÿÏr
 
run
(cÚ¡ 
D”ived
 &
m©
)

81  
	mei_sum_novec_uÄŞËr
<
	mD”ived
, 
	mS¹
, 
	mH®fL’gth
>::
run
(
m©
)

82 + 
ei_sum_novec_uÄŞËr
<
D”ived
, 
	mS¹
+
	mH®fL’gth
, 
	mL’gth
-H®fL’gth>::
run
(
m©
);

86 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gS¹
>

87 
	gei_sum_novec_uÄŞËr
<
	gD”ived
, 
	gS¹
, 1>

90 
	gcŞ
 = 
S¹
 / 
D”ived
::
RowsAtCompeTime
,

91 
	grow
 = 
S¹
 % 
D”ived
::
RowsAtCompeTime


94 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

96 
šlše
 
SÿÏr
 
run
(cÚ¡ 
D”ived
 &
m©
)

98  
	gm©
.
cÛff
(
row
, 
cŞ
);

104 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gS¹
, 
	gL’gth
>

105 
	sei_sum_vec_uÄŞËr


108 
	mPack‘Size
 = 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived
::
SÿÏr
>::
size
,

109 
	mH®fL’gth
 = 
L’gth
/2

112 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

113 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

115 
šlše
 
Pack‘SÿÏr
 
run
(cÚ¡ 
D”ived
 &
m©
)

117  
ei_·dd
(

118 
ei_sum_vec_uÄŞËr
<
D”ived
, 
S¹
, 
H®fL’gth
>::
run
(
m©
),

119 
ei_sum_vec_uÄŞËr
<
D”ived
, 
S¹
+
H®fL’gth
, 
L’gth
-H®fL’gth>::
run
(
m©
) );

123 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gS¹
>

124 
	gei_sum_vec_uÄŞËr
<
	gD”ived
, 
	gS¹
, 1>

127 
	gšdex
 = 
S¹
 * 
ei_·ck‘_Œa™s
<
ty³Çme
 
D”ived
::
SÿÏr
>::
size
,

128 
	grow
 = (
D”ived
::
FÏgs
)&
RowMajÜB™


129 ? 
šdex
 / (
D”ived
::
CŞsAtCompeTime
)

130 : 
šdex
 % 
D”ived
::
RowsAtCompeTime
,

131 
	gcŞ
 = (
D”ived
::
FÏgs
)&
RowMajÜB™


132 ? 
šdex
 % (
D”ived
::
CŞsAtCompeTime
)

133 : 
šdex
 / 
D”ived
::
RowsAtCompeTime
,

134 
	g®ignm’t
 = (
D”ived
::
FÏgs
 & 
AligÃdB™
è? 
AligÃd
 : 
UÇligÃd


137 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

138 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

140 
šlše
 
Pack‘SÿÏr
 
run
(cÚ¡ 
D”ived
 &
m©
)

142  
	gm©
.
‹m¶©e
 
	g·ck‘
<
	g®ignm’t
>(
	grow
, 
	gcŞ
);

150 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,

151 
	gVeùÜiz©iÚ
 = 
ei_sum_Œa™s
<
D”ived
>::
VeùÜiz©iÚ
,

152 
	gUÄŞlšg
 = 
ei_sum_Œa™s
<
D”ived
>::
UÄŞlšg


154 
ei_sum_im¶
;

156 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

157 
	gei_sum_im¶
<
	gD”ived
, 
	gNoVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

159 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

160 
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m©
)

162 
ei_as£¹
(
m©
.
rows
()>0 && m©.
cŞs
()>0 && "you‡re using‡‚on initialized matrix");

163 
SÿÏr
 
	g»s
;

164 
	g»s
 = 
m©
.
cÛff
(0, 0);

165 
	gi
 = 1; i < 
	gm©
.
rows
(); ++i)

166 
	g»s
 +ğ
m©
.
cÛff
(
i
, 0);

167 
	gj
 = 1; j < 
	gm©
.
cŞs
(); ++j)

168 
	gi
 = 0; i < 
	gm©
.
rows
(); ++i)

169 
	g»s
 +ğ
m©
.
cÛff
(
i
, 
j
);

170  
	g»s
;

174 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

175 
	gei_sum_im¶
<
	gD”ived
, 
	gNoVeùÜiz©iÚ
, 
	gCom¶‘eUÄŞlšg
>

176 : 
public
 
ei_sum_novec_uÄŞËr
<
D”ived
, 0, 
	gD”ived
::
SizeAtCompeTime
>

179 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

180 
	gei_sum_im¶
<
	gD”ived
, 
	gLš—rVeùÜiz©iÚ
, 
	gNoUÄŞlšg
>

182 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

183 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

185 
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m©
)

187 cÚ¡ 
	gsize
 = 
m©
.
size
();

188 cÚ¡ 
	g·ck‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
;

189 cÚ¡ 
	g®igÃdS¹
 = (
D”ived
::
FÏgs
 & 
AligÃdB™
)

190 || !(
D”ived
::
FÏgs
 & 
DœeùAcûssB™
)

192 : 
ei_®ignm’tOff£t
(&
m©
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(0), 
size
);

194 
	g®ignm’t
 = (
D”ived
::
FÏgs
 & 
DœeùAcûssB™
è|| (D”ived::FÏg & 
AligÃdB™
)

195 ? 
AligÃd
 : 
UÇligÃd


197 cÚ¡ 
	g®igÃdSize
 = ((
size
-
®igÃdS¹
)/
·ck‘Size
)*packetSize;

198 cÚ¡ 
	g®igÃdEnd
 = 
®igÃdS¹
 + 
®igÃdSize
;

199 
SÿÏr
 
	g»s
;

201 if(
	g®igÃdSize
)

203 
Pack‘SÿÏr
 
	g·ck‘_»s
 = 
m©
.
‹m¶©e
 
·ck‘
<
®ignm’t
>(
®igÃdS¹
);

204 
	gšdex
 = 
®igÃdS¹
 + 
·ck‘Size
; index < 
	g®igÃdEnd
; index +=…acketSize)

205 
·ck‘_»s
 = 
ei_·dd
Õack‘_»s, 
m©
.
‹m¶©e
 
·ck‘
<
®ignm’t
>(
šdex
));

206 
	g»s
 = 
ei_´edux
(
·ck‘_»s
);

211 
	g»s
 = 
SÿÏr
(0);

214 
	gšdex
 = 0; index < 
	g®igÃdS¹
; ++index)

215 
	g»s
 +ğ
m©
.
cÛff
(
šdex
);

217 
	gšdex
 = 
®igÃdEnd
; index < 
	gsize
; ++index)

218 
	g»s
 +ğ
m©
.
cÛff
(
šdex
);

220  
	g»s
;

224 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

225 
	gei_sum_im¶
<
	gD”ived
, 
	gLš—rVeùÜiz©iÚ
, 
	gCom¶‘eUÄŞlšg
>

227 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

228 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘SÿÏr
;

230 
	gPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
,

231 
	gSize
 = 
D”ived
::
SizeAtCompeTime
,

232 
	gVeùÜiz©iÚSize
 = (
Size
 / 
Pack‘Size
) * PacketSize

234 
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m©
)

236 
SÿÏr
 
	g»s
 = 
ei_´edux
(
ei_sum_vec_uÄŞËr
<
D”ived
, 0, 
Size
 / 
Pack‘Size
>::
run
(
m©
));

237 ià(
	gVeùÜiz©iÚSize
 !ğ
Size
)

238 
»s
 +ğ
ei_sum_novec_uÄŞËr
<
D”ived
, 
	gVeùÜiz©iÚSize
, 
	gSize
-VeùÜiz©iÚSize>::
run
(
m©
);

239  
	g»s
;

251 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

252 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


253 
M©rixBa£
<
D”ived
>::
	$sum
() const

255  
ei_sum_im¶
<
D”ived
>::
	`run
(
	`d”ived
());

256 
	}
}

264 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

265 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


266 
M©rixBa£
<
D”ived
>::
	$Œaû
() const

268  
	`dŸgÚ®
().
	`sum
();

269 
	}
}

	@robot/Eigen/src/Core/Swap.h

25 #iâdeà
EIGEN_SWAP_H


26 
	#EIGEN_SWAP_H


	)

34 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

35 
	gei_Œa™s
<
	gSw­W¿µ”
<
	gEx´essiÚTy³
> >

37 
ty³Çme
 
	tEx´essiÚTy³
::
	tSÿÏr
 Scalar;

39 
	gRowsAtCompeTime
 = 
Ex´essiÚTy³
::
RowsAtCompeTime
,

40 
	gCŞsAtCompeTime
 = 
Ex´essiÚTy³
::
CŞsAtCompeTime
,

41 
	gMaxRowsAtCompeTime
 = 
Ex´essiÚTy³
::
MaxRowsAtCompeTime
,

42 
	gMaxCŞsAtCompeTime
 = 
Ex´essiÚTy³
::
MaxCŞsAtCompeTime
,

43 
	gFÏgs
 = 
Ex´essiÚTy³
::
FÏgs
,

44 
	gCÛffR—dCo¡
 = 
Ex´essiÚTy³
::
CÛffR—dCo¡


48 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> 
şass
 
	gSw­W¿µ”


49 : 
public
 
M©rixBa£
<
Sw­W¿µ”
<
Ex´essiÚTy³
> >

51 
public
:

53 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
Sw­W¿µ”
)

54 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘
;

56 
šlše
 
Sw­W¿µ”
(
Ex´essiÚTy³
& 
x´
è: 
m_ex´essiÚ
(xpr) {}

58 
šlše
 
rows
(ècÚ¡ {  
m_ex´essiÚ
.rows(); }

59 
šlše
 
cŞs
(ècÚ¡ {  
	gm_ex´essiÚ
.cols(); }

60 
šlše
 
¡ride
(ècÚ¡ {  
	gm_ex´essiÚ
.stride(); }

62 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

64  
	gm_ex´essiÚ
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
row
, 
cŞ
);

67 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

69  
	gm_ex´essiÚ
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
šdex
);

72 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

73 
cİyCÛff
(
row
, 
cŞ
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

75 
	gOth”D”ived
& 
	g_Ùh”
 = 
Ùh”
.
cÚ¡_ÿ¡_d”ived
();

76 
ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
rows
()

77 && 
cŞ
 >ğ0 && cŞ < 
cŞs
());

78 
SÿÏr
 
	gtmp
 = 
m_ex´essiÚ
.
cÛff
(
row
, 
cŞ
);

79 
	gm_ex´essiÚ
.
cÛffRef
(
row
, 
cŞ
èğ
_Ùh”
.
cÛff
(row, col);

80 
	g_Ùh”
.
cÛffRef
(
row
, 
cŞ
èğ
tmp
;

83 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

84 
cİyCÛff
(
šdex
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

86 
	gOth”D”ived
& 
	g_Ùh”
 = 
Ùh”
.
cÚ¡_ÿ¡_d”ived
();

87 
ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
m_ex´essiÚ
.
size
());

88 
SÿÏr
 
	gtmp
 = 
m_ex´essiÚ
.
cÛff
(
šdex
);

89 
	gm_ex´essiÚ
.
cÛffRef
(
šdex
èğ
_Ùh”
.
cÛff
(index);

90 
	g_Ùh”
.
cÛffRef
(
šdex
èğ
tmp
;

93 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
, 
	gStÜeMode
, 
	gLßdMode
>

94 
cİyPack‘
(
row
, 
cŞ
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

96 
	gOth”D”ived
& 
	g_Ùh”
 = 
Ùh”
.
cÚ¡_ÿ¡_d”ived
();

97 
ei_š‹º®_as£¹
(
row
 >ğ0 &&„ow < 
rows
()

98 && 
cŞ
 >ğ0 && cŞ < 
cŞs
());

99 
Pack‘
 
	gtmp
 = 
m_ex´essiÚ
.
‹m¶©e
 
·ck‘
<
StÜeMode
>(
row
, 
	gcŞ
);

100 
	gm_ex´essiÚ
.
‹m¶©e
 
	gwr™ePack‘
<
	gStÜeMode
>(
	grow
, 
	gcŞ
,

101 
	g_Ùh”
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	grow
, 
	gcŞ
)

103 
	g_Ùh”
.
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	grow
, 
	gcŞ
, 
	gtmp
);

106 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
, 
	gStÜeMode
, 
	gLßdMode
>

107 
cİyPack‘
(
šdex
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

109 
	gOth”D”ived
& 
	g_Ùh”
 = 
Ùh”
.
cÚ¡_ÿ¡_d”ived
();

110 
ei_š‹º®_as£¹
(
šdex
 >ğ0 && index < 
m_ex´essiÚ
.
size
());

111 
Pack‘
 
	gtmp
 = 
m_ex´essiÚ
.
‹m¶©e
 
·ck‘
<
StÜeMode
>(
šdex
);

112 
	gm_ex´essiÚ
.
‹m¶©e
 
	gwr™ePack‘
<
	gStÜeMode
>(
	gšdex
,

113 
	g_Ùh”
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	gšdex
)

115 
	g_Ùh”
.
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	gšdex
, 
	gtmp
);

118 
	g´Ùeùed
:

119 
Ex´essiÚTy³
& 
m_ex´essiÚ
;

121 
	g´iv©e
:

122 
Sw­W¿µ”
& 
İ”©Ü
=(const SwapWrapper&);

132 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

133 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

134 
	gM©rixBa£
<
	gD”ived
>::
sw­
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

136 (
Sw­W¿µ”
<
D”ived
>(
d”ived
())).
ÏzyAssign
(
Ùh”
);

	@robot/Eigen/src/Core/Transpose.h

25 #iâdeà
EIGEN_TRANSPOSE_H


26 
	#EIGEN_TRANSPOSE_H


	)

40 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

41 
	gei_Œa™s
<
	gT¿n¥o£
<
	gM©rixTy³
> >

43 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

44 
ty³Çme
 
	tei_Ã¡ed
<
	tM©rixTy³
>::
	tty³
 
	tM©rixTy³Ne¡ed
;

45 
ty³Çme
 
	tei_uÄef
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

47 
	gRowsAtCompeTime
 = 
M©rixTy³
::
CŞsAtCompeTime
,

48 
	gCŞsAtCompeTime
 = 
M©rixTy³
::
RowsAtCompeTime
,

49 
	gMaxRowsAtCompeTime
 = 
M©rixTy³
::
MaxCŞsAtCompeTime
,

50 
	gMaxCŞsAtCompeTime
 = 
M©rixTy³
::
MaxRowsAtCompeTime
,

51 
	gFÏgs
 = (((
_M©rixTy³Ne¡ed
::
FÏgs
è^ 
RowMajÜB™
)

52 & ~(
Low”TrŸnguÏrB™
 | 
Uµ”TrŸnguÏrB™
))

53 | ((
_M©rixTy³Ne¡ed
::
FÏgs
)&
Uµ”TrŸnguÏrB™
 ? 
Low”TrŸnguÏrB™
 : 0)

54 | ((
_M©rixTy³Ne¡ed
::
FÏgs
)&
Low”TrŸnguÏrB™
 ? 
Uµ”TrŸnguÏrB™
 : 0),

55 
	gCÛffR—dCo¡
 = 
_M©rixTy³Ne¡ed
::
CÛffR—dCo¡


59 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gT¿n¥o£


60 : 
public
 
M©rixBa£
<
T¿n¥o£
<
M©rixTy³
> >

62 
public
:

64 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
T¿n¥o£
)

66 
šlše
 
T¿n¥o£
(cÚ¡ 
M©rixTy³
& 
m©rix
è: 
m_m©rix
(matrix) {}

68 
EIGEN_INHERIT_ASSIGNMENT_OPERATORS
(
T¿n¥o£
)

70 
šlše
 
rows
(ècÚ¡ {  
m_m©rix
.
cŞs
(); }

71 
šlše
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.
rows
(); }

72 
šlše
 
¡ride
(ècÚ¡ {  
	gm_m©rix
.stride(); }

74 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

76  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
cŞ
, 
row
);

79 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

81  
	gm_m©rix
.
cÛff
(
cŞ
, 
row
);

84 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

86  
	gm_m©rix
.
cÛff
(
šdex
);

89 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

91  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
šdex
);

94 
	g‹m¶©e
<
	gLßdMode
>

95 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
row
, 
cŞ
) const

97  
	gm_m©rix
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	gcŞ
, 
	grow
);

100 
	g‹m¶©e
<
	gLßdMode
>

101 
šlše
 
wr™ePack‘
(
row
, 
cŞ
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

103 
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	gcŞ
, 
	grow
, 
	gx
);

106 
	g‹m¶©e
<
	gLßdMode
>

107 
šlše
 cÚ¡ 
Pack‘SÿÏr
 
·ck‘
(
šdex
) const

109  
	gm_m©rix
.
‹m¶©e
 
	g·ck‘
<
	gLßdMode
>(
	gšdex
);

112 
	g‹m¶©e
<
	gLßdMode
>

113 
šlše
 
wr™ePack‘
(
šdex
, cÚ¡ 
Pack‘SÿÏr
& 
x
)

115 
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
‹m¶©e
 
	gwr™ePack‘
<
	gLßdMode
>(
	gšdex
, 
	gx
);

118 
	g´Ùeùed
:

119 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

141 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

142 
šlše
 
	gT¿n¥o£
<
	gD”ived
>

143 
	gM©rixBa£
<
	gD”ived
>::
	$Œª¥o£
()

145  
	`d”ived
();

146 
	}
}

153 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

154 
šlše
 cÚ¡ 
	gT¿n¥o£
<
	gD”ived
>

155 
	gM©rixBa£
<
	gD”ived
>::
	$Œª¥o£
() const

157  
	`d”ived
();

158 
	}
}

175 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

176 
šlše
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
AdjoštR‘uºTy³


177 
M©rixBa£
<
D”ived
>::
	$adjošt
() const

179  
	`cÚjug©e
().
	`Ã¡ByV®ue
();

180 
	}
}

186 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
,

187 
boŞ
 
	gIsSqu¬e
 = (
M©rixTy³
::
RowsAtCompeTime
 =ğM©rixTy³::
CŞsAtCompeTime
è&& M©rixTy³::RowsAtCompeTime!=
DyÇmic
>

188 
ei_š¶aû_Œª¥o£_£ËùÜ
;

190 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

191 
	gei_š¶aû_Œª¥o£_£ËùÜ
<
	gM©rixTy³
,
	gŒue
> {

192 
run
(
M©rixTy³
& 
m
) {

193 
	gm
.
‹m¶©e
 
	g·¹
<
	gSŒiùlyUµ”TrŸnguÏr
>().
sw­
(
m
.
Œª¥o£
());

197 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

198 
	gei_š¶aû_Œª¥o£_£ËùÜ
<
	gM©rixTy³
,
	gçl£
> {

199 
run
(
M©rixTy³
& 
m
) {

200 ià(
	gm
.
rows
()==
m
.
cŞs
())

201 
m
.
‹m¶©e
 
·¹
<
SŒiùlyUµ”TrŸnguÏr
>().
sw­
(m.
Œª¥o£
());

203 
	gm
 = 
m
.
Œª¥o£
().
ev®
();

221 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

222 
šlše
 
	gM©rixBa£
<
	gD”ived
>::
	$Œª¥o£InPÏû
()

224 
ei_š¶aû_Œª¥o£_£ËùÜ
<
D”ived
>::
	`run
(
	`d”ived
());

225 
	}
}

	@robot/Eigen/src/Core/Visitor.h

25 #iâdeà
EIGEN_VISITOR_H


26 
	#EIGEN_VISITOR_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gVis™Ü
,y³Çm
	gD”ived
, 
	gUÄŞlCouÁ
>

29 
	sei_vis™Ü_im¶


32 
	mcŞ
 = (
UÄŞlCouÁ
-1è/ 
D”ived
::
RowsAtCompeTime
,

33 
	mrow
 = (
UÄŞlCouÁ
-1è% 
D”ived
::
RowsAtCompeTime


36 
šlše
 
run
(cÚ¡ 
D”ived
 &
m©
, 
Vis™Ü
& 
vis™Ü
)

38 
	mei_vis™Ü_im¶
<
	mVis™Ü
, 
	mD”ived
, 
	mUÄŞlCouÁ
-1>::
run
(
m©
, 
vis™Ü
);

39 
vis™Ü
(
m©
.
cÛff
(
row
, 
cŞ
),„ow, col);

43 
	g‹m¶©e
<
ty³Çme
 
	gVis™Ü
,y³Çm
	gD”ived
>

44 
	gei_vis™Ü_im¶
<
	gVis™Ü
, 
	gD”ived
, 1>

46 
šlše
 
run
(cÚ¡ 
D”ived
 &
m©
, 
Vis™Ü
& 
vis™Ü
)

48  
	gvis™Ü
.
š™
(
m©
.
cÛff
(0, 0), 0, 0);

52 
	g‹m¶©e
<
ty³Çme
 
	gVis™Ü
,y³Çm
	gD”ived
>

53 
	gei_vis™Ü_im¶
<
	gVis™Ü
, 
	gD”ived
, 
	gDyÇmic
>

55 
šlše
 
run
(cÚ¡ 
D”ived
& 
m©
, 
Vis™Ü
& 
vis™Ü
)

57 
	gvis™Ü
.
š™
(
m©
.
cÛff
(0,0), 0, 0);

58 
	gi
 = 1; i < 
	gm©
.
rows
(); ++i)

59 
vis™Ü
(
m©
.
cÛff
(
i
, 0), i, 0);

60 
	gj
 = 1; j < 
	gm©
.
cŞs
(); ++j)

61 
	gi
 = 0; i < 
	gm©
.
rows
(); ++i)

62 
vis™Ü
(
m©
.
cÛff
(
i
, 
j
), i, j);

84 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

85 
	g‹m¶©e
<
ty³Çme
 
	gVis™Ü
>

86 
	gM©rixBa£
<
	gD”ived
>::
	$vis™
(
Vis™Ü
& 
vis™Ü
) const

88 cÚ¡ 
boŞ
 
uÄŞl
 = 
SizeAtCompeTime
 * 
CÛffR—dCo¡


89 + (
SizeAtCompeTime
-1è* 
ei_funùÜ_Œa™s
<
Vis™Ü
>::
Co¡


90 <ğ
EIGEN_UNROLLING_LIMIT
;

91  
ei_vis™Ü_im¶
<
Vis™Ü
, 
D”ived
,

92 
uÄŞl
 ? (
SizeAtCompeTime
è: 
DyÇmic


93 >::
	`run
(
	`d”ived
(), 
vis™Ü
);

94 
	}
}

99 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

100 
	sei_cÛff_vis™Ü


102 
	mrow
, 
	mcŞ
;

103 
SÿÏr
 
	m»s
;

104 
šlše
 
š™
(cÚ¡ 
SÿÏr
& 
v®ue
, 
i
, 
j
)

106 
	m»s
 = 
v®ue
;

107 
	mrow
 = 
i
;

108 
	mcŞ
 = 
j
;

117 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

118 
	gei_mš_cÛff_vis™Ü
 : 
ei_cÛff_vis™Ü
<
SÿÏr
>

120 
İ”©Ü
(è(cÚ¡ 
SÿÏr
& 
v®ue
, 
	gi
, 
	gj
)

122 if(
	gv®ue
 < 
	gthis
->
	g»s
)

124 
	gthis
->
	g»s
 = 
v®ue
;

125 
	gthis
->
	grow
 = 
i
;

126 
	gthis
->
	gcŞ
 = 
j
;

131 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

132 
	gei_funùÜ_Œa™s
<
	gei_mš_cÛff_vis™Ü
<
	gSÿÏr
> > {

134 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡


143 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

144 
	gei_max_cÛff_vis™Ü
 : 
ei_cÛff_vis™Ü
<
SÿÏr
>

146 
İ”©Ü
(è(cÚ¡ 
SÿÏr
& 
v®ue
, 
	gi
, 
	gj
)

148 if(
	gv®ue
 > 
	gthis
->
	g»s
)

150 
	gthis
->
	g»s
 = 
v®ue
;

151 
	gthis
->
	grow
 = 
i
;

152 
	gthis
->
	gcŞ
 = 
j
;

157 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

158 
	gei_funùÜ_Œa™s
<
	gei_max_cÛff_vis™Ü
<
	gSÿÏr
> > {

160 
	gCo¡
 = 
NumT¿™s
<
SÿÏr
>::
AddCo¡


169 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

170 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


171 
M©rixBa£
<
D”ived
>::
	$mšCÛff
(* 
row
, * 
cŞ
) const

173 
ei_mš_cÛff_vis™Ü
<
SÿÏr
> 
mšVis™Ü
;

174 
this
->
	`vis™
(
mšVis™Ü
);

175 *
row
 = 
mšVis™Ü
.row;

176 ià(
cŞ
è*cŞ = 
mšVis™Ü
.col;

177  
mšVis™Ü
.
»s
;

178 
	}
}

185 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

186 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


187 
M©rixBa£
<
D”ived
>::
	$mšCÛff
(* 
šdex
) const

189 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

190 
ei_mš_cÛff_vis™Ü
<
SÿÏr
> 
mšVis™Ü
;

191 
this
->
	`vis™
(
mšVis™Ü
);

192 *
šdex
 = (
RowsAtCompeTime
==1è? 
mšVis™Ü
.
cŞ
 : mšVis™Ü.
row
;

193  
mšVis™Ü
.
»s
;

194 
	}
}

201 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

202 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


203 
M©rixBa£
<
D”ived
>::
	$maxCÛff
(* 
row
, * 
cŞ
) const

205 
ei_max_cÛff_vis™Ü
<
SÿÏr
> 
maxVis™Ü
;

206 
this
->
	`vis™
(
maxVis™Ü
);

207 *
row
 = 
maxVis™Ü
.row;

208 ià(
cŞ
è*cŞ = 
maxVis™Ü
.col;

209  
maxVis™Ü
.
»s
;

210 
	}
}

217 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

218 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


219 
M©rixBa£
<
D”ived
>::
	$maxCÛff
(* 
šdex
) const

221 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

222 
ei_max_cÛff_vis™Ü
<
SÿÏr
> 
maxVis™Ü
;

223 
this
->
	`vis™
(
maxVis™Ü
);

224 *
šdex
 = (
RowsAtCompeTime
==1è? 
maxVis™Ü
.
cŞ
 : maxVis™Ü.
row
;

225  
maxVis™Ü
.
»s
;

226 
	}
}

	@robot/Eigen/src/Core/arch/AltiVec/PacketMath.h

25 #iâdeà
EIGEN_PACKET_MATH_ALTIVEC_H


26 
	#EIGEN_PACKET_MATH_ALTIVEC_H


	)

28 #iâdeà
EIGEN_CACHEFRIENDLY_PRODUCT_THRESHOLD


29 
	#EIGEN_CACHEFRIENDLY_PRODUCT_THRESHOLD
 4

	)

32 
__veùÜ
 
	tv4f
;

33 
__veùÜ
 
	tv4i
;

34 
__veùÜ
 
	tv4ui
;

35 
__veùÜ
 
	t__boŞ
 
	tv4bi
;

40 
	#USE_CONST_v0i
 cÚ¡ 
v4i
 
v0i
 = 
	`vec_¥Ït_s32
(0)

	)

41 
	#USE_CONST_v1i
 cÚ¡ 
v4i
 
v1i
 = 
	`vec_¥Ït_s32
(1)

	)

42 
	#USE_CONST_v16i_
 cÚ¡ 
v4i
 
v16i_
 = 
	`vec_¥Ït_s32
(-16)

	)

43 
	#USE_CONST_v0f
 
USE_CONST_v0i
; cÚ¡ 
v4f
 
v0f
 = (v4fè
v0i


	)

44 
	#USE_CONST_v1f
 
USE_CONST_v1i
; cÚ¡ 
v4f
 
v1f
 = 
	`vec_ùf
(
v1i
, 0)

	)

45 
	#USE_CONST_v1i_
 cÚ¡ 
v4ui
 
v1i_
 = 
	`vec_¥Ït_u32
(-1)

	)

46 
	#USE_CONST_v0f_
 
USE_CONST_v1i_
; cÚ¡ 
v4f
 
v0f_
 = (v4fè
	`vec_¦
(
v1i_
, v1i_)

	)

48 
	g‹m¶©e
<> 
	gei_·ck‘_Œa™s
<> { 
v4f
 
	tty³
;ƒnum {
	gsize
=4}; };

49 
	g‹m¶©e
<> 
	gei_·ck‘_Œa™s
<> { 
v4i
 
	tty³
;ƒnum {
	gsize
=4}; };

51 
	g‹m¶©e
<> 
	gei_uÅack‘_Œa™s
<
	gv4f
> { 
	tty³
;ƒnum {
	gsize
=4}; };

52 
	g‹m¶©e
<> 
	gei_uÅack‘_Œa™s
<
	gv4i
> { 
	tty³
;ƒnum {
	gsize
=4}; };

54 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
 <<(
¡d
::o¡»am & 
s
, cÚ¡ 
	gv4f
 & 
	gv
)

57 
v4f
 
	gv
;

58 
	gn
[4];

59 } 
	gvt
;

60 
	gvt
.
	gv
 = 
v
;

61 
	gs
 << 
	gvt
.
	gn
[0] << ", " << vt.n[1] << ", " << vt.n[2] << ", " << vt.n[3];

62  
	gs
;

65 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
 <<(
¡d
::o¡»am & 
s
, cÚ¡ 
	gv4i
 & 
	gv
)

68 
v4i
 
	gv
;

69 
	gn
[4];

70 } 
	gvt
;

71 
	gvt
.
	gv
 = 
v
;

72 
	gs
 << 
	gvt
.
	gn
[0] << ", " << vt.n[1] << ", " << vt.n[2] << ", " << vt.n[3];

73  
	gs
;

76 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
 <<(
¡d
::o¡»am & 
s
, cÚ¡ 
	gv4ui
 & 
	gv
)

79 
v4ui
 
	gv
;

80 
	gn
[4];

81 } 
	gvt
;

82 
	gvt
.
	gv
 = 
v
;

83 
	gs
 << 
	gvt
.
	gn
[0] << ", " << vt.n[1] << ", " << vt.n[2] << ", " << vt.n[3];

84  
	gs
;

87 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
 <<(
¡d
::o¡»am & 
s
, cÚ¡ 
	gv4bi
 & 
	gv
)

90 
__veùÜ
 
__boŞ
 
	gv
;

91 
	gn
[4];

92 } 
	gvt
;

93 
	gvt
.
	gv
 = 
v
;

94 
	gs
 << 
	gvt
.
	gn
[0] << ", " << vt.n[1] << ", " << vt.n[2] << ", " << vt.n[3];

95  
	gs
;

98 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_·dd
(cÚ¡ 
v4f
& 
a
, cÚ¡ v4f& 
b
è{  
	`vec_add
×,b); 
	}
}

99 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_·dd
(cÚ¡ 
v4i
& 
a
, cÚ¡ v4i& 
b
è{  
	`vec_add
×,b); 
	}
}

101 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_psub
(cÚ¡ 
v4f
& 
a
, cÚ¡ v4f& 
b
è{  
	`vec_sub
×,b); 
	}
}

102 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_psub
(cÚ¡ 
v4i
& 
a
, cÚ¡ v4i& 
b
è{  
	`vec_sub
×,b); 
	}
}

104 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_pmul
(cÚ¡ 
v4f
& 
a
, cÚ¡ v4f& 
b
è{ 
USE_CONST_v0f
;  
	`vec_madd
×,b, 
v0f
); 
	}
}

105 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_pmul
(cÚ¡ 
v4i
& 
a
, cÚ¡ v4i& 
b
)

109 
v4i
 
a1
, 
b1
, 
bsw­
, 
low_´od
, 
high_´od
, 
´od
, 
´od_
, 
v1£l
;

110 
USE_CONST_v0i
;

111 
USE_CONST_v1i
;

112 
USE_CONST_v16i_
;

115 
a1
 = 
	`vec_abs
(
a
);

116 
b1
 = 
	`vec_abs
(
b
);

119 
v4bi
 
sgn
 = (v4biè
	`vec_cm¶t
(
	`vec_xÜ
(
a
, 
b
), 
v0i
);

122 
bsw­
 = (
v4i
è
	`vec_¾
((
v4ui
è
b1
, (v4uiè
v16i_
 );

123 
low_´od
 = 
	`vec_mulo
((
__veùÜ
 )
a1
, (__veùÜ )
b1
);

124 
high_´od
 = 
	`vec_msum
((
__veùÜ
 )
a1
, (__veùÜ )
bsw­
, 
v0i
);

125 
high_´od
 = (
v4i
è
	`vec_¦
((
v4ui
èhigh_´od, (v4uiè
v16i_
);

126 
´od
 = 
	`vec_add
Ğ
low_´od
, 
high_´od
 );

129 
´od_
 = 
	`vec_nÜ
(
´od
,…rod);

130 
´od_
 = 
	`vec_£l
(
v0i
,…rod_, 
sgn
);

133 
v1£l
 = 
	`vec_£l
(
v0i
, 
v1i
, 
sgn
);

134 
´od_
 = 
	`vec_add
Õrod_, 
v1£l
);

137 
´od
 = 
	`vec_£l
Õrod, 
´od_
, 
sgn
);

139  
´od
;

140 
	}
}

142 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_pdiv
(cÚ¡ 
v4f
& 
a
, cÚ¡ v4f& 
b
) {

143 
v4f
 
t
, 
y_0
, 
y_1
, 
»s
;

144 
USE_CONST_v0f
;

145 
USE_CONST_v1f
;

148 
y_0
 = 
	`vec_»
(
b
);

151 
t
 = 
	`vec_nmsub
(
y_0
, 
b
, 
v1f
);

152 
y_1
 = 
	`vec_madd
(
y_0
, 
t
, y_0);

154 
»s
 = 
	`vec_madd
(
a
, 
y_1
, 
v0f
);

155  
»s
;

156 
	}
}

158 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_pmadd
(cÚ¡ 
v4f
& 
a
, cÚ¡ v4f& 
b
, cÚ¡ v4f& 
c
è{  
	`vec_madd
×, b, c); 
	}
}

160 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_pmš
(cÚ¡ 
v4f
& 
a
, cÚ¡ v4f& 
b
è{  
	`vec_mš
×,b); 
	}
}

161 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_pmš
(cÚ¡ 
v4i
& 
a
, cÚ¡ v4i& 
b
è{  
	`vec_mš
×,b); 
	}
}

163 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_pmax
(cÚ¡ 
v4f
& 
a
, cÚ¡ v4f& 
b
è{  
	`vec_max
×,b); 
	}
}

164 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_pmax
(cÚ¡ 
v4i
& 
a
, cÚ¡ v4i& 
b
è{  
	`vec_max
×,b); 
	}
}

166 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_¶ßd
(cÚ¡ * 
äom
è{  
	`vec_ld
(0, from); 
	}
}

167 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_¶ßd
(cÚ¡ * 
äom
è{  
	`vec_ld
(0, from); 
	}
}

169 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_¶ßdu
(cÚ¡ * 
äom
)

172 
__veùÜ
 
MSQ
, 
LSQ
;

173 
__veùÜ
 
mask
;

174 
MSQ
 = 
	`vec_ld
(0, (*)
äom
);

175 
LSQ
 = 
	`vec_ld
(15, (*)
äom
);

176 
mask
 = 
	`vec_lv¦
(0, 
äom
);

177  (
v4f
è
	`vec_³rm
(
MSQ
, 
LSQ
, 
mask
);

178 
	}
}

180 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_¶ßdu
(cÚ¡ * 
äom
)

183 
__veùÜ
 
MSQ
, 
LSQ
;

184 
__veùÜ
 
mask
;

185 
MSQ
 = 
	`vec_ld
(0, (*)
äom
);

186 
LSQ
 = 
	`vec_ld
(15, (*)
äom
);

187 
mask
 = 
	`vec_lv¦
(0, 
äom
);

188  (
v4i
è
	`vec_³rm
(
MSQ
, 
LSQ
, 
mask
);

189 
	}
}

191 
	g‹m¶©e
<> 
šlše
 
v4f
 
	$ei_p£t1
(cÚ¡ & 
äom
)

194 
	`__©Œibu‹__
(
	`®igÃd
(16)è
af
[4];

195 
af
[0] = 
äom
;

196 
v4f
 
vc
 = 
	`vec_ld
(0, 
af
);

197 
vc
 = 
	`vec_¥Ït
(vc, 0);

198  
vc
;

199 
	}
}

201 
	g‹m¶©e
<> 
šlše
 
v4i
 
	$ei_p£t1
(cÚ¡ & 
äom
)

203 
	`__©Œibu‹__
(
	`®igÃd
(16)è
ai
[4];

204 
ai
[0] = 
äom
;

205 
v4i
 
vc
 = 
	`vec_ld
(0, 
ai
);

206 
vc
 = 
	`vec_¥Ït
(vc, 0);

207  
vc
;

208 
	}
}

210 
	g‹m¶©e
<> 
šlše
 
	$ei_p¡Üe
(* 
to
, cÚ¡ 
v4f
& 
äom
è{ 
	`vec_¡
(äom, 0,o); 
	}
}

211 
	g‹m¶©e
<> 
šlše
 
	$ei_p¡Üe
(* 
to
, cÚ¡ 
v4i
& 
äom
è{ 
	`vec_¡
(äom, 0,o); 
	}
}

213 
	g‹m¶©e
<> 
šlše
 
	$ei_p¡Üeu
(* 
to
, cÚ¡ 
v4f
& 
äom
)

217 
__veùÜ
 
MSQ
, 
LSQ
, 
edges
;

218 
__veùÜ
 
edgeAlign
, 
®ign
;

220 
MSQ
 = 
	`vec_ld
(0, (*)
to
);

221 
LSQ
 = 
	`vec_ld
(15, (*)
to
);

222 
edgeAlign
 = 
	`vec_lv¦
(0, 
to
);

223 
edges
=
	`vec_³rm
(
LSQ
,
MSQ
,
edgeAlign
);

224 
®ign
 = 
	`vec_lv¤
Ğ0, 
to
 );

225 
MSQ
 = 
	`vec_³rm
(
edges
,(
__veùÜ
 )
äom
,
®ign
);

226 
LSQ
 = 
	`vec_³rm
((
__veùÜ
 )
äom
,
edges
,
®ign
);

227 
	`vec_¡
Ğ
LSQ
, 15, (*)
to
 );

228 
	`vec_¡
Ğ
MSQ
, 0, (*)
to
 );

229 
	}
}

231 
	g‹m¶©e
<> 
šlše
 
	$ei_p¡Üeu
(* 
to
 , cÚ¡ 
v4i
& 
äom
 )

235 
__veùÜ
 
MSQ
, 
LSQ
, 
edges
;

236 
__veùÜ
 
edgeAlign
, 
®ign
;

238 
MSQ
 = 
	`vec_ld
(0, (*)
to
);

239 
LSQ
 = 
	`vec_ld
(15, (*)
to
);

240 
edgeAlign
 = 
	`vec_lv¦
(0, 
to
);

241 
edges
=
	`vec_³rm
(
LSQ
,
MSQ
,
edgeAlign
);

242 
®ign
 = 
	`vec_lv¤
Ğ0, 
to
 );

243 
MSQ
 = 
	`vec_³rm
(
edges
,(
__veùÜ
 )
äom
,
®ign
);

244 
LSQ
 = 
	`vec_³rm
((
__veùÜ
 )
äom
,
edges
,
®ign
);

245 
	`vec_¡
Ğ
LSQ
, 15, (*)
to
 );

246 
	`vec_¡
Ğ
MSQ
, 0, (*)
to
 );

247 
	}
}

249 
	g‹m¶©e
<> 
šlše
 
	$ei_pfœ¡
(cÚ¡ 
v4f
& 
a
)

251 
	`__©Œibu‹__
(
	`®igÃd
(16)è
af
[4];

252 
	`vec_¡
(
a
, 0, 
af
);

253  
af
[0];

254 
	}
}

256 
	g‹m¶©e
<> 
šlše
 
	$ei_pfœ¡
(cÚ¡ 
v4i
& 
a
)

258 
	`__©Œibu‹__
(
	`®igÃd
(16)è
ai
[4];

259 
	`vec_¡
(
a
, 0, 
ai
);

260  
ai
[0];

261 
	}
}

263 
šlše
 
v4f
 
	$ei_´eduxp
(cÚ¡ 
v4f
* 
vecs
)

265 
v4f
 
v
[4], 
sum
[4];

270 
v
[0] = 
	`vec_m”geh
(
vecs
[0], vecs[2]);

271 
v
[1] = 
	`vec_m”g–
(
vecs
[0], vecs[2]);

272 
v
[2] = 
	`vec_m”geh
(
vecs
[1], vecs[3]);

273 
v
[3] = 
	`vec_m”g–
(
vecs
[1], vecs[3]);

275 
sum
[0] = 
	`vec_m”geh
(
v
[0], v[2]);

276 
sum
[1] = 
	`vec_m”g–
(
v
[0], v[2]);

277 
sum
[2] = 
	`vec_m”geh
(
v
[1], v[3]);

278 
sum
[3] = 
	`vec_m”g–
(
v
[1], v[3]);

282 
sum
[0] = 
	`vec_add
(sum[0], sum[1]);

284 
sum
[1] = 
	`vec_add
(sum[2], sum[3]);

286 
sum
[0] = 
	`vec_add
(sum[0], sum[1]);

287  
sum
[0];

288 
	}
}

290 
šlše
 
	$ei_´edux
(cÚ¡ 
v4f
& 
a
)

292 
v4f
 
b
, 
sum
;

293 
b
 = (
v4f
)
	`vec_¦d
(
a
,‡, 8);

294 
sum
 = 
	`vec_add
(
a
, 
b
);

295 
b
 = (
v4f
)
	`vec_¦d
(
sum
, sum, 4);

296 
sum
 = 
	`vec_add
(sum, 
b
);

297  
	`ei_pfœ¡
(
sum
);

298 
	}
}

300 
šlše
 
v4i
 
	$ei_´eduxp
(cÚ¡ 
v4i
* 
vecs
)

302 
v4i
 
v
[4], 
sum
[4];

307 
v
[0] = 
	`vec_m”geh
(
vecs
[0], vecs[2]);

308 
v
[1] = 
	`vec_m”g–
(
vecs
[0], vecs[2]);

309 
v
[2] = 
	`vec_m”geh
(
vecs
[1], vecs[3]);

310 
v
[3] = 
	`vec_m”g–
(
vecs
[1], vecs[3]);

312 
sum
[0] = 
	`vec_m”geh
(
v
[0], v[2]);

313 
sum
[1] = 
	`vec_m”g–
(
v
[0], v[2]);

314 
sum
[2] = 
	`vec_m”geh
(
v
[1], v[3]);

315 
sum
[3] = 
	`vec_m”g–
(
v
[1], v[3]);

319 
sum
[0] = 
	`vec_add
(sum[0], sum[1]);

321 
sum
[1] = 
	`vec_add
(sum[2], sum[3]);

323 
sum
[0] = 
	`vec_add
(sum[0], sum[1]);

324  
sum
[0];

325 
	}
}

327 
šlše
 
	$ei_´edux
(cÚ¡ 
v4i
& 
a
)

329 
USE_CONST_v0i
;

330 
v4i
 
sum
;

331 
sum
 = 
	`vec_sums
(
a
, 
v0i
);

332 
sum
 = 
	`vec_¦d
(sum, 
v0i
, 12);

333  
	`ei_pfœ¡
(
sum
);

334 
	}
}

336 
	g‹m¶©e
<
	gOff£t
>

337 
	gei_·lign_im¶
<
	gOff£t
, 
	gv4f
>

339 
šlše
 
run
(
v4f
& 
fœ¡
, cÚ¡ v4f& 
£cÚd
)

341 
	gfœ¡
 = 
vec_¦d
(
fœ¡
, 
£cÚd
, 
Off£t
*4);

345 
	g‹m¶©e
<
	gOff£t
>

346 
	gei_·lign_im¶
<
	gOff£t
, 
	gv4i
>

348 
šlše
 
run
(
v4i
& 
fœ¡
, cÚ¡ v4i& 
£cÚd
)

350 
	gfœ¡
 = 
vec_¦d
(
fœ¡
, 
£cÚd
, 
Off£t
*4);

	@robot/Eigen/src/Core/arch/SSE/PacketMath.h

25 #iâdeà
EIGEN_PACKET_MATH_SSE_H


26 
	#EIGEN_PACKET_MATH_SSE_H


	)

28 #iâdeà
EIGEN_CACHEFRIENDLY_PRODUCT_THRESHOLD


29 
	#EIGEN_CACHEFRIENDLY_PRODUCT_THRESHOLD
 16

	)

32 
	g‹m¶©e
<> 
	gei_·ck‘_Œa™s
<> { 
__m128
 
	tty³
;ƒnum {
	gsize
=4}; };

33 
	g‹m¶©e
<> 
	gei_·ck‘_Œa™s
<> { 
__m128d
 
	tty³
;ƒnum {
	gsize
=2}; };

34 
	g‹m¶©e
<> 
	gei_·ck‘_Œa™s
<> { 
__m128i
 
	tty³
;ƒnum {
	gsize
=4}; };

36 
	g‹m¶©e
<> 
	gei_uÅack‘_Œa™s
<
	g__m128
> { 
	tty³
;ƒnum {
	gsize
=4}; };

37 
	g‹m¶©e
<> 
	gei_uÅack‘_Œa™s
<
	g__m128d
> { 
	tty³
;ƒnum {
	gsize
=2}; };

38 
	g‹m¶©e
<> 
	gei_uÅack‘_Œa™s
<
	g__m128i
> { 
	tty³
;ƒnum {
	gsize
=4}; };

40 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_p£t1
<>(cÚ¡ & 
	gäom
è{  
_mm_£t1_ps
(
äom
); }

41 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_p£t1
<>(cÚ¡ & 
	gäom
è{  
_mm_£t1_pd
(
äom
); }

42 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_p£t1
<>(cÚ¡ & 
	gäom
è{  
_mm_£t1_•i32
(
äom
); }

44 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_·dd
<
	g__m128
>(cÚ¡ __m128& 
	ga
, cÚ¡ __m128& 
	gb
è{  
_mm_add_ps
(
a
,
b
); }

45 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_·dd
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
, cÚ¡ __m128d& 
	gb
è{  
_mm_add_pd
(
a
,
b
); }

46 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_·dd
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
, cÚ¡ __m128i& 
	gb
è{  
_mm_add_•i32
(
a
,
b
); }

48 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_psub
<
	g__m128
>(cÚ¡ __m128& 
	ga
, cÚ¡ __m128& 
	gb
è{  
_mm_sub_ps
(
a
,
b
); }

49 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_psub
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
, cÚ¡ __m128d& 
	gb
è{  
_mm_sub_pd
(
a
,
b
); }

50 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_psub
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
, cÚ¡ __m128i& 
	gb
è{  
_mm_sub_•i32
(
a
,
b
); }

52 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_pmul
<
	g__m128
>(cÚ¡ __m128& 
	ga
, cÚ¡ __m128& 
	gb
è{  
_mm_mul_ps
(
a
,
b
); }

53 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_pmul
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
, cÚ¡ __m128d& 
	gb
è{  
_mm_mul_pd
(
a
,
b
); }

54 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_pmul
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
, cÚ¡ __m128i& 
	gb
)

56  
_mm_Ü_si128
(

57 
_mm_ªd_si128
(

58 
_mm_mul_•u32
(
a
,
b
),

59 
_mm_£Œ_•i32
(0xffffffff,0,0xffffffff,0)),

60 
_mm_¦li_si128
(

61 
_mm_ªd_si128
(

62 
_mm_mul_•u32
(
_mm_¤li_si128
(
a
,4),_mm_¤li_si128(
b
,4)),

63 
_mm_£Œ_•i32
(0xffffffff,0,0xffffffff,0)), 4));

66 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_pdiv
<
	g__m128
>(cÚ¡ __m128& 
	ga
, cÚ¡ __m128& 
	gb
è{  
_mm_div_ps
(
a
,
b
); }

67 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_pdiv
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
, cÚ¡ __m128d& 
	gb
è{  
_mm_div_pd
(
a
,
b
); }

68 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_pdiv
<
	g__m128i
>(const __m128i& , const __m128i& )

69 { 
ei_as£¹
(
çl£
 && "packet integer division‡re‚ot supported by SSE");

70 
__m128i
 
	gdummy
 = 
ei_p£t1
<>(0);

71  
	gdummy
;

75 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	$ei_pmadd
(cÚ¡ 
__m128i
& 
a
, cÚ¡ __m128i& 
b
, cÚ¡ __m128i& 
c
è{  
	`ei_·dd
(
	`ei_pmul
×,b), c); 
	}
}

77 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_pmš
<
	g__m128
>(cÚ¡ __m128& 
	ga
, cÚ¡ __m128& 
	gb
è{  
_mm_mš_ps
(
a
,
b
); }

78 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_pmš
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
, cÚ¡ __m128d& 
	gb
è{  
_mm_mš_pd
(
a
,
b
); }

80 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_pmš
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
, cÚ¡ __m128i& 
	gb
)

82 
__m128i
 
	gmask
 = 
_mm_cm¶t_•i32
(
a
,
b
);

83  
_mm_Ü_si128
(
_mm_ªd_si128
(
mask
,
a
),
_mm_ªdnÙ_si128
(mask,
b
));

86 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_pmax
<
	g__m128
>(cÚ¡ __m128& 
	ga
, cÚ¡ __m128& 
	gb
è{  
_mm_max_ps
(
a
,
b
); }

87 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_pmax
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
, cÚ¡ __m128d& 
	gb
è{  
_mm_max_pd
(
a
,
b
); }

89 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_pmax
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
, cÚ¡ __m128i& 
	gb
)

91 
__m128i
 
	gmask
 = 
_mm_cmpgt_•i32
(
a
,
b
);

92  
_mm_Ü_si128
(
_mm_ªd_si128
(
mask
,
a
),
_mm_ªdnÙ_si128
(mask,
b
));

95 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_¶ßd
<>(cÚ¡ * 
	gäom
è{  
_mm_lßd_ps
(
äom
); }

96 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_¶ßd
<>(cÚ¡ * 
	gäom
è{  
_mm_lßd_pd
(
äom
); }

97 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_¶ßd
<>(cÚ¡ * 
	gäom
è{  
_mm_lßd_si128
(
»š‹½»t_ÿ¡
<cÚ¡ __m128i*>(
äom
)); }

99 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_¶ßdu
<>(cÚ¡ * 
	gäom
è{  
_mm_lßdu_ps
(
äom
); }

106 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_¶ßdu
<>(cÚ¡ * 
	gäom
è{  
_mm_lßdu_pd
(
äom
); }

107 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_¶ßdu
<>(cÚ¡ * 
	gäom
è{  
_mm_lßdu_si128
(
»š‹½»t_ÿ¡
<cÚ¡ __m128i*>(
äom
)); }

109 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_p¡Üe
<>(* 
	gto
, cÚ¡ 
	g__m128
& 
	gäom
è{ 
_mm_¡Üe_ps
(
to
, 
äom
); }

110 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_p¡Üe
<>(* 
	gto
, cÚ¡ 
	g__m128d
& 
	gäom
è{ 
_mm_¡Üe_pd
(
to
, 
äom
); }

111 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_p¡Üe
<>(* 
	gto
, cÚ¡ 
	g__m128i
& 
	gäom
è{ 
_mm_¡Üe_si128
(
»š‹½»t_ÿ¡
<
__m128i
*>(
to
), 
äom
); }

113 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_p¡Üeu
<>(* 
	gto
, cÚ¡ 
	g__m128
& 
	gäom
è{ 
_mm_¡Üeu_ps
(
to
, 
äom
); }

114 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_p¡Üeu
<>(* 
	gto
, cÚ¡ 
	g__m128d
& 
	gäom
è{ 
_mm_¡Üeu_pd
(
to
, 
äom
); }

115 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_p¡Üeu
<>(* 
	gto
, cÚ¡ 
	g__m128i
& 
	gäom
è{ 
_mm_¡Üeu_si128
(
»š‹½»t_ÿ¡
<
__m128i
*>(
to
), 
äom
); }

117 #ià
defšed
(
_MSC_VER
è&& (_MSC_VER <ğ1500è&& defšed(
_WIN64
è&& !defšed(
__INTEL_COMPILER
)

120 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128
>(cÚ¡ __m128& 
	ga
è{ ‡.
	gm128_f32
[0]; }

121 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
è{ ‡.
	gm128d_f64
[0]; }

122 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
è{ 
	gx
 = 
_mm_cvtsi128_si32
(
a
);  x; }

123 #–ià
defšed
(
_MSC_VER
è&& (_MSC_VER <ğ1500è&& !defšed(
__INTEL_COMPILER
)

125 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128
>(cÚ¡ __m128& 
	ga
è{ 
	gx
 = 
_mm_cvtss_f32
(
a
);  x; }

126 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
è{ 
	gx
 = 
_mm_cvtsd_f64
(
a
);  x; }

127 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
è{ 
	gx
 = 
_mm_cvtsi128_si32
(
a
);  x; }

129 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128
>(cÚ¡ __m128& 
	ga
è{  
_mm_cvtss_f32
(
a
); }

130 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
è{  
_mm_cvtsd_f64
(
a
); }

131 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_pfœ¡
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
è{  
_mm_cvtsi128_si32
(
a
); }

134 #ifdeà
__SSE3__


136 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_´eduxp
<
	g__m128
>(cÚ¡ __m128* 
	gvecs
)

138  
_mm_hadd_ps
(_mm_hadd_ps(
vecs
[0], vecs[1]),_mm_hadd_ps(vecs[2], vecs[3]));

140 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_´eduxp
<
	g__m128d
>(cÚ¡ __m128d* 
	gvecs
)

142  
_mm_hadd_pd
(
vecs
[0], vecs[1]);

150 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_´edux
<
	g__m128
>(cÚ¡ __m128& 
	ga
)

152 
__m128
 
	gtmp0
 = 
_mm_hadd_ps
(
a
,a);

153  
ei_pfœ¡
(
_mm_hadd_ps
(
tmp0
,mp0));

156 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_´edux
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
è{  
ei_pfœ¡
(
_mm_hadd_pd
(
a
,‡)); }

166 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_´edux
<
	g__m128
>(cÚ¡ __m128& 
	ga
)

168 
__m128
 
	gtmp
 = 
_mm_add_ps
(
a
, 
_mm_movehl_ps
(a,a));

169  
ei_pfœ¡
(
_mm_add_ss
(
tmp
, 
_mm_shufæe_ps
(tmp,tmp, 1)));

171 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_´edux
<
	g__m128d
>(cÚ¡ __m128d& 
	ga
)

173  
ei_pfœ¡
(
_mm_add_sd
(
a
, 
_mm_uÅackhi_pd
(a,a)));

176 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128
 
	gei_´eduxp
<
	g__m128
>(cÚ¡ __m128* 
	gvecs
)

178 
__m128
 
	gtmp0
, 
	gtmp1
, 
	gtmp2
;

179 
	gtmp0
 = 
_mm_uÅacklo_ps
(
vecs
[0], vecs[1]);

180 
	gtmp1
 = 
_mm_uÅackhi_ps
(
vecs
[0], vecs[1]);

181 
	gtmp2
 = 
_mm_uÅackhi_ps
(
vecs
[2], vecs[3]);

182 
	gtmp0
 = 
_mm_add_ps
(
tmp0
, 
tmp1
);

183 
	gtmp1
 = 
_mm_uÅacklo_ps
(
vecs
[2], vecs[3]);

184 
	gtmp1
 = 
_mm_add_ps
(
tmp1
, 
tmp2
);

185 
	gtmp2
 = 
_mm_movehl_ps
(
tmp1
, 
tmp0
);

186 
	gtmp0
 = 
_mm_mov–h_ps
(
tmp0
, 
tmp1
);

187  
_mm_add_ps
(
tmp0
, 
tmp2
);

190 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128d
 
	gei_´eduxp
<
	g__m128d
>(cÚ¡ __m128d* 
	gvecs
)

192  
_mm_add_pd
(
_mm_uÅacklo_pd
(
vecs
[0], vecs[1]), 
_mm_uÅackhi_pd
(vecs[0], vecs[1]));

196 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
	gei_´edux
<
	g__m128i
>(cÚ¡ __m128i& 
	ga
)

198 
__m128i
 
	gtmp
 = 
_mm_add_•i32
(
a
, 
_mm_uÅackhi_•i64
(a,a));

199  
ei_pfœ¡
(
tmp
è+ƒi_pfœ¡(
_mm_shufæe_•i32
(tmp, 1));

202 
	g‹m¶©e
<> 
EIGEN_STRONG_INLINE
 
__m128i
 
	gei_´eduxp
<
	g__m128i
>(cÚ¡ __m128i* 
	gvecs
)

204 
__m128i
 
	gtmp0
, 
	gtmp1
, 
	gtmp2
;

205 
	gtmp0
 = 
_mm_uÅacklo_•i32
(
vecs
[0], vecs[1]);

206 
	gtmp1
 = 
_mm_uÅackhi_•i32
(
vecs
[0], vecs[1]);

207 
	gtmp2
 = 
_mm_uÅackhi_•i32
(
vecs
[2], vecs[3]);

208 
	gtmp0
 = 
_mm_add_•i32
(
tmp0
, 
tmp1
);

209 
	gtmp1
 = 
_mm_uÅacklo_•i32
(
vecs
[2], vecs[3]);

210 
	gtmp1
 = 
_mm_add_•i32
(
tmp1
, 
tmp2
);

211 
	gtmp2
 = 
_mm_uÅacklo_•i64
(
tmp0
, 
tmp1
);

212 
	gtmp0
 = 
_mm_uÅackhi_•i64
(
tmp0
, 
tmp1
);

213  
_mm_add_•i32
(
tmp0
, 
tmp2
);

216 #ià(
defšed
 
__GNUC__
)

231 #ifdeà
__SSSE3__


233 
	g‹m¶©e
<
	gOff£t
>

234 
	gei_·lign_im¶
<
	gOff£t
,
	g__m128
>

236 
EIGEN_STRONG_INLINE
 
run
(
__m128
& 
fœ¡
, cÚ¡ __m128& 
£cÚd
)

238 ià(
	gOff£t
!=0)

239 
fœ¡
 = 
_mm_ÿ¡si128_ps
(
_mm_®igÄ_•i8
(
_mm_ÿ¡ps_si128
(
£cÚd
), _mm_ÿ¡ps_si128(fœ¡), 
Off£t
*4));

243 
	g‹m¶©e
<
	gOff£t
>

244 
	gei_·lign_im¶
<
	gOff£t
,
	g__m128i
>

246 
EIGEN_STRONG_INLINE
 
run
(
__m128i
& 
fœ¡
, cÚ¡ __m128i& 
£cÚd
)

248 ià(
	gOff£t
!=0)

249 
fœ¡
 = 
_mm_®igÄ_•i8
(
£cÚd
,fœ¡, 
Off£t
*4);

253 
	g‹m¶©e
<
	gOff£t
>

254 
	gei_·lign_im¶
<
	gOff£t
,
	g__m128d
>

256 
EIGEN_STRONG_INLINE
 
run
(
__m128d
& 
fœ¡
, cÚ¡ __m128d& 
£cÚd
)

258 ià(
	gOff£t
==1)

259 
fœ¡
 = 
_mm_ÿ¡si128_pd
(
_mm_®igÄ_•i8
(
_mm_ÿ¡pd_si128
(
£cÚd
), _mm_castpd_si128(first), 8));

264 
	g‹m¶©e
<
	gOff£t
>

265 
	gei_·lign_im¶
<
	gOff£t
,
	g__m128
>

267 
EIGEN_STRONG_INLINE
 
run
(
__m128
& 
fœ¡
, cÚ¡ __m128& 
£cÚd
)

269 ià(
	gOff£t
==1)

271 
fœ¡
 = 
_mm_move_ss
(fœ¡,
£cÚd
);

272 
	gfœ¡
 = 
_mm_ÿ¡si128_ps
(
_mm_shufæe_•i32
(
_mm_ÿ¡ps_si128
(
fœ¡
),0x39));

274 ià(
	gOff£t
==2)

276 
fœ¡
 = 
_mm_movehl_ps
(first,first);

277 
	gfœ¡
 = 
_mm_mov–h_ps
(
fœ¡
,
£cÚd
);

279 ià(
	gOff£t
==3)

281 
fœ¡
 = 
_mm_move_ss
(fœ¡,
£cÚd
);

282 
	gfœ¡
 = 
_mm_shufæe_ps
(
fœ¡
,
£cÚd
,0x93);

287 
	g‹m¶©e
<
	gOff£t
>

288 
	gei_·lign_im¶
<
	gOff£t
,
	g__m128i
>

290 
EIGEN_STRONG_INLINE
 
run
(
__m128i
& 
fœ¡
, cÚ¡ __m128i& 
£cÚd
)

292 ià(
	gOff£t
==1)

294 
fœ¡
 = 
_mm_ÿ¡ps_si128
(
_mm_move_ss
(
_mm_ÿ¡si128_ps
(fœ¡),_mm_ÿ¡si128_ps(
£cÚd
)));

295 
	gfœ¡
 = 
_mm_shufæe_•i32
(
fœ¡
,0x39);

297 ià(
	gOff£t
==2)

299 
fœ¡
 = 
_mm_ÿ¡ps_si128
(
_mm_movehl_ps
(
_mm_ÿ¡si128_ps
(first),_mm_castsi128_ps(first)));

300 
	gfœ¡
 = 
_mm_ÿ¡ps_si128
(
_mm_mov–h_ps
(
_mm_ÿ¡si128_ps
(
fœ¡
),_mm_ÿ¡si128_ps(
£cÚd
)));

302 ià(
	gOff£t
==3)

304 
fœ¡
 = 
_mm_ÿ¡ps_si128
(
_mm_move_ss
(
_mm_ÿ¡si128_ps
(fœ¡),_mm_ÿ¡si128_ps(
£cÚd
)));

305 
	gfœ¡
 = 
_mm_ÿ¡ps_si128
(
_mm_shufæe_ps
(
_mm_ÿ¡si128_ps
(
fœ¡
),_mm_ÿ¡si128_ps(
£cÚd
),0x93));

310 
	g‹m¶©e
<
	gOff£t
>

311 
	gei_·lign_im¶
<
	gOff£t
,
	g__m128d
>

313 
EIGEN_STRONG_INLINE
 
run
(
__m128d
& 
fœ¡
, cÚ¡ __m128d& 
£cÚd
)

315 ià(
	gOff£t
==1)

317 
fœ¡
 = 
_mm_ÿ¡ps_pd
(
_mm_movehl_ps
(
_mm_ÿ¡pd_ps
(first),_mm_castpd_ps(first)));

318 
	gfœ¡
 = 
_mm_ÿ¡ps_pd
(
_mm_mov–h_ps
(
_mm_ÿ¡pd_ps
(
fœ¡
),_mm_ÿ¡pd_ps(
£cÚd
)));

324 
	#ei_vec4f_swizzË1
(
v
,
p
,
q
,
r
,
s
) \

325 (
	`_mm_ÿ¡si128_ps
(
	`_mm_shufæe_•i32
Ğ
	`_mm_ÿ¡ps_si128
(
v
), ((
s
)<<6|(
r
)<<4|(
q
)<<2|(
p
)))))

	)

	@robot/Eigen/src/Core/util/Constants.h

26 #iâdeà
EIGEN_CONSTANTS_H


27 
	#EIGEN_CONSTANTS_H


	)

43 cÚ¡ 
	gDyÇmic
 = 10000;

48 cÚ¡ 
	gInfš™y
 = -1;

69 cÚ¡ 
	gRowMajÜB™
 = 0x1;

74 cÚ¡ 
	gEv®BefÜeNe¡šgB™
 = 0x2;

79 cÚ¡ 
	gEv®BefÜeAssignšgB™
 = 0x4;

97 cÚ¡ 
	gPack‘AcûssB™
 = 0x8;

99 #ifdeà
EIGEN_VECTORIZE


108 cÚ¡ 
	gAùu®Pack‘AcûssB™
 = 
Pack‘AcûssB™
;

110 cÚ¡ 
	gAùu®Pack‘AcûssB™
 = 0x0;

133 cÚ¡ 
	gLš—rAcûssB™
 = 0x10;

144 cÚ¡ 
	gDœeùAcûssB™
 = 0x20;

149 cÚ¡ 
	gAligÃdB™
 = 0x40;

154 cÚ¡ 
	gZ”oDŸgB™
 = 0x80;

159 cÚ¡ 
	gUn™DŸgB™
 = 0x100;

164 cÚ¡ 
	gS–fAdjoštB™
 = 0x200;

169 cÚ¡ 
	gUµ”TrŸnguÏrB™
 = 0x400;

174 cÚ¡ 
	gLow”TrŸnguÏrB™
 = 0x800;

179 cÚ¡ 
	gS·r£B™
 = 0x1000;

182 cÚ¡ 
	gH”ed™¬yB™s
 = 
RowMajÜB™


183 | 
Ev®BefÜeNe¡šgB™


184 | 
Ev®BefÜeAssignšgB™


185 | 
S·r£B™
;

188 cÚ¡ 
	gUµ”TrŸnguÏr
 = 
Uµ”TrŸnguÏrB™
;

189 cÚ¡ 
	gSŒiùlyUµ”TrŸnguÏr
 = 
Uµ”TrŸnguÏrB™
 | 
Z”oDŸgB™
;

190 cÚ¡ 
	gLow”TrŸnguÏr
 = 
Low”TrŸnguÏrB™
;

191 cÚ¡ 
	gSŒiùlyLow”TrŸnguÏr
 = 
Low”TrŸnguÏrB™
 | 
Z”oDŸgB™
;

192 cÚ¡ 
	gS–fAdjošt
 = 
S–fAdjoštB™
;

195 cÚ¡ 
	gUn™Uµ”TrŸnguÏr
 = 
Uµ”TrŸnguÏrB™
 | 
Un™DŸgB™
;

196 cÚ¡ 
	gUn™Low”TrŸnguÏr
 = 
Low”TrŸnguÏrB™
 | 
Un™DŸgB™
;

197 cÚ¡ 
	gDŸgÚ®
 = 
Uµ”TrŸnguÏr
 | 
Low”TrŸnguÏr
;

199 ’um { 
	mAligÃd
, 
	mUÇligÃd
 };

200 ’um { 
	mFÜûAligÃd
, 
	mAsReque¡ed
 };

201 ’um { 
	mCÚd™iÚ®JumpCo¡
 = 5 };

202 
	eCÜÃrTy³
 { 
	mTİLeá
, 
	mTİRight
, 
	mBÙtomLeá
, 
	mBÙtomRight
 };

203 
	eDœeùiÚTy³
 { 
	mV”tiÿl
, 
	mHÜizÚl
 };

204 
	eProduùEv®u©iÚMode
 { 
	mNÜm®Produù
, 
	mCacheFr›ndlyProduù
, 
	mDŸgÚ®Produù
, 
	mS·r£TimeS·r£Produù
, 
	mS·r£TimeD’£Produù
, 
	mD’£TimeS·r£Produù
 };

209 
	mIÂ”VeùÜiz©iÚ
,

212 
	mLš—rVeùÜiz©iÚ
,

215 
	mSliûVeùÜiz©iÚ
,

216 
	mNoVeùÜiz©iÚ


220 
	mNoUÄŞlšg
,

221 
	mIÂ”UÄŞlšg
,

222 
	mCom¶‘eUÄŞlšg


226 
	mCŞMajÜ
 = 0,

227 
	mRowMajÜ
 = 0x1,

230 
	mDÚtAlign
 = 0,

232 
	mAutoAlign
 = 0x2

236 
	mIsD’£
 = 0,

237 
	mIsS·r£
 = 
S·r£B™
,

238 
	mNoDœeùAcûss
 = 0,

239 
	mHasDœeùAcûss
 = 
DœeùAcûssB™


242 cÚ¡ 
	gEiArch_G’”ic
 = 0x0;

243 cÚ¡ 
	gEiArch_SSE
 = 0x1;

244 cÚ¡ 
	gEiArch_AÉiVec
 = 0x2;

246 #ià
defšed
 
EIGEN_VECTORIZE_SSE


247 cÚ¡ 
	gEiArch
 = 
EiArch_SSE
;

248 #–ià
defšed
 
EIGEN_VECTORIZE_ALTIVEC


249 cÚ¡ 
	gEiArch
 = 
EiArch_AÉiVec
;

251 cÚ¡ 
	gEiArch
 = 
EiArch_G’”ic
;

	@robot/Eigen/src/Core/util/DisableMSVCWarnings.h

2 #ifdeà
_MSC_VER


3 #´agm¨
w¬nšg
Ğ
push
 )

4 #´agm¨
w¬nšg
Ğ
di§bË
 : 4181 4244 4127 4211 4717 )

	@robot/Eigen/src/Core/util/EnableMSVCWarnings.h

2 #ifdeà
_MSC_VER


3 #´agm¨
w¬nšg
Ğ
pİ
 )

	@robot/Eigen/src/Core/util/ForwardDeclarations.h

25 #iâdeà
EIGEN_FORWARDDECLARATIONS_H


26 
	#EIGEN_FORWARDDECLARATIONS_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_Œa™s
;

29 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gNumT¿™s
;

31 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
,

32 
	g_O±iÚs
 = 
EIGEN_DEFAULT_MATRIX_STORAGE_ORDER_OPTION
 | 
AutoAlign
,

33 
	g_MaxRows
 = 
_Rows
, 
	g_MaxCŞs
 = 
_CŞs
> 
şass
 
M©rix
;

35 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
> 
şass
 
	gFÏgged
;

36 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> 
şass
 
	gNe¡ByV®ue
;

37 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> 
şass
 
	gSw­W¿µ”
;

38 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gMšÜ
;

39 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBlockRows
=
DyÇmic
, 
	gBlockCŞs
=DyÇmic, 
	gPack‘Acûss
=
AsReque¡ed
,

40 
	g_DœeùAcûssStus
 = 
ei_Œa™s
<
M©rixTy³
>::
FÏgs
&
DœeùAcûssB™
 ? DirectAccessBit

41 : 
ei_Œa™s
<
M©rixTy³
>::
FÏgs
&
S·r£B™
> 
şass
 
Block
;

42 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gT¿n¥o£
;

43 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gCÚjug©e
;

44 
	g‹m¶©e
<
ty³Çme
 
	gNuÎ¬yOp
,y³Çm
	gM©rixTy³
> 
şass
 
	gCwi£NuÎ¬yOp
;

45 
	g‹m¶©e
<
ty³Çme
 
	gUÇryOp
,y³Çm
	gM©rixTy³
> 
şass
 
	gCwi£UÇryOp
;

46 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
> 
şass
 
	gCwi£Bš¬yOp
;

47 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gProduùMode
> 
şass
 
	gProduù
;

48 
	g‹m¶©e
<
ty³Çme
 
	gCÛffsVeùÜTy³
> 
şass
 
	gDŸgÚ®M©rix
;

49 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gDŸgÚ®CÛffs
;

50 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gPack‘Acûss
 = 
AsReque¡ed
> 
şass
 
M­
;

51 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
> 
şass
 
	gP¬t
;

52 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gMode
> 
şass
 
	gExŒaù
;

53 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> 
şass
 
	gCwi£
;

54 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> 
şass
 
	gW™hFÜm©
;

55 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
	gCommaIn™Ÿliz”
;

58 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
> 
	gei_´oduù_mode
;

59 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gProduùMode
 = 
ei_´oduù_mode
<
Lhs
,Rhs>::
v®ue
> 
ProduùR‘uºTy³
;

61 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_sum_İ
;

62 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_difã»nû_İ
;

63 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_´oduù_İ
;

64 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_quÙ›Á_İ
;

65 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_İpos™e_İ
;

66 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_cÚjug©e_İ
;

67 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_»®_İ
;

68 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_imag_İ
;

69 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_abs_İ
;

70 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_abs2_İ
;

71 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_sq¹_İ
;

72 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_exp_İ
;

73 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_log_İ
;

74 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_cos_İ
;

75 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_sš_İ
;

76 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_pow_İ
;

77 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_šv”£_İ
;

78 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_squ¬e_İ
;

79 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_cube_İ
;

80 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gNewTy³
> 
	gei_sÿÏr_ÿ¡_İ
;

81 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_muÉË_İ
;

82 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_quÙ›Á1_İ
;

83 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_mš_İ
;

84 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_max_İ
;

85 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_¿ndom_İ
;

86 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_add_İ
;

87 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_cÚ¡ªt_İ
;

88 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	gei_sÿÏr_id’t™y_İ
;

90 
	gIOFÜm©
;

92 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

93 
ei_ÿche_ä›ndly_´oduù
(

94 
_rows
, 
_cŞs
, 
d•th
,

95 
boŞ
 
_lhsRowMajÜ
, cÚ¡ 
SÿÏr
* 
_lhs
, 
_lhsSŒide
,

96 
boŞ
 
_rhsRowMajÜ
, cÚ¡ 
SÿÏr
* 
_rhs
, 
_rhsSŒide
,

97 
boŞ
 
»sRowMajÜ
, 
SÿÏr
* 
»s
, 
»sSŒide
);

100 
	g‹m¶©e
<
ty³Çme
 
	gCÚd™iÚM©rixTy³
,y³Çm
	gTh’M©rixTy³
,y³Çm
	gEl£M©rixTy³
> 
şass
 
	gS–eù
;

101 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
,y³Çm
	gBš¬yOp
, 
	gDœeùiÚ
> 
şass
 
	gP¬tŸlReduxEx´
;

102 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gDœeùiÚ
> 
şass
 
	gP¬tŸlRedux
;

104 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gLU
;

105 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gQR
;

106 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gSVD
;

107 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gLLT
;

108 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gLDLT
;

111 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	g_Dim
> 
şass
 
	gRÙ©iÚBa£
;

112 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
> 
şass
 
	gCross
;

113 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
şass
 
	gQu©”niÚ
;

114 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
şass
 
	gRÙ©iÚ2D
;

115 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
şass
 
	gAngËAxis
;

116 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,
	gDim
> 
şass
 
	gT¿nsfÜm
;

117 
	g‹m¶©e
 <
ty³Çme
 
	g_SÿÏr
, 
	g_Amb›ÁDim
> 
şass
 
	gP¬am‘rizedLše
;

118 
	g‹m¶©e
 <
ty³Çme
 
	g_SÿÏr
, 
	g_Amb›ÁDim
> 
şass
 
	gHy³½ÏÃ
;

119 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,
	gDim
> 
şass
 
	gT¿n¦©iÚ
;

120 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,
	gDim
> 
şass
 
	gSÿlšg
;

123 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gProduùMode
> 
şass
 
	gS·r£Produù
;

	@robot/Eigen/src/Core/util/Macros.h

26 #iâdeà
EIGEN_MACROS_H


27 
	#EIGEN_MACROS_H


	)

29 #undeà
mšÜ


31 
	#EIGEN_WORLD_VERSION
 2

	)

32 
	#EIGEN_MAJOR_VERSION
 0

	)

33 
	#EIGEN_MINOR_VERSION
 15

	)

35 
	#EIGEN_VERSION_AT_LEAST
(
x
,
y
,
z
è(
EIGEN_WORLD_VERSION
>x || (EIGEN_WORLD_VERSION>=x && \

36 (
EIGEN_MAJOR_VERSION
>
y
 || (EIGEN_MAJOR_VERSION>=y && \

37 
EIGEN_MINOR_VERSION
>=
z
))))

	)

42 #ià
defšed
(
__GNUC__
è&& !(defšed(
__i386__
è|| defšed(
__x86_64__
è|| defšed(
__pow”pc__
è|| defšed(
__µc__
è|| defšed(
__Ÿ64__
))

43 
	#EIGEN_GCC_AND_ARCH_DOESNT_WANT_ALIGNMENT
 1

	)

45 
	#EIGEN_GCC_AND_ARCH_DOESNT_WANT_ALIGNMENT
 0

	)

48 #ià
defšed
(
__GNUC__
) && (__GNUC__ <= 3)

49 
	#EIGEN_GCC3_OR_OLDER
 1

	)

51 
	#EIGEN_GCC3_OR_OLDER
 0

	)

55 #ià!
EIGEN_GCC_AND_ARCH_DOESNT_WANT_ALIGNMENT
 && !
EIGEN_GCC3_OR_OLDER
 && !
defšed
(
__SUNPRO_CC
è&& !defšed(
__QNXNTO__
)

56 
	#EIGEN_ARCH_WANTS_ALIGNMENT
 1

	)

58 
	#EIGEN_ARCH_WANTS_ALIGNMENT
 0

	)

63 #ià
EIGEN_ARCH_WANTS_ALIGNMENT
 && !
defšed
(
EIGEN_DONT_ALIGN
)

64 
	#EIGEN_ALIGN
 1

	)

66 
	#EIGEN_ALIGN
 0

	)

67 #ifdeà
EIGEN_VECTORIZE


70 #iâdeà
EIGEN_DISABLE_UNALIGNED_ARRAY_ASSERT


71 
	#EIGEN_DISABLE_UNALIGNED_ARRAY_ASSERT


	)

75 #ifdeà
EIGEN_DEFAULT_TO_ROW_MAJOR


76 
	#EIGEN_DEFAULT_MATRIX_STORAGE_ORDER_OPTION
 
RowMajÜ


	)

78 
	#EIGEN_DEFAULT_MATRIX_STORAGE_ORDER_OPTION
 
CŞMajÜ


	)

85 #iâdeà
EIGEN_UNROLLING_LIMIT


86 
	#EIGEN_UNROLLING_LIMIT
 100

	)

94 #iâdeà
EIGEN_TUNE_FOR_CPU_CACHE_SIZE


95 
	#EIGEN_TUNE_FOR_CPU_CACHE_SIZE
 (()*256*256)

	)

99 #ifdeà
EIGEN_TUNE_FOR_L2_CACHE_SIZE


100 #”rÜ 
EIGEN_TUNE_FOR_L2_CACHE_SIZE
 
is
 
now
 
ÿÎed
 
EIGEN_TUNE_FOR_CPU_CACHE_SIZE
.

103 
	#USING_PART_OF_NAMESPACE_EIGEN
 \

104 
EIGEN_USING_MATRIX_TYPEDEFS
 \

105 
usšg
 
Eig’
::
M©rix
; \

106 
usšg
 
Eig’
::
M©rixBa£
; \

107 
usšg
 
Eig’
::
ei_¿ndom
; \

108 
usšg
 
Eig’
::
ei_»®
; \

109 
usšg
 
Eig’
::
ei_imag
; \

110 
usšg
 
Eig’
::
ei_cÚj
; \

111 
usšg
 
Eig’
::
ei_abs
; \

112 
usšg
 
Eig’
::
ei_abs2
; \

113 
usšg
 
Eig’
::
ei_sq¹
; \

114 
usšg
 
Eig’
::
ei_exp
; \

115 
usšg
 
Eig’
::
ei_log
; \

116 
usšg
 
Eig’
::
ei_sš
; \

117 
usšg
 
Eig’
::
ei_cos
;

	)

119 #ifdeà
NDEBUG


120 #iâdeà
EIGEN_NO_DEBUG


121 
	#EIGEN_NO_DEBUG


	)

125 #iâdeà
ei_as£¹


126 #ifdeà
EIGEN_NO_DEBUG


127 
	#ei_as£¹
(
x
)

	)

129 
	#ei_as£¹
(
x
è
	`as£¹
(x)

	)

133 #ifdeà
EIGEN_INTERNAL_DEBUGGING


134 
	#ei_š‹º®_as£¹
(
x
è
	`ei_as£¹
(x)

	)

136 
	#ei_š‹º®_as£¹
(
x
)

	)

139 #ifdeà
EIGEN_NO_DEBUG


140 
	#EIGEN_ONLY_USED_FOR_DEBUG
(
x
è()
	)
x

142 
	#EIGEN_ONLY_USED_FOR_DEBUG
(
x
)

	)

151 #ià
EIGEN_GNUC_AT_LEAST
(4,0)

152 
	#EIGEN_ALWAYS_INLINE_ATTRIB
 
	`__©Œibu‹__
((
®ways_šlše
))

	)

154 
	#EIGEN_ALWAYS_INLINE_ATTRIB


	)

158 #ià(
defšed
 
_MSC_VER
)

159 
	#EIGEN_STRONG_INLINE
 
__fÜûšlše


	)

161 
	#EIGEN_STRONG_INLINE
 
šlše


	)

164 #ià(
defšed
 
__GNUC__
)

165 
	#EIGEN_DONT_INLINE
 
	`__©Œibu‹__
((
nošlše
))

	)

166 #–ià(
defšed
 
_MSC_VER
)

167 
	#EIGEN_DONT_INLINE
 
	`__deş¥ec
(
nošlše
)

	)

169 
	#EIGEN_DONT_INLINE


	)

172 #ià(
defšed
 
__GNUC__
)

173 
	#EIGEN_DEPRECATED
 
	`__©Œibu‹__
((
d•»ÿ‹d
))

	)

174 #–ià(
defšed
 
_MSC_VER
)

175 
	#EIGEN_DEPRECATED
 
	`__deş¥ec
(
d•»ÿ‹d
)

	)

177 
	#EIGEN_DEPRECATED


	)

186 #ià!
EIGEN_ALIGN


187 
	#EIGEN_ALIGN_128


	)

188 #–ià(
defšed
 
__GNUC__
)

189 
	#EIGEN_ALIGN_128
 
	`__©Œibu‹__
((
	`®igÃd
(16)))

	)

190 #–ià(
defšed
 
_MSC_VER
)

191 
	#EIGEN_ALIGN_128
 
	`__deş¥ec
(
	`®ign
(16))

	)

193 #”rÜ 
PËa£
 
‹Î
 
me
 
wh©
 
is
 
the
 
equiv®’t
 
of
 
__©Œibu‹__
((
®igÃd
(16))è
your
 
comp”


196 #ifdeà
EIGEN_DONT_USE_RESTRICT_KEYWORD


197 
	#EIGEN_RESTRICT


	)

199 #iâdeà
EIGEN_RESTRICT


200 
	#EIGEN_RESTRICT
 
__»¡riù


	)

203 #iâdeà
EIGEN_STACK_ALLOCATION_LIMIT


204 
	#EIGEN_STACK_ALLOCATION_LIMIT
 1000000

	)

207 #iâdeà
EIGEN_DEFAULT_IO_FORMAT


208 
	#EIGEN_DEFAULT_IO_FORMAT
 
Eig’
::
	`IOFÜm©
()

	)

213 
	#EIGEN_DOCS_IO_FORMAT
 
	`IOFÜm©
(3, 
AlignCŞs
, " ", "\n", "", "")

	)

215 
	#EIGEN_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, 
Op
) \

216 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
> \

217 
EIGEN_STRONG_INLINE
 
D”ived
& 
İ”©Ü
 
	`Op
(cÚ¡ 
Eig’
::
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) \

219  
Ba£
::
İ”©Ü
 
	`Op
(
Ùh”
.
	`d”ived
()); \

221 
EIGEN_STRONG_INLINE
 
D”ived
& 
İ”©Ü
 
	`Op
(cÚ¡ D”ived& 
Ùh”
) \

223  
Ba£
::
İ”©Ü
 
	`Op
(
Ùh”
); \

224 }

	)

226 
	#EIGEN_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
D”ived
, 
Op
) \

227 
‹m¶©e
<
ty³Çme
 
Oth”
> \

228 
EIGEN_STRONG_INLINE
 
D”ived
& 
İ”©Ü
 
	`Op
(cÚ¡ 
Oth”
& 
sÿÏr
) \

230  
Ba£
::
İ”©Ü
 
	`Op
(
sÿÏr
); \

231 }

	)

233 
	#EIGEN_INHERIT_ASSIGNMENT_OPERATORS
(
D”ived
) \

234 
	`EIGEN_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, =) \

235 
	`EIGEN_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, +=) \

236 
	`EIGEN_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, -=) \

237 
	`EIGEN_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
D”ived
, *=) \

238 
	`EIGEN_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
D”ived
, /=)

	)

240 
	#_EIGEN_GENERIC_PUBLIC_INTERFACE
(
D”ived
, 
Ba£CÏss
) \

241 
Ba£CÏss
 
	tBa£
; \

242 
ty³Çme
 
	tEig’
::
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
 Scalar; \

243 
ty³Çme
 
	tEig’
::
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
; \

244 
ty³Çme
 
	tBa£
::
	tPack‘SÿÏr
 PacketScalar; \

245 
ty³Çme
 
	tEig’
::
	tei_Ã¡ed
<
	tD”ived
>::
	tty³
 
	tNe¡ed
; \

246 ’um { 
RowsAtCompeTime
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::RowsAtCompileTime, \

247 
CŞsAtCompeTime
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::ColsAtCompileTime, \

248 
MaxRowsAtCompeTime
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::MaxRowsAtCompileTime, \

249 
MaxCŞsAtCompeTime
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::MaxColsAtCompileTime, \

250 
FÏgs
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::Flags, \

251 
CÛffR—dCo¡
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::CoeffReadCost, \

252 
SizeAtCompeTime
 = 
Ba£
::SizeAtCompileTime, \

253 
MaxSizeAtCompeTime
 = 
Ba£
::MaxSizeAtCompileTime, \

254 
IsVeùÜAtCompeTime
 = 
Ba£
::IsVeùÜAtCompeTim};

	)

256 
	#EIGEN_GENERIC_PUBLIC_INTERFACE
(
D”ived
) \

257 
	`_EIGEN_GENERIC_PUBLIC_INTERFACE
(
D”ived
, 
Eig’
::
M©rixBa£
<D”ived>)

	)

259 
	#EIGEN_ENUM_MIN
(
a
,
b
è(((ï <ğ()bè? (ï : ()b)

	)

260 
	#EIGEN_SIZE_MIN
(
a
,
b
) ((()a == 1 || ()b == 1) ? 1 \

261 : (()
a
 =ğ
DyÇmic
 || ()
b
 == Dynamic) ? Dynamic \

262 : (()
a
 <ğ()
b
è? (ï : ()b)

	)

263 
	#EIGEN_ENUM_MAX
(
a
,
b
è(((ï >ğ()bè? (ï : ()b)

	)

266 
	#EIGEN_EMPTY


	)

269 
	#EIGEN_CAT2
(
a
,
b
è¨## 
	)
b

270 
	#EIGEN_CAT
(
a
,
b
è
	`EIGEN_CAT2
×,b)

	)

273 
	#EIGEN_MAKESTRING2
(
a
è#a

	)

274 
	#EIGEN_MAKESTRING
(
a
è
	`EIGEN_MAKESTRING2
×)

	)

	@robot/Eigen/src/Core/util/Memory.h

27 #iâdeà
EIGEN_MEMORY_H


28 
	#EIGEN_MEMORY_H


	)

34 #ià
defšed
(
__F»eBSD__
è&& !defšed(
__¬m__
è&& !defšed(
__ms__
)

35 
	#EIGEN_FREEBSD_MALLOC_ALREADY_ALIGNED
 1

	)

37 
	#EIGEN_FREEBSD_MALLOC_ALREADY_ALIGNED
 0

	)

40 #ià
defšed
(
__APPLE__
è|| defšed(
_WIN64
è|| 
EIGEN_FREEBSD_MALLOC_ALREADY_ALIGNED


41 
	#EIGEN_MALLOC_ALREADY_ALIGNED
 1

	)

43 
	#EIGEN_MALLOC_ALREADY_ALIGNED
 0

	)

46 #ià(
defšed
 
__QNXNTO__
è|| (((defšed 
_GNU_SOURCE
è|| ((defšed 
_XOPEN_SOURCE
è&& (_XOPEN_SOURCE >ğ600))è&& (defšed 
_POSIX_ADVISORY_INFO
) && (_POSIX_ADVISORY_INFO > 0))

47 
	#EIGEN_HAS_POSIX_MEMALIGN
 1

	)

49 
	#EIGEN_HAS_POSIX_MEMALIGN
 0

	)

52 #ifdeà
EIGEN_VECTORIZE_SSE


53 
	#EIGEN_HAS_MM_MALLOC
 1

	)

55 
	#EIGEN_HAS_MM_MALLOC
 0

	)

62 
šlše
 * 
	$ei_hªdmade_®igÃd_m®loc
(
¡d
::
size_t
 
size
)

64 *
Üigš®
 = 
¡d
::
	`m®loc
(
size
+16);

65 *
®igÃd
 = 
»š‹½»t_ÿ¡
<*>(Ôeš‹½»t_ÿ¡<
¡d
::
size_t
>(
Üigš®
è& ~(¡d::
	`size_t
(15))) + 16);

66 *(
»š‹½»t_ÿ¡
<**>(
®igÃd
è- 1èğ
Üigš®
;

67  
®igÃd
;

68 
	}
}

71 
šlše
 
	$ei_hªdmade_®igÃd_ä“
(*
±r
)

73 if(
±r
)

74 
¡d
::
	`ä“
(*(
»š‹½»t_ÿ¡
<**>(
±r
) - 1));

75 
	}
}

80 
šlše
 * 
	$ei_®igÃd_m®loc
(
¡d
::
size_t
 
size
)

82 #ifdeà
EIGEN_NO_MALLOC


83 
	`ei_as£¹
(
çl£
 && "heap‡llocation is forbidden (EIGEN_NO_MALLOC is defined)");

86 *
»suÉ
;

87 #ià!
EIGEN_ALIGN


88 
»suÉ
 = 
¡d
::
	`m®loc
(
size
);

89 #–ià
EIGEN_MALLOC_ALREADY_ALIGNED


90 
»suÉ
 = 
¡d
::
	`m®loc
(
size
);

91 #–ià
EIGEN_HAS_POSIX_MEMALIGN


92 if(
	`posix_mem®ign
(&
»suÉ
, 16, 
size
))„esult = 0;

93 #–ià
EIGEN_HAS_MM_MALLOC


94 
»suÉ
 = 
	`_mm_m®loc
(
size
, 16);

95 #–ià(
defšed
 
_MSC_VER
)

96 
»suÉ
 = 
	`_®igÃd_m®loc
(
size
, 16);

98 
»suÉ
 = 
	`ei_hªdmade_®igÃd_m®loc
(
size
);

101 #ifdeà
EIGEN_EXCEPTIONS


102 if(
»suÉ
 == 0)

103 
throw
 
¡d
::
	`bad_®loc
();

105  
»suÉ
;

106 
	}
}

111 
	g‹m¶©e
<
boŞ
 
	gAlign
> 
šlše
 * 
	$ei_cÚd™iÚ®_®igÃd_m®loc
(
¡d
::
size_t
 
size
)

113  
	`ei_®igÃd_m®loc
(
size
);

114 
	}
}

116 
	g‹m¶©e
<> 
šlše
 * 
	gei_cÚd™iÚ®_®igÃd_m®loc
<
	gçl£
>(
	g¡d
::
size_t
 
size
)

118 #ifdeà
EIGEN_NO_MALLOC


119 
ei_as£¹
(
çl£
 && "heap‡llocation is forbidden (EIGEN_NO_MALLOC is defined)");

122 *
	g»suÉ
 = 
¡d
::
m®loc
(
size
);

123 #ifdeà
EIGEN_EXCEPTIONS


124 if(!
	g»suÉ
è
throw
 
	g¡d
::
bad_®loc
();

126  
	g»suÉ
;

132 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
* 
	$ei_cÚ¡ruù_–em’ts_of_¬¿y
(
T
 *
±r
, 
¡d
::
size_t
 
size
)

134 
¡d
::
size_t
 
i
=0; i < 
size
; ++iè::
	`Ãw
 (
±r
 + iè
T
;

135  
±r
;

136 
	}
}

142 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
* 
	$ei_®igÃd_Ãw
(
¡d
::
size_t
 
size
)

144 
T
 *
»suÉ
 = 
»š‹½»t_ÿ¡
<T*>(
	`ei_®igÃd_m®loc
((T)*
size
));

145  
	`ei_cÚ¡ruù_–em’ts_of_¬¿y
(
»suÉ
, 
size
);

146 
	}
}

148 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gAlign
> 
šlše
 
T
* 
	$ei_cÚd™iÚ®_®igÃd_Ãw
(
¡d
::
size_t
 
size
)

150 
T
 *
»suÉ
 = 
»š‹½»t_ÿ¡
<T*>(
ei_cÚd™iÚ®_®igÃd_m®loc
<
Align
>((T)*
size
));

151  
	`ei_cÚ¡ruù_–em’ts_of_¬¿y
(
»suÉ
, 
size
);

152 
	}
}

156 
šlše
 
	$ei_®igÃd_ä“
(*
±r
)

158 #ià!
EIGEN_ALIGN


159 
¡d
::
	`ä“
(
±r
);

160 #–ià
EIGEN_MALLOC_ALREADY_ALIGNED


161 
¡d
::
	`ä“
(
±r
);

162 #–ià
EIGEN_HAS_POSIX_MEMALIGN


163 
¡d
::
	`ä“
(
±r
);

164 #–ià
EIGEN_HAS_MM_MALLOC


165 
	`_mm_ä“
(
±r
);

166 #–ià
	`defšed
(
_MSC_VER
)

167 
	`_®igÃd_ä“
(
±r
);

169 
	`ei_hªdmade_®igÃd_ä“
(
±r
);

171 
	}
}

175 
	g‹m¶©e
<
boŞ
 
	gAlign
> 
šlše
 
	$ei_cÚd™iÚ®_®igÃd_ä“
(*
±r
)

177 
	`ei_®igÃd_ä“
(
±r
);

178 
	}
}

180 
	g‹m¶©e
<> 
šlše
 
	gei_cÚd™iÚ®_®igÃd_ä“
<
	gçl£
>(*
	g±r
)

182 
	g¡d
::
ä“
(
±r
);

188 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
	$ei_de¡ruù_–em’ts_of_¬¿y
(
T
 *
±r
, 
¡d
::
size_t
 
size
)

191 if(
±r
)

192 
size
è
±r
[--size].~
	`T
();

193 
	}
}

198 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
	$ei_®igÃd_d–‘e
(
T
 *
±r
, 
¡d
::
size_t
 
size
)

200 
ei_de¡ruù_–em’ts_of_¬¿y
<
T
>(
±r
, 
size
);

201 
	`ei_®igÃd_ä“
(
±r
);

202 
	}
}

207 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gAlign
> 
šlše
 
	$ei_cÚd™iÚ®_®igÃd_d–‘e
(
T
 *
±r
, 
¡d
::
size_t
 
size
)

209 
ei_de¡ruù_–em’ts_of_¬¿y
<
T
>(
±r
, 
size
);

210 
ei_cÚd™iÚ®_®igÃd_ä“
<
Align
>(
±r
);

211 
	}
}

229 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gIÁeg”
>

230 
šlše
 
IÁeg”
 
	$ei_®ignm’tOff£t
(cÚ¡ 
SÿÏr
* 
¬¿y
, 
IÁeg”
 
size
)

232 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘
;

233 ’um { 
Pack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
,

234 
Pack‘AligÃdMask
 = 
Pack‘Size
-1

237 if(
Pack‘Size
==1)

243 if(
¡d
::
	`size_t
(
¬¿y
è& ((
SÿÏr
)-1))

247  
size
;

251  
¡d
::
mš
<
IÁeg”
>Ğ(
Pack‘Size
 - (
	`IÁeg”
((¡d::
	`size_t
(
¬¿y
)/(
SÿÏr
))è& 
Pack‘AligÃdMask
))

252 & 
Pack‘AligÃdMask
, 
size
);

254 
	}
}

267 #ifdeà
__lšux__


268 
	#ei_®igÃd_¡ack_®loc
(
SIZE
è(SIZE<=
EIGEN_STACK_ALLOCATION_LIMIT
) \

269 ? 
	`®loÿ
(
SIZE
) \

270 : 
	`ei_®igÃd_m®loc
(
SIZE
)

	)

271 
	#ei_®igÃd_¡ack_ä“
(
PTR
,
SIZE
èif(SIZE>
EIGEN_STACK_ALLOCATION_LIMIT
è
	`ei_®igÃd_ä“
(PTR)

	)

273 
	#ei_®igÃd_¡ack_®loc
(
SIZE
è
	`ei_®igÃd_m®loc
(SIZE)

	)

274 
	#ei_®igÃd_¡ack_ä“
(
PTR
,
SIZE
è
	`ei_®igÃd_ä“
(PTR)

	)

277 
	#ei_®igÃd_¡ack_Ãw
(
TYPE
,
SIZE
è
	`ei_cÚ¡ruù_–em’ts_of_¬¿y
(
»š‹½»t_ÿ¡
<TYPE*>(
	`ei_®igÃd_¡ack_®loc
((TYPE)*SIZE)), SIZE)

	)

278 
	#ei_®igÃd_¡ack_d–‘e
(
TYPE
,
PTR
,
SIZE
èdØ{
ei_de¡ruù_–em’ts_of_¬¿y
<TYPE>(PTR, SIZE); \

279 
	`ei_®igÃd_¡ack_ä“
(
PTR
,(
TYPE
)*
SIZE
);} 0)

	)

282 #ià
EIGEN_ALIGN


283 #ifdeà
EIGEN_EXCEPTIONS


284 
	#EIGEN_MAKE_ALIGNED_OPERATOR_NEW_NOTHROW
(
N“dsToAlign
) \

285 * 
İ”©Ü
 
	`Ãw
(
¡d
::
size_t
 
size
, cÚ¡ std::
nÙhrow_t
&è
	`throw
() { \

286 
Œy
 {  
Eig’
::
ei_cÚd™iÚ®_®igÃd_m®loc
<
N“dsToAlign
>(
size
); } \

287 
	`ÿtch
 (...) {  0; } \

289 }

	)

291 
	#EIGEN_MAKE_ALIGNED_OPERATOR_NEW_NOTHROW
(
N“dsToAlign
) \

292 * 
İ”©Ü
 
	`Ãw
(
¡d
::
size_t
 
size
, cÚ¡ std::
nÙhrow_t
&è
	`throw
() { \

293  
Eig’
::
ei_cÚd™iÚ®_®igÃd_m®loc
<
N“dsToAlign
>(
size
); \

294 }

	)

297 
	#EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF
(
N“dsToAlign
) \

298 *
İ”©Ü
 
	`Ãw
(
¡d
::
size_t
 
size
) { \

299  
Eig’
::
ei_cÚd™iÚ®_®igÃd_m®loc
<
N“dsToAlign
>(
size
); \

301 *
İ”©Ü
 
Ãw
[](
¡d
::
size_t
 
size
) { \

302  
Eig’
::
ei_cÚd™iÚ®_®igÃd_m®loc
<
N“dsToAlign
>(
size
); \

304 
İ”©Ü
 
	`d–‘e
(* 
±r
è
	`throw
(è{ 
Eig’
::
ei_cÚd™iÚ®_®igÃd_ä“
<
N“dsToAlign
>(ptr); } \

305 
İ”©Ü
 
d–‘e
[](* 
±r
è
	`throw
(è{ 
Eig’
::
ei_cÚd™iÚ®_®igÃd_ä“
<
N“dsToAlign
>(ptr); } \

309 *
İ”©Ü
 
	`Ãw
(
¡d
::
size_t
 
size
, *
±r
) {  ::operator‚ew(size,ptr); } \

310 
İ”©Ü
 
	`d–‘e
(* 
memÜy
, *
±r
è
	`throw
() {  ::operator delete(memory,ptr); } \

312 
	`EIGEN_MAKE_ALIGNED_OPERATOR_NEW_NOTHROW
(
N“dsToAlign
) \

313 
İ”©Ü
 
	`d–‘e
(*
±r
, cÚ¡ 
¡d
::
nÙhrow_t
&è
	`throw
() { \

314 
Eig’
::
ei_cÚd™iÚ®_®igÃd_ä“
<
N“dsToAlign
>(
±r
); \

316 
	tei_İ”©Ü_Ãw_m¬k”_ty³
;

	)

318 
	#EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF
(
N“dsToAlign
)

	)

321 
	#EIGEN_MAKE_ALIGNED_OPERATOR_NEW
 
	`EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF
(
Œue
)

	)

322 
	#EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
SÿÏr
,
Size
) \

323 
	`EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF
(((
Size
)!=
Eig’
::
DyÇmic
è&& (((
SÿÏr
)*(Size))%16==0))

	)

339 
	g‹m¶©e
<
şass
 
	gT
>

340 şas 
	c®igÃd_®loÿtÜ


342 
	mpublic
:

343 
¡d
::
	tsize_t
 
	tsize_ty³
;

344 
	m¡d
::
	t±rdiff_t
 
	tdifã»nû_ty³
;

345 
T
* 
	tpoš‹r
;

346 cÚ¡ 
	tT
* 
	tcÚ¡_poš‹r
;

347 
	mT
& 
	t»ã»nû
;

348 cÚ¡ 
	tT
& 
	tcÚ¡_»ã»nû
;

349 
T
 
	tv®ue_ty³
;

351 
	m‹m¶©e
<
şass
 
	mU
>

352 
	s»bšd


354 
	m®igÃd_®loÿtÜ
<
	tU
> 
	tÙh”
;

357 
poš‹r
 
	$add»ss
Ğ
»ã»nû
 
v®ue
 ) const

359  &
v®ue
;

360 
	}
}

362 
cÚ¡_poš‹r
 
	$add»ss
Ğ
cÚ¡_»ã»nû
 
v®ue
 ) const

364  &
v®ue
;

365 
	}
}

367 
	$®igÃd_®loÿtÜ
(è
	$throw
()

369 
	}
}

371 
	$®igÃd_®loÿtÜ
ĞcÚ¡ 
®igÃd_®loÿtÜ
& ) 
	$throw
()

373 
	}
}

375 
	g‹m¶©e
<
şass
 
	gU
>

376 
®igÃd_®loÿtÜ
ĞcÚ¡‡ligÃd_®loÿtÜ<
U
>& ) 
	$throw
()

378 
	}
}

380 ~
	$®igÃd_®loÿtÜ
(è
	$throw
()

382 
	}
}

384 
size_ty³
 
	$max_size
(ècÚ¡ 
	$throw
()

386  
¡d
::
num”ic_lim™s
<
size_ty³
>::
	`max
();

387 
	}
}

389 
poš‹r
 
	$®loÿ‹
Ğ
size_ty³
 
num
, 
cÚ¡_poš‹r
* 
hšt
 = 0 )

391 
¡©ic_ÿ¡
<>Ğ
hšt
 );

392  
¡©ic_ÿ¡
<
poš‹r
>Ğ
	`ei_®igÃd_m®loc
Ğ
num
 * (
T
) ) );

393 
	}
}

395 
	$cÚ¡ruù
Ğ
poš‹r
 
p
, cÚ¡ 
T
& 
v®ue
 )

397 ::
	`Ãw
Ğ
p
 ) 
	`T
Ğ
v®ue
 );

398 
	}
}

400 
	$de¡roy
Ğ
poš‹r
 
p
 )

402 
p
->~
	`T
();

403 
	}
}

405 
	$d—Îoÿ‹
Ğ
poš‹r
 
p
, 
size_ty³
 )

407 
	`ei_®igÃd_ä“
Ğ
p
 );

408 
	}
}

410 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
®igÃd_®loÿtÜ
<
T
>& 
Ùh”
) const

411 {  
çl£
; }

413 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
®igÃd_®loÿtÜ
<
T
>& 
Ùh”
) const

414 {  
Œue
; }

	@robot/Eigen/src/Core/util/Meta.h

26 #iâdeà
EIGEN_META_H


27 
	#EIGEN_META_H


	)

36 
	sei_m‘a_Œue
 {ƒnum { 
	m»t
 = 1 }; };

37 
	sei_m‘a_çl£
 {ƒnum { 
	m»t
 = 0 }; };

39 
	g‹m¶©e
<
boŞ
 
	gCÚd™iÚ
, 
ty³Çme
 
	gTh’
,y³Çm
	gEl£
>

40 
	sei_m‘a_if
 { 
Th’
 
	t»t
; };

42 
	g‹m¶©e
<
ty³Çme
 
	gTh’
,y³Çm
	gEl£
>

43 
	gei_m‘a_if
 <
	gçl£
, 
	gTh’
, 
	gEl£
> { 
El£
 
	t»t
; };

45 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gU
> 
	sei_is_§me_ty³
 {ƒnum { 
	m»t
 = 0 }; };

46 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_is_§me_ty³
<T,T> {ƒnum { 
	g»t
 = 1 }; };

48 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_uÄef
 { 
T
 
	tty³
; };

49 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_uÄef
<T&> { 
T
 
	tty³
; };

51 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_uÅoš‹r
 { 
T
 
	tty³
; };

52 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_uÅoš‹r
<T*> { 
T
 
	tty³
; };

53 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_uÅoš‹r
<
T
*cÚ¡> { T 
	tty³
; };

55 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_uncÚ¡
 { 
T
 
	tty³
; };

56 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_uncÚ¡
<cÚ¡ T> { 
T
 
	tty³
; };

57 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_uncÚ¡
<
T
 cÚ¡ &> { T & 
	tty³
; };

58 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_uncÚ¡
<
T
 cÚ¡ *> { T * 
	tty³
; };

60 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_ş—Áy³
 { 
T
 
	tty³
; };

61 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_ş—Áy³
<cÚ¡ T> { ty³Çm
	tei_ş—Áy³
<
	tT
>::
	tty³
ype; };

62 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_ş—Áy³
<cÚ¡ T&> { ty³Çm
	tei_ş—Áy³
<
	tT
>::
	tty³
ype; };

63 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_ş—Áy³
<T&> { ty³Çm
	tei_ş—Áy³
<
	tT
>::
	tty³
ype; };

64 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_ş—Áy³
<cÚ¡ T*> { ty³Çm
	tei_ş—Áy³
<
	tT
>::
	tty³
ype; };

65 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_ş—Áy³
<T*> { ty³Çm
	tei_ş—Áy³
<
	tT
>::
	tty³
ype; };

74 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_»suÉ_of
 {};

76 
	sei_has_nÚe
 {
	ma
[1];};

77 
	sei_has_¡d_»suÉ_ty³
 {
	ma
[2];};

78 
	sei_has_Œ1_»suÉ
 {
	ma
[3];};

80 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³
, 
	gSizeOf
=(
ei_has_nÚe
)>

81 
	sei_uÇry_»suÉ_of_£Ëù
 {
ArgTy³
 
	tty³
;};

83 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³
>

84 
	gei_uÇry_»suÉ_of_£Ëù
<
	gFunc
, 
	gArgTy³
, (
	gei_has_¡d_»suÉ_ty³
)> {
ty³Çme
 
	tFunc
::
	t»suÉ_ty³
 
	tty³
;};

86 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³
>

87 
	gei_uÇry_»suÉ_of_£Ëù
<
	gFunc
, 
	gArgTy³
, (
	gei_has_Œ1_»suÉ
)> {
ty³Çme
 
	tFunc
::
	t‹m¶©e
 
	t»suÉ
<Func(
	tArgTy³
)>::
	tty³
ype;};

89 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³
>

90 
	gei_»suÉ_of
<
Func
(
ArgTy³
)> {

91 
	g‹m¶©e
<
ty³Çme
 
	gT
>

92 
ei_has_¡d_»suÉ_ty³
 
‹¡FunùÜ
(
T
 cÚ¡ *, 
ty³Çme
 T::
»suÉ_ty³
 const * = 0);

93 
	g‹m¶©e
<
ty³Çme
 
	gT
>

94 
ei_has_Œ1_»suÉ
 
‹¡FunùÜ
(
T
 cÚ¡ *, 
ty³Çme
 T::
‹m¶©e
 
»suÉ
<T(
ArgTy³
)>::
ty³
 const * = 0);

95 
ei_has_nÚe
 
‹¡FunùÜ
(...);

98 ’um {
	gFunùÜTy³
 = (
‹¡FunùÜ
(
¡©ic_ÿ¡
<
Func
*>(0)))};

99 
ty³Çme
 
	tei_uÇry_»suÉ_of_£Ëù
<
	tFunc
, 
	tArgTy³
, 
	tFunùÜTy³
>::
	tty³
ype;

102 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³0
,y³Çm
	gArgTy³1
, 
	gSizeOf
=(
ei_has_nÚe
)>

103 
	sei_bš¬y_»suÉ_of_£Ëù
 {
ArgTy³0
 
	tty³
;};

105 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³0
,y³Çm
	gArgTy³1
>

106 
	gei_bš¬y_»suÉ_of_£Ëù
<
	gFunc
, 
	gArgTy³0
, 
	gArgTy³1
, (
	gei_has_¡d_»suÉ_ty³
)>

107 {
ty³Çme
 
	tFunc
::
	t»suÉ_ty³
 
	tty³
;};

109 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³0
,y³Çm
	gArgTy³1
>

110 
	gei_bš¬y_»suÉ_of_£Ëù
<
	gFunc
, 
	gArgTy³0
, 
	gArgTy³1
, (
	gei_has_Œ1_»suÉ
)>

111 {
ty³Çme
 
	tFunc
::
	t‹m¶©e
 
	t»suÉ
<Func(
	tArgTy³0
,
	tArgTy³1
)>::
	tty³
ype;};

113 
	g‹m¶©e
<
ty³Çme
 
	gFunc
,y³Çm
	gArgTy³0
,y³Çm
	gArgTy³1
>

114 
	gei_»suÉ_of
<
Func
(
ArgTy³0
,
ArgTy³1
)> {

115 
	g‹m¶©e
<
ty³Çme
 
	gT
>

116 
ei_has_¡d_»suÉ_ty³
 
‹¡FunùÜ
(
T
 cÚ¡ *, 
ty³Çme
 T::
»suÉ_ty³
 const * = 0);

117 
	g‹m¶©e
<
ty³Çme
 
	gT
>

118 
ei_has_Œ1_»suÉ
 
‹¡FunùÜ
(
T
 cÚ¡ *, 
ty³Çme
 T::
‹m¶©e
 
»suÉ
<T(
ArgTy³0
,
ArgTy³1
)>::
ty³
 const * = 0);

119 
ei_has_nÚe
 
‹¡FunùÜ
(...);

122 ’um {
	gFunùÜTy³
 = (
‹¡FunùÜ
(
¡©ic_ÿ¡
<
Func
*>(0)))};

123 
ty³Çme
 
	tei_bš¬y_»suÉ_of_£Ëù
<
	tFunc
, 
	tArgTy³0
, 
	tArgTy³1
, 
	tFunùÜTy³
>::
	tty³
ype;

129 
	g‹m¶©e
<
	gY
,

130 
	gInfX
 = 0,

131 
	gSupX
 = ((
Y
==1) ? 1 : Y/2),

132 
boŞ
 
	gDÚe
 = ((
SupX
-
InfX
)<=1 ? 
Œue
 : ((SupX*SupX <ğ
Y
) && ((SupX+1)*(SupX+1) > Y))) >

134 şas 
	cei_m‘a_sq¹


137 
MidX
 = (
InfX
+
SupX
)/2,

138 
	mTakeInf
 = 
MidX
*MidX > 
Y
 ? 1 : 0,

139 
	mNewInf
 = (
TakeInf
è? 
InfX
 : (
MidX
),

140 
	mNewSup
 = (
TakeInf
è? (
MidX
è: 
SupX


142 
	gpublic
:

143 ’um { 
»t
 = 
ei_m‘a_sq¹
<
Y
,
	gNewInf
,
	gNewSup
>::ret };

146 
	g‹m¶©e
<
	gY
, 
	gInfX
, 
	gSupX
>

147 
şass
 
	gei_m‘a_sq¹
<
	gY
, 
	gInfX
, 
	gSupX
, 
	gŒue
> { 
	gpublic
:ƒnum { 
»t
 = (
SupX
*SupX <ğ
Y
è? SupX : 
InfX
 }; };

150 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gU
> 
	sei_sÿÏr_´oduù_Œa™s


154 
T
 
	tR‘uºTy³
;

157 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_sÿÏr_´oduù_Œa™s
<T,T>

160 
T
 
	tR‘uºTy³
;

163 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_sÿÏr_´oduù_Œa™s
<T,
	g¡d
::
com¶ex
<
T
> >

166 
¡d
::
	tcom¶ex
<
	tT
> 
	tR‘uºTy³
;

169 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_sÿÏr_´oduù_Œa™s
<
	g¡d
::
com¶ex
<
T
>, T>

172 
	g¡d
::
	tcom¶ex
<
	tT
> 
	tR‘uºTy³
;

176 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gArgTy³0
,y³Çm
	gArgTy³1
>

177 
	gei_»suÉ_of
<
	gei_sÿÏr_´oduù_İ
<
	gSÿÏr
>(
	gArgTy³0
,
	gArgTy³1
)> {

178 
ty³Çme
 
	tei_sÿÏr_´oduù_Œa™s
<
	tty³Çme
 
	tei_ş—Áy³
<
	tArgTy³0
>::
	tty³
,y³Çmei_ş—Áy³<
	tArgTy³1
>::ty³>::
	tR‘uºTy³
ype;

	@robot/Eigen/src/Core/util/StaticAssert.h

26 #iâdeà
EIGEN_STATIC_ASSERT_H


27 
	#EIGEN_STATIC_ASSERT_H


	)

42 #iâdeà
EIGEN_NO_STATIC_ASSERT


44 #ifdeà
__GXX_EXPERIMENTAL_CXX0X__


47 
	#EIGEN_STATIC_ASSERT
(
X
,
MSG
è
	`¡©ic_as£¹
(X,#MSG);

	)

51 
	g‹m¶©e
<
boŞ
 
	gcÚd™iÚ
>

52 
	sei_¡©ic_as£¹
 {};

54 
	g‹m¶©e
<>

55 
	gei_¡©ic_as£¹
<
	gŒue
>

58 
	gYOU_TRIED_CALLING_A_VECTOR_METHOD_ON_A_MATRIX
,

59 
	gYOU_MIXED_VECTORS_OF_DIFFERENT_SIZES
,

60 
	gYOU_MIXED_MATRICES_OF_DIFFERENT_SIZES
,

61 
	gTHIS_METHOD_IS_ONLY_FOR_VECTORS_OF_A_SPECIFIC_SIZE
,

62 
	gTHIS_METHOD_IS_ONLY_FOR_MATRICES_OF_A_SPECIFIC_SIZE
,

63 
	gYOU_MADE_A_PROGRAMMING_MISTAKE
,

64 
	gYOU_CALLED_A_FIXED_SIZE_METHOD_ON_A_DYNAMIC_SIZE_MATRIX_OR_VECTOR
,

65 
	gUNALIGNED_LOAD_AND_STORE_OPERATIONS_UNIMPLEMENTED_ON_ALTIVEC
,

66 
	gNUMERIC_TYPE_MUST_BE_FLOATING_POINT
,

67 
	gCOEFFICIENT_WRITE_ACCESS_TO_SELFADJOINT_NOT_SUPPORTED
,

68 
	gWRITING_TO_TRIANGULAR_PART_WITH_UNIT_DIAGONAL_IS_NOT_SUPPORTED
,

69 
	gTHIS_METHOD_IS_ONLY_FOR_FIXED_SIZE
,

70 
	gINVALID_MATRIX_PRODUCT
,

71 
	gINVALID_VECTOR_VECTOR_PRODUCT__IF_YOU_WANTED_A_DOT_OR_COEFF_WISE_PRODUCT_YOU_MUST_USE_THE_EXPLICIT_FUNCTIONS
,

72 
	gINVALID_MATRIX_PRODUCT__IF_YOU_WANTED_A_COEFF_WISE_PRODUCT_YOU_MUST_USE_THE_EXPLICIT_FUNCTION
,

73 
	gYOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
,

74 
	gTHIS_METHOD_IS_ONLY_FOR_COLUMN_MAJOR_MATRICES
,

75 
	gTHIS_METHOD_IS_ONLY_FOR_ROW_MAJOR_MATRICES
,

76 
	gINVALID_MATRIX_TEMPLATE_PARAMETERS
,

77 
	gINVALID_MATRIXBASE_TEMPLATE_PARAMETERS
,

78 
	gBOTH_MATRICES_MUST_HAVE_THE_SAME_STORAGE_ORDER
,

79 
	gTHIS_METHOD_IS_ONLY_FOR_DIAGONAL_MATRIX


86 #ifdeà
_MSC_VER


88 
	#EIGEN_STATIC_ASSERT
(
CONDITION
,
MSG
) \

89 {
Eig’
::
ei_¡©ic_as£¹
<
CONDITION
 ? 
Œue
 : 
çl£
>::
MSG
;}

	)

93 
	#EIGEN_STATIC_ASSERT
(
CONDITION
,
MSG
) \

94 ià(
Eig’
::
ei_¡©ic_as£¹
<
CONDITION
 ? 
Œue
 : 
çl£
>::
MSG
è{}

	)

102 
	#EIGEN_STATIC_ASSERT
(
CONDITION
,
MSG
è
	`ei_as£¹
((CONDITIONè&& #MSG);

	)

108 
	#EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
TYPE
) \

109 
	`EIGEN_STATIC_ASSERT
(
TYPE
::
IsVeùÜAtCompeTime
, \

110 
YOU_TRIED_CALLING_A_VECTOR_METHOD_ON_A_MATRIX
)

	)

113 
	#EIGEN_STATIC_ASSERT_FIXED_SIZE
(
TYPE
) \

114 
	`EIGEN_STATIC_ASSERT
(
TYPE
::
SizeAtCompeTime
!=
Eig’
::
DyÇmic
, \

115 
YOU_CALLED_A_FIXED_SIZE_METHOD_ON_A_DYNAMIC_SIZE_MATRIX_OR_VECTOR
)

	)

118 
	#EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
TYPE
, 
SIZE
) \

119 
	`EIGEN_STATIC_ASSERT
(
TYPE
::
IsVeùÜAtCompeTime
 && TYPE::
SizeAtCompeTime
==
SIZE
, \

120 
THIS_METHOD_IS_ONLY_FOR_VECTORS_OF_A_SPECIFIC_SIZE
)

	)

123 
	#EIGEN_STATIC_ASSERT_MATRIX_SPECIFIC_SIZE
(
TYPE
, 
ROWS
, 
COLS
) \

124 
	`EIGEN_STATIC_ASSERT
(
TYPE
::
RowsAtCompeTime
==
ROWS
 && TYPE::
CŞsAtCompeTime
==
COLS
, \

125 
THIS_METHOD_IS_ONLY_FOR_MATRICES_OF_A_SPECIFIC_SIZE
)

	)

128 
	#EIGEN_STATIC_ASSERT_SAME_VECTOR_SIZE
(
TYPE0
,
TYPE1
) \

129 
	`EIGEN_STATIC_ASSERT
( \

130 ((
TYPE0
::
SizeAtCompeTime
)==
Eig’
::
DyÇmic
 \

131 || (
TYPE1
::
SizeAtCompeTime
)==
Eig’
::
DyÇmic
 \

132 || (
TYPE0
::
SizeAtCompeTime
)==(
TYPE1
::SizeAtCompileTime)),\

133 
YOU_MIXED_VECTORS_OF_DIFFERENT_SIZES
)

	)

135 
	#EIGEN_PREDICATE_SAME_MATRIX_SIZE
(
TYPE0
,
TYPE1
) \

136 (((
TYPE0
::
RowsAtCompeTime
)==
Eig’
::
DyÇmic
 \

137 || (
TYPE1
::
RowsAtCompeTime
)==
Eig’
::
DyÇmic
 \

138 || (
TYPE0
::
RowsAtCompeTime
)==(
TYPE1
::RowsAtCompileTime)) \

139 && ((
TYPE0
::
CŞsAtCompeTime
)==
Eig’
::
DyÇmic
 \

140 || (
TYPE1
::
CŞsAtCompeTime
)==
Eig’
::
DyÇmic
 \

141 || (
TYPE0
::
CŞsAtCompeTime
)==(
TYPE1
::CŞsAtCompeTime)))

	)

144 
	#EIGEN_STATIC_ASSERT_SAME_MATRIX_SIZE
(
TYPE0
,
TYPE1
) \

145 
	`EIGEN_STATIC_ASSERT
( \

146 
	`EIGEN_PREDICATE_SAME_MATRIX_SIZE
(
TYPE0
,
TYPE1
),\

147 
YOU_MIXED_MATRICES_OF_DIFFERENT_SIZES
)

	)

	@robot/Eigen/src/Core/util/XprHelper.h

26 #iâdeà
EIGEN_XPRHELPER_H


27 
	#EIGEN_XPRHELPER_H


	)

30 #ifdeà
__GNUG__


31 
	sei_em±y_¡ruù
{
	m_ei_dummy_
;};

32 
	#EIGEN_EMPTY_STRUCT
 : 
Eig’
::
ei_em±y_¡ruù


	)

34 
	#EIGEN_EMPTY_STRUCT


	)

38 şas 
	cei_no_assignm’t_İ”©Ü


40 #ià
EIGEN_GCC3_OR_OLDER


41 
	m´Ùeùed
:

42 
Ãv”mšd_this_is_ju¡_to_wÜk_¬ound_a_¡upid_gcc3_w¬nšg
();

44 
	m´iv©e
:

45 
ei_no_assignm’t_İ”©Ü
& 
İ”©Ü
=(constƒi_no_assignment_operator&);

52 
	g‹m¶©e
<
	gV®ue
> cÏs 
	cei_št_if_dyÇmic
 
	mEIGEN_EMPTY_STRUCT


54 
	mpublic
:

55 
	$ei_št_if_dyÇmic
() {}

56 
ex¶ic™
 
	$ei_št_if_dyÇmic
(è{
	}
}

57 
	$v®ue
(è{  
V®ue
; 
	}
}

58 
	$£tV®ue
(è{
	}
}

61 
	g‹m¶©e
<> 
şass
 
	gei_št_if_dyÇmic
<
	gDyÇmic
>

63 
	gm_v®ue
;

64 
ei_št_if_dyÇmic
() {}

65 
	gpublic
:

66 
ex¶ic™
 
ei_št_if_dyÇmic
(
v®ue
è: 
m_v®ue
(value) {}

67 
v®ue
(ècÚ¡ {  
m_v®ue
; }

68 
£tV®ue
(
v®ue
è{ 
	gm_v®ue
 = value; }

71 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_funùÜ_Œa™s


75 
	mCo¡
 = 10,

76 
	mPack‘Acûss
 = 
çl£


80 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_·ck‘_Œa™s


82 
T
 
	tty³
;

83 ’um {
	msize
=1};

86 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_uÅack‘_Œa™s


88 
T
 
	tty³
;

89 ’um {
	msize
=1};

92 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gRows
, 
	gCŞs
, 
	gO±iÚs
, 
	gMaxRows
, 
	gMaxCŞs
>

93 şas 
	cei_compu‹_m©rix_æags


96 
	mrow_majÜ_b™
 = 
O±iÚs
&
RowMajÜ
 ? 
RowMajÜB™
 : 0,

97 
	mšÃr_max_size
 = (
MaxRows
==1è? (
MaxCŞs
)

98 : (
MaxCŞs
==1è? (
MaxRows
)

99 : (
row_majÜ_b™
è? (
MaxCŞs
è: (
MaxRows
),

100 
	mis_big
 = 
šÃr_max_size
 =ğ
DyÇmic
,

101 
	m¡Üage_has_fixed_size
 = 
MaxRows
 !ğ
DyÇmic
 && 
MaxCŞs
 != Dynamic,

102 
	m¡Üage_has_®igÃd_fixed_size
 = 
¡Üage_has_fixed_size


103 && ( (
MaxCŞs
*
MaxRows
è% 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 == 0 ),

104 
	m®igÃd_b™
 = ( (
O±iÚs
&
AutoAlign
)

105 && (
is_big
 || 
¡Üage_has_®igÃd_fixed_size
)

106 è? 
AligÃdB™
 : 0,

107 
	m·ck‘_acûss_b™
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
 > 1 && 
®igÃd_b™
 ? 
Pack‘AcûssB™
 : 0

110 
	gpublic
:

111 ’um { 
»t
 = 
Lš—rAcûssB™
 | 
DœeùAcûssB™
 | 
·ck‘_acûss_b™
 | 
row_majÜ_b™
 | 
®igÃd_b™
 };

114 
	g‹m¶©e
<
	g_Rows
, 
	g_CŞs
> 
	sei_size_©_compe_time


116 ’um { 
	m»t
 = (
_Rows
==
DyÇmic
 || 
_CŞs
==Dynamic) ? Dynamic : _Rows * _Cols };

123 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gS·r£Ãss
 = 
ei_Œa™s
<
T
>::
FÏgs
&
S·r£B™
> 
şass
 
ei_ev®
;

125 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_ev®
<T,
	gIsD’£
>

127 
	gM©rix
<
	tty³Çme
 
	tei_Œa™s
<
	tT
>::
	tSÿÏr
,

128 
	tei_Œa™s
<
	tT
>::
	tRowsAtCompeTime
,

129 
	tei_Œa™s
<
	tT
>::
	tCŞsAtCompeTime
,

130 
	tAutoAlign
 | (
	tei_Œa™s
<
	tT
>::
	tFÏgs
&
	tRowMajÜB™
 ? 
	tRowMajÜ
 : 
	tCŞMajÜ
),

131 
	tei_Œa™s
<
	tT
>::
	tMaxRowsAtCompeTime
,

132 
	tei_Œa™s
<
	tT
>::
	tMaxCŞsAtCompeTime


133 > 
	tty³
;

137 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜageOrd”
, 
	g_MaxRows
, 
	g_MaxCŞs
>

138 
	gei_ev®
<
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜageOrd”
, 
	g_MaxRows
, 
	g_MaxCŞs
>, 
	gIsD’£
>

140 cÚ¡ 
	tM©rix
<
	t_SÿÏr
, 
	t_Rows
, 
	t_CŞs
, 
	t_StÜageOrd”
, 
	t_MaxRows
, 
	t_MaxCŞs
>& 
	tty³
;

146 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_¶aš_m©rix_ty³


148 
	mM©rix
<
	tty³Çme
 
	tei_Œa™s
<
	tT
>::
	tSÿÏr
,

149 
	tei_Œa™s
<
	tT
>::
	tRowsAtCompeTime
,

150 
	tei_Œa™s
<
	tT
>::
	tCŞsAtCompeTime
,

151 
	tAutoAlign
 | (
	tei_Œa™s
<
	tT
>::
	tFÏgs
&
	tRowMajÜB™
 ? 
	tRowMajÜ
 : 
	tCŞMajÜ
),

152 
	tei_Œa™s
<
	tT
>::
	tMaxRowsAtCompeTime
,

153 
	tei_Œa™s
<
	tT
>::
	tMaxCŞsAtCompeTime


154 > 
	tty³
;

159 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_¶aš_m©rix_ty³_cŞumn_majÜ


161 
	mM©rix
<
	tty³Çme
 
	tei_Œa™s
<
	tT
>::
	tSÿÏr
,

162 
	tei_Œa™s
<
	tT
>::
	tRowsAtCompeTime
,

163 
	tei_Œa™s
<
	tT
>::
	tCŞsAtCompeTime
,

164 
	tAutoAlign
 | 
	tCŞMajÜ
,

165 
	tei_Œa™s
<
	tT
>::
	tMaxRowsAtCompeTime
,

166 
	tei_Œa™s
<
	tT
>::
	tMaxCŞsAtCompeTime


167 > 
	tty³
;

172 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_¶aš_m©rix_ty³_row_majÜ


174 
	mM©rix
<
	tty³Çme
 
	tei_Œa™s
<
	tT
>::
	tSÿÏr
,

175 
	tei_Œa™s
<
	tT
>::
	tRowsAtCompeTime
,

176 
	tei_Œa™s
<
	tT
>::
	tCŞsAtCompeTime
,

177 
	tAutoAlign
 | 
	tRowMajÜ
,

178 
	tei_Œa™s
<
	tT
>::
	tMaxRowsAtCompeTime
,

179 
	tei_Œa™s
<
	tT
>::
	tMaxCŞsAtCompeTime


180 > 
	tty³
;

183 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sei_mu¡_Ã¡_by_v®ue
 {ƒnum { 
	m»t
 = 
çl£
 }; };

184 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gei_mu¡_Ã¡_by_v®ue
<
	gNe¡ByV®ue
<T> > {ƒnum { 
	g»t
 = 
Œue
 }; };

204 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gn
=1,y³Çm
	gPÏšM©rixTy³
 =y³Çm
ei_ev®
<
T
>::
ty³
> 
	sei_Ã¡ed


207 
Co¡Ev®
 = (
n
+1è* (
NumT¿™s
<
ty³Çme
 
ei_Œa™s
<
T
>::
SÿÏr
>::
R—dCo¡
),

208 
	mCo¡NoEv®
 = (
n
-1è* (
ei_Œa™s
<
T
>::
CÛffR—dCo¡
)

210 
ty³Çme
 
	tei_m‘a_if
<

211 
	tei_mu¡_Ã¡_by_v®ue
<
	tT
>::
	t»t
,

212 
	tT
,

213 
	tty³Çme
 
	tei_m‘a_if
<

214 ((
	tei_Œa™s
<
	tT
>::
	tFÏgs
è& 
	tEv®BefÜeNe¡šgB™
)

215 || ( (
	tCo¡Ev®
è<ğ(
	tCo¡NoEv®
) ),

216 
	tPÏšM©rixTy³
,

217 cÚ¡ 
	tT
&

218 >::
	t»t


219 >::
	t»t
 
	tty³
;

222 
	g‹m¶©e
<
	gFÏgs
> 
	sei_¬e_æags_cÚsi¡’t


224 ’um { 
	m»t
 = !Ğ(
FÏgs
&
Un™DŸgB™
 && FÏgs&
Z”oDŸgB™
) )

231 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gRowsOrSize
=
DyÇmic
, 
	gCŞs
=DyÇmic> 
	sBlockR‘uºTy³
 {

232 
Block
<
	tEx´essiÚTy³
, (
	tei_Œa™s
<Ex´essiÚTy³>::
	tRowsAtCompeTime
 =ğ1 ? 1 : 
	tRowsOrSize
),

233 (
	tei_Œa™s
<
	tEx´essiÚTy³
>::
	tCŞsAtCompeTime
 =ğ1 ? 1 : 
	tRowsOrSize
)> 
	tSubVeùÜTy³
;

234 
	mBlock
<
	tEx´essiÚTy³
, 
	tRowsOrSize
, 
	tCŞs
> 
	tTy³
;

237 
	g‹m¶©e
<
ty³Çme
 
	gCu¼’tTy³
,y³Çm
	gNewTy³
> 
	sei_ÿ¡_»tuº_ty³


239 
ty³Çme
 
	tei_m‘a_if
<
	tei_is_§me_ty³
<
	tCu¼’tTy³
,
	tNewTy³
>::
	t»t
,cÚ¡ Cu¼’tTy³&,NewTy³>::»ˆ
	tty³
;

	@robot/Eigen/src/Geometry/AlignedBox.h

25 #iâdeà
EIGEN_ALIGNEDBOX_H


26 
	#EIGEN_ALIGNEDBOX_H


	)

40 
	g‹m¶©e
 <
ty³Çme
 
	g_SÿÏr
, 
	g_Amb›ÁDim
>

41 şas 
	cAligÃdBox


43 
	mpublic
:

44 
EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
_SÿÏr
,
_Amb›ÁDim
==
DyÇmic
 ? Dynamic : _AmbientDim+1)

45 ’um { 
Amb›ÁDimAtCompeTime
 = 
_Amb›ÁDim
 };

46 
_SÿÏr
 
	tSÿÏr
;

47 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

48 
	gM©rix
<
	tSÿÏr
,
	tAmb›ÁDimAtCompeTime
,1> 
	tVeùÜTy³
;

51 
šlše
 
ex¶ic™
 
	$AligÃdBox
()

52 { ià(
Amb›ÁDimAtCompeTime
!=
DyÇmic
è
	`£tNuÎ
(); 
	}
}

55 
šlše
 
ex¶ic™
 
	$AligÃdBox
(
_dim
è: 
	`m_mš
(_dim), 
	$m_max
(
_dim
)

56 { 
	`£tNuÎ
(); 
	}
}

59 
šlše
 
	$AligÃdBox
(cÚ¡ 
VeùÜTy³
& 
_mš
, cÚ¡ VeùÜTy³& 
_max
è: 
	`m_mš
(_mš), 
	$m_max
(
_max
è{
	}
}

62 
šlše
 
ex¶ic™
 
	$AligÃdBox
(cÚ¡ 
VeùÜTy³
& 
p
è: 
	`m_mš
Õ), 
	$m_max
(
p
è{
	}
}

64 ~
	$AligÃdBox
(è{
	}
}

67 
šlše
 
	$dim
(ècÚ¡ {  
Amb›ÁDimAtCompeTime
==
DyÇmic
 ? 
m_mš
.
	`size
()-1 : Amb›ÁDimAtCompeTime; 
	}
}

70 
šlše
 
boŞ
 
	$isNuÎ
(ècÚ¡ {  (
m_mš
.
	`cwi£
(è> 
m_max
).
	`ªy
(); 
	}
}

73 
šlše
 
	$£tNuÎ
()

75 
m_mš
.
	`£tCÚ¡ªt
Ğ
¡d
::
num”ic_lim™s
<
SÿÏr
>::
	`max
());

76 
m_max
.
	`£tCÚ¡ªt
(-
¡d
::
num”ic_lim™s
<
SÿÏr
>::
	`max
());

77 
	}
}

80 
šlše
 cÚ¡ 
	gVeùÜTy³
& 
	$mš
(ècÚ¡ {  
m_mš
; 
	}
}

82 
šlše
 
	gVeùÜTy³
& 
	$mš
(è{  
m_mš
; 
	}
}

84 
šlše
 cÚ¡ 
	gVeùÜTy³
& 
	$max
(ècÚ¡ {  
m_max
; 
	}
}

86 
šlše
 
	gVeùÜTy³
& 
	$max
(è{  
m_max
; 
	}
}

89 
šlše
 
boŞ
 
	$cÚšs
(cÚ¡ 
VeùÜTy³
& 
p
) const

90 {  (
m_mš
.
	`cwi£
()<=
p
).
	`®l
(è&& (p.cwi£()<=
m_max
).®l(); 
	}
}

93 
šlše
 
boŞ
 
	$cÚšs
(cÚ¡ 
AligÃdBox
& 
b
) const

94 {  (
m_mš
.
	`cwi£
()<=
b
.
	`mš
()).
	`®l
(è&& (b.
	`max
().cwi£()<=
m_max
).®l(); 
	}
}

97 
šlše
 
	gAligÃdBox
& 
	$ex‹nd
(cÚ¡ 
VeùÜTy³
& 
p
)

98 { 
m_mš
 = m_mš.
	`cwi£
().
	`mš
(
p
); 
m_max
 = m_max.cwi£().
	`max
Õ);  *
this
; 
	}
}

101 
šlše
 
	gAligÃdBox
& 
	$ex‹nd
(cÚ¡ 
AligÃdBox
& 
b
)

102 { 
m_mš
 = m_mš.
	`cwi£
().
	`mš
(
b
.m_mš); 
m_max
 = m_max.cwi£().
	`max
(b.m_max);  *
this
; 
	}
}

105 
šlše
 
	gAligÃdBox
& 
	$şamp
(cÚ¡ 
AligÃdBox
& 
b
)

106 { 
m_mš
 = m_mš.
	`cwi£
().
	`max
(
b
.m_mš); 
m_max
 = m_max.cwi£().
	`mš
(b.m_max);  *
this
; 
	}
}

109 
šlše
 
	gAligÃdBox
& 
	$Œª¦©e
(cÚ¡ 
VeùÜTy³
& 
t
)

110 { 
m_mš
 +ğ
t
; 
m_max
 +ğt;  *
this
; 
	}
}

116 
šlše
 
SÿÏr
 
	$squ¬edEx‹riÜDi¡ªû
(cÚ¡ 
VeùÜTy³
& 
p
) const;

122 
šlše
 
SÿÏr
 
	$ex‹riÜDi¡ªû
(cÚ¡ 
VeùÜTy³
& 
p
) const

123 {  
	`ei_sq¹
(
	`squ¬edEx‹riÜDi¡ªû
(
p
)); 
	}
}

130 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

131 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gAligÃdBox
,

132 
	gAligÃdBox
<
	gNewSÿÏrTy³
,
	gAmb›ÁDimAtCompeTime
> >::
ty³
 
	$ÿ¡
() const

134  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
AligÃdBox
,

135 
AligÃdBox
<
NewSÿÏrTy³
,
Amb›ÁDimAtCompeTime
> >::
	`ty³
(*
this
);

136 
	}
}

139 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

140 
šlše
 
ex¶ic™
 
AligÃdBox
(cÚ¡ AligÃdBox<
Oth”SÿÏrTy³
,
Amb›ÁDimAtCompeTime
>& 
Ùh”
)

142 
	gm_mš
 = 
Ùh”
.
mš
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>();

143 
	gm_max
 = 
Ùh”
.
max
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>();

150 
boŞ
 
isAµrox
(cÚ¡ 
AligÃdBox
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

151 {  
m_mš
.
isAµrox
(
Ùh”
.m_mš, 
´ec
è&& 
m_max
.isApprox(other.m_max,…rec); }

153 
	g´Ùeùed
:

155 
VeùÜTy³
 
m_mš
, 
	gm_max
;

158 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,
	gAmbŸÁDim
>

159 
šlše
 
SÿÏr
 
	gAligÃdBox
<
	gSÿÏr
,
	gAmbŸÁDim
>::
	$squ¬edEx‹riÜDi¡ªû
(cÚ¡ 
VeùÜTy³
& 
p
) const

161 
SÿÏr
 
di¡2
 = 0.;

162 
SÿÏr
 
aux
;

163 
k
=0; k<
	`dim
(); ++k)

165 ià((
aux
 = (
p
[
k
]-
m_mš
[k]))<0.)

166 
di¡2
 +ğ
aux
*aux;

167 iàĞ(
aux
 = (
m_max
[
k
]-
p
[k]))<0. )

168 
di¡2
 +ğ
aux
*aux;

170  
di¡2
;

171 
	}
}

	@robot/Eigen/src/Geometry/AngleAxis.h

25 #iâdeà
EIGEN_ANGLEAXIS_H


26 
	#EIGEN_ANGLEAXIS_H


	)

54 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
> 
	gei_Œa™s
<
	gAngËAxis
<_Scalar> >

56 
_SÿÏr
 
	tSÿÏr
;

59 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
>

60 
şass
 
	gAngËAxis
 : 
public
 
RÙ©iÚBa£
<
AngËAxis
<
_SÿÏr
>,3>

62 
	gRÙ©iÚBa£
<
	tAngËAxis
<
	t_SÿÏr
>,3> 
	tBa£
;

64 
	gpublic
:

66 
usšg
 
Ba£
::
İ”©Ü
*;

68 ’um { 
	gDim
 = 3 };

70 
_SÿÏr
 
	tSÿÏr
;

71 
	gM©rix
<
	tSÿÏr
,3,3> 
	tM©rix3
;

72 
	gM©rix
<
	tSÿÏr
,3,1> 
	tVeùÜ3
;

73 
	gQu©”niÚ
<
	tSÿÏr
> 
	tQu©”niÚTy³
;

75 
	g´Ùeùed
:

77 
VeùÜ3
 
m_axis
;

78 
SÿÏr
 
	gm_ªgË
;

80 
	gpublic
:

83 
AngËAxis
() {}

86 
‹m¶©e
<
ty³Çme
 
D”ived
>

87 
šlše
 
AngËAxis
(
SÿÏr
 
ªgË
, cÚ¡ 
M©rixBa£
<
D”ived
>& 
axis
è: 
m_axis
×xis), 
m_ªgË
(angle) {}

89 
šlše
 
AngËAxis
(cÚ¡ 
Qu©”niÚTy³
& 
q
è{ *
	gthis
 = q; }

91 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

92 
šlše
 
ex¶ic™
 
AngËAxis
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
è{ *
	gthis
 = m; }

94 
SÿÏr
 
ªgË
(ècÚ¡ {  
	gm_ªgË
; }

95 
	gSÿÏr
& 
ªgË
(è{  
	gm_ªgË
; }

97 cÚ¡ 
	gVeùÜ3
& 
axis
(ècÚ¡ {  
	gm_axis
; }

98 
	gVeùÜ3
& 
axis
(è{  
	gm_axis
; }

101 
šlše
 
Qu©”niÚTy³
 
	gİ”©Ü
* (cÚ¡ 
	gAngËAxis
& 
	gÙh”
) const

102 {  
Qu©”niÚTy³
(*
this
è* Qu©”niÚTy³(
Ùh”
); }

105 
šlše
 
Qu©”niÚTy³
 
	gİ”©Ü
* (cÚ¡ 
	gQu©”niÚTy³
& 
	gÙh”
) const

106 {  
Qu©”niÚTy³
(*
this
è* 
	gÙh”
; }

109 
ä›nd
 
šlše
 
Qu©”niÚTy³
 
	gİ”©Ü
* (cÚ¡ 
	gQu©”niÚTy³
& 
	ga
, cÚ¡ 
	gAngËAxis
& 
	gb
)

110 {  
a
 * 
Qu©”niÚTy³
(
b
); }

113 
šlše
 
M©rix3
 
	gİ”©Ü
* (cÚ¡ 
	gM©rix3
& 
	gÙh”
) const

114 {  
toRÙ©iÚM©rix
(è* 
	gÙh”
; }

117 
šlše
 
ä›nd
 
M©rix3
 
	gİ”©Ü
* (cÚ¡ 
	gM©rix3
& 
	ga
, cÚ¡ 
	gAngËAxis
& 
	gb
)

118 {  
a
 * 
	gb
.
toRÙ©iÚM©rix
(); }

121 
šlše
 
VeùÜ3
 
	gİ”©Ü
* (cÚ¡ 
	gVeùÜ3
& 
	gÙh”
) const

122 {  
toRÙ©iÚM©rix
(è* 
	gÙh”
; }

125 
AngËAxis
 
šv”£
() const

126 {  
AngËAxis
(-
m_ªgË
, 
m_axis
); }

128 
	gAngËAxis
& 
	gİ”©Ü
=(cÚ¡ 
Qu©”niÚTy³
& 
q
);

129 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

130 
	gAngËAxis
& 
	gİ”©Ü
=(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
);

132 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

133 
	gAngËAxis
& 
äomRÙ©iÚM©rix
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
);

134 
M©rix3
 
toRÙ©iÚM©rix
() const;

141 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

142 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gAngËAxis
,AngËAxis<
	gNewSÿÏrTy³
> >::
ty³
 
ÿ¡
() const

143 {  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
AngËAxis
,
	gAngËAxis
<
	gNewSÿÏrTy³
> >::
ty³
(*
this
); }

146 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

147 
šlše
 
ex¶ic™
 
AngËAxis
(cÚ¡ AngËAxis<
Oth”SÿÏrTy³
>& 
Ùh”
)

149 
	gm_axis
 = 
Ùh”
.
axis
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>();

150 
	gm_ªgË
 = 
SÿÏr
(
Ùh”
.
ªgË
());

157 
boŞ
 
isAµrox
(cÚ¡ 
AngËAxis
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

158 {  
m_axis
.
isAµrox
(
Ùh”
.m_axis, 
´ec
è&& 
ei_isAµrox
(
m_ªgË
,other.m_angle,…rec); }

163 
	gAngËAxis
<> 
	tAngËAxisf
;

166 
	gAngËAxis
<> 
	tAngËAxisd
;

171 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

172 
	gAngËAxis
<
	gSÿÏr
>& AngËAxis<SÿÏr>::
İ”©Ü
=(cÚ¡ 
Qu©”niÚTy³
& 
q
)

174 
SÿÏr
 
n2
 = 
q
.
vec
().
squ¬edNÜm
();

175 ià(
	gn2
 < 
	g´ecisiÚ
<
	gSÿÏr
>()*precision<Scalar>())

177 
	gm_ªgË
 = 0;

178 
	gm_axis
 << 1, 0, 0;

182 
	gm_ªgË
 = 2*
¡d
::
acos
(
q
.
w
());

183 
	gm_axis
 = 
q
.
vec
(è/ 
ei_sq¹
(
n2
);

185  *
	gthis
;

190 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

191 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

192 
	gAngËAxis
<
	gSÿÏr
>& AngËAxis<SÿÏr>::
İ”©Ü
=(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m©
)

196  *
this
 = 
Qu©”niÚTy³
(
m©
);

201 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

202 
ty³Çme
 
	gAngËAxis
<
	gSÿÏr
>::
M©rix3


203 
AngËAxis
<
SÿÏr
>::
	$toRÙ©iÚM©rix
() const

205 
M©rix3
 
»s
;

206 
VeùÜ3
 
sš_axis
 = 
	`ei_sš
(
m_ªgË
è* 
m_axis
;

207 
SÿÏr
 
c
 = 
	`ei_cos
(
m_ªgË
);

208 
VeùÜ3
 
cos1_axis
 = (
	`SÿÏr
(1)-
c
è* 
m_axis
;

210 
SÿÏr
 
tmp
;

211 
tmp
 = 
cos1_axis
.
	`x
(è* 
m_axis
.
	`y
();

212 
»s
.
	`cÛffRef
(0,1èğ
tmp
 - 
sš_axis
.
	`z
();

213 
»s
.
	`cÛffRef
(1,0èğ
tmp
 + 
sš_axis
.
	`z
();

215 
tmp
 = 
cos1_axis
.
	`x
(è* 
m_axis
.
	`z
();

216 
»s
.
	`cÛffRef
(0,2èğ
tmp
 + 
sš_axis
.
	`y
();

217 
»s
.
	`cÛffRef
(2,0èğ
tmp
 - 
sš_axis
.
	`y
();

219 
tmp
 = 
cos1_axis
.
	`y
(è* 
m_axis
.
	`z
();

220 
»s
.
	`cÛffRef
(1,2èğ
tmp
 - 
sš_axis
.
	`x
();

221 
»s
.
	`cÛffRef
(2,1èğ
tmp
 + 
sš_axis
.
	`x
();

223 
»s
.
	`dŸgÚ®
(èğ(
cos1_axis
.
	`cwi£
(è* 
m_axis
).cwi£(è+ 
c
;

225  
»s
;

226 
	}
}

	@robot/Eigen/src/Geometry/EulerAngles.h

25 #iâdeà
EIGEN_EULERANGLES_H


26 
	#EIGEN_EULERANGLES_H


	)

44 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

45 
šlše
 
	gM©rix
<
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
SÿÏr
,3,1>

46 
	gM©rixBa£
<
	gD”ived
>::
	$euËrAngËs
(
a0
, 
a1
, 
a2
) const

49 
	`EIGEN_STATIC_ASSERT_MATRIX_SPECIFIC_SIZE
(
D”ived
,3,3)

51 
M©rix
<
SÿÏr
,3,1> 
»s
;

52 
M©rix
<
	tty³Çme
 
	tD”ived
::
	tSÿÏr
,2,1> 
	tVeùÜ2
;

53 cÚ¡ 
SÿÏr
 
•sÚ
 = 
´ecisiÚ
<Scalar>();

55 cÚ¡ 
odd
 = ((
a0
+1)%3 =ğ
a1
) ? 0 : 1;

56 cÚ¡ 
i
 = 
a0
;

57 cÚ¡ 
j
 = (
a0
 + 1 + 
odd
)%3;

58 cÚ¡ 
k
 = (
a0
 + 2 - 
odd
)%3;

60 ià(
a0
==
a2
)

62 
SÿÏr
 
s
 = 
	`VeùÜ2
(
	`cÛff
(
j
,
i
è, cÛff(
k
,i)).
	`nÜm
();

63 
»s
[1] = 
	`ei_©ª2
(
s
, 
	`cÛff
(
i
,i));

64 ià(
s
 > 
•sÚ
)

66 
»s
[0] = 
	`ei_©ª2
(
	`cÛff
(
j
,
i
), cÛff(
k
,i));

67 
»s
[2] = 
	`ei_©ª2
(
	`cÛff
(
i
,
j
),-cÛff(i,
k
));

71 
»s
[0] = 
	`SÿÏr
(0);

72 
»s
[2] = (
	`cÛff
(
i
,i)>0?1:-1)*
	`ei_©ª2
(-cÛff(
k
,
j
), coeff(j,j));

77 
SÿÏr
 
c
 = 
	`VeùÜ2
(
	`cÛff
(
i
,iè, cÛff(i,
j
)).
	`nÜm
();

78 
»s
[1] = 
	`ei_©ª2
(-
	`cÛff
(
i
,
k
), 
c
);

79 ià(
c
 > 
•sÚ
)

81 
»s
[0] = 
	`ei_©ª2
(
	`cÛff
(
j
,
k
), coeff(k,k));

82 
»s
[2] = 
	`ei_©ª2
(
	`cÛff
(
i
,
j
), coeff(i,i));

86 
»s
[0] = 
	`SÿÏr
(0);

87 
»s
[2] = (
	`cÛff
(
i
,
k
)>0?1:-1)*
	`ei_©ª2
(-cÛff(k,
j
), coeff(j,j));

90 ià(!
odd
)

91 
»s
 = -res;

92  
»s
;

93 
	}
}

	@robot/Eigen/src/Geometry/Hyperplane.h

26 #iâdeà
EIGEN_HYPERPLANE_H


27 
	#EIGEN_HYPERPLANE_H


	)

46 
	g‹m¶©e
 <
ty³Çme
 
	g_SÿÏr
, 
	g_Amb›ÁDim
>

47 şas 
	cHy³½ÏÃ


49 
	mpublic
:

50 
EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
_SÿÏr
,
_Amb›ÁDim
==
DyÇmic
 ? Dynamic : _AmbientDim+1)

51 ’um { 
Amb›ÁDimAtCompeTime
 = 
_Amb›ÁDim
 };

52 
_SÿÏr
 
	tSÿÏr
;

53 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

54 
	gM©rix
<
	tSÿÏr
,
	tAmb›ÁDimAtCompeTime
,1> 
	tVeùÜTy³
;

55 
	gM©rix
<
	tSÿÏr
,(
	tAmb›ÁDimAtCompeTime
)==
	tDyÇmic


56 ? 
	tDyÇmic


57 : (
	tAmb›ÁDimAtCompeTime
)+1,1> 
	tCÛffic›Ás
;

58 
	gBlock
<
	tCÛffic›Ás
,
	tAmb›ÁDimAtCompeTime
,1> 
	tNÜm®R‘uºTy³
;

61 
šlše
 
ex¶ic™
 
	$Hy³½ÏÃ
(è{
	}
}

65 
šlše
 
ex¶ic™
 
	$Hy³½ÏÃ
(
_dim
è: 
	`m_cÛffs
(_dim+1è{
	}
}

70 
šlše
 
	$Hy³½ÏÃ
(cÚ¡ 
VeùÜTy³
& 
n
, cÚ¡ VeùÜTy³& 
e
)

71 : 
	`m_cÛffs
(
n
.
	`size
()+1)

73 
	`nÜm®
(èğ
n
;

74 
	`off£t
(èğ-
e
.
	`dÙ
(
n
);

75 
	}
}

81 
šlše
 
	$Hy³½ÏÃ
(cÚ¡ 
VeùÜTy³
& 
n
, 
SÿÏr
 
d
)

82 : 
	`m_cÛffs
(
n
.
	`size
()+1)

84 
	`nÜm®
(èğ
n
;

85 
	`off£t
(èğ
d
;

86 
	}
}

91 
šlše
 
Hy³½ÏÃ
 
	$Through
(cÚ¡ 
VeùÜTy³
& 
p0
, cÚ¡ VeùÜTy³& 
p1
)

93 
Hy³½ÏÃ
 
	`»suÉ
(
p0
.
	`size
());

94 
»suÉ
.
	`nÜm®
(èğ(
p1
 - 
p0
).
	`un™O¹hogÚ®
();

95 
»suÉ
.
	`off£t
(èğ-»suÉ.
	`nÜm®
().
	`dÙ
(
p0
);

96  
»suÉ
;

97 
	}
}

102 
šlše
 
Hy³½ÏÃ
 
	$Through
(cÚ¡ 
VeùÜTy³
& 
p0
, cÚ¡ VeùÜTy³& 
p1
, cÚ¡ VeùÜTy³& 
p2
)

104 
	`EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
VeùÜTy³
, 3)

105 
Hy³½ÏÃ
 
	`»suÉ
(
p0
.
	`size
());

106 
»suÉ
.
	`nÜm®
(èğ(
p2
 - 
p0
).
	`üoss
(
p1
 -…0).
	`nÜm®ized
();

107 
»suÉ
.
	`off£t
(èğ-»suÉ.
	`nÜm®
().
	`dÙ
(
p0
);

108  
»suÉ
;

109 
	}
}

116 
ex¶ic™
 
Hy³½ÏÃ
(cÚ¡ 
P¬am‘rizedLše
<
SÿÏr
, 
Amb›ÁDimAtCompeTime
>& 
·¿m‘rized
)

118 
nÜm®
(èğ
·¿m‘rized
.
dœeùiÚ
().
un™O¹hogÚ®
();

119 
off£t
(èğ-
nÜm®
().
dÙ
(
·¿m‘rized
.
Üigš
());

122 ~
	$Hy³½ÏÃ
(è{
	}
}

125 
šlše
 
	$dim
(ècÚ¡ {  
Amb›ÁDimAtCompeTime
==
DyÇmic
 ? 
m_cÛffs
.
	`size
()-1 : Amb›ÁDimAtCompeTime; 
	}
}

128 
	$nÜm®ize
()

130 
m_cÛffs
 /ğ
	`nÜm®
().
	`nÜm
();

131 
	}
}

136 
šlše
 
SÿÏr
 
	$sigÃdDi¡ªû
(cÚ¡ 
VeùÜTy³
& 
p
ècÚ¡ { ….
	`dÙ
(
	`nÜm®
()è+ 
	`off£t
(); 
	}
}

141 
šlše
 
SÿÏr
 
	$absDi¡ªû
(cÚ¡ 
VeùÜTy³
& 
p
ècÚ¡ {  
	`ei_abs
(
	`sigÃdDi¡ªû
Õ)); 
	}
}

145 
šlše
 
VeùÜTy³
 
	$´ojeùiÚ
(cÚ¡ 
VeùÜTy³
& 
p
ècÚ¡ { … - 
	`sigÃdDi¡ªû
Õè* 
	`nÜm®
(); 
	}
}

150 
šlše
 cÚ¡ 
NÜm®R‘uºTy³
 
	$nÜm®
(ècÚ¡ {  
	`NÜm®R‘uºTy³
(
m_cÛffs
,0,0,
	`dim
(),1); 
	}
}

155 
šlše
 
NÜm®R‘uºTy³
 
	$nÜm®
(è{  
	`NÜm®R‘uºTy³
(
m_cÛffs
,0,0,
	`dim
(),1); 
	}
}

160 
šlše
 cÚ¡ 
	gSÿÏr
& 
	$off£t
(ècÚ¡ {  
m_cÛffs
.
	`cÛff
(
	`dim
()); 
	}
}

164 
šlše
 
	gSÿÏr
& 
	$off£t
(è{  
	`m_cÛffs
(
	`dim
()); 
	}
}

169 
šlše
 cÚ¡ 
	gCÛffic›Ás
& 
	$cÛffs
(ècÚ¡ {  
m_cÛffs
; 
	}
}

174 
šlše
 
	gCÛffic›Ás
& 
	$cÛffs
(è{  
m_cÛffs
; 
	}
}

182 
VeùÜTy³
 
	$š‹r£ùiÚ
(cÚ¡ 
Hy³½ÏÃ
& 
Ùh”
)

184 
	`EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
VeùÜTy³
, 2)

185 
SÿÏr
 
d‘
 = 
	`cÛffs
().
	`cÛff
(0è* 
Ùh”
.coeffs().coeff(1) - coeffs().coeff(1) * other.coeffs().coeff(0);

188 if(
	`ei_isMuchSm®ËrThª
(
d‘
, 
	`SÿÏr
(1)))

190 if(
	`ei_abs
(
	`cÛffs
().
	`cÛff
(1))>ei_abs(coeffs().coeff(0)))

191  
	`VeùÜTy³
(
	`cÛffs
().
	`cÛff
(1), -coeffs().coeff(2)/coeffs().coeff(1)-coeffs().coeff(0));

193  
	`VeùÜTy³
(-
	`cÛffs
().
	`cÛff
(2)/coeffs().coeff(0)-coeffs().coeff(1), coeffs().coeff(0));

197 
SÿÏr
 
švd‘
 = 
	`SÿÏr
(1è/ 
d‘
;

198  
	`VeùÜTy³
(
švd‘
*(
	`cÛffs
().
	`cÛff
(1)*
Ùh”
.coeffs().coeff(2)-other.coeffs().coeff(1)*coeffs().coeff(2)),

199 
švd‘
*(
Ùh”
.
	`cÛffs
().
	`cÛff
(0)*coeffs().coeff(2)-coeffs().coeff(0)*other.coeffs().coeff(2)));

201 
	}
}

209 
	g‹m¶©e
<
ty³Çme
 
	gX´Ty³
>

210 
šlše
 
	gHy³½ÏÃ
& 
ŒªsfÜm
(cÚ¡ 
M©rixBa£
<
X´Ty³
>& 
m©
, 
T¿nsfÜmT¿™s
 
Œa™s
 = 
Affše
)

212 ià(
Œa™s
==
Affše
)

213 
nÜm®
(èğ
m©
.
šv”£
().
Œª¥o£
() *‚ormal();

214 ià(
	gŒa™s
==
Isom‘ry
)

215 
nÜm®
(èğ
m©
 *‚ormal();

218 
ei_as£¹
("invalidraits value in Hyperplane::transform()");

220  *
	gthis
;

230 
šlše
 
	gHy³½ÏÃ
& 
ŒªsfÜm
(cÚ¡ 
T¿nsfÜm
<
SÿÏr
,
Amb›ÁDimAtCompeTime
>& 
t
,

231 
T¿nsfÜmT¿™s
 
Œa™s
 = 
Affše
)

233 
ŒªsfÜm
(
t
.
lš—r
(), 
Œa™s
);

234 
off£t
(è-ğ
t
.
Œª¦©iÚ
().
dÙ
(
nÜm®
());

235  *
	gthis
;

243 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

244 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gHy³½ÏÃ
,

245 
	gHy³½ÏÃ
<
	gNewSÿÏrTy³
,
	gAmb›ÁDimAtCompeTime
> >::
ty³
 
	$ÿ¡
() const

247  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
Hy³½ÏÃ
,

248 
Hy³½ÏÃ
<
NewSÿÏrTy³
,
Amb›ÁDimAtCompeTime
> >::
	`ty³
(*
this
);

249 
	}
}

252 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

253 
šlše
 
ex¶ic™
 
Hy³½ÏÃ
(cÚ¡ Hy³½ÏÃ<
Oth”SÿÏrTy³
,
Amb›ÁDimAtCompeTime
>& 
Ùh”
)

254 { 
	gm_cÛffs
 = 
Ùh”
.
cÛffs
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>(); }

260 
boŞ
 
isAµrox
(cÚ¡ 
Hy³½ÏÃ
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

261 {  
m_cÛffs
.
isAµrox
(
Ùh”
.m_cÛffs, 
´ec
); }

263 
	g´Ùeùed
:

265 
CÛffic›Ás
 
m_cÛffs
;

	@robot/Eigen/src/Geometry/OrthoMethods.h

26 #iâdeà
EIGEN_ORTHOMETHODS_H


27 
	#EIGEN_ORTHOMETHODS_H


	)

35 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

36 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

37 
šlše
 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³


38 
M©rixBa£
<
D”ived
>::
üoss
(cÚ¡ M©rixBa£<
Oth”D”ived
>& 
Ùh”
) const

40 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
D”ived
,3)

44 cÚ¡ 
ty³Çme
 
	gei_Ã¡ed
<
	gD”ived
,2>::
ty³
 
lhs
(
d”ived
());

45 cÚ¡ 
ty³Çme
 
	gei_Ã¡ed
<
	gOth”D”ived
,2>::
ty³
 
rhs
(
Ùh”
.
d”ived
());

46  
ty³Çme
 
	gei_¶aš_m©rix_ty³
<
	gD”ived
>::
ty³
(

47 
lhs
.
cÛff
(1è* 
rhs
.coeff(2) -†hs.coeff(2) *„hs.coeff(1),

48 
lhs
.
cÛff
(2è* 
rhs
.coeff(0) -†hs.coeff(0) *„hs.coeff(2),

49 
lhs
.
cÛff
(0è* 
rhs
.coeff(1) -†hs.coeff(1) *„hs.coeff(0)

53 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	gSize
 = 
D”ived
::
SizeAtCompeTime
>

54 
	sei_un™O¹hogÚ®_£ËùÜ


56 
ty³Çme
 
	tei_¶aš_m©rix_ty³
<
	tD”ived
>::
	tty³
 
	tVeùÜTy³
;

57 
ty³Çme
 
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
 Scalar;

58 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

59 
šlše
 
VeùÜTy³
 
run
(cÚ¡ 
D”ived
& 
¤c
)

61 
VeùÜTy³
 
³½
(
¤c
.
size
());

69 if((!
ei_isMuchSm®ËrThª
(
¤c
.
x
(), src.
z
()))

70 || (!
ei_isMuchSm®ËrThª
(
¤c
.
y
(), src.
z
())))

72 
R—lSÿÏr
 
	mšvnm
 = R—lSÿÏr(1)/
¤c
.
‹m¶©e
 
¡¬t
<2>().
nÜm
();

73 
	m³½
.
cÛffRef
(0èğ-
ei_cÚj
(
¤c
.
y
())*
švnm
;

74 
	m³½
.
cÛffRef
(1èğ
ei_cÚj
(
¤c
.
x
())*
švnm
;

75 
	m³½
.
cÛffRef
(2) = 0;

83 
R—lSÿÏr
 
	mšvnm
 = R—lSÿÏr(1)/
¤c
.
‹m¶©e
 
’d
<2>().
nÜm
();

84 
	m³½
.
cÛffRef
(0) = 0;

85 
	m³½
.
cÛffRef
(1èğ-
ei_cÚj
(
¤c
.
z
())*
švnm
;

86 
	m³½
.
cÛffRef
(2èğ
ei_cÚj
(
¤c
.
y
())*
švnm
;

88 ifĞ(
	mD”ived
::
SizeAtCompeTime
!=
DyÇmic
 && 
D”ived
::SizeAtCompileTime>3)

89 || (
D”ived
::
SizeAtCompeTime
==
DyÇmic
 && 
¤c
.
size
()>3) )

90 
³½
.
’d
(
¤c
.
size
()-3).
£tZ”o
();

92  
	m³½
;

96 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

97 
	gei_un™O¹hogÚ®_£ËùÜ
<
	gD”ived
,2>

99 
ty³Çme
 
	tei_¶aš_m©rix_ty³
<
	tD”ived
>::
	tty³
 
	tVeùÜTy³
;

100 
šlše
 
VeùÜTy³
 
run
(cÚ¡ 
D”ived
& 
¤c
)

101 {  
VeùÜTy³
(-
ei_cÚj
(
¤c
.
y
()),ƒi_cÚj(¤c.
x
())).
nÜm®ized
(); }

111 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

112 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³


113 
M©rixBa£
<
D”ived
>::
	$un™O¹hogÚ®
() const

115 
	`EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

116  
ei_un™O¹hogÚ®_£ËùÜ
<
D”ived
>::
	`run
(
	`d”ived
());

117 
	}
}

	@robot/Eigen/src/Geometry/ParametrizedLine.h

26 #iâdeà
EIGEN_PARAMETRIZEDLINE_H


27 
	#EIGEN_PARAMETRIZEDLINE_H


	)

42 
	g‹m¶©e
 <
ty³Çme
 
	g_SÿÏr
, 
	g_Amb›ÁDim
>

43 şas 
	cP¬am‘rizedLše


45 
	mpublic
:

46 
	$EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
_SÿÏr
,
_Amb›ÁDim
)

47 ’um { 
Amb›ÁDimAtCompeTime
 = 
_Amb›ÁDim
 };

48 
_SÿÏr
 
	tSÿÏr
;

49 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

50 
M©rix
<
	tSÿÏr
,
	tAmb›ÁDimAtCompeTime
,1> 
	tVeùÜTy³
;

53 
šlše
 
ex¶ic™
 
	$P¬am‘rizedLše
(è{
	}
}

57 
šlše
 
ex¶ic™
 
	$P¬am‘rizedLše
(
_dim
è: 
	`m_Üigš
(_dim), 
	$m_dœeùiÚ
(
_dim
è{
	}
}

62 
	$P¬am‘rizedLše
(cÚ¡ 
VeùÜTy³
& 
Üigš
, cÚ¡ VeùÜTy³& 
dœeùiÚ
)

63 : 
	`m_Üigš
(
Üigš
), 
	$m_dœeùiÚ
(
dœeùiÚ
è{
	}
}

65 
ex¶ic™
 
P¬am‘rizedLše
(cÚ¡ 
Hy³½ÏÃ
<
_SÿÏr
, 
_Amb›ÁDim
>& 
hy³½ÏÃ
);

68 
šlše
 
P¬am‘rizedLše
 
	$Through
(cÚ¡ 
VeùÜTy³
& 
p0
, cÚ¡ VeùÜTy³& 
p1
)

69 {  
	`P¬am‘rizedLše
(
p0
, (
p1
-p0).
	`nÜm®ized
()); 
	}
}

71 ~
	$P¬am‘rizedLše
(è{
	}
}

74 
šlše
 
	$dim
(ècÚ¡ {  
m_dœeùiÚ
.
	`size
(); 
	}
}

76 cÚ¡ 
	gVeùÜTy³
& 
	$Üigš
(ècÚ¡ {  
m_Üigš
; 
	}
}

77 
	gVeùÜTy³
& 
	$Üigš
(è{  
m_Üigš
; 
	}
}

79 cÚ¡ 
	gVeùÜTy³
& 
	$dœeùiÚ
(ècÚ¡ {  
m_dœeùiÚ
; 
	}
}

80 
	gVeùÜTy³
& 
	$dœeùiÚ
(è{  
m_dœeùiÚ
; 
	}
}

85 
R—lSÿÏr
 
	$squ¬edDi¡ªû
(cÚ¡ 
VeùÜTy³
& 
p
) const

87 
VeùÜTy³
 
diff
 = 
p
-
	`Üigš
();

88  (
diff
 - diff.
	`dÙ
(
	`dœeùiÚ
())* dœeùiÚ()).
	`squ¬edNÜm
();

89 
	}
}

93 
R—lSÿÏr
 
	$di¡ªû
(cÚ¡ 
VeùÜTy³
& 
p
ècÚ¡ {  
	`ei_sq¹
(
	`squ¬edDi¡ªû
Õ)); 
	}
}

96 
VeùÜTy³
 
	$´ojeùiÚ
(cÚ¡ 
VeùÜTy³
& 
p
) const

97 {  
	`Üigš
(è+ (
p
-Üigš()).
	`dÙ
(
	`dœeùiÚ
()è* dœeùiÚ(); 
	}
}

99 
SÿÏr
 
š‹r£ùiÚ
(cÚ¡ 
Hy³½ÏÃ
<
_SÿÏr
, 
_Amb›ÁDim
>& 
hy³½ÏÃ
);

106 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

107 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gP¬am‘rizedLše
,

108 
	gP¬am‘rizedLše
<
	gNewSÿÏrTy³
,
	gAmb›ÁDimAtCompeTime
> >::
ty³
 
	$ÿ¡
() const

110  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
P¬am‘rizedLše
,

111 
P¬am‘rizedLše
<
NewSÿÏrTy³
,
Amb›ÁDimAtCompeTime
> >::
	`ty³
(*
this
);

112 
	}
}

115 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

116 
šlše
 
ex¶ic™
 
P¬am‘rizedLše
(cÚ¡ P¬am‘rizedLše<
Oth”SÿÏrTy³
,
Amb›ÁDimAtCompeTime
>& 
Ùh”
)

118 
	gm_Üigš
 = 
Ùh”
.
Üigš
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>();

119 
	gm_dœeùiÚ
 = 
Ùh”
.
dœeùiÚ
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>();

126 
boŞ
 
isAµrox
(cÚ¡ 
P¬am‘rizedLše
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

127 {  
m_Üigš
.
isAµrox
(
Ùh”
.m_Üigš, 
´ec
è&& 
m_dœeùiÚ
.isApprox(other.m_direction,…rec); }

129 
	g´Ùeùed
:

131 
VeùÜTy³
 
m_Üigš
, 
	gm_dœeùiÚ
;

138 
	g‹m¶©e
 <
ty³Çme
 
	g_SÿÏr
, 
	g_Amb›ÁDim
>

139 
šlše
 
	gP¬am‘rizedLše
<
	g_SÿÏr
, 
	g_Amb›ÁDim
>::
P¬am‘rizedLše
(cÚ¡ 
Hy³½ÏÃ
<
_SÿÏr
, 
_Amb›ÁDim
>& 
hy³½ÏÃ
)

141 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
VeùÜTy³
, 2)

142 
dœeùiÚ
(èğ
hy³½ÏÃ
.
nÜm®
().
un™O¹hogÚ®
();

143 
Üigš
(èğ-
hy³½ÏÃ
.
nÜm®
()*hy³½ÏÃ.
off£t
();

148 
	g‹m¶©e
 <
ty³Çme
 
	g_SÿÏr
, 
	g_Amb›ÁDim
>

149 
šlše
 
_SÿÏr
 
	gP¬am‘rizedLše
<
	g_SÿÏr
, 
	g_Amb›ÁDim
>::
š‹r£ùiÚ
(cÚ¡ 
Hy³½ÏÃ
<_SÿÏr, 
_Amb›ÁDim
>& 
hy³½ÏÃ
)

151  -(
	ghy³½ÏÃ
.
off£t
()+
Üigš
().
dÙ
(
hy³½ÏÃ
.
nÜm®
()))

152 /(
dœeùiÚ
().
dÙ
(
hy³½ÏÃ
.
nÜm®
()));

	@robot/Eigen/src/Geometry/Quaternion.h

25 #iâdeà
EIGEN_QUATERNION_H


26 
	#EIGEN_QUATERNION_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gOth”
,

29 
	gOth”Rows
=
Oth”
::
RowsAtCompeTime
,

30 
	gOth”CŞs
=
Oth”
::
CŞsAtCompeTime
>

31 
ei_qu©”niÚ_assign_im¶
;

55 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
> 
	gei_Œa™s
<
	gQu©”niÚ
<_Scalar> >

57 
_SÿÏr
 
	tSÿÏr
;

60 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
>

61 
şass
 
	gQu©”niÚ
 : 
public
 
RÙ©iÚBa£
<
Qu©”niÚ
<
_SÿÏr
>,3>

63 
	gRÙ©iÚBa£
<
	tQu©”niÚ
<
	t_SÿÏr
>,3> 
	tBa£
;

65 
	gpublic
:

66 
EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
_SÿÏr
,4)

68 
usšg
 
	gBa£
::
İ”©Ü
*;

71 
_SÿÏr
 
	tSÿÏr
;

74 
	gM©rix
<
	tSÿÏr
, 4, 1> 
	tCÛffic›Ás
;

76 
	gM©rix
<
	tSÿÏr
,3,1> 
	tVeùÜ3
;

78 
	gM©rix
<
	tSÿÏr
,3,3> 
	tM©rix3
;

80 
	gAngËAxis
<
	tSÿÏr
> 
	tAngËAxisTy³
;

83 
šlše
 
SÿÏr
 
x
(ècÚ¡ {  
	gm_cÛffs
.
cÛff
(0); }

85 
šlše
 
SÿÏr
 
y
(ècÚ¡ {  
	gm_cÛffs
.
cÛff
(1); }

87 
šlše
 
SÿÏr
 
z
(ècÚ¡ {  
	gm_cÛffs
.
cÛff
(2); }

89 
šlše
 
SÿÏr
 
w
(ècÚ¡ {  
	gm_cÛffs
.
cÛff
(3); }

92 
šlše
 
	gSÿÏr
& 
x
(è{  
	gm_cÛffs
.
cÛffRef
(0); }

94 
šlše
 
	gSÿÏr
& 
y
(è{  
	gm_cÛffs
.
cÛffRef
(1); }

96 
šlše
 
	gSÿÏr
& 
z
(è{  
	gm_cÛffs
.
cÛffRef
(2); }

98 
šlše
 
	gSÿÏr
& 
w
(è{  
	gm_cÛffs
.
cÛffRef
(3); }

101 
šlše
 cÚ¡ 
	gBlock
<
	gCÛffic›Ás
,3,1> 
vec
(ècÚ¡ {  
	gm_cÛffs
.
‹m¶©e
 
	g¡¬t
<3>(); }

104 
šlše
 
	gBlock
<
	gCÛffic›Ás
,3,1> 
vec
(è{  
	gm_cÛffs
.
‹m¶©e
 
	g¡¬t
<3>(); }

107 
šlše
 cÚ¡ 
	gCÛffic›Ás
& 
cÛffs
(ècÚ¡ {  
	gm_cÛffs
; }

110 
šlše
 
	gCÛffic›Ás
& 
cÛffs
(è{  
	gm_cÛffs
; }

113 
šlše
 
Qu©”niÚ
() {}

122 
šlše
 
Qu©”niÚ
(
SÿÏr
 
w
, SÿÏ¸
x
, SÿÏ¸
y
, SÿÏ¸
z
)

123 { 
	gm_cÛffs
 << 
	gx
, 
	gy
, 
	gz
, 
	gw
; }

126 
šlše
 
Qu©”niÚ
(cÚ¡ Qu©”niÚ& 
Ùh”
è{ 
	gm_cÛffs
 = oth”.
m_cÛffs
; }

129 
ex¶ic™
 
šlše
 
Qu©”niÚ
(cÚ¡ 
AngËAxisTy³
& 
¯
è{ *
	gthis
 =‡a; }

136 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

137 
ex¶ic™
 
šlše
 
Qu©”niÚ
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
Ùh”
è{ *
	gthis
 = other; }

139 
	gQu©”niÚ
& 
	gİ”©Ü
=(cÚ¡ 
Qu©”niÚ
& 
Ùh”
);

140 
	gQu©”niÚ
& 
	gİ”©Ü
=(cÚ¡ 
AngËAxisTy³
& 
¯
);

141 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

142 
	gQu©”niÚ
& 
	gİ”©Ü
=(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
);

147 
šlše
 
Qu©”niÚ
 
Id’t™y
() {  Quaternion(1, 0, 0, 0); }

151 
šlše
 
	gQu©”niÚ
& 
£tId’t™y
(è{ 
	gm_cÛffs
 << 0, 0, 0, 1;  *
	gthis
; }

156 
šlše
 
SÿÏr
 
squ¬edNÜm
(ècÚ¡ {  
	gm_cÛffs
.squaredNorm(); }

161 
šlše
 
SÿÏr
 
nÜm
(ècÚ¡ {  
	gm_cÛffs
.norm(); }

165 
šlše
 
nÜm®ize
(è{ 
	gm_cÛffs
.normalize(); }

168 
šlše
 
Qu©”niÚ
 
nÜm®ized
(ècÚ¡ {  Qu©”niÚ(
m_cÛffs
.normalized()); }

175 
šlše
 
SÿÏr
 
dÙ
(cÚ¡ 
Qu©”niÚ
& 
Ùh”
ècÚ¡ {  
	gm_cÛffs
.dÙ(Ùh”.
m_cÛffs
); }

177 
šlše
 
SÿÏr
 
ªguÏrDi¡ªû
(cÚ¡ 
Qu©”niÚ
& 
Ùh”
) const;

179 
M©rix3
 
toRÙ©iÚM©rix
() const;

181 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

182 
	gQu©”niÚ
& 
£tFromTwoVeùÜs
(cÚ¡ 
M©rixBa£
<
D”ived1
>& 
a
, cÚ¡ M©rixBa£<
D”ived2
>& 
b
);

184 
šlše
 
Qu©”niÚ
 
	gİ”©Ü
* (cÚ¡ 
	gQu©”niÚ
& 
	gq
) const;

185 
šlše
 
	gQu©”niÚ
& 
	gİ”©Ü
*ğ(cÚ¡ 
Qu©”niÚ
& 
q
);

187 
Qu©”niÚ
 
šv”£
() const;

188 
Qu©”niÚ
 
cÚjug©e
() const;

190 
Qu©”niÚ
 
¦”p
(
SÿÏr
 
t
, cÚ¡ Qu©”niÚ& 
Ùh”
) const;

192 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

193 
VeùÜ3
 
	gİ”©Ü
* (cÚ¡ 
	gM©rixBa£
<
	gD”ived
>& 
	gvec
) const;

200 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

201 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gQu©”niÚ
,Qu©”niÚ<
	gNewSÿÏrTy³
> >::
ty³
 
ÿ¡
() const

202 {  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
Qu©”niÚ
,
	gQu©”niÚ
<
	gNewSÿÏrTy³
> >::
ty³
(*
this
); }

205 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

206 
šlše
 
ex¶ic™
 
Qu©”niÚ
(cÚ¡ Qu©”niÚ<
Oth”SÿÏrTy³
>& 
Ùh”
)

207 { 
	gm_cÛffs
 = 
Ùh”
.
cÛffs
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>(); }

213 
boŞ
 
isAµrox
(cÚ¡ 
Qu©”niÚ
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

214 {  
m_cÛffs
.
isAµrox
(
Ùh”
.m_cÛffs, 
´ec
); }

216 
	g´Ùeùed
:

217 
CÛffic›Ás
 
m_cÛffs
;

222 
	gQu©”niÚ
<> 
	tQu©”niÚf
;

225 
	gQu©”niÚ
<> 
	tQu©”niÚd
;

228 
	g‹m¶©e
<
	gArch
,
ty³Çme
 
	gSÿÏr
> 
šlše
 
	gQu©”niÚ
<Scalar>

229 
ei_qu©”niÚ_´oduù
(cÚ¡ 
Qu©”niÚ
<
SÿÏr
>& 
a
, cÚ¡ Qu©”niÚ<SÿÏr>& 
b
)

231  
	gQu©”niÚ
<
	gSÿÏr
>

233 
	ga
.
w
(è* 
	gb
.w(è-‡.
x
(è* b.x(è-‡.
y
(è* b.y(è-‡.
z
() * b.z(),

234 
	ga
.
w
(è* 
	gb
.
x
(è+‡.x(è* b.w(è+‡.
y
(è* b.
z
() -‡.z() * b.y(),

235 
	ga
.
w
(è* 
	gb
.
y
(è+‡.y(è* b.w(è+‡.
z
(è* b.
x
() -‡.x() * b.z(),

236 
	ga
.
w
(è* 
	gb
.
z
(è+‡.z(è* b.w(è+‡.
x
(è* b.
y
() -‡.y() * b.x()

240 #ifdeà
EIGEN_VECTORIZE_SSE


241 
	g‹m¶©e
<> 
šlše
 
	gQu©”niÚ
<>

242 
	gei_qu©”niÚ_´oduù
<
	gEiArch_SSE
,>(cÚ¡ 
	gQu©”niÚ
<>& 
	g_a
, cÚ¡ Qu©”niÚ<>& 
	g_b
)

244 cÚ¡ 
__m128
 
	gmask
 = 
_mm_ÿ¡si128_ps
(
_mm_£Œ_•i32
(0,0,0,0x80000000));

245 
	gQu©”niÚ
<> 
	g»s
;

246 
__m128
 
	ga
 = 
_a
.
cÛffs
().
·ck‘
<
AligÃd
>(0);

247 
__m128
 
	gb
 = 
_b
.
cÛffs
().
·ck‘
<
AligÃd
>(0);

248 
__m128
 
	gæ1
 = 
_mm_xÜ_ps
(
_mm_mul_ps
(
ei_vec4f_swizzË1
(
a
,1,2,0,2),

249 
ei_vec4f_swizzË1
(
b
,2,0,1,2)),
mask
);

250 
__m128
 
	gæ2
 = 
_mm_xÜ_ps
(
_mm_mul_ps
(
ei_vec4f_swizzË1
(
a
,3,3,3,1),

251 
ei_vec4f_swizzË1
(
b
,0,1,2,1)),
mask
);

252 
ei_p¡Üe
(&
»s
.
x
(),

253 
_mm_add_ps
(
_mm_sub_ps
(
_mm_mul_ps
(
a
,
ei_vec4f_swizzË1
(
b
,3,3,3,3)),

254 
_mm_mul_ps
(
ei_vec4f_swizzË1
(
a
,2,0,1,0),

255 
ei_vec4f_swizzË1
(
b
,1,2,0,0))),

256 
_mm_add_ps
(
æ1
,
æ2
)));

257  
	g»s
;

262 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

263 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
> Qu©”niÚ<SÿÏr>::
İ”©Ü
* (cÚ¡ 
Qu©”niÚ
& 
Ùh”
) const

265  
ei_qu©”niÚ_´oduù
<
EiArch
>(*
this
,
	gÙh”
);

269 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

270 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
>& Qu©”niÚ<SÿÏr>::
İ”©Ü
*ğ(cÚ¡ 
Qu©”niÚ
& 
Ùh”
)

272  (*
this
 = *thi * 
Ùh”
);

282 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

283 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

284 
šlše
 
ty³Çme
 
	gQu©”niÚ
<
	gSÿÏr
>::
VeùÜ3


285 
Qu©”niÚ
<
SÿÏr
>::
İ”©Ü
* (cÚ¡ 
M©rixBa£
<
D”ived
>& 
v
) const

292 
VeùÜ3
 
uv
;

293 
	guv
 = 2 * 
this
->
vec
().
üoss
(
v
);

294  
	gv
 + 
	gthis
->
w
(è* 
	guv
 +his->
vec
().
üoss
(
uv
);

297 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

298 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
>& Qu©”niÚ<SÿÏr>::
İ”©Ü
=(cÚ¡ 
Qu©”niÚ
& 
Ùh”
)

300 
m_cÛffs
 = 
Ùh”
.m_coeffs;

301  *
	gthis
;

306 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

307 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
>& Qu©”niÚ<SÿÏr>::
İ”©Ü
=(cÚ¡ 
AngËAxisTy³
& 
¯
)

309 
SÿÏr
 
ha
 = SÿÏr(0.5)*
¯
.
ªgË
();

310 
	gthis
->
w
(èğ
ei_cos
(
ha
);

311 
	gthis
->
vec
(èğ
ei_sš
(
ha
è* 
¯
.
axis
();

312  *
	gthis
;

320 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

321 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

322 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
>& Qu©”niÚ<SÿÏr>::
İ”©Ü
=(cÚ¡ 
M©rixBa£
<
D”ived
>& 
x´
)

324 
ei_qu©”niÚ_assign_im¶
<
D”ived
>::
run
(*
this
, 
x´
.
d”ived
());

325  *
	gthis
;

329 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

330 
šlše
 
ty³Çme
 
	gQu©”niÚ
<
	gSÿÏr
>::
M©rix3


331 
Qu©”niÚ
<
SÿÏr
>::
	$toRÙ©iÚM©rix
() const

337 
M©rix3
 
»s
;

339 cÚ¡ 
SÿÏr
 
tx
 = 2*
this
->
	`x
();

340 cÚ¡ 
SÿÏr
 
ty
 = 2*
this
->
	`y
();

341 cÚ¡ 
SÿÏr
 
tz
 = 2*
this
->
	`z
();

342 cÚ¡ 
SÿÏr
 
twx
 = 
tx
*
this
->
	`w
();

343 cÚ¡ 
SÿÏr
 
twy
 = 
ty
*
this
->
	`w
();

344 cÚ¡ 
SÿÏr
 
twz
 = 
tz
*
this
->
	`w
();

345 cÚ¡ 
SÿÏr
 
txx
 = 
tx
*
this
->
	`x
();

346 cÚ¡ 
SÿÏr
 
txy
 = 
ty
*
this
->
	`x
();

347 cÚ¡ 
SÿÏr
 
txz
 = 
tz
*
this
->
	`x
();

348 cÚ¡ 
SÿÏr
 
tyy
 = 
ty
*
this
->
	`y
();

349 cÚ¡ 
SÿÏr
 
tyz
 = 
tz
*
this
->
	`y
();

350 cÚ¡ 
SÿÏr
 
tzz
 = 
tz
*
this
->
	`z
();

352 
»s
.
	`cÛffRef
(0,0èğ1-(
tyy
+
tzz
);

353 
»s
.
	`cÛffRef
(0,1èğ
txy
-
twz
;

354 
»s
.
	`cÛffRef
(0,2èğ
txz
+
twy
;

355 
»s
.
	`cÛffRef
(1,0èğ
txy
+
twz
;

356 
»s
.
	`cÛffRef
(1,1èğ1-(
txx
+
tzz
);

357 
»s
.
	`cÛffRef
(1,2èğ
tyz
-
twx
;

358 
»s
.
	`cÛffRef
(2,0èğ
txz
-
twy
;

359 
»s
.
	`cÛffRef
(2,1èğ
tyz
+
twx
;

360 
»s
.
	`cÛffRef
(2,2èğ1-(
txx
+
tyy
);

362  
»s
;

363 
	}
}

371 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

372 
	g‹m¶©e
<
ty³Çme
 
	gD”ived1
,y³Çm
	gD”ived2
>

373 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
>& Qu©”niÚ<SÿÏr>::
£tFromTwoVeùÜs
(cÚ¡ 
M©rixBa£
<
D”ived1
>& 
a
, cÚ¡ M©rixBa£<
D”ived2
>& 
b
)

375 
VeùÜ3
 
	gv0
 = 
a
.
nÜm®ized
();

376 
VeùÜ3
 
	gv1
 = 
b
.
nÜm®ized
();

377 
SÿÏr
 
	gc
 = 
v0
.
dÙ
(
v1
);

380 ià(
ei_isAµrox
(
c
,
SÿÏr
(1)))

383 
	gthis
->
w
(èğ1;his->
vec
().
£tZ”o
();

384  *
	gthis
;

387 ià(
ei_isAµrox
(
c
,
SÿÏr
(-1)))

389 
	gthis
->
vec
(èğ
v0
.
un™O¹hogÚ®
();

390 
	gthis
->
w
() = 0;

391  *
	gthis
;

394 
VeùÜ3
 
	gaxis
 = 
v0
.
üoss
(
v1
);

395 
SÿÏr
 
	gs
 = 
ei_sq¹
((SÿÏr(1)+
c
)*Scalar(2));

396 
SÿÏr
 
	gšvs
 = SÿÏr(1)/
s
;

397 
	gthis
->
vec
(èğ
axis
 * 
švs
;

398 
	gthis
->
w
(èğ
s
 * 
SÿÏr
(0.5);

400  *
	gthis
;

409 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

410 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
> Qu©”niÚ<SÿÏr>::
	$šv”£
() const

413 
SÿÏr
 
n2
 = 
this
->
	`squ¬edNÜm
();

414 ià(
n2
 > 0)

415  
	`Qu©”niÚ
(
	`cÚjug©e
().
	`cÛffs
(è/ 
n2
);

419  
	`Qu©”niÚ
(
CÛffic›Ás
::
	`Z”o
());

421 
	}
}

429 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

430 
šlše
 
	gQu©”niÚ
<
	gSÿÏr
> Qu©”niÚ<SÿÏr>::
	$cÚjug©e
() const

432  
	`Qu©”niÚ
(
this
->
	`w
(),-this->
	`x
(),-this->
	`y
(),-this->
	`z
());

433 
	}
}

438 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

439 
šlše
 
SÿÏr
 
	gQu©”niÚ
<
	gSÿÏr
>::
	$ªguÏrDi¡ªû
(cÚ¡ 
Qu©”niÚ
& 
Ùh”
) const

441 
d
 = 
	`ei_abs
(
this
->
	`dÙ
(
Ùh”
));

442 ià(
d
>=1.0)

444  
	`SÿÏr
(2è* 
¡d
::
	`acos
(
d
);

445 
	}
}

450 
	g‹m¶©e
 <
ty³Çme
 
	gSÿÏr
>

451 
	gQu©”niÚ
<
	gSÿÏr
> Qu©”niÚ<SÿÏr>::
	$¦”p
(
SÿÏr
 
t
, cÚ¡ 
Qu©”niÚ
& 
Ùh”
) const

453 cÚ¡ 
SÿÏr
 
Úe
 = 
	`SÿÏr
(1è- 
machše_•sÚ
<Scalar>();

454 
SÿÏr
 
d
 = 
this
->
	`dÙ
(
Ùh”
);

455 
SÿÏr
 
absD
 = 
	`ei_abs
(
d
);

457 
SÿÏr
 
sÿË0
;

458 
SÿÏr
 
sÿË1
;

460 ià(
absD
>=
Úe
)

462 
sÿË0
 = 
	`SÿÏr
(1è- 
t
;

463 
sÿË1
 = 
t
;

468 
SÿÏr
 
th‘a
 = 
¡d
::
	`acos
(
absD
);

469 
SÿÏr
 
sšTh‘a
 = 
	`ei_sš
(
th‘a
);

471 
sÿË0
 = 
	`ei_sš
ĞĞ
	`SÿÏr
(1è- 
t
 ) * 
th‘a
è/ 
sšTh‘a
;

472 
sÿË1
 = 
	`ei_sš
ĞĞ
t
 * 
th‘a
èè/ 
sšTh‘a
;

473 ià(
d
<0)

474 
sÿË1
 = -scale1;

477  
Qu©”niÚ
<
SÿÏr
>(
sÿË0
 * 
	`cÛffs
(è+ 
sÿË1
 * 
Ùh”
.coeffs());

478 
	}
}

481 
	g‹m¶©e
<
ty³Çme
 
	gOth”
>

482 
	gei_qu©”niÚ_assign_im¶
<
	gOth”
,3,3>

484 
ty³Çme
 
	tOth”
::
	tSÿÏr
 Scalar;

485 
šlše
 
run
(
Qu©”niÚ
<
SÿÏr
>& 
q
, cÚ¡ 
Oth”
& 
m©
)

489 
SÿÏr
 
	gt
 = 
m©
.
Œaû
();

490 ià(
	gt
 > 0)

492 
	gt
 = 
ei_sq¹
(
t
 + 
SÿÏr
(1.0));

493 
	gq
.
w
(èğ
SÿÏr
(0.5)*
t
;

494 
	gt
 = 
SÿÏr
(0.5)/
t
;

495 
	gq
.
x
(èğ(
m©
.
cÛff
(2,1è- 
	gm©
.cÛff(1,2)è* 
	gt
;

496 
	gq
.
y
(èğ(
m©
.
cÛff
(0,2è- 
	gm©
.cÛff(2,0)è* 
	gt
;

497 
	gq
.
z
(èğ(
m©
.
cÛff
(1,0è- 
	gm©
.cÛff(0,1)è* 
	gt
;

501 
	gi
 = 0;

502 ià(
	gm©
.
cÛff
(1,1) > mat.coeff(0,0))

503 
	gi
 = 1;

504 ià(
	gm©
.
cÛff
(2,2è> m©.cÛff(
i
,i))

505 
	gi
 = 2;

506 
	gj
 = (
i
+1)%3;

507 
	gk
 = (
j
+1)%3;

509 
	gt
 = 
ei_sq¹
(
m©
.
cÛff
(
i
,i)-m©.cÛff(
j
,j)-m©.cÛff(
k
,kè+ 
SÿÏr
(1.0));

510 
	gq
.
cÛffs
().
cÛffRef
(
i
èğ
SÿÏr
(0.5è* 
t
;

511 
	gt
 = 
SÿÏr
(0.5)/
t
;

512 
	gq
.
w
(èğ(
m©
.
cÛff
(
k
,
j
)-
	gm©
.cÛff(j,k))*
	gt
;

513 
	gq
.
cÛffs
().
cÛffRef
(
j
èğ(
m©
.
cÛff
(j,
i
)+
	gm©
.cÛff(i,j))*
	gt
;

514 
	gq
.
cÛffs
().
cÛffRef
(
k
èğ(
m©
.
cÛff
(k,
i
)+
	gm©
.cÛff(i,k))*
	gt
;

520 
	g‹m¶©e
<
ty³Çme
 
	gOth”
>

521 
	gei_qu©”niÚ_assign_im¶
<
	gOth”
,4,1>

523 
ty³Çme
 
	tOth”
::
	tSÿÏr
 Scalar;

524 
šlše
 
run
(
Qu©”niÚ
<
SÿÏr
>& 
q
, cÚ¡ 
Oth”
& 
vec
)

526 
	gq
.
cÛffs
(èğ
vec
;

	@robot/Eigen/src/Geometry/Rotation2D.h

25 #iâdeà
EIGEN_ROTATION2D_H


26 
	#EIGEN_ROTATION2D_H


	)

44 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
> 
	gei_Œa™s
<
	gRÙ©iÚ2D
<_Scalar> >

46 
_SÿÏr
 
	tSÿÏr
;

49 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
>

50 
şass
 
	gRÙ©iÚ2D
 : 
public
 
RÙ©iÚBa£
<
RÙ©iÚ2D
<
_SÿÏr
>,2>

52 
	gRÙ©iÚBa£
<
	tRÙ©iÚ2D
<
	t_SÿÏr
>,2> 
	tBa£
;

54 
	gpublic
:

56 
usšg
 
Ba£
::
İ”©Ü
*;

58 ’um { 
	gDim
 = 2 };

60 
_SÿÏr
 
	tSÿÏr
;

61 
	gM©rix
<
	tSÿÏr
,2,1> 
	tVeùÜ2
;

62 
	gM©rix
<
	tSÿÏr
,2,2> 
	tM©rix2
;

64 
	g´Ùeùed
:

66 
SÿÏr
 
m_ªgË
;

68 
	gpublic
:

71 
šlše
 
RÙ©iÚ2D
(
SÿÏr
 
a
è: 
m_ªgË
(a) {}

74 
šlše
 
SÿÏr
 
ªgË
(ècÚ¡ {  
m_ªgË
; }

77 
šlše
 
	gSÿÏr
& 
ªgË
(è{  
	gm_ªgË
; }

80 
šlše
 
RÙ©iÚ2D
 
šv”£
(ècÚ¡ {  -
	gm_ªgË
; }

83 
šlše
 
RÙ©iÚ2D
 
	gİ”©Ü
*(cÚ¡ 
	gRÙ©iÚ2D
& 
	gÙh”
) const

84 {  
	gm_ªgË
 + 
	gÙh”
.m_angle; }

87 
šlše
 
	gRÙ©iÚ2D
& 
	gİ”©Ü
*=(cÚ¡ 
RÙ©iÚ2D
& 
Ùh”
)

88 {  
m_ªgË
 +ğ
Ùh”
.m_ªgË;  *
	gthis
; }

91 
VeùÜ2
 
	gİ”©Ü
* (cÚ¡ 
	gVeùÜ2
& 
	gvec
) const

92 {  
toRÙ©iÚM©rix
(è* 
	gvec
; }

94 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

95 
	gRÙ©iÚ2D
& 
äomRÙ©iÚM©rix
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
);

96 
M©rix2
 
toRÙ©iÚM©rix
() const;

101 
šlše
 
RÙ©iÚ2D
 
¦”p
(
SÿÏr
 
t
, cÚ¡ RÙ©iÚ2D& 
Ùh”
) const

102 {  
	gm_ªgË
 * (1-
	gt
è+ 
	gÙh”
.
ªgË
() *; }

109 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

110 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gRÙ©iÚ2D
,RÙ©iÚ2D<
	gNewSÿÏrTy³
> >::
ty³
 
ÿ¡
() const

111 {  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
RÙ©iÚ2D
,
	gRÙ©iÚ2D
<
	gNewSÿÏrTy³
> >::
ty³
(*
this
); }

114 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

115 
šlše
 
ex¶ic™
 
RÙ©iÚ2D
(cÚ¡ RÙ©iÚ2D<
Oth”SÿÏrTy³
>& 
Ùh”
)

117 
	gm_ªgË
 = 
SÿÏr
(
Ùh”
.
ªgË
());

124 
boŞ
 
isAµrox
(cÚ¡ 
RÙ©iÚ2D
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

125 {  
ei_isAµrox
(
m_ªgË
,
Ùh”
.m_ªgË, 
´ec
); }

130 
	gRÙ©iÚ2D
<> 
	tRÙ©iÚ2Df
;

133 
	gRÙ©iÚ2D
<> 
	tRÙ©iÚ2Dd
;

139 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

140 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

141 
	gRÙ©iÚ2D
<
	gSÿÏr
>& RÙ©iÚ2D<SÿÏr>::
äomRÙ©iÚM©rix
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m©
)

143 
EIGEN_STATIC_ASSERT
(
D”ived
::
RowsAtCompeTime
==2 && D”ived::
CŞsAtCompeTime
==2,
YOU_MADE_A_PROGRAMMING_MISTAKE
)

144 
	gm_ªgË
 = 
ei_©ª2
(
m©
.
cÛff
(1,0), mat.coeff(0,0));

145  *
	gthis
;

150 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

151 
ty³Çme
 
	gRÙ©iÚ2D
<
	gSÿÏr
>::
M©rix2


152 
RÙ©iÚ2D
<
SÿÏr
>::
	$toRÙ©iÚM©rix
() const

154 
SÿÏr
 
sšA
 = 
	`ei_sš
(
m_ªgË
);

155 
SÿÏr
 
cosA
 = 
	`ei_cos
(
m_ªgË
);

156  (
	`M©rix2
(è<< 
cosA
, -
sšA
, sšA, cosA).
	`fšished
();

157 
	}
}

	@robot/Eigen/src/Geometry/RotationBase.h

25 #iâdeà
EIGEN_ROTATIONBASE_H


26 
	#EIGEN_ROTATIONBASE_H


	)

38 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
	g_Dim
>

39 şas 
	cRÙ©iÚBa£


41 
	mpublic
:

42 ’um { 
Dim
 = 
_Dim
 };

44 
ty³Çme
 
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
 Scalar;

47 
	gM©rix
<
	tSÿÏr
,
	tDim
,Dim> 
	tRÙ©iÚM©rixTy³
;

49 
šlše
 cÚ¡ 
	gD”ived
& 
	$d”ived
(ècÚ¡ {  *
¡©ic_ÿ¡
<cÚ¡ 
D”ived
*>(
this
); 
	}
}

50 
šlše
 
	gD”ived
& 
	$d”ived
(è{  *
¡©ic_ÿ¡
<
D”ived
*>(
this
); 
	}
}

53 
šlše
 
RÙ©iÚM©rixTy³
 
	$toRÙ©iÚM©rix
(ècÚ¡ {  
	`d”ived
().
	`toRÙ©iÚM©rix
(); 
	}
}

56 
šlše
 
D”ived
 
	$šv”£
(ècÚ¡ {  
	`d”ived
().
	`šv”£
(); 
	}
}

59 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
> 
	gİ”©Ü
*(cÚ¡ 
	gT¿n¦©iÚ
<SÿÏr,Dim>& 
	gt
) const

60 {  
toRÙ©iÚM©rix
(è* 
	gt
; }

63 
šlše
 
RÙ©iÚM©rixTy³
 
	gİ”©Ü
*(cÚ¡ 
	gSÿlšg
<
	gSÿÏr
,
	gDim
>& 
	gs
) const

64 {  
toRÙ©iÚM©rix
(è* 
	gs
; }

67 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
> 
	gİ”©Ü
*(cÚ¡ T¿nsfÜm<SÿÏr,Dim>& 
	gt
) const

68 {  
toRÙ©iÚM©rix
(è* 
	gt
; }

75 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜage
, 
	g_MaxRows
, 
	g_MaxCŞs
>

76 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

77 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜage
, 
	g_MaxRows
, 
	g_MaxCŞs
>

78 ::
M©rix
(cÚ¡ 
RÙ©iÚBa£
<
Oth”D”ived
,
CŞsAtCompeTime
>& 
r
)

80 
EIGEN_STATIC_ASSERT_MATRIX_SPECIFIC_SIZE
(
M©rix
,(
Oth”D”ived
::
Dim
),(OtherDerived::Dim))

81 *
this
 = 
r
.
toRÙ©iÚM©rix
();

88 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜage
, 
	g_MaxRows
, 
	g_MaxCŞs
>

89 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

90 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜage
, 
	g_MaxRows
, 
	g_MaxCŞs
>&

91 
	gM©rix
<
	g_SÿÏr
, 
	g_Rows
, 
	g_CŞs
, 
	g_StÜage
, 
	g_MaxRows
, 
	g_MaxCŞs
>

92 ::
İ”©Ü
=(cÚ¡ 
RÙ©iÚBa£
<
Oth”D”ived
,
	gCŞsAtCompeTime
>& 
	gr
)

94 
EIGEN_STATIC_ASSERT_MATRIX_SPECIFIC_SIZE
(
M©rix
,(
Oth”D”ived
::
Dim
),(OtherDerived::Dim))

95  *
this
 = 
r
.
toRÙ©iÚM©rix
();

116 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

117 
šlše
 
	gM©rix
<
	gSÿÏr
,2,2> 
	$ei_toRÙ©iÚM©rix
(cÚ¡ 
SÿÏr
& 
s
)

119 
	`EIGEN_STATIC_ASSERT
(
Dim
==2,
YOU_MADE_A_PROGRAMMING_MISTAKE
)

120  
RÙ©iÚ2D
<
SÿÏr
>(
s
).
	`toRÙ©iÚM©rix
();

121 
	}
}

123 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
,y³Çm
	gOth”D”ived
>

124 
šlše
 
	gM©rix
<
	gSÿÏr
,
	gDim
,Dim> 
ei_toRÙ©iÚM©rix
(cÚ¡ 
RÙ©iÚBa£
<
Oth”D”ived
,
Dim
>& 
r
)

126  
	gr
.
toRÙ©iÚM©rix
();

129 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
,y³Çm
	gOth”D”ived
>

130 
šlše
 cÚ¡ 
	gM©rixBa£
<
	gOth”D”ived
>& 
ei_toRÙ©iÚM©rix
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
m©
)

132 
EIGEN_STATIC_ASSERT
(
Oth”D”ived
::
RowsAtCompeTime
==
Dim
 && Oth”D”ived::
CŞsAtCompeTime
==Dim,

133 
YOU_MADE_A_PROGRAMMING_MISTAKE
)

134  
	gm©
;

	@robot/Eigen/src/Geometry/Scaling.h

25 #iâdeà
EIGEN_SCALING_H


26 
	#EIGEN_SCALING_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Dim
>

43 şas 
	cSÿlšg


45 
	mpublic
:

46 
	$EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
_SÿÏr
,
_Dim
)

48 ’um { 
Dim
 = 
_Dim
 };

50 
_SÿÏr
 
	tSÿÏr
;

52 
M©rix
<
	tSÿÏr
,
	tDim
,1> 
	tVeùÜTy³
;

54 
M©rix
<
	tSÿÏr
,
	tDim
,Dim> 
	tLš—rM©rixTy³
;

56 
T¿n¦©iÚ
<
	tSÿÏr
,
	tDim
> 
	tT¿n¦©iÚTy³
;

58 
T¿nsfÜm
<
	tSÿÏr
,
	tDim
> 
	tT¿nsfÜmTy³
;

60 
´Ùeùed
:

62 
VeùÜTy³
 
m_cÛffs
;

64 
public
:

67 
	$Sÿlšg
(è{
	}
}

69 
ex¶ic™
 
šlše
 
	$Sÿlšg
(cÚ¡ 
SÿÏr
& 
s
è{ 
m_cÛffs
.
	`£tCÚ¡ªt
(s); 
	}
}

71 
šlše
 
	$Sÿlšg
(cÚ¡ 
SÿÏr
& 
sx
, cÚ¡ SÿÏr& 
sy
)

73 
	`ei_as£¹
(
Dim
==2);

74 
m_cÛffs
.
	`x
(èğ
sx
;

75 
m_cÛffs
.
	`y
(èğ
sy
;

76 
	}
}

78 
šlše
 
	$Sÿlšg
(cÚ¡ 
SÿÏr
& 
sx
, cÚ¡ SÿÏr& 
sy
, cÚ¡ SÿÏr& 
sz
)

80 
	`ei_as£¹
(
Dim
==3);

81 
m_cÛffs
.
	`x
(èğ
sx
;

82 
m_cÛffs
.
	`y
(èğ
sy
;

83 
m_cÛffs
.
	`z
(èğ
sz
;

84 
	}
}

86 
ex¶ic™
 
šlše
 
	$Sÿlšg
(cÚ¡ 
VeùÜTy³
& 
cÛffs
è: 
	$m_cÛffs
(
cÛffs
è{
	}
}

88 cÚ¡ 
VeùÜTy³
& 
	$cÛffs
(ècÚ¡ {  
m_cÛffs
; 
	}
}

89 
	gVeùÜTy³
& 
	$cÛffs
(è{  
m_cÛffs
; 
	}
}

92 
šlše
 
Sÿlšg
 
	gİ”©Ü
* (cÚ¡ 
	gSÿlšg
& 
	gÙh”
) const

93 {  
Sÿlšg
(
cÛffs
().
cwi£
(è* 
Ùh”
.coeffs()); }

96 
šlše
 
T¿nsfÜmTy³
 
	gİ”©Ü
* (cÚ¡ 
	gT¿n¦©iÚTy³
& 
	gt
) const;

99 
šlše
 
T¿nsfÜmTy³
 
	gİ”©Ü
* (cÚ¡ 
	gT¿nsfÜmTy³
& 
	gt
) const;

103 
šlše
 
Lš—rM©rixTy³
 
	gİ”©Ü
* (cÚ¡ 
	gLš—rM©rixTy³
& 
	gÙh”
) const

104 {  
cÛffs
().
asDŸgÚ®
(è* 
	gÙh”
; }

108 
ä›nd
 
šlše
 
Lš—rM©rixTy³
 
	gİ”©Ü
* (cÚ¡ 
	gLš—rM©rixTy³
& 
	gÙh”
, cÚ¡ 
	gSÿlšg
& 
	gs
)

109 {  
Ùh”
 * 
	gs
.
cÛffs
().
asDŸgÚ®
(); }

111 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

112 
šlše
 
Lš—rM©rixTy³
 
	gİ”©Ü
*(cÚ¡ 
	gRÙ©iÚBa£
<
	gD”ived
,
	gDim
>& 
	gr
) const

113 {  *
this
 * 
	gr
.
toRÙ©iÚM©rix
(); }

116 
šlše
 
VeùÜTy³
 
	gİ”©Ü
* (cÚ¡ 
	gVeùÜTy³
& 
	gÙh”
) const

117 {  
cÛffs
().
asDŸgÚ®
(è* 
	gÙh”
; }

120 
šlše
 
Sÿlšg
 
	$šv”£
() const

121 {  
	`Sÿlšg
(
	`cÛffs
().
	`cwi£
().
	`šv”£
()); 
	}
}

123 
šlše
 
	gSÿlšg
& 
	gİ”©Ü
=(cÚ¡ 
Sÿlšg
& 
Ùh”
)

125 
m_cÛffs
 = 
Ùh”
.m_coeffs;

126  *
	gthis
;

134 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

135 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gSÿlšg
,Sÿlšg<
	gNewSÿÏrTy³
,
	gDim
> >::
ty³
 
	$ÿ¡
() const

136 {  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
Sÿlšg
,Sÿlšg<
NewSÿÏrTy³
,
Dim
> >::
	`ty³
(*
this
); 
	}
}

139 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

140 
šlše
 
ex¶ic™
 
Sÿlšg
(cÚ¡ Sÿlšg<
Oth”SÿÏrTy³
,
Dim
>& 
Ùh”
)

141 { 
	gm_cÛffs
 = 
Ùh”
.
cÛffs
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>(); }

147 
boŞ
 
isAµrox
(cÚ¡ 
Sÿlšg
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

148 {  
m_cÛffs
.
isAµrox
(
Ùh”
.m_cÛffs, 
´ec
); }

154 
	gSÿlšg
<, 2> 
	tSÿlšg2f
;

155 
	gSÿlšg
<,2> 
	tSÿlšg2d
;

156 
	gSÿlšg
<, 3> 
	tSÿlšg3f
;

157 
	gSÿlšg
<,3> 
	tSÿlšg3d
;

160 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

161 
šlše
 
ty³Çme
 
	gSÿlšg
<
	gSÿÏr
,
	gDim
>::
T¿nsfÜmTy³


162 
Sÿlšg
<
SÿÏr
,
	gDim
>::
İ”©Ü
* (cÚ¡ 
T¿n¦©iÚTy³
& 
t
) const

164 
T¿nsfÜmTy³
 
»s
;

165 
	g»s
.
m©rix
().
£tZ”o
();

166 
	g»s
.
lš—r
().
dŸgÚ®
(èğ
cÛffs
();

167 
	g»s
.
Œª¦©iÚ
(èğ
m_cÛffs
.
cwi£
(è* 
t
.
veùÜ
();

168 
»s
(
Dim
,Dimèğ
SÿÏr
(1);

169  
	g»s
;

172 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

173 
šlše
 
ty³Çme
 
	gSÿlšg
<
	gSÿÏr
,
	gDim
>::
T¿nsfÜmTy³


174 
Sÿlšg
<
SÿÏr
,
	gDim
>::
İ”©Ü
* (cÚ¡ 
T¿nsfÜmTy³
& 
t
) const

176 
T¿nsfÜmTy³
 
»s
 = 
t
;

177 
	g»s
.
´esÿË
(
m_cÛffs
);

178  
	g»s
;

	@robot/Eigen/src/Geometry/Transform.h

26 #iâdeà
EIGEN_TRANSFORM_H


27 
	#EIGEN_TRANSFORM_H


	)

30 
	eT¿nsfÜmT¿™s
 {

31 
	mIsom‘ry
,

32 
	mAffše
,

33 
	mProjeùive


39 
	g‹m¶©e
< 
ty³Çme
 
	gOth”
,

40 
	gDim
,

41 
	gHDim
,

42 
	gOth”Rows
=
Oth”
::
RowsAtCompeTime
,

43 
	gOth”CŞs
=
Oth”
::
CŞsAtCompeTime
>

44 
ei_ŒªsfÜm_´oduù_im¶
;

63 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Dim
>

64 şas 
	cT¿nsfÜm


66 
	mpublic
:

67 
EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
_SÿÏr
,
_Dim
==
DyÇmic
 ? Dynamic : (_Dim+1)*(_Dim+1))

69 
Dim
 = 
_Dim
,

70 
	mHDim
 = 
_Dim
+1

73 
_SÿÏr
 
	tSÿÏr
;

75 
	gM©rix
<
	tSÿÏr
,
	tHDim
,HDim> 
	tM©rixTy³
;

77 
	gM©rix
<
	tSÿÏr
,
	tDim
,Dim> 
	tLš—rM©rixTy³
;

79 
	gBlock
<
	tM©rixTy³
,
	tDim
,Dim> 
	tLš—rP¬t
;

81 
	gM©rix
<
	tSÿÏr
,
	tDim
,1> 
	tVeùÜTy³
;

83 
	gBlock
<
	tM©rixTy³
,
	tDim
,1> 
	tT¿n¦©iÚP¬t
;

85 
	gT¿n¦©iÚ
<
	tSÿÏr
,
	tDim
> 
	tT¿n¦©iÚTy³
;

87 
	gSÿlšg
<
	tSÿÏr
,
	tDim
> 
	tSÿlšgTy³
;

89 
	g´Ùeùed
:

91 
M©rixTy³
 
m_m©rix
;

93 
	gpublic
:

96 
šlše
 
	$T¿nsfÜm
(è{ 
	}
}

98 
šlše
 
	$T¿nsfÜm
(cÚ¡ 
T¿nsfÜm
& 
Ùh”
)

100 
m_m©rix
 = 
Ùh”
.m_matrix;

101 
	}
}

103 
šlše
 
ex¶ic™
 
	$T¿nsfÜm
(cÚ¡ 
T¿n¦©iÚTy³
& 
t
è{ *
this
 =; 
	}
}

104 
šlše
 
ex¶ic™
 
	$T¿nsfÜm
(cÚ¡ 
SÿlšgTy³
& 
s
è{ *
this
 = s; 
	}
}

105 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

106 
šlše
 
ex¶ic™
 
T¿nsfÜm
(cÚ¡ 
RÙ©iÚBa£
<
D”ived
, 
Dim
>& 
r
è{ *
	gthis
 =„; }

108 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
=(cÚ¡ 
T¿nsfÜm
& 
Ùh”
)

109 { 
m_m©rix
 = 
Ùh”
.m_m©rix;  *
	gthis
; }

111 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
, 
boŞ
 
	gBigM©rix
>

112 
	scÚ¡ruù_äom_m©rix


114 
šlše
 
run
(
T¿nsfÜm
 *
ŒªsfÜm
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

116 
	gŒªsfÜm
->
m©rix
(èğ
Ùh”
;

120 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
> 
	gcÚ¡ruù_äom_m©rix
<Oth”D”ived, 
	gŒue
>

122 
šlše
 
run
(
T¿nsfÜm
 *
ŒªsfÜm
, cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

124 
	gŒªsfÜm
->
lš—r
(èğ
Ùh”
;

125 
	gŒªsfÜm
->
Œª¦©iÚ
().
£tZ”o
();

126 
	gŒªsfÜm
->
m©rix
()(
	gDim
,Dimèğ
SÿÏr
(1);

127 
	gŒªsfÜm
->
m©rix
().
‹m¶©e
 
	gblock
<1,
	gDim
>(Dim,0).
£tZ”o
();

132 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

133 
šlše
 
ex¶ic™
 
T¿nsfÜm
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

135 
	gcÚ¡ruù_äom_m©rix
<
	gOth”D”ived
, (Oth”D”ived::
RowsAtCompeTime
è=ğ
Dim
>::
run
(
this
, 
Ùh”
);

139 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

140 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
=(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

141 { 
m_m©rix
 = 
Ùh”
;  *
	gthis
; }

143 #ifdeà
EIGEN_QT_SUPPORT


144 
šlše
 
T¿nsfÜm
(cÚ¡ 
QM©rix
& 
Ùh”
);

145 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
=(cÚ¡ 
QM©rix
& 
Ùh”
);

146 
šlše
 
QM©rix
 
	$toQM©rix
() const;

147 
šlše
 
	`T¿nsfÜm
(cÚ¡ 
QT¿nsfÜm
& 
Ùh”
);

148 
šlše
 
T¿nsfÜm
& 
İ”©Ü
=(cÚ¡ 
QT¿nsfÜm
& 
Ùh”
);

149 
šlše
 
QT¿nsfÜm
 
	$toQT¿nsfÜm
() const;

154 
šlše
 
SÿÏr
 
	$İ”©Ü
(è(
row
, 
cŞ
ècÚ¡ {  
	`m_m©rix
Ôow,cŞ); 
	}
}

157 
šlše
 
	gSÿÏr
& 
	$İ”©Ü
(è(
row
, 
cŞ
è{  
	`m_m©rix
Ôow,cŞ); 
	}
}

160 
šlše
 cÚ¡ 
	gM©rixTy³
& 
	$m©rix
(ècÚ¡ {  
m_m©rix
; 
	}
}

162 
šlše
 
	gM©rixTy³
& 
	$m©rix
(è{  
m_m©rix
; 
	}
}

165 
šlše
 cÚ¡ 
Lš—rP¬t
 
	$lš—r
(ècÚ¡ {  
m_m©rix
.
‹m¶©e
 
block
<
Dim
,Dim>(0,0); 
	}
}

167 
šlše
 
Lš—rP¬t
 
	$lš—r
(è{  
m_m©rix
.
‹m¶©e
 
block
<
Dim
,Dim>(0,0); 
	}
}

170 
šlše
 cÚ¡ 
T¿n¦©iÚP¬t
 
	$Œª¦©iÚ
(ècÚ¡ {  
m_m©rix
.
‹m¶©e
 
block
<
Dim
,1>(0,Dim); 
	}
}

172 
šlše
 
T¿n¦©iÚP¬t
 
	$Œª¦©iÚ
(è{  
m_m©rix
.
‹m¶©e
 
block
<
Dim
,1>(0,Dim); 
	}
}

182 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

183 
šlše
 cÚ¡ 
ty³Çme
 
	gei_ŒªsfÜm_´oduù_im¶
<
	gOth”D”ived
,
	g_Dim
,_Dim+1>::
ResuÉTy³


184 
İ”©Ü
 * (cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

185 {  
ei_ŒªsfÜm_´oduù_im¶
<
Oth”D”ived
,
	gDim
,
	gHDim
>::
run
(*
this
,
Ùh”
.
d”ived
()); }

189 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

190 
ä›nd
 
šlše
 cÚ¡ 
ty³Çme
 
	gProduùR‘uºTy³
<
	gOth”D”ived
,
	gM©rixTy³
>::
Ty³


191 
İ”©Ü
 * (cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
a
, cÚ¡ 
	gT¿nsfÜm
 &
	gb
)

192 {  
	ga
.
d”ived
(è* 
	gb
.
m©rix
(); }

195 
šlše
 cÚ¡ 
T¿nsfÜm


196 
	gİ”©Ü
 * (cÚ¡ 
	gT¿nsfÜm
& 
	gÙh”
) const

197 {  
T¿nsfÜm
(
m_m©rix
 * 
Ùh”
.
m©rix
()); }

200 
	$£tId’t™y
(è{ 
m_m©rix
.
	`£tId’t™y
(); 
	}
}

201 cÚ¡ 
ty³Çme
 
	gM©rixTy³
::
Id’t™yR‘uºTy³
 
	$Id’t™y
()

203  
M©rixTy³
::
	`Id’t™y
();

204 
	}
}

206 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

207 
šlše
 
	gT¿nsfÜm
& 
sÿË
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
);

209 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

210 
šlše
 
	gT¿nsfÜm
& 
´esÿË
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
);

212 
šlše
 
	gT¿nsfÜm
& 
sÿË
(
SÿÏr
 
s
);

213 
šlše
 
	gT¿nsfÜm
& 
´esÿË
(
SÿÏr
 
s
);

215 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

216 
šlše
 
	gT¿nsfÜm
& 
Œª¦©e
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
);

218 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

219 
šlše
 
	gT¿nsfÜm
& 
´‘¿n¦©e
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
);

221 
	g‹m¶©e
<
ty³Çme
 
	gRÙ©iÚTy³
>

222 
šlše
 
	gT¿nsfÜm
& 
rÙ©e
(cÚ¡ 
RÙ©iÚTy³
& 
rÙ©iÚ
);

224 
	g‹m¶©e
<
ty³Çme
 
	gRÙ©iÚTy³
>

225 
šlše
 
	gT¿nsfÜm
& 
´”Ù©e
(cÚ¡ 
RÙ©iÚTy³
& 
rÙ©iÚ
);

227 
	gT¿nsfÜm
& 
sh—r
(
SÿÏr
 
sx
, SÿÏ¸
sy
);

228 
	gT¿nsfÜm
& 
´esh—r
(
SÿÏr
 
sx
, SÿÏ¸
sy
);

230 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
=(cÚ¡ 
T¿n¦©iÚTy³
& 
t
);

231 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
*=(cÚ¡ 
T¿n¦©iÚTy³
& 
t
è{  
Œª¦©e
Ñ.
veùÜ
()); }

232 
šlše
 
T¿nsfÜm
 
	gİ”©Ü
*(cÚ¡ 
	gT¿n¦©iÚTy³
& 
	gt
) const;

234 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
=(cÚ¡ 
SÿlšgTy³
& 
t
);

235 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
*=(cÚ¡ 
SÿlšgTy³
& 
s
è{  
sÿË
(s.
cÛffs
()); }

236 
šlše
 
T¿nsfÜm
 
	gİ”©Ü
*(cÚ¡ 
	gSÿlšgTy³
& 
	gs
) const;

237 
ä›nd
 
šlše
 
T¿nsfÜm
 
	gİ”©Ü
*(cÚ¡ 
	gLš—rM©rixTy³
& 
	gm©
, cÚ¡ 
	gT¿nsfÜm
& 
	gt
)

239 
T¿nsfÜm
 
	g»s
 = 
t
;

240 
	g»s
.
m©rix
().
row
(
Dim
èğ
t
.matrix().row(Dim);

241 
	g»s
.
m©rix
().
‹m¶©e
 
	gblock
<
	gDim
,
	gHDim
>(0,0èğ(
m©
 * 
t
.m©rix().‹m¶©
block
<
Dim
,HDim>(0,0)).
Ïzy
();

242  
	g»s
;

245 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

246 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
=(cÚ¡ 
RÙ©iÚBa£
<
D”ived
,
	gDim
>& 
	gr
);

247 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

248 
šlše
 
	gT¿nsfÜm
& 
	gİ”©Ü
*=(cÚ¡ 
RÙ©iÚBa£
<
D”ived
,
	gDim
>& 
	gr
è{  
rÙ©e
(
r
.
toRÙ©iÚM©rix
()); }

249 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

250 
šlše
 
T¿nsfÜm
 
	gİ”©Ü
*(cÚ¡ 
	gRÙ©iÚBa£
<
	gD”ived
,
	gDim
>& 
	gr
) const;

252 
Lš—rM©rixTy³
 
	$rÙ©iÚ
() const;

253 
‹m¶©e
<
ty³Çme
 
RÙ©iÚM©rixTy³
,y³Çm
SÿlšgM©rixTy³
>

254 
	$compu‹RÙ©iÚSÿlšg
(
RÙ©iÚM©rixTy³
 *
rÙ©iÚ
, 
SÿlšgM©rixTy³
 *
sÿlšg
) const;

255 
‹m¶©e
<
ty³Çme
 
SÿlšgM©rixTy³
,y³Çm
RÙ©iÚM©rixTy³
>

256 
	$compu‹SÿlšgRÙ©iÚ
(
SÿlšgM©rixTy³
 *
sÿlšg
, 
RÙ©iÚM©rixTy³
 *
rÙ©iÚ
) const;

258 
‹m¶©e
<
ty³Çme
 
Pos™iÚD”ived
,y³Çm
Or›Á©iÚTy³
,y³Çm
SÿËD”ived
>

259 
T¿nsfÜm
& 
	`äomPos™iÚOr›Á©iÚSÿË
(cÚ¡ 
M©rixBa£
<
Pos™iÚD”ived
> &
pos™iÚ
,

260 cÚ¡ 
Or›Á©iÚTy³
& 
Ü›Á©iÚ
, cÚ¡ 
M©rixBa£
<
SÿËD”ived
> &
sÿË
);

262 
šlše
 cÚ¡ 
M©rixTy³
 
	$šv”£
(
T¿nsfÜmT¿™s
 
Œa™s
 = 
Affše
) const;

265 cÚ¡ 
SÿÏr
* 
	$d©a
(ècÚ¡ {  
m_m©rix
.
	`d©a
(); 
	}
}

267 
SÿÏr
* 
	$d©a
(è{  
m_m©rix
.
	`d©a
(); 
	}
}

274 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

275 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gT¿nsfÜm
,T¿nsfÜm<
	gNewSÿÏrTy³
,
	gDim
> >::
ty³
 
	$ÿ¡
() const

276 {  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
T¿nsfÜm
,T¿nsfÜm<
NewSÿÏrTy³
,
Dim
> >::
	`ty³
(*
this
); 
	}
}

279 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

280 
šlše
 
ex¶ic™
 
T¿nsfÜm
(cÚ¡ T¿nsfÜm<
Oth”SÿÏrTy³
,
Dim
>& 
Ùh”
)

281 { 
	gm_m©rix
 = 
Ùh”
.
m©rix
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>(); }

287 
boŞ
 
isAµrox
(cÚ¡ 
T¿nsfÜm
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

288 {  
m_m©rix
.
isAµrox
(
Ùh”
.m_m©rix, 
´ec
); }

290 #ifdeà
EIGEN_TRANSFORM_PLUGIN


291 #šşud
EIGEN_TRANSFORM_PLUGIN


294 
	g´Ùeùed
:

299 
	gT¿nsfÜm
<,2> 
	tT¿nsfÜm2f
;

301 
	gT¿nsfÜm
<,3> 
	tT¿nsfÜm3f
;

303 
	gT¿nsfÜm
<,2> 
	tT¿nsfÜm2d
;

305 
	gT¿nsfÜm
<,3> 
	tT¿nsfÜm3d
;

311 #ifdeà
EIGEN_QT_SUPPORT


316 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

317 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$T¿nsfÜm
(cÚ¡ 
QM©rix
& 
Ùh”
)

319 *
this
 = 
Ùh”
;

320 
	}
}

326 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

327 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>& T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
=(cÚ¡ 
QM©rix
& 
Ùh”
)

329 
EIGEN_STATIC_ASSERT
(
Dim
==2, 
YOU_MADE_A_PROGRAMMING_MISTAKE
)

330 
	gm_m©rix
 << 
	gÙh”
.
m11
(), oth”.
m21
(), oth”.
dx
(),

331 
	gÙh”
.
m12
(), oth”.
m22
(), oth”.
dy
(),

333  *
	gthis
;

342 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

343 
QM©rix
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$toQM©rix
() const

345 
	`EIGEN_STATIC_ASSERT
(
Dim
==2, 
YOU_MADE_A_PROGRAMMING_MISTAKE
)

346  
	`QM©rix
(
m_m©rix
.
	`cÛff
(0,0), m_matrix.coeff(1,0),

347 
m_m©rix
.
	`cÛff
(0,1), m_matrix.coeff(1,1),

348 
m_m©rix
.
	`cÛff
(0,2), m_matrix.coeff(1,2));

349 
	}
}

355 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

356 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$T¿nsfÜm
(cÚ¡ 
QT¿nsfÜm
& 
Ùh”
)

358 *
this
 = 
Ùh”
;

359 
	}
}

365 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

366 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>& T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
=(cÚ¡ 
QT¿nsfÜm
& 
Ùh”
)

368 
EIGEN_STATIC_ASSERT
(
Dim
==2, 
YOU_MADE_A_PROGRAMMING_MISTAKE
)

369 
	gm_m©rix
 << 
	gÙh”
.
m11
(), oth”.
m21
(), oth”.
dx
(),

370 
	gÙh”
.
m12
(), oth”.
m22
(), oth”.
dy
(),

371 
	gÙh”
.
m13
(), oth”.
m23
(), oth”.
m33
();

372  *
	gthis
;

379 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

380 
QT¿nsfÜm
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$toQT¿nsfÜm
() const

382 
	`EIGEN_STATIC_ASSERT
(
Dim
==2, 
YOU_MADE_A_PROGRAMMING_MISTAKE
)

383  
	`QT¿nsfÜm
(
m_m©rix
.
	`cÛff
(0,0), m_matrix.coeff(1,0), m_matrix.coeff(2,0),

384 
m_m©rix
.
	`cÛff
(0,1), m_matrix.coeff(1,1), m_matrix.coeff(2,1),

385 
m_m©rix
.
	`cÛff
(0,2), m_matrix.coeff(1,2), m_matrix.coeff(2,2));

386 
	}
}

397 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

398 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

399 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

400 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
sÿË
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

402 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
Oth”D”ived
,(
Dim
))

403 
lš—r
(èğÖš—r(è* 
Ùh”
.
asDŸgÚ®
()).
Ïzy
();

404  *
	gthis
;

411 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

412 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>& T¿nsfÜm<SÿÏr,Dim>::
	$sÿË
(
SÿÏr
 
s
)

414 
	`lš—r
(è*ğ
s
;

415  *
this
;

416 
	}
}

422 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

423 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

424 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

425 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
´esÿË
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

427 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
Oth”D”ived
,(
Dim
))

428 
	gm_m©rix
.
‹m¶©e
 
	gblock
<
	gDim
,
	gHDim
>(0,0èğ(
Ùh”
.
asDŸgÚ®
(è* 
m_m©rix
.‹m¶©
block
<
Dim
,HDim>(0,0)).
Ïzy
();

429  *
	gthis
;

436 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

437 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>& T¿nsfÜm<SÿÏr,Dim>::
	$´esÿË
(
SÿÏr
 
s
)

439 
m_m©rix
.
‹m¶©e
 
cÜÃr
<
Dim
,
HDim
>(
TİLeá
è*ğ
s
;

440  *
this
;

441 
	}
}

447 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

448 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

449 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

450 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
Œª¦©e
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

452 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
Oth”D”ived
,(
Dim
))

453 
Œª¦©iÚ
(è+ğ
lš—r
(è* 
Ùh”
;

454  *
	gthis
;

461 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

462 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

463 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

464 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
´‘¿n¦©e
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

466 
EIGEN_STATIC_ASSERT_VECTOR_SPECIFIC_SIZE
(
Oth”D”ived
,(
Dim
))

467 
Œª¦©iÚ
(è+ğ
Ùh”
;

468  *
	gthis
;

488 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

489 
	g‹m¶©e
<
ty³Çme
 
	gRÙ©iÚTy³
>

490 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

491 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$rÙ©e
(cÚ¡ 
RÙ©iÚTy³
& 
rÙ©iÚ
)

493 
	`lš—r
(è*ğ
ei_toRÙ©iÚM©rix
<
SÿÏr
,
Dim
>(
rÙ©iÚ
);

494  *
this
;

495 
	}
}

504 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

505 
	g‹m¶©e
<
ty³Çme
 
	gRÙ©iÚTy³
>

506 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

507 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$´”Ù©e
(cÚ¡ 
RÙ©iÚTy³
& 
rÙ©iÚ
)

509 
m_m©rix
.
‹m¶©e
 
block
<
Dim
,
HDim
>(0,0èğ
ei_toRÙ©iÚM©rix
<
SÿÏr
,Dim>(
rÙ©iÚ
)

510 * 
m_m©rix
.
‹m¶©e
 
block
<
Dim
,
HDim
>(0,0);

511  *
this
;

512 
	}
}

519 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

520 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

521 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$sh—r
(
SÿÏr
 
sx
, SÿÏ¸
sy
)

523 
	`EIGEN_STATIC_ASSERT
((
Dim
)==2, 
YOU_MADE_A_PROGRAMMING_MISTAKE
)

524 
VeùÜTy³
 
tmp
 = 
	`lš—r
().
	`cŞ
(0)*
sy
 +†inear().col(1);

525 
	`lš—r
(è<<†š—r().
	`cŞ
(0è+†š—r().cŞ(1)*
sx
, 
tmp
;

526  *
this
;

527 
	}
}

534 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

535 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

536 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$´esh—r
(
SÿÏr
 
sx
, SÿÏ¸
sy
)

538 
	`EIGEN_STATIC_ASSERT
((
Dim
)==2, 
YOU_MADE_A_PROGRAMMING_MISTAKE
)

539 
m_m©rix
.
‹m¶©e
 
block
<
Dim
,
HDim
>(0,0èğ
	`Lš—rM©rixTy³
(1, 
sx
, 
sy
, 1) * m_matrix.template block<Dim,HDim>(0,0);

540  *
this
;

541 
	}
}

547 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

548 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>& T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
=(cÚ¡ 
T¿n¦©iÚTy³
& 
t
)

550 
lš—r
().
£tId’t™y
();

551 
Œª¦©iÚ
(èğ
t
.
veùÜ
();

552 
	gm_m©rix
.
‹m¶©e
 
	gblock
<1,
	gDim
>(Dim,0).
£tZ”o
();

553 
m_m©rix
(
Dim
,Dimèğ
SÿÏr
(1);

554  *
	gthis
;

557 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

558 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
> T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
*(cÚ¡ 
T¿n¦©iÚTy³
& 
t
) const

560 
T¿nsfÜm
 
»s
 = *
this
;

561 
	g»s
.
Œª¦©e
(
t
.
veùÜ
());

562  
	g»s
;

565 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

566 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>& T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
=(cÚ¡ 
SÿlšgTy³
& 
s
)

568 
m_m©rix
.
£tZ”o
();

569 
lš—r
().
dŸgÚ®
(èğ
s
.
cÛffs
();

570 
	gm_m©rix
.
cÛffRef
(
Dim
,Dimèğ
SÿÏr
(1);

571  *
	gthis
;

574 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

575 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
> T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
*(cÚ¡ 
SÿlšgTy³
& 
s
) const

577 
T¿nsfÜm
 
»s
 = *
this
;

578 
	g»s
.
sÿË
(
s
.
cÛffs
());

579  
	g»s
;

582 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

583 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

584 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>& T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
=(cÚ¡ 
RÙ©iÚBa£
<
D”ived
,Dim>& 
	gr
)

586 
lš—r
(èğ
ei_toRÙ©iÚM©rix
<
SÿÏr
,
	gDim
>(
	gr
);

587 
Œª¦©iÚ
().
£tZ”o
();

588 
	gm_m©rix
.
‹m¶©e
 
	gblock
<1,
	gDim
>(Dim,0).
£tZ”o
();

589 
	gm_m©rix
.
cÛffRef
(
Dim
,Dimèğ
SÿÏr
(1);

590  *
	gthis
;

593 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

594 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

595 
šlše
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
> T¿nsfÜm<SÿÏr,Dim>::
İ”©Ü
*(cÚ¡ 
RÙ©iÚBa£
<
D”ived
,Dim>& 
	gr
) const

597 
T¿nsfÜm
 
	g»s
 = *
this
;

598 
	g»s
.
rÙ©e
(
r
.
d”ived
());

599  
	g»s
;

613 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

614 
ty³Çme
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
Lš—rM©rixTy³


615 
T¿nsfÜm
<
SÿÏr
,
	gDim
>::
	$rÙ©iÚ
() const

617 
Lš—rM©rixTy³
 
»suÉ
;

618 
	`compu‹RÙ©iÚSÿlšg
(&
»suÉ
, (
Lš—rM©rixTy³
*)0);

619  
»suÉ
;

620 
	}
}

634 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

635 
	g‹m¶©e
<
ty³Çme
 
	gRÙ©iÚM©rixTy³
,y³Çm
	gSÿlšgM©rixTy³
>

636 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$compu‹RÙ©iÚSÿlšg
(
RÙ©iÚM©rixTy³
 *
rÙ©iÚ
, 
SÿlšgM©rixTy³
 *
sÿlšg
) const

638 
	`lš—r
().
	`svd
().
	`compu‹RÙ©iÚSÿlšg
(
rÙ©iÚ
, 
sÿlšg
);

639 
	}
}

652 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

653 
	g‹m¶©e
<
ty³Çme
 
	gSÿlšgM©rixTy³
,y³Çm
	gRÙ©iÚM©rixTy³
>

654 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
	$compu‹SÿlšgRÙ©iÚ
(
SÿlšgM©rixTy³
 *
sÿlšg
, 
RÙ©iÚM©rixTy³
 *
rÙ©iÚ
) const

656 
	`lš—r
().
	`svd
().
	`compu‹SÿlšgRÙ©iÚ
(
sÿlšg
, 
rÙ©iÚ
);

657 
	}
}

662 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

663 
	g‹m¶©e
<
ty³Çme
 
	gPos™iÚD”ived
,y³Çm
	gOr›Á©iÚTy³
,y³Çm
	gSÿËD”ived
>

664 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>&

665 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
äomPos™iÚOr›Á©iÚSÿË
(cÚ¡ 
M©rixBa£
<
Pos™iÚD”ived
> &
pos™iÚ
,

666 cÚ¡ 
Or›Á©iÚTy³
& 
Ü›Á©iÚ
, cÚ¡ 
M©rixBa£
<
SÿËD”ived
> &
sÿË
)

668 
lš—r
(èğ
ei_toRÙ©iÚM©rix
<
SÿÏr
,
	gDim
>(
	gÜ›Á©iÚ
);

669 
lš—r
(è*ğ
sÿË
.
asDŸgÚ®
();

670 
Œª¦©iÚ
(èğ
pos™iÚ
;

671 
	gm_m©rix
.
‹m¶©e
 
	gblock
<1,
	gDim
>(Dim,0).
£tZ”o
();

672 
m_m©rix
(
Dim
,Dimèğ
SÿÏr
(1);

673  *
	gthis
;

695 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

696 
šlše
 cÚ¡ 
ty³Çme
 
	gT¿nsfÜm
<
	gSÿÏr
,
	gDim
>::
M©rixTy³


697 
T¿nsfÜm
<
SÿÏr
,
	gDim
>::
	$šv”£
(
T¿nsfÜmT¿™s
 
Œa™s
) const

699 ià(
Œa™s
 =ğ
Projeùive
)

701  
m_m©rix
.
	`šv”£
();

705 
M©rixTy³
 
»s
;

706 ià(
Œa™s
 =ğ
Affše
)

708 
»s
.
‹m¶©e
 
cÜÃr
<
Dim
,Dim>(
TİLeá
èğ
	`lš—r
().
	`šv”£
();

710 ià(
Œa™s
 =ğ
Isom‘ry
)

712 
»s
.
‹m¶©e
 
cÜÃr
<
Dim
,Dim>(
TİLeá
èğ
	`lš—r
().
	`Œª¥o£
();

716 
	`ei_as£¹
("invalidraits value in Transform::inverse()");

719 
»s
.
‹m¶©e
 
cÜÃr
<
Dim
,1>(
TİRight
èğ-„es.‹m¶©cÜÃr<Dim,Dim>(
TİLeá
è* 
	`Œª¦©iÚ
();

720 
»s
.
‹m¶©e
 
cÜÃr
<1,
Dim
>(
BÙtomLeá
).
	`£tZ”o
();

721 
»s
.
	`cÛffRef
(
Dim
,Dimèğ
	`SÿÏr
(1);

722  
»s
;

724 
	}
}

730 
	g‹m¶©e
<
ty³Çme
 
	gOth”
, 
	gDim
, 
	gHDim
>

731 
	gei_ŒªsfÜm_´oduù_im¶
<
	gOth”
,
	gDim
,
	gHDim
, HDim,HDim>

733 
	gT¿nsfÜm
<
	tty³Çme
 
	tOth”
::
	tSÿÏr
,
	tDim
> 
	tT¿nsfÜmTy³
;

734 
ty³Çme
 
	tT¿nsfÜmTy³
::
	tM©rixTy³
 MatrixType;

735 
ty³Çme
 
	tProduùR‘uºTy³
<
	tM©rixTy³
,
	tOth”
>::
	tTy³
 
	tResuÉTy³
;

736 
ResuÉTy³
 
run
(cÚ¡ 
T¿nsfÜmTy³
& 
Œ
, cÚ¡ 
Oth”
& 
Ùh”
)

737 {  
	gŒ
.
m©rix
(è* 
	gÙh”
; }

740 
	g‹m¶©e
<
ty³Çme
 
	gOth”
, 
	gDim
, 
	gHDim
>

741 
	gei_ŒªsfÜm_´oduù_im¶
<
	gOth”
,
	gDim
,
	gHDim
, Dim,Dim>

743 
	gT¿nsfÜm
<
	tty³Çme
 
	tOth”
::
	tSÿÏr
,
	tDim
> 
	tT¿nsfÜmTy³
;

744 
ty³Çme
 
	tT¿nsfÜmTy³
::
	tM©rixTy³
 MatrixType;

745 
T¿nsfÜmTy³
 
	tResuÉTy³
;

746 
ResuÉTy³
 
run
(cÚ¡ 
T¿nsfÜmTy³
& 
Œ
, cÚ¡ 
Oth”
& 
Ùh”
)

748 
T¿nsfÜmTy³
 
	g»s
;

749 
	g»s
.
Œª¦©iÚ
(èğ
Œ
.translation();

750 
	g»s
.
m©rix
().
row
(
Dim
èğ
Œ
.matrix().row(Dim);

751 
	g»s
.
lš—r
(èğ(
Œ
.lš—r(è* 
Ùh”
).
Ïzy
();

752  
	g»s
;

756 
	g‹m¶©e
<
ty³Çme
 
	gOth”
, 
	gDim
, 
	gHDim
>

757 
	gei_ŒªsfÜm_´oduù_im¶
<
	gOth”
,
	gDim
,
	gHDim
, HDim,1>

759 
	gT¿nsfÜm
<
	tty³Çme
 
	tOth”
::
	tSÿÏr
,
	tDim
> 
	tT¿nsfÜmTy³
;

760 
ty³Çme
 
	tT¿nsfÜmTy³
::
	tM©rixTy³
 MatrixType;

761 
ty³Çme
 
	tProduùR‘uºTy³
<
	tM©rixTy³
,
	tOth”
>::
	tTy³
 
	tResuÉTy³
;

762 
ResuÉTy³
 
run
(cÚ¡ 
T¿nsfÜmTy³
& 
Œ
, cÚ¡ 
Oth”
& 
Ùh”
)

763 {  
	gŒ
.
m©rix
(è* 
	gÙh”
; }

766 
	g‹m¶©e
<
ty³Çme
 
	gOth”
, 
	gDim
, 
	gHDim
>

767 
	gei_ŒªsfÜm_´oduù_im¶
<
	gOth”
,
	gDim
,
	gHDim
, Dim,1>

769 
ty³Çme
 
	tOth”
::
	tSÿÏr
 Scalar;

770 
	gT¿nsfÜm
<
	tSÿÏr
,
	tDim
> 
	tT¿nsfÜmTy³
;

771 
ty³Çme
 
	tT¿nsfÜmTy³
::
	tLš—rP¬t
 
	tM©rixTy³
;

772 cÚ¡ 
	tCwi£UÇryOp
<

773 
	tei_sÿÏr_muÉË_İ
<
	tSÿÏr
>,

774 
	tNe¡ByV®ue
<
	tCwi£Bš¬yOp
<

775 
	tei_sÿÏr_sum_İ
<
	tSÿÏr
>,

776 
	tNe¡ByV®ue
<
	tty³Çme
 
	tProduùR‘uºTy³
<Ne¡ByV®ue<
	tM©rixTy³
>,
	tOth”
>::
	tTy³
 >,

777 
	tNe¡ByV®ue
<
	tty³Çme
 
	tT¿nsfÜmTy³
::
	tT¿n¦©iÚP¬t
> > >

778 > 
	tResuÉTy³
;

780 
ResuÉTy³
 
run
(cÚ¡ 
T¿nsfÜmTy³
& 
Œ
, cÚ¡ 
Oth”
& 
Ùh”
)

781 {  ((
	gŒ
.
lš—r
().
Ã¡ByV®ue
(è* 
	gÙh”
).Ã¡ByV®ue(è+r.
Œª¦©iÚ
().nestByValue()).nestByValue()

782 * (
SÿÏr
(1è/ ( (
	gŒ
.
m©rix
().
‹m¶©e
 
	gblock
<1,
	gDim
>(Dim,0è* 
	gÙh”
).
cÛff
(0è+r.m©rix().cÛff(
Dim
,Dim))); }

	@robot/Eigen/src/Geometry/Translation.h

25 #iâdeà
EIGEN_TRANSLATION_H


26 
	#EIGEN_TRANSLATION_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_Dim
>

43 şas 
	cT¿n¦©iÚ


45 
	mpublic
:

46 
	$EIGEN_MAKE_ALIGNED_OPERATOR_NEW_IF_VECTORIZABLE_FIXED_SIZE
(
_SÿÏr
,
_Dim
)

48 ’um { 
Dim
 = 
_Dim
 };

50 
_SÿÏr
 
	tSÿÏr
;

52 
M©rix
<
	tSÿÏr
,
	tDim
,1> 
	tVeùÜTy³
;

54 
M©rix
<
	tSÿÏr
,
	tDim
,Dim> 
	tLš—rM©rixTy³
;

56 
Sÿlšg
<
	tSÿÏr
,
	tDim
> 
	tSÿlšgTy³
;

58 
T¿nsfÜm
<
	tSÿÏr
,
	tDim
> 
	tT¿nsfÜmTy³
;

60 
´Ùeùed
:

62 
VeùÜTy³
 
m_cÛffs
;

64 
public
:

67 
	$T¿n¦©iÚ
(è{
	}
}

69 
šlše
 
	$T¿n¦©iÚ
(cÚ¡ 
SÿÏr
& 
sx
, cÚ¡ SÿÏr& 
sy
)

71 
	`ei_as£¹
(
Dim
==2);

72 
m_cÛffs
.
	`x
(èğ
sx
;

73 
m_cÛffs
.
	`y
(èğ
sy
;

74 
	}
}

76 
šlše
 
	$T¿n¦©iÚ
(cÚ¡ 
SÿÏr
& 
sx
, cÚ¡ SÿÏr& 
sy
, cÚ¡ SÿÏr& 
sz
)

78 
	`ei_as£¹
(
Dim
==3);

79 
m_cÛffs
.
	`x
(èğ
sx
;

80 
m_cÛffs
.
	`y
(èğ
sy
;

81 
m_cÛffs
.
	`z
(èğ
sz
;

82 
	}
}

84 
ex¶ic™
 
šlše
 
	$T¿n¦©iÚ
(cÚ¡ 
VeùÜTy³
& 
veùÜ
è: 
	$m_cÛffs
(
veùÜ
è{
	}
}

86 cÚ¡ 
VeùÜTy³
& 
	$veùÜ
(ècÚ¡ {  
m_cÛffs
; 
	}
}

87 
	gVeùÜTy³
& 
	$veùÜ
(è{  
m_cÛffs
; 
	}
}

90 
šlše
 
T¿n¦©iÚ
 
	gİ”©Ü
* (cÚ¡ 
	gT¿n¦©iÚ
& 
	gÙh”
) const

91 {  
T¿n¦©iÚ
(
m_cÛffs
 + 
Ùh”
.m_coeffs); }

94 
šlše
 
T¿nsfÜmTy³
 
	gİ”©Ü
* (cÚ¡ 
	gSÿlšgTy³
& 
	gÙh”
) const;

97 
šlše
 
T¿nsfÜmTy³
 
	gİ”©Ü
* (cÚ¡ 
	gLš—rM©rixTy³
& 
	glš—r
) const;

99 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

100 
šlše
 
T¿nsfÜmTy³
 
	gİ”©Ü
*(cÚ¡ 
	gRÙ©iÚBa£
<
	gD”ived
,
	gDim
>& 
	gr
) const

101 {  *
this
 * 
	gr
.
toRÙ©iÚM©rix
(); }

105 
ä›nd
 
šlše
 
T¿nsfÜmTy³
 
	gİ”©Ü
* (cÚ¡ 
	gLš—rM©rixTy³
& 
	glš—r
, cÚ¡ 
	gT¿n¦©iÚ
& 
	gt
)

107 
T¿nsfÜmTy³
 
	g»s
;

108 
	g»s
.
m©rix
().
£tZ”o
();

109 
	g»s
.
lš—r
() =†inear;

110 
	g»s
.
Œª¦©iÚ
(èğ
lš—r
 * 
t
.
m_cÛffs
;

111 
	g»s
.
m©rix
().
row
(
Dim
).
£tZ”o
();

112 
»s
(
Dim
,Dimèğ
SÿÏr
(1);

113  
	g»s
;

117 
šlše
 
T¿nsfÜmTy³
 
	gİ”©Ü
* (cÚ¡ 
	gT¿nsfÜmTy³
& 
	gt
) const;

120 
šlše
 
VeùÜTy³
 
	gİ”©Ü
* (cÚ¡ 
	gVeùÜTy³
& 
	gÙh”
) const

121 {  
	gm_cÛffs
 + 
	gÙh”
; }

124 
T¿n¦©iÚ
 
	$šv”£
(ècÚ¡ {  
	`T¿n¦©iÚ
(-
m_cÛffs
); 
	}
}

126 
	gT¿n¦©iÚ
& 
	gİ”©Ü
=(cÚ¡ 
T¿n¦©iÚ
& 
Ùh”
)

128 
m_cÛffs
 = 
Ùh”
.m_coeffs;

129  *
	gthis
;

137 
	g‹m¶©e
<
ty³Çme
 
	gNewSÿÏrTy³
>

138 
šlše
 
ty³Çme
 
	gei_ÿ¡_»tuº_ty³
<
	gT¿n¦©iÚ
,T¿n¦©iÚ<
	gNewSÿÏrTy³
,
	gDim
> >::
ty³
 
	$ÿ¡
() const

139 {  
ty³Çme
 
ei_ÿ¡_»tuº_ty³
<
T¿n¦©iÚ
,T¿n¦©iÚ<
NewSÿÏrTy³
,
Dim
> >::
	`ty³
(*
this
); 
	}
}

142 
	g‹m¶©e
<
ty³Çme
 
	gOth”SÿÏrTy³
>

143 
šlše
 
ex¶ic™
 
T¿n¦©iÚ
(cÚ¡ T¿n¦©iÚ<
Oth”SÿÏrTy³
,
Dim
>& 
Ùh”
)

144 { 
	gm_cÛffs
 = 
Ùh”
.
veùÜ
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>(); }

150 
boŞ
 
isAµrox
(cÚ¡ 
T¿n¦©iÚ
& 
Ùh”
, 
ty³Çme
 
NumT¿™s
<
SÿÏr
>::
R—l
 
´ec
 = 
´ecisiÚ
<Scalar>()) const

151 {  
m_cÛffs
.
isAµrox
(
Ùh”
.m_cÛffs, 
´ec
); }

157 
	gT¿n¦©iÚ
<, 2> 
	tT¿n¦©iÚ2f
;

158 
	gT¿n¦©iÚ
<,2> 
	tT¿n¦©iÚ2d
;

159 
	gT¿n¦©iÚ
<, 3> 
	tT¿n¦©iÚ3f
;

160 
	gT¿n¦©iÚ
<,3> 
	tT¿n¦©iÚ3d
;

164 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

165 
šlše
 
ty³Çme
 
	gT¿n¦©iÚ
<
	gSÿÏr
,
	gDim
>::
T¿nsfÜmTy³


166 
T¿n¦©iÚ
<
SÿÏr
,
	gDim
>::
İ”©Ü
* (cÚ¡ 
SÿlšgTy³
& 
Ùh”
) const

168 
T¿nsfÜmTy³
 
»s
;

169 
	g»s
.
m©rix
().
£tZ”o
();

170 
	g»s
.
lš—r
().
dŸgÚ®
(èğ
Ùh”
.
cÛffs
();

171 
	g»s
.
Œª¦©iÚ
(èğ
m_cÛffs
;

172 
»s
(
Dim
,Dimèğ
SÿÏr
(1);

173  
	g»s
;

176 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

177 
šlše
 
ty³Çme
 
	gT¿n¦©iÚ
<
	gSÿÏr
,
	gDim
>::
T¿nsfÜmTy³


178 
T¿n¦©iÚ
<
SÿÏr
,
	gDim
>::
İ”©Ü
* (cÚ¡ 
Lš—rM©rixTy³
& 
lš—r
) const

180 
T¿nsfÜmTy³
 
»s
;

181 
	g»s
.
m©rix
().
£tZ”o
();

182 
	g»s
.
lš—r
() =†inear;

183 
	g»s
.
Œª¦©iÚ
(èğ
m_cÛffs
;

184 
	g»s
.
m©rix
().
row
(
Dim
).
£tZ”o
();

185 
»s
(
Dim
,Dimèğ
SÿÏr
(1);

186  
	g»s
;

189 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gDim
>

190 
šlše
 
ty³Çme
 
	gT¿n¦©iÚ
<
	gSÿÏr
,
	gDim
>::
T¿nsfÜmTy³


191 
T¿n¦©iÚ
<
SÿÏr
,
	gDim
>::
İ”©Ü
* (cÚ¡ 
T¿nsfÜmTy³
& 
t
) const

193 
T¿nsfÜmTy³
 
»s
 = 
t
;

194 
	g»s
.
´‘¿n¦©e
(
m_cÛffs
);

195  
	g»s
;

	@robot/Eigen/src/LU/Determinant.h

25 #iâdeà
EIGEN_DETERMINANT_H


26 
	#EIGEN_DETERMINANT_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

29 
šlše
 cÚ¡ 
ty³Çme
 
	gD”ived
::
SÿÏr
 
ei_bru‹fÜû_d‘3_h–³r


30 (cÚ¡ 
M©rixBa£
<
D”ived
>& 
m©rix
, 
	ga
, 
	gb
, 
	gc
)

32  
	gm©rix
.
cÛff
(0,
a
)

33 * (
	gm©rix
.
cÛff
(1,
b
è* m©rix.cÛff(2,
c
) - matrix.coeff(1,c) * matrix.coeff(2,b));

36 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

37 cÚ¡ 
ty³Çme
 
	gD”ived
::
SÿÏr
 
ei_bru‹fÜû_d‘4_h–³r


38 (cÚ¡ 
M©rixBa£
<
D”ived
>& 
m©rix
, 
	gj
, 
	gk
, 
	gm
, 
	gn
)

40  (
	gm©rix
.
cÛff
(
j
,0è* m©rix.cÛff(
k
,1) - matrix.coeff(k,0) * matrix.coeff(j,1))

41 * (
	gm©rix
.
cÛff
(
m
,2è* m©rix.cÛff(
n
,3) - matrix.coeff(n,2) * matrix.coeff(m,3));

44 cÚ¡ 
	gTrŸnguÏrD‘”mšªt
 = 0;

46 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,

47 
	gD‘”mšªtTy³
 =

48 (
D”ived
::
FÏgs
 & (
Uµ”TrŸnguÏrB™
 | 
Low”TrŸnguÏrB™
))

49 ? 
TrŸnguÏrD‘”mšªt
 : 
D”ived
::
RowsAtCompeTime


50 > 
	sei_d‘”mšªt_im¶


52 
šlše
 
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
 
run
(cÚ¡ D”ived& 
m
)

54  
m
.
lu
().
d‘”mšªt
();

58 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
	gei_d‘”mšªt_im¶
<D”ived, 
	gTrŸnguÏrD‘”mšªt
>

60 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m
)

62 ià(
D”ived
::
FÏgs
 & 
Un™DŸgB™
)

64 ià(
	gD”ived
::
FÏgs
 & 
Z”oDŸgB™
)

67  
	gm
.
dŸgÚ®
().
»dux
(
ei_sÿÏr_´oduù_İ
<
ty³Çme
 
ei_Œa™s
<
D”ived
>::
SÿÏr
>());

71 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
	gei_d‘”mšªt_im¶
<Derived, 1>

73 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m
)

75  
m
.
cÛff
(0,0);

79 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
	gei_d‘”mšªt_im¶
<Derived, 2>

81 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m
)

83  
m
.
cÛff
(0,0è* 
	gm
.coeff(1,1) - m.coeff(1,0) * m.coeff(0,1);

87 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
	gei_d‘”mšªt_im¶
<Derived, 3>

89 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m
)

91  
ei_bru‹fÜû_d‘3_h–³r
(
m
,0,1,2)

92 - 
ei_bru‹fÜû_d‘3_h–³r
(
m
,1,0,2)

93 + 
ei_bru‹fÜû_d‘3_h–³r
(
m
,2,0,1);

97 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
	gei_d‘”mšªt_im¶
<Derived, 4>

99 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
run
(cÚ¡ 
D”ived
& 
m
)

102  
ei_bru‹fÜû_d‘4_h–³r
(
m
,0,1,2,3)

103 - 
ei_bru‹fÜû_d‘4_h–³r
(
m
,0,2,1,3)

104 + 
ei_bru‹fÜû_d‘4_h–³r
(
m
,0,3,1,2)

105 + 
ei_bru‹fÜû_d‘4_h–³r
(
m
,1,2,0,3)

106 - 
ei_bru‹fÜû_d‘4_h–³r
(
m
,1,3,0,2)

107 + 
ei_bru‹fÜû_d‘4_h–³r
(
m
,2,3,0,1);

115 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

116 
šlše
 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
 
M©rixBa£
<
D”ived
>::
	$d‘”mšªt
() const

118 
	`as£¹
(
	`rows
(è=ğ
	`cŞs
());

119  
ei_d‘”mšªt_im¶
<
D”ived
>::
	`run
(
	`d”ived
());

120 
	}
}

	@robot/Eigen/src/LU/Inverse.h

25 #iâdeà
EIGEN_INVERSE_H


26 
	#EIGEN_INVERSE_H


	)

32 
	g‹m¶©e
<
ty³Çme
 
	gX´Ty³
,y³Çm
	gM©rixTy³
>

33 
	$ei_compu‹_šv”£_š_size2_ÿ£
(cÚ¡ 
X´Ty³
& 
m©rix
, 
M©rixTy³
* 
»suÉ
)

35 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

36 cÚ¡ 
SÿÏr
 
švd‘
 = 
	`SÿÏr
(1è/ 
m©rix
.
	`d‘”mšªt
();

37 
»suÉ
->
	`cÛffRef
(0,0èğ
m©rix
.
	`cÛff
(1,1è* 
švd‘
;

38 
»suÉ
->
	`cÛffRef
(1,0èğ-
m©rix
.
	`cÛff
(1,0è* 
švd‘
;

39 
»suÉ
->
	`cÛffRef
(0,1èğ-
m©rix
.
	`cÛff
(0,1è* 
švd‘
;

40 
»suÉ
->
	`cÛffRef
(1,1èğ
m©rix
.
	`cÛff
(0,0è* 
švd‘
;

41 
	}
}

43 
	g‹m¶©e
<
ty³Çme
 
	gX´Ty³
,y³Çm
	gM©rixTy³
>

44 
boŞ
 
	$ei_compu‹_šv”£_š_size2_ÿ£_w™h_check
(cÚ¡ 
X´Ty³
& 
m©rix
, 
M©rixTy³
* 
»suÉ
)

46 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

47 cÚ¡ 
SÿÏr
 
d‘
 = 
m©rix
.
	`d‘”mšªt
();

48 if(
	`ei_isMuchSm®ËrThª
(
d‘
, 
m©rix
.
	`cwi£
().
	`abs
().
	`maxCÛff
())è 
çl£
;

49 cÚ¡ 
SÿÏr
 
švd‘
 = 
	`SÿÏr
(1è/ 
d‘
;

50 
»suÉ
->
	`cÛffRef
(0,0èğ
m©rix
.
	`cÛff
(1,1è* 
švd‘
;

51 
»suÉ
->
	`cÛffRef
(1,0èğ-
m©rix
.
	`cÛff
(1,0è* 
švd‘
;

52 
»suÉ
->
	`cÛffRef
(0,1èğ-
m©rix
.
	`cÛff
(0,1è* 
švd‘
;

53 
»suÉ
->
	`cÛffRef
(1,1èğ
m©rix
.
	`cÛff
(0,0è* 
švd‘
;

54  
Œue
;

55 
	}
}

57 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

58 
	$ei_compu‹_šv”£_š_size3_ÿ£
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
* 
»suÉ
)

60 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

61 cÚ¡ 
SÿÏr
 
d‘_mšÜ00
 = 
m©rix
.
	`mšÜ
(0,0).
	`d‘”mšªt
();

62 cÚ¡ 
SÿÏr
 
d‘_mšÜ10
 = 
m©rix
.
	`mšÜ
(1,0).
	`d‘”mšªt
();

63 cÚ¡ 
SÿÏr
 
d‘_mšÜ20
 = 
m©rix
.
	`mšÜ
(2,0).
	`d‘”mšªt
();

64 cÚ¡ 
SÿÏr
 
švd‘
 = 
	`SÿÏr
(1è/ ( 
d‘_mšÜ00
 * 
m©rix
.
	`cÛff
(0,0)

65 - 
d‘_mšÜ10
 * 
m©rix
.
	`cÛff
(1,0)

66 + 
d‘_mšÜ20
 * 
m©rix
.
	`cÛff
(2,0) );

67 
»suÉ
->
	`cÛffRef
(0, 0èğ
d‘_mšÜ00
 * 
švd‘
;

68 
»suÉ
->
	`cÛffRef
(0, 1èğ-
d‘_mšÜ10
 * 
švd‘
;

69 
»suÉ
->
	`cÛffRef
(0, 2èğ
d‘_mšÜ20
 * 
švd‘
;

70 
»suÉ
->
	`cÛffRef
(1, 0èğ-
m©rix
.
	`mšÜ
(0,1).
	`d‘”mšªt
(è* 
švd‘
;

71 
»suÉ
->
	`cÛffRef
(1, 1èğ
m©rix
.
	`mšÜ
(1,1).
	`d‘”mšªt
(è* 
švd‘
;

72 
»suÉ
->
	`cÛffRef
(1, 2èğ-
m©rix
.
	`mšÜ
(2,1).
	`d‘”mšªt
(è* 
švd‘
;

73 
»suÉ
->
	`cÛffRef
(2, 0èğ
m©rix
.
	`mšÜ
(0,2).
	`d‘”mšªt
(è* 
švd‘
;

74 
»suÉ
->
	`cÛffRef
(2, 1èğ-
m©rix
.
	`mšÜ
(1,2).
	`d‘”mšªt
(è* 
švd‘
;

75 
»suÉ
->
	`cÛffRef
(2, 2èğ
m©rix
.
	`mšÜ
(2,2).
	`d‘”mšªt
(è* 
švd‘
;

76 
	}
}

78 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
,y³Çm
	gSÿÏr
 =y³Çm
D”ived
::
SÿÏr
>

79 
	sei_compu‹_šv”£_š_size4_ÿ£


81 
run
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
& 
»suÉ
)

83 
»suÉ
.
cÛffRef
(0,0èğ
m©rix
.
mšÜ
(0,0).
d‘”mšªt
();

84 
	m»suÉ
.
cÛffRef
(1,0èğ-
m©rix
.
mšÜ
(0,1).
d‘”mšªt
();

85 
	m»suÉ
.
cÛffRef
(2,0èğ
m©rix
.
mšÜ
(0,2).
d‘”mšªt
();

86 
	m»suÉ
.
cÛffRef
(3,0èğ-
m©rix
.
mšÜ
(0,3).
d‘”mšªt
();

87 
	m»suÉ
.
cÛffRef
(0,2èğ
m©rix
.
mšÜ
(2,0).
d‘”mšªt
();

88 
	m»suÉ
.
cÛffRef
(1,2èğ-
m©rix
.
mšÜ
(2,1).
d‘”mšªt
();

89 
	m»suÉ
.
cÛffRef
(2,2èğ
m©rix
.
mšÜ
(2,2).
d‘”mšªt
();

90 
	m»suÉ
.
cÛffRef
(3,2èğ-
m©rix
.
mšÜ
(2,3).
d‘”mšªt
();

91 
	m»suÉ
.
cÛffRef
(0,1èğ-
m©rix
.
mšÜ
(1,0).
d‘”mšªt
();

92 
	m»suÉ
.
cÛffRef
(1,1èğ
m©rix
.
mšÜ
(1,1).
d‘”mšªt
();

93 
	m»suÉ
.
cÛffRef
(2,1èğ-
m©rix
.
mšÜ
(1,2).
d‘”mšªt
();

94 
	m»suÉ
.
cÛffRef
(3,1èğ
m©rix
.
mšÜ
(1,3).
d‘”mšªt
();

95 
	m»suÉ
.
cÛffRef
(0,3èğ-
m©rix
.
mšÜ
(3,0).
d‘”mšªt
();

96 
	m»suÉ
.
cÛffRef
(1,3èğ
m©rix
.
mšÜ
(3,1).
d‘”mšªt
();

97 
	m»suÉ
.
cÛffRef
(2,3èğ-
m©rix
.
mšÜ
(3,2).
d‘”mšªt
();

98 
	m»suÉ
.
cÛffRef
(3,3èğ
m©rix
.
mšÜ
(3,3).
d‘”mšªt
();

99 
	m»suÉ
 /ğ(
m©rix
.
cŞ
(0).
cwi£
()*
»suÉ
.
row
(0).
Œª¥o£
()).
sum
();

103 #ifdeà
EIGEN_VECTORIZE_SSE


112 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

113 
	gei_compu‹_šv”£_š_size4_ÿ£
<
	gD”ived
, 
	gOth”D”ived
, >

115 
run
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
& 
»suÉ
)

119 
__m128
 
	gmšÜ0
, 
	gmšÜ1
, 
	gmšÜ2
, 
	gmšÜ3
;

123 
__m128
 
	grow0
, 
	grow1
, 
	grow2
, 
	grow3
;

126 
__m128
 
	gd‘
, 
	gtmp1
;

129 cÚ¡ *
	g¤c
 = 
m©rix
.
d©a
();

130 
	gtmp1
 = 
_mm_lßdh_pi
(
_mm_ÿ¡pd_ps
(
_mm_lßd_sd
((*)
¤c
)), (
__m64
*)(src+ 4));

131 
	grow1
 = 
_mm_lßdh_pi
(
_mm_ÿ¡pd_ps
(
_mm_lßd_sd
((*)(
¤c
+8))), (
__m64
*)(src+12));

132 
	grow0
 = 
_mm_shufæe_ps
(
tmp1
, 
row1
, 0x88);

133 
	grow1
 = 
_mm_shufæe_ps
(
row1
, 
tmp1
, 0xDD);

134 
	gtmp1
 = 
_mm_lßdh_pi
(
_mm_ÿ¡pd_ps
(
_mm_lßd_sd
((*)(
¤c
+ 2))), (
__m64
*)(src+ 6));

135 
	grow3
 = 
_mm_lßdh_pi
(
_mm_ÿ¡pd_ps
(
_mm_lßd_sd
((*)(
¤c
+10))), (
__m64
*)(src+14));

136 
	grow2
 = 
_mm_shufæe_ps
(
tmp1
, 
row3
, 0x88);

137 
	grow3
 = 
_mm_shufæe_ps
(
row3
, 
tmp1
, 0xDD);

145 
	gtmp1
 = 
_mm_mul_ps
(
row2
, 
row3
);

146 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0xB1);

147 
	gmšÜ0
 = 
_mm_mul_ps
(
row1
, 
tmp1
);

148 
	gmšÜ1
 = 
_mm_mul_ps
(
row0
, 
tmp1
);

149 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0x4E);

150 
	gmšÜ0
 = 
_mm_sub_ps
(
_mm_mul_ps
(
row1
, 
tmp1
), 
mšÜ0
);

151 
	gmšÜ1
 = 
_mm_sub_ps
(
_mm_mul_ps
(
row0
, 
tmp1
), 
mšÜ1
);

152 
	gmšÜ1
 = 
_mm_shufæe_ps
(
mšÜ1
, minor1, 0x4E);

154 
	gtmp1
 = 
_mm_mul_ps
(
row1
, 
row2
);

155 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0xB1);

156 
	gmšÜ0
 = 
_mm_add_ps
(
_mm_mul_ps
(
row3
, 
tmp1
), 
mšÜ0
);

157 
	gmšÜ3
 = 
_mm_mul_ps
(
row0
, 
tmp1
);

158 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0x4E);

159 
	gmšÜ0
 = 
_mm_sub_ps
(
mšÜ0
, 
_mm_mul_ps
(
row3
, 
tmp1
));

160 
	gmšÜ3
 = 
_mm_sub_ps
(
_mm_mul_ps
(
row0
, 
tmp1
), 
mšÜ3
);

161 
	gmšÜ3
 = 
_mm_shufæe_ps
(
mšÜ3
, minor3, 0x4E);

163 
	gtmp1
 = 
_mm_mul_ps
(
_mm_shufæe_ps
(
row1
,„ow1, 0x4E), 
row3
);

164 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0xB1);

165 
	grow2
 = 
_mm_shufæe_ps
(
row2
,„ow2, 0x4E);

166 
	gmšÜ0
 = 
_mm_add_ps
(
_mm_mul_ps
(
row2
, 
tmp1
), 
mšÜ0
);

167 
	gmšÜ2
 = 
_mm_mul_ps
(
row0
, 
tmp1
);

168 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0x4E);

169 
	gmšÜ0
 = 
_mm_sub_ps
(
mšÜ0
, 
_mm_mul_ps
(
row2
, 
tmp1
));

170 
	gmšÜ2
 = 
_mm_sub_ps
(
_mm_mul_ps
(
row0
, 
tmp1
), 
mšÜ2
);

171 
	gmšÜ2
 = 
_mm_shufæe_ps
(
mšÜ2
, minor2, 0x4E);

173 
	gtmp1
 = 
_mm_mul_ps
(
row0
, 
row1
);

174 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0xB1);

175 
	gmšÜ2
 = 
_mm_add_ps
(
_mm_mul_ps
(
row3
, 
tmp1
), 
mšÜ2
);

176 
	gmšÜ3
 = 
_mm_sub_ps
(
_mm_mul_ps
(
row2
, 
tmp1
), 
mšÜ3
);

177 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0x4E);

178 
	gmšÜ2
 = 
_mm_sub_ps
(
_mm_mul_ps
(
row3
, 
tmp1
), 
mšÜ2
);

179 
	gmšÜ3
 = 
_mm_sub_ps
(
mšÜ3
, 
_mm_mul_ps
(
row2
, 
tmp1
));

181 
	gtmp1
 = 
_mm_mul_ps
(
row0
, 
row3
);

182 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0xB1);

183 
	gmšÜ1
 = 
_mm_sub_ps
(
mšÜ1
, 
_mm_mul_ps
(
row2
, 
tmp1
));

184 
	gmšÜ2
 = 
_mm_add_ps
(
_mm_mul_ps
(
row1
, 
tmp1
), 
mšÜ2
);

185 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0x4E);

186 
	gmšÜ1
 = 
_mm_add_ps
(
_mm_mul_ps
(
row2
, 
tmp1
), 
mšÜ1
);

187 
	gmšÜ2
 = 
_mm_sub_ps
(
mšÜ2
, 
_mm_mul_ps
(
row1
, 
tmp1
));

189 
	gtmp1
 = 
_mm_mul_ps
(
row0
, 
row2
);

190 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0xB1);

191 
	gmšÜ1
 = 
_mm_add_ps
(
_mm_mul_ps
(
row3
, 
tmp1
), 
mšÜ1
);

192 
	gmšÜ3
 = 
_mm_sub_ps
(
mšÜ3
, 
_mm_mul_ps
(
row1
, 
tmp1
));

193 
	gtmp1
 = 
_mm_shufæe_ps
(
tmp1
,mp1, 0x4E);

194 
	gmšÜ1
 = 
_mm_sub_ps
(
mšÜ1
, 
_mm_mul_ps
(
row3
, 
tmp1
));

195 
	gmšÜ3
 = 
_mm_add_ps
(
_mm_mul_ps
(
row1
, 
tmp1
), 
mšÜ3
);

201 
	gd‘
 = 
_mm_mul_ps
(
row0
, 
mšÜ0
);

202 
	gd‘
 = 
_mm_add_ps
(
_mm_shufæe_ps
(
d‘
, det, 0x4E), det);

203 
	gd‘
 = 
_mm_add_ss
(
_mm_shufæe_ps
(
d‘
, det, 0xB1), det);

206 
	gd‘
 = 
_mm_div_ss
(
_mm_£t_ss
(1.0f), 
d‘
);

207 
	gd‘
 = 
_mm_shufæe_ps
(
d‘
, det, 0x00);

211 
	gmšÜ0
 = 
_mm_mul_ps
(
d‘
, 
mšÜ0
);

212 *
	gd¡
 = 
»suÉ
.
d©a
();

213 
_mm_¡Ü–_pi
((
__m64
*)(
d¡
), 
mšÜ0
);

214 
_mm_¡Üeh_pi
((
__m64
*)(
d¡
+2), 
mšÜ0
);

215 
	gmšÜ1
 = 
_mm_mul_ps
(
d‘
, 
mšÜ1
);

216 
_mm_¡Ü–_pi
((
__m64
*)(
d¡
+4), 
mšÜ1
);

217 
_mm_¡Üeh_pi
((
__m64
*)(
d¡
+6), 
mšÜ1
);

218 
	gmšÜ2
 = 
_mm_mul_ps
(
d‘
, 
mšÜ2
);

219 
_mm_¡Ü–_pi
((
__m64
*)(
d¡
+ 8), 
mšÜ2
);

220 
_mm_¡Üeh_pi
((
__m64
*)(
d¡
+10), 
mšÜ2
);

221 
	gmšÜ3
 = 
_mm_mul_ps
(
d‘
, 
mšÜ3
);

222 
_mm_¡Ü–_pi
((
__m64
*)(
d¡
+12), 
mšÜ3
);

223 
_mm_¡Üeh_pi
((
__m64
*)(
d¡
+14), 
mšÜ3
);

232 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
, 
	gSize
 = 
D”ived
::
RowsAtCompeTime
>

233 
	sei_compu‹_šv”£


235 
šlše
 
run
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
* 
»suÉ
)

237 
LU
<
D”ived
> 
lu
(
m©rix
);

238 
	mlu
.
compu‹Inv”£
(
»suÉ
);

242 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

243 
	gei_compu‹_šv”£
<
	gD”ived
, 
	gOth”D”ived
, 1>

245 
šlše
 
run
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
* 
»suÉ
)

247 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

248 
	g»suÉ
->
cÛffRef
(0,0èğ
SÿÏr
(1è/ 
m©rix
.
cÛff
(0,0);

252 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

253 
	gei_compu‹_šv”£
<
	gD”ived
, 
	gOth”D”ived
, 2>

255 
šlše
 
run
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
* 
»suÉ
)

257 
ei_compu‹_šv”£_š_size2_ÿ£
(
m©rix
, 
»suÉ
);

261 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

262 
	gei_compu‹_šv”£
<
	gD”ived
, 
	gOth”D”ived
, 3>

264 
šlše
 
run
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
* 
»suÉ
)

266 
ei_compu‹_šv”£_š_size3_ÿ£
(
m©rix
, 
»suÉ
);

270 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
,y³Çm
	gOth”D”ived
>

271 
	gei_compu‹_šv”£
<
	gD”ived
, 
	gOth”D”ived
, 4>

273 
šlše
 
run
(cÚ¡ 
D”ived
& 
m©rix
, 
Oth”D”ived
* 
»suÉ
)

275 
	gei_compu‹_šv”£_š_size4_ÿ£
<
	gD”ived
, 
	gOth”D”ived
>::
run
(
m©rix
, *
»suÉ
);

292 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

293 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

294 
šlše
 
	gM©rixBa£
<
	gD”ived
>::
compu‹Inv”£
(
M©rixBa£
<
Oth”D”ived
> *
»suÉ
) const

296 
ei_as£¹
(
rows
(è=ğ
cŞs
());

297 
EIGEN_STATIC_ASSERT
(
NumT¿™s
<
SÿÏr
>::
HasFlßtšgPošt
,
NUMERIC_TYPE_MUST_BE_FLOATING_POINT
)

298 
	gei_compu‹_šv”£
<
	gPÏšM©rixTy³
, 
	gOth”D”ived
>::
run
(
ev®
(), 
¡©ic_ÿ¡
<
Oth”D”ived
*>(
»suÉ
));

315 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

316 
šlše
 cÚ¡ 
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³
 
M©rixBa£
<
D”ived
>::
	$šv”£
() const

318 
PÏšM©rixTy³
 
	`»suÉ
(
	`rows
(), 
	`cŞs
());

319 
	`compu‹Inv”£
(&
»suÉ
);

320  
»suÉ
;

321 
	}
}

	@robot/Eigen/src/LU/LU.h

25 #iâdeà
EIGEN_LU_H


26 
	#EIGEN_LU_H


	)

60 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> cÏs 
	cLU


62 
	mpublic
:

64 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

65 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

66 
	mM©rix
<, 1, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, M©rixTy³::
	tO±iÚs
, 1, M©rixTy³::
	tMaxCŞsAtCompeTime
> 
	tIÁRowVeùÜTy³
;

67 
	mM©rix
<, 
	tM©rixTy³
::
	tRowsAtCompeTime
, 1, M©rixTy³::
	tO±iÚs
, M©rixTy³::
	tMaxRowsAtCompeTime
, 1> 
	tIÁCŞVeùÜTy³
;

68 
	mM©rix
<
	tSÿÏr
, 1, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, M©rixTy³::
	tO±iÚs
, 1, M©rixTy³::
	tMaxCŞsAtCompeTime
> 
	tRowVeùÜTy³
;

69 
	mM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tRowsAtCompeTime
, 1, M©rixTy³::
	tO±iÚs
, M©rixTy³::
	tMaxRowsAtCompeTime
, 1> 
	tCŞVeùÜTy³
;

71 ’um { 
	mMaxSm®lDimAtCompeTime
 = 
EIGEN_SIZE_MIN
(

72 
M©rixTy³
::
MaxCŞsAtCompeTime
,

73 
M©rixTy³
::
MaxRowsAtCompeTime
)

76 
	gM©rix
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
,

77 
	tM©rixTy³
::
	tCŞsAtCompeTime
,

79 
	tDyÇmic
,

80 
	tM©rixTy³
::
	tO±iÚs
,

81 
	tM©rixTy³
::
	tMaxCŞsAtCompeTime
,

82 
	tM©rixTy³
::
	tMaxCŞsAtCompeTime


84 > 
	tK”ÃlResuÉTy³
;

86 
	gM©rix
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
,

87 
	tM©rixTy³
::
	tRowsAtCompeTime
,

89 
	tDyÇmic
,

90 
	tM©rixTy³
::
	tO±iÚs
,

91 
	tM©rixTy³
::
	tMaxRowsAtCompeTime
,

92 
	tM©rixTy³
::
	tMaxCŞsAtCompeTime


93 > 
	tImageResuÉTy³
;

99 
LU
(cÚ¡ 
M©rixTy³
& 
m©rix
);

107 
šlše
 cÚ¡ 
	gM©rixTy³
& 
	$m©rixLU
() const

109  
m_lu
;

110 
	}
}

118 
šlše
 cÚ¡ 
	gIÁCŞVeùÜTy³
& 
	$³rmutiÚP
() const

120  
m_p
;

121 
	}
}

129 
šlše
 cÚ¡ 
	gIÁRowVeùÜTy³
& 
	$³rmutiÚQ
() const

131  
m_q
;

132 
	}
}

148 
	g‹m¶©e
<
ty³Çme
 
	gK”ÃlM©rixTy³
>

149 
	$compu‹K”Ãl
(
K”ÃlM©rixTy³
 *
»suÉ
) const;

164 
‹m¶©e
<
ty³Çme
 
ImageM©rixTy³
>

165 
	$compu‹Image
(
ImageM©rixTy³
 *
»suÉ
) const;

181 cÚ¡ 
K”ÃlResuÉTy³
 
	$k”Ãl
() const;

196 cÚ¡ 
ImageResuÉTy³
 
	$image
() const;

219 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
,y³Çm
ResuÉTy³
>

220 
boŞ
 
	`sŞve
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
b
, 
ResuÉTy³
 *
»suÉ
) const;

237 
ty³Çme
 
ei_Œa™s
<
M©rixTy³
>::
SÿÏr
 
	$d‘”mšªt
() const;

244 
šlše
 
	$¿nk
() const

246  
m_¿nk
;

247 
	}
}

254 
šlše
 
	$dim’siÚOfK”Ãl
() const

256  
m_lu
.
	`cŞs
(è- 
m_¿nk
;

257 
	}
}

265 
šlše
 
boŞ
 
	$isInjeùive
() const

267  
m_¿nk
 =ğ
m_lu
.
	`cŞs
();

268 
	}
}

276 
šlše
 
boŞ
 
	$isSurjeùive
() const

278  
m_¿nk
 =ğ
m_lu
.
	`rows
();

279 
	}
}

286 
šlše
 
boŞ
 
	$isInv”tibË
() const

288  
	`isInjeùive
(è&& 
	`isSurjeùive
();

289 
	}
}

300 
	g‹m¶©e
<
ty³Çme
 
	gResuÉTy³
>

301 
šlše
 
	$compu‹Inv”£
(
ResuÉTy³
 *
»suÉ
) const

303 
	`sŞve
(
M©rixTy³
::
	`Id’t™y
(
m_lu
.
	`rows
(), m_lu.
	`cŞs
()), 
»suÉ
);

304 
	}
}

313 
šlše
 
M©rixTy³
 
	$šv”£
() const

315 
M©rixTy³
 
»suÉ
;

316 
	`compu‹Inv”£
(&
»suÉ
);

317  
»suÉ
;

318 
	}
}

320 
	g´Ùeùed
:

321 cÚ¡ 
M©rixTy³
& 
m_Üigš®M©rix
;

322 
M©rixTy³
 
	gm_lu
;

323 
IÁCŞVeùÜTy³
 
	gm_p
;

324 
IÁRowVeùÜTy³
 
	gm_q
;

325 
	gm_d‘_pq
;

326 
	gm_¿nk
;

327 
R—lSÿÏr
 
	gm_´ecisiÚ
;

330 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

331 
	gLU
<
	gM©rixTy³
>::
	$LU
(cÚ¡ 
M©rixTy³
& 
m©rix
)

332 : 
	`m_Üigš®M©rix
(
m©rix
),

333 
	`m_lu
(
m©rix
),

334 
	`m_p
(
m©rix
.
	`rows
()),

335 
	`m_q
(
m©rix
.
	$cŞs
())

337 cÚ¡ 
size
 = 
m©rix
.
	`dŸgÚ®
().
	`size
();

338 cÚ¡ 
rows
 = 
m©rix
.
	`rows
();

339 cÚ¡ 
cŞs
 = 
m©rix
.
	`cŞs
();

343 
m_´ecisiÚ
 = 
machše_•sÚ
<
SÿÏr
>(è* 
size
;

345 
IÁCŞVeùÜTy³
 
	`rows_Œª¥os™iÚs
(
m©rix
.
	`rows
());

346 
IÁRowVeùÜTy³
 
	`cŞs_Œª¥os™iÚs
(
m©rix
.
	`cŞs
());

347 
numb”_of_Œª¥os™iÚs
 = 0;

349 
R—lSÿÏr
 
bigge¡
 = 
	`R—lSÿÏr
(0);

350 
m_¿nk
 = 
size
;

351 
k
 = 0; k < 
size
; ++k)

353 
row_of_bigge¡_š_cÜÃr
, 
cŞ_of_bigge¡_š_cÜÃr
;

354 
R—lSÿÏr
 
bigge¡_š_cÜÃr
;

356 
bigge¡_š_cÜÃr
 = 
m_lu
.
	`cÜÃr
(
Eig’
::
BÙtomRight
, 
rows
-
k
, 
cŞs
-k)

357 .
	`cwi£
().
	`abs
()

358 .
	`maxCÛff
(&
row_of_bigge¡_š_cÜÃr
, &
cŞ_of_bigge¡_š_cÜÃr
);

359 
row_of_bigge¡_š_cÜÃr
 +ğ
k
;

360 
cŞ_of_bigge¡_š_cÜÃr
 +ğ
k
;

361 if(
k
==0è
bigge¡
 = 
bigge¡_š_cÜÃr
;

364 if(
	`ei_isMuchSm®ËrThª
(
bigge¡_š_cÜÃr
, 
bigge¡
, 
m_´ecisiÚ
))

366 
m_¿nk
 = 
k
;

367 
i
 = 
k
; i < 
size
; i++)

369 
rows_Œª¥os™iÚs
.
	`cÛffRef
(
i
) = i;

370 
cŞs_Œª¥os™iÚs
.
	`cÛffRef
(
i
) = i;

375 
rows_Œª¥os™iÚs
.
	`cÛffRef
(
k
èğ
row_of_bigge¡_š_cÜÃr
;

376 
cŞs_Œª¥os™iÚs
.
	`cÛffRef
(
k
èğ
cŞ_of_bigge¡_š_cÜÃr
;

377 if(
k
 !ğ
row_of_bigge¡_š_cÜÃr
) {

378 
m_lu
.
	`row
(
k
).
	`sw­
(m_lu.row(
row_of_bigge¡_š_cÜÃr
));

379 ++
numb”_of_Œª¥os™iÚs
;

381 if(
k
 !ğ
cŞ_of_bigge¡_š_cÜÃr
) {

382 
m_lu
.
	`cŞ
(
k
).
	`sw­
(m_lu.cŞ(
cŞ_of_bigge¡_š_cÜÃr
));

383 ++
numb”_of_Œª¥os™iÚs
;

385 if(
k
<
rows
-1)

386 
m_lu
.
	`cŞ
(
k
).
	`’d
(
rows
-k-1è/ğm_lu.
	`cÛff
(k,k);

387 if(
k
<
size
-1)

388 
cŞ
 = 
k
 + 1; cŞ < 
cŞs
; ++col)

389 
m_lu
.
	`cŞ
(
cŞ
).
	`’d
(
rows
-
k
-1è-ğm_lu.cŞ(k).’dÔows-k-1è* m_lu.
	`cÛff
(k,col);

392 
k
 = 0; k < 
m©rix
.
	`rows
(); ++kè
m_p
.
	`cÛffRef
(k) = k;

393 
k
 = 
size
-1; k >= 0; --k)

394 
¡d
::
	`sw­
(
m_p
.
	`cÛffRef
(
k
), m_p.cÛffRef(
rows_Œª¥os™iÚs
.
	`cÛff
(k)));

396 
k
 = 0; k < 
m©rix
.
	`cŞs
(); ++kè
m_q
.
	`cÛffRef
(k) = k;

397 
k
 = 0; k < 
size
; ++k)

398 
¡d
::
	`sw­
(
m_q
.
	`cÛffRef
(
k
), m_q.cÛffRef(
cŞs_Œª¥os™iÚs
.
	`cÛff
(k)));

400 
m_d‘_pq
 = (
numb”_of_Œª¥os™iÚs
%2) ? -1 : 1;

401 
	}
}

403 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

404 
ty³Çme
 
	gei_Œa™s
<
	gM©rixTy³
>::
SÿÏr
 
LU
<
M©rixTy³
>::
	$d‘”mšªt
() const

406  
	`SÿÏr
(
m_d‘_pq
è* 
m_lu
.
	`dŸgÚ®
().
	`»dux
(
ei_sÿÏr_´oduù_İ
<
SÿÏr
>());

407 
	}
}

409 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

410 
	g‹m¶©e
<
ty³Çme
 
	gK”ÃlM©rixTy³
>

411 
	gLU
<
	gM©rixTy³
>::
	$compu‹K”Ãl
(
K”ÃlM©rixTy³
 *
»suÉ
) const

413 
	`ei_as£¹
(!
	`isInv”tibË
());

414 cÚ¡ 
dimk”
 = 
	`dim’siÚOfK”Ãl
(), 
cŞs
 = 
m_lu
.
	`cŞs
();

415 
»suÉ
->
	`»size
(
cŞs
, 
dimk”
);

433 
M©rix
<
SÿÏr
, 
DyÇmic
, DyÇmic, 
M©rixTy³
::
O±iÚs
,

434 
M©rixTy³
::
MaxCŞsAtCompeTime
, MatrixType::MaxColsAtCompileTime>

435 
	`y
(-
m_lu
.
	`cÜÃr
(
TİRight
, 
m_¿nk
, 
dimk”
));

437 
m_lu
.
	`cÜÃr
(
TİLeá
, 
m_¿nk
, m_rank)

438 .
‹m¶©e
 
m¬ked
<
Uµ”TrŸnguÏr
>()

439 .
	`sŞveTrŸnguÏrInPÏû
(
y
);

441 
i
 = 0; i < 
m_¿nk
; ++iè
»suÉ
->
	`row
(
m_q
.
	`cÛff
(i)èğ
y
.row(i);

442 
i
 = 
m_¿nk
; i < 
cŞs
; ++iè
»suÉ
->
	`row
(
m_q
.
	`cÛff
(i)).
	`£tZ”o
();

443 
k
 = 0; k < 
dimk”
; ++kè
»suÉ
->
	`cÛffRef
(
m_q
.
	`cÛff
(
m_¿nk
+k), kèğ
	`SÿÏr
(1);

444 
	}
}

446 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

447 cÚ¡ 
ty³Çme
 
	gLU
<
	gM©rixTy³
>::
K”ÃlResuÉTy³


448 
LU
<
M©rixTy³
>::
	$k”Ãl
() const

450 
K”ÃlResuÉTy³
 
	`»suÉ
(
m_lu
.
	`cŞs
(), 
	`dim’siÚOfK”Ãl
());

451 
	`compu‹K”Ãl
(&
»suÉ
);

452  
»suÉ
;

453 
	}
}

455 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

456 
	g‹m¶©e
<
ty³Çme
 
	gImageM©rixTy³
>

457 
	gLU
<
	gM©rixTy³
>::
	$compu‹Image
(
ImageM©rixTy³
 *
»suÉ
) const

459 
	`ei_as£¹
(
m_¿nk
 > 0);

460 
»suÉ
->
	`»size
(
m_Üigš®M©rix
.
	`rows
(), 
m_¿nk
);

461 
i
 = 0; i < 
m_¿nk
; ++i)

462 
»suÉ
->
	`cŞ
(
i
èğ
m_Üigš®M©rix
.cŞ(
m_q
.
	`cÛff
(i));

463 
	}
}

465 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

466 cÚ¡ 
ty³Çme
 
	gLU
<
	gM©rixTy³
>::
ImageResuÉTy³


467 
LU
<
M©rixTy³
>::
	$image
() const

469 
ImageResuÉTy³
 
	`»suÉ
(
m_Üigš®M©rix
.
	`rows
(), 
m_¿nk
);

470 
	`compu‹Image
(&
»suÉ
);

471  
»suÉ
;

472 
	}
}

474 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

475 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
,y³Çm
	gResuÉTy³
>

476 
boŞ
 
	gLU
<
	gM©rixTy³
>::
sŞve
(

477 cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
b
,

478 
ResuÉTy³
 *
»suÉ


489 cÚ¡ 
	grows
 = 
m_lu
.
rows
(), 
	gcŞs
 = m_lu.
cŞs
();

490 
ei_as£¹
(
b
.
rows
() ==„ows);

491 cÚ¡ 
	gsm®ldim
 = 
¡d
::
mš
(
rows
, 
cŞs
);

493 
ty³Çme
 
	gOth”D”ived
::
PÏšM©rixTy³
 
c
(
b
.
rows
(), b.
cŞs
());

496 
	gi
 = 0; i < 
	grows
; ++iè
	gc
.
row
(
m_p
.
cÛff
(
i
)èğ
b
.row(i);

499 
	gm_lu
.
cÜÃr
(
Eig’
::
TİLeá
,
sm®ldim
,sm®ldim).
‹m¶©e
 
	gm¬ked
<
	gUn™Low”TrŸnguÏr
>()

500 .
sŞveTrŸnguÏrInPÏû
(

501 
c
.
cÜÃr
(
Eig’
::
TİLeá
, 
sm®ldim
, c.
cŞs
()));

502 if(
	grows
>
	gcŞs
)

504 
	gc
.
cÜÃr
(
Eig’
::
BÙtomLeá
, 
rows
-
cŞs
, 
c
.cols())

505 -ğ
m_lu
.
cÜÃr
(
Eig’
::
BÙtomLeá
, 
rows
-
cŞs
, cŞsè* 
	gc
.cÜÃr(Eig’::
TİLeá
, cŞs, 
c
.cols());

509 if(!
isSurjeùive
())

512 
R—lSÿÏr
 
	gbigge¡_š_c
 = 
m_¿nk
>0 ? 
c
.
cÜÃr
(
TİLeá
, m_¿nk, c.
cŞs
()).
cwi£
().
abs
().
maxCÛff
() : RealScalar(0);

513 
	gcŞ
 = 0; cŞ < 
	gc
.
cŞs
(); ++col)

514 
	grow
 = 
m_¿nk
;„ow < 
	gc
.
rows
(); ++row)

515 if(!
ei_isMuchSm®ËrThª
(
c
.
cÛff
(
row
,
cŞ
), 
bigge¡_š_c
, 
m_´ecisiÚ
))

516  
	gçl£
;

518 if(
	gm_¿nk
>0)

519 
	gm_lu
.
cÜÃr
(
TİLeá
, 
m_¿nk
, m_rank)

520 .
‹m¶©e
 
	gm¬ked
<
	gUµ”TrŸnguÏr
>()

521 .
sŞveTrŸnguÏrInPÏû
(
c
.
cÜÃr
(
TİLeá
, 
m_¿nk
, c.
cŞs
()));

524 
	g»suÉ
->
»size
(
m_lu
.
cŞs
(), 
b
.cols());

525 
	gi
 = 0; i < 
	gm_¿nk
; ++iè
	g»suÉ
->
row
(
m_q
.
cÛff
(
i
)èğ
c
.row(i);

526 
	gi
 = 
m_¿nk
; i < 
	gm_lu
.
cŞs
(); ++iè
	g»suÉ
->
row
(
m_q
.
cÛff
(
i
)).
£tZ”o
();

527  
	gŒue
;

536 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

537 
šlše
 cÚ¡ 
	gLU
<
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³
>

538 
M©rixBa£
<
D”ived
>::
	$lu
() const

540  
LU
<
PÏšM©rixTy³
>(
	`ev®
());

541 
	}
}

	@robot/Eigen/src/LeastSquares/LeastSquares.h

25 #iâdeà
EIGEN_LEASTSQUARES_H


26 
	#EIGEN_LEASTSQUARES_H


	)

97 
	g‹m¶©e
<
ty³Çme
 
	gVeùÜTy³
>

98 
	$lš—rReg»ssiÚ
(
numPošts
,

99 
VeùÜTy³
 **
pošts
,

100 
VeùÜTy³
 *
»suÉ
,

101 
funcOfOth”s
 )

103 
ty³Çme
 
	tVeùÜTy³
::
	tSÿÏr
 Scalar;

104 
Hy³½ÏÃ
<
	tSÿÏr
, 
	tVeùÜTy³
::
	tSizeAtCompeTime
> 
	tHy³½ÏÃTy³
;

105 cÚ¡ 
size
 = 
pošts
[0]->
	`size
();

106 
»suÉ
->
	`»size
(
size
);

107 
Hy³½ÏÃTy³
 
	`h
(
size
);

108 
	`f™Hy³½ÏÃ
(
numPošts
, 
pošts
, &
h
);

109 
i
 = 0; i < 
funcOfOth”s
; i++)

110 
»suÉ
->
	`cÛffRef
(
i
èğ- 
h
.
	`cÛffs
()[i] / h.cÛffs()[
funcOfOth”s
];

111 
i
 = 
funcOfOth”s
; i < 
size
; i++)

112 
»suÉ
->
	`cÛffRef
(
i
èğ- 
h
.
	`cÛffs
()[i+1] / h.cÛffs()[
funcOfOth”s
];

113 
	}
}

142 
	g‹m¶©e
<
ty³Çme
 
	gVeùÜTy³
,y³Çm
	gHy³½ÏÃTy³
>

143 
f™Hy³½ÏÃ
(
numPošts
,

144 
VeùÜTy³
 **
pošts
,

145 
Hy³½ÏÃTy³
 *
»suÉ
,

146 
ty³Çme
 
NumT¿™s
<ty³Çm
VeùÜTy³
::
SÿÏr
>::
R—l
* 
soundÃss
 = 0)

148 
ty³Çme
 
	tVeùÜTy³
::
	tSÿÏr
 Scalar;

149 
	gM©rix
<
	tSÿÏr
,
	tVeùÜTy³
::
	tSizeAtCompeTime
,VeùÜTy³::SizeAtCompeTime> 
	tCovM©rixTy³
;

150 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
VeùÜTy³
)

151 
ei_as£¹
(
numPošts
 >= 1);

152 
	gsize
 = 
pošts
[0]->
size
();

153 
ei_as£¹
(
size
+1 =ğ
»suÉ
->
cÛffs
().size());

156 
VeùÜTy³
 
	gm—n
 = VeùÜTy³::
Z”o
(
size
);

157 
	gi
 = 0; i < 
	gnumPošts
; ++i)

158 
	gm—n
 +ğ*(
pošts
[
i
]);

159 
	gm—n
 /ğ
numPošts
;

162 
CovM©rixTy³
 
	gcovM©
 = CovM©rixTy³::
Z”o
(
size
, size);

163 
VeùÜTy³
 
	g»m—n
 = VeùÜTy³::
Z”o
(
size
);

164 
	gi
 = 0; i < 
	gnumPošts
; ++i)

166 
VeùÜTy³
 
	gdiff
 = (*(
pošts
[
i
]è- 
m—n
).
cÚjug©e
();

167 
	gcovM©
 +ğ
diff
 * diff.
adjošt
();

171 
	gS–fAdjoštEig’SŞv”
<
	gCovM©rixTy³
> 
eig
(
covM©
);

172 
	g»suÉ
->
nÜm®
(èğ
eig
.
eig’veùÜs
().
cŞ
(0);

173 ià(
	gsoundÃss
)

174 *
	gsoundÃss
 = 
eig
.
eig’v®ues
().
cÛff
(0)/eig.eigenvalues().coeff(1);

178 
	g»suÉ
->
off£t
(èğ- (
»suÉ
->
nÜm®
().
cwi£
()* 
m—n
).
sum
();

	@robot/Eigen/src/QR/EigenSolver.h

25 #iâdeà
EIGEN_EIGENSOLVER_H


26 
	#EIGEN_EIGENSOLVER_H


	)

43 
	g‹m¶©e
<
ty³Çme
 
	g_M©rixTy³
> cÏs 
	cEig’SŞv”


45 
	mpublic
:

47 
_M©rixTy³
 
	tM©rixTy³
;

48 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

49 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

50 
	m¡d
::
	tcom¶ex
<
	tR—lSÿÏr
> 
	tCom¶ex
;

51 
	mM©rix
<
	tCom¶ex
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, 1> 
	tEig’v®ueTy³
;

52 
	mM©rix
<
	tCom¶ex
, 
	tM©rixTy³
::
	tRowsAtCompeTime
, M©rixTy³::
	tCŞsAtCompeTime
> 
	tEig’veùÜTy³
;

53 
	mM©rix
<
	tR—lSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, 1> 
	tR—lVeùÜTy³
;

54 
	mM©rix
<
	tR—lSÿÏr
, 
	tDyÇmic
, 1> 
	tR—lVeùÜTy³X
;

62 
	$Eig’SŞv”
(è: 
	`m_eivec
(), 
	`m_eiv®ues
(), 
	$m_isIn™Ÿlized
(
çl£
) {}

64 
	$Eig’SŞv”
(cÚ¡ 
M©rixTy³
& 
m©rix
)

65 : 
	`m_eivec
(
m©rix
.
	`rows
(), m©rix.
	`cŞs
()),

66 
	`m_eiv®ues
(
m©rix
.
	`cŞs
()),

67 
	$m_isIn™Ÿlized
(
çl£
)

69 
	`compu‹
(
m©rix
);

70 
	}
}

73 
Eig’veùÜTy³
 
	$eig’veùÜs
() const;

106 cÚ¡ 
M©rixTy³
& 
	$p£udoEig’veùÜs
() const

108 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "EigenSolver is‚ot initialized.");

109  
m_eivec
;

110 
	}
}

112 
M©rixTy³
 
	$p£udoEig’v®ueM©rix
() const;

115 
Eig’v®ueTy³
 
	$eig’v®ues
() const

117 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "EigenSolver is‚ot initialized.");

118  
m_eiv®ues
;

119 
	}
}

121 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

123 
	g´iv©e
:

125 
Üthes
(
M©rixTy³
& 
m©H
, 
R—lVeùÜTy³
& 
Üt
);

126 
hqr2
(
M©rixTy³
& 
m©H
);

128 
	g´Ùeùed
:

129 
M©rixTy³
 
m_eivec
;

130 
Eig’v®ueTy³
 
	gm_eiv®ues
;

131 
boŞ
 
	gm_isIn™Ÿlized
;

138 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

139 
M©rixTy³
 
	gEig’SŞv”
<
	gM©rixTy³
>::
	$p£udoEig’v®ueM©rix
() const

141 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "EigenSolver is‚ot initialized.");

142 
n
 = 
m_eivec
.
	`cŞs
();

143 
M©rixTy³
 
m©D
 = M©rixTy³::
	`Z”o
(
n
,n);

144 
i
=0; i<
n
; ++i)

146 ià(
	`ei_isMuchSm®ËrThª
(
	`ei_imag
(
m_eiv®ues
.
	`cÛff
(
i
)), 
	`ei_»®
(m_eivalues.coeff(i))))

147 
m©D
.
	`cÛffRef
(
i
,ièğ
	`ei_»®
(
m_eiv®ues
.
	`cÛff
(i));

150 
m©D
.
‹m¶©e
 
block
<2,2>(
i
,iè<< 
	`ei_»®
(
m_eiv®ues
.
	`cÛff
(i)), 
	`ei_imag
(m_eivalues.coeff(i)),

151 -
	`ei_imag
(
m_eiv®ues
.
	`cÛff
(
i
)), 
	`ei_»®
(m_eivalues.coeff(i));

152 ++
i
;

155  
m©D
;

156 
	}
}

162 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

163 
ty³Çme
 
	gEig’SŞv”
<
	gM©rixTy³
>::
Eig’veùÜTy³
 
Eig’SŞv”
<
M©rixTy³
>::
	$eig’veùÜs
() const

165 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "EigenSolver is‚ot initialized.");

166 
n
 = 
m_eivec
.
	`cŞs
();

167 
Eig’veùÜTy³
 
	`m©V
(
n
,n);

168 
j
=0; j<
n
; ++j)

170 ià(
	`ei_isMuchSm®ËrThª
(
	`ei_abs
(
	`ei_imag
(
m_eiv®ues
.
	`cÛff
(
j
))),ƒi_abs(
	`ei_»®
(m_eivalues.coeff(j)))))

173 
m©V
.
	`cŞ
(
j
èğ
m_eivec
.cŞ(j).
‹m¶©e
 
ÿ¡
<
Com¶ex
>();

178 
i
=0; i<
n
; ++i)

180 
m©V
.
	`cÛffRef
(
i
,
j
èğ
	`Com¶ex
(
m_eivec
.
	`cÛff
(i,j), m_eivec.coeff(i,j+1));

181 
m©V
.
	`cÛffRef
(
i
,
j
+1èğ
	`Com¶ex
(
m_eivec
.
	`cÛff
(i,j), -m_eivec.coeff(i,j+1));

183 
m©V
.
	`cŞ
(
j
).
	`nÜm®ize
();

184 
m©V
.
	`cŞ
(
j
+1).
	`nÜm®ize
();

185 ++
j
;

188  
m©V
;

189 
	}
}

191 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

192 
	gEig’SŞv”
<
	gM©rixTy³
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
)

194 
	`as£¹
(
m©rix
.
	`cŞs
(è=ğm©rix.
	`rows
());

195 
n
 = 
m©rix
.
	`cŞs
();

196 
m_eiv®ues
.
	`»size
(
n
,1);

198 
M©rixTy³
 
m©H
 = 
m©rix
;

199 
R—lVeùÜTy³
 
	`Üt
(
n
);

202 
	`Üthes
(
m©H
, 
Üt
);

205 
	`hqr2
(
m©H
);

207 
m_isIn™Ÿlized
 = 
Œue
;

208 
	}
}

211 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

212 
	gEig’SŞv”
<
	gM©rixTy³
>::
	$Üthes
(
M©rixTy³
& 
m©H
, 
R—lVeùÜTy³
& 
Üt
)

219 
n
 = 
m_eivec
.
	`cŞs
();

220 
low
 = 0;

221 
high
 = 
n
-1;

223 
m
 = 
low
+1; m <ğ
high
-1; ++m)

226 
R—lSÿÏr
 
sÿË
 = 
m©H
.
	`block
(
m
, m-1, 
high
-m+1, 1).
	`cwi£
().
	`abs
().
	`sum
();

227 ià(
sÿË
 != 0.0)

230 
R—lSÿÏr
 
h
 = 0.0;

232 
i
 = 
high
; i >ğ
m
; i--)

234 
Üt
.
	`cÛffRef
(
i
èğ
m©H
.
	`cÛff
(i,
m
-1)/
sÿË
;

235 
h
 +ğ
Üt
.
	`cÛff
(
i
) * ort.coeff(i);

237 
R—lSÿÏr
 
g
 = 
	`ei_sq¹
(
h
);

238 ià(
Üt
.
	`cÛff
(
m
) > 0)

239 
g
 = -g;

240 
h
 = h - 
Üt
.
	`cÛff
(
m
è* 
g
;

241 
Üt
.
	`cÛffRef
(
m
èğÜt.
	`cÛff
(mè- 
g
;

245 
bSize
 = 
high
-
m
+1;

246 
m©H
.
	`block
(
m
, m, 
bSize
, 
n
-mè-ğ((
Üt
.
	`£gm’t
(m, bSize)/
h
)

247 * (
Üt
.
	`£gm’t
(
m
, 
bSize
).
	`Œª¥o£
(è* 
m©H
.
	`block
(m, m, bSize, 
n
-m)).
	`Ïzy
()).lazy();

249 
m©H
.
	`block
(0, 
m
, 
high
+1, 
bSize
è-ğ((m©H.block(0, m, high+1, bSizeè* 
Üt
.
	`£gm’t
(m, bSize)).
	`Ïzy
()

250 * (
Üt
.
	`£gm’t
(
m
, 
bSize
)/
h
).
	`Œª¥o£
()).
	`Ïzy
();

252 
Üt
.
	`cÛffRef
(
m
èğ
sÿË
*Üt.
	`cÛff
(m);

253 
m©H
.
	`cÛffRef
(
m
,m-1èğ
sÿË
*
g
;

258 
m_eivec
.
	`£tId’t™y
();

260 
m
 = 
high
-1; m >ğ
low
+1; m--)

262 ià(
m©H
.
	`cÛff
(
m
,m-1) != 0.0)

264 
Üt
.
	`£gm’t
(
m
+1, 
high
-mèğ
m©H
.
	`cŞ
(m-1).segment(m+1, high-m);

266 
bSize
 = 
high
-
m
+1;

267 
m_eivec
.
	`block
(
m
, m, 
bSize
, bSizeè+ğĞ(
Üt
.
	`£gm’t
(m, bSizeè/ (
m©H
.
	`cÛff
(m,m-1) * ort.coeff(m) ) )

268 * (
Üt
.
	`£gm’t
(
m
, 
bSize
).
	`Œª¥o£
(è* 
m_eivec
.
	`block
(m, m, bSize, bSize)).
	`Ïzy
());

271 
	}
}

274 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

275 
	g¡d
::
com¶ex
<
SÿÏr
> 
	$cdiv
(
SÿÏr
 
xr
, SÿÏ¸
xi
, SÿÏ¸
yr
, SÿÏ¸
yi
)

277 
SÿÏr
 
r
,
d
;

278 ià(
	`ei_abs
(
yr
è>ƒi_abs(
yi
))

280 
r
 = 
yi
/
yr
;

281 
d
 = 
yr
 + 
r
*
yi
;

282  
¡d
::
com¶ex
<
SÿÏr
>((
xr
 + 
r
*
xi
)/
d
, (xi -„*xr)/d);

286 
r
 = 
yr
/
yi
;

287 
d
 = 
yi
 + 
r
*
yr
;

288  
¡d
::
com¶ex
<
SÿÏr
>((
r
*
xr
 + 
xi
)/
d
, (r*xi - xr)/d);

290 
	}
}

294 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

295 
	gEig’SŞv”
<
	gM©rixTy³
>::
	$hqr2
(
M©rixTy³
& 
m©H
)

303 
Â
 = 
m_eivec
.
	`cŞs
();

304 
n
 = 
Â
-1;

305 
low
 = 0;

306 
high
 = 
Â
-1;

307 
SÿÏr
 
•s
 = 
	`ei_pow
(
	`SÿÏr
(2),
ei_is_§me_ty³
<SÿÏr,>::
»t
 ? Scalar(-23) : Scalar(-52));

308 
SÿÏr
 
exshiá
 = 0.0;

309 
SÿÏr
 
p
=0,
q
=0,
r
=0,
s
=0,
z
=0,
t
,
w
,
x
,
y
;

314 
SÿÏr
 
nÜm
 = 0.0;

315 
j
 = 0; j < 
Â
; ++j)

318 ià((
j
 < 
low
è|| (j > 
high
))

320 
m_eiv®ues
.
	`cÛffRef
(
j
èğ
	`Com¶ex
(
m©H
.
	`cÛff
(j,j), 0.0);

322 
nÜm
 +ğ
m©H
.
	`row
(
j
).
	`£gm’t
(
¡d
::
	`max
(j-1,0), 
Â
-¡d::max(j-1,0)).
	`cwi£
().
	`abs
().
	`sum
();

326 
™”
 = 0;

327 
n
 >ğ
low
)

330 
l
 = 
n
;

331 
l
 > 
low
)

333 
s
 = 
	`ei_abs
(
m©H
.
	`cÛff
(
l
-1,l-1)) +ƒi_abs(matH.coeff(l,l));

334 ià(
s
 == 0.0)

335 
s
 = 
nÜm
;

336 ià(
	`ei_abs
(
m©H
.
	`cÛff
(
l
,l-1)è< 
•s
 * 
s
)

338 
l
--;

343 ià(
l
 =ğ
n
)

345 
m©H
.
	`cÛffRef
(
n
,nèğm©H.
	`cÛff
Ò,nè+ 
exshiá
;

346 
m_eiv®ues
.
	`cÛffRef
(
n
èğ
	`Com¶ex
(
m©H
.
	`cÛff
(n,n), 0.0);

347 
n
--;

348 
™”
 = 0;

350 ià(
l
 =ğ
n
-1)

352 
w
 = 
m©H
.
	`cÛff
(
n
,n-1) * matH.coeff(n-1,n);

353 
p
 = (
m©H
.
	`cÛff
(
n
-1,n-1è- m©H.cÛffÒ,n)è* 
	`SÿÏr
(0.5);

354 
q
 = 
p
 *… + 
w
;

355 
z
 = 
	`ei_sq¹
(
	`ei_abs
(
q
));

356 
m©H
.
	`cÛffRef
(
n
,nèğm©H.
	`cÛff
Ò,nè+ 
exshiá
;

357 
m©H
.
	`cÛffRef
(
n
-1,n-1èğm©H.
	`cÛff
Ò-1,n-1è+ 
exshiá
;

358 
x
 = 
m©H
.
	`cÛff
(
n
,n);

361 ià(
q
 >= 0)

363 ià(
p
 >= 0)

364 
z
 = 
p
 + z;

366 
z
 = 
p
 - z;

368 
m_eiv®ues
.
	`cÛffRef
(
n
-1èğ
	`Com¶ex
(
x
 + 
z
, 0.0);

369 
m_eiv®ues
.
	`cÛffRef
(
n
èğ
	`Com¶ex
(
z
!=0.0 ? 
x
 - 
w
 / z : m_eiv®ues.
	`cÛff
Ò-1).
	`»®
(), 0.0);

371 
x
 = 
m©H
.
	`cÛff
(
n
,n-1);

372 
s
 = 
	`ei_abs
(
x
è+ƒi_abs(
z
);

373 
p
 = 
x
 / 
s
;

374 
q
 = 
z
 / 
s
;

375 
r
 = 
	`ei_sq¹
(
p
 *…+
q
 * q);

376 
p
 =… / 
r
;

377 
q
 = q / 
r
;

380 
j
 = 
n
-1; j < 
Â
; ++j)

382 
z
 = 
m©H
.
	`cÛff
(
n
-1,
j
);

383 
m©H
.
	`cÛffRef
(
n
-1,
j
èğ
q
 * 
z
 + 
p
 * m©H.
	`cÛff
(n,j);

384 
m©H
.
	`cÛffRef
(
n
,
j
èğ
q
 * m©H.
	`cÛff
Ò,jè- 
p
 * 
z
;

388 
i
 = 0; i <ğ
n
; ++i)

390 
z
 = 
m©H
.
	`cÛff
(
i
,
n
-1);

391 
m©H
.
	`cÛffRef
(
i
,
n
-1èğ
q
 * 
z
 + 
p
 * m©H.
	`cÛff
(i,n);

392 
m©H
.
	`cÛffRef
(
i
,
n
èğ
q
 * m©H.
	`cÛff
(i,nè- 
p
 * 
z
;

396 
i
 = 
low
; i <ğ
high
; ++i)

398 
z
 = 
m_eivec
.
	`cÛff
(
i
,
n
-1);

399 
m_eivec
.
	`cÛffRef
(
i
,
n
-1èğ
q
 * 
z
 + 
p
 * m_eivec.
	`cÛff
(i,n);

400 
m_eivec
.
	`cÛffRef
(
i
,
n
èğ
q
 * m_eivec.
	`cÛff
(i,nè- 
p
 * 
z
;

405 
m_eiv®ues
.
	`cÛffRef
(
n
-1èğ
	`Com¶ex
(
x
 + 
p
, 
z
);

406 
m_eiv®ues
.
	`cÛffRef
(
n
èğ
	`Com¶ex
(
x
 + 
p
, -
z
);

408 
n
 =‚ - 2;

409 
™”
 = 0;

414 
x
 = 
m©H
.
	`cÛff
(
n
,n);

415 
y
 = 0.0;

416 
w
 = 0.0;

417 ià(
l
 < 
n
)

419 
y
 = 
m©H
.
	`cÛff
(
n
-1,n-1);

420 
w
 = 
m©H
.
	`cÛff
(
n
,n-1) * matH.coeff(n-1,n);

424 ià(
™”
 == 10)

426 
exshiá
 +ğ
x
;

427 
i
 = 
low
; i <ğ
n
; ++i)

428 
m©H
.
	`cÛffRef
(
i
,iè-ğ
x
;

429 
s
 = 
	`ei_abs
(
m©H
.
	`cÛff
(
n
,n-1)) +ƒi_abs(matH.coeff(n-1,n-2));

430 
x
 = 
y
 = 
	`SÿÏr
(0.75è* 
s
;

431 
w
 = 
	`SÿÏr
(-0.4375è* 
s
 * s;

435 ià(
™”
 == 30)

437 
s
 = 
	`SÿÏr
((
y
 - 
x
) / 2.0);

438 
s
 = s * s + 
w
;

439 ià(
s
 > 0)

441 
s
 = 
	`ei_sq¹
(s);

442 ià(
y
 < 
x
)

443 
s
 = -s;

444 
s
 = 
	`SÿÏr
(
x
 - 
w
 / ((
y
 - x) / 2.0 + s));

445 
i
 = 
low
; i <ğ
n
; ++i)

446 
m©H
.
	`cÛffRef
(
i
,iè-ğ
s
;

447 
exshiá
 +ğ
s
;

448 
x
 = 
y
 = 
w
 = 
	`SÿÏr
(0.964);

452 
™”
 = iter + 1;

455 
m
 = 
n
-2;

456 
m
 >ğ
l
)

458 
z
 = 
m©H
.
	`cÛff
(
m
,m);

459 
r
 = 
x
 - 
z
;

460 
s
 = 
y
 - 
z
;

461 
p
 = (
r
 * 
s
 - 
w
è/ 
m©H
.
	`cÛff
(
m
+1,m) + matH.coeff(m,m+1);

462 
q
 = 
m©H
.
	`cÛff
(
m
+1,m+1è- 
z
 - 
r
 - 
s
;

463 
r
 = 
m©H
.
	`cÛff
(
m
+2,m+1);

464 
s
 = 
	`ei_abs
(
p
è+ƒi_abs(
q
è+ƒi_abs(
r
);

465 
p
 =… / 
s
;

466 
q
 = q / 
s
;

467 
r
 =„ / 
s
;

468 ià(
m
 =ğ
l
) {

471 ià(
	`ei_abs
(
m©H
.
	`cÛff
(
m
,m-1)è* (ei_abs(
q
è+ƒi_abs(
r
)) <

472 
•s
 * (
	`ei_abs
(
p
è* (ei_abs(
m©H
.
	`cÛff
(
m
-1,m-1)è+ƒi_abs(
z
) +

473 
	`ei_abs
(
m©H
.
	`cÛff
(
m
+1,m+1)))))

477 
m
--;

480 
i
 = 
m
+2; i <ğ
n
; ++i)

482 
m©H
.
	`cÛffRef
(
i
,i-2) = 0.0;

483 ià(
i
 > 
m
+2)

484 
m©H
.
	`cÛffRef
(
i
,i-3) = 0.0;

488 
k
 = 
m
; k <ğ
n
-1; ++k)

490 
nÙÏ¡
 = (
k
 !ğ
n
-1);

491 ià(
k
 !ğ
m
) {

492 
p
 = 
m©H
.
	`cÛff
(
k
,k-1);

493 
q
 = 
m©H
.
	`cÛff
(
k
+1,k-1);

494 
r
 = 
nÙÏ¡
 ? 
m©H
.
	`cÛff
(
k
+2,k-1è: 
	`SÿÏr
(0);

495 
x
 = 
	`ei_abs
(
p
è+ƒi_abs(
q
è+ƒi_abs(
r
);

496 ià(
x
 != 0.0)

498 
p
 =… / 
x
;

499 
q
 = q / 
x
;

500 
r
 =„ / 
x
;

504 ià(
x
 == 0.0)

507 
s
 = 
	`ei_sq¹
(
p
 *… + 
q
 * q + 
r
 *„);

509 ià(
p
 < 0)

510 
s
 = -s;

512 ià(
s
 != 0)

514 ià(
k
 !ğ
m
)

515 
m©H
.
	`cÛffRef
(
k
,k-1èğ-
s
 * 
x
;

516 ià(
l
 !ğ
m
)

517 
m©H
.
	`cÛffRef
(
k
,k-1èğ-m©H.
	`cÛff
(k,k-1);

519 
p
 =… + 
s
;

520 
x
 = 
p
 / 
s
;

521 
y
 = 
q
 / 
s
;

522 
z
 = 
r
 / 
s
;

523 
q
 = q / 
p
;

524 
r
 =„ / 
p
;

527 
j
 = 
k
; j < 
Â
; ++j)

529 
p
 = 
m©H
.
	`cÛff
(
k
,
j
è+ 
q
 * matH.coeff(k+1,j);

530 ià(
nÙÏ¡
)

532 
p
 =… + 
r
 * 
m©H
.
	`cÛff
(
k
+2,
j
);

533 
m©H
.
	`cÛffRef
(
k
+2,
j
èğm©H.
	`cÛff
(k+2,jè- 
p
 * 
z
;

535 
m©H
.
	`cÛffRef
(
k
,
j
èğm©H.
	`cÛff
(k,jè- 
p
 * 
x
;

536 
m©H
.
	`cÛffRef
(
k
+1,
j
èğm©H.
	`cÛff
(k+1,jè- 
p
 * 
y
;

540 
i
 = 0; i <ğ
¡d
::
	`mš
(
n
,
k
+3); ++i)

542 
p
 = 
x
 * 
m©H
.
	`cÛff
(
i
,
k
è+ 
y
 * matH.coeff(i,k+1);

543 ià(
nÙÏ¡
)

545 
p
 =… + 
z
 * 
m©H
.
	`cÛff
(
i
,
k
+2);

546 
m©H
.
	`cÛffRef
(
i
,
k
+2èğm©H.
	`cÛff
(i,k+2è- 
p
 * 
r
;

548 
m©H
.
	`cÛffRef
(
i
,
k
èğm©H.
	`cÛff
(i,kè- 
p
;

549 
m©H
.
	`cÛffRef
(
i
,
k
+1èğm©H.
	`cÛff
(i,k+1è- 
p
 * 
q
;

553 
i
 = 
low
; i <ğ
high
; ++i)

555 
p
 = 
x
 * 
m_eivec
.
	`cÛff
(
i
,
k
è+ 
y
 * m_eivec.coeff(i,k+1);

556 ià(
nÙÏ¡
)

558 
p
 =… + 
z
 * 
m_eivec
.
	`cÛff
(
i
,
k
+2);

559 
m_eivec
.
	`cÛffRef
(
i
,
k
+2èğm_eivec.
	`cÛff
(i,k+2è- 
p
 * 
r
;

561 
m_eivec
.
	`cÛffRef
(
i
,
k
èğm_eivec.
	`cÛff
(i,kè- 
p
;

562 
m_eivec
.
	`cÛffRef
(
i
,
k
+1èğm_eivec.
	`cÛff
(i,k+1è- 
p
 * 
q
;

570 ià(
nÜm
 == 0.0)

575 
n
 = 
Â
-1;‚ >= 0;‚--)

577 
p
 = 
m_eiv®ues
.
	`cÛff
(
n
).
	`»®
();

578 
q
 = 
m_eiv®ues
.
	`cÛff
(
n
).
	`imag
();

581 ià(
q
 == 0)

583 
l
 = 
n
;

584 
m©H
.
	`cÛffRef
(
n
,n) = 1.0;

585 
i
 = 
n
-1; i >= 0; i--)

587 
w
 = 
m©H
.
	`cÛff
(
i
,iè- 
p
;

588 
r
 = (
m©H
.
	`row
(
i
).
	`£gm’t
(
l
,
n
-l+1è* m©H.
	`cŞ
(n).segment(l,‚-l+1))(0,0);

590 ià(
m_eiv®ues
.
	`cÛff
(
i
).
	`imag
() < 0.0)

592 
z
 = 
w
;

593 
s
 = 
r
;

597 
l
 = 
i
;

598 ià(
m_eiv®ues
.
	`cÛff
(
i
).
	`imag
() == 0.0)

600 ià(
w
 != 0.0)

601 
m©H
.
	`cÛffRef
(
i
,
n
èğ-
r
 / 
w
;

603 
m©H
.
	`cÛffRef
(
i
,
n
èğ-
r
 / (
•s
 * 
nÜm
);

607 
x
 = 
m©H
.
	`cÛff
(
i
,i+1);

608 
y
 = 
m©H
.
	`cÛff
(
i
+1,i);

609 
q
 = (
m_eiv®ues
.
	`cÛff
(
i
).
	`»®
(è- 
p
è* (m_eiv®ues.cÛff(i).»®(è-…è+ m_eiv®ues.cÛff(i).
	`imag
() * m_eivalues.coeff(i).imag();

610 
t
 = (
x
 * 
s
 - 
z
 * 
r
è/ 
q
;

611 
m©H
.
	`cÛffRef
(
i
,
n
èğ
t
;

612 ià(
	`ei_abs
(
x
è>ƒi_abs(
z
))

613 
m©H
.
	`cÛffRef
(
i
+1,
n
èğ(-
r
 - 
w
 * 
t
è/ 
x
;

615 
m©H
.
	`cÛffRef
(
i
+1,
n
èğ(-
s
 - 
y
 * 
t
è/ 
z
;

619 
t
 = 
	`ei_abs
(
m©H
.
	`cÛff
(
i
,
n
));

620 ià((
•s
 * 
t
) * > 1)

621 
m©H
.
	`cŞ
(
n
).
	`’d
(
Â
-
i
è/ğ
t
;

625 ià(
q
 < 0)

627 
¡d
::
com¶ex
<
SÿÏr
> 
cc
;

628 
l
 = 
n
-1;

631 ià(
	`ei_abs
(
m©H
.
	`cÛff
(
n
,n-1)) >ƒi_abs(matH.coeff(n-1,n)))

633 
m©H
.
	`cÛffRef
(
n
-1,n-1èğ
q
 / m©H.
	`cÛff
(n,n-1);

634 
m©H
.
	`cÛffRef
(
n
-1,nèğ-(m©H.
	`cÛff
Ò,nè- 
p
) / matH.coeff(n,n-1);

638 
cc
 = 
cdiv
<
SÿÏr
>(0.0,-
m©H
.
	`cÛff
(
n
-1,n),m©H.cÛffÒ-1,n-1)-
p
,
q
);

639 
m©H
.
	`cÛffRef
(
n
-1,n-1èğ
	`ei_»®
(
cc
);

640 
m©H
.
	`cÛffRef
(
n
-1,nèğ
	`ei_imag
(
cc
);

642 
m©H
.
	`cÛffRef
(
n
,n-1) = 0.0;

643 
m©H
.
	`cÛffRef
(
n
,n) = 1.0;

644 
i
 = 
n
-2; i >= 0; i--)

646 
SÿÏr
 
¿
,
§
,
vr
,
vi
;

647 
¿
 = (
m©H
.
	`block
(
i
,
l
, 1, 
n
-l+1è* m©H.blockÖ,n-1,‚-l+1, 1)).
	`Ïzy
()(0,0);

648 
§
 = (
m©H
.
	`block
(
i
,
l
, 1, 
n
-l+1è* m©H.blockÖ,n,‚-l+1, 1)).
	`Ïzy
()(0,0);

649 
w
 = 
m©H
.
	`cÛff
(
i
,iè- 
p
;

651 ià(
m_eiv®ues
.
	`cÛff
(
i
).
	`imag
() < 0.0)

653 
z
 = 
w
;

654 
r
 = 
¿
;

655 
s
 = 
§
;

659 
l
 = 
i
;

660 ià(
m_eiv®ues
.
	`cÛff
(
i
).
	`imag
() == 0)

662 
cc
 = 
	`cdiv
(-
¿
,-
§
,
w
,
q
);

663 
m©H
.
	`cÛffRef
(
i
,
n
-1èğ
	`ei_»®
(
cc
);

664 
m©H
.
	`cÛffRef
(
i
,
n
èğ
	`ei_imag
(
cc
);

669 
x
 = 
m©H
.
	`cÛff
(
i
,i+1);

670 
y
 = 
m©H
.
	`cÛff
(
i
+1,i);

671 
vr
 = (
m_eiv®ues
.
	`cÛff
(
i
).
	`»®
(è- 
p
è* (m_eiv®ues.cÛff(i).»®(è-…è+ m_eiv®ues.cÛff(i).
	`imag
(è* m_eiv®ues.cÛff(i).imag(è- 
q
 * q;

672 
vi
 = (
m_eiv®ues
.
	`cÛff
(
i
).
	`»®
(è- 
p
è* 
	`SÿÏr
(2è* 
q
;

673 ià((
vr
 =ğ0.0è&& (
vi
 == 0.0))

674 
vr
 = 
•s
 * 
nÜm
 * (
	`ei_abs
(
w
è+ƒi_abs(
q
è+ƒi_abs(
x
è+ƒi_abs(
y
è+ƒi_abs(
z
));

676 
cc
ğ
	`cdiv
(
x
*
r
-
z
*
¿
+
q
*
§
,x*
s
-z*§-q*¿,
vr
,
vi
);

677 
m©H
.
	`cÛffRef
(
i
,
n
-1èğ
	`ei_»®
(
cc
);

678 
m©H
.
	`cÛffRef
(
i
,
n
èğ
	`ei_imag
(
cc
);

679 ià(
	`ei_abs
(
x
è> (ei_abs(
z
è+ƒi_abs(
q
)))

681 
m©H
.
	`cÛffRef
(
i
+1,
n
-1èğ(-
¿
 - 
w
 * m©H.
	`cÛff
(i,n-1è+ 
q
 * m©H.cÛff(i,n)è/ 
x
;

682 
m©H
.
	`cÛffRef
(
i
+1,
n
èğ(-
§
 - 
w
 * m©H.
	`cÛff
(i,nè- 
q
 * m©H.cÛff(i,n-1)è/ 
x
;

686 
cc
 = 
	`cdiv
(-
r
-
y
*
m©H
.
	`cÛff
(
i
,
n
-1),-
s
-y*m©H.cÛff(i,n),
z
,
q
);

687 
m©H
.
	`cÛffRef
(
i
+1,
n
-1èğ
	`ei_»®
(
cc
);

688 
m©H
.
	`cÛffRef
(
i
+1,
n
èğ
	`ei_imag
(
cc
);

693 
t
 = 
¡d
::
	`max
(
	`ei_abs
(
m©H
.
	`cÛff
(
i
,
n
-1)),ei_abs(matH.coeff(i,n)));

694 ià((
•s
 * 
t
) * > 1)

695 
m©H
.
	`block
(
i
, 
n
-1, 
Â
-i, 2è/ğ
t
;

703 
i
 = 0; i < 
Â
; ++i)

707 ià(
i
 < 
low
 || i > 
high
)

709 
m_eivec
.
	`row
(
i
).
	`’d
(
Â
-ièğ
m©H
.row(i).end(nn-i);

714 
bRows
 = 
high
-
low
+1;

715 
j
 = 
Â
-1; j >ğ
low
; j--)

717 
bSize
 = 
¡d
::
	`mš
(
j
,
high
)-
low
+1;

718 
m_eivec
.
	`cŞ
(
j
).
	`£gm’t
(
low
, 
bRows
èğ(m_eivec.
	`block
Öow,†ow, bRows, 
bSize
è* 
m©H
.col(j).segment(low, bSize));

720 
	}
}

	@robot/Eigen/src/QR/HessenbergDecomposition.h

25 #iâdeà
EIGEN_HESSENBERGDECOMPOSITION_H


26 
	#EIGEN_HESSENBERGDECOMPOSITION_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	g_M©rixTy³
> cÏs 
	cHes£nb”gDecompos™iÚ


44 
	mpublic
:

46 
_M©rixTy³
 
	tM©rixTy³
;

47 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

48 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

51 
	mSize
 = 
M©rixTy³
::
RowsAtCompeTime
,

52 
	mSizeMšusOÃ
 = 
M©rixTy³
::
RowsAtCompeTime
==
DyÇmic


53 ? 
DyÇmic


54 : 
M©rixTy³
::
RowsAtCompeTime
-1

57 
	gM©rix
<
	tSÿÏr
, 
	tSizeMšusOÃ
, 1> 
	tCÛffVeùÜTy³
;

58 
	gM©rix
<
	tR—lSÿÏr
, 
	tSize
, 1> 
	tDŸgÚ®Ty³
;

59 
	gM©rix
<
	tR—lSÿÏr
, 
	tSizeMšusOÃ
, 1> 
	tSubDŸgÚ®Ty³
;

61 
ty³Çme
 
	tNe¡ByV®ue
<
	tDŸgÚ®CÛffs
<
	tM©rixTy³
> >::
	tR—lR‘uºTy³
 
	tDŸgÚ®R‘uºTy³
;

63 
ty³Çme
 
	tNe¡ByV®ue
<
	tDŸgÚ®CÛffs
<

64 
	tNe¡ByV®ue
<
	tBlock
<
	tM©rixTy³
,
	tSizeMšusOÃ
,SizeMšusOÃ> > > >::
	tR—lR‘uºTy³
 
	tSubDŸgÚ®R‘uºTy³
;

69 
Hes£nb”gDecompos™iÚ
(
size
 = 
Size
==
DyÇmic
 ? 2 : Size)

70 : 
m_m©rix
(
size
,size), 
m_hCÛffs
(size-1)

73 
	$Hes£nb”gDecompos™iÚ
(cÚ¡ 
M©rixTy³
& 
m©rix
)

74 : 
	`m_m©rix
(
m©rix
),

75 
	`m_hCÛffs
(
m©rix
.
	`cŞs
()-1)

77 
	`_compu‹
(
m_m©rix
, 
m_hCÛffs
);

78 
	}
}

84 
	$compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
)

86 
m_m©rix
 = 
m©rix
;

87 
m_hCÛffs
.
	`»size
(
m©rix
.
	`rows
()-1,1);

88 
	`_compu‹
(
m_m©rix
, 
m_hCÛffs
);

89 
	}
}

96 
CÛffVeùÜTy³
 
	$hou£hŞd”CÛffic›Ás
(ècÚ¡ {  
m_hCÛffs
; 
	}
}

113 cÚ¡ 
	gM©rixTy³
& 
	$·ckedM©rix
(ècÚ¡ {  
m_m©rix
; 
	}
}

115 
M©rixTy³
 
	$m©rixQ
() const;

116 
M©rixTy³
 
	$m©rixH
() const;

118 
´iv©e
:

120 
	`_compu‹
(
M©rixTy³
& 
m©A
, 
CÛffVeùÜTy³
& 
hCÛffs
);

122 
´Ùeùed
:

123 
M©rixTy³
 
m_m©rix
;

124 
CÛffVeùÜTy³
 
m_hCÛffs
;

125 
	}
};

127 #iâdeà
EIGEN_HIDE_HEAVY_CODE


141 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

142 
	gHes£nb”gDecompos™iÚ
<
	gM©rixTy³
>::
	$_compu‹
(
M©rixTy³
& 
m©A
, 
CÛffVeùÜTy³
& 
hCÛffs
)

144 
	`as£¹
(
m©A
.
	`rows
()==m©A.
	`cŞs
());

145 
n
 = 
m©A
.
	`rows
();

146 
i
 = 0; i<
n
-2; ++i)

152 
R—lSÿÏr
 
v1nÜm2
 = 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-(i+2)).
	`squ¬edNÜm
();

154 ià(
	`ei_isMuchSm®ËrThª
(
v1nÜm2
,
¡©ic_ÿ¡
<
SÿÏr
>(1)))

156 
hCÛffs
.
	`cÛffRef
(
i
) = 0.;

160 
SÿÏr
 
v0
 = 
m©A
.
	`cŞ
(
i
).
	`cÛff
(i+1);

161 
R—lSÿÏr
 
b‘a
 = 
	`ei_sq¹
(
	`ei_abs2
(
v0
)+
v1nÜm2
);

162 ià(
	`ei_»®
(
v0
)>=0.)

163 
b‘a
 = -beta;

164 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-(i+2)è*ğ(
	`SÿÏr
(1)/(
v0
-
b‘a
));

165 
m©A
.
	`cŞ
(
i
).
	`cÛffRef
(i+1èğ
b‘a
;

166 
SÿÏr
 
h
 = (
b‘a
 - 
v0
) / beta;

171 
m©A
.
	`cŞ
(
i
).
	`cÛffRef
(i+1) = 1;

174 
m©A
.
	`cÜÃr
(
BÙtomRight
,
n
-
i
-1,n-i-1è-ğ((
	`ei_cÚj
(
h
è* m©A.
	`cŞ
(i).
	`’d
(n-i-1)) *

175 (
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-i-1).
	`adjošt
(è* m©A.
	`cÜÃr
(
BÙtomRight
,n-i-1,n-i-1))).
	`Ïzy
();

178 
m©A
.
	`cÜÃr
(
BÙtomRight
,
n
,n-
i
-1è-ğ((m©A.cÜÃr(BÙtomRight,n,n-i-1è* m©A.
	`cŞ
(i).
	`’d
(n-i-1))

179 * (
h
 * 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-i-1).
	`adjošt
())).
	`Ïzy
();

181 
m©A
.
	`cŞ
(
i
).
	`cÛffRef
(i+1èğ
b‘a
;

182 
hCÛffs
.
	`cÛffRef
(
i
èğ
h
;

185 ià(
NumT¿™s
<
SÿÏr
>::
IsCom¶ex
)

188 
i
 = 
n
-2;

189 
SÿÏr
 
v0
 = 
m©A
.
	`cÛff
(
i
+1,i);

191 
R—lSÿÏr
 
b‘a
 = 
	`ei_sq¹
(
	`ei_abs2
(
v0
));

192 ià(
	`ei_»®
(
v0
)>=0.)

193 
b‘a
 = -beta;

194 
SÿÏr
 
h
 = (
b‘a
 - 
v0
) / beta;

195 
hCÛffs
.
	`cÛffRef
(
i
èğ
h
;

198 
m©A
.
	`cÜÃr
(
BÙtomRight
,
n
-
i
-1,n-iè-ğ
	`ei_cÚj
(
h
) * matA.corner(BottomRight,n-i-1,n-i);

201 
m©A
.
	`cŞ
(
n
-1è-ğ
h
 * matA.col(n-1);

205 
hCÛffs
.
	`cÛffRef
(
n
-2) = 0;

207 
	}
}

210 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

211 
ty³Çme
 
	gHes£nb”gDecompos™iÚ
<
	gM©rixTy³
>::
M©rixTy³


212 
Hes£nb”gDecompos™iÚ
<
M©rixTy³
>::
	$m©rixQ
() const

214 
n
 = 
m_m©rix
.
	`rows
();

215 
M©rixTy³
 
m©Q
 = M©rixTy³::
	`Id’t™y
(
n
,n);

216 
i
 = 
n
-2; i>=0; i--)

218 
SÿÏr
 
tmp
 = 
m_m©rix
.
	`cÛff
(
i
+1,i);

219 
m_m©rix
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(
i
+1,i) = 1;

221 
m©Q
.
	`cÜÃr
(
BÙtomRight
,
n
-
i
-1,n-i-1) -=

222 ((
m_hCÛffs
.
	`cÛff
(
i
è* 
m_m©rix
.
	`cŞ
(i).
	`’d
(
n
-i-1)) *

223 (
m_m©rix
.
	`cŞ
(
i
).
	`’d
(
n
-i-1).
	`adjošt
(è* 
m©Q
.
	`cÜÃr
(
BÙtomRight
,n-i-1,n-i-1)).
	`Ïzy
()).lazy();

225 
m_m©rix
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(
i
+1,ièğ
tmp
;

227  
m©Q
;

228 
	}
}

237 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

238 
ty³Çme
 
	gHes£nb”gDecompos™iÚ
<
	gM©rixTy³
>::
M©rixTy³


239 
Hes£nb”gDecompos™iÚ
<
M©rixTy³
>::
	$m©rixH
() const

243 
n
 = 
m_m©rix
.
	`rows
();

244 
M©rixTy³
 
m©H
 = 
m_m©rix
;

245 ià(
n
>2)

246 
m©H
.
	`cÜÃr
(
BÙtomLeá
,
n
-2,‚-2).
‹m¶©e
 
·¹
<
Low”TrŸnguÏr
>().
	`£tZ”o
();

247  
m©H
;

248 
	}
}

	@robot/Eigen/src/QR/QR.h

25 #iâdeà
EIGEN_QR_H


26 
	#EIGEN_QR_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> cÏs 
	cQR


44 
	mpublic
:

46 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

47 
ty³Çme
 
	tM©rixTy³
::
	tR—lSÿÏr
 RealScalar;

48 
	mBlock
<
	tM©rixTy³
, M©rixTy³::
	tCŞsAtCompeTime
, M©rixTy³::CŞsAtCompeTime> 
	tM©rixRBlockTy³
;

49 
	mM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, M©rixTy³::CŞsAtCompeTime> 
	tM©rixTy³R
;

50 
	mM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, 1> 
	tVeùÜTy³
;

58 
	$QR
(è: 
	`m_qr
(), 
	`m_hCÛffs
(), 
	$m_isIn™Ÿlized
(
çl£
) {}

60 
	$QR
(cÚ¡ 
M©rixTy³
& 
m©rix
)

61 : 
	`m_qr
(
m©rix
.
	`rows
(), m©rix.
	`cŞs
()),

62 
	`m_hCÛffs
(
m©rix
.
	`cŞs
()),

63 
	$m_isIn™Ÿlized
(
çl£
)

65 
	`compu‹
(
m©rix
);

66 
	}
}

74 
EIGEN_DEPRECATED
 
boŞ
 
	$isFuÎRªk
() const

76 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

77  
	`¿nk
(è=ğ
m_qr
.
	`cŞs
();

78 
	}
}

85 
	$¿nk
() const;

92 
šlše
 
	$dim’siÚOfK”Ãl
() const

94 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

95  
m_qr
.
	`cŞs
(è- 
	`¿nk
();

96 
	}
}

104 
šlše
 
boŞ
 
	$isInjeùive
() const

106 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

107  
	`¿nk
(è=ğ
m_qr
.
	`cŞs
();

108 
	}
}

116 
šlše
 
boŞ
 
	$isSurjeùive
() const

118 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

119  
	`¿nk
(è=ğ
m_qr
.
	`rows
();

120 
	}
}

127 
šlše
 
boŞ
 
	$isInv”tibË
() const

129 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

130  
	`isInjeùive
(è&& 
	`isSurjeùive
();

131 
	}
}

134 cÚ¡ 
	gP¬t
<
	gNe¡ByV®ue
<
	gM©rixRBlockTy³
>, 
	gUµ”TrŸnguÏr
>

135 
	$m©rixR
() const

137 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

138 
cŞs
 = 
m_qr
.
	`cŞs
();

139  
	`M©rixRBlockTy³
(
m_qr
, 0, 0, 
cŞs
, cŞs).
	`Ã¡ByV®ue
().
‹m¶©e
 
·¹
<
Uµ”TrŸnguÏr
>();

140 
	}
}

165 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
,y³Çm
	gResuÉTy³
>

166 
boŞ
 
sŞve
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
b
, 
ResuÉTy³
 *
»suÉ
) const;

168 
M©rixTy³
 
	$m©rixQ
() const;

170 
	`compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

172 
´Ùeùed
:

173 
M©rixTy³
 
m_qr
;

174 
VeùÜTy³
 
m_hCÛffs
;

175 
mubË
 
m_¿nk
;

176 
mubË
 
boŞ
 
m_¿nkIsU±od©e
;

177 
boŞ
 
m_isIn™Ÿlized
;

178 
	}
};

181 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

182 
	gQR
<
	gM©rixTy³
>::
	$¿nk
() const

184 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

185 ià(!
m_¿nkIsU±od©e
)

187 
R—lSÿÏr
 
maxCÛff
 = 
m_qr
.
	`dŸgÚ®
().
	`cwi£
().
	`abs
().
	`maxCÛff
();

188 
n
 = 
m_qr
.
	`cŞs
();

189 
m_¿nk
 = 0;

190 
m_¿nk
<
n
 && !
	`ei_isMuchSm®ËrThª
(
m_qr
.
	`dŸgÚ®
().
	`cÛff
(m_¿nk), 
maxCÛff
))

191 ++
m_¿nk
;

192 
m_¿nkIsU±od©e
 = 
Œue
;

194  
m_¿nk
;

195 
	}
}

197 #iâdeà
EIGEN_HIDE_HEAVY_CODE


199 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

200 
	gQR
<
	gM©rixTy³
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
)

202 
m_¿nkIsU±od©e
 = 
çl£
;

203 
m_qr
 = 
m©rix
;

204 
m_hCÛffs
.
	`»size
(
m©rix
.
	`cŞs
());

206 
rows
 = 
m©rix
.
	`rows
();

207 
cŞs
 = 
m©rix
.
	`cŞs
();

208 
R—lSÿÏr
 
•s2
 = 
´ecisiÚ
<RealScalar>()*precision<RealScalar>();

210 
k
 = 0; k < 
cŞs
; ++k)

212 
»maššgSize
 = 
rows
-
k
;

214 
R—lSÿÏr
 
b‘a
;

215 
SÿÏr
 
v0
 = 
m_qr
.
	`cŞ
(
k
).
	`cÛff
(k);

217 ià(
»maššgSize
==1)

219 ià(
NumT¿™s
<
SÿÏr
>::
IsCom¶ex
)

222 
b‘a
 = 
	`ei_abs
(
v0
);

223 ià(
	`ei_»®
(
v0
)>0)

224 
b‘a
 = -beta;

225 
m_qr
.
	`cÛffRef
(
k
,kèğ
b‘a
;

226 
m_hCÛffs
.
	`cÛffRef
(
k
èğ(
b‘a
 - 
v0
) / beta;

230 
m_hCÛffs
.
	`cÛffRef
(
k
) = 0;

233 ià((
b‘a
=
m_qr
.
	`cŞ
(
k
).
	`’d
(
»maššgSize
-1).
	`squ¬edNÜm
())>
•s2
)

237 
b‘a
 = 
	`ei_sq¹
(
	`ei_abs2
(
v0
)+beta);

238 ià(
	`ei_»®
(
v0
)>=0.)

239 
b‘a
 = -beta;

240 
m_qr
.
	`cŞ
(
k
).
	`’d
(
»maššgSize
-1è/ğ
v0
-
b‘a
;

241 
m_qr
.
	`cÛffRef
(
k
,kèğ
b‘a
;

242 
SÿÏr
 
h
 = 
m_hCÛffs
.
	`cÛffRef
(
k
èğ(
b‘a
 - 
v0
) / beta;

246 
»maššgCŞs
 = 
cŞs
 - 
k
 -1;

247 ià(
»maššgCŞs
>0)

249 
m_qr
.
	`cÛffRef
(
k
,kèğ
	`SÿÏr
(1);

250 
m_qr
.
	`cÜÃr
(
BÙtomRight
, 
»maššgSize
, 
»maššgCŞs
è-ğ
	`ei_cÚj
(
h
è* m_qr.
	`cŞ
(
k
).
	`’d
(remainingSize)

251 * (
m_qr
.
	`cŞ
(
k
).
	`’d
(
»maššgSize
).
	`adjošt
(è* m_qr.
	`cÜÃr
(
BÙtomRight
,„emaššgSize, 
»maššgCŞs
));

252 
m_qr
.
	`cÛffRef
(
k
,kèğ
b‘a
;

257 
m_hCÛffs
.
	`cÛffRef
(
k
) = 0;

260 
m_isIn™Ÿlized
 = 
Œue
;

261 
	}
}

263 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

264 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
,y³Çm
	gResuÉTy³
>

265 
boŞ
 
	gQR
<
	gM©rixTy³
>::
sŞve
(

266 cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
b
,

267 
ResuÉTy³
 *
»suÉ


270 
ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

271 cÚ¡ 
	grows
 = 
m_qr
.
rows
();

272 
ei_as£¹
(
b
.
rows
() ==„ows);

274 
¿nk
();

276 
	g»suÉ
->
»size
(
m_qr
.
cŞs
(), 
b
.cols());

280 *
	g»suÉ
 = 
m©rixQ
().
Œª¥o£
()*
b
;

282 if(
	gm_¿nk
==0)

283  
»suÉ
->
isZ”o
();

285 if(!
isSurjeùive
())

288 
R—lSÿÏr
 
	gbigge¡_š_»s
 = 
»suÉ
->
cÜÃr
(
TİLeá
, 
m_¿nk
,„esuÉ->
cŞs
()).
cwi£
().
abs
().
maxCÛff
();

289 
	gcŞ
 = 0; cŞ < 
	g»suÉ
->
cŞs
(); ++col)

290 
	grow
 = 
m_¿nk
;„ow < 
	g»suÉ
->
rows
(); ++row)

291 if(!
ei_isMuchSm®ËrThª
(
»suÉ
->
cÛff
(
row
,
cŞ
), 
bigge¡_š_»s
))

292  
	gçl£
;

294 
	gm_qr
.
cÜÃr
(
TİLeá
, 
m_¿nk
, m_rank)

295 .
‹m¶©e
 
	gm¬ked
<
	gUµ”TrŸnguÏr
>()

296 .
sŞveTrŸnguÏrInPÏû
(
»suÉ
->
cÜÃr
(
TİLeá
, 
m_¿nk
,„esuÉ->
cŞs
()));

298  
	gŒue
;

302 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

303 
M©rixTy³
 
	gQR
<
	gM©rixTy³
>::
	$m©rixQ
() const

305 
	`ei_as£¹
(
m_isIn™Ÿlized
 && "QR is‚ot initialized.");

309 
rows
 = 
m_qr
.
	`rows
();

310 
cŞs
 = 
m_qr
.
	`cŞs
();

311 
M©rixTy³
 
»s
 = M©rixTy³::
	`Id’t™y
(
rows
, 
cŞs
);

312 
k
 = 
cŞs
-1; k >= 0; k--)

316 
SÿÏr
 
b‘a
 = 
m_qr
.
	`cÛff
(
k
,k);

317 
m_qr
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(
k
,k) = 1;

318 
’dL’gth
 = 
rows
-
k
;

319 
»s
.
	`cÜÃr
(
BÙtomRight
,
’dL’gth
, 
cŞs
-
k
è-ğ((
m_hCÛffs
.
	`cÛff
(kè* 
m_qr
.
	`cŞ
(k).
	`’d
(endLength))

320 * (
m_qr
.
	`cŞ
(
k
).
	`’d
(
’dL’gth
).
	`adjošt
(è* 
»s
.
	`cÜÃr
(
BÙtomRight
,’dL’gth, 
cŞs
-k)).
	`Ïzy
()).lazy();

321 
m_qr
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(
k
,kèğ
b‘a
;

323  
»s
;

324 
	}
}

332 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

333 cÚ¡ 
	gQR
<
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³
>

334 
M©rixBa£
<
D”ived
>::
	$qr
() const

336  
QR
<
PÏšM©rixTy³
>(
	`ev®
());

337 
	}
}

	@robot/Eigen/src/QR/QrInstantiations.cpp

25 #iâdeà
EIGEN_EXTERN_INSTANTIATIONS


26 
	#EIGEN_EXTERN_INSTANTIATIONS


	)

28 
	~"../../CÜe
"

29 #undeà
EIGEN_EXTERN_INSTANTIATIONS


31 
	~"../../QR
"

33 
Çme¥aû
 
	gEig’


36 
‹m¶©e
 
ei_ŒidŸgÚ®_qr_¡•
(* , * , , , * , );

37 
‹m¶©e
 
ei_ŒidŸgÚ®_qr_¡•
(* , * , , , * , );

38 
‹m¶©e
 
ei_ŒidŸgÚ®_qr_¡•
(* , * , , , 
¡d
::
com¶ex
<>* , );

39 
‹m¶©e
 
ei_ŒidŸgÚ®_qr_¡•
(* , * , , , 
¡d
::
com¶ex
<>* , );

41 
EIGEN_QR_MODULE_INSTANTIATE
();

	@robot/Eigen/src/QR/SelfAdjointEigenSolver.h

25 #iâdeà
EIGEN_SELFADJOINTEIGENSOLVER_H


26 
	#EIGEN_SELFADJOINTEIGENSOLVER_H


	)

41 
	g‹m¶©e
<
ty³Çme
 
	g_M©rixTy³
> cÏs 
	cS–fAdjoštEig’SŞv”


43 
	mpublic
:

45 ’um {
Size
 = 
_M©rixTy³
::
RowsAtCompeTime
 };

46 
_M©rixTy³
 
	tM©rixTy³
;

47 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

48 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

49 
	g¡d
::
	tcom¶ex
<
	tR—lSÿÏr
> 
	tCom¶ex
;

50 
	gM©rix
<
	tR—lSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, 1> 
	tR—lVeùÜTy³
;

51 
	gM©rix
<
	tR—lSÿÏr
, 
	tDyÇmic
, 1> 
	tR—lVeùÜTy³X
;

52 
	gTridŸgÚ®iz©iÚ
<
	tM©rixTy³
> 
	tTridŸgÚ®iz©iÚTy³
;

54 
	$S–fAdjoštEig’SŞv”
()

55 : 
	`m_eivec
((
Size
), (Size)),

56 
	`m_eiv®ues
((
Size
))

58 
	`ei_as£¹
(
Size
!=
DyÇmic
);

59 
	}
}

61 
	$S–fAdjoštEig’SŞv”
(
size
)

62 : 
	`m_eivec
(
size
, size),

63 
	$m_eiv®ues
(
size
)

64 {
	}
}

71 
	$S–fAdjoštEig’SŞv”
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
boŞ
 
compu‹Eig’veùÜs
 = 
Œue
)

72 : 
	`m_eivec
(
m©rix
.
	`rows
(), m©rix.
	`cŞs
()),

73 
	`m_eiv®ues
(
m©rix
.
	$cŞs
())

75 
	`compu‹
(
m©rix
, 
compu‹Eig’veùÜs
);

76 
	}
}

85 
	$S–fAdjoštEig’SŞv”
(cÚ¡ 
M©rixTy³
& 
m©A
, cÚ¡ M©rixTy³& 
m©B
, 
boŞ
 
compu‹Eig’veùÜs
 = 
Œue
)

86 : 
	`m_eivec
(
m©A
.
	`rows
(), m©A.
	`cŞs
()),

87 
	`m_eiv®ues
(
m©A
.
	$cŞs
())

89 
	`compu‹
(
m©A
, 
m©B
, 
compu‹Eig’veùÜs
);

90 
	}
}

92 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
boŞ
 
compu‹Eig’veùÜs
 = 
Œue
);

94 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©A
, cÚ¡ M©rixTy³& 
m©B
, 
boŞ
 
compu‹Eig’veùÜs
 = 
Œue
);

97 
M©rixTy³
 
	$eig’veùÜs
() const

99 #iâdeà
NDEBUG


100 
	`ei_as£¹
(
m_eig’veùÜsOk
);

102  
m_eivec
;

103 
	}
}

106 
R—lVeùÜTy³
 
	$eig’v®ues
(ècÚ¡ {  
m_eiv®ues
; 
	}
}

112 
M©rixTy³
 
	$İ”©ÜSq¹
() const

114  
m_eivec
 * 
m_eiv®ues
.
	`cwi£
().
	`sq¹
().
	`asDŸgÚ®
(è* m_eivec.
	`adjošt
();

115 
	}
}

121 
M©rixTy³
 
	$İ”©ÜInv”£Sq¹
() const

123  
m_eivec
 * 
m_eiv®ues
.
	`cwi£
().
	`šv”£
().cwi£().
	`sq¹
().
	`asDŸgÚ®
(è* m_eivec.
	`adjošt
();

124 
	}
}

127 
	g´Ùeùed
:

128 
M©rixTy³
 
m_eivec
;

129 
R—lVeùÜTy³
 
	gm_eiv®ues
;

130 #iâdeà
NDEBUG


131 
boŞ
 
	gm_eig’veùÜsOk
;

135 #iâdeà
EIGEN_HIDE_HEAVY_CODE


138 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

139 
	$ei_giv’s_rÙ©iÚ
(
SÿÏr
 
a
, SÿÏ¸
b
, SÿÏr& 
c
, SÿÏr& 
s
)

141 ià(
b
==0)

143 
c
 = 1; 
s
 = 0;

145 ià(
	`ei_abs
(
b
)>ei_abs(
a
))

147 
SÿÏr
 
t
 = -
a
/
b
;

148 
s
 = 
	`SÿÏr
(1)/
	`ei_sq¹
(1+
t
*t);

149 
c
 = 
s
 * 
t
;

153 
SÿÏr
 
t
 = -
b
/
a
;

154 
c
 = 
	`SÿÏr
(1)/
	`ei_sq¹
(1+
t
*t);

155 
s
 = 
c
 * 
t
;

157 
	}
}

175 
	g‹m¶©e
<
ty³Çme
 
	gR—lSÿÏr
,y³Çm
	gSÿÏr
>

176 
ei_ŒidŸgÚ®_qr_¡•
(
R—lSÿÏr
* 
dŸg
, R—lSÿÏr* 
subdŸg
, 
¡¬t
, 
’d
, 
SÿÏr
* 
m©rixQ
, 
n
);

183 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

184 
	gS–fAdjoštEig’SŞv”
<
	gM©rixTy³
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
boŞ
 
compu‹Eig’veùÜs
)

186 #iâdeà
NDEBUG


187 
m_eig’veùÜsOk
 = 
compu‹Eig’veùÜs
;

189 
	`as£¹
(
m©rix
.
	`cŞs
(è=ğm©rix.
	`rows
());

190 
n
 = 
m©rix
.
	`cŞs
();

191 
m_eiv®ues
.
	`»size
(
n
,1);

193 if(
n
==1)

195 
m_eiv®ues
.
	`cÛffRef
(0,0èğ
	`ei_»®
(
m©rix
.
	`cÛff
(0,0));

196 
m_eivec
.
	`£tOÃs
();

200 
m_eivec
 = 
m©rix
;

205 
R—lVeùÜTy³
& 
dŸg
 = 
m_eiv®ues
;

206 
ty³Çme
 
TridŸgÚ®iz©iÚTy³
::
SubDŸgÚ®Ty³
 
	`subdŸg
(
n
-1);

207 
TridŸgÚ®iz©iÚTy³
::
	`decompo£InPÏû
(
m_eivec
, 
dŸg
, 
subdŸg
, 
compu‹Eig’veùÜs
);

209 
’d
 = 
n
-1;

210 
¡¬t
 = 0;

211 
’d
>0)

213 
i
 = 
¡¬t
; i<
’d
; ++i)

214 ià(
	`ei_isMuchSm®ËrThª
(
	`ei_abs
(
subdŸg
[
i
]),Ói_abs(
dŸg
[i])+ei_abs(diag[i+1]))))

215 
subdŸg
[
i
] = 0;

218 
’d
>0 && 
subdŸg
[end-1]==0)

219 
’d
--;

220 ià(
’d
<=0)

222 
¡¬t
 = 
’d
 - 1;

223 
¡¬t
>0 && 
subdŸg
[start-1]!=0)

224 
¡¬t
--;

226 
	`ei_ŒidŸgÚ®_qr_¡•
(
dŸg
.
	`d©a
(), 
subdŸg
.d©a(), 
¡¬t
, 
’d
, 
compu‹Eig’veùÜs
 ? 
m_eivec
.d©a(è: (
SÿÏr
*)0, 
n
);

232 
i
 = 0; i < 
n
-1; ++i)

234 
k
;

235 
m_eiv®ues
.
	`£gm’t
(
i
,
n
-i).
	`mšCÛff
(&
k
);

236 ià(
k
 > 0)

238 
¡d
::
	`sw­
(
m_eiv®ues
[
i
], m_eiv®ues[
k
+i]);

239 
m_eivec
.
	`cŞ
(
i
).
	`sw­
(m_eivec.cŞ(
k
+i));

242 
	}
}

251 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

252 
	gS–fAdjoštEig’SŞv”
<
	gM©rixTy³
>::

253 
	$compu‹
(cÚ¡ 
M©rixTy³
& 
m©A
, cÚ¡ M©rixTy³& 
m©B
, 
boŞ
 
compu‹Eig’veùÜs
)

255 
	`ei_as£¹
(
m©A
.
	`cŞs
()==m©A.
	`rows
(è&& 
m©B
.rows()==matA.rows() && matB.cols()==matB.rows());

258 
LLT
<
M©rixTy³
> 
	`chŞB
(
m©B
);

261 
M©rixTy³
 
m©C
 = 
m©A
;

262 
chŞB
.
	`m©rixL
().
	`sŞveTrŸnguÏrInPÏû
(
m©C
);

264 
m©C
 = m©C.
	`adjošt
().
	`ev®
();

265 
chŞB
.
	`m©rixL
().
‹m¶©e
 
m¬ked
<
Low”TrŸnguÏr
>().
	`sŞveTrŸnguÏrInPÏû
(
m©C
);

266 
m©C
 = m©C.
	`adjošt
().
	`ev®
();

275 
	`compu‹
(
m©C
, 
compu‹Eig’veùÜs
);

277 ià(
compu‹Eig’veùÜs
)

280 
chŞB
.
	`m©rixL
().
	`adjošt
().
‹m¶©e
 
m¬ked
<
Uµ”TrŸnguÏr
>().
	`sŞveTrŸnguÏrInPÏû
(
m_eivec
);

281 
i
=0; i<
m_eivec
.
	`cŞs
(); ++i)

282 
m_eivec
.
	`cŞ
(
i
èğm_eivec.cŞ(i).
	`nÜm®ized
();

284 
	}
}

292 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

293 
šlše
 
	gM©rix
<
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l
,ƒi_Œa™s<D”ived>::
CŞsAtCompeTime
, 1>

294 
	gM©rixBa£
<
	gD”ived
>::
	$eig’v®ues
() const

296 
	`ei_as£¹
(
FÏgs
&
S–fAdjoštB™
);

297  
S–fAdjoštEig’SŞv”
<
ty³Çme
 
D”ived
::
PÏšM©rixTy³
>(
	`ev®
(),
çl£
).
	`eig’v®ues
();

298 
	}
}

300 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
, 
boŞ
 
	gIsS–fAdjošt
>

301 
	sei_İ”©ÜNÜm_£ËùÜ


303 
šlše
 
ty³Çme
 
	mNumT¿™s
<ty³Çm
	mei_Œa™s
<
	mD”ived
>::
SÿÏr
>::
R—l


304 
İ”©ÜNÜm
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
)

308  
m
.
eig’v®ues
().
cwi£
().
abs
().
maxCÛff
();

312 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
	gei_İ”©ÜNÜm_£ËùÜ
<D”ived, 
	gçl£
>

314 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l


315 
İ”©ÜNÜm
(cÚ¡ 
M©rixBa£
<
D”ived
>& 
m
)

317 
ty³Çme
 
D”ived
::
PÏšM©rixTy³
 
m_ev®
(
m
);

320  
ei_sq¹
(

321 (
m_ev®
*m_ev®.
adjošt
())

322 .
‹m¶©e
 
m¬ked
<
S–fAdjošt
>()

323 .
eig’v®ues
()

324 .
maxCÛff
()

333 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

334 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l


335 
M©rixBa£
<
D”ived
>::
	$İ”©ÜNÜm
() const

337  
ei_İ”©ÜNÜm_£ËùÜ
<
D”ived
, 
FÏgs
&
S–fAdjoštB™
>

338 ::
	`İ”©ÜNÜm
(
	`d”ived
());

339 
	}
}

341 #iâdeà
EIGEN_EXTERN_INSTANTIATIONS


342 
	g‹m¶©e
<
ty³Çme
 
	gR—lSÿÏr
,y³Çm
	gSÿÏr
>

343 
	$ei_ŒidŸgÚ®_qr_¡•
(
R—lSÿÏr
* 
dŸg
, R—lSÿÏr* 
subdŸg
, 
¡¬t
, 
’d
, 
SÿÏr
* 
m©rixQ
, 
n
)

345 
R—lSÿÏr
 
td
 = (
dŸg
[
’d
-1] - dŸg[’d])*
	`R—lSÿÏr
(0.5);

346 
R—lSÿÏr
 
e2
 = 
	`ei_abs2
(
subdŸg
[
’d
-1]);

347 
R—lSÿÏr
 
mu
 = 
dŸg
[
’d
] - 
e2
 / (
td
 + (td>0 ? 1 : -1è* 
	`ei_sq¹
(td*td +ƒ2));

348 
R—lSÿÏr
 
x
 = 
dŸg
[
¡¬t
] - 
mu
;

349 
R—lSÿÏr
 
z
 = 
subdŸg
[
¡¬t
];

351 
k
 = 
¡¬t
; k < 
’d
; ++k)

353 
R—lSÿÏr
 
c
, 
s
;

354 
	`ei_giv’s_rÙ©iÚ
(
x
, 
z
, 
c
, 
s
);

357 
R—lSÿÏr
 
sdk
 = 
s
 * 
dŸg
[
k
] + 
c
 * 
subdŸg
[k];

358 
R—lSÿÏr
 
dkp1
 = 
s
 * 
subdŸg
[
k
] + 
c
 * 
dŸg
[k+1];

360 
dŸg
[
k
] = 
c
 * (ø* dŸg[k] - 
s
 * 
subdŸg
[k]) - s * (c * subdiag[k] - s * diag[k+1]);

361 
dŸg
[
k
+1] = 
s
 * 
sdk
 + 
c
 * 
dkp1
;

362 
subdŸg
[
k
] = 
c
 * 
sdk
 - 
s
 * 
dkp1
;

364 ià(
k
 > 
¡¬t
)

365 
subdŸg
[
k
 - 1] = 
c
 * subdŸg[k-1] - 
s
 * 
z
;

367 
x
 = 
subdŸg
[
k
];

369 ià(
k
 < 
’d
 - 1)

371 
z
 = -
s
 * 
subdŸg
[
k
+1];

372 
subdŸg
[
k
 + 1] = 
c
 * subdiag[k+1];

377 ià(
m©rixQ
)

379 #ifdeà
EIGEN_DEFAULT_TO_ROW_MAJOR


381 
kn
 = 
k
*
n
;

382 
kn1
 = (
k
+1)*
n
;

385 
i
=0; i<
n
; ++i)

387 #ifdeà
EIGEN_DEFAULT_TO_ROW_MAJOR


388 
SÿÏr
 
m©rixQ_i_k
 = 
m©rixQ
[
i
*
n
+
k
];

389 
m©rixQ
[
i
*
n
+
k
] = 
c
 * 
m©rixQ_i_k
 - 
s
 * matrixQ[i*n+k+1];

390 
m©rixQ
[
i
*
n
+
k
+1] = 
s
 * 
m©rixQ_i_k
 + 
c
 * matrixQ[i*n+k+1];

392 
SÿÏr
 
m©rixQ_i_k
 = 
m©rixQ
[
i
+
kn
];

393 
m©rixQ
[
i
+
kn
] = 
c
 * 
m©rixQ_i_k
 - 
s
 * m©rixQ[i+
kn1
];

394 
m©rixQ
[
i
+
kn1
] = 
s
 * 
m©rixQ_i_k
 + 
c
 * matrixQ[i+kn1];

399 
	}
}

	@robot/Eigen/src/QR/Tridiagonalization.h

25 #iâdeà
EIGEN_TRIDIAGONALIZATION_H


26 
	#EIGEN_TRIDIAGONALIZATION_H


	)

42 
	g‹m¶©e
<
ty³Çme
 
	g_M©rixTy³
> cÏs 
	cTridŸgÚ®iz©iÚ


44 
	mpublic
:

46 
_M©rixTy³
 
	tM©rixTy³
;

47 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

48 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

49 
ty³Çme
 
	tei_·ck‘_Œa™s
<
	tSÿÏr
>::
	tty³
 
	tPack‘
;

52 
	mSize
 = 
M©rixTy³
::
RowsAtCompeTime
,

53 
	mSizeMšusOÃ
 = 
M©rixTy³
::
RowsAtCompeTime
==
DyÇmic


54 ? 
DyÇmic


55 : 
M©rixTy³
::
RowsAtCompeTime
-1,

56 
	mPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size


59 
	gM©rix
<
	tSÿÏr
, 
	tSizeMšusOÃ
, 1> 
	tCÛffVeùÜTy³
;

60 
	gM©rix
<
	tR—lSÿÏr
, 
	tSize
, 1> 
	tDŸgÚ®Ty³
;

61 
	gM©rix
<
	tR—lSÿÏr
, 
	tSizeMšusOÃ
, 1> 
	tSubDŸgÚ®Ty³
;

63 
ty³Çme
 
	tNe¡ByV®ue
<
	tDŸgÚ®CÛffs
<
	tM©rixTy³
> >::
	tR—lR‘uºTy³
 
	tDŸgÚ®R‘uºTy³
;

65 
ty³Çme
 
	tNe¡ByV®ue
<
	tDŸgÚ®CÛffs
<

66 
	tNe¡ByV®ue
<
	tBlock
<
	tM©rixTy³
,
	tSizeMšusOÃ
,SizeMšusOÃ> > > >::
	tR—lR‘uºTy³
 
	tSubDŸgÚ®R‘uºTy³
;

71 
TridŸgÚ®iz©iÚ
(
size
 = 
Size
==
DyÇmic
 ? 2 : Size)

72 : 
m_m©rix
(
size
,size), 
m_hCÛffs
(size-1)

75 
	$TridŸgÚ®iz©iÚ
(cÚ¡ 
M©rixTy³
& 
m©rix
)

76 : 
	`m_m©rix
(
m©rix
),

77 
	`m_hCÛffs
(
m©rix
.
	`cŞs
()-1)

79 
	`_compu‹
(
m_m©rix
, 
m_hCÛffs
);

80 
	}
}

86 
	$compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
)

88 
m_m©rix
 = 
m©rix
;

89 
m_hCÛffs
.
	`»size
(
m©rix
.
	`rows
()-1, 1);

90 
	`_compu‹
(
m_m©rix
, 
m_hCÛffs
);

91 
	}
}

98 
šlše
 
CÛffVeùÜTy³
 
	$hou£hŞd”CÛffic›Ás
(ècÚ¡ {  
m_hCÛffs
; 
	}
}

116 
šlše
 cÚ¡ 
	gM©rixTy³
& 
	$·ckedM©rix
(ècÚ¡ {  
m_m©rix
; 
	}
}

118 
M©rixTy³
 
	$m©rixQ
() const;

119 
M©rixTy³
 
	$m©rixT
() const;

120 cÚ¡ 
DŸgÚ®R‘uºTy³
 
	$dŸgÚ®
() const;

121 cÚ¡ 
SubDŸgÚ®R‘uºTy³
 
	$subDŸgÚ®
() const;

123 
	`decompo£InPÏû
(
M©rixTy³
& 
m©
, 
DŸgÚ®Ty³
& 
dŸg
, 
SubDŸgÚ®Ty³
& 
subdŸg
, 
boŞ
 
exŒaùQ
 = 
Œue
);

125 
´iv©e
:

127 
	`_compu‹
(
M©rixTy³
& 
m©A
, 
CÛffVeùÜTy³
& 
hCÛffs
);

129 
	`_decompo£InPÏû3x3
(
M©rixTy³
& 
m©
, 
DŸgÚ®Ty³
& 
dŸg
, 
SubDŸgÚ®Ty³
& 
subdŸg
, 
boŞ
 
exŒaùQ
 = 
Œue
);

131 
´Ùeùed
:

132 
M©rixTy³
 
m_m©rix
;

133 
CÛffVeùÜTy³
 
m_hCÛffs
;

134 
	}
};

137 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

138 cÚ¡ 
ty³Çme
 
	gTridŸgÚ®iz©iÚ
<
	gM©rixTy³
>::
DŸgÚ®R‘uºTy³


139 
TridŸgÚ®iz©iÚ
<
M©rixTy³
>::
	$dŸgÚ®
() const

141  
m_m©rix
.
	`dŸgÚ®
().
	`Ã¡ByV®ue
().
	`»®
();

142 
	}
}

145 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

146 cÚ¡ 
ty³Çme
 
	gTridŸgÚ®iz©iÚ
<
	gM©rixTy³
>::
SubDŸgÚ®R‘uºTy³


147 
TridŸgÚ®iz©iÚ
<
M©rixTy³
>::
	$subDŸgÚ®
() const

149 
n
 = 
m_m©rix
.
	`rows
();

150  
Block
<
M©rixTy³
,
SizeMšusOÃ
,SizeMšusOÃ>(
m_m©rix
, 1, 0, 
n
-1,n-1)

151 .
	`Ã¡ByV®ue
().
	`dŸgÚ®
().Ã¡ByV®ue().
	`»®
();

152 
	}
}

159 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

160 
ty³Çme
 
	gTridŸgÚ®iz©iÚ
<
	gM©rixTy³
>::
M©rixTy³


161 
TridŸgÚ®iz©iÚ
<
M©rixTy³
>::
	$m©rixT
() const

165 
n
 = 
m_m©rix
.
	`rows
();

166 
M©rixTy³
 
m©T
 = 
m_m©rix
;

167 
m©T
.
	`cÜÃr
(
TİRight
,
n
-1,‚-1).
	`dŸgÚ®
(èğ
	`subDŸgÚ®
().
‹m¶©e
 
ÿ¡
<
SÿÏr
>().
	`cÚjug©e
();

168 ià(
n
>2)

170 
m©T
.
	`cÜÃr
(
TİRight
,
n
-2,‚-2).
‹m¶©e
 
·¹
<
Uµ”TrŸnguÏr
>().
	`£tZ”o
();

171 
m©T
.
	`cÜÃr
(
BÙtomLeá
,
n
-2,‚-2).
‹m¶©e
 
·¹
<
Low”TrŸnguÏr
>().
	`£tZ”o
();

173  
m©T
;

174 
	}
}

176 #iâdeà
EIGEN_HIDE_HEAVY_CODE


190 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

191 
	gTridŸgÚ®iz©iÚ
<
	gM©rixTy³
>::
	$_compu‹
(
M©rixTy³
& 
m©A
, 
CÛffVeùÜTy³
& 
hCÛffs
)

193 
	`as£¹
(
m©A
.
	`rows
()==m©A.
	`cŞs
());

194 
n
 = 
m©A
.
	`rows
();

196 
i
 = 0; i<
n
-2; ++i)

202 
R—lSÿÏr
 
v1nÜm2
 = 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-(i+2)).
	`squ¬edNÜm
();

205 ià(
	`ei_isMuchSm®ËrThª
(
v1nÜm2
,
¡©ic_ÿ¡
<
SÿÏr
>(1)))

207 
hCÛffs
.
	`cÛffRef
(
i
) = 0.;

211 
SÿÏr
 
v0
 = 
m©A
.
	`cŞ
(
i
).
	`cÛff
(i+1);

212 
R—lSÿÏr
 
b‘a
 = 
	`ei_sq¹
(
	`ei_abs2
(
v0
)+
v1nÜm2
);

213 ià(
	`ei_»®
(
v0
)>=0.)

214 
b‘a
 = -beta;

215 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-(i+2)è*ğ(
	`SÿÏr
(1)/(
v0
-
b‘a
));

216 
m©A
.
	`cŞ
(
i
).
	`cÛffRef
(i+1èğ
b‘a
;

217 
SÿÏr
 
h
 = (
b‘a
 - 
v0
) / beta;

223 
m©A
.
	`cŞ
(
i
).
	`cÛffRef
(i+1) = 1;

228 #ifdeà
EIGEN_NEVER_DEFINED


230 
hCÛffs
.
	`’d
(
n
-
i
-1èğ(
m©A
.
	`cÜÃr
(
BÙtomRight
,n-i-1,n-i-1).
‹m¶©e
 
·¹
<
Low”TrŸnguÏr
|
S–fAdjošt
>()

231 * (
h
 * 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-i-1))).
	`Ïzy
();

233 
hCÛffs
.
	`’d
(
n
-
i
-1è+ğ(
h
 * 
	`SÿÏr
(-0.5è* 
m©A
.
	`cŞ
(i).’dÒ-i-1).
	`dÙ
(hCoeffs.end(n-i-1)))

234 * 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-i-1);

237 
m©A
.
	`cÜÃr
(
BÙtomRight
,
n
-
i
-1,n-i-1).
‹m¶©e
 
·¹
<
Low”TrŸnguÏr
>() -=

238 (
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-i-1è* 
hCÛffs
.’dÒ-i-1).
	`adjošt
()).
	`Ïzy
()

239 + (
hCÛffs
.
	`’d
(
n
-
i
-1è* 
m©A
.
	`cŞ
(i).’dÒ-i-1).
	`adjošt
()).
	`Ïzy
();

247 #ifdeà
EIGEN_NEVER_DEFINED


248 
n4
 = (
¡d
::
	`max
(0,
n
-4)/4)*4;

249 
hCÛffs
.
	`’d
(
n
-
i
-1).
	`£tZ”o
();

250 
b
=
i
+1; b<
n4
; b+=4)

253 
hCÛffs
.
	`’d
(
b
-4) +=

254 
Block
<
M©rixTy³
,
DyÇmic
,4>(
m©A
,
b
+4,b,
n
-b-4,4è* m©A.
‹m¶©e
 
block
<4,1>(b,
i
);

256 
Block
<
CÛffVeùÜTy³
,4,1>(
hCÛffs
, 
b
, 0, 4,1) +=

257 
Block
<
M©rixTy³
,
DyÇmic
,4>(
m©A
,
b
+4,b,
n
-b-4,4).
	`adjošt
(è* Block<M©rixTy³,DyÇmic,1>(m©A,b+4,
i
,n-b-4,1);

259 
Block
<
CÛffVeùÜTy³
,4,1>(
hCÛffs
, 
b
, 0, 4,1) +=

260 (
Block
<
M©rixTy³
,4,4>(
m©A
,
b
,b,4,4).
‹m¶©e
 
·¹
<
Low”TrŸnguÏr
|
S–fAdjošt
>()

261 * (
h
 * 
Block
<
M©rixTy³
,4,1>(
m©A
,
b
,
i
,4,1))).
	`Ïzy
();

270 #ifdeà
EIGEN_NEVER_DEFINED


271 
j1
=
i
+1; j1<
n
; ++j1)

272 
i1
=
j1
; i1<
n
; ++i1)

273 
m©A
.
	`cÛffRef
(
i1
,
j1
è-ğm©A.
	`cÛff
(i1,
i
)*
	`ei_cÚj
(
hCÛffs
.coeff(j1-1))

274 + 
hCÛffs
.
	`cÛff
(
i1
-1)*
	`ei_cÚj
(
m©A
.cÛff(
j1
,
i
));

284 
hCÛffs
.
	`’d
(
n
-
i
-1èğ(
m©A
.
	`cÜÃr
(
BÙtomRight
,n-i-1,n-i-1è* (
h
 * m©A.
	`cŞ
(i).’dÒ-i-1))).
	`Ïzy
();

287 
hCÛffs
.
	`’d
(
n
-
i
-1è+ğ(
h
 * 
	`SÿÏr
(-0.5è* 
m©A
.
	`cŞ
(i).’dÒ-i-1).
	`dÙ
(hCoeffs.end(n-i-1)))

288 * 
m©A
.
	`cŞ
(
i
).
	`’d
(
n
-i-1);

290 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
pb
 = &
m©A
.
	`cÛffRef
(0,
i
);

291 cÚ¡ 
SÿÏr
* 
EIGEN_RESTRICT
 
·
 = (&
hCÛffs
.
	`cÛffRef
(0)) - 1;

292 
j1
=
i
+1; j1<
n
; ++j1)

294 
¡¬ti
 = 
i
+1;

295 
®igÃdEnd
 = 
¡¬ti
;

296 ià(
Pack‘Size
>1 && ((
M©rixTy³
::
FÏgs
)&
RowMajÜ
) == 0)

298 
®igÃdS¹
 = (
¡¬ti
è+ 
	`ei_®ignm’tOff£t
(&
m©A
.
	`cÛffRef
(¡¬ti,
j1
), 
n
-starti);

299 
®igÃdEnd
 = 
®igÃdS¹
 + ((
n
-®igÃdS¹)/
Pack‘Size
)*PacketSize;

301 
i1
=
¡¬ti
; i1<
®igÃdS¹
; ++i1)

302 
m©A
.
	`cÛffRef
(
i1
,
j1
è-ğm©A.
	`cÛff
(i1,
i
)*
	`ei_cÚj
(
hCÛffs
.coeff(j1-1))

303 + 
hCÛffs
.
	`cÛff
(
i1
-1)*
	`ei_cÚj
(
m©A
.cÛff(
j1
,
i
));

305 
Pack‘
 
tmp0
 = 
	`ei_p£t1
(
hCÛffs
.
	`cÛff
(
j1
-1));

306 
Pack‘
 
tmp1
 = 
	`ei_p£t1
(
m©A
.
	`cÛff
(
j1
,
i
));

307 
SÿÏr
* 
pc
 = &
m©A
.
	`cÛffRef
(0,
j1
);

308 
i1
=
®igÃdS¹
 ; i1<
®igÃdEnd
; i1+=
Pack‘Size
)

309 
	`ei_p¡Üe
(
pc
+
i1
,
	`ei_psub
(
	`ei_¶ßd
(pc+i1),

310 
	`ei_·dd
(
	`ei_pmul
(
tmp0
, 
	`ei_¶ßdu
(
pb
+
i1
)),

311 
	`ei_pmul
(
tmp1
, 
	`ei_¶ßdu
(
·
+
i1
)))));

313 
i1
=
®igÃdEnd
; i1<
n
; ++i1)

314 
m©A
.
	`cÛffRef
(
i1
,
j1
è-ğm©A.
	`cÛff
(i1,
i
)*
	`ei_cÚj
(
hCÛffs
.coeff(j1-1))

315 + 
hCÛffs
.
	`cÛff
(
i1
-1)*
	`ei_cÚj
(
m©A
.cÛff(
j1
,
i
));

321 
m©A
.
	`cŞ
(
i
).
	`cÛffRef
(i+1èğ
b‘a
;

323 
hCÛffs
.
	`cÛffRef
(
i
èğ
h
;

326 ià(
NumT¿™s
<
SÿÏr
>::
IsCom¶ex
)

329 
i
 = 
n
-2;

330 
SÿÏr
 
v0
 = 
m©A
.
	`cŞ
(
i
).
	`cÛff
(i+1);

331 
R—lSÿÏr
 
b‘a
 = 
	`ei_abs
(
v0
);

332 ià(
	`ei_»®
(
v0
)>=0.)

333 
b‘a
 = -beta;

334 
m©A
.
	`cŞ
(
i
).
	`cÛffRef
(i+1èğ
b‘a
;

335 if(
	`ei_isMuchSm®ËrThª
(
b‘a
, 
	`SÿÏr
(1))è
hCÛffs
.
	`cÛffRef
(
i
) = Scalar(0);

336 
hCÛffs
.
	`cÛffRef
(
i
èğ(
b‘a
 - 
v0
) / beta;

340 
hCÛffs
.
	`cÛffRef
(
n
-2) = 0;

342 
	}
}

345 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

346 
ty³Çme
 
	gTridŸgÚ®iz©iÚ
<
	gM©rixTy³
>::
M©rixTy³


347 
TridŸgÚ®iz©iÚ
<
M©rixTy³
>::
	$m©rixQ
() const

349 
n
 = 
m_m©rix
.
	`rows
();

350 
M©rixTy³
 
m©Q
 = M©rixTy³::
	`Id’t™y
(
n
,n);

351 
i
 = 
n
-2; i>=0; i--)

353 
SÿÏr
 
tmp
 = 
m_m©rix
.
	`cÛff
(
i
+1,i);

354 
m_m©rix
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(
i
+1,i) = 1;

356 
m©Q
.
	`cÜÃr
(
BÙtomRight
,
n
-
i
-1,n-i-1) -=

357 ((
m_hCÛffs
.
	`cÛff
(
i
è* 
m_m©rix
.
	`cŞ
(i).
	`’d
(
n
-i-1)) *

358 (
m_m©rix
.
	`cŞ
(
i
).
	`’d
(
n
-i-1).
	`adjošt
(è* 
m©Q
.
	`cÜÃr
(
BÙtomRight
,n-i-1,n-i-1)).
	`Ïzy
()).lazy();

360 
m_m©rix
.
	`cÚ¡_ÿ¡_d”ived
().
	`cÛffRef
(
i
+1,ièğ
tmp
;

362  
m©Q
;

363 
	}
}

366 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

367 
	gTridŸgÚ®iz©iÚ
<
	gM©rixTy³
>::
	$decompo£InPÏû
(
M©rixTy³
& 
m©
, 
DŸgÚ®Ty³
& 
dŸg
, 
SubDŸgÚ®Ty³
& 
subdŸg
, 
boŞ
 
exŒaùQ
)

369 
n
 = 
m©
.
	`rows
();

370 
	`ei_as£¹
(
m©
.
	`cŞs
()==
n
 && 
dŸg
.
	`size
()=ò && 
subdŸg
.size()==n-1);

371 ià(
n
==3 && (!
NumT¿™s
<
SÿÏr
>::
IsCom¶ex
) )

373 
	`_decompo£InPÏû3x3
(
m©
, 
dŸg
, 
subdŸg
, 
exŒaùQ
);

377 
TridŸgÚ®iz©iÚ
 
	`ŒidŸg
(
m©
);

378 
dŸg
 = 
ŒidŸg
.
	`dŸgÚ®
();

379 
subdŸg
 = 
ŒidŸg
.
	`subDŸgÚ®
();

380 ià(
exŒaùQ
)

381 
m©
 = 
ŒidŸg
.
	`m©rixQ
();

383 
	}
}

389 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

390 
	gTridŸgÚ®iz©iÚ
<
	gM©rixTy³
>::
	$_decompo£InPÏû3x3
(
M©rixTy³
& 
m©
, 
DŸgÚ®Ty³
& 
dŸg
, 
SubDŸgÚ®Ty³
& 
subdŸg
, 
boŞ
 
exŒaùQ
)

392 
dŸg
[0] = 
	`ei_»®
(
	`m©
(0,0));

393 
R—lSÿÏr
 
v1nÜm2
 = 
	`ei_abs2
(
	`m©
(0,2));

394 ià(
	`ei_isMuchSm®ËrThª
(
v1nÜm2
, 
	`R—lSÿÏr
(1)))

396 
dŸg
[1] = 
	`ei_»®
(
	`m©
(1,1));

397 
dŸg
[2] = 
	`ei_»®
(
	`m©
(2,2));

398 
subdŸg
[0] = 
	`ei_»®
(
	`m©
(0,1));

399 
subdŸg
[1] = 
	`ei_»®
(
	`m©
(1,2));

400 ià(
exŒaùQ
)

401 
m©
.
	`£tId’t™y
();

405 
R—lSÿÏr
 
b‘a
 = 
	`ei_sq¹
(
	`ei_abs2
(
	`m©
(0,1))+
v1nÜm2
);

406 
R—lSÿÏr
 
švB‘a
 = 
	`R—lSÿÏr
(1)/
b‘a
;

407 
SÿÏr
 
m01
 = 
	`m©
(0,1è* 
švB‘a
;

408 
SÿÏr
 
m02
 = 
	`m©
(0,2è* 
švB‘a
;

409 
SÿÏr
 
q
 = 
	`R—lSÿÏr
(2)*
m01
*
	`m©
(1,2è+ 
m02
*(mat(2,2) - mat(1,1));

410 
dŸg
[1] = 
	`ei_»®
(
	`m©
(1,1è+ 
m02
*
q
);

411 
dŸg
[2] = 
	`ei_»®
(
	`m©
(2,2è- 
m02
*
q
);

412 
subdŸg
[0] = 
b‘a
;

413 
subdŸg
[1] = 
	`ei_»®
(
	`m©
(1,2è- 
m01
 * 
q
);

414 ià(
exŒaùQ
)

416 
	`m©
(0,0) = 1;

417 
	`m©
(0,1) = 0;

418 
	`m©
(0,2) = 0;

419 
	`m©
(1,0) = 0;

420 
	`m©
(1,1èğ
m01
;

421 
	`m©
(1,2èğ
m02
;

422 
	`m©
(2,0) = 0;

423 
	`m©
(2,1èğ
m02
;

424 
	`m©
(2,2èğ-
m01
;

427 
	}
}

	@robot/Eigen/src/SVD/SVD.h

25 #iâdeà
EIGEN_SVD_H


26 
	#EIGEN_SVD_H


	)

43 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> cÏs 
	cSVD


45 
	m´iv©e
:

46 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

47 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

50 
	mPack‘Size
 = 
ei_·ck‘_Œa™s
<
SÿÏr
>::
size
,

51 
	mAlignm’tMask
 = (
Pack‘Size
)-1,

52 
	mMšSize
 = 
EIGEN_SIZE_MIN
(
M©rixTy³
::
RowsAtCompeTime
, M©rixTy³::
CŞsAtCompeTime
)

55 
	gM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tRowsAtCompeTime
, 1> 
	tCŞVeùÜ
;

56 
	gM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, 1> 
	tRowVeùÜ
;

58 
	gM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tRowsAtCompeTime
, 
	tMšSize
> 
	tM©rixUTy³
;

59 
	gM©rix
<
	tSÿÏr
, 
	tM©rixTy³
::
	tCŞsAtCompeTime
, M©rixTy³::CŞsAtCompeTime> 
	tM©rixVTy³
;

60 
	gM©rix
<
	tSÿÏr
, 
	tMšSize
, 1> 
	tSšguÏrV®uesTy³
;

62 
	gpublic
:

64 
	$SVD
(è{
	}
}

66 
	$SVD
(cÚ¡ 
M©rixTy³
& 
m©rix
)

67 : 
	`m_m©U
(
m©rix
.
	`rows
(), 
¡d
::
	`mš
(m©rix.rows(), m©rix.
	`cŞs
())),

68 
	`m_m©V
(
m©rix
.
	`cŞs
(),matrix.cols()),

69 
	`m_sigma
(
¡d
::
	`mš
(
m©rix
.
	`rows
(),m©rix.
	$cŞs
()))

71 
	`compu‹
(
m©rix
);

72 
	}
}

74 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
,y³Çm
	gResuÉTy³
>

75 
boŞ
 
sŞve
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
b
, 
ResuÉTy³
* 
»suÉ
) const;

77 cÚ¡ 
	gM©rixUTy³
& 
	$m©rixU
(ècÚ¡ {  
m_m©U
; 
	}
}

78 cÚ¡ 
	gSšguÏrV®uesTy³
& 
	$sšguÏrV®ues
(ècÚ¡ {  
m_sigma
; 
	}
}

79 cÚ¡ 
	gM©rixVTy³
& 
	$m©rixV
(ècÚ¡ {  
m_m©V
; 
	}
}

81 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

82 
	gSVD
& 
sÜt
();

84 
	g‹m¶©e
<
ty³Çme
 
	gUn™¬yTy³
,y³Çm
	gPos™iveTy³
>

85 
	$compu‹Un™¬yPos™ive
(
Un™¬yTy³
 *
un™¬y
, 
Pos™iveTy³
 *
pos™ive
) const;

86 
‹m¶©e
<
ty³Çme
 
Pos™iveTy³
,y³Çm
Un™¬yTy³
>

87 
	$compu‹Pos™iveUn™¬y
(
Pos™iveTy³
 *
pos™ive
, 
Un™¬yTy³
 *
un™¬y
) const;

88 
‹m¶©e
<
ty³Çme
 
RÙ©iÚTy³
,y³Çm
SÿlšgTy³
>

89 
	$compu‹RÙ©iÚSÿlšg
(
RÙ©iÚTy³
 *
un™¬y
, 
SÿlšgTy³
 *
pos™ive
) const;

90 
‹m¶©e
<
ty³Çme
 
SÿlšgTy³
,y³Çm
RÙ©iÚTy³
>

91 
	$compu‹SÿlšgRÙ©iÚ
(
SÿlšgTy³
 *
pos™ive
, 
RÙ©iÚTy³
 *
un™¬y
) const;

93 
´Ùeùed
:

95 
M©rixUTy³
 
m_m©U
;

97 
M©rixVTy³
 
m_m©V
;

99 
SšguÏrV®uesTy³
 
m_sigma
;

100 
	}
};

106 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

107 
	gSVD
<
	gM©rixTy³
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
)

109 cÚ¡ 
m
 = 
m©rix
.
	`rows
();

110 cÚ¡ 
n
 = 
m©rix
.
	`cŞs
();

111 cÚ¡ 
nu
 = 
¡d
::
	`mš
(
m
,
n
);

112 
	`ei_as£¹
(
m
>=
n
 && "In Eigen 2.0, SVD only works for MxN matrices with M>=N. Sorry!");

113 
	`ei_as£¹
(
m
>1 && "In Eigen 2.0, SVD doesn't work on 1x1 matrices");

115 
m_m©U
.
	`»size
(
m
, 
nu
);

116 
m_m©U
.
	`£tZ”o
();

117 
m_sigma
.
	`»size
(
¡d
::
	`mš
(
m
,
n
));

118 
m_m©V
.
	`»size
(
n
,n);

120 
RowVeùÜ
 
	`e
(
n
);

121 
CŞVeùÜ
 
	`wÜk
(
m
);

122 
M©rixTy³
 
	`m©A
(
m©rix
);

123 cÚ¡ 
boŞ
 
wªtu
 = 
Œue
;

124 cÚ¡ 
boŞ
 
wªtv
 = 
Œue
;

125 
i
=0, 
j
=0, 
k
=0;

129 
nù
 = 
¡d
::
	`mš
(
m
-1,
n
);

130 
Ät
 = 
¡d
::
	`max
(0,¡d::
	`mš
(
n
-2,
m
));

131 
k
 = 0; k < 
¡d
::
	`max
(
nù
,
Ät
); ++k)

133 ià(
k
 < 
nù
)

137 
m_sigma
[
k
] = 
m©A
.
	`cŞ
(k).
	`’d
(
m
-k).
	`nÜm
();

138 ià(
m_sigma
[
k
] != 0.0)

140 ià(
	`m©A
(
k
,k) < 0.0)

141 
m_sigma
[
k
] = -m_sigma[k];

142 
m©A
.
	`cŞ
(
k
).
	`’d
(
m
-kè/ğ
m_sigma
[k];

143 
	`m©A
(
k
,k) += 1.0;

145 
m_sigma
[
k
] = -m_sigma[k];

148 
j
 = 
k
+1; j < 
n
; ++j)

150 ià((
k
 < 
nù
è&& (
m_sigma
[k] != 0.0))

153 
SÿÏr
 
t
 = 
m©A
.
	`cŞ
(
k
).
	`’d
(
m
-k).
	`dÙ
(m©A.cŞ(
j
).end(m-k));

154 
t
 = -t/
	`m©A
(
k
,k);

155 
m©A
.
	`cŞ
(
j
).
	`’d
(
m
-
k
è+ğ
t
 * matA.col(k).end(m-k);

160 
e
[
j
] = 
	`m©A
(
k
,j);

164 ià(
wªtu
 & (
k
 < 
nù
))

165 
m_m©U
.
	`cŞ
(
k
).
	`’d
(
m
-kèğ
m©A
.col(k).end(m-k);

167 ià(
k
 < 
Ät
)

171 
e
[
k
] =ƒ.
	`’d
(
n
-k-1).
	`nÜm
();

172 ià(
e
[
k
] != 0.0)

174 ià(
e
[
k
+1] < 0.0)

175 
e
[
k
] = -e[k];

176 
e
.
	`’d
(
n
-
k
-1) /=ƒ[k];

177 
e
[
k
+1] += 1.0;

179 
e
[
k
] = -e[k];

180 ià((
k
+1 < 
m
è& (
e
[k] != 0.0))

183 
wÜk
.
	`’d
(
m
-
k
-1èğ
m©A
.
	`cÜÃr
(
BÙtomRight
,m-k-1,
n
-k-1è* 
e
.end(n-k-1);

184 
j
 = 
k
+1; j < 
n
; ++j)

185 
m©A
.
	`cŞ
(
j
).
	`’d
(
m
-
k
-1è+ğ(-
e
[j]/e[k+1]è* 
wÜk
.end(m-k-1);

189 ià(
wªtv
)

190 
m_m©V
.
	`cŞ
(
k
).
	`’d
(
n
-k-1èğ
e
.end(n-k-1);

196 
p
 = 
¡d
::
	`mš
(
n
,
m
+1);

197 ià(
nù
 < 
n
)

198 
m_sigma
[
nù
] = 
	`m©A
(nct,nct);

199 ià(
m
 < 
p
)

200 
m_sigma
[
p
-1] = 0.0;

201 ià(
Ät
+1 < 
p
)

202 
e
[
Ät
] = 
	`m©A
Ò¹,
p
-1);

203 
e
[
p
-1] = 0.0;

206 ià(
wªtu
)

208 
j
 = 
nù
; j < 
nu
; ++j)

210 
m_m©U
.
	`cŞ
(
j
).
	`£tZ”o
();

211 
	`m_m©U
(
j
,j) = 1.0;

213 
k
 = 
nù
-1; k >= 0; k--)

215 ià(
m_sigma
[
k
] != 0.0)

217 
j
 = 
k
+1; j < 
nu
; ++j)

219 
SÿÏr
 
t
 = 
m_m©U
.
	`cŞ
(
k
).
	`’d
(
m
-k).
	`dÙ
(m_m©U.cŞ(
j
).end(m-k));

220 
t
 = -t/
	`m_m©U
(
k
,k);

221 
m_m©U
.
	`cŞ
(
j
).
	`’d
(
m
-
k
è+ğ
t
 * m_matU.col(k).end(m-k);

223 
m_m©U
.
	`cŞ
(
k
).
	`’d
(
m
-k) = - m_matU.col(k).end(m-k);

224 
	`m_m©U
(
k
,kèğ
	`SÿÏr
(1) + m_matU(k,k);

225 ià(
k
-1>0)

226 
m_m©U
.
	`cŞ
(
k
).
	`¡¬t
(k-1).
	`£tZ”o
();

230 
m_m©U
.
	`cŞ
(
k
).
	`£tZ”o
();

231 
	`m_m©U
(
k
,k) = 1.0;

237 ià(
wªtv
)

239 
k
 = 
n
-1; k >= 0; k--)

241 ià((
k
 < 
Ät
è& (
e
[k] != 0.0))

243 
j
 = 
k
+1; j < 
nu
; ++j)

245 
SÿÏr
 
t
 = 
m_m©V
.
	`cŞ
(
k
).
	`’d
(
n
-k-1).
	`dÙ
(m_m©V.cŞ(
j
).end(n-k-1));

246 
t
 = -t/
	`m_m©V
(
k
+1,k);

247 
m_m©V
.
	`cŞ
(
j
).
	`’d
(
n
-
k
-1è+ğ
t
 * m_matV.col(k).end(n-k-1);

250 
m_m©V
.
	`cŞ
(
k
).
	`£tZ”o
();

251 
	`m_m©V
(
k
,k) = 1.0;

256 
µ
 = 
p
-1;

257 
™”
 = 0;

258 
SÿÏr
 
•s
 = 
	`ei_pow
(
	`SÿÏr
(2),
ei_is_§me_ty³
<SÿÏr,>::
»t
 ? Scalar(-23) : Scalar(-52));

259 
p
 > 0)

261 
k
=0;

262 
ka£
=0;

276 
k
 = 
p
-2; k >= -1; --k)

278 ià(
k
 == -1)

280 ià(
	`ei_abs
(
e
[
k
]è<ğ
•s
*Ói_abs(
m_sigma
[k]) +ƒi_abs(m_sigma[k+1])))

282 
e
[
k
] = 0.0;

286 ià(
k
 =ğ
p
-2)

288 
ka£
 = 4;

292 
ks
;

293 
ks
 = 
p
-1; k >ğ
k
; --ks)

295 ià(
ks
 =ğ
k
)

297 
SÿÏr
 
t
 = (
ks
 !ğ
p
 ? 
	`ei_abs
(
e
[ks]è: 
	`SÿÏr
(0)è+ (k !ğ
k
+1 ?ƒi_abs(e[ks-1]) : Scalar(0));

298 ià(
	`ei_abs
(
m_sigma
[
ks
]è<ğ
•s
*
t
)

300 
m_sigma
[
ks
] = 0.0;

304 ià(
ks
 =ğ
k
)

306 
ka£
 = 3;

308 ià(
ks
 =ğ
p
-1)

310 
ka£
 = 1;

314 
ka£
 = 2;

315 
k
 = 
ks
;

318 ++
k
;

321 
ka£
)

327 
SÿÏr
 
	`f
(
e
[
p
-2]);

328 
e
[
p
-2] = 0.0;

329 
j
 = 
p
-2; j >ğ
k
; --j)

331 
SÿÏr
 
	`t
(
	`ei_hypÙ
(
m_sigma
[
j
],
f
));

332 
SÿÏr
 
	`cs
(
m_sigma
[
j
]/
t
);

333 
SÿÏr
 
	`¢
(
f
/
t
);

334 
m_sigma
[
j
] = 
t
;

335 ià(
j
 !ğ
k
)

337 
f
 = -
¢
*
e
[
j
-1];

338 
e
[
j
-1] = 
cs
*e[j-1];

340 ià(
wªtv
)

342 
i
 = 0; i < 
n
; ++i)

344 
t
 = 
cs
*
	`m_m©V
(
i
,
j
è+ 
¢
*m_m©V(i,
p
-1);

345 
	`m_m©V
(
i
,
p
-1èğ-
¢
*m_m©V(i,
j
è+ 
cs
*m_matV(i,p-1);

346 
	`m_m©V
(
i
,
j
èğ
t
;

356 
SÿÏr
 
	`f
(
e
[
k
-1]);

357 
e
[
k
-1] = 0.0;

358 
j
 = 
k
; j < 
p
; ++j)

360 
SÿÏr
 
	`t
(
	`ei_hypÙ
(
m_sigma
[
j
],
f
));

361 
SÿÏr
 
	`cs
Ğ
m_sigma
[
j
]/
t
);

362 
SÿÏr
 
	`¢
(
f
/
t
);

363 
m_sigma
[
j
] = 
t
;

364 
f
 = -
¢
*
e
[
j
];

365 
e
[
j
] = 
cs
*e[j];

366 ià(
wªtu
)

368 
i
 = 0; i < 
m
; ++i)

370 
t
 = 
cs
*
	`m_m©U
(
i
,
j
è+ 
¢
*m_m©U(i,
k
-1);

371 
	`m_m©U
(
i
,
k
-1èğ-
¢
*m_m©U(i,
j
è+ 
cs
*m_matU(i,k-1);

372 
	`m_m©U
(
i
,
j
èğ
t
;

383 
SÿÏr
 
sÿË
 = 
¡d
::
	`max
(std::max(std::max(std::max(

384 
	`ei_abs
(
m_sigma
[
p
-1]),ei_abs(m_sigma[p-2])),ei_abs(
e
[p-2])),

385 
	`ei_abs
(
m_sigma
[
k
])),ei_abs(
e
[k]));

386 
SÿÏr
 
¥
 = 
m_sigma
[
p
-1]/
sÿË
;

387 
SÿÏr
 
¥m1
 = 
m_sigma
[
p
-2]/
sÿË
;

388 
SÿÏr
 
•m1
 = 
e
[
p
-2]/
sÿË
;

389 
SÿÏr
 
sk
 = 
m_sigma
[
k
]/
sÿË
;

390 
SÿÏr
 
ek
 = 
e
[
k
]/
sÿË
;

391 
SÿÏr
 
b
 = ((
¥m1
 + 
¥
)*(¥m1 - spè+ 
•m1
*•m1)/
	`SÿÏr
(2);

392 
SÿÏr
 
c
 = (
¥
*
•m1
)*(sp*epm1);

393 
SÿÏr
 
shiá
 = 0.0;

394 ià((
b
 !ğ0.0è|| (
c
 != 0.0))

396 
shiá
 = 
	`ei_sq¹
(
b
*b + 
c
);

397 ià(
b
 < 0.0)

398 
shiá
 = -shift;

399 
shiá
 = 
c
/(
b
 + shift);

401 
SÿÏr
 
f
 = (
sk
 + 
¥
)*(sk - spè+ 
shiá
;

402 
SÿÏr
 
g
 = 
sk
*
ek
;

406 
j
 = 
k
; j < 
p
-1; ++j)

408 
SÿÏr
 
t
 = 
	`ei_hypÙ
(
f
,
g
);

409 
SÿÏr
 
cs
 = 
f
/
t
;

410 
SÿÏr
 
¢
 = 
g
/
t
;

411 ià(
j
 !ğ
k
)

412 
e
[
j
-1] = 
t
;

413 
f
 = 
cs
*
m_sigma
[
j
] + 
¢
*
e
[j];

414 
e
[
j
] = 
cs
*e[j] - 
¢
*
m_sigma
[j];

415 
g
 = 
¢
*
m_sigma
[
j
+1];

416 
m_sigma
[
j
+1] = 
cs
*m_sigma[j+1];

417 ià(
wªtv
)

419 
i
 = 0; i < 
n
; ++i)

421 
t
 = 
cs
*
	`m_m©V
(
i
,
j
è+ 
¢
*m_matV(i,j+1);

422 
	`m_m©V
(
i
,
j
+1èğ-
¢
*m_m©V(i,jè+ 
cs
*m_matV(i,j+1);

423 
	`m_m©V
(
i
,
j
èğ
t
;

426 
t
 = 
	`ei_hypÙ
(
f
,
g
);

427 
cs
 = 
f
/
t
;

428 
¢
 = 
g
/
t
;

429 
m_sigma
[
j
] = 
t
;

430 
f
 = 
cs
*
e
[
j
] + 
¢
*
m_sigma
[j+1];

431 
m_sigma
[
j
+1] = -
¢
*
e
[j] + 
cs
*m_sigma[j+1];

432 
g
 = 
¢
*
e
[
j
+1];

433 
e
[
j
+1] = 
cs
*e[j+1];

434 ià(
wªtu
 && (
j
 < 
m
-1))

436 
i
 = 0; i < 
m
; ++i)

438 
t
 = 
cs
*
	`m_m©U
(
i
,
j
è+ 
¢
*m_matU(i,j+1);

439 
	`m_m©U
(
i
,
j
+1èğ-
¢
*m_m©U(i,jè+ 
cs
*m_matU(i,j+1);

440 
	`m_m©U
(
i
,
j
èğ
t
;

444 
e
[
p
-2] = 
f
;

445 
™”
 = iter + 1;

453 ià(
m_sigma
[
k
] <= 0.0)

455 
m_sigma
[
k
] = m_sigma[k] < 
	`SÿÏr
(0) ? -m_sigma[k] : Scalar(0);

456 ià(
wªtv
)

457 
m_m©V
.
	`cŞ
(
k
).
	`¡¬t
(
µ
+1) = -m_matV.col(k).start(pp+1);

461 
k
 < 
µ
)

463 ià(
m_sigma
[
k
] >= m_sigma[k+1])

465 
SÿÏr
 
t
 = 
m_sigma
[
k
];

466 
m_sigma
[
k
] = m_sigma[k+1];

467 
m_sigma
[
k
+1] = 
t
;

468 ià(
wªtv
 && (
k
 < 
n
-1))

469 
m_m©V
.
	`cŞ
(
k
).
	`sw­
(m_matV.col(k+1));

470 ià(
wªtu
 && (
k
 < 
m
-1))

471 
m_m©U
.
	`cŞ
(
k
).
	`sw­
(m_matU.col(k+1));

472 ++
k
;

474 
™”
 = 0;

475 
p
--;

480 
	}
}

482 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

483 
	gSVD
<
	gM©rixTy³
>& SVD<M©rixTy³>::
	$sÜt
()

485 
mu
 = 
m_m©U
.
	`rows
();

486 
mv
 = 
m_m©V
.
	`rows
();

487 
n
 = 
m_m©U
.
	`cŞs
();

489 
i
=0; i<
n
; ++i)

491 
k
 = 
i
;

492 
SÿÏr
 
p
 = 
m_sigma
.
	`cÛff
(
i
);

494 
j
=
i
+1; j<
n
; ++j)

496 ià(
m_sigma
.
	`cÛff
(
j
è> 
p
)

498 
k
 = 
j
;

499 
p
 = 
m_sigma
.
	`cÛff
(
j
);

502 ià(
k
 !ğ
i
)

504 
m_sigma
.
	`cÛffRef
(
k
èğm_sigma.
	`cÛff
(
i
);

505 
m_sigma
.
	`cÛffRef
(
i
èğ
p
;

507 
j
 = 
mu
;

508 
s
=0; 
j
!=0; ++s, --j)

509 
¡d
::
	`sw­
(
m_m©U
.
	`cÛffRef
(
s
,
i
), m_m©U.cÛffRef(s,
k
));

511 
j
 = 
mv
;

512 
s
=0; 
j
!=0; ++s, --j)

513 
¡d
::
	`sw­
(
m_m©V
.
	`cÛffRef
(
s
,
i
), m_m©V.cÛffRef(s,
k
));

516  *
this
;

517 
	}
}

524 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

525 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
,y³Çm
	gResuÉTy³
>

526 
boŞ
 
	gSVD
<
	gM©rixTy³
>::
sŞve
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
b
, 
ResuÉTy³
* 
»suÉ
) const

529 
ei_as£¹
(
b
.
rows
() ==„ows);

531 
SÿÏr
 
	gmaxV®
 = 
m_sigma
.
cwi£
().
abs
().
maxCÛff
();

532 
	gj
=0; j<
	gb
.
cŞs
(); ++j)

534 
	gM©rix
<
	gSÿÏr
,
	gM©rixUTy³
::
RowsAtCompeTime
,1> 
	gaux
 = 
m_m©U
.
Œª¥o£
(è* 
b
.
cŞ
(
j
);

536 
	gi
 = 0; i <
	gm_m©U
.
cŞs
(); ++i)

538 
SÿÏr
 
	gsi
 = 
m_sigma
.
cÛff
(
i
);

539 ià(
ei_isMuchSm®ËrThª
(
ei_abs
(
si
),
maxV®
))

540 
	gaux
.
cÛffRef
(
i
) = 0;

542 
	gaux
.
cÛffRef
(
i
è/ğ
si
;

545 
	g»suÉ
->
cŞ
(
j
èğ
m_m©V
 * 
aux
;

547  
	gŒue
;

558 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

559 
	g‹m¶©e
<
ty³Çme
 
	gUn™¬yTy³
,y³Çm
	gPos™iveTy³
>

560 
	gSVD
<
	gM©rixTy³
>::
	$compu‹Un™¬yPos™ive
(
Un™¬yTy³
 *
un™¬y
,

561 
Pos™iveTy³
 *
pos™ive
) const

563 
	`ei_as£¹
(
m_m©U
.
	`cŞs
(è=ğ
m_m©V
.cols() && "Polar decomposition is only for square matrices");

564 if(
un™¬y
è*un™¬y = 
m_m©U
 * 
m_m©V
.
	`adjošt
();

565 if(
pos™ive
è*pos™ivğ
m_m©V
 * 
m_sigma
.
	`asDŸgÚ®
(è* m_m©V.
	`adjošt
();

566 
	}
}

576 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

577 
	g‹m¶©e
<
ty³Çme
 
	gUn™¬yTy³
,y³Çm
	gPos™iveTy³
>

578 
	gSVD
<
	gM©rixTy³
>::
	$compu‹Pos™iveUn™¬y
(
Un™¬yTy³
 *
pos™ive
,

579 
Pos™iveTy³
 *
un™¬y
) const

581 
	`ei_as£¹
(
m_m©U
.
	`rows
(è=ğ
m_m©V
.rows() && "Polar decomposition is only for square matrices");

582 if(
un™¬y
è*un™¬y = 
m_m©U
 * 
m_m©V
.
	`adjošt
();

583 if(
pos™ive
è*pos™ivğ
m_m©U
 * 
m_sigma
.
	`asDŸgÚ®
(è* m_m©U.
	`adjošt
();

584 
	}
}

595 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

596 
	g‹m¶©e
<
ty³Çme
 
	gRÙ©iÚTy³
,y³Çm
	gSÿlšgTy³
>

597 
	gSVD
<
	gM©rixTy³
>::
	$compu‹RÙ©iÚSÿlšg
(
RÙ©iÚTy³
 *
rÙ©iÚ
, 
SÿlšgTy³
 *
sÿlšg
) const

599 
	`ei_as£¹
(
m_m©U
.
	`rows
(è=ğ
m_m©V
.rows() && "Polar decomposition is only for square matrices");

600 
SÿÏr
 
x
 = (
m_m©U
 * 
m_m©V
.
	`adjošt
()).
	`d‘”mšªt
();

601 
M©rix
<
SÿÏr
, 
M©rixTy³
::
RowsAtCompeTime
, 1> 
	`sv
(
m_sigma
);

602 
sv
.
	`cÛffRef
(0è*ğ
x
;

603 if(
sÿlšg
èsÿlšg->
	`ÏzyAssign
(
m_m©V
 * 
sv
.
	`asDŸgÚ®
(è* m_m©V.
	`adjošt
());

604 if(
rÙ©iÚ
)

606 
M©rixTy³
 
	`m
(
m_m©U
);

607 
m
.
	`cŞ
(0è/ğ
x
;

608 
rÙ©iÚ
->
	`ÏzyAssign
(
m
 * 
m_m©V
.
	`adjošt
());

610 
	}
}

621 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

622 
	g‹m¶©e
<
ty³Çme
 
	gSÿlšgTy³
,y³Çm
	gRÙ©iÚTy³
>

623 
	gSVD
<
	gM©rixTy³
>::
	$compu‹SÿlšgRÙ©iÚ
(
SÿlšgTy³
 *
sÿlšg
, 
RÙ©iÚTy³
 *
rÙ©iÚ
) const

625 
	`ei_as£¹
(
m_m©U
.
	`rows
(è=ğ
m_m©V
.rows() && "Polar decomposition is only for square matrices");

626 
SÿÏr
 
x
 = (
m_m©U
 * 
m_m©V
.
	`adjošt
()).
	`d‘”mšªt
();

627 
M©rix
<
SÿÏr
, 
M©rixTy³
::
RowsAtCompeTime
, 1> 
	`sv
(
m_sigma
);

628 
sv
.
	`cÛffRef
(0è*ğ
x
;

629 if(
sÿlšg
èsÿlšg->
	`ÏzyAssign
(
m_m©U
 * 
sv
.
	`asDŸgÚ®
(è* m_m©U.
	`adjošt
());

630 if(
rÙ©iÚ
)

632 
M©rixTy³
 
	`m
(
m_m©U
);

633 
m
.
	`cŞ
(0è/ğ
x
;

634 
rÙ©iÚ
->
	`ÏzyAssign
(
m
 * 
m_m©V
.
	`adjošt
());

636 
	}
}

642 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

643 
šlše
 
	gSVD
<
ty³Çme
 
	gM©rixBa£
<
	gD”ived
>::
PÏšM©rixTy³
>

644 
M©rixBa£
<
D”ived
>::
	$svd
() const

646  
SVD
<
PÏšM©rixTy³
>(
	`d”ived
());

647 
	}
}

	@robot/Eigen/src/Sparse/AmbiVector.h

25 #iâdeà
EIGEN_AMBIVECTOR_H


26 
	#EIGEN_AMBIVECTOR_H


	)

33 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
> cÏs 
	cAmbiVeùÜ


35 
	mpublic
:

36 
_SÿÏr
 
	tSÿÏr
;

37 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

38 
	$AmbiVeùÜ
(
size
)

39 : 
	`m_bufãr
(0), 
	`m_size
(0), 
	`m_®loÿ‹dSize
(0), 
	`m_®loÿ‹dEËm’ts
(0), 
	`m_mode
(-1)

41 
	`»size
(
size
);

44 
	`š™
(
R—lSÿÏr
 
e¡im©edD’s™y
);

45 
	`š™
(
mode
);

47 
	$nÚZ”os
() const;

50 
	$£tBounds
(
¡¬t
, 
’d
è{ 
m_¡¬t
 = s¹; 
m_’d
 =ƒnd; 
	}
}

52 
£tZ”o
();

54 
»¡¬t
();

55 
	gSÿÏr
& 
cÛffRef
(
i
);

56 
SÿÏr
 
cÛff
(
i
);

58 
şass
 
	gI‹¿tÜ
;

60 ~
	$AmbiVeùÜ
(è{ 
d–‘e
[] 
m_bufãr
; 
	}
}

62 
	$»size
(
size
)

64 ià(
m_®loÿ‹dSize
 < 
size
)

65 
	`»®loÿ‹
(
size
);

66 
m_size
 = 
size
;

67 
	}
}

69 
	$size
(ècÚ¡ {  
m_size
; 
	}
}

71 
	g´Ùeùed
:

73 
	$»®loÿ‹
(
size
)

77 
d–‘e
[] 
m_bufãr
;

78 ià(
size
<1000)

80 
®locSize
 = (
size
 * (
Li¡El
))/(
SÿÏr
);

81 
m_®loÿ‹dEËm’ts
 = (
®locSize
*(
SÿÏr
))/(
Li¡El
);

82 
m_bufãr
 = 
Ãw
 
SÿÏr
[
®locSize
];

86 
m_®loÿ‹dEËm’ts
 = (
size
*(
SÿÏr
))/(
Li¡El
);

87 
m_bufãr
 = 
Ãw
 
SÿÏr
[
size
];

89 
m_size
 = 
size
;

90 
m_¡¬t
 = 0;

91 
m_’d
 = 
m_size
;

92 
	}
}

94 
	$»®loÿ‹S·r£
()

96 
cİyEËm’ts
 = 
m_®loÿ‹dEËm’ts
;

97 
m_®loÿ‹dEËm’ts
 = 
¡d
::
	`mš
((m_®loÿ‹dEËm’ts*1.5),
m_size
);

98 
®locSize
 = 
m_®loÿ‹dEËm’ts
 * (
Li¡El
);

99 
®locSize
 =‡ÎocSize/(
SÿÏr
) + (allocSize%(Scalar)>0?1:0);

100 
SÿÏr
* 
ÃwBufãr
 = 
Ãw
 SÿÏr[
®locSize
];

101 
¡d
::
	`memıy
(
ÃwBufãr
, 
m_bufãr
, 
cİyEËm’ts
 * (
Li¡El
));

102 
d–‘e
[] 
m_bufãr
;

103 
m_bufãr
 = 
ÃwBufãr
;

104 
	}
}

106 
	g´Ùeùed
:

108 
	sLi¡El


110 
Ãxt
;

111 
	gšdex
;

112 
SÿÏr
 
	gv®ue
;

116 
SÿÏr
* 
	gm_bufãr
;

117 
	gm_size
;

118 
	gm_¡¬t
;

119 
	gm_’d
;

120 
	gm_®loÿ‹dSize
;

121 
	gm_®loÿ‹dEËm’ts
;

122 
	gm_mode
;

125 
	gm_ÎS¹
;

126 
	gm_ÎCu¼’t
;

127 
	gm_ÎSize
;

129 
	g´iv©e
:

130 
AmbiVeùÜ
(const AmbiVector&);

135 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

136 
	gAmbiVeùÜ
<
	gSÿÏr
>::
	$nÚZ”os
() const

138 ià(
m_mode
==
IsS·r£
)

139  
m_ÎSize
;

141  
m_’d
 - 
m_¡¬t
;

142 
	}
}

144 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

145 
	gAmbiVeùÜ
<
	gSÿÏr
>::
	$š™
(
R—lSÿÏr
 
e¡im©edD’s™y
)

147 ià(
e¡im©edD’s™y
>0.1)

148 
	`š™
(
IsD’£
);

150 
	`š™
(
IsS·r£
);

151 
	}
}

153 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

154 
	gAmbiVeùÜ
<
	gSÿÏr
>::
	$š™
(
mode
)

156 
m_mode
 = 
mode
;

157 ià(
m_mode
==
IsS·r£
)

159 
m_ÎSize
 = 0;

160 
m_ÎS¹
 = -1;

162 
	}
}

169 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

170 
	gAmbiVeùÜ
<
	gSÿÏr
>::
	$»¡¬t
()

172 
m_ÎCu¼’t
 = 
m_ÎS¹
;

173 
	}
}

176 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

177 
	gAmbiVeùÜ
<
	gSÿÏr
>::
	$£tZ”o
()

179 ià(
m_mode
==
IsD’£
)

181 
i
=
m_¡¬t
; i<
m_’d
; ++i)

182 
m_bufãr
[
i
] = 
	`SÿÏr
(0);

186 
	`ei_as£¹
(
m_mode
==
IsS·r£
);

187 
m_ÎSize
 = 0;

188 
m_ÎS¹
 = -1;

190 
	}
}

192 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

193 
	gSÿÏr
& 
	gAmbiVeùÜ
<SÿÏr>::
	$cÛffRef
(
i
)

195 ià(
m_mode
==
IsD’£
)

196  
m_bufãr
[
i
];

199 
Li¡El
* 
EIGEN_RESTRICT
 
ÎEËm’ts
 = 
»š‹½»t_ÿ¡
<Li¡El*>(
m_bufãr
);

201 
	`ei_as£¹
(
m_mode
==
IsS·r£
);

202 ià(
m_ÎSize
==0)

205 
m_ÎS¹
 = 0;

206 
m_ÎCu¼’t
 = 0;

207 ++
m_ÎSize
;

208 
ÎEËm’ts
[0].
v®ue
 = 
	`SÿÏr
(0);

209 
ÎEËm’ts
[0].
šdex
 = 
i
;

210 
ÎEËm’ts
[0].
Ãxt
 = -1;

211  
ÎEËm’ts
[0].
v®ue
;

213 ià(
i
<
ÎEËm’ts
[
m_ÎS¹
].
šdex
)

216 
Li¡El
& 
–
 = 
ÎEËm’ts
[
m_ÎSize
];

217 
–
.
v®ue
 = 
	`SÿÏr
(0);

218 
–
.
šdex
 = 
i
;

219 
–
.
Ãxt
 = 
m_ÎS¹
;

220 
m_ÎS¹
 = 
m_ÎSize
;

221 ++
m_ÎSize
;

222 
m_ÎCu¼’t
 = 
m_ÎS¹
;

223  
–
.
v®ue
;

227 
Ãx‹l
 = 
ÎEËm’ts
[
m_ÎCu¼’t
].
Ãxt
;

228 
	`ei_as£¹
(
i
>=
ÎEËm’ts
[
m_ÎCu¼’t
].
šdex
 && "you must call„estart() before inserting‡nƒlement with†ower orƒqual index");

229 
Ãx‹l
 >ğ0 && 
ÎEËm’ts
[Ãx‹l].
šdex
<=
i
)

231 
m_ÎCu¼’t
 = 
Ãx‹l
;

232 
Ãx‹l
 = 
ÎEËm’ts
[Ãx‹l].
Ãxt
;

235 ià(
ÎEËm’ts
[
m_ÎCu¼’t
].
šdex
==
i
)

238  
ÎEËm’ts
[
m_ÎCu¼’t
].
v®ue
;

242 ià(
m_ÎSize
>=
m_®loÿ‹dEËm’ts
)

244 
	`»®loÿ‹S·r£
();

245 
ÎEËm’ts
 = 
»š‹½»t_ÿ¡
<
Li¡El
*>(
m_bufãr
);

247 
	`ei_š‹º®_as£¹
(
m_ÎSize
<
m_®loÿ‹dEËm’ts
 && "internalƒrror: overflow in sparse mode");

249 
Li¡El
& 
–
 = 
ÎEËm’ts
[
m_ÎSize
];

250 
–
.
v®ue
 = 
	`SÿÏr
(0);

251 
–
.
šdex
 = 
i
;

252 
–
.
Ãxt
 = 
ÎEËm’ts
[
m_ÎCu¼’t
].next;

253 
ÎEËm’ts
[
m_ÎCu¼’t
].
Ãxt
 = 
m_ÎSize
;

254 ++
m_ÎSize
;

255  
–
.
v®ue
;

259 
	}
}

261 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

262 
SÿÏr
 
	gAmbiVeùÜ
<
	gSÿÏr
>::
	$cÛff
(
i
)

264 ià(
m_mode
==
IsD’£
)

265  
m_bufãr
[
i
];

268 
Li¡El
* 
EIGEN_RESTRICT
 
ÎEËm’ts
 = 
»š‹½»t_ÿ¡
<Li¡El*>(
m_bufãr
);

269 
	`ei_as£¹
(
m_mode
==
IsS·r£
);

270 ià((
m_ÎSize
==0è|| (
i
<
ÎEËm’ts
[
m_ÎS¹
].
šdex
))

272  
	`SÿÏr
(0);

276 
–id
 = 
m_ÎS¹
;

277 
–id
 >ğ0 && 
ÎEËm’ts
[–id].
šdex
<
i
)

278 
–id
 = 
ÎEËm’ts
[–id].
Ãxt
;

280 ià(
ÎEËm’ts
[
–id
].
šdex
==
i
)

281  
ÎEËm’ts
[
m_ÎCu¼’t
].
v®ue
;

283  
	`SÿÏr
(0);

286 
	}
}

289 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
>

290 
şass
 
	gAmbiVeùÜ
<
	g_SÿÏr
>::
I‹¿tÜ


292 
public
:

293 
_SÿÏr
 
	tSÿÏr
;

294 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

302 
I‹¿tÜ
(cÚ¡ 
AmbiVeùÜ
& 
vec
, 
R—lSÿÏr
 
•sÚ
 = R—lSÿÏr(0.1)*
´ecisiÚ
<RealScalar>())

303 : 
m_veùÜ
(
vec
)

305 
m_•sÚ
 = 
•sÚ
;

306 
	gm_isD’£
 = 
m_veùÜ
.
m_mode
==
IsD’£
;

307 ià(
	gm_isD’£
)

309 
	gm_ÿchedIndex
 = 
m_veùÜ
.
m_¡¬t
-1;

310 ++(*
	gthis
);

314 
Li¡El
* 
EIGEN_RESTRICT
 
	gÎEËm’ts
 = 
»š‹½»t_ÿ¡
<Li¡El*>(
m_veùÜ
.
m_bufãr
);

315 
	gm_cu¼’tEl
 = 
m_veùÜ
.
m_ÎS¹
;

316 
	gm_cu¼’tEl
>=0 && 
ei_abs
(
ÎEËm’ts
[
m_cu¼’tEl
].
v®ue
)<
m_•sÚ
)

317 
m_cu¼’tEl
 = 
ÎEËm’ts
[m_cu¼’tEl].
Ãxt
;

318 ià(
	gm_cu¼’tEl
<0)

320 
	gm_ÿchedIndex
 = -1;

324 
	gm_ÿchedIndex
 = 
ÎEËm’ts
[
m_cu¼’tEl
].
šdex
;

325 
	gm_ÿchedV®ue
 = 
ÎEËm’ts
[
m_cu¼’tEl
].
v®ue
;

330 
šdex
(ècÚ¡ {  
	gm_ÿchedIndex
; }

331 
SÿÏr
 
v®ue
(ècÚ¡ {  
	gm_ÿchedV®ue
; }

333 
İ”©Ü
 
boŞ
(ècÚ¡ {  
	gm_ÿchedIndex
>=0; }

335 
	gI‹¿tÜ
& 
	gİ”©Ü
++()

337 ià(
	gm_isD’£
)

340 ++
	gm_ÿchedIndex
;

341 } 
	gm_ÿchedIndex
<
	gm_veùÜ
.
	gm_’d
 && 
ei_abs
(
m_veùÜ
.
m_bufãr
[
m_ÿchedIndex
])<
	gm_•sÚ
);

342 ià(
	gm_ÿchedIndex
<
	gm_veùÜ
.
	gm_’d
)

343 
	gm_ÿchedV®ue
 = 
m_veùÜ
.
m_bufãr
[
m_ÿchedIndex
];

345 
	gm_ÿchedIndex
=-1;

349 
Li¡El
* 
EIGEN_RESTRICT
 
	gÎEËm’ts
 = 
»š‹½»t_ÿ¡
<Li¡El*>(
m_veùÜ
.
m_bufãr
);

351 
	gm_cu¼’tEl
 = 
ÎEËm’ts
[
m_cu¼’tEl
].
Ãxt
;

352 } 
	gm_cu¼’tEl
>=0 && 
ei_abs
(
ÎEËm’ts
[
m_cu¼’tEl
].
v®ue
)<
m_•sÚ
);

353 ià(
	gm_cu¼’tEl
<0)

355 
	gm_ÿchedIndex
 = -1;

359 
	gm_ÿchedIndex
 = 
ÎEËm’ts
[
m_cu¼’tEl
].
šdex
;

360 
	gm_ÿchedV®ue
 = 
ÎEËm’ts
[
m_cu¼’tEl
].
v®ue
;

363  *
	gthis
;

366 
	g´Ùeùed
:

367 cÚ¡ 
AmbiVeùÜ
& 
m_veùÜ
;

368 
	gm_cu¼’tEl
;

369 
R—lSÿÏr
 
	gm_•sÚ
;

370 
	gm_ÿchedIndex
;

371 
SÿÏr
 
	gm_ÿchedV®ue
;

372 
boŞ
 
	gm_isD’£
;

374 
	g´iv©e
:

375 
I‹¿tÜ
& 
İ”©Ü
=(const Iterator&);

	@robot/Eigen/src/Sparse/CholmodSupport.h

25 #iâdeà
EIGEN_CHOLMODSUPPORT_H


26 
	#EIGEN_CHOLMODSUPPORT_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
,y³Çm
	gChŞmodTy³
>

29 
	$ei_chŞmod_cÚfigu»_m©rix
(
ChŞmodTy³
& 
m©
)

31 ià(
ei_is_§me_ty³
<
SÿÏr
,>::
»t
)

33 
m©
.
xty³
 = 
CHOLMOD_REAL
;

34 
m©
.
dty³
 = 1;

36 ià(
ei_is_§me_ty³
<
SÿÏr
,>::
»t
)

38 
m©
.
xty³
 = 
CHOLMOD_REAL
;

39 
m©
.
dty³
 = 0;

41 ià(
ei_is_§me_ty³
<
SÿÏr
,
¡d
::
com¶ex
<> >::
»t
)

43 
m©
.
xty³
 = 
CHOLMOD_COMPLEX
;

44 
m©
.
dty³
 = 1;

46 ià(
ei_is_§me_ty³
<
SÿÏr
,
¡d
::
com¶ex
<> >::
»t
)

48 
m©
.
xty³
 = 
CHOLMOD_COMPLEX
;

49 
m©
.
dty³
 = 0;

53 
	`ei_as£¹
(
çl£
 && "Scalarype‚ot supported by CHOLMOD");

55 
	}
}

57 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

58 
chŞmod_¥¬£
 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$asChŞmodM©rix
()

60 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

61 
chŞmod_¥¬£
 
»s
;

62 
»s
.
nzmax
 = 
	`nÚZ”os
();

63 
»s
.
Äow
 = 
	`rows
();;

64 
»s
.
ncŞ
 = 
	`cŞs
();

65 
»s
.
p
 = 
	`d”ived
().
	`_ou‹rIndexPŒ
();

66 
»s
.
i
 = 
	`d”ived
().
	`_šÃrIndexPŒ
();

67 
»s
.
x
 = 
	`d”ived
().
	`_v®uePŒ
();

68 
»s
.
xty³
 = 
CHOLMOD_REAL
;

69 
»s
.
™y³
 = 
CHOLMOD_INT
;

70 
»s
.
sÜ‹d
 = 1;

71 
»s
.
·cked
 = 1;

72 
»s
.
dty³
 = 0;

73 
»s
.
¡y³
 = -1;

75 
ei_chŞmod_cÚfigu»_m©rix
<
SÿÏr
>(
»s
);

77 ià(
D”ived
::
FÏgs
 & 
S–fAdjošt
)

79 ià(
D”ived
::
FÏgs
 & 
Uµ”TrŸnguÏr
)

80 
»s
.
¡y³
 = 1;

81 ià(
D”ived
::
FÏgs
 & 
Low”TrŸnguÏr
)

82 
»s
.
¡y³
 = -1;

84 
»s
.
¡y³
 = 0;

87 
»s
.
¡y³
 = 0;

89  
»s
;

90 
	}
}

92 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

93 
chŞmod_d’£
 
ei_chŞmod_m­_eig’_to_d’£
(
M©rixBa£
<
D”ived
>& 
m©
)

95 
EIGEN_STATIC_ASSERT
((
ei_Œa™s
<
D”ived
>::
FÏgs
&
RowMajÜB™
)==0,
THIS_METHOD_IS_ONLY_FOR_COLUMN_MAJOR_MATRICES
);

96 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

98 
chŞmod_d’£
 
	g»s
;

99 
	g»s
.
	gÄow
 = 
m©
.
rows
();

100 
	g»s
.
	gncŞ
 = 
m©
.
cŞs
();

101 
	g»s
.
	gnzmax
 = 
»s
.
Äow
 *„es.
ncŞ
;

102 
	g»s
.
	gd
 = 
m©
.
d”ived
().
¡ride
();

103 
	g»s
.
	gx
 = 
m©
.
d”ived
().
d©a
();

104 
	g»s
.
	gz
 = 0;

106 
	gei_chŞmod_cÚfigu»_m©rix
<
	gSÿÏr
>(
	g»s
);

108  
	g»s
;

111 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gFÏgs
>

112 
	gM­³dS·r£M©rix
<
	gSÿÏr
,
	gFÏgs
>::
	$M­³dS·r£M©rix
(
chŞmod_¥¬£
& 
cm
)

114 
m_šÃrSize
 = 
cm
.
Äow
;

115 
m_ou‹rSize
 = 
cm
.
ncŞ
;

116 
m_ou‹rIndex
 = 
»š‹½»t_ÿ¡
<*>(
cm
.
p
);

117 
m_šÃrIndiûs
 = 
»š‹½»t_ÿ¡
<*>(
cm
.
i
);

118 
m_v®ues
 = 
»š‹½»t_ÿ¡
<
SÿÏr
*>(
cm
.
x
);

119 
m_Âz
 = 
m_ou‹rIndex
[
cm
.
ncŞ
];

120 
	}
}

122 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

123 
şass
 
	gS·r£LLT
<
	gM©rixTy³
,
	gChŞmod
> : 
public
 
S·r£LLT
<
M©rixTy³
>

125 
´Ùeùed
:

126 
S·r£LLT
<
	tM©rixTy³
> 
	tBa£
;

127 
ty³Çme
 
	tBa£
::
	tSÿÏr
 Scalar;

128 
ty³Çme
 
	tBa£
::
	tR—lSÿÏr
 RealScalar;

129 
usšg
 
	gBa£
::
M©rixLIsDœty
;

130 
usšg
 
	gBa£
::
Su³ºod®FaùÜIsDœty
;

131 
usšg
 
	gBa£
::
m_æags
;

132 
usšg
 
	gBa£
::
m_m©rix
;

133 
usšg
 
	gBa£
::
m_¡©us
;

135 
	gpublic
:

137 
S·r£LLT
(
æags
 = 0)

138 : 
Ba£
(
æags
), 
m_chŞmodFaùÜ
(0)

140 
chŞmod_¡¬t
(&
m_chŞmod
);

143 
S·r£LLT
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
æags
 = 0)

144 : 
Ba£
(
æags
), 
m_chŞmodFaùÜ
(0)

146 
chŞmod_¡¬t
(&
m_chŞmod
);

147 
compu‹
(
m©rix
);

150 ~
S·r£LLT
()

152 ià(
	gm_chŞmodFaùÜ
)

153 
chŞmod_ä“_çùÜ
(&
m_chŞmodFaùÜ
, &
m_chŞmod
);

154 
chŞmod_fšish
(&
m_chŞmod
);

157 
šlše
 cÚ¡ 
ty³Çme
 
	gBa£
::
ChŞM©rixTy³
& 
m©rixL
() const;

159 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

160 
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const;

162 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

164 
	g´Ùeùed
:

165 
mubË
 
chŞmod_commÚ
 
m_chŞmod
;

166 
chŞmod_çùÜ
* 
	gm_chŞmodFaùÜ
;

169 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

170 
	gS·r£LLT
<
	gM©rixTy³
,
	gChŞmod
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

172 ià(
m_chŞmodFaùÜ
)

174 
	`chŞmod_ä“_çùÜ
(&
m_chŞmodFaùÜ
, &
m_chŞmod
);

175 
m_chŞmodFaùÜ
 = 0;

178 
chŞmod_¥¬£
 
A
 = 
cÚ¡_ÿ¡
<
M©rixTy³
&>(
a
).
	`asChŞmodM©rix
();

179 
m_chŞmod
.
su³ºod®
 = 
CHOLMOD_AUTO
;

181 ià(
m_æags
&
Incom¶‘eFaùÜiz©iÚ
)

183 
m_chŞmod
.
nm‘hods
 = 1;

184 
m_chŞmod
.
m‘hod
[0].
Üd”šg
 = 
CHOLMOD_NATURAL
;

185 
m_chŞmod
.
po¡Üd”
 = 0;

189 
m_chŞmod
.
nm‘hods
 = 1;

190 
m_chŞmod
.
m‘hod
[0].
Üd”šg
 = 
CHOLMOD_NATURAL
;

191 
m_chŞmod
.
po¡Üd”
 = 0;

193 
m_chŞmod
.
fš®_Î
 = 1;

194 
m_chŞmodFaùÜ
 = 
	`chŞmod_ª®yze
(&
A
, &
m_chŞmod
);

195 
	`chŞmod_çùÜize
(&
A
, 
m_chŞmodFaùÜ
, &
m_chŞmod
);

197 
m_¡©us
 = (m_¡©u & ~
Su³ºod®FaùÜIsDœty
è| 
M©rixLIsDœty
;

198 
	}
}

200 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

201 
šlše
 cÚ¡ 
ty³Çme
 
	gS·r£LLT
<
	gM©rixTy³
>::
ChŞM©rixTy³
&

202 
S·r£LLT
<
M©rixTy³
,
	gChŞmod
>::
	$m©rixL
() const

204 ià(
m_¡©us
 & 
M©rixLIsDœty
)

206 
	`ei_as£¹
(!(
m_¡©us
 & 
Su³ºod®FaùÜIsDœty
));

208 
chŞmod_¥¬£
* 
cmRes
 = 
	`chŞmod_çùÜ_to_¥¬£
(
m_chŞmodFaùÜ
, &
m_chŞmod
);

209 
cÚ¡_ÿ¡
<
ty³Çme
 
Ba£
::
ChŞM©rixTy³
&>(
m_m©rix
èğ
M­³dS·r£M©rix
<
SÿÏr
>(*
cmRes
);

210 
	`ä“
(
cmRes
);

212 
m_¡©us
 = (m_¡©u & ~
M©rixLIsDœty
);

214  
m_m©rix
;

215 
	}
}

217 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

218 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

219 
	gS·r£LLT
<
	gM©rixTy³
,
	gChŞmod
>::
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const

221 cÚ¡ 
size
 = 
m_chŞmodFaùÜ
->
n
;

222 
ei_as£¹
(
size
==
b
.
rows
());

230 
chŞmod_d’£
 
	gcdb
 = 
ei_chŞmod_m­_eig’_to_d’£
(
b
);

231 
chŞmod_d’£
* 
	gx
 = 
chŞmod_sŞve
(
CHOLMOD_LDLt
, 
m_chŞmodFaùÜ
, &
cdb
, &
m_chŞmod
);

232 
	gb
 = 
M©rix
<
ty³Çme
 
Ba£
::
SÿÏr
,
	gDyÇmic
,1>::
M­
(
»š‹½»t_ÿ¡
<ty³ÇmBa£::SÿÏr*>(
x
->x),
b
.
rows
());

233 
chŞmod_ä“_d’£
(&
x
, &
m_chŞmod
);

	@robot/Eigen/src/Sparse/CompressedStorage.h

25 #iâdeà
EIGEN_COMPRESSED_STORAGE_H


26 
	#EIGEN_COMPRESSED_STORAGE_H


	)

31 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
>

32 şas 
	cCom´es£dStÜage


34 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

35 
	mpublic
:

36 
	$Com´es£dStÜage
()

37 : 
	`m_v®ues
(0), 
	`m_šdiûs
(0), 
	`m_size
(0), 
	$m_®loÿ‹dSize
(0)

40 
	$Com´es£dStÜage
(
¡d
::
size_t
 
size
)

41 : 
	`m_v®ues
(0), 
	`m_šdiûs
(0), 
	`m_size
(0), 
	$m_®loÿ‹dSize
(0)

43 
	`»size
(
size
);

44 
	}
}

46 
	$Com´es£dStÜage
(cÚ¡ 
Com´es£dStÜage
& 
Ùh”
)

47 : 
	`m_v®ues
(0), 
	`m_šdiûs
(0), 
	`m_size
(0), 
	$m_®loÿ‹dSize
(0)

49 *
this
 = 
Ùh”
;

50 
	}
}

52 
	gCom´es£dStÜage
& 
	gİ”©Ü
=(cÚ¡ 
Com´es£dStÜage
& 
Ùh”
)

54 
»size
(
Ùh”
.
size
());

55 
	g¡d
::
memıy
(
m_v®ues
, 
Ùh”
.m_v®ues, 
m_size
 * (
SÿÏr
));

56 
	g¡d
::
memıy
(
m_šdiûs
, 
Ùh”
.m_šdiûs, 
m_size
 * ());

57  *
	gthis
;

60 
	$sw­
(
Com´es£dStÜage
& 
Ùh”
)

62 
¡d
::
	`sw­
(
m_v®ues
, 
Ùh”
.m_values);

63 
¡d
::
	`sw­
(
m_šdiûs
, 
Ùh”
.m_indices);

64 
¡d
::
	`sw­
(
m_size
, 
Ùh”
.m_size);

65 
¡d
::
	`sw­
(
m_®loÿ‹dSize
, 
Ùh”
.m_allocatedSize);

66 
	}
}

68 ~
	$Com´es£dStÜage
()

70 
d–‘e
[] 
m_v®ues
;

71 
d–‘e
[] 
m_šdiûs
;

72 
	}
}

74 
	$»£rve
(
¡d
::
size_t
 
size
)

76 
¡d
::
size_t
 
ÃwAÎoÿ‹dSize
 = 
m_size
 + 
size
;

77 ià(
ÃwAÎoÿ‹dSize
 > 
m_®loÿ‹dSize
)

78 
	`»®loÿ‹
(
ÃwAÎoÿ‹dSize
);

79 
	}
}

81 
	$squ“ze
()

83 ià(
m_®loÿ‹dSize
>
m_size
)

84 
	`»®loÿ‹
(
m_size
);

85 
	}
}

87 
	$»size
(
¡d
::
size_t
 
size
, 
»£rveSizeFaùÜ
 = 0)

89 ià(
m_®loÿ‹dSize
<
size
)

90 
	`»®loÿ‹
(
size
 + 
¡d
::
	`size_t
(
»£rveSizeFaùÜ
*size));

91 
m_size
 = 
size
;

92 
	}
}

94 
	$­³nd
(cÚ¡ 
SÿÏr
& 
v
, 
i
)

96 
id
 = 
m_size
;

97 
	`»size
(
m_size
+1, 1);

98 
m_v®ues
[
id
] = 
v
;

99 
m_šdiûs
[
id
] = 
i
;

100 
	}
}

102 
šlše
 
	g¡d
::
size_t
 
	$size
(ècÚ¡ {  
m_size
; 
	}
}

103 
šlše
 
	g¡d
::
size_t
 
	$®loÿ‹dSize
(ècÚ¡ {  
m_®loÿ‹dSize
; 
	}
}

104 
šlše
 
	$ş—r
(è{ 
m_size
 = 0; 
	}
}

106 
šlše
 
	gSÿÏr
& 
	$v®ue
(
¡d
::
size_t
 
i
è{  
m_v®ues
[i]; 
	}
}

107 
šlše
 cÚ¡ 
	gSÿÏr
& 
	$v®ue
(
¡d
::
size_t
 
i
ècÚ¡ {  
m_v®ues
[i]; 
	}
}

109 
šlše
 & 
	$šdex
(
¡d
::
size_t
 
i
è{  
m_šdiûs
[i]; 
	}
}

110 
šlše
 cÚ¡ & 
	$šdex
(
¡d
::
size_t
 
i
ècÚ¡ {  
m_šdiûs
[i]; 
	}
}

112 
Com´es£dStÜage
 
	$M­
(* 
šdiûs
, 
SÿÏr
* 
v®ues
, 
¡d
::
size_t
 
size
)

114 
Com´es£dStÜage
 
»s
;

115 
»s
.
m_šdiûs
 = 
šdiûs
;

116 
»s
.
m_v®ues
 = 
v®ues
;

117 
»s
.
m_®loÿ‹dSize
 =„es.
m_size
 = 
size
;

118  
»s
;

119 
	}
}

122 
šlše
 
	$£¬chLow”Index
(
key
) const

124  
	`£¬chLow”Index
(0, 
m_size
, 
key
);

125 
	}
}

128 
šlše
 
	$£¬chLow”Index
(
¡d
::
size_t
 
¡¬t
, std::size_ˆ
’d
, 
key
) const

130 
’d
>
¡¬t
)

132 
¡d
::
size_t
 
mid
 = (
’d
+
¡¬t
)>>1;

133 ià(
m_šdiûs
[
mid
]<
key
)

134 
¡¬t
 = 
mid
+1;

136 
’d
 = 
mid
;

138  
¡¬t
;

139 
	}
}

143 
šlše
 
SÿÏr
 
©
(
key
, SÿÏ¸
deçuÉV®ue
 = 
	$SÿÏr
(0)) const

145 ià(
m_size
==0)

146  
deçuÉV®ue
;

147 ià(
key
==
m_šdiûs
[
m_size
-1])

148  
m_v®ues
[
m_size
-1];

151 cÚ¡ 
¡d
::
size_t
 
id
 = 
	`£¬chLow”Index
(0,
m_size
-1,
key
);

152  ((
id
<
m_size
è&& (
m_šdiûs
[id]==
key
)è? 
m_v®ues
[id] : 
deçuÉV®ue
;

153 
	}
}

156 
šlše
 
SÿÏr
 
©InRªge
(
¡d
::
size_t
 
¡¬t
, std::size_ˆ
’d
, 
key
, SÿÏ¸
deçuÉV®ue
 = 
	$SÿÏr
(0)) const

158 ià(
¡¬t
==
’d
)

159  
	`SÿÏr
(0);

160 ià(
’d
>
¡¬t
 && 
key
==
m_šdiûs
[end-1])

161  
m_v®ues
[
’d
-1];

164 cÚ¡ 
¡d
::
size_t
 
id
 = 
	`£¬chLow”Index
(
¡¬t
,
’d
-1,
key
);

165  ((
id
<
’d
è&& (
m_šdiûs
[id]==
key
)è? 
m_v®ues
[id] : 
deçuÉV®ue
;

166 
	}
}

171 
šlše
 
	gSÿÏr
& 
©W™hIn£¹iÚ
(
key
, 
SÿÏr
 
deçuÉV®ue
 = 
	$SÿÏr
(0))

173 
¡d
::
size_t
 
id
 = 
	`£¬chLow”Index
(0,
m_size
,
key
);

174 ià(
id
>=
m_size
 || 
m_šdiûs
[id]!=
key
)

176 
	`»size
(
m_size
+1,1);

177 
¡d
::
size_t
 
j
=
m_size
-1; j>
id
; --j)

179 
m_šdiûs
[
j
] = m_indices[j-1];

180 
m_v®ues
[
j
] = m_values[j-1];

182 
m_šdiûs
[
id
] = 
key
;

183 
m_v®ues
[
id
] = 
deçuÉV®ue
;

185  
m_v®ues
[
id
];

186 
	}
}

188 
´uÃ
(
SÿÏr
 
»ã»nû
, 
R—lSÿÏr
 
•sÚ
 = 
´ecisiÚ
<RealScalar>())

190 
¡d
::
size_t
 
k
 = 0;

191 
	g¡d
::
size_t
 
n
 = 
size
();

192 
	g¡d
::
size_t
 
i
=0; 
	gi
<
	gn
; ++i)

194 ià(!
ei_isMuchSm®ËrThª
(
v®ue
(
i
), 
»ã»nû
, 
•sÚ
))

196 
v®ue
(
k
èğv®ue(
i
);

197 
šdex
(
k
èğšdex(
i
);

198 ++
	gk
;

201 
»size
(
k
,0);

204 
	g´Ùeùed
:

206 
šlše
 
	$»®loÿ‹
(
¡d
::
size_t
 
size
)

208 
SÿÏr
* 
ÃwV®ues
 = 
Ãw
 SÿÏr[
size
];

209 * 
ÃwIndiûs
 = 
Ãw
 [
size
];

210 
¡d
::
size_t
 
cİySize
 = std::
	`mš
(
size
, 
m_size
);

212 
¡d
::
	`memıy
(
ÃwV®ues
, 
m_v®ues
, 
cİySize
 * (
SÿÏr
));

213 
¡d
::
	`memıy
(
ÃwIndiûs
, 
m_šdiûs
, 
cİySize
 * ());

215 
d–‘e
[] 
m_v®ues
;

216 
d–‘e
[] 
m_šdiûs
;

217 
m_v®ues
 = 
ÃwV®ues
;

218 
m_šdiûs
 = 
ÃwIndiûs
;

219 
m_®loÿ‹dSize
 = 
size
;

220 
	}
}

222 
	g´Ùeùed
:

223 
SÿÏr
* 
m_v®ues
;

224 * 
	gm_šdiûs
;

225 
	g¡d
::
size_t
 
m_size
;

226 
	g¡d
::
size_t
 
m_®loÿ‹dSize
;

	@robot/Eigen/src/Sparse/CoreIterators.h

25 #iâdeà
EIGEN_COREITERATORS_H


26 
	#EIGEN_COREITERATORS_H


	)

38 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
şass
 
	gM©rixBa£
<D”ived>::
IÂ”I‹¿tÜ


40 
ty³Çme
 
	tD”ived
::
	tSÿÏr
 Scalar;

41 ’um { 
	gIsRowMajÜ
 = (
D”ived
::
FÏgs
&
RowMajÜB™
)==RowMajorBit };

42 
	gpublic
:

43 
EIGEN_STRONG_INLINE
 
IÂ”I‹¿tÜ
(cÚ¡ 
D”ived
& 
ex´
, 
ou‹r
)

44 : 
m_ex´essiÚ
(
ex´
), 
m_šÃr
(0), 
m_ou‹r
(
ou‹r
), 
m_’d
Óx´.
rows
())

47 
EIGEN_STRONG_INLINE
 
SÿÏr
 
v®ue
() const

49  (
	gIsRowMajÜ
è? 
	gm_ex´essiÚ
.
cÛff
(
m_ou‹r
, 
m_šÃr
)

50 : 
m_ex´essiÚ
.
cÛff
(
m_šÃr
, 
m_ou‹r
);

53 
EIGEN_STRONG_INLINE
 
	gIÂ”I‹¿tÜ
& 
	gİ”©Ü
++(è{ 
	gm_šÃr
++;  *
	gthis
; }

55 
EIGEN_STRONG_INLINE
 
šdex
(ècÚ¡ {  
	gm_šÃr
; }

56 
šlše
 
row
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gm_ou‹r
 : 
šdex
(); }

57 
šlše
 
cŞ
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
šdex
(è: 
m_ou‹r
; }

59 
EIGEN_STRONG_INLINE
 
İ”©Ü
 
boŞ
(ècÚ¡ {  
	gm_šÃr
 < 
	gm_’d
 && m_inner>=0; }

61 
	g´Ùeùed
:

62 cÚ¡ 
D”ived
& 
m_ex´essiÚ
;

63 
	gm_šÃr
;

64 cÚ¡ 
	gm_ou‹r
;

65 cÚ¡ 
	gm_’d
;

	@robot/Eigen/src/Sparse/DynamicSparseMatrix.h

25 #iâdeà
EIGEN_DYNAMIC_SPARSEMATRIX_H


26 
	#EIGEN_DYNAMIC_SPARSEMATRIX_H


	)

45 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

46 
	gei_Œa™s
<
	gDyÇmicS·r£M©rix
<
	g_SÿÏr
, 
	g_FÏgs
> >

48 
_SÿÏr
 
	tSÿÏr
;

50 
	gRowsAtCompeTime
 = 
DyÇmic
,

51 
	gCŞsAtCompeTime
 = 
DyÇmic
,

52 
	gMaxRowsAtCompeTime
 = 
DyÇmic
,

53 
	gMaxCŞsAtCompeTime
 = 
DyÇmic
,

54 
	gFÏgs
 = 
S·r£B™
 | 
_FÏgs
,

55 
	gCÛffR—dCo¡
 = 
NumT¿™s
<
SÿÏr
>::
R—dCo¡
,

56 
	gSuµÜ‹dAcûssP©‹ºs
 = 
Ou‹rRªdomAcûssP©‹º


60 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

61 
şass
 
	gDyÇmicS·r£M©rix


62 : 
public
 
S·r£M©rixBa£
<
DyÇmicS·r£M©rix
<
_SÿÏr
, 
	g_FÏgs
> >

64 
	gpublic
:

65 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
DyÇmicS·r£M©rix
)

69 
M­³dS·r£M©rix
<
	tSÿÏr
,
	tFÏgs
> 
	tM­
;

71 
	g´Ùeùed
:

73 ’um { 
IsRowMajÜ
 = 
Ba£
::IsRowMajor };

74 
	gDyÇmicS·r£M©rix
<
	tSÿÏr
,(
	tFÏgs
&~
	tRowMajÜB™
)|(
	tIsRowMajÜ
?RowMajÜB™:0)> 
	tT¿n¥o£dS·r£M©rix
;

76 
	gm_šÃrSize
;

77 
	g¡d
::
veùÜ
<
Com´es£dStÜage
<
SÿÏr
> > 
m_d©a
;

79 
	gpublic
:

81 
šlše
 
rows
(ècÚ¡ {  
IsRowMajÜ
 ? 
ou‹rSize
(è: 
m_šÃrSize
; }

82 
šlše
 
cŞs
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gm_šÃrSize
 : 
ou‹rSize
(); }

83 
šlše
 
šÃrSize
(ècÚ¡ {  
	gm_šÃrSize
; }

84 
šlše
 
ou‹rSize
(ècÚ¡ {  
	gm_d©a
.
size
(); }

85 
šlše
 
šÃrNÚZ”os
(
j
ècÚ¡ {  
	gm_d©a
[j].
size
(); }

87 
	g¡d
::
veùÜ
<
Com´es£dStÜage
<
SÿÏr
> >& 
_d©a
(è{  
m_d©a
; }

88 cÚ¡ 
	g¡d
::
veùÜ
<
Com´es£dStÜage
<
SÿÏr
> >& 
_d©a
(ècÚ¡ {  
m_d©a
; }

93 
šlše
 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

95 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

96 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

97  
	gm_d©a
[
ou‹r
].
©
(
šÃr
);

104 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

106 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

107 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

108  
	gm_d©a
[
ou‹r
].
©W™hIn£¹iÚ
(
šÃr
);

111 
şass
 
	gIÂ”I‹¿tÜ
;

113 
šlše
 
£tZ”o
()

115 
	gj
=0; j<
ou‹rSize
(); ++j)

116 
	gm_d©a
[
j
].
ş—r
();

120 
šlše
 
nÚZ”os
() const

122 
	g»s
 = 0;

123 
	gj
=0; j<
ou‹rSize
(); ++j)

124 
	g»s
 +ğ
m_d©a
[
j
].
size
();

125  
	g»s
;

129 
šlše
 
¡¬tFl
(
»£rveSize
 = 1000)

131 ià(
ou‹rSize
()>0)

133 
»£rveSizeP”VeùÜ
 = 
¡d
::
max
(
»£rveSize
/
ou‹rSize
(),4);

134 
	gj
=0; j<
ou‹rSize
(); ++j)

136 
	gm_d©a
[
j
].
ş—r
();

137 
	gm_d©a
[
j
].
»£rve
(
»£rveSizeP”VeùÜ
);

150 
šlše
 
	gSÿÏr
& 
fl
(
row
, 
cŞ
)

152 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

153 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

154 
ei_as£¹
(
ou‹r
<(
m_d©a
.
size
()è&& 
šÃr
<
m_šÃrSize
);

155 
ei_as£¹
((
m_d©a
[
ou‹r
].
size
()==0è|| (m_d©a[ou‹r].
šdex
(m_d©a[ou‹r].size()-1)<
šÃr
));

156 
	gm_d©a
[
ou‹r
].
­³nd
(0, 
šÃr
);

157  
	gm_d©a
[
ou‹r
].
v®ue
(
m_d©a
[ou‹r].
size
()-1);

164 
šlše
 
	gSÿÏr
& 
fÌªd
(
row
, 
cŞ
)

166 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

167 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

169 
	g¡¬tId
 = 0;

170 
	gid
 = 
m_d©a
[
ou‹r
].
size
() - 1;

171 
	gm_d©a
[
ou‹r
].
»size
(
id
+2,1);

173  (
	gid
 >ğ
¡¬tId
è&& (
m_d©a
[
ou‹r
].
šdex
(
id
è> 
šÃr
) )

175 
m_d©a
[
ou‹r
].
šdex
(
id
+1) = m_data[outer].index(id);

176 
	gm_d©a
[
ou‹r
].
v®ue
(
id
+1èğ
m_d©a
[outer].value(id);

177 --
	gid
;

179 
	gm_d©a
[
ou‹r
].
šdex
(
id
+1èğ
šÃr
;

180 
	gm_d©a
[
ou‹r
].
v®ue
(
id
+1) = 0;

181  
	gm_d©a
[
ou‹r
].
v®ue
(
id
+1);

185 
šlše
 
’dFl
() {}

187 
´uÃ
(
SÿÏr
 
»ã»nû
, 
R—lSÿÏr
 
•sÚ
 = 
´ecisiÚ
<RealScalar>())

189 
j
=0; 
	gj
<
ou‹rSize
(); ++j)

190 
	gm_d©a
[
j
].
´uÃ
(
»ã»nû
,
•sÚ
);

195 
»size
(
rows
, 
cŞs
)

197 cÚ¡ 
	gou‹rSize
 = 
IsRowMajÜ
 ? 
rows
 : 
cŞs
;

198 
	gm_šÃrSize
 = 
IsRowMajÜ
 ? 
cŞs
 : 
rows
;

199 
£tZ”o
();

200 ià((
	gm_d©a
.
size
()è!ğ
ou‹rSize
)

202 
m_d©a
.
»size
(
ou‹rSize
);

206 
»sizeAndK“pD©a
(
rows
, 
cŞs
)

208 cÚ¡ 
	gou‹rSize
 = 
IsRowMajÜ
 ? 
rows
 : 
cŞs
;

209 cÚ¡ 
	gšÃrSize
 = 
IsRowMajÜ
 ? 
cŞs
 : 
rows
;

210 ià(
	gm_šÃrSize
>
	gšÃrSize
)

214 
	g¡d
::
û¼
 << "not implemented yet\n";

215 
	g¡d
::
ex™
(2);

217 ià(
	gm_d©a
.
size
(è!ğ
ou‹rSize
)

219 
m_d©a
.
»size
(
ou‹rSize
);

223 
šlše
 
DyÇmicS·r£M©rix
()

224 : 
m_šÃrSize
(0), 
m_d©a
(0)

226 
ei_as£¹
(
šÃrSize
()==0 && 
ou‹rSize
()==0);

229 
šlše
 
DyÇmicS·r£M©rix
(
rows
, 
cŞs
)

230 : 
m_šÃrSize
(0)

232 
»size
(
rows
, 
cŞs
);

235 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

236 
šlše
 
DyÇmicS·r£M©rix
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

237 : 
m_šÃrSize
(0)

239 *
this
 = 
Ùh”
.
d”ived
();

242 
šlše
 
DyÇmicS·r£M©rix
(cÚ¡ DyÇmicS·r£M©rix& 
Ùh”
)

243 : 
Ba£
(), 
m_šÃrSize
(0)

245 *
	gthis
 = 
Ùh”
.
d”ived
();

248 
šlše
 
sw­
(
DyÇmicS·r£M©rix
& 
Ùh”
)

251 
	g¡d
::
sw­
(
m_šÃrSize
, 
Ùh”
.m_innerSize);

253 
	gm_d©a
.
sw­
(
Ùh”
.
m_d©a
);

256 
šlše
 
	gDyÇmicS·r£M©rix
& 
	gİ”©Ü
=(cÚ¡ 
DyÇmicS·r£M©rix
& 
Ùh”
)

258 ià(
Ùh”
.
isRV®ue
())

260 
sw­
(
Ùh”
.
cÚ¡_ÿ¡_d”ived
());

264 
»size
(
Ùh”
.
rows
(), oth”.
cŞs
());

265 
	gm_d©a
 = 
Ùh”
.
m_d©a
;

267  *
	gthis
;

270 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

271 
šlše
 
	gDyÇmicS·r£M©rix
& 
	gİ”©Ü
=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

273  
S·r£M©rixBa£
<
DyÇmicS·r£M©rix
>::
İ”©Ü
=(
Ùh”
.
d”ived
());

277 
	gšlše
 ~
DyÇmicS·r£M©rix
() {}

280 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	g_FÏgs
>

281 
şass
 
	gDyÇmicS·r£M©rix
<
	gSÿÏr
,
	g_FÏgs
>::
IÂ”I‹¿tÜ
 : 
public
 
S·r£VeùÜ
<
SÿÏr
,_Flags>::InnerIterator

283 
ty³Çme
 
	tS·r£VeùÜ
<
	tSÿÏr
,
	t_FÏgs
>::
	tIÂ”I‹¿tÜ
 
	tBa£
;

284 
	gpublic
:

285 
IÂ”I‹¿tÜ
(cÚ¡ 
DyÇmicS·r£M©rix
& 
m©
, 
ou‹r
)

286 : 
Ba£
(
m©
.
m_d©a
[
ou‹r
]), 
m_ou‹r
(outer)

289 
šlše
 
row
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gm_ou‹r
 : 
Ba£
::
šdex
(); }

290 
šlše
 
cŞ
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gBa£
::
šdex
(è: 
m_ou‹r
; }

292 
	g´Ùeùed
:

293 cÚ¡ 
m_ou‹r
;

295 
	g´iv©e
:

296 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

	@robot/Eigen/src/Sparse/MappedSparseMatrix.h

25 #iâdeà
EIGEN_MAPPED_SPARSEMATRIX_H


26 
	#EIGEN_MAPPED_SPARSEMATRIX_H


	)

37 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

38 
	gei_Œa™s
<
	gM­³dS·r£M©rix
<
	g_SÿÏr
, 
	g_FÏgs
> > : 
ei_Œa™s
<
S·r£M©rix
<
_SÿÏr
, _Flags> >

41 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

42 
şass
 
	gM­³dS·r£M©rix


43 : 
public
 
S·r£M©rixBa£
<
M­³dS·r£M©rix
<
_SÿÏr
, 
	g_FÏgs
> >

45 
	gpublic
:

46 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
M­³dS·r£M©rix
)

48 
´Ùeùed
:

49 ’um { 
IsRowMajÜ
 = 
Ba£
::IsRowMajor };

51 
	gm_ou‹rSize
;

52 
	gm_šÃrSize
;

53 
	gm_Âz
;

54 * 
	gm_ou‹rIndex
;

55 * 
	gm_šÃrIndiûs
;

56 
SÿÏr
* 
	gm_v®ues
;

58 
	gpublic
:

60 
šlše
 
rows
(ècÚ¡ {  
IsRowMajÜ
 ? 
m_ou‹rSize
 : 
m_šÃrSize
; }

61 
šlše
 
cŞs
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gm_šÃrSize
 : 
m_ou‹rSize
; }

62 
šlše
 
šÃrSize
(ècÚ¡ {  
	gm_šÃrSize
; }

63 
šlše
 
ou‹rSize
(ècÚ¡ {  
	gm_ou‹rSize
; }

64 
šlše
 
šÃrNÚZ”os
(
j
ècÚ¡ {  
	gm_ou‹rIndex
[j+1]-m_outerIndex[j]; }

68 
šlše
 cÚ¡ 
SÿÏr
* 
_v®uePŒ
(ècÚ¡ {  
	gm_v®ues
; }

69 
šlše
 
SÿÏr
* 
_v®uePŒ
(è{  
	gm_v®ues
; }

71 
šlše
 cÚ¡ * 
_šÃrIndexPŒ
(ècÚ¡ {  
	gm_šÃrIndiûs
; }

72 
šlše
 * 
_šÃrIndexPŒ
(è{  
	gm_šÃrIndiûs
; }

74 
šlše
 cÚ¡ * 
_ou‹rIndexPŒ
(ècÚ¡ {  
	gm_ou‹rIndex
; }

75 
šlše
 * 
_ou‹rIndexPŒ
(è{  
	gm_ou‹rIndex
; }

78 
šlše
 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

80 cÚ¡ 
	gou‹r
 = 
RowMajÜ
 ? 
row
 : 
cŞ
;

81 cÚ¡ 
	gšÃr
 = 
RowMajÜ
 ? 
cŞ
 : 
row
;

83 
	g¡¬t
 = 
m_ou‹rIndex
[
ou‹r
];

84 
	g’d
 = 
m_ou‹rIndex
[
ou‹r
+1];

85 ià(
	g¡¬t
==
’d
)

86  
SÿÏr
(0);

87 ià(
	g’d
>0 && 
	gšÃr
==
m_šÃrIndiûs
[
’d
-1])

88  
m_v®ues
[
’d
-1];

92 cÚ¡ * 
	gr
 = 
¡d
::
low”_bound
(&
m_šÃrIndiûs
[
¡¬t
],&m_šÃrIndiûs[
’d
-1],
šÃr
);

93 cÚ¡ 
	gid
 = 
r
-&
m_šÃrIndiûs
[0];

94  ((*
	gr
==
šÃr
è&& (
id
<
’d
)è? 
m_v®ues
[id] : 
SÿÏr
(0);

97 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

99 cÚ¡ 
	gou‹r
 = 
RowMajÜ
 ? 
row
 : 
cŞ
;

100 cÚ¡ 
	gšÃr
 = 
RowMajÜ
 ? 
cŞ
 : 
row
;

102 
	g¡¬t
 = 
m_ou‹rIndex
[
ou‹r
];

103 
	g’d
 = 
m_ou‹rIndex
[
ou‹r
+1];

104 
ei_as£¹
(
’d
>=
¡¬t
 && "you…robably called coeffRef on‡‚on finalized matrix");

105 
ei_as£¹
(
’d
>
¡¬t
 && "coeffRef cannot be called on‡ zero coefficient");

106 * 
	gr
 = 
¡d
::
low”_bound
(&
m_šÃrIndiûs
[
¡¬t
],&m_šÃrIndiûs[
’d
],
šÃr
);

107 cÚ¡ 
	gid
 = 
r
-&
m_šÃrIndiûs
[0];

108 
ei_as£¹
((*
r
==
šÃr
è&& (
id
<
’d
) && "coeffRef cannot be called on‡ zero coefficient");

109  
	gm_v®ues
[
id
];

112 
şass
 
	gIÂ”I‹¿tÜ
;

115 
šlše
 
nÚZ”os
(ècÚ¡ {  
	gm_Âz
; }

117 
šlše
 
M­³dS·r£M©rix
(
rows
, 
cŞs
, 
Âz
, * 
ou‹rIndexPŒ
, * 
šÃrIndexPŒ
, 
SÿÏr
* 
v®uePŒ
)

118 : 
m_ou‹rSize
(
IsRowMajÜ
?
rows
:
cŞs
), 
m_šÃrSize
(IsRowMajÜ?cŞs:rows), 
m_Âz
(
Âz
), 
m_ou‹rIndex
(
ou‹rIndexPŒ
),

119 
m_šÃrIndiûs
(
šÃrIndexPŒ
), 
m_v®ues
(
v®uePŒ
)

122 #ifdeà
EIGEN_TAUCS_SUPPORT


123 
ex¶ic™
 
M­³dS·r£M©rix
(
ucs_ccs_m©rix
& 
ucsM©rix
);

126 #ifdeà
EIGEN_CHOLMOD_SUPPORT


127 
ex¶ic™
 
M­³dS·r£M©rix
(
chŞmod_¥¬£
& 
chŞmodM©rix
);

130 #ifdeà
EIGEN_SUPERLU_SUPPORT


131 
ex¶ic™
 
M­³dS·r£M©rix
(
SluM©rix
& 
¦uM©rix
);

135 
	gšlše
 ~
M­³dS·r£M©rix
() {}

138 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	g_FÏgs
>

139 
şass
 
	gM­³dS·r£M©rix
<
	gSÿÏr
,
	g_FÏgs
>::
IÂ”I‹¿tÜ


141 
public
:

142 
IÂ”I‹¿tÜ
(cÚ¡ 
M­³dS·r£M©rix
& 
m©
, 
ou‹r
)

143 : 
m_m©rix
(
m©
),

144 
m_ou‹r
(
ou‹r
),

145 
m_id
(
m©
.
_ou‹rIndexPŒ
()[
ou‹r
]),

146 
m_¡¬t
(
m_id
),

147 
m_’d
(
m©
.
_ou‹rIndexPŒ
()[
ou‹r
+1])

150 
	g‹m¶©e
<
	gAdded
, 
	gRemoved
>

151 
IÂ”I‹¿tÜ
(cÚ¡ 
FÏgged
<
M­³dS·r£M©rix
,
Added
,
Removed
>& 
m©
, 
ou‹r
)

152 : 
m_m©rix
(
m©
.
_ex´essiÚ
()), 
m_id
(m_m©rix.
_ou‹rIndexPŒ
()[
ou‹r
]),

153 
m_¡¬t
(
m_id
), 
m_’d
(
m_m©rix
.
_ou‹rIndexPŒ
()[
ou‹r
+1])

156 
šlše
 
	gIÂ”I‹¿tÜ
& 
	gİ”©Ü
++(è{ 
	gm_id
++;  *
	gthis
; }

158 
šlše
 
SÿÏr
 
v®ue
(ècÚ¡ {  
	gm_m©rix
.
_v®uePŒ
()[
m_id
]; }

159 
šlše
 
	gSÿÏr
& 
v®ueRef
(è{  
	gcÚ¡_ÿ¡
<SÿÏr&>(
	gm_m©rix
.
_v®uePŒ
()[
m_id
]); }

161 
šlše
 
šdex
(ècÚ¡ {  
	gm_m©rix
.
_šÃrIndexPŒ
()[
m_id
]; }

162 
šlše
 
row
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gm_ou‹r
 : 
šdex
(); }

163 
šlše
 
cŞ
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
šdex
(è: 
m_ou‹r
; }

165 
šlše
 
İ”©Ü
 
boŞ
(ècÚ¡ {  (
	gm_id
 < 
	gm_’d
è&& (m_id>=
m_¡¬t
); }

167 
	g´Ùeùed
:

168 cÚ¡ 
M­³dS·r£M©rix
& 
m_m©rix
;

169 cÚ¡ 
	gm_ou‹r
;

170 
	gm_id
;

171 cÚ¡ 
	gm_¡¬t
;

172 cÚ¡ 
	gm_’d
;

	@robot/Eigen/src/Sparse/RandomSetter.h

25 #iâdeà
EIGEN_RANDOMSETTER_H


26 
	#EIGEN_RANDOMSETTER_H


	)

32 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	sStdM­T¿™s


34 
	tKeyTy³
;

35 
	m¡d
::
	tm­
<
	tKeyTy³
,
	tSÿÏr
> 
	tTy³
;

37 
	mIsSÜ‹d
 = 1

40 
£tInv®idKey
(
Ty³
&, cÚ¡ 
KeyTy³
&) {}

43 #ifdeà
EIGEN_UNORDERED_MAP_SUPPORT


60 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	sStdUnÜd”edM­T¿™s


62 
	tKeyTy³
;

63 
	m¡d
::
	tunÜd”ed_m­
<
	tKeyTy³
,
	tSÿÏr
> 
	tTy³
;

65 
	mIsSÜ‹d
 = 0

68 
£tInv®idKey
(
Ty³
&, cÚ¡ 
KeyTy³
&) {}

72 #ifdeà
_DENSE_HASH_MAP_H_


77 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	sGoogËD’£HashM­T¿™s


79 
	tKeyTy³
;

80 
	mgoogË
::
	td’£_hash_m­
<
	tKeyTy³
,
	tSÿÏr
> 
	tTy³
;

82 
	mIsSÜ‹d
 = 0

85 
£tInv®idKey
(
Ty³
& 
m­
, cÚ¡ 
KeyTy³
& 
k
)

86 { 
	mm­
.
£t_em±y_key
(
k
); }

90 #ifdeà
_SPARSE_HASH_MAP_H_


95 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
> 
	sGoogËS·r£HashM­T¿™s


97 
	tKeyTy³
;

98 
	mgoogË
::
	t¥¬£_hash_m­
<
	tKeyTy³
,
	tSÿÏr
> 
	tTy³
;

100 
	mIsSÜ‹d
 = 0

103 
£tInv®idKey
(
Ty³
&, cÚ¡ 
KeyTy³
&) {}

157 
	g‹m¶©e
<
ty³Çme
 
	gS·r£M©rixTy³
,

158 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
şass
 
	gM­T¿™s
 =

159 #ià
defšed
 
_DENSE_HASH_MAP_H_


160 
GoogËD’£HashM­T¿™s


161 #–ià
defšed
 
_HASH_MAP


162 
GnuHashM­T¿™s


164 
StdM­T¿™s


166 ,
	gOu‹rPack‘B™s
 = 6>

167 şas 
	cRªdomS‘‹r


169 
ty³Çme
 
	tei_Œa™s
<
	tS·r£M©rixTy³
>::
	tSÿÏr
 Scalar;

170 
	sSÿÏrW¿µ”


172 
SÿÏrW¿µ”
(è: 
v®ue
(0) {}

173 
SÿÏr
 
v®ue
;

175 
ty³Çme
 
	tM­T¿™s
<
	tSÿÏrW¿µ”
>::
	tKeyTy³
 KeyType;

176 
ty³Çme
 
	tM­T¿™s
<
	tSÿÏrW¿µ”
>::
	tTy³
 
	tHashM­Ty³
;

177 cÚ¡ 
	gOu‹rPack‘Mask
 = (1 << 
Ou‹rPack‘B™s
) - 1;

179 
	gSw­StÜage
 = 1 - 
M­T¿™s
<
SÿÏrW¿µ”
>::
IsSÜ‹d
,

180 
	gT¬g‘RowMajÜ
 = (
S·r£M©rixTy³
::
FÏgs
 & 
RowMajÜB™
) ? 1 : 0,

181 
	gS‘‹rRowMajÜ
 = 
Sw­StÜage
 ? 1-
T¬g‘RowMajÜ
 : TargetRowMajor,

182 
	gIsUµ”TrŸnguÏr
 = 
S·r£M©rixTy³
::
FÏgs
 & 
Uµ”TrŸnguÏrB™
,

183 
	gIsLow”TrŸnguÏr
 = 
S·r£M©rixTy³
::
FÏgs
 & 
Low”TrŸnguÏrB™


186 
	gpublic
:

194 
šlše
 
	$RªdomS‘‹r
(
S·r£M©rixTy³
& 
rg‘
)

195 : 
	$mp_rg‘
(&
rg‘
)

197 cÚ¡ 
ou‹rSize
 = 
Sw­StÜage
 ? 
rg‘
.
	`šÃrSize
(è:¬g‘.
	`ou‹rSize
();

198 cÚ¡ 
šÃrSize
 = 
Sw­StÜage
 ? 
rg‘
.
	`ou‹rSize
(è:¬g‘.
	`šÃrSize
();

199 
m_ou‹rPack‘s
 = 
ou‹rSize
 >> 
Ou‹rPack‘B™s
;

200 ià(
ou‹rSize
&
Ou‹rPack‘Mask
)

201 
m_ou‹rPack‘s
 += 1;

202 
m_hashm­s
 = 
Ãw
 
HashM­Ty³
[
m_ou‹rPack‘s
];

204 
aux
 = 
šÃrSize
 - 1;

205 
m_keyB™sOff£t
 = 0;

206 
aux
)

208 ++
m_keyB™sOff£t
;

209 
aux
 =‡ux >> 1;

211 
KeyTy³
 
ik
 = (1<<(
Ou‹rPack‘B™s
+
m_keyB™sOff£t
));

212 
k
=0; k<
m_ou‹rPack‘s
; ++k)

213 
M­T¿™s
<
SÿÏrW¿µ”
>::
	`£tInv®idKey
(
m_hashm­s
[
k
],
ik
);

216 
j
=0; j<
mp_rg‘
->
	`ou‹rSize
(); ++j)

217 
ty³Çme
 
S·r£M©rixTy³
::
IÂ”I‹¿tÜ
 
	`™
(*
mp_rg‘
,
j
); 
™
; ++it)

218 (*
this
)(
T¬g‘RowMajÜ
?
j
:
™
.
	`šdex
(), T¬g‘RowMajÜ?™.šdex():jèğ™.
	`v®ue
();

219 
	}
}

222 ~
	$RªdomS‘‹r
()

224 
KeyTy³
 
keyB™sMask
 = (1<<
m_keyB™sOff£t
)-1;

225 ià(!
Sw­StÜage
)

227 
mp_rg‘
->
	`¡¬tFl
(
	`nÚZ”os
());

228 
k
=0; k<
m_ou‹rPack‘s
; ++k)

230 cÚ¡ 
ou‹rOff£t
 = (1<<
Ou‹rPack‘B™s
è* 
k
;

231 
ty³Çme
 
HashM­Ty³
::
™”©Ü
 
’d
 = 
m_hashm­s
[
k
].
	`’d
();

232 
ty³Çme
 
HashM­Ty³
::
™”©Ü
 
™
 = 
m_hashm­s
[
k
].
	`begš
(); it!=
’d
; ++it)

234 cÚ¡ 
ou‹r
 = (
™
->
fœ¡
 >> 
m_keyB™sOff£t
è+ 
ou‹rOff£t
;

235 cÚ¡ 
šÃr
 = 
™
->
fœ¡
 & 
keyB™sMask
;

236 
mp_rg‘
->
	`fl
(
T¬g‘RowMajÜ
 ? 
ou‹r
 : 
šÃr
, T¬g‘RowMajÜ ? iÂ” : ou‹rèğ
™
->
£cÚd
.
v®ue
;

239 
mp_rg‘
->
	`’dFl
();

243 
VeùÜXi
 
	`pos™iÚs
(
mp_rg‘
->
	`ou‹rSize
());

244 
pos™iÚs
.
	`£tZ”o
();

246 
k
=0; k<
m_ou‹rPack‘s
; ++k)

248 
ty³Çme
 
HashM­Ty³
::
™”©Ü
 
’d
 = 
m_hashm­s
[
k
].
	`’d
();

249 
ty³Çme
 
HashM­Ty³
::
™”©Ü
 
™
 = 
m_hashm­s
[
k
].
	`begš
(); it!=
’d
; ++it)

251 cÚ¡ 
ou‹r
 = 
™
->
fœ¡
 & 
keyB™sMask
;

252 ++
pos™iÚs
[
ou‹r
];

256 
couÁ
 = 0;

257 
j
=0; j<
mp_rg‘
->
	`ou‹rSize
(); ++j)

259 
tmp
 = 
pos™iÚs
[
j
];

260 
mp_rg‘
->
	`_ou‹rIndexPŒ
()[
j
] = 
couÁ
;

261 
pos™iÚs
[
j
] = 
couÁ
;

262 
couÁ
 +ğ
tmp
;

264 
mp_rg‘
->
	`_ou‹rIndexPŒ
()[mp_rg‘->
	`ou‹rSize
()] = 
couÁ
;

265 
mp_rg‘
->
	`»sizeNÚZ”os
(
couÁ
);

267 
k
=0; k<
m_ou‹rPack‘s
; ++k)

269 cÚ¡ 
ou‹rOff£t
 = (1<<
Ou‹rPack‘B™s
è* 
k
;

270 
ty³Çme
 
HashM­Ty³
::
™”©Ü
 
’d
 = 
m_hashm­s
[
k
].
	`’d
();

271 
ty³Çme
 
HashM­Ty³
::
™”©Ü
 
™
 = 
m_hashm­s
[
k
].
	`begš
(); it!=
’d
; ++it)

273 cÚ¡ 
šÃr
 = (
™
->
fœ¡
 >> 
m_keyB™sOff£t
è+ 
ou‹rOff£t
;

274 cÚ¡ 
ou‹r
 = 
™
->
fœ¡
 & 
keyB™sMask
;

279 
posS¹
 = 
mp_rg‘
->
	`_ou‹rIndexPŒ
()[
ou‹r
];

280 
i
 = (
pos™iÚs
[
ou‹r
]++) - 1;

281  (
i
 >ğ
posS¹
è&& (
mp_rg‘
->
	`_šÃrIndexPŒ
()[i] > 
šÃr
) )

283 
mp_rg‘
->
	`_v®uePŒ
()[
i
+1] = mp_target->_valuePtr()[i];

284 
mp_rg‘
->
	`_šÃrIndexPŒ
()[
i
+1] = mp_target->_innerIndexPtr()[i];

285 --
i
;

287 
mp_rg‘
->
	`_šÃrIndexPŒ
()[
i
+1] = 
šÃr
;

288 
mp_rg‘
->
	`_v®uePŒ
()[
i
+1] = 
™
->
£cÚd
.
v®ue
;

292 
d–‘e
[] 
m_hashm­s
;

293 
	}
}

296 
	gSÿÏr
& 
	$İ”©Ü
(è(
row
, 
cŞ
)

298 
	`ei_as£¹
(((!
IsUµ”TrŸnguÏr
è|| (
row
<=
cŞ
)) && "Invalid‡ccesso‡n upperriangular matrix");

299 
	`ei_as£¹
(((!
IsLow”TrŸnguÏr
è|| (
cŞ
<=
row
)) && "Invalid‡ccesso‡n upperriangular matrix");

300 cÚ¡ 
ou‹r
 = 
S‘‹rRowMajÜ
 ? 
row
 : 
cŞ
;

301 cÚ¡ 
šÃr
 = 
S‘‹rRowMajÜ
 ? 
cŞ
 : 
row
;

302 cÚ¡ 
ou‹rMajÜ
 = 
ou‹r
 >> 
Ou‹rPack‘B™s
;

303 cÚ¡ 
ou‹rMšÜ
 = 
ou‹r
 & 
Ou‹rPack‘Mask
;

304 cÚ¡ 
KeyTy³
 
key
 = (
	`KeyTy³
(
ou‹rMšÜ
)<<
m_keyB™sOff£t
è| 
šÃr
;

305  
m_hashm­s
[
ou‹rMajÜ
][
key
].
v®ue
;

306 
	}
}

313 
	$nÚZ”os
() const

315 
nz
 = 0;

316 
k
=0; k<
m_ou‹rPack‘s
; ++k)

317 
nz
 +ğ
m_hashm­s
[
k
].
	`size
();

318  
nz
;

319 
	}
}

322 
	g´Ùeùed
:

324 
HashM­Ty³
* 
m_hashm­s
;

325 
S·r£M©rixTy³
* 
	gmp_rg‘
;

326 
	gm_ou‹rPack‘s
;

327 
	gm_keyB™sOff£t
;

	@robot/Eigen/src/Sparse/SparseAssign.h

	@robot/Eigen/src/Sparse/SparseBlock.h

26 #iâdeà
EIGEN_SPARSE_BLOCK_H


27 
	#EIGEN_SPARSE_BLOCK_H


	)

29 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gSize
>

30 
	gei_Œa™s
<
	gS·r£IÂ”VeùÜS‘
<
	gM©rixTy³
, 
	gSize
> >

32 
ty³Çme
 
	tei_Œa™s
<
	tM©rixTy³
>::
	tSÿÏr
 Scalar;

34 
	gIsRowMajÜ
 = ((
M©rixTy³
::
FÏgs
)&
RowMajÜB™
)==RowMajorBit,

35 
	gFÏgs
 = 
M©rixTy³
::
FÏgs
,

36 
	gRowsAtCompeTime
 = 
IsRowMajÜ
 ? 
Size
 : 
M©rixTy³
::
RowsAtCompeTime
,

37 
	gCŞsAtCompeTime
 = 
IsRowMajÜ
 ? 
M©rixTy³
::
CŞsAtCompeTime
 : 
Size
,

38 
	gCÛffR—dCo¡
 = 
M©rixTy³
::
CÛffR—dCo¡


42 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gSize
>

43 
şass
 
	gS·r£IÂ”VeùÜS‘
 : 
ei_no_assignm’t_İ”©Ü
,

44 
public
 
	gS·r£M©rixBa£
<
	gS·r£IÂ”VeùÜS‘
<
	gM©rixTy³
, 
	gSize
> >

46 ’um { 
	gIsRowMajÜ
 = 
ei_Œa™s
<
S·r£IÂ”VeùÜS‘
>::
IsRowMajÜ
 };

47 
	gpublic
:

49 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£IÂ”VeùÜS‘
)

50 şas 
	cIÂ”I‹¿tÜ
: 
public
 
M©rixTy³
::
IÂ”I‹¿tÜ


52 
public
:

53 
šlše
 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£IÂ”VeùÜS‘
& 
x´
, 
ou‹r
)

54 : 
M©rixTy³
::
IÂ”I‹¿tÜ
(
x´
.
m_m©rix
, x´.
m_ou‹rS¹
 + 
ou‹r
)

57 
	g´iv©e
:

58 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

61 
šlše
 
	$S·r£IÂ”VeùÜS‘
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
ou‹rS¹
, 
ou‹rSize
)

62 : 
	`m_m©rix
(
m©rix
), 
	`m_ou‹rS¹
(
ou‹rS¹
), 
	$m_ou‹rSize
(
ou‹rSize
)

64 
	`ei_as£¹
Ğ(
ou‹rS¹
>=0è&& ((ou‹rS¹+
ou‹rSize
)<=
m©rix
.
	`ou‹rSize
()) );

65 
	}
}

67 
šlše
 
	$S·r£IÂ”VeùÜS‘
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
ou‹r
)

68 : 
	`m_m©rix
(
m©rix
), 
	`m_ou‹rS¹
(
ou‹r
), 
	$m_ou‹rSize
(
Size
)

70 
	`ei_as£¹
(
Size
!=
DyÇmic
);

71 
	`ei_as£¹
Ğ(
ou‹r
>=0è&& (ou‹r<
m©rix
.
	`ou‹rSize
()) );

72 
	}
}

86 
EIGEN_STRONG_INLINE
 
	$rows
(ècÚ¡ {  
IsRowMajÜ
 ? 
m_ou‹rSize
.
	`v®ue
(è: 
m_m©rix
.
	`rows
(); 
	}
}

87 
EIGEN_STRONG_INLINE
 
	$cŞs
(ècÚ¡ {  
IsRowMajÜ
 ? 
m_m©rix
.
	`cŞs
(è: 
m_ou‹rSize
.
	`v®ue
(); 
	}
}

89 
	g´Ùeùed
:

91 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

92 
	gm_ou‹rS¹
;

93 cÚ¡ 
	gei_št_if_dyÇmic
<
	gSize
> 
	gm_ou‹rSize
;

101 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_O±iÚs
, 
	gSize
>

102 
şass
 
	gS·r£IÂ”VeùÜS‘
<
	gDyÇmicS·r£M©rix
<
	g_SÿÏr
, 
	g_O±iÚs
>, 
	gSize
>

103 : 
public
 
S·r£M©rixBa£
<
S·r£IÂ”VeùÜS‘
<
DyÇmicS·r£M©rix
<
_SÿÏr
, 
	g_O±iÚs
>, 
	gSize
> >

105 
	gDyÇmicS·r£M©rix
<
	t_SÿÏr
, 
	t_O±iÚs
> 
	tM©rixTy³
;

106 ’um { 
	gIsRowMajÜ
 = 
ei_Œa™s
<
S·r£IÂ”VeùÜS‘
>::
IsRowMajÜ
 };

107 
	gpublic
:

109 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£IÂ”VeùÜS‘
)

110 şas 
	cIÂ”I‹¿tÜ
: 
public
 
M©rixTy³
::
IÂ”I‹¿tÜ


112 
public
:

113 
šlše
 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£IÂ”VeùÜS‘
& 
x´
, 
ou‹r
)

114 : 
M©rixTy³
::
IÂ”I‹¿tÜ
(
x´
.
m_m©rix
, x´.
m_ou‹rS¹
 + 
ou‹r
)

116 
	g´iv©e
:

117 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

120 
šlše
 
	$S·r£IÂ”VeùÜS‘
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
ou‹rS¹
, 
ou‹rSize
)

121 : 
	`m_m©rix
(
m©rix
), 
	`m_ou‹rS¹
(
ou‹rS¹
), 
	$m_ou‹rSize
(
ou‹rSize
)

123 
	`ei_as£¹
Ğ(
ou‹rS¹
>=0è&& ((ou‹rS¹+
ou‹rSize
)<=
m©rix
.
	`ou‹rSize
()) );

124 
	}
}

126 
šlše
 
	$S·r£IÂ”VeùÜS‘
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
ou‹r
)

127 : 
	`m_m©rix
(
m©rix
), 
	`m_ou‹rS¹
(
ou‹r
), 
	$m_ou‹rSize
(
Size
)

129 
	`ei_as£¹
(
Size
!=
DyÇmic
);

130 
	`ei_as£¹
Ğ(
ou‹r
>=0è&& (ou‹r<
m©rix
.
	`ou‹rSize
()) );

131 
	}
}

133 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

134 
šlše
 
	gS·r£IÂ”VeùÜS‘
& 
	gİ”©Ü
=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

136 ià(
IsRowMajÜ
 !ğ((
Oth”D”ived
::
FÏgs
&
RowMajÜB™
)==RowMajorBit))

139 
DyÇmicS·r£M©rix
<
SÿÏr
,
IsRowMajÜ
?
RowMajÜB™
:0> 
aux
(
Ùh”
);

140 *
	gthis
 = 
aux
.
m¬kAsRV®ue
();

145 
	gj
=0; j<
	gm_ou‹rSize
.
v®ue
(); ++j)

147 
	gS·r£VeùÜ
<
	gSÿÏr
,
	gIsRowMajÜ
 ? 
	gRowMajÜB™
 : 0> 
aux
(
Ùh”
.
šÃrVeùÜ
(
j
));

148 
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
_d©a
()[
m_ou‹rS¹
+
j
].
sw­
(
aux
._data());

151  *
	gthis
;

154 
šlše
 
	gS·r£IÂ”VeùÜS‘
& 
	gİ”©Ü
=(cÚ¡ 
S·r£IÂ”VeùÜS‘
& 
Ùh”
)

156  
İ”©Ü
=<
S·r£IÂ”VeùÜS‘
>(
Ùh”
);

165 
EIGEN_STRONG_INLINE
 
	$rows
(ècÚ¡ {  
IsRowMajÜ
 ? 
m_ou‹rSize
.
	`v®ue
(è: 
m_m©rix
.
	`rows
(); 
	}
}

166 
EIGEN_STRONG_INLINE
 
	$cŞs
(ècÚ¡ {  
IsRowMajÜ
 ? 
m_m©rix
.
	`cŞs
(è: 
m_ou‹rSize
.
	`v®ue
(); 
	}
}

168 
	g´Ùeùed
:

170 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

171 
	gm_ou‹rS¹
;

172 cÚ¡ 
	gei_št_if_dyÇmic
<
	gSize
> 
	gm_ou‹rSize
;

263 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

264 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
	gS·r£M©rixBa£
<D”ived>::
	$row
(
i
)

266 
	`EIGEN_STATIC_ASSERT
(
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_ROW_MAJOR_MATRICES
);

267  
	`šÃrVeùÜ
(
i
);

268 
	}
}

272 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

273 cÚ¡ 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
	gS·r£M©rixBa£
<D”ived>::
	$row
(
i
) const

275 
	`EIGEN_STATIC_ASSERT
(
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_ROW_MAJOR_MATRICES
);

276  
	`šÃrVeùÜ
(
i
);

277 
	}
}

280 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

281 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
	gS·r£M©rixBa£
<D”ived>::
	$cŞ
(
i
)

283 
	`EIGEN_STATIC_ASSERT
(!
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_COLUMN_MAJOR_MATRICES
);

284  
	`šÃrVeùÜ
(
i
);

285 
	}
}

289 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

290 cÚ¡ 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
	gS·r£M©rixBa£
<D”ived>::
	$cŞ
(
i
) const

292 
	`EIGEN_STATIC_ASSERT
(!
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_COLUMN_MAJOR_MATRICES
);

293  
	`šÃrVeùÜ
(
i
);

294 
	}
}

299 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

300 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
	gS·r£M©rixBa£
<D”ived>::
	$šÃrVeùÜ
(
ou‹r
)

301 {  
S·r£IÂ”VeùÜS‘
<
D”ived
,1>(
	`d”ived
(), 
ou‹r
); 
	}
}

306 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

307 cÚ¡ 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
	gS·r£M©rixBa£
<D”ived>::
	$šÃrVeùÜ
(
ou‹r
) const

308 {  
S·r£IÂ”VeùÜS‘
<
D”ived
,1>(
	`d”ived
(), 
ou‹r
); 
	}
}

313 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

314 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,
	gDyÇmic
> 
	gS·r£M©rixBa£
<D”ived>::
	$subrows
(
¡¬t
, 
size
)

316 
	`EIGEN_STATIC_ASSERT
(
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_ROW_MAJOR_MATRICES
);

317  
	`šÃrVeùÜs
(
¡¬t
, 
size
);

318 
	}
}

322 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

323 cÚ¡ 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,
	gDyÇmic
> 
	gS·r£M©rixBa£
<D”ived>::
	$subrows
(
¡¬t
, 
size
) const

325 
	`EIGEN_STATIC_ASSERT
(
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_ROW_MAJOR_MATRICES
);

326  
	`šÃrVeùÜs
(
¡¬t
, 
size
);

327 
	}
}

330 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

331 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,
	gDyÇmic
> 
	gS·r£M©rixBa£
<D”ived>::
	$subcŞs
(
¡¬t
, 
size
)

333 
	`EIGEN_STATIC_ASSERT
(!
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_COLUMN_MAJOR_MATRICES
);

334  
	`šÃrVeùÜs
(
¡¬t
, 
size
);

335 
	}
}

339 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

340 cÚ¡ 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,
	gDyÇmic
> 
	gS·r£M©rixBa£
<D”ived>::
	$subcŞs
(
¡¬t
, 
size
) const

342 
	`EIGEN_STATIC_ASSERT
(!
IsRowMajÜ
,
THIS_METHOD_IS_ONLY_FOR_COLUMN_MAJOR_MATRICES
);

343  
	`šÃrVeùÜs
(
¡¬t
, 
size
);

344 
	}
}

349 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

350 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,
	gDyÇmic
> 
	gS·r£M©rixBa£
<D”ived>::
	$šÃrVeùÜs
(
ou‹rS¹
, 
ou‹rSize
)

351 {  
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
>(
	`d”ived
(), 
ou‹rS¹
, 
ou‹rSize
); 
	}
}

356 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

357 cÚ¡ 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,
	gDyÇmic
> 
	gS·r£M©rixBa£
<D”ived>::
	$šÃrVeùÜs
(
ou‹rS¹
, 
ou‹rSize
) const

358 {  
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
>(
	`d”ived
(), 
ou‹rS¹
, 
ou‹rSize
); 
	}
}

361 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBlockRows
, 
	gBlockCŞs
, 
	gPack‘Acûss
>

362 
şass
 
	gBlock
<
	gM©rixTy³
,
	gBlockRows
,
	gBlockCŞs
,
	gPack‘Acûss
,
	gIsS·r£
>

363 : 
public
 
S·r£M©rixBa£
<
Block
<
M©rixTy³
,
	gBlockRows
,
	gBlockCŞs
,
	gPack‘Acûss
,
	gIsS·r£
> >

365 
	gpublic
:

367 
_EIGEN_GENERIC_PUBLIC_INTERFACE
(
Block
, 
S·r£M©rixBa£
<Block>)

368 
şass
 
	gIÂ”I‹¿tÜ
;

372 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
i
)

373 : 
m_m©rix
(
m©rix
),

378 
m_¡¬tRow
Ğ(
BlockRows
==1è&& (
BlockCŞs
==
M©rixTy³
::
CŞsAtCompeTime
è? 
i
 : 0),

379 
m_¡¬tCŞ
Ğ(
BlockRows
==
M©rixTy³
::
RowsAtCompeTime
è&& (
BlockCŞs
==1è? 
i
 : 0),

380 
m_blockRows
(
m©rix
.
rows
()),

381 
m_blockCŞs
(
m©rix
.
cŞs
())

383 
ei_as£¹
Ğ(
i
>=0) && (

384 ((
BlockRows
==1è&& (
BlockCŞs
==
M©rixTy³
::
CŞsAtCompeTime
è&& 
i
<
m©rix
.
rows
())

385 ||((
BlockRows
==
M©rixTy³
::
RowsAtCompeTime
è&& (
BlockCŞs
==1è&& 
i
<
m©rix
.
cŞs
())));

390 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
¡¬tRow
, 
¡¬tCŞ
)

391 : 
m_m©rix
(
m©rix
), 
m_¡¬tRow
(
¡¬tRow
), 
m_¡¬tCŞ
(
¡¬tCŞ
),

392 
m_blockRows
(
m©rix
.
rows
()), 
m_blockCŞs
(m©rix.
cŞs
())

394 
EIGEN_STATIC_ASSERT
(
RowsAtCompeTime
!=
DyÇmic
 && RowsAtCompeTime!=DyÇmic,
THIS_METHOD_IS_ONLY_FOR_FIXED_SIZE
)

395 
ei_as£¹
(
¡¬tRow
 >ğ0 && 
BlockRows
 >ğ1 && s¹Row + BlockRow <ğ
m©rix
.
rows
()

396 && 
¡¬tCŞ
 >ğ0 && 
BlockCŞs
 >ğ1 && s¹CŞ + BlockCŞ <ğ
m©rix
.
cŞs
());

401 
šlše
 
Block
(cÚ¡ 
M©rixTy³
& 
m©rix
,

402 
¡¬tRow
, 
¡¬tCŞ
,

403 
blockRows
, 
blockCŞs
)

404 : 
m_m©rix
(
m©rix
), 
m_¡¬tRow
(
¡¬tRow
), 
m_¡¬tCŞ
(
¡¬tCŞ
),

405 
m_blockRows
(
blockRows
), 
m_blockCŞs
(
blockCŞs
)

407 
ei_as£¹
((
RowsAtCompeTime
==
DyÇmic
 || RowsAtCompeTime==
blockRows
)

408 && (
CŞsAtCompeTime
==
DyÇmic
 || CŞsAtCompeTime==
blockCŞs
));

409 
ei_as£¹
(
¡¬tRow
 >ğ0 && 
blockRows
 >ğ1 && s¹Row + blockRow <ğ
m©rix
.
rows
()

410 && 
¡¬tCŞ
 >ğ0 && 
blockCŞs
 >ğ1 && s¹CŞ + blockCŞ <ğ
m©rix
.
cŞs
());

413 
šlše
 
rows
(ècÚ¡ {  
	gm_blockRows
.
v®ue
(); }

414 
šlše
 
cŞs
(ècÚ¡ {  
	gm_blockCŞs
.
v®ue
(); }

416 
šlše
 
¡ride
(ècÚ¡ {  
	gm_m©rix
.stride(); }

418 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

420  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
()

421 .
cÛffRef
(
row
 + 
m_¡¬tRow
.
v®ue
(), 
cŞ
 + 
m_¡¬tCŞ
.value());

424 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

426  
	gm_m©rix
.
cÛff
(
row
 + 
m_¡¬tRow
.
v®ue
(), 
cŞ
 + 
m_¡¬tCŞ
.value());

429 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

431  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
()

432 .
cÛffRef
(
m_¡¬tRow
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 0 : 
šdex
),

433 
m_¡¬tCŞ
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 
šdex
 : 0));

436 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

438  
	gm_m©rix


439 .
cÛff
(
m_¡¬tRow
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 0 : 
šdex
),

440 
m_¡¬tCŞ
.
v®ue
(è+ (
RowsAtCompeTime
 =ğ1 ? 
šdex
 : 0));

443 
	g´Ùeùed
:

445 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

446 cÚ¡ 
	gei_št_if_dyÇmic
<
	gM©rixTy³
::
RowsAtCompeTime
 =ğ1 ? 0 : 
DyÇmic
> 
m_¡¬tRow
;

447 cÚ¡ 
	gei_št_if_dyÇmic
<
	gM©rixTy³
::
CŞsAtCompeTime
 =ğ1 ? 0 : 
DyÇmic
> 
m_¡¬tCŞ
;

448 cÚ¡ 
	gei_št_if_dyÇmic
<
	gRowsAtCompeTime
> 
	gm_blockRows
;

449 cÚ¡ 
	gei_št_if_dyÇmic
<
	gCŞsAtCompeTime
> 
	gm_blockCŞs
;

	@robot/Eigen/src/Sparse/SparseCwise.h

26 #iâdeà
EIGEN_SPARSE_CWISE_H


27 
	#EIGEN_SPARSE_CWISE_H


	)

31 
	#EIGEN_SPARSE_CWISE_BINOP_RETURN_TYPE
(
OP
) \

32 
Cwi£Bš¬yOp
<
OP
<
ty³Çme
 
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
>, Ex´essiÚTy³, 
Oth”D”ived
>

	)

34 
	#EIGEN_SPARSE_CWISE_PRODUCT_RETURN_TYPE
 \

35 
S·r£Cwi£Bš¬yOp
< \

36 
ei_sÿÏr_´oduù_İ
< \

37 
ty³Çme
 
ei_sÿÏr_´oduù_Œa™s
< \

38 
ty³Çme
 
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
, \

39 
ty³Çme
 
ei_Œa™s
<
Oth”D”ived
>::
SÿÏr
 \

40 >::
R‘uºTy³
 \

42 
Ex´essiÚTy³
, \

43 
Oth”D”ived
 \

44 >

	)

48 
	#EIGEN_SPARSE_CWISE_UNOP_RETURN_TYPE
(
OP
) \

49 
S·r£Cwi£UÇryOp
<
OP
<
ty³Çme
 
ei_Œa™s
<
Ex´essiÚTy³
>::
SÿÏr
>, Ex´essiÚTy³>

	)

57 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
> cÏs 
	cS·r£Cwi£


59 
	mpublic
:

61 
ty³Çme
 
	tei_Œa™s
<
	tEx´essiÚTy³
>::
	tSÿÏr
 Scalar;

62 
ty³Çme
 
	tei_m‘a_if
<
	tei_mu¡_Ã¡_by_v®ue
<
	tEx´essiÚTy³
>::
	t»t
,

63 
	tEx´essiÚTy³
, cÚ¡ Ex´essiÚTy³&>::
	t»t
 
	tEx´essiÚTy³Ne¡ed
;

64 
	mCwi£UÇryOp
<
	tei_sÿÏr_add_İ
<
	tSÿÏr
>, 
	tEx´essiÚTy³
> 
	tSÿÏrAddR‘uºTy³
;

66 
šlše
 
	$S·r£Cwi£
(cÚ¡ 
Ex´essiÚTy³
& 
m©rix
è: 
	$m_m©rix
(
m©rix
) {}

69 
šlše
 cÚ¡ 
Ex´essiÚTy³
& 
	$_ex´essiÚ
(ècÚ¡ {  
m_m©rix
; 
	}
}

71 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

72 cÚ¡ 
EIGEN_SPARSE_CWISE_PRODUCT_RETURN_TYPE


73 
	gİ”©Ü
*(cÚ¡ 
	gS·r£M©rixBa£
<
	gOth”D”ived
> &
	gÙh”
) const;

75 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

76 cÚ¡ 
EIGEN_SPARSE_CWISE_PRODUCT_RETURN_TYPE


77 
	gİ”©Ü
*(cÚ¡ 
	gM©rixBa£
<
	gOth”D”ived
> &
	gÙh”
) const;

87 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

88 cÚ¡ 
	$EIGEN_SPARSE_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_mš_İ
)

89 
	`mš
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

91 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

92 cÚ¡ 
	$EIGEN_SPARSE_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_max_İ
)

93 
	`max
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

95 cÚ¡ 
	$EIGEN_SPARSE_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs_İ
è
	$abs
() const;

96 cÚ¡ 
	$EIGEN_SPARSE_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs2_İ
è
	$abs2
() const;

107 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
>

108 
šlše
 
Ex´essiÚTy³
& 
İ”©Ü
*=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
);

153 #ifdeà
EIGEN_SPARSE_CWISE_PLUGIN


154 #šşud
EIGEN_SPARSE_CWISE_PLUGIN


157 
´Ùeùed
:

158 
Ex´essiÚTy³Ne¡ed
 
m_m©rix
;

160 
´iv©e
:

161 
S·r£Cwi£
& 
İ”©Ü
=(const SparseCwise&);

162 
	}
};

164 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

165 
šlše
 cÚ¡ 
	gS·r£Cwi£
<
	gD”ived
>

166 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$cwi£
() const

168  
	`d”ived
();

169 
	}
}

171 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

172 
šlše
 
	gS·r£Cwi£
<
	gD”ived
>

173 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$cwi£
()

175  
	`d”ived
();

176 
	}
}

	@robot/Eigen/src/Sparse/SparseCwiseBinaryOp.h

25 #iâdeà
EIGEN_SPARSE_CWISE_BINARY_OP_H


26 
	#EIGEN_SPARSE_CWISE_BINARY_OP_H


	)

45 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
>

46 
	gei_Œa™s
<
	gS·r£Cwi£Bš¬yOp
<
	gBš¬yOp
, 
	gLhs
, 
	gRhs
> >

48 
ty³Çme
 
	tei_»suÉ_of
<

49 
	tBš¬yOp
(

50 
	tty³Çme
 
	tLhs
::
	tSÿÏr
,

51 
	tty³Çme
 
	tRhs
::
	tSÿÏr


53 >::
	tty³
 
	tSÿÏr
;

54 
ty³Çme
 
	tLhs
::
	tNe¡ed
 
	tLhsNe¡ed
;

55 
ty³Çme
 
	tRhs
::
	tNe¡ed
 
	tRhsNe¡ed
;

56 
ty³Çme
 
	tei_uÄef
<
	tLhsNe¡ed
>::
	tty³
 
	t_LhsNe¡ed
;

57 
ty³Çme
 
	tei_uÄef
<
	tRhsNe¡ed
>::
	tty³
 
	t_RhsNe¡ed
;

59 
	gLhsCÛffR—dCo¡
 = 
_LhsNe¡ed
::
CÛffR—dCo¡
,

60 
	gRhsCÛffR—dCo¡
 = 
_RhsNe¡ed
::
CÛffR—dCo¡
,

61 
	gLhsFÏgs
 = 
_LhsNe¡ed
::
FÏgs
,

62 
	gRhsFÏgs
 = 
_RhsNe¡ed
::
FÏgs
,

63 
	gRowsAtCompeTime
 = 
Lhs
::
RowsAtCompeTime
,

64 
	gCŞsAtCompeTime
 = 
Lhs
::
CŞsAtCompeTime
,

65 
	gMaxRowsAtCompeTime
 = 
Lhs
::
MaxRowsAtCompeTime
,

66 
	gMaxCŞsAtCompeTime
 = 
Lhs
::
MaxCŞsAtCompeTime
,

67 
	gFÏgs
 = ((
LhsFÏgs
è| (
RhsFÏgs
)è& 
H”ed™¬yB™s
,

68 
	gCÛffR—dCo¡
 = 
LhsCÛffR—dCo¡
 + 
RhsCÛffR—dCo¡
 + 
ei_funùÜ_Œa™s
<
Bš¬yOp
>::
Co¡


72 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
>

73 
şass
 
	gS·r£Cwi£Bš¬yOp
 : 
ei_no_assignm’t_İ”©Ü
,

74 
public
 
	gS·r£M©rixBa£
<
	gS·r£Cwi£Bš¬yOp
<
	gBš¬yOp
, 
	gLhs
, 
	gRhs
> >

76 
	gpublic
:

78 
şass
 
IÂ”I‹¿tÜ
;

80 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£Cwi£Bš¬yOp
)

81 
ty³Çme
 
	tei_Œa™s
<
	tS·r£Cwi£Bš¬yOp
>::
	tLhsNe¡ed
 LhsNested;

82 
ty³Çme
 
	tei_Œa™s
<
	tS·r£Cwi£Bš¬yOp
>::
	tRhsNe¡ed
 RhsNested;

83 
ty³Çme
 
	tei_uÄef
<
	tLhsNe¡ed
>::
	tty³
 
	t_LhsNe¡ed
;

84 
ty³Çme
 
	tei_uÄef
<
	tRhsNe¡ed
>::
	tty³
 
	t_RhsNe¡ed
;

86 
EIGEN_STRONG_INLINE
 
S·r£Cwi£Bš¬yOp
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, cÚ¡ 
Bš¬yOp
& 
func
 = BinaryOp())

87 : 
m_lhs
(
lhs
), 
m_rhs
(
rhs
), 
m_funùÜ
(
func
)

89 
EIGEN_STATIC_ASSERT
((
_LhsNe¡ed
::
FÏgs
&
RowMajÜB™
)==(
_RhsNe¡ed
::Flags&RowMajorBit),

90 
BOTH_MATRICES_MUST_HAVE_THE_SAME_STORAGE_ORDER
)

91 
EIGEN_STATIC_ASSERT
((
ei_funùÜ_®lows_mixšg_»®_ªd_com¶ex
<
Bš¬yOp
>::
»t


92 ? (
ei_is_§me_ty³
<
ty³Çme
 
Lhs
::
R—lSÿÏr
,y³Çm
Rhs
::R—lSÿÏr>::
»t
)

93 : (
ei_is_§me_ty³
<
ty³Çme
 
Lhs
::
SÿÏr
,y³Çm
Rhs
::SÿÏr>::
»t
)),

94 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

96 
EIGEN_STATIC_ASSERT_SAME_MATRIX_SIZE
(
Lhs
, 
Rhs
)

97 
ei_as£¹
(
lhs
.
rows
(è=ğ
rhs
.rows(è&&†hs.
cŞs
() ==„hs.cols());

100 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_lhs
.rows(); }

101 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_lhs
.cols(); }

103 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_LhsNe¡ed
& 
lhs
(ècÚ¡ {  
	gm_lhs
; }

104 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_RhsNe¡ed
& 
rhs
(ècÚ¡ {  
	gm_rhs
; }

105 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gBš¬yOp
& 
funùÜ
(ècÚ¡ {  
	gm_funùÜ
; }

107 
	g´Ùeùed
:

108 cÚ¡ 
LhsNe¡ed
 
m_lhs
;

109 cÚ¡ 
RhsNe¡ed
 
	gm_rhs
;

110 cÚ¡ 
Bš¬yOp
 
	gm_funùÜ
;

113 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
,y³Çm
	gD”ived
,

114 
	g_LhsStÜageMode
 = (
Lhs
::
FÏgs
è& 
S·r£B™
,

115 
	g_RhsStÜageMode
 = (
Rhs
::
FÏgs
è& 
S·r£B™
>

116 
şass
 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
;

118 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
>

119 
şass
 
	gS·r£Cwi£Bš¬yOp
<
	gBš¬yOp
,
	gLhs
,
	gRhs
>::
IÂ”I‹¿tÜ


120 : 
public
 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
<
Bš¬yOp
,
	gLhs
,
	gRhs
, 
ty³Çme
 
	gS·r£Cwi£Bš¬yOp
<
	gBš¬yOp
,Lhs,Rhs>::
IÂ”I‹¿tÜ
>

122 
public
:

123 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
<

124 
	tBš¬yOp
,
	tLhs
,
	tRhs
, 
	tIÂ”I‹¿tÜ
> 
	tBa£
;

126 
EIGEN_STRONG_INLINE
 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£Cwi£Bš¬yOp
& 
bšOp
, 
ou‹r
)

127 : 
Ba£
(
bšOp
,
ou‹r
)

129 
	g´iv©e
:

130 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

143 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
,y³Çm
	gD”ived
>

144 
şass
 
	gei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
<
	gBš¬yOp
, 
	gLhs
, 
	gRhs
, 
	gD”ived
, 
	gIsS·r£
, IsSparse>

146 
	gS·r£Cwi£Bš¬yOp
<
	tBš¬yOp
, 
	tLhs
, 
	tRhs
> 
	tCwi£Bš¬yX´
;

147 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	tSÿÏr
 Scalar;

148 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	t_LhsNe¡ed
 _LhsNested;

149 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	t_RhsNe¡ed
 _RhsNested;

150 
ty³Çme
 
	t_LhsNe¡ed
::
	tIÂ”I‹¿tÜ
 
	tLhsI‹¿tÜ
;

151 
ty³Çme
 
	t_RhsNe¡ed
::
	tIÂ”I‹¿tÜ
 
	tRhsI‹¿tÜ
;

152 
	gpublic
:

154 
EIGEN_STRONG_INLINE
 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
(cÚ¡ 
Cwi£Bš¬yX´
& 
x´
, 
ou‹r
)

155 : 
m_lhsI‹r
(
x´
.
lhs
(),
ou‹r
), 
m_rhsI‹r
(x´.
rhs
(),ou‹r), 
m_funùÜ
(x´.
funùÜ
())

157 
	gthis
->
	gİ”©Ü
++();

160 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gİ”©Ü
++()

162 ià(
	gm_lhsI‹r
 && 
	gm_rhsI‹r
 && (m_lhsI‹r.
šdex
(è=ğ
m_rhsI‹r
.index()))

164 
m_id
 = 
m_lhsI‹r
.
šdex
();

165 
	gm_v®ue
 = 
m_funùÜ
(
m_lhsI‹r
.
v®ue
(), 
m_rhsI‹r
.value());

166 ++
	gm_lhsI‹r
;

167 ++
	gm_rhsI‹r
;

169 ià(
	gm_lhsI‹r
 && (!
	gm_rhsI‹r
 || (m_lhsI‹r.
šdex
() < m_rhsIter.index())))

171 
	gm_id
 = 
m_lhsI‹r
.
šdex
();

172 
	gm_v®ue
 = 
m_funùÜ
(
m_lhsI‹r
.
v®ue
(), 
SÿÏr
(0));

173 ++
	gm_lhsI‹r
;

175 ià(
	gm_rhsI‹r
 && (!
	gm_lhsI‹r
 || (m_lhsI‹r.
šdex
() > m_rhsIter.index())))

177 
	gm_id
 = 
m_rhsI‹r
.
šdex
();

178 
	gm_v®ue
 = 
m_funùÜ
(
SÿÏr
(0), 
m_rhsI‹r
.
v®ue
());

179 ++
	gm_rhsI‹r
;

183 
	gm_id
 = -1;

185  *
	g¡©ic_ÿ¡
<
	gD”ived
*>(
	gthis
);

188 
EIGEN_STRONG_INLINE
 
SÿÏr
 
v®ue
(ècÚ¡ {  
	gm_v®ue
; }

190 
EIGEN_STRONG_INLINE
 
šdex
(ècÚ¡ {  
	gm_id
; }

191 
EIGEN_STRONG_INLINE
 
row
(ècÚ¡ {  
	gm_lhsI‹r
.row(); }

192 
EIGEN_STRONG_INLINE
 
cŞ
(ècÚ¡ {  
	gm_lhsI‹r
.col(); }

194 
EIGEN_STRONG_INLINE
 
İ”©Ü
 
boŞ
(ècÚ¡ {  
	gm_id
>=0; }

196 
	g´Ùeùed
:

197 
LhsI‹¿tÜ
 
m_lhsI‹r
;

198 
RhsI‹¿tÜ
 
	gm_rhsI‹r
;

199 cÚ¡ 
	gBš¬yOp
& 
	gm_funùÜ
;

200 
SÿÏr
 
	gm_v®ue
;

201 
	gm_id
;

203 
	g´iv©e
:

204 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
& 
İ”©Ü
=(constƒi_sparse_cwise_binary_op_inner_iterator_selector&);

208 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gLhs
,y³Çm
	gRhs
,y³Çm
	gD”ived
>

209 
şass
 
	gei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
<
	gei_sÿÏr_´oduù_İ
<
	gT
>, 
	gLhs
, 
	gRhs
, 
	gD”ived
, 
	gIsS·r£
, IsSparse>

211 
	gei_sÿÏr_´oduù_İ
<
	tT
> 
	tBš¬yFunc
;

212 
	gS·r£Cwi£Bš¬yOp
<
	tBš¬yFunc
, 
	tLhs
, 
	tRhs
> 
	tCwi£Bš¬yX´
;

213 
ty³Çme
 
	tCwi£Bš¬yX´
::
	tSÿÏr
 Scalar;

214 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	t_LhsNe¡ed
 _LhsNested;

215 
ty³Çme
 
	t_LhsNe¡ed
::
	tIÂ”I‹¿tÜ
 
	tLhsI‹¿tÜ
;

216 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	t_RhsNe¡ed
 _RhsNested;

217 
ty³Çme
 
	t_RhsNe¡ed
::
	tIÂ”I‹¿tÜ
 
	tRhsI‹¿tÜ
;

218 
	gpublic
:

220 
EIGEN_STRONG_INLINE
 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
(cÚ¡ 
Cwi£Bš¬yX´
& 
x´
, 
ou‹r
)

221 : 
m_lhsI‹r
(
x´
.
lhs
(),
ou‹r
), 
m_rhsI‹r
(x´.
rhs
(),ou‹r), 
m_funùÜ
(x´.
funùÜ
())

223 
	gm_lhsI‹r
 && 
	gm_rhsI‹r
 && (m_lhsI‹r.
šdex
(è!ğ
m_rhsI‹r
.index()))

225 ià(
m_lhsI‹r
.
šdex
(è< 
m_rhsI‹r
.index())

226 ++
m_lhsI‹r
;

228 ++
	gm_rhsI‹r
;

232 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gİ”©Ü
++()

234 ++
	gm_lhsI‹r
;

235 ++
	gm_rhsI‹r
;

236 
	gm_lhsI‹r
 && 
	gm_rhsI‹r
 && (m_lhsI‹r.
šdex
(è!ğ
m_rhsI‹r
.index()))

238 ià(
m_lhsI‹r
.
šdex
(è< 
m_rhsI‹r
.index())

239 ++
m_lhsI‹r
;

241 ++
	gm_rhsI‹r
;

243  *
	g¡©ic_ÿ¡
<
	gD”ived
*>(
	gthis
);

246 
EIGEN_STRONG_INLINE
 
SÿÏr
 
v®ue
(ècÚ¡ {  
m_funùÜ
(
m_lhsI‹r
.v®ue(), 
m_rhsI‹r
.value()); }

248 
EIGEN_STRONG_INLINE
 
šdex
(ècÚ¡ {  
	gm_lhsI‹r
.index(); }

249 
EIGEN_STRONG_INLINE
 
row
(ècÚ¡ {  
	gm_lhsI‹r
.row(); }

250 
EIGEN_STRONG_INLINE
 
cŞ
(ècÚ¡ {  
	gm_lhsI‹r
.col(); }

252 
EIGEN_STRONG_INLINE
 
İ”©Ü
 
boŞ
(ècÚ¡ {  (
	gm_lhsI‹r
 && 
	gm_rhsI‹r
); }

254 
	g´Ùeùed
:

255 
LhsI‹¿tÜ
 
m_lhsI‹r
;

256 
RhsI‹¿tÜ
 
	gm_rhsI‹r
;

257 cÚ¡ 
	gBš¬yFunc
& 
	gm_funùÜ
;

259 
	g´iv©e
:

260 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
& 
İ”©Ü
=(constƒi_sparse_cwise_binary_op_inner_iterator_selector&);

264 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gLhs
,y³Çm
	gRhs
,y³Çm
	gD”ived
>

265 
şass
 
	gei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
<
	gei_sÿÏr_´oduù_İ
<
	gT
>, 
	gLhs
, 
	gRhs
, 
	gD”ived
, 
	gIsS·r£
, 
	gIsD’£
>

267 
	gei_sÿÏr_´oduù_İ
<
	tT
> 
	tBš¬yFunc
;

268 
	gS·r£Cwi£Bš¬yOp
<
	tBš¬yFunc
, 
	tLhs
, 
	tRhs
> 
	tCwi£Bš¬yX´
;

269 
ty³Çme
 
	tCwi£Bš¬yX´
::
	tSÿÏr
 Scalar;

270 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	t_LhsNe¡ed
 _LhsNested;

271 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	tRhsNe¡ed
 RhsNested;

272 
ty³Çme
 
	t_LhsNe¡ed
::
	tIÂ”I‹¿tÜ
 
	tLhsI‹¿tÜ
;

273 ’um { 
	gIsRowMajÜ
 = ((
Lhs
::
FÏgs
)&
RowMajÜB™
)==RowMajorBit };

274 
	gpublic
:

276 
EIGEN_STRONG_INLINE
 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
(cÚ¡ 
Cwi£Bš¬yX´
& 
x´
, 
ou‹r
)

277 : 
m_rhs
(
x´
.
rhs
()), 
m_lhsI‹r
(x´.
lhs
(),
ou‹r
), 
m_funùÜ
(x´.
funùÜ
()), 
m_ou‹r
(outer)

280 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gİ”©Ü
++()

282 ++
	gm_lhsI‹r
;

283  *
	g¡©ic_ÿ¡
<
	gD”ived
*>(
	gthis
);

286 
EIGEN_STRONG_INLINE
 
SÿÏr
 
v®ue
() const

287 {  
m_funùÜ
(
m_lhsI‹r
.
v®ue
(),

288 
m_rhs
.
cÛff
(
IsRowMajÜ
?
m_ou‹r
:
m_lhsI‹r
.
šdex
(),IsRowMajor?m_lhsIter.index():m_outer)); }

290 
EIGEN_STRONG_INLINE
 
šdex
(ècÚ¡ {  
	gm_lhsI‹r
.index(); }

291 
EIGEN_STRONG_INLINE
 
row
(ècÚ¡ {  
	gm_lhsI‹r
.row(); }

292 
EIGEN_STRONG_INLINE
 
cŞ
(ècÚ¡ {  
	gm_lhsI‹r
.col(); }

294 
EIGEN_STRONG_INLINE
 
İ”©Ü
 
boŞ
(ècÚ¡ {  
	gm_lhsI‹r
; }

296 
	g´Ùeùed
:

297 cÚ¡ 
RhsNe¡ed
 
m_rhs
;

298 
LhsI‹¿tÜ
 
	gm_lhsI‹r
;

299 cÚ¡ 
Bš¬yFunc
 
	gm_funùÜ
;

300 cÚ¡ 
	gm_ou‹r
;

302 
	g´iv©e
:

303 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
& 
İ”©Ü
=(constƒi_sparse_cwise_binary_op_inner_iterator_selector&);

307 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gLhs
,y³Çm
	gRhs
,y³Çm
	gD”ived
>

308 
şass
 
	gei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
<
	gei_sÿÏr_´oduù_İ
<
	gT
>, 
	gLhs
, 
	gRhs
, 
	gD”ived
, 
	gIsD’£
, 
	gIsS·r£
>

310 
	gei_sÿÏr_´oduù_İ
<
	tT
> 
	tBš¬yFunc
;

311 
	gS·r£Cwi£Bš¬yOp
<
	tBš¬yFunc
, 
	tLhs
, 
	tRhs
> 
	tCwi£Bš¬yX´
;

312 
ty³Çme
 
	tCwi£Bš¬yX´
::
	tSÿÏr
 Scalar;

313 
ty³Çme
 
	tei_Œa™s
<
	tCwi£Bš¬yX´
>::
	t_RhsNe¡ed
 _RhsNested;

314 
ty³Çme
 
	t_RhsNe¡ed
::
	tIÂ”I‹¿tÜ
 
	tRhsI‹¿tÜ
;

315 ’um { 
	gIsRowMajÜ
 = ((
Rhs
::
FÏgs
)&
RowMajÜB™
)==RowMajorBit };

316 
	gpublic
:

318 
EIGEN_STRONG_INLINE
 
ei_¥¬£_cwi£_bš¬y_İ_šÃr_™”©Ü_£ËùÜ
(cÚ¡ 
Cwi£Bš¬yX´
& 
x´
, 
ou‹r
)

319 : 
m_x´
(
x´
), 
m_rhsI‹r
(x´.
rhs
(),
ou‹r
), 
m_funùÜ
(x´.
funùÜ
()), 
m_ou‹r
(outer)

322 
EIGEN_STRONG_INLINE
 
	gD”ived
& 
	gİ”©Ü
++()

324 ++
	gm_rhsI‹r
;

325  *
	g¡©ic_ÿ¡
<
	gD”ived
*>(
	gthis
);

328 
EIGEN_STRONG_INLINE
 
SÿÏr
 
v®ue
() const

329 {  
m_funùÜ
(
m_x´
.
lhs
().
cÛff
(
IsRowMajÜ
?
m_ou‹r
:
m_rhsI‹r
.
šdex
(),IsRowMajÜ?m_rhsI‹r.šdex():m_ou‹r), m_rhsI‹r.
v®ue
()); }

331 
EIGEN_STRONG_INLINE
 
šdex
(ècÚ¡ {  
	gm_rhsI‹r
.index(); }

332 
EIGEN_STRONG_INLINE
 
row
(ècÚ¡ {  
	gm_rhsI‹r
.row(); }

333 
EIGEN_STRONG_INLINE
 
cŞ
(ècÚ¡ {  
	gm_rhsI‹r
.col(); }

335 
EIGEN_STRONG_INLINE
 
İ”©Ü
 
boŞ
(ècÚ¡ {  
	gm_rhsI‹r
; }

337 
	g´Ùeùed
:

338 cÚ¡ 
Cwi£Bš¬yX´
& 
m_x´
;

339 
RhsI‹¿tÜ
 
	gm_rhsI‹r
;

340 cÚ¡ 
	gBš¬yFunc
& 
	gm_funùÜ
;

341 cÚ¡ 
	gm_ou‹r
;

349 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

350 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

351 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gS·r£Cwi£Bš¬yOp
<
	gei_sÿÏr_difã»nû_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>,

352 
	gD”ived
, 
	gOth”D”ived
>

353 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
-(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

355  
S·r£Cwi£Bš¬yOp
<
ei_sÿÏr_difã»nû_İ
<
SÿÏr
>,

356 
	gD”ived
, 
	gOth”D”ived
>(
d”ived
(), 
	gÙh”
.derived());

359 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

360 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

361 
EIGEN_STRONG_INLINE
 
	gD”ived
 &

362 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
-=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

364  *
this
 = 
d”ived
(è- 
Ùh”
.derived();

367 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

368 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

369 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gS·r£Cwi£Bš¬yOp
<
	gei_sÿÏr_sum_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, D”ived, 
	gOth”D”ived
>

370 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
+(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

372  
S·r£Cwi£Bš¬yOp
<
ei_sÿÏr_sum_İ
<
SÿÏr
>, 
	gD”ived
, 
	gOth”D”ived
>(
d”ived
(), 
	gÙh”
.derived());

375 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

376 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

377 
EIGEN_STRONG_INLINE
 
	gD”ived
 &

378 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
+=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

380  *
this
 = 
d”ived
(è+ 
Ùh”
.derived();

383 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

384 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

385 
EIGEN_STRONG_INLINE
 cÚ¡ 
EIGEN_SPARSE_CWISE_PRODUCT_RETURN_TYPE


386 
	gS·r£Cwi£
<
	gEx´essiÚTy³
>::
İ”©Ü
*(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

388  
EIGEN_SPARSE_CWISE_PRODUCT_RETURN_TYPE
(
_ex´essiÚ
(), 
Ùh”
.
d”ived
());

391 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

392 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

393 
EIGEN_STRONG_INLINE
 cÚ¡ 
EIGEN_SPARSE_CWISE_PRODUCT_RETURN_TYPE


394 
	gS·r£Cwi£
<
	gEx´essiÚTy³
>::
İ”©Ü
*(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

396  
EIGEN_SPARSE_CWISE_PRODUCT_RETURN_TYPE
(
_ex´essiÚ
(), 
Ùh”
.
d”ived
());

415 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

416 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

417 
šlše
 
	gEx´essiÚTy³
& 
	gS·r£Cwi£
<Ex´essiÚTy³>::
İ”©Ü
*=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
)

419  
m_m©rix
.
cÚ¡_ÿ¡_d”ived
(èğ
_ex´essiÚ
(è* 
Ùh”
.
d”ived
();

429 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

430 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

431 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_SPARSE_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_mš_İ
)

432 
S·r£Cwi£
<
Ex´essiÚTy³
>::
	`mš
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

434  
	`EIGEN_SPARSE_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_mš_İ
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

435 
	}
}

437 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

438 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

439 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_SPARSE_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_max_İ
)

440 
S·r£Cwi£
<
Ex´essiÚTy³
>::
	`max
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

442  
	`EIGEN_SPARSE_CWISE_BINOP_RETURN_TYPE
(
ei_sÿÏr_max_İ
)(
	`_ex´essiÚ
(), 
Ùh”
.
	`d”ived
());

443 
	}
}

	@robot/Eigen/src/Sparse/SparseCwiseUnaryOp.h

25 #iâdeà
EIGEN_SPARSE_CWISE_UNARY_OP_H


26 
	#EIGEN_SPARSE_CWISE_UNARY_OP_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gUÇryOp
,y³Çm
	gM©rixTy³
>

29 
	gei_Œa™s
<
	gS·r£Cwi£UÇryOp
<
	gUÇryOp
, 
	gM©rixTy³
> > : 
ei_Œa™s
<
M©rixTy³
>

31 
ty³Çme
 
	tei_»suÉ_of
<

32 
	tUÇryOp
(
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
)

33 >::
	tty³
 
	tSÿÏr
;

34 
ty³Çme
 
	tM©rixTy³
::
	tNe¡ed
 
	tM©rixTy³Ne¡ed
;

35 
ty³Çme
 
	tei_uÄef
<
	tM©rixTy³Ne¡ed
>::
	tty³
 
	t_M©rixTy³Ne¡ed
;

37 
	gCÛffR—dCo¡
 = 
_M©rixTy³Ne¡ed
::
CÛffR—dCo¡
 + 
ei_funùÜ_Œa™s
<
UÇryOp
>::
Co¡


41 
	g‹m¶©e
<
ty³Çme
 
	gUÇryOp
,y³Çm
	gM©rixTy³
>

42 
şass
 
	gS·r£Cwi£UÇryOp
 : 
ei_no_assignm’t_İ”©Ü
,

43 
public
 
	gS·r£M©rixBa£
<
	gS·r£Cwi£UÇryOp
<
	gUÇryOp
, 
	gM©rixTy³
> >

45 
	gpublic
:

47 
şass
 
IÂ”I‹¿tÜ
;

50 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£Cwi£UÇryOp
)

52 
šlše
 
S·r£Cwi£UÇryOp
(cÚ¡ 
M©rixTy³
& 
m©
, cÚ¡ 
UÇryOp
& 
func
 = UnaryOp())

53 : 
m_m©rix
(
m©
), 
m_funùÜ
(
func
) {}

55 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_m©rix
.rows(); }

56 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.cols(); }

61 
	g´Ùeùed
:

62 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

63 cÚ¡ 
UÇryOp
 
	gm_funùÜ
;

67 
	g‹m¶©e
<
ty³Çme
 
	gUÇryOp
,y³Çm
	gM©rixTy³
>

68 
şass
 
	gS·r£Cwi£UÇryOp
<
	gUÇryOp
,
	gM©rixTy³
>::
IÂ”I‹¿tÜ


70 
ty³Çme
 
	tS·r£Cwi£UÇryOp
::
	tSÿÏr
 Scalar;

71 
ty³Çme
 
	tei_Œa™s
<
	tS·r£Cwi£UÇryOp
>::
	t_M©rixTy³Ne¡ed
 _MatrixTypeNested;

72 
ty³Çme
 
	t_M©rixTy³Ne¡ed
::
	tIÂ”I‹¿tÜ
 
	tM©rixTy³I‹¿tÜ
;

73 
	gpublic
:

75 
EIGEN_STRONG_INLINE
 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£Cwi£UÇryOp
& 
uÇryOp
, 
ou‹r
)

76 : 
m_™”
(
uÇryOp
.
m_m©rix
,
ou‹r
), 
m_funùÜ
(unaryOp.m_functor)

79 
EIGEN_STRONG_INLINE
 
	gIÂ”I‹¿tÜ
& 
	gİ”©Ü
++()

80 { ++
	gm_™”
;  *
	gthis
; }

82 
EIGEN_STRONG_INLINE
 
SÿÏr
 
v®ue
(ècÚ¡ {  
m_funùÜ
(
m_™”
.value()); }

84 
EIGEN_STRONG_INLINE
 
šdex
(ècÚ¡ {  
	gm_™”
.index(); }

85 
EIGEN_STRONG_INLINE
 
row
(ècÚ¡ {  
	gm_™”
.row(); }

86 
EIGEN_STRONG_INLINE
 
cŞ
(ècÚ¡ {  
	gm_™”
.col(); }

88 
EIGEN_STRONG_INLINE
 
İ”©Ü
 
boŞ
(ècÚ¡ {  
	gm_™”
; }

90 
	g´Ùeùed
:

91 
M©rixTy³I‹¿tÜ
 
m_™”
;

92 cÚ¡ 
UÇryOp
 
	gm_funùÜ
;

94 
	g´iv©e
:

95 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

98 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

99 
	g‹m¶©e
<
ty³Çme
 
	gCu¡omUÇryOp
>

100 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gCu¡omUÇryOp
, 
	gD”ived
>

101 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$uÇryEx´
(cÚ¡ 
Cu¡omUÇryOp
& 
func
) const

103  
S·r£Cwi£UÇryOp
<
Cu¡omUÇryOp
, 
D”ived
>(
	`d”ived
(), 
func
);

104 
	}
}

106 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

107 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_İpos™e_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>,Derived>

108 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
-() const

110  
d”ived
();

113 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

114 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_SPARSE_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs_İ
)

115 
S·r£Cwi£
<
Ex´essiÚTy³
>::
	$abs
() const

117  
	`_ex´essiÚ
();

118 
	}
}

120 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
>

121 
EIGEN_STRONG_INLINE
 cÚ¡ 
	$EIGEN_SPARSE_CWISE_UNOP_RETURN_TYPE
(
ei_sÿÏr_abs2_İ
)

122 
S·r£Cwi£
<
Ex´essiÚTy³
>::
	$abs2
() const

124  
	`_ex´essiÚ
();

125 
	}
}

127 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

128 
EIGEN_STRONG_INLINE
 
ty³Çme
 
	gS·r£M©rixBa£
<
	gD”ived
>::
CÚjug©eR‘uºTy³


129 
S·r£M©rixBa£
<
D”ived
>::
	$cÚjug©e
() const

131  
	`CÚjug©eR‘uºTy³
(
	`d”ived
());

132 
	}
}

134 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

135 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gS·r£M©rixBa£
<
	gD”ived
>::
R—lR‘uºTy³


136 
S·r£M©rixBa£
<
D”ived
>::
	$»®
(ècÚ¡ {  
	`d”ived
(); 
	}
}

138 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

139 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gS·r£M©rixBa£
<
	gD”ived
>::
ImagR‘uºTy³


140 
S·r£M©rixBa£
<
D”ived
>::
	$imag
(ècÚ¡ {  
	`d”ived
(); 
	}
}

142 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

143 
	g‹m¶©e
<
ty³Çme
 
	gNewTy³
>

144 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_ÿ¡_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
, 
	gNewTy³
>, Derived>

145 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$ÿ¡
() const

147  
	`d”ived
();

148 
	}
}

150 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

151 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_muÉË_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

152 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
*(cÚ¡ 
SÿÏr
& 
sÿÏr
) const

154  
S·r£Cwi£UÇryOp
<
ei_sÿÏr_muÉË_İ
<
SÿÏr
>, 
	gD”ived
>

155 (
d”ived
(), 
	gei_sÿÏr_muÉË_İ
<
	gSÿÏr
>(
	gsÿÏr
));

158 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

159 
EIGEN_STRONG_INLINE
 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_quÙ›Á1_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

160 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
/(cÚ¡ 
SÿÏr
& 
sÿÏr
) const

162  
S·r£Cwi£UÇryOp
<
ei_sÿÏr_quÙ›Á1_İ
<
SÿÏr
>, 
	gD”ived
>

163 (
d”ived
(), 
	gei_sÿÏr_quÙ›Á1_İ
<
	gSÿÏr
>(
	gsÿÏr
));

166 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

167 
EIGEN_STRONG_INLINE
 
	gD”ived
&

168 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
*=(cÚ¡ 
SÿÏr
& 
Ùh”
)

170 
j
=0; 
	gj
<
ou‹rSize
(); ++j)

171 
ty³Çme
 
	gD”ived
::
IÂ”I‹¿tÜ
 
i
(
d”ived
(),
j
); 
	gi
; ++i)

172 
	gi
.
v®ueRef
(è*ğ
Ùh”
;

173  
d”ived
();

176 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

177 
EIGEN_STRONG_INLINE
 
	gD”ived
&

178 
	gS·r£M©rixBa£
<
	gD”ived
>::
İ”©Ü
/=(cÚ¡ 
SÿÏr
& 
Ùh”
)

180 
j
=0; 
	gj
<
ou‹rSize
(); ++j)

181 
ty³Çme
 
	gD”ived
::
IÂ”I‹¿tÜ
 
i
(
d”ived
(),
j
); 
	gi
; ++i)

182 
	gi
.
v®ueRef
(è/ğ
Ùh”
;

183  
d”ived
();

	@robot/Eigen/src/Sparse/SparseDiagonalProduct.h

25 #iâdeà
EIGEN_SPARSE_DIAGONAL_PRODUCT_H


26 
	#EIGEN_SPARSE_DIAGONAL_PRODUCT_H


	)

39 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

40 
	gei_Œa™s
<
	gS·r£DŸgÚ®Produù
<
	gLhs
, 
	gRhs
> > : 
ei_Œa™s
<
S·r£Produù
<
Lhs
, Rhs, 
	gDŸgÚ®Produù
> >

42 
ty³Çme
 
	tei_ş—Áy³
<
	tLhs
>::
	tty³
 
	t_Lhs
;

43 
ty³Çme
 
	tei_ş—Áy³
<
	tRhs
>::
	tty³
 
	t_Rhs
;

45 
	gS·r£FÏgs
 = (((
_Lhs
::
FÏgs
)&
DŸgÚ®
)==DŸgÚ®è? (
_Rhs
::Flags) : (_Lhs::Flags),

46 
	gFÏgs
 = 
S·r£B™
 | (
S·r£FÏgs
&
RowMajÜB™
)

50 ’um {
	mSDP_IsDŸgÚ®
, 
	mSDP_IsS·r£RowMajÜ
, 
	mSDP_IsS·r£CŞMajÜ
};

51 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gS·r£DŸgÚ®ProduùTy³
, 
	gRhsMode
, 
	gLhsMode
>

52 
şass
 
	gei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ
;

54 
	g‹m¶©e
<
ty³Çme
 
	gLhsNe¡ed
,y³Çm
	gRhsNe¡ed
>

55 
şass
 
	gS·r£DŸgÚ®Produù
 : 
public
 
S·r£M©rixBa£
<
S·r£DŸgÚ®Produù
<
LhsNe¡ed
,
	gRhsNe¡ed
> >, 
	gei_no_assignm’t_İ”©Ü


57 
ty³Çme
 
	tei_Œa™s
<
	tS·r£DŸgÚ®Produù
>::
	t_LhsNe¡ed
 _LhsNested;

58 
ty³Çme
 
	tei_Œa™s
<
	tS·r£DŸgÚ®Produù
>::
	t_RhsNe¡ed
 _RhsNested;

61 
	gLhsMode
 = (
_LhsNe¡ed
::
FÏgs
&
DŸgÚ®
)==DŸgÚ® ? 
SDP_IsDŸgÚ®


62 : (
_LhsNe¡ed
::
FÏgs
&
RowMajÜB™
è? 
SDP_IsS·r£RowMajÜ
 : 
SDP_IsS·r£CŞMajÜ
,

63 
	gRhsMode
 = (
_RhsNe¡ed
::
FÏgs
&
DŸgÚ®
)==DŸgÚ® ? 
SDP_IsDŸgÚ®


64 : (
_RhsNe¡ed
::
FÏgs
&
RowMajÜB™
è? 
SDP_IsS·r£RowMajÜ
 : 
SDP_IsS·r£CŞMajÜ


67 
	gpublic
:

69 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£DŸgÚ®Produù
)

71 
ei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ


72 <
	t_LhsNe¡ed
,
	t_RhsNe¡ed
,
	tS·r£DŸgÚ®Produù
,
	tLhsMode
,
	tRhsMode
> 
	tIÂ”I‹¿tÜ
;

74 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

75 
EIGEN_STRONG_INLINE
 
S·r£DŸgÚ®Produù
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
)

76 : 
m_lhs
(
lhs
), 
m_rhs
(
rhs
)

78 
ei_as£¹
(
lhs
.
cŞs
(è=ğ
rhs
.
rows
() && "invalid sparse matrix * diagonal matrix…roduct");

81 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_lhs
.rows(); }

82 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_rhs
.cols(); }

84 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_LhsNe¡ed
& 
lhs
(ècÚ¡ {  
	gm_lhs
; }

85 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_RhsNe¡ed
& 
rhs
(ècÚ¡ {  
	gm_rhs
; }

87 
	g´Ùeùed
:

88 
LhsNe¡ed
 
m_lhs
;

89 
RhsNe¡ed
 
	gm_rhs
;

93 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gS·r£DŸgÚ®ProduùTy³
>

94 
şass
 
	gei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ


95 <
	gLhs
,
	gRhs
,
	gS·r£DŸgÚ®ProduùTy³
,
	gSDP_IsDŸgÚ®
,
	gSDP_IsS·r£RowMajÜ
>

96 : 
public
 
S·r£Cwi£UÇryOp
<
ei_sÿÏr_muÉË_İ
<
ty³Çme
 
Lhs
::
SÿÏr
>,
	gRhs
>::
IÂ”I‹¿tÜ


98 
ty³Çme
 
	tS·r£Cwi£UÇryOp
<
	tei_sÿÏr_muÉË_İ
<
	tty³Çme
 
	tLhs
::
	tSÿÏr
>,
	tRhs
>::
	tIÂ”I‹¿tÜ
 
	tBa£
;

99 
	gpublic
:

100 
šlše
 
ei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ
(

101 cÚ¡ 
S·r£DŸgÚ®ProduùTy³
& 
ex´
, 
ou‹r
)

102 : 
Ba£
(
ex´
.
rhs
()*Óx´.
lhs
().
dŸgÚ®
().
cÛff
(
ou‹r
)), outer)

106 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gS·r£DŸgÚ®ProduùTy³
>

107 
şass
 
	gei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ


108 <
	gLhs
,
	gRhs
,
	gS·r£DŸgÚ®ProduùTy³
,
	gSDP_IsDŸgÚ®
,
	gSDP_IsS·r£CŞMajÜ
>

109 : 
public
 
S·r£Cwi£Bš¬yOp
<

110 
ei_sÿÏr_´oduù_İ
<
ty³Çme
 
Lhs
::
SÿÏr
>,

111 
	gS·r£IÂ”VeùÜS‘
<
	gRhs
,1>,

112 
ty³Çme
 
	gLhs
::
_CÛffsVeùÜTy³
>::
IÂ”I‹¿tÜ


114 
ty³Çme
 
	tS·r£Cwi£Bš¬yOp
<

115 
	tei_sÿÏr_´oduù_İ
<
	tty³Çme
 
	tLhs
::
	tSÿÏr
>,

116 
	tS·r£IÂ”VeùÜS‘
<
	tRhs
,1>,

117 
	tty³Çme
 
	tLhs
::
	t_CÛffsVeùÜTy³
>::
	tIÂ”I‹¿tÜ
 
	tBa£
;

118 
	gpublic
:

119 
šlše
 
ei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ
(

120 cÚ¡ 
S·r£DŸgÚ®ProduùTy³
& 
ex´
, 
ou‹r
)

121 : 
Ba£
(
ex´
.
rhs
().
šÃrVeùÜ
(
ou‹r
è.
cwi£
()*ƒx´.
lhs
().
dŸgÚ®
(), 0)

123 
	g´iv©e
:

124 
ei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ
& 
İ”©Ü
=(constƒi_sparse_diagonal_product_inner_iterator_selector&);

127 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gS·r£DŸgÚ®ProduùTy³
>

128 
şass
 
	gei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ


129 <
	gLhs
,
	gRhs
,
	gS·r£DŸgÚ®ProduùTy³
,
	gSDP_IsS·r£CŞMajÜ
,
	gSDP_IsDŸgÚ®
>

130 : 
public
 
S·r£Cwi£UÇryOp
<
ei_sÿÏr_muÉË_İ
<
ty³Çme
 
Rhs
::
SÿÏr
>,
	gLhs
>::
IÂ”I‹¿tÜ


132 
ty³Çme
 
	tS·r£Cwi£UÇryOp
<
	tei_sÿÏr_muÉË_İ
<
	tty³Çme
 
	tRhs
::
	tSÿÏr
>,
	tLhs
>::
	tIÂ”I‹¿tÜ
 
	tBa£
;

133 
	gpublic
:

134 
šlše
 
ei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ
(

135 cÚ¡ 
S·r£DŸgÚ®ProduùTy³
& 
ex´
, 
ou‹r
)

136 : 
Ba£
(
ex´
.
lhs
()*ex´.
rhs
().
dŸgÚ®
().
cÛff
(
ou‹r
), outer)

140 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gS·r£DŸgÚ®ProduùTy³
>

141 
şass
 
	gei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ


142 <
	gLhs
,
	gRhs
,
	gS·r£DŸgÚ®ProduùTy³
,
	gSDP_IsS·r£RowMajÜ
,
	gSDP_IsDŸgÚ®
>

143 : 
public
 
S·r£Cwi£Bš¬yOp
<

144 
ei_sÿÏr_´oduù_İ
<
ty³Çme
 
Rhs
::
SÿÏr
>,

145 
	gS·r£IÂ”VeùÜS‘
<
	gLhs
,1>,

146 
	gNe¡ByV®ue
<
	gT¿n¥o£
<
ty³Çme
 
	gRhs
::
_CÛffsVeùÜTy³
> > >::
IÂ”I‹¿tÜ


148 
ty³Çme
 
	tS·r£Cwi£Bš¬yOp
<

149 
	tei_sÿÏr_´oduù_İ
<
	tty³Çme
 
	tRhs
::
	tSÿÏr
>,

150 
	tS·r£IÂ”VeùÜS‘
<
	tLhs
,1>,

151 
	tNe¡ByV®ue
<
	tT¿n¥o£
<
	tty³Çme
 
	tRhs
::
	t_CÛffsVeùÜTy³
> > >::
	tIÂ”I‹¿tÜ
 
	tBa£
;

152 
	gpublic
:

153 
šlše
 
ei_¥¬£_dŸgÚ®_´oduù_šÃr_™”©Ü_£ËùÜ
(

154 cÚ¡ 
S·r£DŸgÚ®ProduùTy³
& 
ex´
, 
ou‹r
)

155 : 
Ba£
(
ex´
.
lhs
().
šÃrVeùÜ
(
ou‹r
è.
cwi£
()*ƒx´.
rhs
().
dŸgÚ®
().
Œª¥o£
().
Ã¡ByV®ue
(), 0)

	@robot/Eigen/src/Sparse/SparseDot.h

25 #iâdeà
EIGEN_SPARSE_DOT_H


26 
	#EIGEN_SPARSE_DOT_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

29 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

30 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


31 
S·r£M©rixBa£
<
D”ived
>::
dÙ
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const

33 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

34 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
Oth”D”ived
)

35 
EIGEN_STATIC_ASSERT_SAME_VECTOR_SIZE
(
D”ived
,
Oth”D”ived
)

36 
EIGEN_STATIC_ASSERT
((
ei_is_§me_ty³
<
SÿÏr
, 
ty³Çme
 
Oth”D”ived
::SÿÏr>::
»t
),

37 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

39 
ei_as£¹
(
size
(è=ğ
Ùh”
.size());

40 
ei_as£¹
(
Ùh”
.
size
()>0 && "you‡re using‡‚on initialized vector");

42 
ty³Çme
 
	gD”ived
::
IÂ”I‹¿tÜ
 
i
(
d”ived
(),0);

43 
SÿÏr
 
	g»s
 = 0;

44 
	gi
)

46 
	g»s
 +ğ
i
.
v®ue
(è* 
ei_cÚj
(
Ùh”
.
cÛff
(i.
šdex
()));

47 ++
	gi
;

49  
	g»s
;

52 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

53 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

54 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


55 
S·r£M©rixBa£
<
D”ived
>::
dÙ
(cÚ¡ S·r£M©rixBa£<
Oth”D”ived
>& 
Ùh”
) const

57 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
D”ived
)

58 
EIGEN_STATIC_ASSERT_VECTOR_ONLY
(
Oth”D”ived
)

59 
EIGEN_STATIC_ASSERT_SAME_VECTOR_SIZE
(
D”ived
,
Oth”D”ived
)

60 
EIGEN_STATIC_ASSERT
((
ei_is_§me_ty³
<
SÿÏr
, 
ty³Çme
 
Oth”D”ived
::SÿÏr>::
»t
),

61 
YOU_MIXED_DIFFERENT_NUMERIC_TYPES__YOU_NEED_TO_USE_THE_CAST_METHOD_OF_MATRIXBASE_TO_CAST_NUMERIC_TYPES_EXPLICITLY
)

63 
ei_as£¹
(
size
(è=ğ
Ùh”
.size());

65 
ty³Çme
 
	gD”ived
::
IÂ”I‹¿tÜ
 
i
(
d”ived
(),0);

66 
ty³Çme
 
	gOth”D”ived
::
IÂ”I‹¿tÜ
 
j
(
Ùh”
.
d”ived
(),0);

67 
SÿÏr
 
	g»s
 = 0;

68 
	gi
 && 
	gj
)

70 ià(
	gi
.
šdex
()==
j
.index())

72 
»s
 +ğ
i
.
v®ue
(è* 
ei_cÚj
(
j
.value());

73 ++
	gi
; ++
	gj
;

75 ià(
	gi
.
šdex
()<
	gj
.index())

76 ++
	gi
;

78 ++
	gj
;

80  
	g»s
;

83 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

84 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l


85 
S·r£M©rixBa£
<
D”ived
>::
	$squ¬edNÜm
() const

87  
	`ei_»®
((*
this
).
	`cwi£
().
	`abs2
().
	`sum
());

88 
	}
}

90 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

91 
šlše
 
ty³Çme
 
	gNumT¿™s
<ty³Çm
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>::
R—l


92 
S·r£M©rixBa£
<
D”ived
>::
	$nÜm
() const

94  
	`ei_sq¹
(
	`squ¬edNÜm
());

95 
	}
}

	@robot/Eigen/src/Sparse/SparseFlagged.h

26 #iâdeà
EIGEN_SPARSE_FLAGGED_H


27 
	#EIGEN_SPARSE_FLAGGED_H


	)

29 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
>

30 
	gei_Œa™s
<
	gS·r£FÏgged
<
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
> > : 
ei_Œa™s
<
Ex´essiÚTy³
>

32 ’um { 
FÏgs
 = (
Ex´essiÚTy³
::FÏg | 
Added
è& ~
Removed
 };

35 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
> 
şass
 
	gS·r£FÏgged


36 : 
public
 
S·r£M©rixBa£
<
S·r£FÏgged
<
Ex´essiÚTy³
, 
	gAdded
, 
	gRemoved
> >

38 
	gpublic
:

40 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£FÏgged
)

41 
şass
 
IÂ”I‹¿tÜ
;

42 
şass
 
	gRev”£IÂ”I‹¿tÜ
;

44 
ty³Çme
 
	tei_m‘a_if
<
	tei_mu¡_Ã¡_by_v®ue
<
	tEx´essiÚTy³
>::
	t»t
,

45 
	tEx´essiÚTy³
, cÚ¡ Ex´essiÚTy³&>::
	t»t
 
	tEx´essiÚTy³Ne¡ed
;

47 
šlše
 
S·r£FÏgged
(cÚ¡ 
Ex´essiÚTy³
& 
m©rix
è: 
m_m©rix
(matrix) {}

49 
šlše
 
rows
(ècÚ¡ {  
m_m©rix
.rows(); }

50 
šlše
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.cols(); }

53 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

54 {  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
cŞ
, 
row
); }

56 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

57 {  
	gm_m©rix
.
cÛff
(
cŞ
, 
row
); }

59 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

60 {  
	gm_m©rix
.
cÛff
(
šdex
); }

62 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

63 {  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
šdex
); }

65 
	g´Ùeùed
:

66 
Ex´essiÚTy³Ne¡ed
 
m_m©rix
;

68 
	g´iv©e
:

69 
S·r£FÏgged
& 
İ”©Ü
=(const SparseFlagged&);

72 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
>

73 
şass
 
	gS·r£FÏgged
<
	gEx´essiÚTy³
,
	gAdded
,
	gRemoved
>::
IÂ”I‹¿tÜ
 : 
public
 
Ex´essiÚTy³
::InnerIterator

75 
public
:

76 
EIGEN_STRONG_INLINE
 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£FÏgged
& 
x´
, 
ou‹r
)

77 : 
Ex´essiÚTy³
::
IÂ”I‹¿tÜ
(
x´
.
m_m©rix
, 
ou‹r
)

80 
	g´iv©e
:

81 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

84 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
, 
	gAdded
, 
	gRemoved
>

85 
şass
 
	gS·r£FÏgged
<
	gEx´essiÚTy³
,
	gAdded
,
	gRemoved
>::
Rev”£IÂ”I‹¿tÜ
 : 
public
 
Ex´essiÚTy³
::ReverseInnerIterator

87 
public
:

89 
EIGEN_STRONG_INLINE
 
Rev”£IÂ”I‹¿tÜ
(cÚ¡ 
S·r£FÏgged
& 
x´
, 
ou‹r
)

90 : 
Ex´essiÚTy³
::
Rev”£IÂ”I‹¿tÜ
(
x´
.
m_m©rix
, 
ou‹r
)

94 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

95 
	g‹m¶©e
<
	gAdded
>

96 
šlše
 cÚ¡ 
	gS·r£FÏgged
<
	gD”ived
, 
	gAdded
, 0>

97 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$m¬ked
() const

99  
	`d”ived
();

100 
	}
}

	@robot/Eigen/src/Sparse/SparseFuzzy.h

25 #iâdeà
EIGEN_SPARSE_FUZZY_H


26 
	#EIGEN_SPARSE_FUZZY_H


	)

	@robot/Eigen/src/Sparse/SparseLDLT.h

63 #iâdeà
EIGEN_SPARSELDLT_H


64 
	#EIGEN_SPARSELDLT_H


	)

76 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
 = 
DeçuÉBack’d
>

77 şas 
	cS·r£LDLT


79 
´Ùeùed
:

80 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

81 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

82 
	mS·r£M©rix
<
	tSÿÏr
,
	tLow”TrŸnguÏr
|
	tUn™DŸgB™
> 
	tChŞM©rixTy³
;

83 
	mM©rix
<
	tSÿÏr
,
	tM©rixTy³
::
	tCŞsAtCompeTime
,1> 
	tVeùÜTy³
;

86 
	mSu³ºod®FaùÜIsDœty
 = 0x10000,

87 
	mM©rixLIsDœty
 = 0x20000

90 
	gpublic
:

93 
	$S·r£LDLT
(
æags
 = 0)

94 : 
	`m_æags
(
æags
), 
	$m_¡©us
(0)

96 
	`ei_as£¹
((
M©rixTy³
::
FÏgs
&
RowMajÜB™
)==0);

97 
m_´ecisiÚ
 = 
	`R—lSÿÏr
(0.1è* 
Eig’
::
´ecisiÚ
<
R—lSÿÏr
>();

98 
	}
}

102 
	$S·r£LDLT
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
æags
 = 0)

103 : 
	`m_m©rix
(
m©rix
.
	`rows
(), m©rix.
	`cŞs
()), 
	`m_æags
(
æags
), 
	$m_¡©us
(0)

105 
	`ei_as£¹
((
M©rixTy³
::
FÏgs
&
RowMajÜB™
)==0);

106 
m_´ecisiÚ
 = 
	`R—lSÿÏr
(0.1è* 
Eig’
::
´ecisiÚ
<
R—lSÿÏr
>();

107 
	`compu‹
(
m©rix
);

108 
	}
}

123 
	$£tP»cisiÚ
(
R—lSÿÏr
 
v
è{ 
m_´ecisiÚ
 = v; 
	}
}

128 
R—lSÿÏr
 
	$´ecisiÚ
(ècÚ¡ {  
m_´ecisiÚ
; 
	}
}

140 
	$£‰agss
(
f
è{ 
m_æags
 = f; 
	}
}

142 
	$æags
(ècÚ¡ {  
m_æags
; 
	}
}

145 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

148 
_symbŞic
(cÚ¡ 
M©rixTy³
& 
m©rix
);

151 
boŞ
 
_num”ic
(cÚ¡ 
M©rixTy³
& 
m©rix
);

154 
šlše
 cÚ¡ 
	gChŞM©rixTy³
& 
	$m©rixL
(ècÚ¡ {  
m_m©rix
; 
	}
}

157 
šlše
 
VeùÜTy³
 
	$veùÜD
(ècÚ¡ {  
m_dŸg
; 
	}
}

159 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

160 
boŞ
 
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const;

163 
šlše
 
boŞ
 
	$sucûeded
(ècÚ¡ {  
m_sucûeded
; 
	}
}

165 
	g´Ùeùed
:

166 
ChŞM©rixTy³
 
m_m©rix
;

167 
VeùÜTy³
 
	gm_dŸg
;

168 
VeùÜXi
 
	gm_·»Á
;

169 
VeùÜXi
 
	gm_nÚZ”osP”CŞ
;

171 
R—lSÿÏr
 
	gm_´ecisiÚ
;

172 
	gm_æags
;

173 
mubË
 
	gm_¡©us
;

174 
boŞ
 
	gm_sucûeded
;

180 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

181 
	gS·r£LDLT
<
	gM©rixTy³
,
	gBack’d
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

183 
	`_symbŞic
(
a
);

184 
m_sucûeded
 = 
	`_num”ic
(
a
);

185 
	}
}

187 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

188 
	gS·r£LDLT
<
	gM©rixTy³
,
	gBack’d
>::
	$_symbŞic
(cÚ¡ 
M©rixTy³
& 
a
)

190 
	`as£¹
(
a
.
	`rows
()=÷.
	`cŞs
());

191 cÚ¡ 
size
 = 
a
.
	`rows
();

192 
m_m©rix
.
	`»size
(
size
, size);

193 
m_·»Á
.
	`»size
(
size
);

194 
m_nÚZ”osP”CŞ
.
	`»size
(
size
);

195 * 
gs
 = 
	`ei_®igÃd_¡ack_Ãw
(, 
size
);

197 cÚ¡ * 
Ap
 = 
a
.
	`_ou‹rIndexPŒ
();

198 cÚ¡ * 
Ai
 = 
a
.
	`_šÃrIndexPŒ
();

199 * 
Lp
 = 
m_m©rix
.
	`_ou‹rIndexPŒ
();

200 cÚ¡ * 
P
 = 0;

201 * 
Pšv
 = 0;

203 ià(
P
)

206 
k
 = 0; k < 
size
; ++k)

207 
Pšv
[
P
[
k
]] = k;

209 
k
 = 0; k < 
size
; ++k)

212 
m_·»Á
[
k
] = -1;

213 
gs
[
k
] = k;

214 
m_nÚZ”osP”CŞ
[
k
] = 0;

215 
kk
 = 
P
 ? P[
k
] : k;

216 
p2
 = 
Ap
[
kk
+1];

217 
p
 = 
Ap
[
kk
];… < 
p2
; ++p)

220 
i
 = 
Pšv
 ? Pšv[
Ai
[
p
]] : Ai[p];

221 ià(
i
 < 
k
)

224 ; 
gs
[
i
] !ğ
k
; i = 
m_·»Á
[i])

227 ià(
m_·»Á
[
i
] == -1)

228 
m_·»Á
[
i
] = 
k
;

229 ++
m_nÚZ”osP”CŞ
[
i
];

230 
gs
[
i
] = 
k
;

236 
Lp
[0] = 0;

237 
k
 = 0; k < 
size
; ++k)

238 
Lp
[
k
+1] = Lp[k] + 
m_nÚZ”osP”CŞ
[k];

240 
m_m©rix
.
	`»sizeNÚZ”os
(
Lp
[
size
]);

241 
	`ei_®igÃd_¡ack_d–‘e
(, 
gs
, 
size
);

242 
	}
}

244 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

245 
boŞ
 
	gS·r£LDLT
<
	gM©rixTy³
,
	gBack’d
>::
	$_num”ic
(cÚ¡ 
M©rixTy³
& 
a
)

247 
	`as£¹
(
a
.
	`rows
()=÷.
	`cŞs
());

248 cÚ¡ 
size
 = 
a
.
	`rows
();

249 
	`as£¹
(
m_·»Á
.
	`size
()==
size
);

250 
	`as£¹
(
m_nÚZ”osP”CŞ
.
	`size
()==
size
);

252 cÚ¡ * 
Ap
 = 
a
.
	`_ou‹rIndexPŒ
();

253 cÚ¡ * 
Ai
 = 
a
.
	`_šÃrIndexPŒ
();

254 cÚ¡ 
SÿÏr
* 
Ax
 = 
a
.
	`_v®uePŒ
();

255 cÚ¡ * 
Lp
 = 
m_m©rix
.
	`_ou‹rIndexPŒ
();

256 * 
Li
 = 
m_m©rix
.
	`_šÃrIndexPŒ
();

257 
SÿÏr
* 
Lx
 = 
m_m©rix
.
	`_v®uePŒ
();

258 
m_dŸg
.
	`»size
(
size
);

260 
SÿÏr
 * 
y
 = 
	`ei_®igÃd_¡ack_Ãw
(SÿÏr, 
size
);

261 * 
·‰”n
 = 
	`ei_®igÃd_¡ack_Ãw
(, 
size
);

262 * 
gs
 = 
	`ei_®igÃd_¡ack_Ãw
(, 
size
);

264 cÚ¡ * 
P
 = 0;

265 cÚ¡ * 
Pšv
 = 0;

266 
boŞ
 
ok
 = 
Œue
;

268 
k
 = 0; k < 
size
; ++k)

271 
y
[
k
] = 0.0;

272 
tİ
 = 
size
;

273 
gs
[
k
] = k;

274 
m_nÚZ”osP”CŞ
[
k
] = 0;

275 
kk
 = (
P
è? (P[
k
]) : (k);

276 
p2
 = 
Ap
[
kk
+1];

277 
p
 = 
Ap
[
kk
];… < 
p2
; ++p)

279 
i
 = 
Pšv
 ? Pšv[
Ai
[
p
]] : Ai[p];

280 ià(
i
 <ğ
k
)

282 
y
[
i
] +ğ
Ax
[
p
];

283 
Ën
;

284 
Ën
 = 0; 
gs
[
i
] !ğ
k
; i = 
m_·»Á
[i])

286 
·‰”n
[
Ën
++] = 
i
;

287 
gs
[
i
] = 
k
;

289 
Ën
 > 0)

290 
·‰”n
[--
tİ
] =…©‹º[--
Ën
];

294 
m_dŸg
[
k
] = 
y
[k];

295 
y
[
k
] = 0.0;

296 ; 
tİ
 < 
size
; ++top)

298 
i
 = 
·‰”n
[
tİ
];

299 
SÿÏr
 
yi
 = 
y
[
i
];

300 
y
[
i
] = 0.0;

301 
p2
 = 
Lp
[
i
] + 
m_nÚZ”osP”CŞ
[i];

302 
p
;

303 
p
 = 
Lp
[
i
];… < 
p2
; ++p)

304 
y
[
Li
[
p
]] -ğ
Lx
[p] * 
yi
;

305 
SÿÏr
 
l_ki
 = 
yi
 / 
m_dŸg
[
i
];

306 
m_dŸg
[
k
] -ğ
l_ki
 * 
yi
;

307 
Li
[
p
] = 
k
;

308 
Lx
[
p
] = 
l_ki
;

309 ++
m_nÚZ”osP”CŞ
[
i
];

311 ià(
m_dŸg
[
k
] == 0.0)

313 
ok
 = 
çl£
;

318 
	`ei_®igÃd_¡ack_d–‘e
(
SÿÏr
, 
y
, 
size
);

319 
	`ei_®igÃd_¡ack_d–‘e
(, 
·‰”n
, 
size
);

320 
	`ei_®igÃd_¡ack_d–‘e
(, 
gs
, 
size
);

322  
ok
;

323 
	}
}

326 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

327 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

328 
boŞ
 
	gS·r£LDLT
<
	gM©rixTy³
, 
	gBack’d
>::
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const

330 cÚ¡ 
size
 = 
m_m©rix
.
rows
();

331 
ei_as£¹
(
size
==
b
.
rows
());

332 ià(!
	gm_sucûeded
)

333  
	gçl£
;

335 ià(
	gm_m©rix
.
nÚZ”os
()>0)

336 
	gm_m©rix
.
sŞveTrŸnguÏrInPÏû
(
b
);

337 
	gb
 = 
b
.
cwi£
(è/ 
m_dŸg
;

340 ià(
	gm_m©rix
.
nÚZ”os
()>0)

341 
	gm_m©rix
.
Œª¥o£
().
sŞveTrŸnguÏrInPÏû
(
b
);

343  
	gŒue
;

	@robot/Eigen/src/Sparse/SparseLLT.h

25 #iâdeà
EIGEN_SPARSELLT_H


26 
	#EIGEN_SPARSELLT_H


	)

38 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
 = 
DeçuÉBack’d
>

39 şas 
	cS·r£LLT


41 
´Ùeùed
:

42 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

43 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

44 
	mS·r£M©rix
<
	tSÿÏr
,
	tLow”TrŸnguÏr
> 
	tChŞM©rixTy³
;

47 
	mSu³ºod®FaùÜIsDœty
 = 0x10000,

48 
	mM©rixLIsDœty
 = 0x20000

51 
	gpublic
:

54 
	$S·r£LLT
(
æags
 = 0)

55 : 
	`m_æags
(
æags
), 
	$m_¡©us
(0)

57 
m_´ecisiÚ
 = 
	`R—lSÿÏr
(0.1è* 
Eig’
::
´ecisiÚ
<
R—lSÿÏr
>();

58 
	}
}

62 
	$S·r£LLT
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
æags
 = 0)

63 : 
	`m_m©rix
(
m©rix
.
	`rows
(), m©rix.
	`cŞs
()), 
	`m_æags
(
æags
), 
	$m_¡©us
(0)

65 
m_´ecisiÚ
 = 
	`R—lSÿÏr
(0.1è* 
Eig’
::
´ecisiÚ
<
R—lSÿÏr
>();

66 
	`compu‹
(
m©rix
);

67 
	}
}

82 
	$£tP»cisiÚ
(
R—lSÿÏr
 
v
è{ 
m_´ecisiÚ
 = v; 
	}
}

87 
R—lSÿÏr
 
	$´ecisiÚ
(ècÚ¡ {  
m_´ecisiÚ
; 
	}
}

99 
	$£tFÏgs
(
f
è{ 
m_æags
 = f; 
	}
}

101 
	$æags
(ècÚ¡ {  
m_æags
; 
	}
}

104 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

107 
šlše
 cÚ¡ 
	gChŞM©rixTy³
& 
	$m©rixL
(ècÚ¡ {  
m_m©rix
; 
	}
}

109 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

110 
boŞ
 
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const;

113 
šlše
 
boŞ
 
	$sucûeded
(ècÚ¡ {  
m_sucûeded
; 
	}
}

115 
	g´Ùeùed
:

116 
ChŞM©rixTy³
 
m_m©rix
;

117 
R—lSÿÏr
 
	gm_´ecisiÚ
;

118 
	gm_æags
;

119 
mubË
 
	gm_¡©us
;

120 
boŞ
 
	gm_sucûeded
;

126 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

127 
	gS·r£LLT
<
	gM©rixTy³
,
	gBack’d
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

129 
	`as£¹
(
a
.
	`rows
()=÷.
	`cŞs
());

130 cÚ¡ 
size
 = 
a
.
	`rows
();

131 
m_m©rix
.
	`»size
(
size
, size);

134 
AmbiVeùÜ
<
SÿÏr
> 
	`‹mpVeùÜ
(
size
);

135 
R—lSÿÏr
 
d’s™y
 = 
a
.
	`nÚZ”os
()/
	`R—lSÿÏr
(
size
*size);

138 
m_m©rix
.
	`¡¬tFl
(
a
.
	`nÚZ”os
()*2);

139 
j
 = 0; j < 
size
; ++j)

141 
SÿÏr
 
x
 = 
	`ei_»®
(
a
.
	`cÛff
(
j
,j));

144 
‹mpVeùÜ
.
	`š™
(
d’s™y
>0.001? 
IsD’£
 : 
IsS·r£
);

145 
‹mpVeùÜ
.
	`£tBounds
(
j
+1,
size
);

146 
‹mpVeùÜ
.
	`£tZ”o
();

149 
ty³Çme
 
M©rixTy³
::
IÂ”I‹¿tÜ
 
	`™
(
a
,
j
);

150 ++
™
;

151 ; 
™
; ++it)

152 
‹mpVeùÜ
.
	`cÛffRef
(
™
.
	`šdex
()èğ™.
	`v®ue
();

154 
k
=0; k<
j
+1; ++k)

156 
ty³Çme
 
ChŞM©rixTy³
::
IÂ”I‹¿tÜ
 
	`™
(
m_m©rix
, 
k
);

157 
™
 && it.
	`šdex
()<
j
)

158 ++
™
;

159 ià(
™
 && it.
	`šdex
()==
j
)

161 
SÿÏr
 
y
 = 
™
.
	`v®ue
();

162 
x
 -ğ
	`ei_abs2
(
y
);

163 ++
™
;

164 
‹mpVeùÜ
.
	`»¡¬t
();

165 ; 
™
; ++it)

167 
‹mpVeùÜ
.
	`cÛffRef
(
™
.
	`šdex
()è-ğ™.
	`v®ue
(è* 
y
;

173 
R—lSÿÏr
 
rx
 = 
	`ei_sq¹
(
	`ei_»®
(
x
));

174 
m_m©rix
.
	`fl
(
j
,jèğ
rx
;

175 
SÿÏr
 
y
 = 
	`SÿÏr
(1)/
rx
;

176 
ty³Çme
 
AmbiVeùÜ
<
SÿÏr
>::
I‹¿tÜ
 
	`™
(
‹mpVeùÜ
, 
m_´ecisiÚ
*
rx
); 
™
; ++it)

178 
m_m©rix
.
	`fl
(
™
.
	`šdex
(), 
j
èğ™.
	`v®ue
(è* 
y
;

181 
m_m©rix
.
	`’dFl
();

182 
	}
}

185 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

186 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

187 
boŞ
 
	gS·r£LLT
<
	gM©rixTy³
, 
	gBack’d
>::
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const

189 cÚ¡ 
size
 = 
m_m©rix
.
rows
();

190 
ei_as£¹
(
size
==
b
.
rows
());

192 
	gm_m©rix
.
sŞveTrŸnguÏrInPÏû
(
b
);

194 ià(
	gNumT¿™s
<
	gSÿÏr
>::
IsCom¶ex
)

196 
ChŞM©rixTy³
 
aux
 = 
m_m©rix
.
cÚjug©e
();

197 
	gaux
.
Œª¥o£
().
sŞveTrŸnguÏrInPÏû
(
b
);

200 
	gm_m©rix
.
Œª¥o£
().
sŞveTrŸnguÏrInPÏû
(
b
);

202  
	gŒue
;

	@robot/Eigen/src/Sparse/SparseLU.h

25 #iâdeà
EIGEN_SPARSELU_H


26 
	#EIGEN_SPARSELU_H


	)

38 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
 = 
DeçuÉBack’d
>

39 şas 
	cS·r£LU


41 
´Ùeùed
:

42 
ty³Çme
 
	tM©rixTy³
::
	tSÿÏr
 Scalar;

43 
ty³Çme
 
	tNumT¿™s
<
	tty³Çme
 
	tM©rixTy³
::
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

44 
	mS·r£M©rix
<
	tSÿÏr
,
	tLow”TrŸnguÏr
> 
	tLUM©rixTy³
;

47 
	mM©rixLUIsDœty
 = 0x10000

50 
	gpublic
:

53 
	$S·r£LU
(
æags
 = 0)

54 : 
	`m_æags
(
æags
), 
	$m_¡©us
(0)

56 
m_´ecisiÚ
 = 
	`R—lSÿÏr
(0.1è* 
Eig’
::
´ecisiÚ
<
R—lSÿÏr
>();

57 
	}
}

61 
	$S·r£LU
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
æags
 = 0)

62 : 
	`m_æags
(
æags
), 
	$m_¡©us
(0)

64 
m_´ecisiÚ
 = 
	`R—lSÿÏr
(0.1è* 
Eig’
::
´ecisiÚ
<
R—lSÿÏr
>();

65 
	`compu‹
(
m©rix
);

66 
	}
}

78 
	$£tP»cisiÚ
(
R—lSÿÏr
 
v
è{ 
m_´ecisiÚ
 = v; 
	}
}

83 
R—lSÿÏr
 
	$´ecisiÚ
(ècÚ¡ {  
m_´ecisiÚ
; 
	}
}

93 
	$£tFÏgs
(
f
è{ 
m_æags
 = f; 
	}
}

95 
	$æags
(ècÚ¡ {  
m_æags
; 
	}
}

97 
	$£tOrd”šgM‘hod
(
m
)

99 
	`ei_as£¹
(
m
&~
Ord”šgMask
 == 0 && m!=0 && "invalid ordering method");

100 
m_æags
 = m_æags&~
Ord”šgMask
 | 
m
&OrderingMask;

101 
	}
}

103 
	$Üd”šgM‘hod
() const

105  
m_æags
&
Ord”šgMask
;

106 
	}
}

109 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

117 
	g‹m¶©e
<
ty³Çme
 
	gBD”ived
,y³Çm
	gXD”ived
>

118 
boŞ
 
sŞve
(cÚ¡ 
M©rixBa£
<
BD”ived
> &
b
, M©rixBa£<
XD”ived
>* 
x
) const;

121 
šlše
 
boŞ
 
	$sucûeded
(ècÚ¡ {  
m_sucûeded
; 
	}
}

123 
	g´Ùeùed
:

124 
R—lSÿÏr
 
m_´ecisiÚ
;

125 
	gm_æags
;

126 
mubË
 
	gm_¡©us
;

127 
boŞ
 
	gm_sucûeded
;

133 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

134 
	gS·r£LU
<
	gM©rixTy³
,
	gBack’d
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

136 
	`ei_as£¹
(
çl£
 && "not implemented yet");

137 
	}
}

140 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gBack’d
>

141 
	g‹m¶©e
<
ty³Çme
 
	gBD”ived
,y³Çm
	gXD”ived
>

142 
boŞ
 
	gS·r£LU
<
	gM©rixTy³
,
	gBack’d
>::
sŞve
(cÚ¡ 
M©rixBa£
<
BD”ived
> &
b
, M©rixBa£<
XD”ived
>* 
x
) const

144 
ei_as£¹
(
çl£
 && "not implemented yet");

145  
	gçl£
;

	@robot/Eigen/src/Sparse/SparseMatrix.h

25 #iâdeà
EIGEN_SPARSEMATRIX_H


26 
	#EIGEN_SPARSEMATRIX_H


	)

37 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

38 
	gei_Œa™s
<
	gS·r£M©rix
<
	g_SÿÏr
, 
	g_FÏgs
> >

40 
_SÿÏr
 
	tSÿÏr
;

42 
	gRowsAtCompeTime
 = 
DyÇmic
,

43 
	gCŞsAtCompeTime
 = 
DyÇmic
,

44 
	gMaxRowsAtCompeTime
 = 
DyÇmic
,

45 
	gMaxCŞsAtCompeTime
 = 
DyÇmic
,

46 
	gFÏgs
 = 
S·r£B™
 | 
_FÏgs
,

47 
	gCÛffR—dCo¡
 = 
NumT¿™s
<
SÿÏr
>::
R—dCo¡
,

48 
	gSuµÜ‹dAcûssP©‹ºs
 = 
IÂ”RªdomAcûssP©‹º


54 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

55 
şass
 
	gS·r£M©rix


56 : 
public
 
S·r£M©rixBa£
<
S·r£M©rix
<
_SÿÏr
, 
	g_FÏgs
> >

58 
	gpublic
:

59 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£M©rix
)

60 
EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
S·r£M©rix
, +=)

61 
EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
S·r£M©rix
, -=)

66 
M­³dS·r£M©rix
<
	tSÿÏr
,
	tFÏgs
> 
	tM­
;

68 
	g´Ùeùed
:

70 ’um { 
IsRowMajÜ
 = 
Ba£
::IsRowMajor };

71 
	gS·r£M©rix
<
	tSÿÏr
,(
	tFÏgs
&~
	tRowMajÜB™
)|(
	tIsRowMajÜ
?RowMajÜB™:0)> 
	tT¿n¥o£dS·r£M©rix
;

73 
	gm_ou‹rSize
;

74 
	gm_šÃrSize
;

75 * 
	gm_ou‹rIndex
;

76 
	gCom´es£dStÜage
<
	gSÿÏr
> 
	gm_d©a
;

78 
	gpublic
:

80 
šlše
 
rows
(ècÚ¡ {  
IsRowMajÜ
 ? 
m_ou‹rSize
 : 
m_šÃrSize
; }

81 
šlše
 
cŞs
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gm_šÃrSize
 : 
m_ou‹rSize
; }

83 
šlše
 
šÃrSize
(ècÚ¡ {  
	gm_šÃrSize
; }

84 
šlše
 
ou‹rSize
(ècÚ¡ {  
	gm_ou‹rSize
; }

85 
šlše
 
šÃrNÚZ”os
(
j
ècÚ¡ {  
	gm_ou‹rIndex
[j+1]-m_outerIndex[j]; }

87 
šlše
 cÚ¡ 
SÿÏr
* 
_v®uePŒ
(ècÚ¡ {  &
	gm_d©a
.
v®ue
(0); }

88 
šlše
 
SÿÏr
* 
_v®uePŒ
(è{  &
	gm_d©a
.
v®ue
(0); }

90 
šlše
 cÚ¡ * 
_šÃrIndexPŒ
(ècÚ¡ {  &
	gm_d©a
.
šdex
(0); }

91 
šlše
 * 
_šÃrIndexPŒ
(è{  &
	gm_d©a
.
šdex
(0); }

93 
šlše
 cÚ¡ * 
_ou‹rIndexPŒ
(ècÚ¡ {  
	gm_ou‹rIndex
; }

94 
šlše
 * 
_ou‹rIndexPŒ
(è{  
	gm_ou‹rIndex
; }

96 
šlše
 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

98 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

99 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

100  
	gm_d©a
.
©InRªge
(
m_ou‹rIndex
[
ou‹r
], m_ou‹rIndex[ou‹r+1], 
šÃr
);

103 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

105 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

106 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

108 
	g¡¬t
 = 
m_ou‹rIndex
[
ou‹r
];

109 
	g’d
 = 
m_ou‹rIndex
[
ou‹r
+1];

110 
ei_as£¹
(
’d
>=
¡¬t
 && "you…robably called coeffRef on‡‚on finalized matrix");

111 
ei_as£¹
(
’d
>
¡¬t
 && "coeffRef cannot be called on‡ zero coefficient");

112 cÚ¡ 
	gid
 = 
m_d©a
.
£¬chLow”Index
(
¡¬t
,
’d
-1,
šÃr
);

113 
ei_as£¹
((
id
<
’d
è&& (
m_d©a
.
šdex
(id)==
šÃr
) && "coeffRef cannot be called on‡ zero coefficient");

114  
	gm_d©a
.
v®ue
(
id
);

117 
	gpublic
:

119 
şass
 
IÂ”I‹¿tÜ
;

121 
šlše
 
£tZ”o
()

123 
	gm_d©a
.
ş—r
();

125 
	g¡d
::
mem£t
(
m_ou‹rIndex
, 0, (
m_ou‹rSize
+1)*());

133 
šlše
 
nÚZ”os
(ècÚ¡ {  
	gm_d©a
.
size
(); }

139 
šlše
 
¡¬tFl
(
»£rveSize
 = 1000)

141 
£tZ”o
();

142 
	gm_d©a
.
»£rve
(
»£rveSize
);

147 
šlše
 
	gSÿÏr
& 
fl
(
row
, 
cŞ
)

149 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

150 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

152 ià(
	gm_ou‹rIndex
[
ou‹r
+1]==0)

155 
i
 = 
ou‹r
;

156 
	gi
>=0 && 
m_ou‹rIndex
[
i
]==0)

158 
m_ou‹rIndex
[
i
] = 
m_d©a
.
size
();

159 --
	gi
;

161 
	gm_ou‹rIndex
[
ou‹r
+1] = 
m_ou‹rIndex
[outer];

165 
ei_as£¹
(
m_d©a
.
šdex
(m_d©a.
size
()-1)<
šÃr
 && "wrong sorted insertion");

167 
as£¹
(
¡d
::
size_t
(
m_ou‹rIndex
[
ou‹r
+1]è=ğ
m_d©a
.
size
());

168 
	gid
 = 
m_ou‹rIndex
[
ou‹r
+1];

169 ++
	gm_ou‹rIndex
[
ou‹r
+1];

171 
	gm_d©a
.
­³nd
(0, 
šÃr
);

172  
	gm_d©a
.
v®ue
(
id
);

177 
šlše
 
	gSÿÏr
& 
fÌªd
(
row
, 
cŞ
)

179 cÚ¡ 
	gou‹r
 = 
IsRowMajÜ
 ? 
row
 : 
cŞ
;

180 cÚ¡ 
	gšÃr
 = 
IsRowMajÜ
 ? 
cŞ
 : 
row
;

181 ià(
	gm_ou‹rIndex
[
ou‹r
+1]==0)

185 
i
 = 
ou‹r
;

186 
	gi
>=0 && 
m_ou‹rIndex
[
i
]==0)

188 
m_ou‹rIndex
[
i
] = 
m_d©a
.
size
();

189 --
	gi
;

191 
	gm_ou‹rIndex
[
ou‹r
+1] = 
m_ou‹rIndex
[outer];

193 
as£¹
(
¡d
::
size_t
(
m_ou‹rIndex
[
ou‹r
+1]è=ğ
m_d©a
.
size
() && "invalid outer index");

194 
	g¡d
::
size_t
 
¡¬tId
 = 
m_ou‹rIndex
[
ou‹r
];

196 
	g¡d
::
size_t
 
id
 = 
m_ou‹rIndex
[
ou‹r
+1];

197 ++
	gm_ou‹rIndex
[
ou‹r
+1];

199 
	g»®locR©io
 = 1;

200 ià(
	gm_d©a
.
®loÿ‹dSize
()<
	gid
+1)

205 
	gÂzE¡im©e
 = (
m_ou‹rIndex
[
ou‹r
])*(
m_ou‹rSize
)/(outer);

206 
	g»®locR©io
 = (
ÂzE¡im©e
-(
m_d©a
.
size
()))/(m_data.size());

210 
	g»®locR©io
 = 
¡d
::
mš
(¡d::
max
(
»®locR©io
,1.5f),8.f);

212 
	gm_d©a
.
»size
(
id
+1,
»®locR©io
);

214  (
	gid
 > 
	g¡¬tId
è&& (
	gm_d©a
.
šdex
(
id
-1è> 
	gšÃr
) )

216 
	gm_d©a
.
šdex
(
id
èğ
m_d©a
.index(id-1);

217 
	gm_d©a
.
v®ue
(
id
èğ
m_d©a
.value(id-1);

218 --
	gid
;

221 
	gm_d©a
.
šdex
(
id
èğ
šÃr
;

222  (
	gm_d©a
.
v®ue
(
id
) = 0);

225 
šlše
 
’dFl
()

227 
	gsize
 = 
m_d©a
.
size
();

228 
	gi
 = 
m_ou‹rSize
;

230 
	gi
>=0 && 
m_ou‹rIndex
[
i
]==0)

231 --
i
;

232 ++
	gi
;

233 
	gi
<=
m_ou‹rSize
)

235 
m_ou‹rIndex
[
i
] = 
size
;

236 ++
	gi
;

240 
´uÃ
(
SÿÏr
 
»ã»nû
, 
R—lSÿÏr
 
•sÚ
 = 
´ecisiÚ
<RealScalar>())

242 
k
 = 0;

243 
	gj
=0; j<
	gm_ou‹rSize
; ++j)

245 
	g´eviousS¹
 = 
m_ou‹rIndex
[
j
];

246 
	gm_ou‹rIndex
[
j
] = 
k
;

247 
	g’d
 = 
m_ou‹rIndex
[
j
+1];

248 
	gi
=
´eviousS¹
; i<
	g’d
; ++i)

250 ià(!
ei_isMuchSm®ËrThª
(
m_d©a
.
v®ue
(
i
), 
»ã»nû
, 
•sÚ
))

252 
	gm_d©a
.
v®ue
(
k
èğ
m_d©a
.v®ue(
i
);

253 
	gm_d©a
.
šdex
(
k
èğ
m_d©a
.šdex(
i
);

254 ++
	gk
;

258 
	gm_ou‹rIndex
[
m_ou‹rSize
] = 
k
;

259 
	gm_d©a
.
»size
(
k
,0);

265 
»size
(
rows
, 
cŞs
)

267 cÚ¡ 
	gou‹rSize
 = 
IsRowMajÜ
 ? 
rows
 : 
cŞs
;

268 
	gm_šÃrSize
 = 
IsRowMajÜ
 ? 
cŞs
 : 
rows
;

269 
	gm_d©a
.
ş—r
();

270 ià(
	gm_ou‹rSize
 !ğ
ou‹rSize
 || 
m_ou‹rSize
==0)

272 
d–‘e
[] 
m_ou‹rIndex
;

273 
	gm_ou‹rIndex
 = 
Ãw
 [
ou‹rSize
+1];

274 
	gm_ou‹rSize
 = 
ou‹rSize
;

276 
	g¡d
::
mem£t
(
m_ou‹rIndex
, 0, (
m_ou‹rSize
+1)*());

278 
»sizeNÚZ”os
(
size
)

280 
	gm_d©a
.
»size
(
size
);

283 
šlše
 
S·r£M©rix
()

284 : 
m_ou‹rSize
(-1), 
m_šÃrSize
(0), 
m_ou‹rIndex
(0)

286 
»size
(0, 0);

289 
šlše
 
S·r£M©rix
(
rows
, 
cŞs
)

290 : 
m_ou‹rSize
(0), 
m_šÃrSize
(0), 
m_ou‹rIndex
(0)

292 
»size
(
rows
, 
cŞs
);

295 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

296 
šlše
 
S·r£M©rix
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

297 : 
m_ou‹rSize
(0), 
m_šÃrSize
(0), 
m_ou‹rIndex
(0)

299 *
	gthis
 = 
Ùh”
.
d”ived
();

302 
šlše
 
S·r£M©rix
(cÚ¡ S·r£M©rix& 
Ùh”
)

303 : 
Ba£
(), 
m_ou‹rSize
(0), 
m_šÃrSize
(0), 
m_ou‹rIndex
(0)

305 *
	gthis
 = 
Ùh”
.
d”ived
();

308 
šlše
 
sw­
(
S·r£M©rix
& 
Ùh”
)

311 
	g¡d
::
sw­
(
m_ou‹rIndex
, 
Ùh”
.m_outerIndex);

312 
	g¡d
::
sw­
(
m_šÃrSize
, 
Ùh”
.m_innerSize);

313 
	g¡d
::
sw­
(
m_ou‹rSize
, 
Ùh”
.m_outerSize);

314 
	gm_d©a
.
sw­
(
Ùh”
.
m_d©a
);

317 
šlše
 
	gS·r£M©rix
& 
	gİ”©Ü
=(cÚ¡ 
S·r£M©rix
& 
Ùh”
)

320 ià(
Ùh”
.
isRV®ue
())

322 
sw­
(
Ùh”
.
cÚ¡_ÿ¡_d”ived
());

326 
»size
(
Ùh”
.
rows
(), oth”.
cŞs
());

327 
	g¡d
::
memıy
(
m_ou‹rIndex
, 
Ùh”
.m_ou‹rIndex, (
m_ou‹rSize
+1)*());

328 
	gm_d©a
 = 
Ùh”
.
m_d©a
;

330  *
	gthis
;

333 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

334 
šlše
 
	gS·r£M©rix
& 
	gİ”©Ü
=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

336 cÚ¡ 
boŞ
 
ÃedToT¿n¥o£
 = (
FÏgs
 & 
RowMajÜB™
è!ğ(
Oth”D”ived
::Flags & RowMajorBit);

337 ià(
	gÃedToT¿n¥o£
)

344 
ty³Çme
 
	tei_ev®
<
	tOth”D”ived
>::
	tty³
 
	tOth”Cİy
;

345 
ty³Çme
 
	tei_ş—Áy³
<
	tOth”Cİy
>::
	tty³
 
	t_Oth”Cİy
;

346 
Oth”Cİy
 
Ùh”Cİy
(
Ùh”
.
d”ived
());

348 
»size
(
Ùh”
.
rows
(), oth”.
cŞs
());

349 
	gEig’
::
M­
<
VeùÜXi
>(
m_ou‹rIndex
,
ou‹rSize
()).
£tZ”o
();

352 
	gj
=0; j<
	gÙh”Cİy
.
ou‹rSize
(); ++j)

353 
ty³Çme
 
	g_Oth”Cİy
::
IÂ”I‹¿tÜ
 
™
(
Ùh”Cİy
, 
j
); 
	g™
; ++it)

354 ++
	gm_ou‹rIndex
[
™
.
šdex
()];

357 
	gcouÁ
 = 0;

358 
VeùÜXi
 
pos™iÚs
(
ou‹rSize
());

359 
	gj
=0; j<
ou‹rSize
(); ++j)

361 
	gtmp
 = 
m_ou‹rIndex
[
j
];

362 
	gm_ou‹rIndex
[
j
] = 
couÁ
;

363 
	gpos™iÚs
[
j
] = 
couÁ
;

364 
	gcouÁ
 +ğ
tmp
;

366 
	gm_ou‹rIndex
[
ou‹rSize
()] = 
couÁ
;

368 
	gm_d©a
.
»size
(
couÁ
);

370 
	gj
=0; j<
	gÙh”Cİy
.
ou‹rSize
(); ++j)

371 
ty³Çme
 
	g_Oth”Cİy
::
IÂ”I‹¿tÜ
 
™
(
Ùh”Cİy
, 
j
); 
	g™
; ++it)

373 
	gpos
 = 
pos™iÚs
[
™
.
šdex
()]++;

374 
	gm_d©a
.
šdex
(
pos
èğ
j
;

375 
	gm_d©a
.
v®ue
(
pos
èğ
™
.value();

378  *
	gthis
;

383  
	gS·r£M©rixBa£
<
	gS·r£M©rix
>::
İ”©Ü
=(
Ùh”
.
d”ived
());

387 
ä›nd
 
	g¡d
::
o¡»am
 & 
İ”©Ü
 << (
¡d
::o¡»am & 
s
, cÚ¡ 
	gS·r£M©rix
& 
	gm
)

389 
EIGEN_DBG_SPARSE
(

390 
s
 << "Nonzeroƒntries:\n";

391 
i
=0; i<
m
.
nÚZ”os
(); ++i)

393 
s
 << "(" << 
m
.
m_d©a
.
v®ue
(
i
è<< "," << m.m_d©a.
šdex
(i) << ") ";

395 
s
 << 
¡d
::
’dl
;

396 
s
 << 
¡d
::
’dl
;

397 
s
 << "Column…ointers:\n";

398 
i
=0; i<
m
.
ou‹rSize
(); ++i)

400 
s
 << 
m
.
m_ou‹rIndex
[
i
] << " ";

402 
s
 << " $" << 
¡d
::
’dl
;

403 
s
 << 
¡d
::
’dl
;

405 
	gs
 << 
	g¡©ic_ÿ¡
<cÚ¡ 
	gS·r£M©rixBa£
<
	gS·r£M©rix
>&>(
	gm
);

406  
	gs
;

410 
	gšlše
 ~
S·r£M©rix
()

412 
	gd–‘e
[] 
	gm_ou‹rIndex
;

416 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	g_FÏgs
>

417 
şass
 
	gS·r£M©rix
<
	gSÿÏr
,
	g_FÏgs
>::
IÂ”I‹¿tÜ


419 
public
:

420 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£M©rix
& 
m©
, 
ou‹r
)

421 : 
m_m©rix
(
m©
), 
m_ou‹r
(
ou‹r
), 
m_id
(m©.
m_ou‹rIndex
[ou‹r]), 
m_¡¬t
(m_id), 
m_’d
(mat.m_outerIndex[outer+1])

424 
	g‹m¶©e
<
	gAdded
, 
	gRemoved
>

425 
IÂ”I‹¿tÜ
(cÚ¡ 
FÏgged
<
S·r£M©rix
,
Added
,
Removed
>& 
m©
, 
ou‹r
)

426 : 
m_m©rix
(
m©
.
_ex´essiÚ
()), 
m_ou‹r
(
ou‹r
), 
m_id
(m_m©rix.
m_ou‹rIndex
[outer]),

427 
m_¡¬t
(
m_id
), 
m_’d
(
m_m©rix
.
m_ou‹rIndex
[
ou‹r
+1])

430 
šlše
 
	gIÂ”I‹¿tÜ
& 
	gİ”©Ü
++(è{ 
	gm_id
++;  *
	gthis
; }

432 
šlše
 
SÿÏr
 
v®ue
(ècÚ¡ {  
	gm_m©rix
.
	gm_d©a
.v®ue(
m_id
); }

433 
šlše
 
	gSÿÏr
& 
v®ueRef
(è{  
	gcÚ¡_ÿ¡
<SÿÏr&>(
	gm_m©rix
.
	gm_d©a
.
v®ue
(
m_id
)); }

435 
šlše
 
šdex
(ècÚ¡ {  
	gm_m©rix
.
	gm_d©a
.šdex(
m_id
); }

436 
šlše
 
row
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
	gm_ou‹r
 : 
šdex
(); }

437 
šlše
 
cŞ
(ècÚ¡ {  
	gIsRowMajÜ
 ? 
šdex
(è: 
m_ou‹r
; }

439 
šlše
 
İ”©Ü
 
boŞ
(ècÚ¡ {  (
	gm_id
 < 
	gm_’d
è&& (m_id>=
m_¡¬t
); }

441 
	g´Ùeùed
:

442 cÚ¡ 
S·r£M©rix
& 
m_m©rix
;

443 cÚ¡ 
	gm_ou‹r
;

444 
	gm_id
;

445 cÚ¡ 
	gm_¡¬t
;

446 cÚ¡ 
	gm_’d
;

448 
	g´iv©e
:

449 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

	@robot/Eigen/src/Sparse/SparseMatrixBase.h

25 #iâdeà
EIGEN_SPARSEMATRIXBASE_H


26 
	#EIGEN_SPARSEMATRIXBASE_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> cÏs 
	cS·r£M©rixBa£


30 
	mpublic
:

32 
ty³Çme
 
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
 Scalar;

37 
	mRowsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
RowsAtCompeTime
,

43 
	mCŞsAtCompeTime
 = 
ei_Œa™s
<
D”ived
>::
CŞsAtCompeTime
,

50 
	mSizeAtCompeTime
 = (
ei_size_©_compe_time
<
ei_Œa™s
<
D”ived
>::
RowsAtCompeTime
,

51 
	mei_Œa™s
<
	mD”ived
>::
CŞsAtCompeTime
>::
»t
),

56 
	mMaxRowsAtCompeTime
 = 
RowsAtCompeTime
,

57 
	mMaxCŞsAtCompeTime
 = 
CŞsAtCompeTime
,

59 
	mMaxSizeAtCompeTime
 = (
ei_size_©_compe_time
<
MaxRowsAtCompeTime
,

60 
	mMaxCŞsAtCompeTime
>::
»t
),

62 
	mIsVeùÜAtCompeTime
 = 
RowsAtCompeTime
 =ğ1 || 
CŞsAtCompeTime
 == 1,

68 
	mFÏgs
 = 
ei_Œa™s
<
D”ived
>::
FÏgs
,

73 
	mCÛffR—dCo¡
 = 
ei_Œa™s
<
D”ived
>::
CÛffR—dCo¡
,

78 
	mIsRowMajÜ
 = 
FÏgs
&
RowMajÜB™
 ? 1 : 0

82 
ty³Çme
 
	tei_m‘a_if
<
	tNumT¿™s
<
	tSÿÏr
>::
	tIsCom¶ex
,

83 cÚ¡ 
	tS·r£Cwi£UÇryOp
<
	tei_sÿÏr_cÚjug©e_İ
<
	tSÿÏr
>, 
	tD”ived
>,

84 cÚ¡ 
	tD”ived
&

85 >::
	t»t
 
	tCÚjug©eR‘uºTy³
;

87 
	gCwi£UÇryOp
<
	tei_sÿÏr_»®_İ
<
	tSÿÏr
>, 
	tD”ived
> 
	tR—lR‘uºTy³
;

89 
	gCwi£UÇryOp
<
	tei_sÿÏr_imag_İ
<
	tSÿÏr
>, 
	tD”ived
> 
	tImagR‘uºTy³
;

91 
	gS·r£T¿n¥o£
< 
	tty³Çme
 
	tei_ş—Áy³
<
	tCÚjug©eR‘uºTy³
>::
	tty³
>

92 
	tAdjoštR‘uºTy³
;

94 #iâdeà
EIGEN_PARSED_BY_DOXYGEN


101 
ty³Çme
 
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
;

104 
	gM©rix
<
	tSÿÏr
,
	tEIGEN_ENUM_MAX
(
	tRowsAtCompeTime
,
	tCŞsAtCompeTime
),

105 
	tEIGEN_ENUM_MAX
(
	tRowsAtCompeTime
,
	tCŞsAtCompeTime
)> 
	tSqu¬eM©rixTy³
;

107 
šlše
 cÚ¡ 
	gD”ived
& 
	$d”ived
(ècÚ¡ {  *
¡©ic_ÿ¡
<cÚ¡ 
D”ived
*>(
this
); 
	}
}

108 
šlše
 
	gD”ived
& 
	$d”ived
(è{  *
¡©ic_ÿ¡
<
D”ived
*>(
this
); 
	}
}

109 
šlše
 
	gD”ived
& 
	$cÚ¡_ÿ¡_d”ived
() const

110 {  *
¡©ic_ÿ¡
<
D”ived
*>(
cÚ¡_ÿ¡
<
S·r£M©rixBa£
*>(
this
)); 
	}
}

114 
šlše
 
	$rows
(ècÚ¡ {  
	`d”ived
().
	`rows
(); 
	}
}

116 
šlše
 
	$cŞs
(ècÚ¡ {  
	`d”ived
().
	`cŞs
(); 
	}
}

119 
šlše
 
	$size
(ècÚ¡ {  
	`rows
(è* 
	`cŞs
(); 
	}
}

122 
šlše
 
	$nÚZ”os
(ècÚ¡ {  
	`d”ived
().
	`nÚZ”os
(); 
	}
}

127 
šlše
 
boŞ
 
	$isVeùÜ
(ècÚ¡ {  
	`rows
()==1 || 
	`cŞs
()==1; 
	}
}

130 
	$ou‹rSize
(ècÚ¡ {  ((
FÏgs
)&
RowMajÜB™
è? 
this
->
	`rows
(è:his->
	`cŞs
(); 
	}
}

133 
	$šÃrSize
(ècÚ¡ {  ((
FÏgs
)&
RowMajÜB™
è? 
this
->
	`cŞs
(è:his->
	`rows
(); 
	}
}

135 
boŞ
 
	$isRV®ue
(ècÚ¡ {  
m_isRV®ue
; 
	}
}

136 
	gD”ived
& 
	$m¬kAsRV®ue
(è{ 
m_isRV®ue
 = 
Œue
;  
	`d”ived
(); 
	}
}

138 
	$S·r£M©rixBa£
(è: 
	$m_isRV®ue
(
çl£
è{ 
	}
}

140 
šlše
 
D”ived
& 
İ”©Ü
=(cÚ¡ D”ived& 
Ùh”
)

146 
this
->
İ”©Ü
=<
D”ived
>(
Ùh”
);

147  
d”ived
();

151 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

152 
šlše
 
	$assignG’”ic
(cÚ¡ 
Oth”D”ived
& 
Ùh”
)

156 
	`ei_as£¹
(Ğ((
ei_Œa™s
<
D”ived
>::
SuµÜ‹dAcûssP©‹ºs
&
Ou‹rRªdomAcûssP©‹º
)==OuterRandomAccessPattern) ||

157 (!((
FÏgs
 & 
RowMajÜB™
è!ğ(
Oth”D”ived
::Flags & RowMajorBit)))) &&

160 cÚ¡ 
ou‹rSize
 = 
Ùh”
.
	`ou‹rSize
();

163 
D”ived
 
	`‹mp
(
Ùh”
.
	`rows
(), oth”.
	`cŞs
());

165 
‹mp
.
	`¡¬tFl
(
¡d
::
	`max
(
this
->
	`rows
(),this->
	`cŞs
())*2);

166 
j
=0; j<
ou‹rSize
; ++j)

168 
ty³Çme
 
Oth”D”ived
::
IÂ”I‹¿tÜ
 
	`™
(
Ùh”
.
	`d”ived
(), 
j
); 
™
; ++it)

170 
SÿÏr
 
v
 = 
™
.
	`v®ue
();

171 ià(
v
!=
	`SÿÏr
(0))

173 ià(
Oth”D”ived
::
FÏgs
 & 
RowMajÜB™
è
‹mp
.
	`fl
(
j
,
™
.
	`šdex
()èğ
v
;

174 
‹mp
.
	`fl
(
™
.
	`šdex
(),
j
èğ
v
;

178 
‹mp
.
	`’dFl
();

180 
	`d”ived
(èğ
‹mp
.
	`m¬kAsRV®ue
();

181 
	}
}

184 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

185 
šlše
 
	gD”ived
& 
	gİ”©Ü
=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

189 cÚ¡ 
boŞ
 
Œª¥o£
 = (
FÏgs
 & 
RowMajÜB™
è!ğ(
Oth”D”ived
::Flags & RowMajorBit);

191 cÚ¡ 
	gou‹rSize
 = ((
Oth”D”ived
::
FÏgs
è& 
RowMajÜB™
è? 
Ùh”
.
rows
(è: oth”.
cŞs
();

192 ià((!
	gŒª¥o£
è&& 
	gÙh”
.
isRV®ue
())

195 
d”ived
().
»size
(
Ùh”
.
rows
(), oth”.
cŞs
());

196 
d”ived
().
¡¬tFl
(
¡d
::
max
(
this
->
rows
(),this->
cŞs
())*2);

197 
	gj
=0; j<
	gou‹rSize
; ++j)

199 
ty³Çme
 
	gOth”D”ived
::
IÂ”I‹¿tÜ
 
™
(
Ùh”
.
d”ived
(), 
j
); 
	g™
; ++it)

201 
SÿÏr
 
	gv
 = 
™
.
v®ue
();

202 ià(
	gv
!=
SÿÏr
(0))

204 ià(
IsRowMajÜ
è
d”ived
().
fl
(
j
,
™
.
šdex
()èğ
v
;

205 
d”ived
().
fl
(
™
.
šdex
(),
j
èğ
v
;

209 
d”ived
().
’dFl
();

213 
assignG’”ic
(
Ùh”
.
d”ived
());

215  
d”ived
();

218 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

219 
šlše
 
	gD”ived
& 
	gİ”©Ü
=(cÚ¡ 
S·r£Produù
<
Lhs
,
	gRhs
,
	gS·r£TimeS·r£Produù
>& 
	g´oduù
);

221 
ä›nd
 
	g¡d
::
o¡»am
 & 
İ”©Ü
 << (
¡d
::o¡»am & 
s
, cÚ¡ 
	gS·r£M©rixBa£
& 
	gm
)

223 ià(
	gFÏgs
&
	gRowMajÜB™
)

225 
	grow
=0;„ow<
	gm
.
ou‹rSize
(); ++row)

227 
	gcŞ
 = 0;

228 
ty³Çme
 
	gD”ived
::
IÂ”I‹¿tÜ
 
™
(
m
.
d”ived
(), 
row
); 
	g™
; ++it)

230  ; 
	gcŞ
<
	g™
.
šdex
(); ++col)

231 
	gs
 << "0 ";

232 
	gs
 << 
	g™
.
v®ue
() << " ";

233 ++
	gcŞ
;

235  ; 
	gcŞ
<
	gm
.
cŞs
(); ++col)

236 
	gs
 << "0 ";

237 
	gs
 << 
	g¡d
::
’dl
;

242 ià(
	gm
.
cŞs
() == 1) {

243 
row
 = 0;

244 
ty³Çme
 
	gD”ived
::
IÂ”I‹¿tÜ
 
™
(
m
.
d”ived
(), 0); 
	g™
; ++it)

246  ; 
	grow
<
	g™
.
šdex
(); ++row)

247 
	gs
 << "0" << 
	g¡d
::
’dl
;

248 
	gs
 << 
	g™
.
v®ue
(è<< 
	g¡d
::
’dl
;

249 ++
	grow
;

251  ; 
	grow
<
	gm
.
rows
(); ++row)

252 
	gs
 << "0" << 
	g¡d
::
’dl
;

256 
	gS·r£M©rix
<
	gSÿÏr
, 
	gRowMajÜB™
> 
	gŒªs
 = 
m
.
d”ived
();

257 
	gs
 << 
	gŒªs
;

260  
	gs
;

263 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_İpos™e_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>,D”ived> 
	gİ”©Ü
-() const;

265 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

266 cÚ¡ 
	gS·r£Cwi£Bš¬yOp
<
	gei_sÿÏr_sum_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, D”ived, 
	gOth”D”ived
>

267 
	gİ”©Ü
+(cÚ¡ 
	gS·r£M©rixBa£
<
	gOth”D”ived
> &
	gÙh”
) const;

269 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

270 cÚ¡ 
	gS·r£Cwi£Bš¬yOp
<
	gei_sÿÏr_difã»nû_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, D”ived, 
	gOth”D”ived
>

271 
	gİ”©Ü
-(cÚ¡ 
	gS·r£M©rixBa£
<
	gOth”D”ived
> &
	gÙh”
) const;

273 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

274 
	gD”ived
& 
	gİ”©Ü
+=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

275 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

276 
	gD”ived
& 
	gİ”©Ü
-=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

281 
	gD”ived
& 
	gİ”©Ü
*=(cÚ¡ 
SÿÏr
& 
Ùh”
);

282 
	gD”ived
& 
	gİ”©Ü
/=(cÚ¡ 
SÿÏr
& 
Ùh”
);

284 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_muÉË_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

285 
	gİ”©Ü
*(cÚ¡ 
	gSÿÏr
& 
	gsÿÏr
) const;

286 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_quÙ›Á1_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

287 
	gİ”©Ü
/(cÚ¡ 
	gSÿÏr
& 
	gsÿÏr
) const;

289 
šlše
 
ä›nd
 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_muÉË_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
>, Derived>

290 
	gİ”©Ü
*(cÚ¡ 
	gSÿÏr
& 
	gsÿÏr
, cÚ¡ 
	gS·r£M©rixBa£
& 
	gm©rix
)

291 {  
m©rix
*
	gsÿÏr
; }

294 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

295 cÚ¡ 
ty³Çme
 
	gS·r£ProduùR‘uºTy³
<
	gD”ived
,
	gOth”D”ived
>::
Ty³


296 
İ”©Ü
*(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

299 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
> 
ä›nd


300 cÚ¡ 
ty³Çme
 
	gS·r£ProduùR‘uºTy³
<
	gOth”D”ived
,
	gD”ived
>::
Ty³


301 
İ”©Ü
*(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
lhs
, cÚ¡ 
	gD”ived
& 
	grhs
)

302 {  
ty³Çme
 
	gS·r£ProduùR‘uºTy³
<
	gOth”D”ived
,
	gD”ived
>::
Ty³
(
lhs
.
d”ived
(),
rhs
); }

304 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

305 cÚ¡ 
ty³Çme
 
	gS·r£ProduùR‘uºTy³
<
	gD”ived
,
	gOth”D”ived
>::
Ty³


306 
İ”©Ü
*(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const;

308 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

309 
	gD”ived
& 
	gİ”©Ü
*=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
);

311 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

312 
ty³Çme
 
	gei_¶aš_m©rix_ty³_cŞumn_majÜ
<
	gOth”D”ived
>::
ty³


313 
sŞveTrŸnguÏr
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

315 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

316 
sŞveTrŸnguÏrInPÏû
(
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

318 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
> 
SÿÏr
 
dÙ
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

319 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
> 
SÿÏr
 
dÙ
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const;

320 
R—lSÿÏr
 
	$squ¬edNÜm
() const;

321 
R—lSÿÏr
 
	$nÜm
() const;

325 
S·r£T¿n¥o£
<
D”ived
> 
	$Œª¥o£
(è{  
	`d”ived
(); 
	}
}

326 cÚ¡ 
	gS·r£T¿n¥o£
<
	gD”ived
> 
	$Œª¥o£
(ècÚ¡ {  
	`d”ived
(); 
	}
}

328 cÚ¡ 
AdjoštR‘uºTy³
 
	$adjošt
(ècÚ¡ {  
	`cÚjug©e
(è; 
	}
}

331 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
row
(
i
);

332 cÚ¡ 
	gS·r£IÂ”VeùÜS‘
<
	gD”ived
,1> 
	$row
(
i
) const;

333 
S·r£IÂ”VeùÜS‘
<
D”ived
,1> 
	`cŞ
(
j
);

334 cÚ¡ 
S·r£IÂ”VeùÜS‘
<
D”ived
,1> 
	$cŞ
(
j
) const;

335 
S·r£IÂ”VeùÜS‘
<
D”ived
,1> 
	`šÃrVeùÜ
(
ou‹r
);

336 cÚ¡ 
S·r£IÂ”VeùÜS‘
<
D”ived
,1> 
	$šÃrVeùÜ
(
ou‹r
) const;

339 
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
> 
	`subrows
(
¡¬t
, 
size
);

340 cÚ¡ 
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
> 
	$subrows
(
¡¬t
, 
size
) const;

341 
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
> 
	`subcŞs
(
¡¬t
, 
size
);

342 cÚ¡ 
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
> 
	$subcŞs
(
¡¬t
, 
size
) const;

343 
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
> 
	`šÃrVeùÜs
(
ou‹rS¹
, 
ou‹rSize
);

344 cÚ¡ 
S·r£IÂ”VeùÜS‘
<
D”ived
,
DyÇmic
> 
	$šÃrVeùÜs
(
ou‹rS¹
, 
ou‹rSize
) const;

422 
M©rix
<
SÿÏr
,
RowsAtCompeTime
,
CŞsAtCompeTime
> 
	$toD’£
() const

424 
M©rix
<
SÿÏr
,
RowsAtCompeTime
,
CŞsAtCompeTime
> 
	`»s
(
	`rows
(),
	`cŞs
());

425 
»s
.
	`£tZ”o
();

426 
j
=0; j<
	`ou‹rSize
(); ++j)

428 
ty³Çme
 
D”ived
::
IÂ”I‹¿tÜ
 
	`i
(
	`d”ived
(),
j
); 
i
; ++i)

429 if(
IsRowMajÜ
)

430 
»s
.
	`cÛffRef
(
j
,
i
.
	`šdex
()èği.
	`v®ue
();

432 
»s
.
	`cÛffRef
(
i
.
	`šdex
(),
j
èği.
	`v®ue
();

434  
»s
;

435 
	}
}

437 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

438 
boŞ
 
isAµrox
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

439 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const

440 {  
toD’£
().
isAµrox
(
Ùh”
.toD’£(),
´ec
); }

442 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

443 
boŞ
 
isAµrox
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
,

444 
R—lSÿÏr
 
´ec
 = 
´ecisiÚ
<
SÿÏr
>()) const

445 {  
toD’£
().
isAµrox
(
Ùh”
,
´ec
); }

475 
	g‹m¶©e
<
ty³Çme
 
	gNewTy³
>

476 cÚ¡ 
	gS·r£Cwi£UÇryOp
<
	gei_sÿÏr_ÿ¡_İ
<
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr
, 
	gNewTy³
>, D”ived> 
	$ÿ¡
() const;

483 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
ei_ev®
<
D”ived
>::
ty³
 
	$ev®
() const

484 {  
ty³Çme
 
ei_ev®
<
D”ived
>::
	`ty³
(
	`d”ived
()); 
	}
}

489 
	g‹m¶©e
<
	gAdded
>

490 cÚ¡ 
	gS·r£FÏgged
<
	gD”ived
, 
	gAdded
, 0> 
	$m¬ked
() const;

503 
CÚjug©eR‘uºTy³
 
	$cÚjug©e
() const;

504 cÚ¡ 
R—lR‘uºTy³
 
	$»®
() const;

505 cÚ¡ 
ImagR‘uºTy³
 
	$imag
() const;

507 
‹m¶©e
<
ty³Çme
 
Cu¡omUÇryOp
>

508 cÚ¡ 
S·r£Cwi£UÇryOp
<
Cu¡omUÇryOp
, 
D”ived
> 
	`uÇryEx´
(cÚ¡ Cu¡omUÇryOp& 
func
 = 
	$Cu¡omUÇryOp
()) const;

515 
SÿÏr
 
	$sum
() const;

532 cÚ¡ 
S·r£Cwi£
<
D”ived
> 
	$cwi£
() const;

533 
S·r£Cwi£
<
D”ived
> 
	`cwi£
();

609 #ifdeà
EIGEN_TAUCS_SUPPORT


610 
ucs_ccs_m©rix
 
	`asTaucsM©rix
();

613 #ifdeà
EIGEN_CHOLMOD_SUPPORT


614 
chŞmod_¥¬£
 
	`asChŞmodM©rix
();

617 #ifdeà
EIGEN_SUPERLU_SUPPORT


618 
SluM©rix
 
	`asSluM©rix
();

621 
´Ùeùed
:

623 
boŞ
 
m_isRV®ue
;

624 
	}
};

	@robot/Eigen/src/Sparse/SparseProduct.h

25 #iâdeà
EIGEN_SPARSEPRODUCT_H


26 
	#EIGEN_SPARSEPRODUCT_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
> 
	sei_¥¬£_´oduù_mode


32 
	mv®ue
 = ((
Lhs
::
FÏgs
&
DŸgÚ®
)==DŸgÚ® || (
Rhs
::Flags&Diagonal)==Diagonal)

33 ? 
DŸgÚ®Produù


34 : (
Rhs
::
FÏgs
&
Lhs
::FÏgs&
S·r£B™
)==SparseBit

35 ? 
S·r£TimeS·r£Produù


36 : (
Lhs
::
FÏgs
&
S·r£B™
)==SparseBit

37 ? 
S·r£TimeD’£Produù


38 : 
D’£TimeS·r£Produù
 };

41 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gProduùMode
>

42 
	sS·r£ProduùR‘uºTy³


44 cÚ¡ 
	tty³Çme
 
	tei_Ã¡ed
<
	tLhs
,
	tRhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tLhsNe¡ed
;

45 cÚ¡ 
	tty³Çme
 
	tei_Ã¡ed
<
	tRhs
,
	tLhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tRhsNe¡ed
;

47 
	mS·r£Produù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
, 
	tProduùMode
> 
	tTy³
;

50 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

51 
	gS·r£ProduùR‘uºTy³
<
	gLhs
,
	gRhs
,
	gDŸgÚ®Produù
>

53 cÚ¡ 
	tty³Çme
 
	tei_Ã¡ed
<
	tLhs
,
	tRhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tLhsNe¡ed
;

54 cÚ¡ 
	tty³Çme
 
	tei_Ã¡ed
<
	tRhs
,
	tLhs
::
	tRowsAtCompeTime
>::
	tty³
 
	tRhsNe¡ed
;

56 
	gS·r£DŸgÚ®Produù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
> 
	tTy³
;

60 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

61 
	gS·r£ProduùR‘uºTy³
<
	gLhs
,
	gRhs
,
	gS·r£TimeS·r£Produù
>

63 
ty³Çme
 
	tei_Œa™s
<
	tLhs
>::
	tSÿÏr
 Scalar;

65 
	gLhsRowMajÜ
 = 
ei_Œa™s
<
Lhs
>::
FÏgs
 & 
RowMajÜB™
,

66 
	gRhsRowMajÜ
 = 
ei_Œa™s
<
Rhs
>::
FÏgs
 & 
RowMajÜB™
,

67 
	gT¿n¥o£Rhs
 = (!
LhsRowMajÜ
è&& 
RhsRowMajÜ
,

68 
	gT¿n¥o£Lhs
 = 
LhsRowMajÜ
 && (!
RhsRowMajÜ
)

73 
ty³Çme
 
	tei_m‘a_if
<
	tT¿n¥o£Lhs
,

74 
	tS·r£M©rix
<
	tSÿÏr
,0>,

75 cÚ¡ 
	tty³Çme
 
	tei_Ã¡ed
<
	tLhs
,
	tRhs
::
	tRowsAtCompeTime
>::
	tty³
>::
	t»t
 
	tLhsNe¡ed
;

77 
ty³Çme
 
	tei_m‘a_if
<
	tT¿n¥o£Rhs
,

78 
	tS·r£M©rix
<
	tSÿÏr
,0>,

79 cÚ¡ 
	tty³Çme
 
	tei_Ã¡ed
<
	tRhs
,
	tLhs
::
	tRowsAtCompeTime
>::
	tty³
>::
	t»t
 
	tRhsNe¡ed
;

81 
	gS·r£Produù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
, 
	tS·r£TimeS·r£Produù
> 
	tTy³
;

84 
	g‹m¶©e
<
ty³Çme
 
	gLhsNe¡ed
,y³Çm
	gRhsNe¡ed
, 
	gProduùMode
>

85 
	gei_Œa™s
<
	gS·r£Produù
<
	gLhsNe¡ed
, 
	gRhsNe¡ed
, 
	gProduùMode
> >

88 
ty³Çme
 
	tei_ş—Áy³
<
	tLhsNe¡ed
>::
	tty³
 
	t_LhsNe¡ed
;

89 
ty³Çme
 
	tei_ş—Áy³
<
	tRhsNe¡ed
>::
	tty³
 
	t_RhsNe¡ed
;

90 
ty³Çme
 
	t_LhsNe¡ed
::
	tSÿÏr
 Scalar;

93 
	gLhsCÛffR—dCo¡
 = 
_LhsNe¡ed
::
CÛffR—dCo¡
,

94 
	gRhsCÛffR—dCo¡
 = 
_RhsNe¡ed
::
CÛffR—dCo¡
,

95 
	gLhsFÏgs
 = 
_LhsNe¡ed
::
FÏgs
,

96 
	gRhsFÏgs
 = 
_RhsNe¡ed
::
FÏgs
,

98 
	gRowsAtCompeTime
 = 
_LhsNe¡ed
::
RowsAtCompeTime
,

99 
	gCŞsAtCompeTime
 = 
_RhsNe¡ed
::
CŞsAtCompeTime
,

100 
	gIÂ”Size
 = 
EIGEN_SIZE_MIN
(
_LhsNe¡ed
::
CŞsAtCompeTime
, 
_RhsNe¡ed
::
RowsAtCompeTime
),

102 
	gMaxRowsAtCompeTime
 = 
_LhsNe¡ed
::
MaxRowsAtCompeTime
,

103 
	gMaxCŞsAtCompeTime
 = 
_RhsNe¡ed
::
MaxCŞsAtCompeTime
,

108 
	gEv®ToRowMajÜ
 = (
RhsFÏgs
 & 
LhsFÏgs
 & 
RowMajÜB™
),

109 
	gResuÉIsS·r£
 = 
ProduùMode
==
S·r£TimeS·r£Produù
 || ProduùMode==
DŸgÚ®Produù
,

111 
	gRemovedB™s
 = ~Ğ(
Ev®ToRowMajÜ
 ? 0 : 
RowMajÜB™
è| (
ResuÉIsS·r£
 ? 0 : 
S·r£B™
) ),

113 
	gFÏgs
 = ((
LhsFÏgs
 | 
RhsFÏgs
è& 
H”ed™¬yB™s
 & 
RemovedB™s
)

114 | 
Ev®BefÜeAssignšgB™


115 | 
Ev®BefÜeNe¡šgB™
,

117 
	gCÛffR—dCo¡
 = 
DyÇmic


120 
ty³Çme
 
	tei_m‘a_if
<
	tResuÉIsS·r£
,

121 
	tS·r£M©rixBa£
<
	tS·r£Produù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
, 
	tProduùMode
> >,

122 
	tM©rixBa£
<
	tS·r£Produù
<
	tLhsNe¡ed
, 
	tRhsNe¡ed
, 
	tProduùMode
> > >::
	t»t
 
	tBa£
;

125 
	g‹m¶©e
<
ty³Çme
 
	gLhsNe¡ed
,y³Çm
	gRhsNe¡ed
, 
	gProduùMode
>

126 
şass
 
	gS·r£Produù
 : 
ei_no_assignm’t_İ”©Ü
,

127 
public
 
	gei_Œa™s
<
	gS·r£Produù
<
	gLhsNe¡ed
, 
	gRhsNe¡ed
, 
	gProduùMode
> >::
Ba£


129 
public
:

131 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
S·r£Produù
)

133 
´iv©e
:

135 
ty³Çme
 
	tei_Œa™s
<
	tS·r£Produù
>::
	t_LhsNe¡ed
 _LhsNested;

136 
ty³Çme
 
	tei_Œa™s
<
	tS·r£Produù
>::
	t_RhsNe¡ed
 _RhsNested;

138 
	gpublic
:

140 
‹m¶©e
<
ty³Çme
 
Lhs
,y³Çm
	gRhs
>

141 
EIGEN_STRONG_INLINE
 
S·r£Produù
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
)

142 : 
m_lhs
(
lhs
), 
m_rhs
(
rhs
)

144 
ei_as£¹
(
lhs
.
cŞs
(è=ğ
rhs
.
rows
());

147 
	gProduùIsV®id
 = 
_LhsNe¡ed
::
CŞsAtCompeTime
==
DyÇmic


148 || 
_RhsNe¡ed
::
RowsAtCompeTime
==
DyÇmic


149 || (
_LhsNe¡ed
::
CŞsAtCompeTime
)==(
_RhsNe¡ed
::
RowsAtCompeTime
),

150 
	gA»VeùÜs
 = 
_LhsNe¡ed
::
IsVeùÜAtCompeTime
 && 
_RhsNe¡ed
::IsVectorAtCompileTime,

151 
	gSameSizes
 = 
EIGEN_PREDICATE_SAME_MATRIX_SIZE
(
_LhsNe¡ed
,
_RhsNe¡ed
)

156 
EIGEN_STATIC_ASSERT
(
ProduùIsV®id
 || !(
A»VeùÜs
 && 
SameSizes
),

157 
INVALID_VECTOR_VECTOR_PRODUCT__IF_YOU_WANTED_A_DOT_OR_COEFF_WISE_PRODUCT_YOU_MUST_USE_THE_EXPLICIT_FUNCTIONS
)

158 
EIGEN_STATIC_ASSERT
(
ProduùIsV®id
 || !(
SameSizes
 && !
A»VeùÜs
),

159 
INVALID_MATRIX_PRODUCT__IF_YOU_WANTED_A_COEFF_WISE_PRODUCT_YOU_MUST_USE_THE_EXPLICIT_FUNCTION
)

160 
EIGEN_STATIC_ASSERT
(
ProduùIsV®id
 || 
SameSizes
, 
INVALID_MATRIX_PRODUCT
)

163 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
	gm_lhs
.rows(); }

164 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gm_rhs
.cols(); }

166 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_LhsNe¡ed
& 
lhs
(ècÚ¡ {  
	gm_lhs
; }

167 
EIGEN_STRONG_INLINE
 cÚ¡ 
	g_RhsNe¡ed
& 
rhs
(ècÚ¡ {  
	gm_rhs
; }

169 
	g´Ùeùed
:

170 
LhsNe¡ed
 
m_lhs
;

171 
RhsNe¡ed
 
	gm_rhs
;

175 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gResuÉTy³
>

176 
	$ei_¥¬£_´oduù_im¶
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ResuÉTy³
& 
»s
)

178 
ty³Çme
 
	tei_Œa™s
<
	tty³Çme
 
	tei_ş—Áy³
<
	tLhs
>::
	tty³
>::
	tSÿÏr
 Scalar;

181 
rows
 = 
lhs
.
	`šÃrSize
();

182 
cŞs
 = 
rhs
.
	`ou‹rSize
();

184 
	`ei_as£¹
(
lhs
.
	`ou‹rSize
(è=ğ
rhs
.
	`šÃrSize
());

187 
AmbiVeùÜ
<
SÿÏr
> 
	`‹mpVeùÜ
(
rows
);

190 
¿tioLhs
 = (
lhs
.
	`nÚZ”os
())/(Öhs.
	`rows
())*Öhs.
	`cŞs
()));

191 
avgNnzP”RhsCŞumn
 = (
rhs
.
	`nÚZ”os
())/(
cŞs
);

192 
¿tioRes
 = 
¡d
::
	`mš
(
¿tioLhs
 * 
avgNnzP”RhsCŞumn
, 1.f);

194 
»s
.
	`»size
(
rows
, 
cŞs
);

195 
»s
.
	`¡¬tFl
((
¿tioRes
*
rows
*
cŞs
));

196 
j
=0; j<
cŞs
; ++j)

201 
¿tioCŞRes
 = 
¿tioRes
;

202 
‹mpVeùÜ
.
	`š™
(
¿tioCŞRes
);

203 
‹mpVeùÜ
.
	`£tZ”o
();

204 
ty³Çme
 
Rhs
::
IÂ”I‹¿tÜ
 
	`rhsIt
(
rhs
, 
j
); 
rhsIt
; ++rhsIt)

207 
‹mpVeùÜ
.
	`»¡¬t
();

208 
SÿÏr
 
x
 = 
rhsIt
.
	`v®ue
();

209 
ty³Çme
 
Lhs
::
IÂ”I‹¿tÜ
 
	`lhsIt
(
lhs
, 
rhsIt
.
	`šdex
()); 
lhsIt
; ++lhsIt)

211 
‹mpVeùÜ
.
	`cÛffRef
(
lhsIt
.
	`šdex
()è+ğlhsIt.
	`v®ue
(è* 
x
;

214 
ty³Çme
 
AmbiVeùÜ
<
SÿÏr
>::
I‹¿tÜ
 
	`™
(
‹mpVeùÜ
); 
™
; ++it)

215 ià(
ResuÉTy³
::
FÏgs
&
RowMajÜB™
)

216 
»s
.
	`fl
(
j
,
™
.
	`šdex
()èğ™.
	`v®ue
();

218 
»s
.
	`fl
(
™
.
	`šdex
(), 
j
èğ™.
	`v®ue
();

220 
»s
.
	`’dFl
();

221 
	}
}

223 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gResuÉTy³
,

224 
	gLhsStÜageOrd”
 = 
ei_Œa™s
<
Lhs
>::
FÏgs
&
RowMajÜB™
,

225 
	gRhsStÜageOrd”
 = 
ei_Œa™s
<
Rhs
>::
FÏgs
&
RowMajÜB™
,

226 
	gResStÜageOrd”
 = 
ei_Œa™s
<
ResuÉTy³
>::
FÏgs
&
RowMajÜB™
>

227 
ei_¥¬£_´oduù_£ËùÜ
;

229 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gResuÉTy³
>

230 
	gei_¥¬£_´oduù_£ËùÜ
<
	gLhs
,
	gRhs
,
	gResuÉTy³
,
	gCŞMajÜ
,ColMajor,ColMajor>

232 
ty³Çme
 
	tei_Œa™s
<
	tty³Çme
 
	tei_ş—Áy³
<
	tLhs
>::
	tty³
>::
	tSÿÏr
 Scalar;

234 
run
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ResuÉTy³
& 
»s
)

236 
ty³Çme
 
	gei_ş—Áy³
<
	gResuÉTy³
>::
ty³
 
_»s
(
»s
.
rows
(),„es.
cŞs
());

237 
	gei_¥¬£_´oduù_im¶
<
	gLhs
,
	gRhs
,
	gResuÉTy³
>(
	glhs
, 
	grhs
, 
	g_»s
);

238 
	g»s
.
sw­
(
_»s
);

242 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gResuÉTy³
>

243 
	gei_¥¬£_´oduù_£ËùÜ
<
	gLhs
,
	gRhs
,
	gResuÉTy³
,
	gCŞMajÜ
,CŞMajÜ,
	gRowMajÜ
>

245 
run
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ResuÉTy³
& 
»s
)

248 
	gS·r£M©rix
<
	tty³Çme
 
	tResuÉTy³
::
	tSÿÏr
> 
	tS·r£TempÜ¬yTy³
;

249 
S·r£TempÜ¬yTy³
 
_»s
(
»s
.
rows
(),„es.
cŞs
());

250 
	gei_¥¬£_´oduù_im¶
<
	gLhs
,
	gRhs
,
	gS·r£TempÜ¬yTy³
>(
	glhs
, 
	grhs
, 
	g_»s
);

251 
	g»s
 = 
_»s
;

255 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gResuÉTy³
>

256 
	gei_¥¬£_´oduù_£ËùÜ
<
	gLhs
,
	gRhs
,
	gResuÉTy³
,
	gRowMajÜ
,RowMajor,RowMajor>

258 
run
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ResuÉTy³
& 
»s
)

261 
ty³Çme
 
	gei_ş—Áy³
<
	gResuÉTy³
>::
ty³
 
_»s
(
»s
.
rows
(),„es.
cŞs
());

262 
	gei_¥¬£_´oduù_im¶
<
	gRhs
,
	gLhs
,
	gResuÉTy³
>(
	grhs
, 
	glhs
, 
	g_»s
);

263 
	g»s
.
sw­
(
_»s
);

267 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
,y³Çm
	gResuÉTy³
>

268 
	gei_¥¬£_´oduù_£ËùÜ
<
	gLhs
,
	gRhs
,
	gResuÉTy³
,
	gRowMajÜ
,RowMajÜ,
	gCŞMajÜ
>

270 
run
(cÚ¡ 
Lhs
& 
lhs
, cÚ¡ 
Rhs
& 
rhs
, 
ResuÉTy³
& 
»s
)

273 
	gS·r£M©rix
<
	tty³Çme
 
	tResuÉTy³
::
	tSÿÏr
> 
	tS·r£TempÜ¬yTy³
;

274 
S·r£TempÜ¬yTy³
 
_»s
(
»s
.
cŞs
(),„es.
rows
());

275 
	gei_¥¬£_´oduù_im¶
<
	gRhs
,
	gLhs
,
	gS·r£TempÜ¬yTy³
>(
	grhs
, 
	glhs
, 
	g_»s
);

276 
	g»s
 = 
_»s
.
Œª¥o£
();

309 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

310 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

311 
šlše
 
	gD”ived
& 
	gS·r£M©rixBa£
<D”ived>::
İ”©Ü
=(cÚ¡ 
S·r£Produù
<
Lhs
,
	gRhs
,
	gS·r£TimeS·r£Produù
>& 
	g´oduù
)

313 
	gei_¥¬£_´oduù_£ËùÜ
<

314 
ty³Çme
 
	gei_ş—Áy³
<
	gLhs
>::
ty³
,

315 
ty³Çme
 
	gei_ş—Áy³
<
	gRhs
>::
ty³
,

316 
	gD”ived
>::
run
(
´oduù
.
lhs
(),´oduù.
rhs
(),
d”ived
());

317  
d”ived
();

335 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

336 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

337 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
ÏzyAssign
(cÚ¡ 
S·r£Produù
<
Lhs
,
Rhs
,
S·r£TimeD’£Produù
>& 
´oduù
)

339 
ty³Çme
 
	tei_ş—Áy³
<
	tLhs
>::
	tty³
 
	t_Lhs
;

340 
ty³Çme
 
	tei_ş—Áy³
<
	tRhs
>::
	tty³
 
	t_Rhs
;

341 
ty³Çme
 
	t_Lhs
::
	tIÂ”I‹¿tÜ
 
	tLhsIÂ”I‹¿tÜ
;

343 
	gLhsIsRowMajÜ
 = (
_Lhs
::
FÏgs
&
RowMajÜB™
)==RowMajorBit,

344 
	gLhsIsS–fAdjošt
 = (
_Lhs
::
FÏgs
&
S–fAdjoštB™
)==SelfAdjointBit,

345 
	gProûssFœ¡H®f
 = 
LhsIsS–fAdjošt


346 && ( ((
_Lhs
::
FÏgs
&(
Uµ”TrŸnguÏrB™
|
Low”TrŸnguÏrB™
))==0)

347 || ( (
_Lhs
::
FÏgs
&
Uµ”TrŸnguÏrB™
è&& !
LhsIsRowMajÜ
)

348 || ( (
_Lhs
::
FÏgs
&
Low”TrŸnguÏrB™
è&& 
LhsIsRowMajÜ
) ),

349 
	gProûssSecÚdH®f
 = 
LhsIsS–fAdjošt
 && (!
ProûssFœ¡H®f
)

351 
d”ived
().
£tZ”o
();

352 
	gj
=0; j<
	g´oduù
.
lhs
().
ou‹rSize
(); ++j)

354 
LhsIÂ”I‹¿tÜ
 
i
(
´oduù
.
lhs
(),
j
);

355 ià(
	gProûssSecÚdH®f
 && 
	gi
 && (i.
šdex
()==
j
))

357 
d”ived
().
row
(
j
è+ğ
i
.
v®ue
(è* 
´oduù
.
rhs
().row(j);

358 ++
	gi
;

360 
	gBlock
<
	gD”ived
,1,D”ived::
CŞsAtCompeTime
> 
»s
(
d”ived
().
row
(
LhsIsRowMajÜ
 ? 
j
 : 0));

361 ; (
	gProûssFœ¡H®f
 ? 
	gi
 && i.
šdex
(è< 
	gj
 : 
i
) ; ++i)

363 ià(
	gLhsIsS–fAdjošt
)

365 
	ga
 = 
LhsIsRowMajÜ
 ? 
j
 : 
i
.
šdex
();

366 
	gb
 = 
LhsIsRowMajÜ
 ? 
i
.
šdex
(è: 
j
;

367 
SÿÏr
 
	gv
 = 
i
.
v®ue
();

368 
d”ived
().
row
(
a
è+ğ(
v
è* 
´oduù
.
rhs
().row(
b
);

369 
d”ived
().
row
(
b
è+ğ
ei_cÚj
(
v
è* 
´oduù
.
rhs
().row(
a
);

371 ià(
	gLhsIsRowMajÜ
)

372 
	g»s
 +ğ
i
.
v®ue
(è* 
´oduù
.
rhs
().
row
(i.
šdex
());

374 
d”ived
().
row
(
i
.
šdex
()è+ği.
v®ue
(è* 
´oduù
.
rhs
().row(
j
);

376 ià(
	gProûssFœ¡H®f
 && 
	gi
 && (i.
šdex
()==
j
))

377 
d”ived
().
row
(
j
è+ğ
i
.
v®ue
(è* 
´oduù
.
rhs
().row(j);

379  
d”ived
();

383 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

384 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

385 
	gD”ived
& 
	gM©rixBa£
<D”ived>::
ÏzyAssign
(cÚ¡ 
S·r£Produù
<
Lhs
,
Rhs
,
D’£TimeS·r£Produù
>& 
´oduù
)

387 
ty³Çme
 
	tei_ş—Áy³
<
	tRhs
>::
	tty³
 
	t_Rhs
;

388 
ty³Çme
 
	t_Rhs
::
	tIÂ”I‹¿tÜ
 
	tRhsIÂ”I‹¿tÜ
;

389 ’um { 
	gRhsIsRowMajÜ
 = (
_Rhs
::
FÏgs
&
RowMajÜB™
)==RowMajorBit };

390 
d”ived
().
£tZ”o
();

391 
	gj
=0; j<
	g´oduù
.
rhs
().
ou‹rSize
(); ++j)

392 
RhsIÂ”I‹¿tÜ
 
i
(
´oduù
.
rhs
(),
j
); 
	gi
; ++i)

393 
d”ived
().
cŞ
(
RhsIsRowMajÜ
 ? 
i
.
šdex
(è: 
j
è+ği.
v®ue
(è* 
´oduù
.
lhs
().col(RhsIsRowMajor ? j : i.index());

394  
d”ived
();

398 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

399 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

400 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gS·r£ProduùR‘uºTy³
<
	gD”ived
,
	gOth”D”ived
>::
Ty³


401 
S·r£M©rixBa£
<
D”ived
>::
İ”©Ü
*(cÚ¡ S·r£M©rixBa£<
Oth”D”ived
> &
Ùh”
) const

403  
ty³Çme
 
S·r£ProduùR‘uºTy³
<
D”ived
,
	gOth”D”ived
>::
Ty³
(
d”ived
(), 
Ùh”
.derived());

407 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

408 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

409 
EIGEN_STRONG_INLINE
 cÚ¡ 
ty³Çme
 
	gS·r£ProduùR‘uºTy³
<
	gD”ived
,
	gOth”D”ived
>::
Ty³


410 
S·r£M©rixBa£
<
D”ived
>::
İ”©Ü
*(cÚ¡ 
M©rixBa£
<
Oth”D”ived
> &
Ùh”
) const

412  
ty³Çme
 
S·r£ProduùR‘uºTy³
<
D”ived
,
	gOth”D”ived
>::
Ty³
(
d”ived
(), 
Ùh”
.derived());

	@robot/Eigen/src/Sparse/SparseRedux.h

25 #iâdeà
EIGEN_SPARSEREDUX_H


26 
	#EIGEN_SPARSEREDUX_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

29 
ty³Çme
 
	gei_Œa™s
<
	gD”ived
>::
SÿÏr


30 
S·r£M©rixBa£
<
D”ived
>::
	$sum
() const

32 
	`ei_as£¹
(
	`rows
()>0 && 
	`cŞs
()>0 && "you‡re using‡‚on initialized matrix");

33 
SÿÏr
 
»s
 = 0;

34 
j
=0; j<
	`ou‹rSize
(); ++j)

35 
ty³Çme
 
D”ived
::
IÂ”I‹¿tÜ
 
	`™”
(
	`d”ived
(),
j
); 
™”
; ++iter)

36 
»s
 +ğ
™”
.
	`v®ue
();

37  
»s
;

38 
	}
}

	@robot/Eigen/src/Sparse/SparseTranspose.h

25 #iâdeà
EIGEN_SPARSETRANSPOSE_H


26 
	#EIGEN_SPARSETRANSPOSE_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

29 
	gei_Œa™s
<
	gS·r£T¿n¥o£
<
	gM©rixTy³
> > : 
ei_Œa™s
<
T¿n¥o£
<
M©rixTy³
> >

32 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gS·r£T¿n¥o£


33 : 
public
 
S·r£M©rixBa£
<
S·r£T¿n¥o£
<
M©rixTy³
> >

35 
public
:

37 
EIGEN_GENERIC_PUBLIC_INTERFACE
(
S·r£T¿n¥o£
)

39 
şass
 
IÂ”I‹¿tÜ
;

40 
şass
 
	gRev”£IÂ”I‹¿tÜ
;

42 
šlše
 
S·r£T¿n¥o£
(cÚ¡ 
M©rixTy³
& 
m©rix
è: 
m_m©rix
(matrix) {}

46 
šlše
 
rows
(ècÚ¡ {  
m_m©rix
.
cŞs
(); }

47 
šlše
 
cŞs
(ècÚ¡ {  
	gm_m©rix
.
rows
(); }

48 
šlše
 
nÚZ”os
(ècÚ¡ {  
	gm_m©rix
.nonZeros(); }

51 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

52 {  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
cŞ
, 
row
); }

54 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

55 {  
	gm_m©rix
.
cÛff
(
cŞ
, 
row
); }

57 
šlše
 cÚ¡ 
SÿÏr
 
cÛff
(
šdex
) const

58 {  
	gm_m©rix
.
cÛff
(
šdex
); }

60 
šlše
 
	gSÿÏr
& 
cÛffRef
(
šdex
)

61 {  
	gm_m©rix
.
cÚ¡_ÿ¡_d”ived
().
cÛffRef
(
šdex
); }

63 
	g´Ùeùed
:

64 cÚ¡ 
ty³Çme
 
M©rixTy³
::
Ne¡ed
 
m_m©rix
;

66 
	g´iv©e
:

67 
S·r£T¿n¥o£
& 
İ”©Ü
=(const SparseTranspose&);

70 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gS·r£T¿n¥o£
<M©rixTy³>::
IÂ”I‹¿tÜ
 : 
public
 
M©rixTy³
::InnerIterator

72 
public
:

73 
EIGEN_STRONG_INLINE
 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£T¿n¥o£
& 
Œªs
, 
ou‹r
)

74 : 
M©rixTy³
::
IÂ”I‹¿tÜ
(
Œªs
.
m_m©rix
, 
ou‹r
)

77 
	g´iv©e
:

78 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

81 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gS·r£T¿n¥o£
<M©rixTy³>::
Rev”£IÂ”I‹¿tÜ
 : 
public
 
M©rixTy³
::ReverseInnerIterator

83 
public
:

85 
EIGEN_STRONG_INLINE
 
Rev”£IÂ”I‹¿tÜ
(cÚ¡ 
S·r£T¿n¥o£
& 
x´
, 
ou‹r
)

86 : 
M©rixTy³
::
Rev”£IÂ”I‹¿tÜ
(
x´
.
m_m©rix
, 
ou‹r
)

	@robot/Eigen/src/Sparse/SparseUtil.h

25 #iâdeà
EIGEN_SPARSEUTIL_H


26 
	#EIGEN_SPARSEUTIL_H


	)

28 #ifdeà
NDEBUG


29 
	#EIGEN_DBG_SPARSE
(
X
)

	)

31 
	#EIGEN_DBG_SPARSE
(
X
è
	)
X

34 
	#EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, 
Op
) \

35 
‹m¶©e
<
ty³Çme
 
Oth”D”ived
> \

36 
EIGEN_STRONG_INLINE
 
D”ived
& 
İ”©Ü
 
	`Op
(cÚ¡ 
Eig’
::
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) \

38  
Ba£
::
İ”©Ü
 
	`Op
(
Ùh”
.
	`d”ived
()); \

40 
EIGEN_STRONG_INLINE
 
D”ived
& 
İ”©Ü
 
	`Op
(cÚ¡ D”ived& 
Ùh”
) \

42  
Ba£
::
İ”©Ü
 
	`Op
(
Ùh”
); \

43 }

	)

45 
	#EIGEN_SPARSE_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
D”ived
, 
Op
) \

46 
‹m¶©e
<
ty³Çme
 
Oth”
> \

47 
EIGEN_STRONG_INLINE
 
D”ived
& 
İ”©Ü
 
	`Op
(cÚ¡ 
Oth”
& 
sÿÏr
) \

49  
Ba£
::
İ”©Ü
 
	`Op
(
sÿÏr
); \

50 }

	)

52 
	#EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATORS
(
D”ived
) \

53 
	`EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, =) \

54 
	`EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, +=) \

55 
	`EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
D”ived
, -=) \

56 
	`EIGEN_SPARSE_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
D”ived
, *=) \

57 
	`EIGEN_SPARSE_INHERIT_SCALAR_ASSIGNMENT_OPERATOR
(
D”ived
, /=)

	)

59 
	#_EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
D”ived
, 
Ba£CÏss
) \

60 
Ba£CÏss
 
	tBa£
; \

61 
ty³Çme
 
	tEig’
::
	tei_Œa™s
<
	tD”ived
>::
	tSÿÏr
 Scalar; \

62 
ty³Çme
 
	tEig’
::
	tNumT¿™s
<
	tSÿÏr
>::
	tR—l
 
	tR—lSÿÏr
; \

63 
ty³Çme
 
	tEig’
::
	tei_Ã¡ed
<
	tD”ived
>::
	tty³
 
	tNe¡ed
; \

64 ’um { 
RowsAtCompeTime
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::RowsAtCompileTime, \

65 
CŞsAtCompeTime
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::ColsAtCompileTime, \

66 
FÏgs
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::Flags, \

67 
CÛffR—dCo¡
 = 
Eig’
::
ei_Œa™s
<
D”ived
>::CoeffReadCost, \

68 
SizeAtCompeTime
 = 
Ba£
::SizeAtCompileTime, \

69 
IsVeùÜAtCompeTime
 = 
Ba£
::IsVeùÜAtCompeTim};

	)

71 
	#EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
D”ived
) \

72 
	`_EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
D”ived
, 
Eig’
::
S·r£M©rixBa£
<D”ived>)

	)

74 
	eS·r£Back’d
 {

75 
	mDeçuÉBack’d
,

76 
	mTaucs
,

77 
	mChŞmod
,

78 
	mSu³rLU
,

79 
	mUmfPack


84 
	mCom¶‘eFaùÜiz©iÚ
 = 0x0000,

85 
	mIncom¶‘eFaùÜiz©iÚ
 = 0x0001,

86 
	mMemÜyEffic›Á
 = 0x0002,

89 
	mSu³ºod®MuÉiäÚl
 = 0x0010,

90 
	mSu³ºod®LeáLookšg
 = 0x0020,

93 
	mN©u¿lOrd”šg
 = 0x0100,

94 
	mMšimumDeg»e_AT_PLUS_A
 = 0x0200,

95 
	mMšimumDeg»e_ATA
 = 0x0300,

96 
	mCŞAµroxMšimumDeg»e
 = 0x0400,

97 
	mM‘is
 = 0x0500,

98 
	mScÙch
 = 0x0600,

99 
	mChaco
 = 0x0700,

100 
	mOrd”šgMask
 = 0x0f00

103 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
şass
 
	gS·r£M©rixBa£
;

104 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
 = 0> 
şass
 
S·r£M©rix
;

105 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
 = 0> 
şass
 
DyÇmicS·r£M©rix
;

106 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
 = 0> 
şass
 
S·r£VeùÜ
;

107 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
 = 0> 
şass
 
M­³dS·r£M©rix
;

109 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
> 
şass
 
	gS·r£T¿n¥o£
;

110 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
, 
	gSize
> 
şass
 
	gS·r£IÂ”VeùÜS‘
;

111 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
> 
şass
 
	gS·r£Cwi£
;

112 
	g‹m¶©e
<
ty³Çme
 
	gUÇryOp
,y³Çm
	gM©rixTy³
> 
şass
 
	gS·r£Cwi£UÇryOp
;

113 
	g‹m¶©e
<
ty³Çme
 
	gBš¬yOp
,y³Çm
	gLhs
,y³Çm
	gRhs
> 
şass
 
	gS·r£Cwi£Bš¬yOp
;

114 
	g‹m¶©e
<
ty³Çme
 
	gEx´essiÚTy³
,

115 
	gAdded
, 
	gRemoved
> 
şass
 
	gS·r£FÏgged
;

116 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
> 
şass
 
	gS·r£DŸgÚ®Produù
;

118 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
> 
	gei_¥¬£_´oduù_mode
;

119 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
, 
	gProduùMode
 = 
ei_¥¬£_´oduù_mode
<
Lhs
,Rhs>::
v®ue
> 
S·r£ProduùR‘uºTy³
;

121 cÚ¡ 
	gCoh”’tAcûssP©‹º
 = 0x1;

122 cÚ¡ 
	gIÂ”RªdomAcûssP©‹º
 = 0x2 | 
Coh”’tAcûssP©‹º
;

123 cÚ¡ 
	gOu‹rRªdomAcûssP©‹º
 = 0x4 | 
Coh”’tAcûssP©‹º
;

124 cÚ¡ 
	gRªdomAcûssP©‹º
 = 0x8 | 
Ou‹rRªdomAcûssP©‹º
 | 
IÂ”RªdomAcûssP©‹º
;

137 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
şass
 
	gei_ev®
<T,
	gIsS·r£
>

139 
ty³Çme
 
	tei_Œa™s
<
	tT
>::
	tSÿÏr
 
	t_SÿÏr
;

141 
	g_FÏgs
 = 
ei_Œa™s
<
T
>::
FÏgs


144 
	gpublic
:

145 
S·r£M©rix
<
	t_SÿÏr
, 
	t_FÏgs
> 
	tty³
;

	@robot/Eigen/src/Sparse/SparseVector.h

25 #iâdeà
EIGEN_SPARSEVECTOR_H


26 
	#EIGEN_SPARSEVECTOR_H


	)

37 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

38 
	gei_Œa™s
<
	gS·r£VeùÜ
<
	g_SÿÏr
, 
	g_FÏgs
> >

40 
_SÿÏr
 
	tSÿÏr
;

42 
	gIsCŞVeùÜ
 = 
_FÏgs
 & 
RowMajÜB™
 ? 0 : 1,

44 
	gRowsAtCompeTime
 = 
IsCŞVeùÜ
 ? 
DyÇmic
 : 1,

45 
	gCŞsAtCompeTime
 = 
IsCŞVeùÜ
 ? 1 : 
DyÇmic
,

46 
	gMaxRowsAtCompeTime
 = 
RowsAtCompeTime
,

47 
	gMaxCŞsAtCompeTime
 = 
CŞsAtCompeTime
,

48 
	gFÏgs
 = 
S·r£B™
 | 
_FÏgs
,

49 
	gCÛffR—dCo¡
 = 
NumT¿™s
<
SÿÏr
>::
R—dCo¡
,

50 
	gSuµÜ‹dAcûssP©‹ºs
 = 
IÂ”RªdomAcûssP©‹º


54 
	g‹m¶©e
<
ty³Çme
 
	g_SÿÏr
, 
	g_FÏgs
>

55 
şass
 
	gS·r£VeùÜ


56 : 
public
 
S·r£M©rixBa£
<
S·r£VeùÜ
<
_SÿÏr
, 
	g_FÏgs
> >

58 
	gpublic
:

59 
EIGEN_SPARSE_GENERIC_PUBLIC_INTERFACE
(
S·r£VeùÜ
)

60 
EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
S·r£VeùÜ
, +=)

61 
EIGEN_SPARSE_INHERIT_ASSIGNMENT_OPERATOR
(
S·r£VeùÜ
, -=)

64 
´Ùeùed
:

65 
public
:

67 
S·r£M©rixBa£
<
	tS·r£VeùÜ
> 
	tS·r£Ba£
;

68 ’um { 
	gIsCŞVeùÜ
 = 
ei_Œa™s
<
S·r£VeùÜ
>::
IsCŞVeùÜ
 };

70 
	gCom´es£dStÜage
<
	gSÿÏr
> 
	gm_d©a
;

71 
	gm_size
;

73 
	gCom´es£dStÜage
<
	gSÿÏr
>& 
_d©a
(è{  
	gm_d©a
; }

74 
	gCom´es£dStÜage
<
	gSÿÏr
>& 
_d©a
(ècÚ¡ {  
	gm_d©a
; }

76 
	gpublic
:

78 
EIGEN_STRONG_INLINE
 
rows
(ècÚ¡ {  
IsCŞVeùÜ
 ? 
m_size
 : 1; }

79 
EIGEN_STRONG_INLINE
 
cŞs
(ècÚ¡ {  
	gIsCŞVeùÜ
 ? 1 : 
m_size
; }

80 
EIGEN_STRONG_INLINE
 
šÃrSize
(ècÚ¡ {  
	gm_size
; }

81 
EIGEN_STRONG_INLINE
 
ou‹rSize
() const {  1; }

82 
EIGEN_STRONG_INLINE
 
šÃrNÚZ”os
(
j
ècÚ¡ { 
ei_as£¹
(j==0);  
	gm_size
; }

84 
EIGEN_STRONG_INLINE
 cÚ¡ 
SÿÏr
* 
_v®uePŒ
(ècÚ¡ {  &
	gm_d©a
.
v®ue
(0); }

85 
EIGEN_STRONG_INLINE
 
SÿÏr
* 
_v®uePŒ
(è{  &
	gm_d©a
.
v®ue
(0); }

87 
EIGEN_STRONG_INLINE
 cÚ¡ * 
_šÃrIndexPŒ
(ècÚ¡ {  &
	gm_d©a
.
šdex
(0); }

88 
EIGEN_STRONG_INLINE
 * 
_šÃrIndexPŒ
(è{  &
	gm_d©a
.
šdex
(0); }

90 
šlše
 
SÿÏr
 
cÛff
(
row
, 
cŞ
) const

92 
ei_as£¹
((
IsCŞVeùÜ
 ? 
cŞ
 : 
row
)==0);

93  
cÛff
(
IsCŞVeùÜ
 ? 
row
 : 
cŞ
);

95 
šlše
 
SÿÏr
 
cÛff
(
i
ècÚ¡ {  
	gm_d©a
.
©
(i); }

97 
šlše
 
	gSÿÏr
& 
cÛffRef
(
row
, 
cŞ
)

99 
ei_as£¹
((
IsCŞVeùÜ
 ? 
cŞ
 : 
row
)==0);

100  
cÛff
(
IsCŞVeùÜ
 ? 
row
 : 
cŞ
);

109 
šlše
 
	gSÿÏr
& 
cÛffRef
(
i
)

111  
	gm_d©a
.
©W™hIn£¹iÚ
(
i
);

114 
	gpublic
:

116 
şass
 
IÂ”I‹¿tÜ
;

118 
šlše
 
£tZ”o
(è{ 
	gm_d©a
.
ş—r
(); }

121 
šlše
 
nÚZ”os
(ècÚ¡ {  
	gm_d©a
.
size
(); }

125 
šlše
 
»£rve
(
»£rveSize
è{ 
	gm_d©a
.reserve(reserveSize); }

127 
šlše
 
¡¬tFl
(
»£rve
)

129 
£tZ”o
();

130 
	gm_d©a
.
»£rve
(reserve);

135 
šlše
 
	gSÿÏr
& 
fl
(
r
, 
c
)

137 
ei_as£¹
(
r
==0 || 
c
==0);

138  
fl
(
IsCŞVeùÜ
 ? 
r
 : 
c
);

141 
šlše
 
	gSÿÏr
& 
fl
(
i
)

143 
	gm_d©a
.
­³nd
(0, 
i
);

144  
	gm_d©a
.
v®ue
(
m_d©a
.
size
()-1);

147 
šlše
 
	gSÿÏr
& 
fÌªd
(
r
, 
c
)

149 
ei_as£¹
(
r
==0 || 
c
==0);

150  
fÌªd
(
IsCŞVeùÜ
 ? 
r
 : 
c
);

155 
šlše
 
	gSÿÏr
& 
fÌªd
(
i
)

157 
	g¡¬tId
 = 0;

158 
	gid
 = 
m_d©a
.
size
() - 1;

159 
	gm_d©a
.
»size
(
id
+2,1);

161  (
	gid
 >ğ
¡¬tId
è&& (
m_d©a
.
šdex
(
id
è> 
i
) )

163 
m_d©a
.
šdex
(
id
+1) = m_data.index(id);

164 
	gm_d©a
.
v®ue
(
id
+1èğ
m_d©a
.value(id);

165 --
	gid
;

167 
	gm_d©a
.
šdex
(
id
+1èğ
i
;

168 
	gm_d©a
.
v®ue
(
id
+1) = 0;

169  
	gm_d©a
.
v®ue
(
id
+1);

172 
šlše
 
’dFl
() {}

174 
´uÃ
(
SÿÏr
 
»ã»nû
, 
R—lSÿÏr
 
•sÚ
 = 
´ecisiÚ
<RealScalar>())

176 
m_d©a
.
´uÃ
(
»ã»nû
,
•sÚ
);

179 
»size
(
rows
, 
cŞs
)

181 
ei_as£¹
(
rows
==1 || 
cŞs
==1);

182 
»size
(
IsCŞVeùÜ
 ? 
rows
 : 
cŞs
);

185 
»size
(
ÃwSize
)

187 
	gm_size
 = 
ÃwSize
;

188 
	gm_d©a
.
ş—r
();

191 
»sizeNÚZ”os
(
size
è{ 
	gm_d©a
.
»size
(size); }

193 
šlše
 
S·r£VeùÜ
(è: 
m_size
(0è{ 
»size
(0); }

195 
šlše
 
S·r£VeùÜ
(
size
è: 
m_size
(0è{ 
»size
(size); }

197 
šlše
 
S·r£VeùÜ
(
rows
, 
cŞs
è: 
m_size
(0è{ 
»size
(rows,cols); }

199 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

200 
šlše
 
S·r£VeùÜ
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

201 : 
m_size
(0)

203 *
this
 = 
Ùh”
.
d”ived
();

206 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

207 
šlše
 
S·r£VeùÜ
(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

208 : 
m_size
(0)

210 *
this
 = 
Ùh”
.
d”ived
();

213 
šlše
 
S·r£VeùÜ
(cÚ¡ S·r£VeùÜ& 
Ùh”
)

214 : 
m_size
(0)

216 *
this
 = 
Ùh”
.
d”ived
();

219 
šlše
 
sw­
(
S·r£VeùÜ
& 
Ùh”
)

221 
	g¡d
::
sw­
(
m_size
, 
Ùh”
.m_size);

222 
	gm_d©a
.
sw­
(
Ùh”
.
m_d©a
);

225 
šlše
 
	gS·r£VeùÜ
& 
	gİ”©Ü
=(cÚ¡ 
S·r£VeùÜ
& 
Ùh”
)

227 ià(
Ùh”
.
isRV®ue
())

229 
sw­
(
Ùh”
.
cÚ¡_ÿ¡_d”ived
());

233 
»size
(
Ùh”
.
size
());

234 
	gm_d©a
 = 
Ùh”
.
m_d©a
;

236  *
	gthis
;

239 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

240 
šlše
 
	gS·r£VeùÜ
& 
	gİ”©Ü
=(cÚ¡ 
S·r£M©rixBa£
<
Oth”D”ived
>& 
Ùh”
)

242  
Ba£
::
İ”©Ü
=(
Ùh”
);

295 
ä›nd
 
	g¡d
::
o¡»am
 & 
İ”©Ü
 << (
¡d
::o¡»am & 
s
, cÚ¡ 
	gS·r£VeùÜ
& 
	gm
)

297 
	gi
=0; i<
	gm
.
nÚZ”os
(); ++i)

298 
	gs
 << "(" << 
	gm
.
	gm_d©a
.
v®ue
(
i
è<< "," << m.m_d©a.
šdex
(i) << ") ";

299 
	gs
 << 
	g¡d
::
’dl
;

300  
	gs
;

326 
	gšlše
 ~
S·r£VeùÜ
() {}

329 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	g_FÏgs
>

330 
şass
 
	gS·r£VeùÜ
<
	gSÿÏr
,
	g_FÏgs
>::
IÂ”I‹¿tÜ


332 
public
:

333 
IÂ”I‹¿tÜ
(cÚ¡ 
S·r£VeùÜ
& 
vec
, 
ou‹r
=0)

334 : 
m_d©a
(
vec
.m_d©a), 
m_id
(0), 
m_’d
(m_d©a.
size
())

336 
ei_as£¹
(
ou‹r
==0);

339 
IÂ”I‹¿tÜ
(cÚ¡ 
Com´es£dStÜage
<
SÿÏr
>& 
d©a
)

340 : 
m_d©a
(
d©a
), 
m_id
(0), 
m_’d
(m_d©a.
size
())

343 
	g‹m¶©e
<
	gAdded
, 
	gRemoved
>

344 
IÂ”I‹¿tÜ
(cÚ¡ 
FÏgged
<
S·r£VeùÜ
,
Added
,
Removed
>& 
vec
, 
ou‹r
)

345 : 
m_d©a
(
vec
.
_ex´essiÚ
().m_d©a), 
m_id
(0), 
m_’d
(m_d©a.
size
())

348 
šlše
 
	gIÂ”I‹¿tÜ
& 
	gİ”©Ü
++(è{ 
	gm_id
++;  *
	gthis
; }

350 
šlše
 
SÿÏr
 
v®ue
(ècÚ¡ {  
	gm_d©a
.v®ue(
m_id
); }

351 
šlše
 
	gSÿÏr
& 
v®ueRef
(è{  
	gcÚ¡_ÿ¡
<SÿÏr&>(
	gm_d©a
.
v®ue
(
m_id
)); }

353 
šlše
 
šdex
(ècÚ¡ {  
	gm_d©a
.šdex(
m_id
); }

354 
šlše
 
row
(ècÚ¡ {  
	gIsCŞVeùÜ
 ? 
šdex
() : 0; }

355 
šlše
 
cŞ
(ècÚ¡ {  
	gIsCŞVeùÜ
 ? 0 : 
šdex
(); }

357 
šlše
 
İ”©Ü
 
boŞ
(ècÚ¡ {  (
	gm_id
 < 
	gm_’d
); }

359 
	g´Ùeùed
:

360 cÚ¡ 
Com´es£dStÜage
<
SÿÏr
>& 
m_d©a
;

361 
	gm_id
;

362 cÚ¡ 
	gm_’d
;

364 
	g´iv©e
:

365 
IÂ”I‹¿tÜ
& 
İ”©Ü
=(const InnerIterator&);

	@robot/Eigen/src/Sparse/SuperLUSupport.h

25 #iâdeà
EIGEN_SUPERLUSUPPORT_H


26 
	#EIGEN_SUPERLUSUPPORT_H


	)

29 
	#DECL_GSSVX
(
NAMESPACE
,
FNAME
,
FLOATTYPE
,
KEYTYPE
) \

30 
šlše
 
	`Su³rLU_gssvx
(
su³¾u_İtiÚs_t
 *
İtiÚs
, 
Su³rM©rix
 *
A
, \

31 *
³rm_c
, *
³rm_r
, *
‘»e
, *
equed
, \

32 
FLOATTYPE
 *
R
, FLOATTYPE *
C
, 
Su³rM©rix
 *
L
, \

33 
Su³rM©rix
 *
U
, *
wÜk
, 
lwÜk
, \

34 
Su³rM©rix
 *
B
, Su³rM©rix *
X
, \

35 
FLOATTYPE
 *
»c_pivÙ_growth
, \

36 
FLOATTYPE
 *
rcÚd
, FLOATTYPE *
ã¼
, FLOATTYPE *
b”r
, \

37 
Su³rLUSt_t
 *
¡©s
, *
šfo
, 
KEYTYPE
) { \

38 
usšg
 
Çme¥aû
 
NAMESPACE
; \

39 
mem_u§ge_t
 
mem_u§ge
; \

40 
NAMESPACE
::
	`FNAME
(
İtiÚs
, 
A
, 
³rm_c
, 
³rm_r
, 
‘»e
, 
equed
, 
R
, 
C
, 
L
, \

41 
U
, 
wÜk
, 
lwÜk
, 
B
, 
X
, 
»c_pivÙ_growth
, 
rcÚd
, \

42 
ã¼
, 
b”r
, &
mem_u§ge
, 
¡©s
, 
šfo
); \

43  
mem_u§ge
.
fÜ_lu
; \

44 }

	)

46 
	$DECL_GSSVX
(
Su³rLU_S
,
sgssvx
,,)

47 
	`DECL_GSSVX
(
Su³rLU_C
,
cgssvx
,,
¡d
::
com¶ex
<>)

48 
	$DECL_GSSVX
(
Su³rLU_D
,
dgssvx
,,)

49 
	`DECL_GSSVX
(
Su³rLU_Z
,
zgssvx
,,
¡d
::
com¶ex
<>)

51 
‹m¶©e
<
ty³Çme
 
M©rixTy³
>

52 
SluM©rixM­H–³r
;

61 
SluM©rix
 : 
Su³rM©rix


63 
	`SluM©rix
()

65 
StÜe
 = &
¡Üage
;

68 
	`SluM©rix
(cÚ¡ 
SluM©rix
& 
Ùh”
)

69 : 
	`Su³rM©rix
(
Ùh”
)

71 
StÜe
 = &
¡Üage
;

72 
¡Üage
 = 
Ùh”
.storage;

75 
SluM©rix
& 
İ”©Ü
=(cÚ¡ SluM©rix& 
Ùh”
)

77 
Su³rM©rix
::
İ”©Ü
=(
¡©ic_ÿ¡
<cÚ¡ Su³rM©rix&>(
Ùh”
));

78 
StÜe
 = &
¡Üage
;

79 
¡Üage
 = 
Ùh”
.storage;

80  *
this
;

85 uniÚ {
Âz
;
lda
;};

86 *
v®ues
;

87 *
šÃrInd
;

88 *
ou‹rInd
;

89 } 
¡Üage
;

91 
	`£tStÜageTy³
(
Sty³_t
 
t
)

93 
Sty³
 = 
t
;

94 ià(
t
==
SLU_NC
 ||==
SLU_NR
 ||==
SLU_DN
)

95 
StÜe
 = &
¡Üage
;

98 
	`ei_as£¹
(
çl£
 && "storageype‚ot supported");

99 
StÜe
 = 0;

103 
‹m¶©e
<
ty³Çme
 
SÿÏr
>

104 
	`£tSÿÏrTy³
()

106 ià(
ei_is_§me_ty³
<
SÿÏr
,>::
»t
)

107 
Dty³
 = 
SLU_S
;

108 ià(
ei_is_§me_ty³
<
SÿÏr
,>::
»t
)

109 
Dty³
 = 
SLU_D
;

110 ià(
ei_is_§me_ty³
<
SÿÏr
,
¡d
::
com¶ex
<> >::
»t
)

111 
Dty³
 = 
SLU_C
;

112 ià(
ei_is_§me_ty³
<
SÿÏr
,
¡d
::
com¶ex
<> >::
»t
)

113 
Dty³
 = 
SLU_Z
;

116 
	`ei_as£¹
(
çl£
 && "Scalarype‚ot supported by SuperLU");

120 
‹m¶©e
<
ty³Çme
 
SÿÏr
, 
Rows
, 
CŞs
, 
O±iÚs
, 
MRows
, 
MCŞs
>

121 
SluM©rix
 
	`M­
(
M©rix
<
SÿÏr
,
Rows
,
CŞs
,
O±iÚs
,
MRows
,
MCŞs
>& 
m©
)

123 
M©rix
<
	tSÿÏr
,
	tRows
,
	tCŞs
,
	tO±iÚs
,
	tMRows
,
	tMCŞs
> 
	tM©rixTy³
;

124 
	`ei_as£¹
Ğ((
O±iÚs
&
RowMajÜ
)!=RowMajor) && "row-major dense matrices is‚ot supported by SuperLU");

125 
SluM©rix
 
»s
;

126 
»s
.
	`£tStÜageTy³
(
SLU_DN
);

127 
»s
.
£tSÿÏrTy³
<
SÿÏr
>();

128 
»s
.
Mty³
 = 
SLU_GE
;

130 
»s
.
Äow
 = 
m©
.
	`rows
();

131 
»s
.
ncŞ
 = 
m©
.
	`cŞs
();

133 
»s
.
¡Üage
.
lda
 = 
m©
.
	`¡ride
();

134 
»s
.
¡Üage
.
v®ues
 = 
m©
.
	`d©a
();

135  
»s
;

138 
‹m¶©e
<
ty³Çme
 
M©rixTy³
>

139 
SluM©rix
 
	`M­
(
S·r£M©rixBa£
<
M©rixTy³
>& 
m©
)

141 
SluM©rix
 
»s
;

142 ià((
M©rixTy³
::
FÏgs
&
RowMajÜB™
)==RowMajorBit)

144 
»s
.
	`£tStÜageTy³
(
SLU_NR
);

145 
»s
.
Äow
 = 
m©
.
	`cŞs
();

146 
»s
.
ncŞ
 = 
m©
.
	`rows
();

150 
»s
.
	`£tStÜageTy³
(
SLU_NC
);

151 
»s
.
Äow
 = 
m©
.
	`rows
();

152 
»s
.
ncŞ
 = 
m©
.
	`cŞs
();

155 
»s
.
Mty³
 = 
SLU_GE
;

157 
»s
.
¡Üage
.
Âz
 = 
m©
.
	`nÚZ”os
();

158 
»s
.
¡Üage
.
v®ues
 = 
m©
.
	`d”ived
().
	`_v®uePŒ
();

159 
»s
.
¡Üage
.
šÃrInd
 = 
m©
.
	`d”ived
().
	`_šÃrIndexPŒ
();

160 
»s
.
¡Üage
.
ou‹rInd
 = 
m©
.
	`d”ived
().
	`_ou‹rIndexPŒ
();

162 
»s
.
£tSÿÏrTy³
<
ty³Çme
 
M©rixTy³
::
SÿÏr
>();

165 ià(
M©rixTy³
::
FÏgs
 & 
Uµ”TrŸnguÏr
)

166 
»s
.
Mty³
 = 
SLU_TRU
;

167 ià(
M©rixTy³
::
FÏgs
 & 
Low”TrŸnguÏr
)

168 
»s
.
Mty³
 = 
SLU_TRL
;

169 ià(
M©rixTy³
::
FÏgs
 & 
S–fAdjošt
)

170 
	`ei_as£¹
(
çl£
 && "SelfAdjoint matrix shape‚ot supported by SuperLU");

171  
»s
;

173 
	}
};

175 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gRows
, 
	gCŞs
, 
	gO±iÚs
, 
	gMRows
, 
	gMCŞs
>

176 
	gSluM©rixM­H–³r
<
	gM©rix
<
	gSÿÏr
,
	gRows
,
	gCŞs
,
	gO±iÚs
,
	gMRows
,
	gMCŞs
> >

178 
	gM©rix
<
	tSÿÏr
,
	tRows
,
	tCŞs
,
	tO±iÚs
,
	tMRows
,
	tMCŞs
> 
	tM©rixTy³
;

179 
run
(
M©rixTy³
& 
m©
, 
SluM©rix
& 
»s
)

181 
ei_as£¹
Ğ((
O±iÚs
&
RowMajÜ
)!=RowMajor) && "row-major dense matrices is‚ot supported by SuperLU");

182 
	g»s
.
£tStÜageTy³
(
SLU_DN
);

183 
	g»s
.
	g£tSÿÏrTy³
<
	gSÿÏr
>();

184 
	g»s
.
	gMty³
 = 
SLU_GE
;

186 
	g»s
.
	gÄow
 = 
m©
.
rows
();

187 
	g»s
.
	gncŞ
 = 
m©
.
cŞs
();

189 
	g»s
.
	g¡Üage
.
	glda
 = 
m©
.
¡ride
();

190 
	g»s
.
	g¡Üage
.
	gv®ues
 = 
m©
.
d©a
();

194 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

195 
	gSluM©rixM­H–³r
<
	gS·r£M©rixBa£
<
	gD”ived
> >

197 
D”ived
 
	tM©rixTy³
;

198 
run
(
M©rixTy³
& 
m©
, 
SluM©rix
& 
»s
)

200 ià((
	gM©rixTy³
::
FÏgs
&
RowMajÜB™
)==RowMajorBit)

202 
»s
.
£tStÜageTy³
(
SLU_NR
);

203 
	g»s
.
	gÄow
 = 
m©
.
cŞs
();

204 
	g»s
.
	gncŞ
 = 
m©
.
rows
();

208 
	g»s
.
£tStÜageTy³
(
SLU_NC
);

209 
	g»s
.
	gÄow
 = 
m©
.
rows
();

210 
	g»s
.
	gncŞ
 = 
m©
.
cŞs
();

213 
	g»s
.
	gMty³
 = 
SLU_GE
;

215 
	g»s
.
	g¡Üage
.
	gÂz
 = 
m©
.
nÚZ”os
();

216 
	g»s
.
	g¡Üage
.
	gv®ues
 = 
m©
.
_v®uePŒ
();

217 
	g»s
.
	g¡Üage
.
	gšÃrInd
 = 
m©
.
_šÃrIndexPŒ
();

218 
	g»s
.
	g¡Üage
.
	gou‹rInd
 = 
m©
.
_ou‹rIndexPŒ
();

220 
	g»s
.
	g£tSÿÏrTy³
<
ty³Çme
 
	gM©rixTy³
::
SÿÏr
>();

223 ià(
	gM©rixTy³
::
FÏgs
 & 
Uµ”TrŸnguÏr
)

224 
»s
.
Mty³
 = 
SLU_TRU
;

225 ià(
	gM©rixTy³
::
FÏgs
 & 
Low”TrŸnguÏr
)

226 
»s
.
Mty³
 = 
SLU_TRL
;

227 ià(
	gM©rixTy³
::
FÏgs
 & 
S–fAdjošt
)

228 
ei_as£¹
(
çl£
 && "SelfAdjoint matrix shape‚ot supported by SuperLU");

232 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

233 
SluM©rix
 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$asSluM©rix
()

235  
SluM©rix
::
	`M­
(
	`d”ived
());

236 
	}
}

239 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gFÏgs
>

240 
	gM­³dS·r£M©rix
<
	gSÿÏr
,
	gFÏgs
>::
	$M­³dS·r£M©rix
(
SluM©rix
& 
¦uM©
)

242 ià((
FÏgs
&
RowMajÜB™
)==RowMajorBit)

244 
	`as£¹
(
¦uM©
.
Sty³
 =ğ
SLU_NR
);

245 
m_šÃrSize
 = 
¦uM©
.
ncŞ
;

246 
m_ou‹rSize
 = 
¦uM©
.
Äow
;

250 
	`as£¹
(
¦uM©
.
Sty³
 =ğ
SLU_NC
);

251 
m_šÃrSize
 = 
¦uM©
.
Äow
;

252 
m_ou‹rSize
 = 
¦uM©
.
ncŞ
;

254 
m_ou‹rIndex
 = 
¦uM©
.
¡Üage
.
ou‹rInd
;

255 
m_šÃrIndiûs
 = 
¦uM©
.
¡Üage
.
šÃrInd
;

256 
m_v®ues
 = 
»š‹½»t_ÿ¡
<
SÿÏr
*>(
¦uM©
.
¡Üage
.
v®ues
);

257 
m_Âz
 = 
¦uM©
.
¡Üage
.
ou‹rInd
[
m_ou‹rSize
];

258 
	}
}

260 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

261 
şass
 
	gS·r£LU
<
	gM©rixTy³
,
	gSu³rLU
> : 
public
 
S·r£LU
<
M©rixTy³
>

263 
´Ùeùed
:

264 
S·r£LU
<
	tM©rixTy³
> 
	tBa£
;

265 
ty³Çme
 
	tBa£
::
	tSÿÏr
 Scalar;

266 
ty³Çme
 
	tBa£
::
	tR—lSÿÏr
 RealScalar;

267 
	gM©rix
<
	tSÿÏr
,
	tDyÇmic
,1> 
	tVeùÜ
;

268 
	gM©rix
<, 1, 
	tM©rixTy³
::
	tCŞsAtCompeTime
> 
	tIÁRowVeùÜTy³
;

269 
	gM©rix
<, 
	tM©rixTy³
::
	tRowsAtCompeTime
, 1> 
	tIÁCŞVeùÜTy³
;

270 
	gS·r£M©rix
<
	tSÿÏr
,
	tLow”TrŸnguÏr
|
	tUn™DŸgB™
> 
	tLM©rixTy³
;

271 
	gS·r£M©rix
<
	tSÿÏr
,
	tUµ”TrŸnguÏr
> 
	tUM©rixTy³
;

272 
usšg
 
	gBa£
::
m_æags
;

273 
usšg
 
	gBa£
::
m_¡©us
;

275 
	gpublic
:

277 
S·r£LU
(
æags
 = 
N©u¿lOrd”šg
)

278 : 
Ba£
(
æags
)

282 
S·r£LU
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
æags
 = 
N©u¿lOrd”šg
)

283 : 
Ba£
(
æags
)

285 
compu‹
(
m©rix
);

288 ~
S·r£LU
()

292 
šlše
 cÚ¡ 
	gLM©rixTy³
& 
m©rixL
() const

294 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

295  
	gm_l
;

298 
šlše
 cÚ¡ 
	gUM©rixTy³
& 
m©rixU
() const

300 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

301  
	gm_u
;

304 
šlše
 cÚ¡ 
	gIÁCŞVeùÜTy³
& 
³rmutiÚP
() const

306 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

307  
	gm_p
;

310 
šlše
 cÚ¡ 
	gIÁRowVeùÜTy³
& 
³rmutiÚQ
() const

312 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

313  
	gm_q
;

316 
SÿÏr
 
d‘”mšªt
() const;

318 
	g‹m¶©e
<
ty³Çme
 
	gBD”ived
,y³Çm
	gXD”ived
>

319 
boŞ
 
sŞve
(cÚ¡ 
M©rixBa£
<
BD”ived
> &
b
, M©rixBa£<
XD”ived
>* 
x
) const;

321 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

323 
	g´Ùeùed
:

325 
exŒaùD©a
() const;

327 
	g´Ùeùed
:

329 
mubË
 
LM©rixTy³
 
m_l
;

330 
mubË
 
UM©rixTy³
 
	gm_u
;

331 
mubË
 
IÁCŞVeùÜTy³
 
	gm_p
;

332 
mubË
 
IÁRowVeùÜTy³
 
	gm_q
;

334 
mubË
 
	gS·r£M©rix
<
	gSÿÏr
> 
	gm_m©rix
;

335 
mubË
 
SluM©rix
 
	gm_¦uA
;

336 
mubË
 
Su³rM©rix
 
	gm_¦uL
, 
	gm_¦uU
;

337 
mubË
 
SluM©rix
 
	gm_¦uB
, 
	gm_¦uX
;

338 
mubË
 
Su³rLUSt_t
 
	gm_¦uSt
;

339 
mubË
 
su³¾u_İtiÚs_t
 
	gm_¦uO±iÚs
;

340 
mubË
 
	g¡d
::
veùÜ
<> 
m_¦uEŒ“
;

341 
mubË
 
	g¡d
::
veùÜ
<
R—lSÿÏr
> 
m_¦uRsÿË
, 
	gm_¦uCsÿË
;

342 
mubË
 
	g¡d
::
veùÜ
<
R—lSÿÏr
> 
m_¦uF”r
, 
	gm_¦uB”r
;

343 
mubË
 
	gm_¦uEqued
;

344 
mubË
 
boŞ
 
	gm_exŒaùedD©aA»Dœty
;

347 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

348 
	gS·r£LU
<
	gM©rixTy³
,
	gSu³rLU
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

350 cÚ¡ 
size
 = 
a
.
	`rows
();

351 
m_m©rix
 = 
a
;

353 
	`£t_deçuÉ_İtiÚs
(&
m_¦uO±iÚs
);

354 
m_¦uO±iÚs
.
CŞP”m
 = 
NATURAL
;

355 
m_¦uO±iÚs
.
PrštSt
 = 
NO
;

356 
m_¦uO±iÚs
.
CÚd™iÚNumb”
 = 
NO
;

357 
m_¦uO±iÚs
.
T¿ns
 = 
NOTRANS
;

360 
Ba£
::
	`Üd”šgM‘hod
())

362 
N©u¿lOrd”šg
 : 
m_¦uO±iÚs
.
CŞP”m
 = 
NATURAL
; ;

363 
MšimumDeg»e_AT_PLUS_A
 : 
m_¦uO±iÚs
.
CŞP”m
 = 
MMD_AT_PLUS_A
; ;

364 
MšimumDeg»e_ATA
 : 
m_¦uO±iÚs
.
CŞP”m
 = 
MMD_ATA
; ;

365 
CŞAµroxMšimumDeg»e
 : 
m_¦uO±iÚs
.
CŞP”m
 = 
COLAMD
; ;

367 
¡d
::
û¼
 << "Eig’: ord”šg m‘hod \"" << 
Ba£
::
	`Üd”šgM‘hod
() << "\"‚ot supported byhe SuperLU backend\n";

368 
m_¦uO±iÚs
.
CŞP”m
 = 
NATURAL
;

371 
m_¦uA
 = 
m_m©rix
.
	`asSluM©rix
();

372 
	`mem£t
(&
m_¦uL
,0, m_sluL);

373 
	`mem£t
(&
m_¦uU
,0, m_sluU);

374 
m_¦uEqued
 = 'B';

375 
šfo
 = 0;

377 
m_p
.
	`»size
(
size
);

378 
m_q
.
	`»size
(
size
);

379 
m_¦uRsÿË
.
	`»size
(
size
);

380 
m_¦uCsÿË
.
	`»size
(
size
);

381 
m_¦uEŒ“
.
	`»size
(
size
);

383 
R—lSÿÏr
 
»c_pivÙ_gross
, 
rcÚd
;

384 
R—lSÿÏr
 
ã¼
, 
b”r
;

387 
m_¦uB
.
	`£tStÜageTy³
(
SLU_DN
);

388 
m_¦uB
.
£tSÿÏrTy³
<
SÿÏr
>();

389 
m_¦uB
.
Mty³
 = 
SLU_GE
;

390 
m_¦uB
.
¡Üage
.
v®ues
 = 0;

391 
m_¦uB
.
Äow
 = m_¦uB.
ncŞ
 = 0;

392 
m_¦uB
.
¡Üage
.
lda
 = 
size
;

393 
m_¦uX
 = 
m_¦uB
;

395 
	`StIn™
(&
m_¦uSt
);

396 
	`Su³rLU_gssvx
(&
m_¦uO±iÚs
, &
m_¦uA
, 
m_q
.
	`d©a
(), 
m_p
.d©a(), &
m_¦uEŒ“
[0],

397 &
m_¦uEqued
, &
m_¦uRsÿË
[0], &
m_¦uCsÿË
[0],

398 &
m_¦uL
, &
m_¦uU
,

399 
NULL
, 0,

400 &
m_¦uB
, &
m_¦uX
,

401 &
»c_pivÙ_gross
, &
rcÚd
,

402 &
ã¼
, &
b”r
,

403 &
m_¦uSt
, &
šfo
, 
	`SÿÏr
());

404 
	`StF»e
(&
m_¦uSt
);

406 
m_exŒaùedD©aA»Dœty
 = 
Œue
;

409 
Ba£
::
m_sucûeded
 = (
šfo
 == 0);

410 
	}
}

412 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

413 
	g‹m¶©e
<
ty³Çme
 
	gBD”ived
,ty³Çm
	gXD”ived
>

414 
boŞ
 
	gS·r£LU
<
	gM©rixTy³
,
	gSu³rLU
>::
sŞve
(cÚ¡ 
M©rixBa£
<
BD”ived
> &
b
, M©rixBa£<
XD”ived
> *
x
) const

416 cÚ¡ 
	gsize
 = 
m_m©rix
.
rows
();

417 cÚ¡ 
	grhsCŞs
 = 
b
.
cŞs
();

418 
ei_as£¹
(
size
==
b
.
rows
());

420 
	gm_¦uO±iÚs
.
	gFaù
 = 
FACTORED
;

421 
	gm_¦uO±iÚs
.
	gI‹rRefše
 = 
NOREFINE
;

423 
	gm_¦uF”r
.
»size
(
rhsCŞs
);

424 
	gm_¦uB”r
.
»size
(
rhsCŞs
);

425 
	gm_¦uB
 = 
SluM©rix
::
M­
(
b
.
cÚ¡_ÿ¡_d”ived
());

426 
	gm_¦uX
 = 
SluM©rix
::
M­
(
x
->
d”ived
());

428 
StIn™
(&
m_¦uSt
);

429 
	gšfo
 = 0;

430 
R—lSÿÏr
 
	g»c_pivÙ_gross
, 
	grcÚd
;

431 
Su³rLU_gssvx
(

432 &
m_¦uO±iÚs
, &
m_¦uA
,

433 
m_q
.
d©a
(), 
m_p
.data(),

434 &
m_¦uEŒ“
[0], &
m_¦uEqued
,

435 &
m_¦uRsÿË
[0], &
m_¦uCsÿË
[0],

436 &
m_¦uL
, &
m_¦uU
,

437 
NULL
, 0,

438 &
m_¦uB
, &
m_¦uX
,

439 &
»c_pivÙ_gross
, &
rcÚd
,

440 &
m_¦uF”r
[0], &
m_¦uB”r
[0],

441 &
m_¦uSt
, &
šfo
, 
SÿÏr
());

442 
StF»e
(&
m_¦uSt
);

444  
	gšfo
==0;

455 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

456 
	gS·r£LU
<
	gM©rixTy³
,
	gSu³rLU
>::
	$exŒaùD©a
() const

458 ià(
m_exŒaùedD©aA»Dœty
)

460 
uµ”
;

461 
fsupc
, 
i¡¬t
, 
nsu´
;

462 
Ï¡l
 = 0, 
Ï¡u
 = 0;

463 
SCfÜm©
 *
L¡Üe
 = 
¡©ic_ÿ¡
<SCfÜm©*>(
m_¦uL
.
StÜe
);

464 
NCfÜm©
 *
U¡Üe
 = 
¡©ic_ÿ¡
<NCfÜm©*>(
m_¦uU
.
StÜe
);

465 
SÿÏr
 *
SN±r
;

467 cÚ¡ 
size
 = 
m_m©rix
.
	`rows
();

468 
m_l
.
	`»size
(
size
,size);

469 
m_l
.
	`»sizeNÚZ”os
(
L¡Üe
->
Âz
);

470 
m_u
.
	`»size
(
size
,size);

471 
m_u
.
	`»sizeNÚZ”os
(
U¡Üe
->
Âz
);

473 * 
LcŞ
 = 
m_l
.
	`_ou‹rIndexPŒ
();

474 * 
Lrow
 = 
m_l
.
	`_šÃrIndexPŒ
();

475 
SÿÏr
* 
Lv®
 = 
m_l
.
	`_v®uePŒ
();

477 * 
UcŞ
 = 
m_u
.
	`_ou‹rIndexPŒ
();

478 * 
Urow
 = 
m_u
.
	`_šÃrIndexPŒ
();

479 
SÿÏr
* 
Uv®
 = 
m_u
.
	`_v®uePŒ
();

481 
UcŞ
[0] = 0;

482 
UcŞ
[0] = 0;

485 
k
 = 0; k <ğ
L¡Üe
->
nsu³r
; ++k)

487 
fsupc
 = 
	`L_FST_SUPC
(
k
);

488 
i¡¬t
 = 
	`L_SUB_START
(
fsupc
);

489 
nsu´
 = 
	`L_SUB_START
(
fsupc
+1è- 
i¡¬t
;

490 
uµ”
 = 1;

493 
j
 = 
fsupc
; j < 
	`L_FST_SUPC
(
k
+1); ++j)

495 
SN±r
 = &((
SÿÏr
*)
L¡Üe
->
nzv®
)[
	`L_NZ_START
(
j
)];

498 
i
 = 
	`U_NZ_START
(
j
); i < U_NZ_START(j+1); ++i)

500 
Uv®
[
Ï¡u
] = ((
SÿÏr
*)
U¡Üe
->
nzv®
)[
i
];

502 ià(
Uv®
[
Ï¡u
] != 0.0)

503 
Urow
[
Ï¡u
++] = 
	`U_SUB
(
i
);

505 
i
 = 0; i < 
uµ”
; ++i)

508 
Uv®
[
Ï¡u
] = 
SN±r
[
i
];

510 ià(
Uv®
[
Ï¡u
] != 0.0)

511 
Urow
[
Ï¡u
++] = 
	`L_SUB
(
i¡¬t
+
i
);

513 
UcŞ
[
j
+1] = 
Ï¡u
;

516 
Lv®
[
Ï¡l
] = 1.0;

517 
Lrow
[
Ï¡l
++] = 
	`L_SUB
(
i¡¬t
 + 
uµ”
 - 1);

518 
i
 = 
uµ”
; i < 
nsu´
; ++i)

520 
Lv®
[
Ï¡l
] = 
SN±r
[
i
];

522 ià(
Lv®
[
Ï¡l
] != 0.0)

523 
Lrow
[
Ï¡l
++] = 
	`L_SUB
(
i¡¬t
+
i
);

525 
LcŞ
[
j
+1] = 
Ï¡l
;

527 ++
uµ”
;

533 
m_l
.
	`»sizeNÚZ”os
(
Ï¡l
);

534 
m_u
.
	`»sizeNÚZ”os
(
Ï¡u
);

536 
m_exŒaùedD©aA»Dœty
 = 
çl£
;

538 
	}
}

540 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

541 
ty³Çme
 
	gS·r£LU
<
	gM©rixTy³
,
	gSu³rLU
>::
SÿÏr
 
S·r£LU
<
M©rixTy³
,Su³rLU>::
	$d‘”mšªt
() const

543 ià(
m_exŒaùedD©aA»Dœty
)

544 
	`exŒaùD©a
();

548 
SÿÏr
 
d‘
 = 
	`SÿÏr
(1);

549 
j
=0; j<
m_u
.
	`cŞs
(); ++j)

551 ià(
m_u
.
	`_ou‹rIndexPŒ
()[
j
+1]-m_u._outerIndexPtr()[j] > 0)

553 
Ï¡Id
 = 
m_u
.
	`_ou‹rIndexPŒ
()[
j
+1]-1;

554 
	`ei_as£¹
(
m_u
.
	`_šÃrIndexPŒ
()[
Ï¡Id
]<=
j
);

555 ià(
m_u
.
	`_šÃrIndexPŒ
()[
Ï¡Id
]==
j
)

557 
d‘
 *ğ
m_u
.
	`_v®uePŒ
()[
Ï¡Id
];

562  
d‘
;

563 
	}
}

	@robot/Eigen/src/Sparse/TaucsSupport.h

25 #iâdeà
EIGEN_TAUCSSUPPORT_H


26 
	#EIGEN_TAUCSSUPPORT_H


	)

28 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

29 
ucs_ccs_m©rix
 
	gS·r£M©rixBa£
<
	gD”ived
>::
	$asTaucsM©rix
()

31 
ucs_ccs_m©rix
 
»s
;

32 
»s
.
n
 = 
	`cŞs
();

33 
»s
.
m
 = 
	`rows
();

34 
»s
.
æags
 = 0;

35 
»s
.
cŞ±r
 = 
	`d”ived
().
	`_ou‹rIndexPŒ
();

36 
»s
.
rowšd
 = 
	`d”ived
().
	`_šÃrIndexPŒ
();

37 
»s
.
v®ues
.
v
 = 
	`d”ived
().
	`_v®uePŒ
();

38 ià(
ei_is_§me_ty³
<
SÿÏr
,>::
»t
)

39 
»s
.
æags
 |ğ
TAUCS_INT
;

40 ià(
ei_is_§me_ty³
<
SÿÏr
,>::
»t
)

41 
»s
.
æags
 |ğ
TAUCS_SINGLE
;

42 ià(
ei_is_§me_ty³
<
SÿÏr
,>::
»t
)

43 
»s
.
æags
 |ğ
TAUCS_DOUBLE
;

44 ià(
ei_is_§me_ty³
<
SÿÏr
,
¡d
::
com¶ex
<> >::
»t
)

45 
»s
.
æags
 |ğ
TAUCS_SCOMPLEX
;

46 ià(
ei_is_§me_ty³
<
SÿÏr
,
¡d
::
com¶ex
<> >::
»t
)

47 
»s
.
æags
 |ğ
TAUCS_DCOMPLEX
;

50 
	`ei_as£¹
(
çl£
 && "Scalarype‚ot supported by TAUCS");

53 ià(
FÏgs
 & 
Uµ”TrŸnguÏr
)

54 
»s
.
æags
 |ğ
TAUCS_UPPER
;

55 ià(
FÏgs
 & 
Low”TrŸnguÏr
)

56 
»s
.
æags
 |ğ
TAUCS_LOWER
;

57 ià(
FÏgs
 & 
S–fAdjošt
)

58 
»s
.
æags
 |ğ(
NumT¿™s
<
SÿÏr
>::
IsCom¶ex
 ? 
TAUCS_HERMITIAN
 : 
TAUCS_SYMMETRIC
);

59 ià((
FÏgs
 & 
Uµ”TrŸnguÏr
è|| (FÏg & 
Low”TrŸnguÏr
))

60 
»s
.
æags
 |ğ
TAUCS_TRIANGULAR
;

62  
»s
;

63 
	}
}

65 
	g‹m¶©e
<
ty³Çme
 
	gSÿÏr
, 
	gFÏgs
>

66 
	gM­³dS·r£M©rix
<
	gSÿÏr
,
	gFÏgs
>::
	$M­³dS·r£M©rix
(
ucs_ccs_m©rix
& 
ucsM©
)

68 
m_šÃrSize
 = 
ucsM©
.
m
;

69 
m_ou‹rSize
 = 
ucsM©
.
n
;

70 
m_ou‹rIndex
 = 
ucsM©
.
cŞ±r
;

71 
m_šÃrIndiûs
 = 
ucsM©
.
rowšd
;

72 
m_v®ues
 = 
»š‹½»t_ÿ¡
<
SÿÏr
*>(
ucsM©
.
v®ues
.
v
);

73 
m_Âz
 = 
ucsM©
.
cŞ±r
[ucsM©.
n
];

74 
	}
}

76 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

77 
şass
 
	gS·r£LLT
<
	gM©rixTy³
,
	gTaucs
> : 
public
 
S·r£LLT
<
M©rixTy³
>

79 
´Ùeùed
:

80 
S·r£LLT
<
	tM©rixTy³
> 
	tBa£
;

81 
ty³Çme
 
	tBa£
::
	tSÿÏr
 Scalar;

82 
ty³Çme
 
	tBa£
::
	tR—lSÿÏr
 RealScalar;

83 
usšg
 
	gBa£
::
M©rixLIsDœty
;

84 
usšg
 
	gBa£
::
Su³ºod®FaùÜIsDœty
;

85 
usšg
 
	gBa£
::
m_æags
;

86 
usšg
 
	gBa£
::
m_m©rix
;

87 
usšg
 
	gBa£
::
m_¡©us
;

89 
	gpublic
:

91 
S·r£LLT
(
æags
 = 0)

92 : 
Ba£
(
æags
), 
m_ucsSu³ºod®FaùÜ
(0)

96 
S·r£LLT
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
æags
 = 0)

97 : 
Ba£
(
æags
), 
m_ucsSu³ºod®FaùÜ
(0)

99 
compu‹
(
m©rix
);

102 ~
S·r£LLT
()

104 ià(
	gm_ucsSu³ºod®FaùÜ
)

105 
ucs_su³ºod®_çùÜ_ä“
(
m_ucsSu³ºod®FaùÜ
);

108 
šlše
 cÚ¡ 
ty³Çme
 
	gBa£
::
ChŞM©rixTy³
& 
m©rixL
() const;

110 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

111 
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const;

113 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

115 
	g´Ùeùed
:

116 * 
m_ucsSu³ºod®FaùÜ
;

119 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

120 
	gS·r£LLT
<
	gM©rixTy³
,
	gTaucs
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

122 ià(
m_ucsSu³ºod®FaùÜ
)

124 
	`ucs_su³ºod®_çùÜ_ä“
(
m_ucsSu³ºod®FaùÜ
);

125 
m_ucsSu³ºod®FaùÜ
 = 0;

128 ià(
m_æags
 & 
Incom¶‘eFaùÜiz©iÚ
)

130 
ucs_ccs_m©rix
 
ucsM©A
 = 
cÚ¡_ÿ¡
<
M©rixTy³
&>(
a
).
	`asTaucsM©rix
();

131 
ucs_ccs_m©rix
* 
ucsRes
 = 
	`ucs_ccs_çùÜ_Ît
(&
ucsM©A
, 
Ba£
::
m_´ecisiÚ
, 0);

134 
DyÇmicS·r£M©rix
<
SÿÏr
,
RowMajÜ
> 
tmp
 = 
M­³dS·r£M©rix
<SÿÏr>(*
ucsRes
);

135 
m_m©rix
 = 
tmp
;

136 
	`ä“
(
ucsRes
);

137 
m_¡©us
 = (m_¡©u & ~(
Com¶‘eFaùÜiz©iÚ
|
M©rixLIsDœty
))

138 | 
Incom¶‘eFaùÜiz©iÚ


139 | 
Su³ºod®FaùÜIsDœty
;

143 
ucs_ccs_m©rix
 
ucsM©A
 = 
cÚ¡_ÿ¡
<
M©rixTy³
&>(
a
).
	`asTaucsM©rix
();

144 iàĞ(
m_æags
 & 
Su³ºod®LeáLookšg
)

145 || ((!(
m_æags
 & 
Su³ºod®MuÉiäÚl
)è&& (m_æag & 
MemÜyEffic›Á
)) )

147 
m_ucsSu³ºod®FaùÜ
 = 
	`ucs_ccs_çùÜ_Ît_Î
(&
ucsM©A
);

152 
m_ucsSu³ºod®FaùÜ
 = 
	`ucs_ccs_çùÜ_Ît_mf
(&
ucsM©A
);

154 
m_¡©us
 = (m_¡©u & ~
Incom¶‘eFaùÜiz©iÚ
è| 
Com¶‘eFaùÜiz©iÚ
 | 
M©rixLIsDœty
;

156 
	}
}

158 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

159 
šlše
 cÚ¡ 
ty³Çme
 
	gS·r£LLT
<
	gM©rixTy³
>::
ChŞM©rixTy³
&

160 
S·r£LLT
<
M©rixTy³
,
	gTaucs
>::
	$m©rixL
() const

162 ià(
m_¡©us
 & 
M©rixLIsDœty
)

164 
	`ei_as£¹
(!(
m_¡©us
 & 
Su³ºod®FaùÜIsDœty
));

166 
ucs_ccs_m©rix
* 
ucsL
 = 
	`ucs_su³ºod®_çùÜ_to_ccs
(
m_ucsSu³ºod®FaùÜ
);

170 
DyÇmicS·r£M©rix
<
SÿÏr
,
RowMajÜ
> 
tmp
 = 
M­³dS·r£M©rix
<SÿÏr>(*
ucsL
);

171 
cÚ¡_ÿ¡
<
ty³Çme
 
Ba£
::
ChŞM©rixTy³
&>(
m_m©rix
èğ
tmp
;

172 
	`ä“
(
ucsL
);

173 
m_¡©us
 = (m_¡©u & ~
M©rixLIsDœty
);

175  
m_m©rix
;

176 
	}
}

178 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

179 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

180 
	gS·r£LLT
<
	gM©rixTy³
,
	gTaucs
>::
sŞveInPÏû
(
M©rixBa£
<
D”ived
> &
b
) const

182 
boŞ
 
šputIsCom·tibËW™hTaucs
 = (
D”ived
::
FÏgs
&
RowMajÜB™
)==0;

184 ià(!
	gšputIsCom·tibËW™hTaucs
)

186 
m©rixL
();

187 
	gBa£
::
sŞveInPÏû
(
b
);

189 ià(
	gm_æags
 & 
	gIncom¶‘eFaùÜiz©iÚ
)

191 
ucs_ccs_m©rix
 
	gucsLLT
 = 
cÚ¡_ÿ¡
<
ty³Çme
 
Ba£
::
ChŞM©rixTy³
&>(
m_m©rix
).
asTaucsM©rix
();

192 
ty³Çme
 
	gei_¶aš_m©rix_ty³
<
	gD”ived
>::
ty³
 
x
(
b
.
rows
());

193 
	gj
=0; j<
	gb
.
cŞs
(); ++j)

195 
ucs_ccs_sŞve_Ît
(&
ucsLLT
,
x
.
d©a
(),&
b
.
cŞ
(
j
).
cÛffRef
(0));

196 
	gb
.
cŞ
(
j
èğ
x
;

201 
ty³Çme
 
	gei_¶aš_m©rix_ty³
<
	gD”ived
>::
ty³
 
x
(
b
.
rows
());

202 
	gj
=0; j<
	gb
.
cŞs
(); ++j)

204 
ucs_su³ºod®_sŞve_Ît
(
m_ucsSu³ºod®FaùÜ
,
x
.
d©a
(),&
b
.
cŞ
(
j
).
cÛffRef
(0));

205 
	gb
.
cŞ
(
j
èğ
x
;

	@robot/Eigen/src/Sparse/TriangularSolver.h

25 #iâdeà
EIGEN_SPARSETRIANGULARSOLVER_H


26 
	#EIGEN_SPARSETRIANGULARSOLVER_H


	)

29 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

30 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gLhs
,
	gRhs
,
	gLow”TrŸnguÏr
,
	gRowMajÜ
|
	gIsS·r£
>

32 
ty³Çme
 
	tRhs
::
	tSÿÏr
 Scalar;

33 
run
(cÚ¡ 
Lhs
& 
lhs
, 
Rhs
& 
Ùh”
)

35 
	gcŞ
=0 ; cŞ<
	gÙh”
.
cŞs
() ; ++col)

37 
	gi
=0; i<
	glhs
.
rows
(); ++i)

39 
SÿÏr
 
	gtmp
 = 
Ùh”
.
cÛff
(
i
,
cŞ
);

40 
SÿÏr
 
	gÏ¡V®
 = 0;

41 
	gÏ¡Index
 = 0;

42 
ty³Çme
 
	gLhs
::
IÂ”I‹¿tÜ
 
™
(
lhs
, 
i
); 
	g™
; ++it)

44 
	gÏ¡V®
 = 
™
.
v®ue
();

45 
	gÏ¡Index
 = 
™
.
šdex
();

46 if(
	gÏ¡Index
 =ğ
i
)

48 
	gtmp
 -ğ
Ï¡V®
 * 
Ùh”
.
cÛff
(
Ï¡Index
,
cŞ
);

51 ià(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
)

52 
Ùh”
.
cÛffRef
(
i
,
cŞ
èğ
tmp
;

55 
ei_as£¹
(
Ï¡Index
==
i
);

56 
	gÙh”
.
cÛffRef
(
i
,
cŞ
èğ
tmp
/
Ï¡V®
;

64 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

65 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gLhs
,
	gRhs
,
	gUµ”TrŸnguÏr
,
	gRowMajÜ
|
	gIsS·r£
>

67 
ty³Çme
 
	tRhs
::
	tSÿÏr
 Scalar;

68 
run
(cÚ¡ 
Lhs
& 
lhs
, 
Rhs
& 
Ùh”
)

70 
	gcŞ
=0 ; cŞ<
	gÙh”
.
cŞs
() ; ++col)

72 
	gi
=
lhs
.
rows
()-1 ; i>=0 ; --i)

74 
SÿÏr
 
	gtmp
 = 
Ùh”
.
cÛff
(
i
,
cŞ
);

75 
ty³Çme
 
	gLhs
::
IÂ”I‹¿tÜ
 
™
(
lhs
, 
i
);

76 ià(
	g™
.
šdex
(è=ğ
i
)

77 ++
™
;

78 ; 
	g™
; ++it)

80 
	gtmp
 -ğ
™
.
v®ue
(è* 
Ùh”
.
cÛff
(™.
šdex
(),
cŞ
);

83 ià(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
)

84 
Ùh”
.
cÛffRef
(
i
,
cŞ
èğ
tmp
;

87 
ty³Çme
 
	gLhs
::
IÂ”I‹¿tÜ
 
™
(
lhs
, 
i
);

88 
ei_as£¹
(
™
.
šdex
(è=ğ
i
);

89 
	gÙh”
.
cÛffRef
(
i
,
cŞ
èğ
tmp
/
™
.
v®ue
();

97 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

98 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gLhs
,
	gRhs
,
	gLow”TrŸnguÏr
,
	gCŞMajÜ
|
	gIsS·r£
>

100 
ty³Çme
 
	tRhs
::
	tSÿÏr
 Scalar;

101 
run
(cÚ¡ 
Lhs
& 
lhs
, 
Rhs
& 
Ùh”
)

103 
	gcŞ
=0 ; cŞ<
	gÙh”
.
cŞs
() ; ++col)

105 
	gi
=0; i<
	glhs
.
cŞs
(); ++i)

107 
ty³Çme
 
	gLhs
::
IÂ”I‹¿tÜ
 
™
(
lhs
, 
i
);

108 if(!(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
))

111 
ei_as£¹
(
™
.
šdex
()==
i
);

112 
	gÙh”
.
cÛffRef
(
i
,
cŞ
è/ğ
™
.
v®ue
();

114 
SÿÏr
 
	gtmp
 = 
Ùh”
.
cÛffRef
(
i
,
cŞ
);

115 ià(
	g™
.
šdex
()==
i
)

116 ++
™
;

117 ; 
	g™
; ++it)

118 
	gÙh”
.
cÛffRef
(
™
.
šdex
(), 
cŞ
è-ğ
tmp
 * it.
v®ue
();

125 
	g‹m¶©e
<
ty³Çme
 
	gLhs
,y³Çm
	gRhs
>

126 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gLhs
,
	gRhs
,
	gUµ”TrŸnguÏr
,
	gCŞMajÜ
|
	gIsS·r£
>

128 
ty³Çme
 
	tRhs
::
	tSÿÏr
 Scalar;

129 
run
(cÚ¡ 
Lhs
& 
lhs
, 
Rhs
& 
Ùh”
)

131 
	gcŞ
=0 ; cŞ<
	gÙh”
.
cŞs
() ; ++col)

133 
	gi
=
lhs
.
cŞs
()-1; i>=0; --i)

135 if(!(
	gLhs
::
FÏgs
 & 
Un™DŸgB™
))

139 
Ùh”
.
cÛffRef
(
i
,
cŞ
è/ğ
lhs
.
cÛff
(i,i);

141 
SÿÏr
 
	gtmp
 = 
Ùh”
.
cÛffRef
(
i
,
cŞ
);

142 
ty³Çme
 
	gLhs
::
IÂ”I‹¿tÜ
 
™
(
lhs
, 
i
);

143 ; 
	g™
 && it.
šdex
()<
	gi
; ++it)

144 
	gÙh”
.
cÛffRef
(
™
.
šdex
(), 
cŞ
è-ğ
tmp
 * it.
v®ue
();

150 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

151 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

152 
	gS·r£M©rixBa£
<
	gD”ived
>::
sŞveTrŸnguÏrInPÏû
(
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const

154 
ei_as£¹
(
d”ived
().
cŞs
(è=ğd”ived().
rows
());

155 
ei_as£¹
(
d”ived
().
cŞs
(è=ğ
Ùh”
.
rows
());

156 
ei_as£¹
(!(
FÏgs
 & 
Z”oDŸgB™
));

157 
ei_as£¹
(
FÏgs
 & (
Uµ”TrŸnguÏrB™
|
Low”TrŸnguÏrB™
));

159 ’um { 
	gcİy
 = 
ei_Œa™s
<
Oth”D”ived
>::
FÏgs
 & 
RowMajÜB™
 };

161 
ty³Çme
 
	tei_m‘a_if
<
	tcİy
,

162 
	tty³Çme
 
	tei_¶aš_m©rix_ty³_cŞumn_majÜ
<
	tOth”D”ived
>::
	tty³
, Oth”D”ived&>::
	t»t
 
	tOth”Cİy
;

163 
Oth”Cİy
 
Ùh”Cİy
(
Ùh”
.
d”ived
());

165 
	gei_sŞve_ŒŸnguÏr_£ËùÜ
<
	gD”ived
, 
ty³Çme
 
	gei_uÄef
<
	gOth”Cİy
>::
ty³
>::
run
(
d”ived
(), 
Ùh”Cİy
);

167 ià(
	gcİy
)

168 
	gÙh”
 = 
Ùh”Cİy
;

171 
	g‹m¶©e
<
ty³Çme
 
	gD”ived
>

172 
	g‹m¶©e
<
ty³Çme
 
	gOth”D”ived
>

173 
ty³Çme
 
	gei_¶aš_m©rix_ty³_cŞumn_majÜ
<
	gOth”D”ived
>::
ty³


174 
S·r£M©rixBa£
<
D”ived
>::
sŞveTrŸnguÏr
(cÚ¡ 
M©rixBa£
<
Oth”D”ived
>& 
Ùh”
) const

176 
ty³Çme
 
ei_¶aš_m©rix_ty³_cŞumn_majÜ
<
Oth”D”ived
>::
ty³
 
»s
(
Ùh”
);

177 
sŞveTrŸnguÏrInPÏû
(
»s
);

178  
	g»s
;

	@robot/Eigen/src/Sparse/UmfPackSupport.h

25 #iâdeà
EIGEN_UMFPACKSUPPORT_H


26 
	#EIGEN_UMFPACKSUPPORT_H


	)

32 
šlše
 
	$umåack_ä“_num”ic
(**
Num”ic
, )

33 { 
	`umåack_di_ä“_num”ic
(
Num”ic
); 
	}
}

35 
šlše
 
umåack_ä“_num”ic
(**
Num”ic
, 
¡d
::
com¶ex
<>)

36 { 
umåack_zi_ä“_num”ic
(
Num”ic
); }

38 
šlše
 
	$umåack_ä“_symbŞic
(**
SymbŞic
, )

39 { 
	`umåack_di_ä“_symbŞic
(
SymbŞic
); 
	}
}

41 
šlše
 
umåack_ä“_symbŞic
(**
SymbŞic
, 
¡d
::
com¶ex
<>)

42 { 
umåack_zi_ä“_symbŞic
(
SymbŞic
); }

44 
šlše
 
	$umåack_symbŞic
(
n_row
,
n_cŞ
,

45 cÚ¡ 
Ap
[], cÚ¡ 
Ai
[], cÚ¡ 
Ax
[], **
SymbŞic
,

46 cÚ¡ 
CÚŒŞ
 [
UMFPACK_CONTROL
], 
Info
 [
UMFPACK_INFO
])

48  
	`umåack_di_symbŞic
(
n_row
,
n_cŞ
,
Ap
,
Ai
,
Ax
,
SymbŞic
,
CÚŒŞ
,
Info
);

49 
	}
}

51 
šlše
 
umåack_symbŞic
(
n_row
,
n_cŞ
,

52 cÚ¡ 
Ap
[], cÚ¡ 
Ai
[], cÚ¡ 
¡d
::
com¶ex
<> 
Ax
[], **
SymbŞic
,

53 cÚ¡ 
CÚŒŞ
 [
UMFPACK_CONTROL
], 
Info
 [
UMFPACK_INFO
])

55  
umåack_zi_symbŞic
(
n_row
,
n_cŞ
,
Ap
,
Ai
,&
Ax
[0].
»®
(),0,
SymbŞic
,
CÚŒŞ
,
Info
);

58 
šlše
 
	$umåack_num”ic
ĞcÚ¡ 
Ap
[], cÚ¡ 
Ai
[], cÚ¡ 
Ax
[],

59 *
SymbŞic
, **
Num”ic
,

60 cÚ¡ 
CÚŒŞ
[
UMFPACK_CONTROL
],
Info
 [
UMFPACK_INFO
])

62  
	`umåack_di_num”ic
(
Ap
,
Ai
,
Ax
,
SymbŞic
,
Num”ic
,
CÚŒŞ
,
Info
);

63 
	}
}

65 
šlše
 
umåack_num”ic
ĞcÚ¡ 
Ap
[], cÚ¡ 
Ai
[], cÚ¡ 
¡d
::
com¶ex
<> 
Ax
[],

66 *
SymbŞic
, **
Num”ic
,

67 cÚ¡ 
CÚŒŞ
[
UMFPACK_CONTROL
],
Info
 [
UMFPACK_INFO
])

69  
umåack_zi_num”ic
(
Ap
,
Ai
,&
Ax
[0].
»®
(),0,
SymbŞic
,
Num”ic
,
CÚŒŞ
,
Info
);

72 
šlše
 
	$umåack_sŞve
Ğ
sys
, cÚ¡ 
Ap
[], cÚ¡ 
Ai
[], cÚ¡ 
Ax
[],

73 
X
[], cÚ¡ 
B
[], *
Num”ic
,

74 cÚ¡ 
CÚŒŞ
[
UMFPACK_CONTROL
], 
Info
[
UMFPACK_INFO
])

76  
	`umåack_di_sŞve
(
sys
,
Ap
,
Ai
,
Ax
,
X
,
B
,
Num”ic
,
CÚŒŞ
,
Info
);

77 
	}
}

79 
šlše
 
umåack_sŞve
Ğ
sys
, cÚ¡ 
Ap
[], cÚ¡ 
Ai
[], cÚ¡ 
¡d
::
com¶ex
<> 
Ax
[],

80 
¡d
::
com¶ex
<> 
X
[], cÚ¡ std::com¶ex<> 
B
[], *
Num”ic
,

81 cÚ¡ 
CÚŒŞ
[
UMFPACK_CONTROL
], 
Info
[
UMFPACK_INFO
])

83  
umåack_zi_sŞve
(
sys
,
Ap
,
Ai
,&
Ax
[0].
»®
(),0,&
X
[0].»®(),0,&
B
[0].»®(),0,
Num”ic
,
CÚŒŞ
,
Info
);

86 
šlše
 
	$umåack_g‘_lunz
(*
Êz
, *
unz
, *
n_row
, *
n_cŞ
, *
nz_udŸg
, *
Num”ic
, )

88  
	`umåack_di_g‘_lunz
(
Êz
,
unz
,
n_row
,
n_cŞ
,
nz_udŸg
,
Num”ic
);

89 
	}
}

91 
šlše
 
umåack_g‘_lunz
(*
Êz
, *
unz
, *
n_row
, *
n_cŞ
, *
nz_udŸg
, *
Num”ic
, 
¡d
::
com¶ex
<>)

93  
umåack_zi_g‘_lunz
(
Êz
,
unz
,
n_row
,
n_cŞ
,
nz_udŸg
,
Num”ic
);

96 
šlše
 
	$umåack_g‘_num”ic
(
Lp
[], 
Lj
[], 
Lx
[], 
Up
[], 
Ui
[], 
Ux
[],

97 
P
[], 
Q
[], 
Dx
[], *
do_»c
, 
Rs
[], *
Num”ic
)

99  
	`umåack_di_g‘_num”ic
(
Lp
,
Lj
,
Lx
,
Up
,
Ui
,
Ux
,
P
,
Q
,
Dx
,
do_»c
,
Rs
,
Num”ic
);

100 
	}
}

102 
šlše
 
umåack_g‘_num”ic
(
Lp
[], 
Lj
[], 
¡d
::
com¶ex
<> 
Lx
[], 
Up
[], 
Ui
[], std::com¶ex<> 
Ux
[],

103 
P
[], 
Q
[], 
¡d
::
com¶ex
<> 
Dx
[], *
do_»c
, 
Rs
[], *
Num”ic
)

105  
umåack_zi_g‘_num”ic
(
Lp
,
Lj
,
Lx
?&Lx[0].
»®
():0,0,
Up
,
Ui
,
Ux
?&Ux[0].»®():0,0,
P
,
Q
,

106 
Dx
?&Dx[0].
»®
():0,0,
do_»c
,
Rs
,
Num”ic
);

109 
šlše
 
	$umåack_g‘_d‘”mšªt
(*
Mx
, *
Ex
, *
Num”icHªdË
, 
U£r_Info
 [
UMFPACK_INFO
])

111  
	`umåack_di_g‘_d‘”mšªt
(
Mx
,
Ex
,
Num”icHªdË
,
U£r_Info
);

112 
	}
}

114 
šlše
 
umåack_g‘_d‘”mšªt
(
¡d
::
com¶ex
<> *
Mx
, *
Ex
, *
Num”icHªdË
, 
U£r_Info
 [
UMFPACK_INFO
])

116  
umåack_zi_g‘_d‘”mšªt
(&
Mx
->
»®
(),0,
Ex
,
Num”icHªdË
,
U£r_Info
);

120 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

121 
şass
 
	gS·r£LU
<
	gM©rixTy³
,
	gUmfPack
> : 
public
 
S·r£LU
<
M©rixTy³
>

123 
´Ùeùed
:

124 
S·r£LU
<
	tM©rixTy³
> 
	tBa£
;

125 
ty³Çme
 
	tBa£
::
	tSÿÏr
 Scalar;

126 
ty³Çme
 
	tBa£
::
	tR—lSÿÏr
 RealScalar;

127 
	gM©rix
<
	tSÿÏr
,
	tDyÇmic
,1> 
	tVeùÜ
;

128 
	gM©rix
<, 1, 
	tM©rixTy³
::
	tCŞsAtCompeTime
> 
	tIÁRowVeùÜTy³
;

129 
	gM©rix
<, 
	tM©rixTy³
::
	tRowsAtCompeTime
, 1> 
	tIÁCŞVeùÜTy³
;

130 
	gS·r£M©rix
<
	tSÿÏr
,
	tLow”TrŸnguÏr
|
	tUn™DŸgB™
> 
	tLM©rixTy³
;

131 
	gS·r£M©rix
<
	tSÿÏr
,
	tUµ”TrŸnguÏr
> 
	tUM©rixTy³
;

132 
usšg
 
	gBa£
::
m_æags
;

133 
usšg
 
	gBa£
::
m_¡©us
;

135 
	gpublic
:

137 
S·r£LU
(
æags
 = 
N©u¿lOrd”šg
)

138 : 
Ba£
(
æags
), 
m_num”ic
(0)

142 
S·r£LU
(cÚ¡ 
M©rixTy³
& 
m©rix
, 
æags
 = 
N©u¿lOrd”šg
)

143 : 
Ba£
(
æags
), 
m_num”ic
(0)

145 
compu‹
(
m©rix
);

148 ~
S·r£LU
()

150 ià(
	gm_num”ic
)

151 
umåack_ä“_num”ic
(&
m_num”ic
,
SÿÏr
());

154 
šlše
 cÚ¡ 
	gLM©rixTy³
& 
m©rixL
() const

156 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

157  
	gm_l
;

160 
šlše
 cÚ¡ 
	gUM©rixTy³
& 
m©rixU
() const

162 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

163  
	gm_u
;

166 
šlše
 cÚ¡ 
	gIÁCŞVeùÜTy³
& 
³rmutiÚP
() const

168 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

169  
	gm_p
;

172 
šlše
 cÚ¡ 
	gIÁRowVeùÜTy³
& 
³rmutiÚQ
() const

174 ià(
	gm_exŒaùedD©aA»Dœty
è
exŒaùD©a
();

175  
	gm_q
;

178 
SÿÏr
 
d‘”mšªt
() const;

180 
	g‹m¶©e
<
ty³Çme
 
	gBD”ived
,y³Çm
	gXD”ived
>

181 
boŞ
 
sŞve
(cÚ¡ 
M©rixBa£
<
BD”ived
> &
b
, M©rixBa£<
XD”ived
>* 
x
) const;

183 
compu‹
(cÚ¡ 
M©rixTy³
& 
m©rix
);

185 
	g´Ùeùed
:

187 
exŒaùD©a
() const;

189 
	g´Ùeùed
:

191 * 
m_num”ic
;

192 cÚ¡ 
M©rixTy³
* 
	gm_m©rixRef
;

193 
mubË
 
LM©rixTy³
 
	gm_l
;

194 
mubË
 
UM©rixTy³
 
	gm_u
;

195 
mubË
 
IÁCŞVeùÜTy³
 
	gm_p
;

196 
mubË
 
IÁRowVeùÜTy³
 
	gm_q
;

197 
mubË
 
boŞ
 
	gm_exŒaùedD©aA»Dœty
;

200 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

201 
	gS·r£LU
<
	gM©rixTy³
,
	gUmfPack
>::
	$compu‹
(cÚ¡ 
M©rixTy³
& 
a
)

203 cÚ¡ 
rows
 = 
a
.
	`rows
();

204 cÚ¡ 
cŞs
 = 
a
.
	`cŞs
();

205 
	`ei_as£¹
((
M©rixTy³
::
FÏgs
&
RowMajÜB™
)==0 && "Row major matrices‡re‚ot supported yet");

207 
m_m©rixRef
 = &
a
;

209 ià(
m_num”ic
)

210 
	`umåack_ä“_num”ic
(&
m_num”ic
,
	`SÿÏr
());

212 * 
symbŞic
;

213 
”rÜCode
 = 0;

214 
”rÜCode
 = 
	`umåack_symbŞic
(
rows
, 
cŞs
, 
a
.
	`_ou‹rIndexPŒ
(),‡.
	`_šÃrIndexPŒ
(),‡.
	`_v®uePŒ
(),

215 &
symbŞic
, 0, 0);

216 ià(
”rÜCode
==0)

217 
”rÜCode
 = 
	`umåack_num”ic
(
a
.
	`_ou‹rIndexPŒ
(),‡.
	`_šÃrIndexPŒ
(),‡.
	`_v®uePŒ
(),

218 
symbŞic
, &
m_num”ic
, 0, 0);

220 
	`umåack_ä“_symbŞic
(&
symbŞic
,
	`SÿÏr
());

222 
m_exŒaùedD©aA»Dœty
 = 
Œue
;

224 
Ba£
::
m_sucûeded
 = (
”rÜCode
==0);

225 
	}
}

227 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

228 
	gS·r£LU
<
	gM©rixTy³
,
	gUmfPack
>::
	$exŒaùD©a
() const

230 ià(
m_exŒaùedD©aA»Dœty
)

233 
Êz
, 
unz
, 
rows
, 
cŞs
, 
nz_udŸg
;

234 
	`umåack_g‘_lunz
(&
Êz
, &
unz
, &
rows
, &
cŞs
, &
nz_udŸg
, 
m_num”ic
, 
	`SÿÏr
());

237 
m_l
.
	`»size
(
rows
,
¡d
::
	`mš
Ôows,
cŞs
));

238 
m_l
.
	`»sizeNÚZ”os
(
Êz
);

240 
m_u
.
	`»size
(
¡d
::
	`mš
(
rows
,
cŞs
),cols);

241 
m_u
.
	`»sizeNÚZ”os
(
unz
);

243 
m_p
.
	`»size
(
rows
);

244 
m_q
.
	`»size
(
cŞs
);

247 
	`umåack_g‘_num”ic
(
m_l
.
	`_ou‹rIndexPŒ
(), m_l.
	`_šÃrIndexPŒ
(), m_l.
	`_v®uePŒ
(),

248 
m_u
.
	`_ou‹rIndexPŒ
(), m_u.
	`_šÃrIndexPŒ
(), m_u.
	`_v®uePŒ
(),

249 
m_p
.
	`d©a
(), 
m_q
.d©a(), 0, 0, 0, 
m_num”ic
);

251 
m_exŒaùedD©aA»Dœty
 = 
çl£
;

253 
	}
}

255 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

256 
ty³Çme
 
	gS·r£LU
<
	gM©rixTy³
,
	gUmfPack
>::
SÿÏr
 
S·r£LU
<
M©rixTy³
,UmfPack>::
	$d‘”mšªt
() const

258 
SÿÏr
 
d‘
;

259 
	`umåack_g‘_d‘”mšªt
(&
d‘
, 0, 
m_num”ic
, 0);

260  
d‘
;

261 
	}
}

263 
	g‹m¶©e
<
ty³Çme
 
	gM©rixTy³
>

264 
	g‹m¶©e
<
ty³Çme
 
	gBD”ived
,ty³Çm
	gXD”ived
>

265 
boŞ
 
	gS·r£LU
<
	gM©rixTy³
,
	gUmfPack
>::
sŞve
(cÚ¡ 
M©rixBa£
<
BD”ived
> &
b
, M©rixBa£<
XD”ived
> *
x
) const

268 cÚ¡ 
	grhsCŞs
 = 
b
.
cŞs
();

270 
ei_as£¹
((
BD”ived
::
FÏgs
&
RowMajÜB™
)==0 && "UmfPack backend does‚ot support‚on col-major„hs yet");

271 
ei_as£¹
((
XD”ived
::
FÏgs
&
RowMajÜB™
)==0 && "UmfPack backend does‚ot support‚on col-major„esult yet");

273 
	g”rÜCode
;

274 
	gj
=0; j<
	grhsCŞs
; ++j)

276 
	g”rÜCode
 = 
umåack_sŞve
(
UMFPACK_A
,

277 
m_m©rixRef
->
_ou‹rIndexPŒ
(), m_m©rixRef->
_šÃrIndexPŒ
(), m_m©rixRef->
_v®uePŒ
(),

278 &
x
->
cŞ
(
j
).
cÛffRef
(0), &
b
.
cÚ¡_ÿ¡_d”ived
().cŞ(j).cÛffRef(0), 
m_num”ic
, 0, 0);

279 ià(
	g”rÜCode
!=0)

280  
çl£
;

286  
	gŒue
;

	@robot/FADBAD++/badiff.h

30 #iâdeà
_BADIFF_H


31 
	#_BADIFF_H


	)

33 
	~"çdbad.h
"

35 
	~<veùÜ
>

36 
	~<¡ack
>

38 
Çme¥aû
 
	gçdbad


41 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

42 şas 
	cD”iv©ives


44 
	gpublic
:

45 şas 
	cRecyşeBš


47 
¡d
::
¡ack
< std::
veùÜ
<
U
>* > 
m_»cyşe
;

48 
RecyşeBš
(const RecycleBin&){ }

49 
	gpublic
:

50 
RecyşeBš
(){}

51 
¡d
::
veùÜ
<
U
>* 
pİRecyşe
(cÚ¡ 
n
)

53 ià(
m_»cyşe
.
em±y
()è 
Ãw
 
¡d
::
veùÜ
<
U
>(
n
);

54 
	g¡d
::
veùÜ
<
U
>* 
–m
=
m_»cyşe
.
tİ
();

55 
	gm_»cyşe
.
pİ
();

56 
USER_ASSERT
(
–m
->
size
()==
n
,"Size mismatch "<<elm->size()<<"!="<<n)

57  
	g–m
;

59 
pushRecyşe
(
¡d
::
veùÜ
<
U
>* 
–m
)

61 
m_»cyşe
.
push
(
–m
);

63 ~
RecyşeBš
()

65 !
	gm_»cyşe
.
em±y
())

67 
d–‘e
 
	gm_»cyşe
.
tİ
();

68 
	gm_»cyşe
.
pİ
();

72 
	g´iv©e
:

73 
¡d
::
veùÜ
<
U
>* 
m_v®ues
;

75 
size
(ècÚ¡ {  (è
	gm_v®ues
->size(); }

77 
	gpublic
:

78 
D”iv©ives
():
m_v®ues
(0){}

80 
»cyşe
(
RecyşeBš
& 
bš
)

82 
USER_ASSERT
(
m_v®ues
!=0,"Nothingo„ecycle")

83 
	gbš
.
pushRecyşe
(
m_v®ues
);

84 
	gm_v®ues
=0;

87 
boŞ
 
haveV®ues
(ècÚ¡ {  
	gm_v®ues
!=0; }

89 
	gU
& 
diff
(
RecyşeBš
& 
bš
, cÚ¡ 
i
, cÚ¡ 
n
)

91 
USER_ASSERT
(
i
<
n
,"Index "<<i<<" out of„ange [0,"<<n<<"]")

92 ià(
	gm_v®ues
==0)

94 
m_v®ues
=
bš
.
pİRecyşe
(
n
);

95 
	gj
=0;j<
	gn
;++jè(*
	gm_v®ues
)[
j
]=
Op
<
U
>::
myZ”o
();

97 
USER_ASSERT
(
m_v®ues
->
size
()==
n
,"Size mismatch "<<m_values->size()<<"!="<<n)

98  (*
	gm_v®ues
)[
i
]=
Op
<
U
>::
myOÃ
();

100 
add
(
RecyşeBš
& 
bš
, cÚ¡ 
D”iv©ives
<
U
>& 
d
)

102 
USER_ASSERT
(
d
.
size
()>0,"Propagating‚ode with‚o derivatives")

103 ià(
	gm_v®ues
==0)

105 
m_v®ues
=
bš
.
pİRecyşe
(
d
.
size
());

106 
	gi
=0;i<
	gm_v®ues
->
size
();++iè(*m_v®ues)[
i
]=(*
d
.
m_v®ues
)[i];

110 
USER_ASSERT
(
m_v®ues
->
size
()==
d
.size(),"Size mismatch "<<m_values->size()<<"!="<<d.size())

111 
	gi
=0;i<
	gm_v®ues
->
size
();++iè
	gOp
<
	gU
>::
myCadd
((*
m_v®ues
)[
i
],(*
d
.m_values)[i]);

114 
sub
(
RecyşeBš
& 
bš
, cÚ¡ 
D”iv©ives
<
U
>& 
d
)

116 
USER_ASSERT
(
d
.
size
()>0,"Propagating‚ode with‚o derivatives")

117 ià(
	gm_v®ues
==0)

119 
m_v®ues
=
bš
.
pİRecyşe
(
d
.
size
());

120 
	gi
=0;i<
	gm_v®ues
->
size
();++iè(*m_v®ues)[
i
]=
Op
<
U
>::
myNeg
((*
d
.
m_v®ues
)[i]);

124 
USER_ASSERT
(
m_v®ues
->
size
()==
d
.size(),"Size mismatch "<<m_values->size()<<"!="<<d.size())

125 
	gi
=0;i<
	gm_v®ues
->
size
();++iè
	gOp
<
	gU
>::
myCsub
((*
m_v®ues
)[
i
],(*
d
.m_values)[i]);

128 
	g‹m¶©e
 <
ty³Çme
 
	gV
>

129 
add
(
RecyşeBš
& 
bš
, cÚ¡ 
V
& 
a
, cÚ¡ 
D”iv©ives
<
U
>& 
d
)

131 
USER_ASSERT
(
d
.
size
()>0,"Propagating‚ode with‚o derivatives")

132 ià(
	gm_v®ues
==0)

134 
m_v®ues
=
bš
.
pİRecyşe
(
d
.
size
());

135 
	gi
=0;i<
	gm_v®ues
->
size
();++iè(*m_v®ues)[
i
]=
a
*(*
d
.
m_v®ues
)[i];

139 
USER_ASSERT
(
m_v®ues
->
size
()==
d
.size(),"Size mismatch "<<m_values->size()<<"!="<<d.size())

140 
	gi
=0;i<
	gm_v®ues
->
size
();++iè
	gOp
<
	gU
>::
myCadd
((*
m_v®ues
)[
i
],
a
*(*
d
.m_values)[i]);

143 
	g‹m¶©e
 <
ty³Çme
 
	gV
>

144 
sub
(
RecyşeBš
& 
bš
, cÚ¡ 
V
& 
a
, cÚ¡ 
D”iv©ives
<
U
>& 
d
)

146 
USER_ASSERT
(
d
.
size
()>0,"Propagating‚ode with‚o derivatives")

147 ià(
	gm_v®ues
==0)

149 
m_v®ues
=
bš
.
pİRecyşe
(
d
.
size
());

150 
	gi
=0;i<
	gm_v®ues
->
size
();++iè(*m_v®ues)[
i
]=
Op
<
U
>::
myNeg
(
a
*(*
d
.
m_v®ues
)[i]);

154 
USER_ASSERT
(
m_v®ues
->
size
()==
d
.size(),"Size mismatch "<<m_values->size()<<"!="<<d.size())

155 
	gi
=0;i<
	gm_v®ues
->
size
();++iè
	gOp
<
	gU
>::
myCsub
((*
m_v®ues
)[
i
],
a
*(*
d
.m_values)[i]);

159 
	gU
& 
	gİ”©Ü
[](cÚ¡ 
	gi
)

161 ià(
	gm_v®ues
!=0)

163 
USER_ASSERT
(
i
<
m_v®ues
->
size
(),"Index "<<i<<" out of bounds [0,"<<m_values->size()<<"]")

164  (*
m_v®ues
)[
i
];

168 
U
 
	gz”o
;

169 
	gz”o
=
Op
<
U
>::
myZ”o
();

170  
	gz”o
;

173 cÚ¡ 
	gU
& 
	gİ”©Ü
[](cÚ¡ 
	gi
) const

175 ià(
	gm_v®ues
!=0)

177 
USER_ASSERT
(
i
<
m_v®ues
->
size
(),"Index "<<i<<" out of bounds [0,"<<m_values->size()<<"]")

178  (*
m_v®ues
)[
i
];

182 
U
 
	gz”o
;

183 
	gz”o
=
Op
<
U
>::
myZ”o
();

184  
	gz”o
;

190 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

191 şas 
	cBTy³NameHV


193 
U
 
	gm_v®
;

194 
mubË
 
	gm_rc
;

196 
	g´Ùeùed
:

197 
mubË
 
D”iv©ives
<
U
> 
m_d”iv©ives
;

198 
	gvœtu®
 ~
BTy³NameHV
(){}

199 
	gpublic
:

200 
BTy³NameHV
():
m_rc
(0),
m_d”iv©ives
(){}

201 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
ex¶ic™
 
BTy³NameHV
(cÚ¡ 
V
& 
v®
):
m_v®
(v®),
m_rc
(0),
m_d”iv©ives
(){}

202 cÚ¡ 
	gU
& 
v®
(ècÚ¡ {  
	gm_v®
; }

203 
	gU
& 
v®
(è{  
	gm_v®
; }

204 
decRef
(
BTy³NameHV
<
U
>*& 
pBTy³NameHV
)

206 
INTERNAL_ASSERT
(
m_rc
>0,"Resource counter‚egative");

207 ià(--
	gm_rc
==0)

209 ià(
m_d”iv©ives
.
haveV®ues
())

211 
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
 
bš
;

212 
´İag©e
(
bš
);

213 
	gm_d”iv©ives
.
»cyşe
(
bš
);

214 
´İag©eChd»n
(
bš
);

216 
d–‘e
 
	gthis
;

218 
	gpBTy³NameHV
=0;

220 
decRef
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
, 
BTy³NameHV
<U>*& 
pBTy³NameHV
)

222 
INTERNAL_ASSERT
(
m_rc
>0,"Resource counter‚egative");

223 ià(--
	gm_rc
==0)

225 ià(
m_d”iv©ives
.
haveV®ues
())

227 
´İag©e
(
bš
);

228 
	gm_d”iv©ives
.
»cyşe
(
bš
);

229 
´İag©eChd»n
(
bš
);

231 
d–‘e
 
	gthis
;

233 
	gpBTy³NameHV
=0;

235 
šcRef
(ècÚ¡ {++
	gm_rc
;}

237 
	gU
& 
diff
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
, cÚ¡ 
idx
, cÚ¡ 
size
)

239  
	gm_d”iv©ives
.
diff
(
bš
,
idx
,
size
);

241 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
&) {}

242 
vœtu®
 
´İag©eChd»n
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
&) {}

243 
add
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
, cÚ¡ D”iv©ives<U>& 
d
è{ 
	gm_d”iv©ives
.add(bin,d); }

244 
sub
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
, cÚ¡ D”iv©ives<U>& 
d
è{ 
	gm_d”iv©ives
.sub(bin,d); }

245 
add
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
, cÚ¡ U& 
a
, cÚ¡ D”iv©ives<U>& 
d
è{ 
	gm_d”iv©ives
.add(bin,a,d); }

246 
sub
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
, cÚ¡ U& 
a
, cÚ¡ D”iv©ives<U>& 
d
è{ 
	gm_d”iv©ives
.sub(bin,a,d); }

247 
	gU
& 
d”iv
(cÚ¡ 
i
)

249 
USER_ASSERT
(
m_rc
==1,"Still‚on-propagated dependencies ("<<m_rc-1<<"),he derivative might be wrong")

250  
	gm_d”iv©ives
[
i
];

254 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

255 şas 
	cBTy³Name


257 
	sSV


259 
mubË
 
	gBTy³NameHV
<
	gU
>* 
	gm_pBTy³NameHV
;

260 
SV
(
BTy³NameHV
<
U
>* 
pBTy³NameHV
):
m_pBTy³NameHV
ÕBTy³NameHV){ m_pBTy³NameHV->
šcRef
(); }

261 
SV
(cÚ¡ 
ty³Çme
 
BTy³Name
<
U
>::SV& 
sv
):
m_pBTy³NameHV
(sv.m_pBTy³NameHV){ m_pBTy³NameHV->
šcRef
(); }

262 ~
SV
(){ 
	gm_pBTy³NameHV
->
decRef
(
m_pBTy³NameHV
); }

263 
	gBTy³NameHV
<
	gU
>* 
g‘BTy³NameHV
(ècÚ¡ {  
	gm_pBTy³NameHV
; }

264 
£tBTy³NameHV
(
BTy³NameHV
<
U
>* 
pBTy³NameHV
)

266 ià(
	gm_pBTy³NameHV
!=
pBTy³NameHV
)

268 
m_pBTy³NameHV
->
decRef
(m_pBTypeNameHV);

269 
	gm_pBTy³NameHV
=
pBTy³NameHV
;

270 
	gm_pBTy³NameHV
->
šcRef
();

273 cÚ¡ 
	gU
& 
v®
(ècÚ¡ {  
	gm_pBTy³NameHV
->val(); }

274 
	gU
& 
v®
(è{  
	gm_pBTy³NameHV
->val(); }

275 cÚ¡ 
	gU
& 
d”iv
(cÚ¡ 
i
ècÚ¡ {  
	gm_pBTy³NameHV
->deriv(i); }

276 
	gU
& 
d”iv
(cÚ¡ 
i
è{  
	gm_pBTy³NameHV
->deriv(i); }

278 
	gU
& 
diff
(cÚ¡ 
idx
, cÚ¡ 
size
)

280 
ty³Çme
 
	gD”iv©ives
<
	gU
>::
RecyşeBš
 
bš
;

281 
	gU
& 
»s
(
m_pBTy³NameHV
->
diff
(
bš
,
idx
,
size
));

282 
	gBTy³NameHV
<
	gU
>* 
	gpHV
=
Ãw
 
BTy³NameHV
<
U
>(
this
->
v®
());

283 
	gm_pBTy³NameHV
->
decRef
(
bš
,
m_pBTy³NameHV
);

284 
	gm_pBTy³NameHV
=
pHV
;

285 
	gm_pBTy³NameHV
->
šcRef
();

286  
	g»s
;

288 } 
	gm_sv
;

289 
	gpublic
:

290 
U
 
	tUnd”lyšgTy³
;

291 
BTy³Name
():
m_sv
(
Ãw
 
BTy³NameHV
<
U
>()){}

292 
BTy³Name
(
BTy³NameHV
<
U
>* 
pBTy³NameHV
):
m_sv
(pBTypeNameHV){}

293 
ex¶ic™
 
BTy³Name
(cÚ¡ 
ty³Çme
 BTy³Name<
U
>::
SV
& 
sv
):
m_sv
(sv){}

294 
‹m¶©e
 <
ty³Çme
 
V
> 
BTy³Name
(cÚ¡ V& 
v®
):
m_sv
(
Ãw
 
BTy³NameHV
<
U
>(val)){}

295 
BTy³Name
<
U
>& 
İ”©Ü
=(cÚ¡ BTy³Name<U>& 
v®
)

297 ià(
this
==&
v®
)  *this;

298 
	gm_sv
.
£tBTy³NameHV
(
v®
.
m_sv
.
g‘BTy³NameHV
());

299  *
	gthis
;

301 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
=(cÚ¡ 
V
& 
v®
è{ 
m_sv
.
£tBTy³NameHV
(
Ãw
 
BTy³NameHV
<
U
>(v®));  *
	gthis
; }

302 
	gBTy³NameHV
<
	gU
>* 
g‘BTy³NameHV
(ècÚ¡ {  
	gm_sv
.getBTypeNameHV(); }

303 
£tBTy³NameHV
(cÚ¡ 
BTy³NameHV
<
U
>* 
pBTy³NameHV
è{ 
	gm_sv
.setBTypeNameHV(pBTypeNameHV); }

304 cÚ¡ 
	gU
& 
v®
(ècÚ¡ {  
	gm_sv
.val(); }

305 
	gU
& 
x
(è{  
	gm_sv
.
v®
(); }

306 cÚ¡ 
	gU
& 
d”iv
(cÚ¡ 
i
ècÚ¡ {  
	gm_sv
.deriv(i); }

307 
	gU
& 
d
(cÚ¡ 
i
è{  
	gm_sv
.
d”iv
(i); }

308 
	gU
& 
diff
(cÚ¡ 
idx
, cÚ¡ 
size
è{  
	gm_sv
.diff(idx,size); }

310 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
+=(cÚ¡ 
BTy³Name
<
U
>& 
v®
);

311 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
-=(cÚ¡ 
BTy³Name
<
U
>& 
v®
);

312 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
*=(cÚ¡ 
BTy³Name
<
U
>& 
v®
);

313 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
/=(cÚ¡ 
BTy³Name
<
U
>& 
v®
);

314 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
+=(cÚ¡ 
V
& 
v®
);

315 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
-=(cÚ¡ 
V
& 
v®
);

316 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
*=(cÚ¡ 
V
& 
v®
);

317 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gBTy³Name
<
	gU
>& 
	gİ”©Ü
/=(cÚ¡ 
V
& 
v®
);

320 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myEq
(v®1.
v®
(),
v®2
.val()); }

321 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myNe
(v®1.
v®
(),
v®2
.val()); }

322 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gBTy³Name
<U>& 
	gv®1
, cÚ¡ BTy³Name<U>& 
	gv®2
è{  
	gOp
<U>::
myLt
(
v®1
.
v®
(),
v®2
.val()); }

323 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myLe
(v®1.
v®
(),
v®2
.val()); }

324 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gBTy³Name
<U>& 
	gv®1
, cÚ¡ BTy³Name<U>& 
	gv®2
è{  
	gOp
<U>::
myGt
(
v®1
.
v®
(),
v®2
.val()); }

325 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myGe
(v®1.
v®
(),
v®2
.val()); }

326 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myEq
(v®1.
v®
(),
v®2
); }

327 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myEq
(v®1,
v®2
.
v®
()); }

328 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myNe
(v®1.
v®
(),
v®2
); }

329 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myNe
(v®1,
v®2
.
v®
()); }

330 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gBTy³Name
<U>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myLt
(
v®1
.
v®
(),
v®2
); }

331 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ V& 
	gv®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myLt
(
v®1
,
v®2
.
v®
()); }

332 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myLe
(v®1.
v®
(),
v®2
); }

333 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myLe
(v®1,
v®2
.
v®
()); }

334 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gBTy³Name
<U>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myGt
(
v®1
.
v®
(),
v®2
); }

335 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ V& 
	gv®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myGt
(
v®1
,
v®2
.
v®
()); }

336 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myGe
(v®1.
v®
(),
v®2
); }

337 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gBTy³Name
<U>& 
	gv®2
è{  
	gOp
<U>::
myGe
(v®1,
v®2
.
v®
()); }

341 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

342 
şass
 
	gBšBTy³NameHV
 : 
public
 
BTy³NameHV
<
U
>

344 
BTy³NameHV
<
U
>* 
m_pOp1
;

345 
	gBTy³NameHV
<
	gU
>* 
	gm_pOp2
;

346 
	gpublic
:

347 
BšBTy³NameHV
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, BTy³NameHV<U>* 
pOp2
):BTy³NameHV<U>(v®),
m_pOp1
ÕOp1),
m_pOp2
(pOp2)

349 
	gm_pOp1
->
šcRef
();

350 
	gm_pOp2
->
šcRef
();

352 
vœtu®
 
´İag©eChd»n
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

354 
m_pOp1
->
decRef
(
bš
,m_pOp1);

355 
	gm_pOp2
->
decRef
(
bš
,
m_pOp2
);

357 
	gvœtu®
 ~
BšBTy³NameHV
()

359 ià(
	gm_pOp1
èm_pOp1->
decRef
(
m_pOp1
);

360 ià(
	gm_pOp2
èm_pOp2->
decRef
(
m_pOp2
);

362 
	gBTy³NameHV
<
	gU
>* 
İ1
(è{  
	gm_pOp1
; }

363 
	gBTy³NameHV
<
	gU
>* 
İ2
(è{  
	gm_pOp2
; }

368 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

369 
şass
 
	gUnBTy³NameHV
 : 
public
 
BTy³NameHV
<
U
>

371 
BTy³NameHV
<
U
>* 
m_pOp
;

372 
	gpublic
:

373 
UnBTy³NameHV
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):BTy³NameHV<U>(v®),
m_pOp
(pOp)

375 
	gm_pOp
->
šcRef
();

377 
vœtu®
 
´İag©eChd»n
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

379 
m_pOp
->
decRef
(
bš
,m_pOp);

381 
	gvœtu®
 ~
UnBTy³NameHV
()

383 ià(
	gm_pOp
èm_pOp->
decRef
(
m_pOp
);

385 
	gBTy³NameHV
<
	gU
>* 
İ
(è{  
	gm_pOp
; }

390 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

391 
	gBTy³NameADD
 : 
public
 
BšBTy³NameHV
<
U
>

393 
BTy³NameADD
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, BTy³NameHV<U>* 
pOp2
):
BšBTy³NameHV
<U>(v®,
	gpOp1
,
	gpOp2
){}

394 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

396 
this
->
İ1
()->
add
(
bš
,this->
m_d”iv©ives
);

397 
	gthis
->
İ2
()->
add
(
bš
,
this
->
m_d”iv©ives
);

399 
	g´iv©e
:

400 
İ”©Ü
=(cÚ¡ 
BTy³NameADD
<
U
>&){}

402 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

403 
	gBTy³NameADD1
 : 
public
 
UnBTy³NameHV
<
U
>

405 cÚ¡ 
V
 
m_a
;

406 
BTy³NameADD1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
BTy³NameHV
<U>* 
pOp2
):
UnBTy³NameHV
<U>(v®,
	gpOp2
),
m_a
(a){}

407 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

409 
this
->
İ
()->
add
(
bš
,this->
m_d”iv©ives
);

411 
	g´iv©e
:

412 
İ”©Ü
=(cÚ¡ 
BTy³NameADD1
<
U
,
	gV
>&){}

414 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

415 
	gBTy³NameADD2
 : 
public
 
UnBTy³NameHV
<
U
>

417 cÚ¡ 
V
 
m_b
;

418 
BTy³NameADD2
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnBTy³NameHV
<U>(v®,
	gpOp1
),
m_b
(b){}

419 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

421 
this
->
İ
()->
add
(
bš
,this->
m_d”iv©ives
);

423 
	g´iv©e
:

424 
İ”©Ü
=(cÚ¡ 
BTy³NameADD2
<
U
,
	gV
>&){}

426 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

427 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
+(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ BTy³Name<U>& 
	gv®2
)

429  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameADD
<U>(
	gv®1
.
v®
()+
	gv®2
.v®(),v®1.
g‘BTy³NameHV
(),val2.getBTypeNameHV())));

461 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

462 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
+(cÚ¡ 
	gV
& 
	ga
, cÚ¡ BTy³Name<U>& 
	gv®2
)

464  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

465 
Ãw
 
	gBTy³NameADD1
<
	gU
,
	gV
>(
	ga
+
	gv®2
.
v®
(),‡, v®2.
g‘BTy³NameHV
())

468 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

469 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
+(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

471  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

472 
Ãw
 
	gBTy³NameADD2
<
	gU
,
	gV
>(
	gv®1
.
v®
()+
	gb
, v®1.
g‘BTy³NameHV
(), b)

478 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

479 
	gBTy³NameSUB
 : 
public
 
BšBTy³NameHV
<
U
>

481 
BTy³NameSUB
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, BTy³NameHV<U>* 
pOp2
):
BšBTy³NameHV
<U>(v®,
	gpOp1
,
	gpOp2
){}

482 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

484 
this
->
İ1
()->
add
(
bš
,this->
m_d”iv©ives
);

485 
	gthis
->
İ2
()->
sub
(
bš
,
this
->
m_d”iv©ives
);

487 
	g´iv©e
:

488 
İ”©Ü
=(cÚ¡ 
BTy³NameSUB
<
U
>&){}

490 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

491 
	gBTy³NameSUB1
 : 
public
 
UnBTy³NameHV
<
U
>

493 cÚ¡ 
V
 
m_a
;

494 
BTy³NameSUB1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
BTy³NameHV
<U>* 
pOp2
):
UnBTy³NameHV
<U>(v®,
	gpOp2
),
m_a
(a){}

495 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

497 
this
->
İ
()->
sub
(
bš
,this->
m_d”iv©ives
);

499 
	g´iv©e
:

500 
İ”©Ü
=(cÚ¡ 
BTy³NameSUB1
<
U
,
	gV
>&){}

502 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

503 
	gBTy³NameSUB2
 : 
public
 
UnBTy³NameHV
<
U
>

505 cÚ¡ 
V
 
m_b
;

506 
BTy³NameSUB2
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnBTy³NameHV
<U>(v®,
	gpOp1
),
m_b
(b){}

507 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

509 
this
->
İ
()->
add
(
bš
,this->
m_d”iv©ives
);

511 
	g´iv©e
:

512 
İ”©Ü
=(cÚ¡ 
BTy³NameSUB2
<
U
,
	gV
>&){}

514 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

515 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
-(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ BTy³Name<U>& 
	gv®2
)

517  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameSUB
<U>(
	gv®1
.
v®
()-
	gv®2
.v®(),v®1.
g‘BTy³NameHV
(),val2.getBTypeNameHV())));

549 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

550 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
-(cÚ¡ 
	gV
& 
	ga
, cÚ¡ BTy³Name<U>& 
	gv®2
)

552  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

553 
Ãw
 
	gBTy³NameSUB1
<
	gU
,
	gV
>(
	ga
-
	gv®2
.
v®
(),‡, v®2.
g‘BTy³NameHV
())

556 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

557 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
-(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

559  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

560 
Ãw
 
	gBTy³NameSUB2
<
	gU
,
	gV
>(
	gv®1
.
v®
()-
	gb
, v®1.
g‘BTy³NameHV
(), b)

566 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

567 
	gBTy³NameMUL
 : 
public
 
BšBTy³NameHV
<
U
>

569 
BTy³NameMUL
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, BTy³NameHV<U>* 
pOp2
):
BšBTy³NameHV
<U>(v®,
	gpOp1
,
	gpOp2
){}

570 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

572 
this
->
İ1
()->
add
(
bš
,this->
İ2
()->
v®
(),this->
m_d”iv©ives
);

573 
	gthis
->
İ2
()->
add
(
bš
,
this
->
İ1
()->
v®
(),this->
m_d”iv©ives
);

575 
	g´iv©e
:

576 
İ”©Ü
=(cÚ¡ 
BTy³NameMUL
<
U
>&){}

578 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

579 
	gBTy³NameMUL1
 : 
public
 
UnBTy³NameHV
<
U
>

581 cÚ¡ 
V
 
m_a
;

582 
BTy³NameMUL1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
BTy³NameHV
<U>* 
pOp2
):
UnBTy³NameHV
<U>(v®,
	gpOp2
),
m_a
(a){}

583 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

585 
this
->
İ
()->
add
(
bš
,
m_a
,this->
m_d”iv©ives
);

587 
	g´iv©e
:

588 
İ”©Ü
=(cÚ¡ 
BTy³NameMUL1
<
U
,
	gV
>&){}

590 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

591 
	gBTy³NameMUL2
 : 
public
 
UnBTy³NameHV
<
U
>

593 cÚ¡ 
V
 
m_b
;

594 
BTy³NameMUL2
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnBTy³NameHV
<U>(v®,
	gpOp1
),
m_b
(b){}

595 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

597 
this
->
İ
()->
add
(
bš
,
m_b
,this->
m_d”iv©ives
);

599 
	g´iv©e
:

600 
İ”©Ü
=(cÚ¡ 
BTy³NameMUL2
<
U
,
	gV
>&){}

602 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

603 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
*(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ BTy³Name<U>& 
	gv®2
)

605  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameMUL
<U>(
	gv®1
.
v®
()*
	gv®2
.v®(),v®1.
g‘BTy³NameHV
(),val2.getBTypeNameHV())));

637 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

638 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
*(cÚ¡ 
	gV
& 
	ga
, cÚ¡ BTy³Name<U>& 
	gv®2
)

640  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

641 
Ãw
 
	gBTy³NameMUL1
<
	gU
,
	gV
>(
a
*
	gv®2
.
v®
(), 
	ga
, v®2.
g‘BTy³NameHV
())

644 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

645 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
*(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

647  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

648 
Ãw
 
	gBTy³NameMUL2
<
	gU
,
	gV
>(
	gv®1
.
v®
()*
	gb
, v®1.
g‘BTy³NameHV
(), b)

654 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

655 
	gBTy³NameDIV
 : 
public
 
BšBTy³NameHV
<
U
>

657 
BTy³NameDIV
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, BTy³NameHV<U>* 
pOp2
):
BšBTy³NameHV
<U>(v®,
	gpOp1
,
	gpOp2
){}

658 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

660 
U
 
tmp
=
Op
<U>::
myInv
(
this
->
İ2
()->
v®
());

661 
	gthis
->
İ1
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

662 
	gthis
->
İ2
()->
sub
(
bš
,
tmp
*
this
->
v®
(),this->
m_d”iv©ives
);

664 
	g´iv©e
:

665 
İ”©Ü
=(cÚ¡ 
BTy³NameDIV
<
U
>&){}

667 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

668 
	gBTy³NameDIV1
 : 
public
 
UnBTy³NameHV
<
U
>

670 cÚ¡ 
V
 
m_a
;

671 
BTy³NameDIV1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
BTy³NameHV
<U>* 
pOp2
):
UnBTy³NameHV
<U>(v®,
	gpOp2
),
m_a
(a){}

672 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

674 
this
->
İ
()->
sub
(
bš
,
Op
<
U
>::
myInv
Ñhis->İ()->
v®
())*this->v®(),this->
m_d”iv©ives
);

676 
	g´iv©e
:

677 
İ”©Ü
=(cÚ¡ 
BTy³NameDIV1
<
U
,
	gV
>&){}

679 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

680 
	gBTy³NameDIV2
 : 
public
 
UnBTy³NameHV
<
U
>

682 cÚ¡ 
V
 
m_b
;

683 
BTy³NameDIV2
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnBTy³NameHV
<U>(v®,
	gpOp1
),
m_b
(b){}

684 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

686 
this
->
İ
()->
add
(
bš
,
Op
<
V
>::
myInv
(
m_b
),this->
m_d”iv©ives
);

688 
	g´iv©e
:

689 
İ”©Ü
=(cÚ¡ 
BTy³NameDIV2
<
U
,
	gV
>&){}

691 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

692 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
/(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ BTy³Name<U>& 
	gv®2
)

694  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

695 
Ãw
 
	gBTy³NameDIV
<
	gU
>(
	gv®1
.
v®
()/
	gv®2
.v®(),v®1.
g‘BTy³NameHV
(),val2.getBTypeNameHV())

728 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

729 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
/(cÚ¡ 
	gV
& 
	ga
, cÚ¡ BTy³Name<U>& 
	gv®2
)

731  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

732 
Ãw
 
	gBTy³NameDIV1
<
	gU
,
	gV
>(
	ga
/
	gv®2
.
v®
(),‡, v®2.
g‘BTy³NameHV
())

735 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

736 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
/(cÚ¡ BTy³Name<U>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

738  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

739 
Ãw
 
	gBTy³NameDIV2
<
	gU
,
	gV
>(
	gv®1
.
v®
()/
	gb
, v®1.
g‘BTy³NameHV
(), b)

745 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
+=(cÚ¡ 
BTy³Name
<
U
>& 
v®
è{  (*
this
)=(*this)+val; }

746 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
-=(cÚ¡ 
BTy³Name
<
U
>& 
v®
è{  (*
this
)=(*this)-val; }

747 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
*=(cÚ¡ 
BTy³Name
<
U
>& 
v®
è{  (*
this
)=(*this)*val; }

748 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
/=(cÚ¡ 
BTy³Name
<
U
>& 
v®
è{  (*
this
)=(*this)/val; }

749 
	g‹m¶©e
 <
ty³Çme
 
	gU
>em¶©<ty³Çm
	gV
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
+=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)+val; }

750 
	g‹m¶©e
 <
ty³Çme
 
	gU
>em¶©<ty³Çm
	gV
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
-=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)-val; }

751 
	g‹m¶©e
 <
ty³Çme
 
	gU
>em¶©<ty³Çm
	gV
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
*=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)*val; }

752 
	g‹m¶©e
 <
ty³Çme
 
	gU
>em¶©<ty³Çm
	gV
> 
	gBTy³Name
<U>& BTy³Name<U>::
İ”©Ü
/=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)/val; }

756 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

757 
	gBTy³NameUMINUS
 : 
public
 
UnBTy³NameHV
<
U
>

759 
BTy³NameUMINUS
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

760 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

762 
this
->
İ
()->
sub
(
bš
,this->
m_d”iv©ives
);

764 
	g´iv©e
:

765 
İ”©Ü
=(cÚ¡ 
BTy³NameUMINUS
<
U
>&){}

768 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

769 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
-(cÚ¡ BTy³Name<U>& 
	gv®
)

771  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameUMINUS
<U>(
	gOp
<U>::
myNeg
(
v®
.v®()),
	gv®
.
g‘BTy³NameHV
())));

776 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

777 
	gBTy³NameUPLUS
 : 
public
 
UnBTy³NameHV
<
U
>

779 
BTy³NameUPLUS
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

780 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

782 
this
->
İ
()->
add
(
bš
,this->
m_d”iv©ives
);

784 
	g´iv©e
:

785 
İ”©Ü
=(cÚ¡ 
BTy³NameUPLUS
<
U
>&){}

788 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

789 
	gBTy³Name
<
	gU
> 
	gİ”©Ü
+(cÚ¡ BTy³Name<U>& 
	gv®
)

791  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameUPLUS
<U>(
	gOp
<U>::
myPos
(
v®
.v®()),
	gv®
.
g‘BTy³NameHV
())));

796 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

797 
	gBTy³NamePOW
 : 
public
 
BšBTy³NameHV
<
U
>

799 
BTy³NamePOW
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, BTy³NameHV<U>* 
pOp2
):
BšBTy³NameHV
<U>(v®,
	gpOp1
,
	gpOp2
){}

800 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

802 
U
 
tmp1
(
this
->
İ2
()->
v®
(è* 
Op
<U>::
myPow
Ñhis->
İ1
()->v®(),this->İ2()->v®()-Op<U>::
myOÃ
()));

803 
U
 
tmp2
(
this
->
v®
(è* 
Op
<U>::
myLog
Ñhis->
İ1
()->val()));

804 
	gthis
->
İ1
()->
add
(
bš
,
tmp1
,
this
->
m_d”iv©ives
);

805 
	gthis
->
İ2
()->
add
(
bš
,
tmp2
,
this
->
m_d”iv©ives
);

807 
	g´iv©e
:

808 
İ”©Ü
=(cÚ¡ 
BTy³NamePOW
<
U
>&){}

810 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

811 
	gBTy³NamePOW1
 : 
public
 
UnBTy³NameHV
<
U
>

813 cÚ¡ 
V
 
m_a
;

814 
BTy³NamePOW1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
BTy³NameHV
<U>* 
pOp2
):
UnBTy³NameHV
<U>(v®,
	gpOp2
),
m_a
(a){}

815 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

817 
U
 
tmp2
(
this
->
v®
(è* 
Op
<
V
>::
myLog
(
m_a
));

818 
	gthis
->
İ
()->
add
(
bš
,
tmp2
,
this
->
m_d”iv©ives
);

820 
	g´iv©e
:

821 
İ”©Ü
=(cÚ¡ 
BTy³NamePOW1
<
U
,
	gV
>&){}

823 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

824 
	gBTy³NamePOW2
 : 
public
 
UnBTy³NameHV
<
U
>

826 cÚ¡ 
V
 
m_b
;

827 
BTy³NamePOW2
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnBTy³NameHV
<U>(v®,
	gpOp1
),
m_b
(b){}

828 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

830 
U
 
tmp1
(
m_b
 * 
Op
<U>::
myPow
(
this
->
İ
()->
v®
(),m_b-Op<
V
>::
myOÃ
()));

831 
	gthis
->
İ
()->
add
(
bš
,
tmp1
,
this
->
m_d”iv©ives
);

833 
	g´iv©e
:

834 
İ”©Ü
=(cÚ¡ 
BTy³NamePOW2
<
U
,
	gV
>&){}

836 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

837 
	gBTy³Name
<
	gU
> 
pow
(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ BTy³Name<U>& 
v®2
)

839  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NamePOW
<U>(
	gOp
<U>::
myPow
(
v®1
.
v®
(),
v®2
.v®()),
	gv®1
.
g‘BTy³NameHV
(),
	gv®2
.getBTypeNameHV())));

871 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

872 
	gBTy³Name
<
	gU
> 
pow
(cÚ¡ 
V
& 
a
, cÚ¡ 
BTy³Name
<
U
>& 
v®2
)

874  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

875 
Ãw
 
	gBTy³NamePOW1
<
	gU
,
	gV
>(
	gOp
<U>::
myPow
(
a
,
v®2
.
v®
()), 
	ga
, 
	gv®2
.
g‘BTy³NameHV
())

878 
	g‹m¶©e
 <
ty³Çme
 
	gU
,y³Çm
	gV
>

879 
	gBTy³Name
<
	gU
> 
pow
(cÚ¡ 
BTy³Name
<
U
>& 
v®1
, cÚ¡ 
V
& 
b
)

881  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(

882 
Ãw
 
	gBTy³NamePOW2
<
	gU
,
	gV
>(
	gOp
<U>::
myPow
(
v®1
.
v®
(),
b
), 
	gv®1
.
g‘BTy³NameHV
(), 
	gb
)

888 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

889 
	gBTy³NameSQR
 : 
public
 
UnBTy³NameHV
<
U
>

891 
BTy³NameSQR
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

892 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

894 
U
 
tmp
(
Op
<U>::
myTwo
(è* 
this
->
İ
()->
v®
());

895 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

897 
	g´iv©e
:

898 
İ”©Ü
=(cÚ¡ 
BTy³NameSQR
<
U
>&){}

900 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

901 
	gBTy³Name
<
	gU
> 
sqr
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

903  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameSQR
<U>(
	gOp
<U>::
mySqr
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

908 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

909 
	gBTy³NameSQRT
 : 
public
 
UnBTy³NameHV
<
U
>

911 
BTy³NameSQRT
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

912 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

914 
U
 
tmp
(
Op
<U>::
myInv
(
this
->
v®
()*Op<U>::
myTwo
()));

915 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

917 
	g´iv©e
:

918 
İ”©Ü
=(cÚ¡ 
BTy³NameSQRT
<
U
>&){}

920 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

921 
	gBTy³Name
<
	gU
> 
sq¹
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

923  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameSQRT
<U>(
	gOp
<U>::
mySq¹
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

928 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

929 
	gBTy³NameEXP
 : 
public
 
UnBTy³NameHV
<
U
>

931 
BTy³NameEXP
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

932 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

934 
this
->
İ
()->
add
(
bš
,this->
v®
(),this->
m_d”iv©ives
);

936 
	g´iv©e
:

937 
İ”©Ü
=(cÚ¡ 
BTy³NameEXP
<
U
>&){}

939 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

940 
	gBTy³Name
<
	gU
> 
exp
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

942  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameEXP
<U>(
	gOp
<U>::
myExp
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

947 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

948 
	gBTy³NameLOG
 : 
public
 
UnBTy³NameHV
<
U
>

950 
BTy³NameLOG
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

951 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

953 
this
->
İ
()->
add
(
bš
,
Op
<
U
>::
myInv
Ñhis->İ()->
v®
()),this->
m_d”iv©ives
);

955 
	g´iv©e
:

956 
İ”©Ü
=(cÚ¡ 
BTy³NameLOG
<
U
>&){}

958 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

959 
	gBTy³Name
<
	gU
> 
log
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

961  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameLOG
<U>(
	gOp
<U>::
myLog
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

966 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

967 
	gBTy³NameSIN
 : 
public
 
UnBTy³NameHV
<
U
>

969 
BTy³NameSIN
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

970 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

972 
U
 
tmp
(
Op
<U>::
myCos
(
this
->
İ
()->
v®
()));

973 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

975 
	g´iv©e
:

976 
İ”©Ü
=(cÚ¡ 
BTy³NameSIN
<
U
>&){}

978 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

979 
	gBTy³Name
<
	gU
> 
sš
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

981  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameSIN
<U>(
	gOp
<U>::
mySš
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

986 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

987 
	gBTy³NameCOS
 : 
public
 
UnBTy³NameHV
<
U
>

989 
BTy³NameCOS
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

990 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

992 
U
 
tmp
(
Op
<U>::
mySš
(
this
->
İ
()->
v®
()));

993 
	gthis
->
İ
()->
sub
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

995 
	g´iv©e
:

996 
İ”©Ü
=(cÚ¡ 
BTy³NameCOS
<
U
>&){}

998 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

999 
	gBTy³Name
<
	gU
> 
cos
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

1001  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameCOS
<U>(
	gOp
<U>::
myCos
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

1006 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1007 
	gBTy³NameTAN
 : 
public
 
UnBTy³NameHV
<
U
>

1009 
BTy³NameTAN
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

1010 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

1012 
U
 
tmp
(
Op
<U>::
mySqr
(
this
->
v®
())+Op<U>::
myOÃ
());

1013 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

1015 
	g´iv©e
:

1016 
İ”©Ü
=(cÚ¡ 
BTy³NameTAN
<
U
>&){}

1018 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1019 
	gBTy³Name
<
	gU
> 
n
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

1021  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameTAN
<U>(
	gOp
<U>::
myTª
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

1026 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1027 
	gBTy³NameASIN
 : 
public
 
UnBTy³NameHV
<
U
>

1029 
BTy³NameASIN
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

1030 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

1032 
U
 
tmp
(
Op
<U>::
myInv
(Op<U>::
mySq¹
(Op<U>::
myOÃ
()-Op<U>::
mySqr
(
this
->
İ
()->
v®
()))));

1033 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

1035 
	g´iv©e
:

1036 
İ”©Ü
=(cÚ¡ 
BTy³NameASIN
<
U
>&){}

1038 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1039 
	gBTy³Name
<
	gU
> 
asš
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

1041  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameASIN
<U>(
	gOp
<U>::
myAsš
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

1046 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1047 
	gBTy³NameACOS
 : 
public
 
UnBTy³NameHV
<
U
>

1049 
BTy³NameACOS
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

1050 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

1052 
U
 
tmp
(
Op
<U>::
myInv
(Op<U>::
mySq¹
(Op<U>::
myOÃ
()-Op<U>::
mySqr
(
this
->
İ
()->
v®
()))));

1053 
	gthis
->
İ
()->
sub
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

1055 
	g´iv©e
:

1056 
İ”©Ü
=(cÚ¡ 
BTy³NameACOS
<
U
>&){}

1058 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1059 
	gBTy³Name
<
	gU
> 
acos
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

1061  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameACOS
<U>(
	gOp
<U>::
myAcos
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

1066 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1067 
	gBTy³NameATAN
 : 
public
 
UnBTy³NameHV
<
U
>

1069 
BTy³NameATAN
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

1070 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

1072 
U
 
tmp
(
Op
<U>::
myInv
(Op<U>::
mySqr
(
this
->
İ
()->
v®
())+Op<U>::
myOÃ
()));

1073 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

1075 
	g´iv©e
:

1076 
İ”©Ü
=(cÚ¡ 
BTy³NameATAN
<
U
>&){}

1078 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

1079 
	gBTy³Name
<
	gU
> 
©ª
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

1081  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameATAN
<U>(
	gOp
<U>::
myAn
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

1084 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gOp
< 
	gBTy³Name
<U> >

1086 
	gBTy³Name
<
	tU
> 
	tT
;

1087 
	gBTy³Name
<
	tU
> 
	tUnd”lyšg
;

1088 
ty³Çme
 
	tOp
<
	tU
>::
	tBa£
 Base;

1089 
Ba£
 
myIÁeg”
(cÚ¡ 
i
) {  Base(i); }

1090 
Ba£
 
myZ”o
(è{  
myIÁeg”
(0); }

1091 
Ba£
 
myOÃ
(è{  
myIÁeg”
(1);}

1092 
Ba£
 
myTwo
(è{  
myIÁeg”
(2); }

1093 
Ba£
 
myPI
(è{  
	gOp
<
	gBa£
>::myPI(); }

1094 
T
 
myPos
(cÚ¡ T& 
x
è{  +
	gx
; }

1095 
T
 
myNeg
(cÚ¡ T& 
x
è{  -
	gx
; }

1096 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCadd
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
+=y; }

1097 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCsub
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
-=y; }

1098 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCmul
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
*=y; }

1099 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCdiv
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
/=y; }

1100 
T
 
myInv
(cÚ¡ T& 
x
è{  
myOÃ
()/
	gx
; }

1101 
T
 
mySqr
(cÚ¡ T& 
x
è{  
	gçdbad
::
sqr
(x); }

1102 
	g‹m¶©e
 <
ty³Çme
 
	gX
,y³Çm
	gY
>

1103 
T
 
myPow
(cÚ¡ 
X
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gçdbad
::
pow
(x,y); }

1104 
T
 
mySq¹
(cÚ¡ T& 
x
è{  
	gçdbad
::
sq¹
(x); }

1105 
T
 
myLog
(cÚ¡ T& 
x
è{  
	gçdbad
::
log
(x); }

1106 
T
 
myExp
(cÚ¡ T& 
x
è{  
	gçdbad
::
exp
(x); }

1107 
T
 
mySš
(cÚ¡ T& 
x
è{  
	gçdbad
::
sš
(x); }

1108 
T
 
myCos
(cÚ¡ T& 
x
è{  
	gçdbad
::
cos
(x); }

1109 
T
 
myTª
(cÚ¡ T& 
x
è{  
	gçdbad
::
n
(x); }

1110 
T
 
myAsš
(cÚ¡ T& 
x
è{  
	gçdbad
::
asš
(x); }

1111 
T
 
myAcos
(cÚ¡ T& 
x
è{  
	gçdbad
::
acos
(x); }

1112 
T
 
myAn
(cÚ¡ T& 
x
è{  
	gçdbad
::
©ª
(x); }

1113 
boŞ
 
myEq
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
==y; }

1114 
boŞ
 
myNe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
!=y; }

1115 
boŞ
 
myLt
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
<
	gy
; }

1116 
boŞ
 
myLe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
<=y; }

1117 
boŞ
 
myGt
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
>
	gy
; }

1118 
boŞ
 
myGe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
>=y; }

	@robot/FADBAD++/examples/ExampleBAD.cpp

1 
	~"badiff.h
"

2 
	~<io¡»am
>

3 
usšg
 
Çme¥aû
 
	g¡d
;

4 
usšg
 
Çme¥aû
 
	gçdbad
;

6 
	gB
<> 
func
(cÚ¡ 
B
<>& 
x
, cÚ¡ B<>& 
y
)

8 
	gB
<> 
	gz
=
sq¹
(
x
);

9  
y
*
	gz
+
sš
(
z
);

12 
	$maš
()

14 
B
<> 
x
,
y
,
f
;

15 
x
=1;

16 
y
=2;

17 
f
=
	`func
(
x
,
y
);

18 
f
.
	`diff
(0,1);

19 
fv®
=
f
.
	`x
();

20 
dfdx
=
x
.
	`d
(0);

21 
dfdy
=
y
.
	`d
(0);

23 
cout
 << "f(x,y)=" << 
fv®
 << 
’dl
;

24 
cout
 << "df/dx(x,y)=" << 
dfdx
 << 
’dl
;

25 
cout
 << "df/dy(x,y)=" << 
dfdy
 << 
’dl
;

28 
	}
}

	@robot/FADBAD++/examples/ExampleBADFAD1.cpp

1 
	~"badiff.h
"

2 
	~"çdiff.h
"

3 
	~<io¡»am
>

4 
usšg
 
Çme¥aû
 
	g¡d
;

5 
usšg
 
Çme¥aû
 
	gçdbad
;

7 
	gB
< 
	gF
<> > 
func
(cÚ¡ 
B
< 
F
<> >& 
x
, cÚ¡ B< F<> >& 
y
)

9 
	gB
< 
	gF
<> > 
	gz
=
sq¹
(
x
);

10  
y
*
	gz
+
sš
(
z
);

13 
	$maš
()

15 
B
< 
F
<> > 
x
,
y
,
f
;

16 
x
=1;

17 
y
=2;

18 
x
.
	`x
().
	`diff
(0,2);

19 
y
.
	`x
().
	`diff
(1,2);

20 
f
=
	`func
(
x
,
y
);

21 
f
.
	`diff
(0,1);

22 
fv®
=
f
.
	`x
().x();

23 
dfdx
=
x
.
	`d
(0).
	`x
();

24 
dfdy
=
y
.
	`d
(0).
	`x
();

25 
dfdxdx
=
x
.
	`d
(0).d(0);

26 
dfdxdy
=
x
.
	`d
(0).d(1);

27 
dfdydx
=
y
.
	`d
(0).d(0);

28 
dfdydy
=
y
.
	`d
(0).d(1);

30 
cout
 << "f(x,y)=" << 
fv®
 << 
’dl
;

31 
cout
 << "df/dx(x,y)=" << 
dfdx
 << 
’dl
;

32 
cout
 << "df/dy(x,y)=" << 
dfdy
 << 
’dl
;

33 
cout
 << "df/dx(x,y)=" << 
dfdxdx
 << 
’dl
;

34 
cout
 << "df/dxdy(x,y)=" << 
dfdxdy
 << 
’dl
;

35 
cout
 << "df/dydx(x,y)=" << 
dfdydx
 << 
’dl
;

36 
cout
 << "df/dy(x,y)=" << 
dfdydy
 << 
’dl
;

39 
	}
}

	@robot/FADBAD++/examples/ExampleBADFAD2.cpp

1 
	~"badiff.h
"

2 
	~"çdiff.h
"

3 
	~<io¡»am
>

4 
usšg
 
Çme¥aû
 
	g¡d
;

5 
usšg
 
Çme¥aû
 
	gçdbad
;

7 
	gB
< 
	gF
<> > 
func
(cÚ¡ 
B
< 
F
<> >& 
x
, cÚ¡ B< F<> >& 
y
)

9 
	gB
< 
	gF
<> > 
	gz
=
sq¹
(
x
);

10  
y
*
	gz
+
sš
(
z
);

13 
	gF
<> 
dfunc
(

14 
F
<>& 
o_dfdx
, F<>& 
o_dfdy
,

15 cÚ¡ 
F
<>& 
i_x
, cÚ¡ F<>& 
i_y
)

17 
	gB
< 
	gF
<> > 
x
(
i_x
),
y
(
i_y
);

18 
	gB
< 
	gF
<> > 
f
(
func
(
x
,
y
));

19 
	gf
.
diff
(0,1);

20 
	go_dfdx
=
x
.
d
(0);

21 
	go_dfdy
=
y
.
d
(0);

22  
	gf
.
x
();

25 
	$ddfunc
(

26 & 
o_dfdxdx
, & 
o_dfdxdy
,

27 & 
o_dfdydx
, & 
o_dfdydy
,

28 & 
o_dfdx
, & 
o_dfdy
,

29 cÚ¡ & 
i_x
, cÚ¡ & 
i_y
)

31 
F
<> 
	`x
(
i_x
),
	`y
(
i_y
),
dfdx
,
dfdy
;

32 
x
.
	`diff
(0,2);

33 
y
.
	`diff
(1,2);

34 
F
<> 
	`f
(
	`dfunc
(
dfdx
,
dfdy
,
x
,
y
));

35 
o_dfdxdx
=
dfdx
.
	`d
(0);

36 
o_dfdxdy
=
dfdx
.
	`d
(1);

37 
o_dfdydx
=
dfdy
.
	`d
(0);

38 
o_dfdydy
=
dfdy
.
	`d
(1);

39 
o_dfdx
=
dfdx
.
	`x
();

40 
o_dfdy
=
dfdy
.
	`x
();

41  
f
.
	`x
();

42 
	}
}

44 
	$maš
()

46 
x
,
y
,
f
,
dfdx
,
dfdy
,

47 
dfdxdx
,
dfdxdy
,

48 
dfdydx
,
dfdydy
;

49 
x
=1;

50 
y
=2;

51 
f
=
	`ddfunc
(
dfdxdx
,
dfdxdy
,

52 
dfdydx
,
dfdydy
,

53 
dfdx
,
dfdy
,
x
,
y
);

55 
cout
 << "f(x,y)=" << 
f
 << 
’dl
;

56 
cout
 << "df/dx(x,y)=" << 
dfdx
 << 
’dl
;

57 
cout
 << "df/dy(x,y)=" << 
dfdy
 << 
’dl
;

58 
cout
 << "df/dx(x,y)=" << 
dfdxdx
 << 
’dl
;

59 
cout
 << "df/dxdy(x,y)=" << 
dfdxdy
 << 
’dl
;

60 
cout
 << "df/dydx(x,y)=" << 
dfdydx
 << 
’dl
;

61 
cout
 << "df/dy(x,y)=" << 
dfdydy
 << 
’dl
;

64 
	}
}

	@robot/FADBAD++/examples/ExampleBADFAD3.cpp

1 
	~"badiff.h
"

2 
	~"çdiff.h
"

3 
	~<io¡»am
>

4 
usšg
 
Çme¥aû
 
	g¡d
;

5 
usšg
 
Çme¥aû
 
	gçdbad
;

7 şas 
	cFunc


9 
	mpublic
:

10 
‹m¶©e
 <
şass
 
T
>

11 
T
 
	$İ”©Ü
()(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
)

13 
T
 
z
=
	`sq¹
(
x
);

14  
y
*
z
+
	`sš
(z);

16 
	}
};

18 şas 
	cDFunc


20 
	mpublic
:

21 
‹m¶©e
 <
şass
 
T
>

22 
T
 
	$İ”©Ü
()(

23 
T
& 
o_dfdx
, T& 
o_dfdy
,

24 cÚ¡ 
T
& 
i_x
, cÚ¡ T& 
i_y
)

26 
B
<
T
> 
	`x
(
i_x
),
	`y
(
i_y
);

27 
Func
 
func
;

28 
B
<
T
> 
	`f
(
	`func
(
x
,
y
));

29 
f
.
	`diff
(0,1);

30 
o_dfdx
=
x
.
	`d
(0);

31 
o_dfdy
=
y
.
	`d
(0);

32  
f
.
	`x
();

34 
	}
};

36 şas 
	cDDFunc


38 
	mpublic
:

39 
‹m¶©e
 <
şass
 
T
>

40 
T
 
	$İ”©Ü
()(

41 
T
& 
o_dfdxdx
, T& 
o_dfdxdy
,

42 
T
& 
o_dfdydx
, T& 
o_dfdydy
,

43 
T
& 
o_dfdx
, T& 
o_dfdy
,

44 cÚ¡ 
T
& 
i_x
, cÚ¡ T& 
i_y
)

46 
F
<
T
> 
	`x
(
i_x
),
	`y
(
i_y
),
dfdx
,
dfdy
;

47 
x
.
	`diff
(0,2);

48 
y
.
	`diff
(1,2);

49 
DFunc
 
dfunc
;

50 
F
<
T
> 
	`f
(
	`dfunc
(
dfdx
,
dfdy
,
x
,
y
));

51 
o_dfdxdx
=
dfdx
.
	`d
(0);

52 
o_dfdxdy
=
dfdx
.
	`d
(1);

53 
o_dfdydx
=
dfdy
.
	`d
(0);

54 
o_dfdydy
=
dfdy
.
	`d
(1);

55 
o_dfdx
=
dfdx
.
	`x
();

56 
o_dfdy
=
dfdy
.
	`x
();

57  
f
.
	`x
();

60 
	}
};

63 
	$maš
()

65 
x
,
y
,
f
,
dfdx
,
dfdy
,

66 
dfdxdx
,
dfdxdy
,

67 
dfdydx
,
dfdydy
;

68 
x
=1;

69 
y
=2;

70 
f
=
	`DDFunc
()(
dfdxdx
,
dfdxdy
,

71 
dfdydx
,
dfdydy
,

72 
dfdx
,
dfdy
,
x
,
y
);

74 
cout
 << "f(x,y)=" << 
f
 << 
’dl
;

75 
cout
 << "df/dx(x,y)=" << 
dfdx
 << 
’dl
;

76 
cout
 << "df/dy(x,y)=" << 
dfdy
 << 
’dl
;

77 
cout
 << "df/dx(x,y)=" << 
dfdxdx
 << 
’dl
;

78 
cout
 << "df/dxdy(x,y)=" << 
dfdxdy
 << 
’dl
;

79 
cout
 << "df/dydx(x,y)=" << 
dfdydx
 << 
’dl
;

80 
cout
 << "df/dy(x,y)=" << 
dfdydy
 << 
’dl
;

83 
	}
}

	@robot/FADBAD++/examples/ExampleBADFAD4.cpp

1 
	~"badiff.h
"

2 
	~"çdiff.h
"

3 
	~<io¡»am
>

4 
usšg
 
Çme¥aû
 
	g¡d
;

5 
usšg
 
Çme¥aû
 
	gçdbad
;

7 şas 
	cFunc


9 
	mpublic
:

10 
‹m¶©e
 <
şass
 
T
>

11 
T
 
	$İ”©Ü
()(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
)

13 
T
 
z
=
	`sq¹
(
x
);

14  
y
*
z
+
	`sš
(z);

16 
	}
};

18 
	g‹m¶©e
 <
şass
 
	gC
>

19 şas 
	cFDiff


21 
	mpublic
:

22 
‹m¶©e
 <
şass
 
T
>

23 
T
 
	$İ”©Ü
()(

24 
T
& 
o_dfdx
, T& 
o_dfdy
,

25 cÚ¡ 
T
& 
i_x
, cÚ¡ T& 
i_y
)

27 
F
<
T
> 
	`x
(
i_x
),
	`y
(
i_y
);

28 
x
.
	`diff
(0,2);

29 
y
.
	`diff
(1,2);

30 
C
 
func
;

31 
F
<
T
> 
	`f
(
	`func
(
x
,
y
));

32 
o_dfdx
=
f
.
	`d
(0);

33 
o_dfdy
=
f
.
	`d
(1);

34  
f
.
	`x
();

36 
	}
};

38 
	g‹m¶©e
 <
şass
 
	gC
>

39 şas 
	cBDiff


41 
	mpublic
:

42 
‹m¶©e
 <
şass
 
T
>

43 
T
 
	$İ”©Ü
()(

44 
T
& 
o_dfdx
, T& 
o_dfdy
,

45 cÚ¡ 
T
& 
i_x
, cÚ¡ T& 
i_y
)

47 
B
<
T
> 
	`x
(
i_x
),
	`y
(
i_y
);

48 
C
 
func
;

49 
B
<
T
> 
	`f
(
	`func
(
x
,
y
));

50 
f
.
	`diff
(0,1);

51 
o_dfdx
=
x
.
	`d
(0);

52 
o_dfdy
=
y
.
	`d
(0);

53  
f
.
	`x
();

55 
	}
};

57 
	$maš
()

59 
x
,
y
,
f
,
dfdx
,
dfdy
;

60 
x
=1;

61 
y
=2;

62 
FDiff
<
Func
> 
FFunc
;

63 
f
=
	`FFunc
(
dfdx
,
dfdy
,
x
,
y
);

65 
cout
 << "f(x,y)=" << 
f
 << 
’dl
;

66 
cout
 << "df/dx(x,y)=" << 
dfdx
 << 
’dl
;

67 
cout
 << "df/dy(x,y)=" << 
dfdy
 << 
’dl
;

69 
BDiff
<
Func
> 
BFunc
;

70 
f
=
	`BFunc
(
dfdx
,
dfdy
,
x
,
y
);

72 
cout
 << "f(x,y)=" << 
f
 << 
’dl
;

73 
cout
 << "df/dx(x,y)=" << 
dfdx
 << 
’dl
;

74 
cout
 << "df/dy(x,y)=" << 
dfdy
 << 
’dl
;

77 
	}
}

	@robot/FADBAD++/examples/ExampleFAD.cpp

1 
	~"çdiff.h
"

2 
	~<io¡»am
>

3 
usšg
 
Çme¥aû
 
	g¡d
;

4 
usšg
 
Çme¥aû
 
	gçdbad
;

6 
	gF
<> 
func
(cÚ¡ 
F
<>& 
x
, cÚ¡ F<>& 
y
)

8 
	gF
<> 
	gz
=
sq¹
(
x
);

9  
y
*
	gz
+
sš
(
z
);

12 
	$maš
()

14 
F
<> 
x
,
y
,
f
;

15 
x
=1;

16 
x
.
	`diff
(0,2);

17 
y
=2;

18 
y
.
	`diff
(1,2);

19 
f
=
	`func
(
x
,
y
);

20 
fv®
=
f
.
	`x
();

21 
dfdx
=
f
.
	`d
(0);

22 
dfdy
=
f
.
	`d
(1);

24 
cout
 << "f(x,y)=" << 
fv®
 << 
’dl
;

25 
cout
 << "df/dx(x,y)=" << 
dfdx
 << 
’dl
;

26 
cout
 << "df/dy(x,y)=" << 
dfdy
 << 
’dl
;

29 
	}
}

	@robot/FADBAD++/examples/ExampleTAD1.cpp

1 
	~"diff.h
"

2 
	~<io¡»am
>

3 
usšg
 
Çme¥aû
 
	g¡d
;

4 
usšg
 
Çme¥aû
 
	gçdbad
;

6 
	gT
<> 
func
(cÚ¡ 
T
<>& 
x
, cÚ¡ T<>& 
y
)

8 
	gT
<> 
	gz
=
sq¹
(
x
);

9  
y
*
	gz
+
sš
(
z
);

12 
	$maš
()

14 
T
<> 
x
,
y
,
f
;

15 
x
=1;

16 
y
=2;

17 
x
[1]=1;

18 
f
=
	`func
(
x
,
y
);

19 
fv®
=
f
[0];

20 
f
.
	`ev®
(10);

22 
cout
 << "f(x,y)=" << 
fv®
 << 
’dl
;

23 
i
=0;i<=10;i++)

25 
c
=
f
[
i
];

26 
cout
 << "(1/k!)*(d^"<<
i
<<"f/dx^" << i << ")=" << 
c
 << 
’dl
;

29 
f
.
	`»£t
();

30 
x
[0]=3;

31 
y
[0]=4;

32 
y
[1]=1;

33 
f
.
	`ev®
(10);

35 
i
=0;i<=10;i++)

37 
c
=
f
[
i
];

38 
cout
 << "(1/k!)*(d^"<<
i
<<"f/dy^" << i << ")=" << 
c
 << 
’dl
;

42 
	}
}

	@robot/FADBAD++/examples/ExampleTAD2.cpp

1 
	~"diff.h
"

2 
	~<io¡»am
>

3 
usšg
 
Çme¥aû
 
	g¡d
;

4 
usšg
 
Çme¥aû
 
	gçdbad
;

6 şas 
	cTODE


8 
	mpublic
:

9 
T
<> 
x
;

10 
	mT
<> 
	mxp
;

11 
	$TODE
(){
xp
=
	`cos
(
x
);}

12 
	}
};

14 
	$maš
()

16 
TODE
 
ode
;

17 
ode
.
x
[0]=1;

18 
i
=0;i<10;i++)

20 
ode
.
xp
.
	`ev®
(
i
);

21 
ode
.
x
[
i
+1]=ode.
xp
[i]/(i+1);

28 
i
=0;i<=10;i++)

30 
cout
 << "x[" << 
i
 << "]=" << 
ode
.
x
[i] << 
’dl
;

34 
	}
}

	@robot/FADBAD++/examples/ExampleTAD3.cpp

1 
	~"diff.h
"

2 
	~<io¡»am
>

3 
usšg
 
Çme¥aû
 
	g¡d
;

4 
usšg
 
Çme¥aû
 
	gçdbad
;

6 
s
(10), 
r
(28), 
q
(8/3);

8 şas 
	cLÜ’z


10 
	mpublic
:

11 
T
<> 
x
,
	my
,
	mz
,
	mp
;

12 
	mT
<> 
	mxp
,
	myp
,
	mzp
,
	mµ
;

13 
	$LÜ’z
()

16 
xp
 = 
p
*(
s
*(
y
-
x
));

17 
yp
 = 
p
*(
x
*(
r
-
z
)-
y
);

18 
zp
 = 
p
*(
x
*
y
-
q
*
z
);

19 
µ
 = (0);

21 
	$»£t
()

23 
xp
.
	`»£t
();

24 
yp
.
	`»£t
();

25 
zp
.
	`»£t
();

26 
µ
.
	`»£t
();

27 
	}
}

30 
	$maš
()

33 
LÜ’z
 
ode
;

36 
ode
.
x
[0]=2.14736765;

37 
ode
.
y
[0]=-2.07804819;

38 
ode
.
z
[0]=
r
-1;

39 
ode
.
p
[0]=1.55865218;

41 
i
,
j
;

42 
i
=0;i<10;i++)

46 
ode
.
xp
.
	`ev®
(
i
);

47 
ode
.
yp
.
	`ev®
(
i
);

48 
ode
.
zp
.
	`ev®
(
i
);

49 
ode
.
zp
.
	`ev®
(
i
);

52 
ode
.
x
[
i
+1]=ode.
xp
[i]/(i+1);

53 
ode
.
y
[
i
+1]=ode.
yp
[i]/(i+1);

54 
ode
.
z
[
i
+1]=ode.
zp
[i]/(i+1);

55 
ode
.
p
[
i
+1]=ode.
µ
[i]/(i+1);

60 
i
=0;i<=10;i++)

62 
cout
 << "x[" << 
i
 << "]=" << 
ode
.
x
[i] << 
’dl
;

63 
cout
 << "y[" << 
i
 << "]=" << 
ode
.
y
[i] << 
’dl
;

64 
cout
 << "z[" << 
i
 << "]=" << 
ode
.
z
[i] << 
’dl
;

65 
cout
 << "p[" << 
i
 << "]=" << 
ode
.
p
[i] << 
’dl
;

69 
	}
}

	@robot/FADBAD++/examples/MonteCarlo.cpp

5 
	~<c¡dlib
>

6 
	~<cm©h
>

8 
	~"badiff.h
"

9 
	~"çdiff.h
"

10 
	~<io¡»am
>

12 
usšg
 
Çme¥aû
 
	g¡d
;

13 
usšg
 
Çme¥aû
 
	gçdbad
;

15 
	$G‘OÃGaussŸnBySumm©iÚ
()

17 
»suÉ
=0;

18 
j
=0; j < 12; j++)

19 
»suÉ
 +ğ
	`¿nd
()/
¡©ic_ÿ¡
<>(
RAND_MAX
);

20 
»suÉ
 -= 6.0;

21  
»suÉ
;

22 
	}
}

24 
	$G‘OÃGaussŸnByBoxMuÎ”
()

26 
»suÉ
;

27 
x
;

28 
y
;

29 
sizeSqu¬ed
;

32 
x
 = 2.0*
	`¿nd
()/
¡©ic_ÿ¡
<>(
RAND_MAX
)-1;

33 
y
 = 2.0*
	`¿nd
()/
¡©ic_ÿ¡
<>(
RAND_MAX
)-1;

34 
sizeSqu¬ed
 = 
x
*x + 
y
*y;

36  
sizeSqu¬ed
 >= 1.0);

37 
»suÉ
 = 
x
*
	`sq¹
(-2*
	`log
(
sizeSqu¬ed
)/sizeSquared);

38  
»suÉ
;

39 
	}
}

41 
	g‹m¶©e
 <
ty³Çme
 
	gAr™hT
>

42 
Ar™hT
 
	$Sim¶eMÚ‹C¬lo
(cÚ¡ 
Expœy
,

43 cÚ¡ 
SŒike
,

44 cÚ¡ 
Ar™hT
& 
SpÙ
,

45 cÚ¡ 
Ar™hT
& 
VŞ
,

46 cÚ¡ 
Ar™hT
& 
r
,

47 
Numb”OfP©hs
)

49 
Ar™hT
 
v¬Ÿnû
 = 
VŞ
*VŞ*
Expœy
;

50 
Ar™hT
 
roÙV¬Ÿnû
 = 
	`sq¹
(
v¬Ÿnû
);

51 
Ar™hT
 
™oCÜ»ùiÚ
 = -0.5*
v¬Ÿnû
;

52 
Ar™hT
 
movedSpÙ
 = 
SpÙ
*
	`exp
(
r
*
Expœy
 +
™oCÜ»ùiÚ
);

53 
Ar™hT
 
thisSpÙ
;

54 
Ar™hT
 
ruÂšgSum
=0;

55 
i
=0; i < 
Numb”OfP©hs
; i++)

57 
Ar™hT
 
thisGaussŸn
 = 
	`G‘OÃGaussŸnByBoxMuÎ”
();

58 
thisSpÙ
 = 
movedSpÙ
*
	`exp
Ğ
roÙV¬Ÿnû
*
thisGaussŸn
);

59 
Ar™hT
 
thisPayoff
 = 
thisSpÙ
 - 
SŒike
;

60 
thisPayoff
 =hisPayoff >0 ?hisPayoff : 0;

61 
ruÂšgSum
 +ğ
thisPayoff
;

63 
Ar™hT
 
m—n
 = 
ruÂšgSum
 / (
Numb”OfP©hs
);

64 
m—n
 *ğ
	`exp
(-
r
*
Expœy
);

65  
m—n
;

66 
	}
}

68 
	g‹m¶©e
 <
ty³Çme
 
	gAr™hT
>

69 
	$BADSim¶eMÚ‹C¬lo
(cÚ¡ 
Expœy
,

70 cÚ¡ 
SŒike
,

71 cÚ¡ 
Ar™hT
& 
SpÙ
,

72 cÚ¡ 
Ar™hT
& 
VŞ
,

73 cÚ¡ 
Ar™hT
& 
r
,

74 
Numb”OfP©hs
,

75 
Ar™hT
& 
Priû
,

76 
Ar™hT
& 
dPriûSpÙ
,

77 
Ar™hT
& 
dPriûVŞ
,

78 
Ar™hT
& 
dPriûR
)

80 
B
< 
Ar™hT
 > 
	`BSpÙ
(
SpÙ
);

81 
B
< 
Ar™hT
 > 
	`BVŞ
(
VŞ
);

82 
B
< 
Ar™hT
 > 
	`Br
(
r
);

83 
B
< 
Ar™hT
 > 
BPriû
=
	`Sim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
BSpÙ
,
BVŞ
,
Br
,
Numb”OfP©hs
);

84 
BPriû
.
	`diff
(0,1);

85 
Priû
=
BPriû
.
	`x
();

86 
dPriûSpÙ
=
BSpÙ
.
	`d
(0);

87 
dPriûVŞ
=
BVŞ
.
	`d
(0);

88 
dPriûR
=
Br
.
	`d
(0);

89 
	}
}

91 
	g‹m¶©e
 <
ty³Çme
 
	gAr™hT
>

92 
	$FADSim¶eMÚ‹C¬lo
(cÚ¡ 
Expœy
,

93 cÚ¡ 
SŒike
,

94 cÚ¡ 
Ar™hT
& 
SpÙ
,

95 cÚ¡ 
Ar™hT
& 
VŞ
,

96 cÚ¡ 
Ar™hT
& 
r
,

97 
Numb”OfP©hs
,

98 
Ar™hT
& 
Priû
,

99 
Ar™hT
& 
dPriûSpÙ
,

100 
Ar™hT
& 
dPriûVŞ
,

101 
Ar™hT
& 
dPriûR
)

103 
F
< 
Ar™hT
 > 
	`FSpÙ
(
SpÙ
);

104 
F
< 
Ar™hT
 > 
	`FVŞ
(
VŞ
);

105 
F
< 
Ar™hT
 > 
	`Fr
(
r
);

106 
FSpÙ
.
	`diff
(0,3);

107 
FVŞ
.
	`diff
(1,3);

108 
Fr
.
	`diff
(2,3);

109 
F
< 
Ar™hT
 > 
FPriû
=
	`Sim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
FSpÙ
,
FVŞ
,
Fr
,
Numb”OfP©hs
);

110 
Priû
=
FPriû
.
	`x
();

111 
dPriûSpÙ
=
FPriû
.
	`d
(0);

112 
dPriûVŞ
=
FPriû
.
	`d
(1);

113 
dPriûR
=
FPriû
.
	`d
(2);

114 
	}
}

116 
	g‹m¶©e
 <
ty³Çme
 
	gAr™hT
>

117 
	$FADFADSim¶eMÚ‹C¬lo
(cÚ¡ 
Expœy
,

118 cÚ¡ 
SŒike
,

119 cÚ¡ 
Ar™hT
& 
SpÙ
,

120 cÚ¡ 
Ar™hT
& 
VŞ
,

121 cÚ¡ 
Ar™hT
& 
r
,

122 
Numb”OfP©hs
,

123 
Ar™hT
& 
Priû
,

124 
Ar™hT
& 
dPriûSpÙ
,

125 
Ar™hT
& 
dPriûVŞ
,

126 
Ar™hT
& 
dPriûR
,

127 
Ar™hT
& 
dPriû2SpÙ
)

129 
F
< 
Ar™hT
 > 
	`FSpÙ
(
SpÙ
);

130 
F
< 
Ar™hT
 > 
	`FVŞ
(
VŞ
);

131 
F
< 
Ar™hT
 > 
	`Fr
(
r
);

132 
FSpÙ
.
	`diff
(0,1);

133 
F
< 
Ar™hT
 > 
FPriû
;

134 
F
< 
Ar™hT
 > 
FdPriûSpÙ
;

135 
F
< 
Ar™hT
 > 
FdPriûVŞ
;

136 
F
< 
Ar™hT
 > 
FdPriûR
;

137 
	`FADSim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
FSpÙ
,
FVŞ
,
Fr
,
Numb”OfP©hs
,

138 
FPriû
, 
FdPriûSpÙ
, 
FdPriûVŞ
, 
FdPriûR
);

139 
Priû
=
FPriû
.
	`x
();

140 
dPriûSpÙ
=
FdPriûSpÙ
.
	`x
();

141 
dPriûVŞ
=
FdPriûVŞ
.
	`x
();

142 
dPriûR
=
FdPriûR
.
	`x
();

143 
dPriû2SpÙ
=
FdPriûSpÙ
.
	`d
(0);

144 
	}
}

146 
	g‹m¶©e
 <
ty³Çme
 
	gAr™hT
>

147 
	$FADBADSim¶eMÚ‹C¬lo
(cÚ¡ 
Expœy
,

148 cÚ¡ 
SŒike
,

149 cÚ¡ 
Ar™hT
& 
SpÙ
,

150 cÚ¡ 
Ar™hT
& 
VŞ
,

151 cÚ¡ 
Ar™hT
& 
r
,

152 
Numb”OfP©hs
,

153 
Ar™hT
& 
Priû
,

154 
Ar™hT
& 
dPriûSpÙ
,

155 
Ar™hT
& 
dPriûVŞ
,

156 
Ar™hT
& 
dPriûR
,

157 
Ar™hT
& 
dPriû2SpÙ
)

159 
F
< 
Ar™hT
 > 
	`FSpÙ
(
SpÙ
);

160 
F
< 
Ar™hT
 > 
	`FVŞ
(
VŞ
);

161 
F
< 
Ar™hT
 > 
	`Fr
(
r
);

162 
FSpÙ
.
	`diff
(0,1);

163 
F
< 
Ar™hT
 > 
FPriû
;

164 
F
< 
Ar™hT
 > 
FdPriûSpÙ
;

165 
F
< 
Ar™hT
 > 
FdPriûVŞ
;

166 
F
< 
Ar™hT
 > 
FdPriûR
;

167 
	`BADSim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
FSpÙ
,
FVŞ
,
Fr
,
Numb”OfP©hs
,

168 
FPriû
, 
FdPriûSpÙ
, 
FdPriûVŞ
, 
FdPriûR
);

169 
Priû
=
FPriû
.
	`x
();

170 
dPriûSpÙ
=
FdPriûSpÙ
.
	`x
();

171 
dPriûVŞ
=
FdPriûVŞ
.
	`x
();

172 
dPriûR
=
FdPriûR
.
	`x
();

173 
dPriû2SpÙ
=
FdPriûSpÙ
.
	`d
(0);

174 
	}
}

177 
	$maš
()

179 
SŒike
=1.3000;

180 
Expœy
=1.0;

181 
SpÙ
=1.3000;

182 
VŞ
=.08;

183 
r
=0.06;

184 
Priû
;

185 
dPriûSpÙ
;

186 
dPriûVŞ
;

187 
dPriûR
;

188 
dPriû2SpÙ
;

190 
	`¤ªd
(0);

192 
	`FADSim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
SpÙ
,
VŞ
,
r
,1000,

193 
Priû
,
dPriûSpÙ
,
dPriûVŞ
,
dPriûR
);

195 
cout
 << "Priû=" << 
Priû
 << 
’dl
;

196 
cout
 << "dPriûSpÙ=" << 
dPriûSpÙ
 << 
’dl
;

197 
cout
 << "dPriûVŞ=" << 
dPriûVŞ
 << 
’dl
;

198 
cout
 << "dPriûR=" << 
dPriûR
 << 
’dl
;

200 
	`¤ªd
(0);

202 
	`BADSim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
SpÙ
,
VŞ
,
r
,1000,

203 
Priû
,
dPriûSpÙ
,
dPriûVŞ
,
dPriûR
);

205 
cout
 << "Priû=" << 
Priû
 << 
’dl
;

206 
cout
 << "dPriûSpÙ=" << 
dPriûSpÙ
 << 
’dl
;

207 
cout
 << "dPriûVŞ=" << 
dPriûVŞ
 << 
’dl
;

208 
cout
 << "dPriûR=" << 
dPriûR
 << 
’dl
;

210 
	`¤ªd
(0);

216 
	`FADFADSim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
SpÙ
,
VŞ
,
r
,1000,

217 
Priû
,
dPriûSpÙ
,
dPriûVŞ
,
dPriûR
,
dPriû2SpÙ
);

219 
cout
 << "Priû=" << 
Priû
 << 
’dl
;

220 
cout
 << "dPriûSpÙ=" << 
dPriûSpÙ
 << 
’dl
;

221 
cout
 << "dPriûVŞ=" << 
dPriûVŞ
 << 
’dl
;

222 
cout
 << "dPriûR=" << 
dPriûR
 << 
’dl
;

223 
cout
 << "dPriû2SpÙ=" << 
dPriû2SpÙ
 << 
’dl
;

225 
	`¤ªd
(0);

227 
	`FADFADSim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
SpÙ
,
VŞ
,
r
,1000,

228 
Priû
,
dPriûSpÙ
,
dPriûVŞ
,
dPriûR
,
dPriû2SpÙ
);

230 
cout
 << "Priû=" << 
Priû
 << 
’dl
;

231 
cout
 << "dPriûSpÙ=" << 
dPriûSpÙ
 << 
’dl
;

232 
cout
 << "dPriûVŞ=" << 
dPriûVŞ
 << 
’dl
;

233 
cout
 << "dPriûR=" << 
dPriûR
 << 
’dl
;

234 
cout
 << "dPriû2SpÙ=" << 
dPriû2SpÙ
 << 
’dl
;

236 
	`¤ªd
(0);

238 
	`FADBADSim¶eMÚ‹C¬lo
(
Expœy
,
SŒike
,
SpÙ
,
VŞ
,
r
,1000,

239 
Priû
,
dPriûSpÙ
,
dPriûVŞ
,
dPriûR
,
dPriû2SpÙ
);

241 
cout
 << "Priû=" << 
Priû
 << 
’dl
;

242 
cout
 << "dPriûSpÙ=" << 
dPriûSpÙ
 << 
’dl
;

243 
cout
 << "dPriûVŞ=" << 
dPriûVŞ
 << 
’dl
;

244 
cout
 << "dPriûR=" << 
dPriûR
 << 
’dl
;

245 
cout
 << "dPriû2SpÙ=" << 
dPriû2SpÙ
 << 
’dl
;

248 
	}
}

	@robot/FADBAD++/extra/atan2ad.h

32 
	~"çdiff.h
"

34 
Çme¥aû
 
	gçdbad


36 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
	sATª2Op


38 
	g‹m¶©e
 <
ty³Çme
 
	gX
,y³Çm
	gY
>

39 
T
 
©ª2
(cÚ¡ 
X
& 
x
, cÚ¡ 
Y
& 
y
) {  ::atan2(x,y); }

43 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

44 
šlše
 
	gFTy³Name
<
	gT
,
	gN
> 
©ª2
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
y
, cÚ¡ FTy³Name<T,N>& 
x
)

46 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
ATª2Op
<
T
>::
©ª2
(
y
.
v®
(),
x
.val()));

47 ià(!
	gy
.
d•’d
(è&& !
	gx
.d•’d()è 
	gc
;

49 
T
 
tmp
(
Op
<T>::
mySqr
(
y
.
v®
())+Op<T>::mySqr(
x
.val()));

50 
	gc
.
£tD•’d
(
y
,
x
);

51 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=(
x
.
v®
()*
y
[i]-y.v®()*x[i])/
tmp
;

52  
	gc
;

58 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
	gATª2Op
< 
	gFTy³Name
<U,N> >

60 
	gFTy³Name
<
	tU
,
	tN
> 
	tT
;

61 
	g‹m¶©e
 <
ty³Çme
 
	gX
,y³Çm
	gY
>

62 
T
 
©ª2
(cÚ¡ 
X
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gçdbad
::atan2(x,y); }

	@robot/FADBAD++/extra/ndf.h

33 #iâdeà
_NDF_H


34 
	#_NDF_H


	)

36 
	~<lim™s
>

38 
Çme¥aû
 
	gçdbad


42 
	g‹m¶©e
 <
şass
 
	gT
>

43 
šlše
 
T
 
nd
(cÚ¡ T& 
x
)

45 cÚ¡ 
	gsq¹2pi
=
Op
<>::
mySq¹
(Op<>::
myTwo
()*Op<>::
myPI
());

46  
	gOp
<
	gT
>::
myExp
(-0.5*
Op
<
T
>::
mySqr
(
x
))/
sq¹2pi
;

53 
šlše
 
úd
(cÚ¡ 
x
)

57 cÚ¡ 
	gCNDMAX
=37;

59 
	gúÜm
;

60 
	gxabs
=
çbs
(
x
);

61 ià(
	gxabs
>
	gCNDMAX
)

63 
	gúÜm
=0.0;

67 
	gbud
;

68 
	ge
=
Op
<>::
myExp
(-0.5*Op<>::
mySqr
(
xabs
));

69 ià(
	gxabs
<7.07106781186547)

71 
	gbud
 = 3.52624965998911E-02 * 
xabs
 + 0.700383064443688;

72 
	gbud
 = 
bud
 * 
xabs
 + 6.37396220353165;

73 
	gbud
 = 
bud
 * 
xabs
 + 33.912866078383;

74 
	gbud
 = 
bud
 * 
xabs
 + 112.079291497871;

75 
	gbud
 = 
bud
 * 
xabs
 + 221.213596169931;

76 
	gbud
 = 
bud
 * 
xabs
 + 220.206867912376;

77 
	gúÜm
 = 
e
 * 
bud
;

78 
	gbud
 = 8.83883476483184E-02 * 
xabs
 + 1.75566716318264;

79 
	gbud
 = 
bud
 * 
xabs
 + 16.064177579207;

80 
	gbud
 = 
bud
 * 
xabs
 + 86.7807322029461;

81 
	gbud
 = 
bud
 * 
xabs
 + 296.564248779674;

82 
	gbud
 = 
bud
 * 
xabs
 + 637.333633378831;

83 
	gbud
 = 
bud
 * 
xabs
 + 793.826512519948;

84 
	gbud
 = 
bud
 * 
xabs
 + 440.413735824752;

85 
	gúÜm
 /ğ
bud
;

89 
	gbud
 = 
xabs
 + 0.65;

90 
	gbud
 = 
xabs
 + 4.0 / 
bud
;

91 
	gbud
 = 
xabs
 + 3.0 / 
bud
;

92 
	gbud
 = 
xabs
 + 2.0 / 
bud
;

93 
	gbud
 = 
xabs
 + 1.0 / 
bud
;

94 
	gúÜm
 = 
e
 / 
bud
 / 2.506628274631;

97 ià(
	gx
>0è
	gúÜm
=1-
úÜm
;

98  
	gúÜm
;

104 
šlše
 
iúd
(cÚ¡ 
p
)

106 cÚ¡ 
	ga
[6] =

112 cÚ¡ 
	gb
[5] =

118 cÚ¡ 
	gc
[6] =

124 cÚ¡ 
	gd
[4] =

129 cÚ¡ 
	gsq¹2pi
=
Op
<>::
mySq¹
(Op<>::
myTwo
()*Op<>::
myPI
());

131 
	gq
, 
	gt
, 
	gu
;

133 ià(
	gp
 > 1.0 ||… < 0.0)

134  
	g¡d
::
num”ic_lim™s
<>::
qu›t_NaN
();

135 ià(
	gp
 == 0.0)

136  -
¡d
::
num”ic_lim™s
<>::
šfš™y
();

137 ià(
	gp
 == 1.0)

138  
¡d
::
num”ic_lim™s
<>::
šfš™y
();

139 
	gq
 = 
p
<.5?p:1-p;

140 ià(
	gq
 > 0.02425)

143 
	gu
 = 
q
-0.5;

144 
	gt
 = 
u
*u;

145 
	gu
 = 
u
*(((((
a
[0]*
t
+a[1])*t+a[2])*t+a[3])*t+a[4])*t+a[5])

146 /(((((
b
[0]*
t
+b[1])*t+b[2])*t+b[3])*t+b[4])*t+1);

151 
	gt
 = 
Op
<>::
mySq¹
(Op<>::
myNeg
(Op<>::
myTwo
()*Op<>::
myLog
(
q
)));

152 
	gu
 = (((((
c
[0]*
t
+c[1])*t+c[2])*t+c[3])*t+c[4])*t+c[5])

153 /((((
d
[0]*
t
+d[1])*t+d[2])*t+d[3])*t+1);

158 
	gt
 = 
úd
(
u
)-
q
;

159 
	gt
 = 
t
*
sq¹2pi
*
Op
<>::
myExp
(Op<>::
mySqr
(
u
)/Op<>::
myTwo
());

160 
	gu
 = 
u
-
t
/(1.0+u*t/
Op
<>::
myTwo
());

162  (
	gp
 > 0.5 ? -
	gu
 : 
u
);

	@robot/FADBAD++/extra/ndfad.h

33 #iâdeà
_NDFAD_H


34 
	#_NDFAD_H


	)

36 
	~"ndf.h
"

37 
	~"çdbad.h
"

39 
Çme¥aû
 
	gçdbad


42 #ifdeà
_FADIFF_H


44 
	g‹m¶©e
 <
şass
 
	gT
, 
	gN
>

45 
INLINE2
 
	gF
<
	gT
,
	gN
> 
nd
(cÚ¡ 
F
<
T
,
N
>& 
a
)

47 cÚ¡ 
	gT
& 
av®
(
a
.
v®
());

48 
	gF
<
	gT
,
	gN
> 
c
(
nd
(
av®
));

49 ià(!
	ga
.
d•’d
()è 
	gc
;

50 
	gc
.
£tD•’d
(
a
);

51 cÚ¡ 
	gT
& 
cv®
(
c
.
v®
());

52 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=-
a
[i]*
cv®
*
av®
;

53  
	gc
;

56 
	g‹m¶©e
 <
şass
 
	gT
, 
	gN
>

57 
INLINE2
 
	gF
<
	gT
,
	gN
> 
úd
(cÚ¡ 
F
<
T
,
N
>& 
a
)

59 
	gF
<
	gT
,
	gN
> 
c
(
úd
(
a
.
v®
()));

60 ià(!
	ga
.
d•’d
()è 
	gc
;

61 
T
 
tmp
(
nd
(
a
.
v®
()));

62 
	gc
.
£tD•’d
(
a
);

63 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

64  
	gc
;

67 
	g‹m¶©e
 <
şass
 
	gT
, 
	gN
>

68 
INLINE2
 
	gF
<
	gT
,
	gN
> 
iúd
(cÚ¡ 
F
<
T
,
N
>& 
a
)

70 
	gF
<
	gT
,
	gN
> 
c
(
iúd
(
a
.
v®
()));

71 ià(!
	ga
.
d•’d
()è 
	gc
;

72 
T
 
tmp
(
Op
<T>::
myInv
(
nd
(
c
.
v®
())));

73 
	gc
.
£tD•’d
(
a
);

74 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

75  
	gc
;

79 #ifdeà
_BADIFF_H


82 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

83 
	gBTy³NameCND
 : 
public
 
UnBTy³NameHV
<
U
>

85 
BTy³NameCND
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

86 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

88 
U
 
tmp
(
nd
(
this
->
İ
()->
v®
()));

89 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

92 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

93 
	gBTy³Name
<
	gU
> 
úd
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

95  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameCND
<U>(
úd
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

99 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

100 
	gBTy³NameICND
 : 
public
 
UnBTy³NameHV
<
U
>

102 
BTy³NameICND
(cÚ¡ 
U
& 
v®
, 
BTy³NameHV
<U>* 
pOp
):
UnBTy³NameHV
<U>(v®,
	gpOp
){}

103 
vœtu®
 
´İag©e
(
ty³Çme
 
D”iv©ives
<
U
>::
RecyşeBš
& 
bš
)

105 
U
 
tmp
(
Op
<U>::
myInv
(
nd
(
this
->
v®
())));

106 
	gthis
->
İ
()->
add
(
bš
,
tmp
,
this
->
m_d”iv©ives
);

109 
	g‹m¶©e
 <
ty³Çme
 
	gU
>

110 
	gBTy³Name
<
	gU
> 
iúd
(cÚ¡ 
BTy³Name
<
U
>& 
v®
)

112  
	gBTy³Name
<
	gU
>(
	g¡©ic_ÿ¡
<
	gBTy³NameHV
<U>*>(
Ãw
 
	gBTy³NameICND
<U>(
iúd
(
v®
.v®()), 
	gv®
.
g‘BTy³NameHV
())));

117 #ifdeà
_TADIFF_H


119 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

120 
	gCND
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

122 
CND
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
, TTy³NameHV<U,N>* 
pNd
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
,
	gpNd
){}

123 
ev®
(cÚ¡ 
k
)

125 
	gl
=
¡d
::
max
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

126 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
úd
Ñhis->
İ1V®
(0)); 
	gthis
->length()=1; }

127 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

129 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

130 
	gj
=0;j<
	gi
;++j)

132 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(i-
j
è*his->
İ2V®
(jè*his->
İ1V®
(i-j));

134 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
),
Op
<
U
>::
myIÁeg”
(i));

136  
	gthis
->
Ëngth
()=
l
;

139 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

140 
	gTTy³Name
<
	gU
,
	gN
> 
úd
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

142 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
Op
< 
TTy³Name
<
U
,
N
> >::
myExp
(-0.5*
v®
*v®)/Op<>::
mySq¹
(2*Op<>::
myPI
()));

143  
	gTTy³Name
<
	gU
,
	gN
>(
	g¡©ic_ÿ¡
<
	gTTy³NameHV
<U,N>*>(
Ãw
 
	gCND
<U,N>(
úd
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV())));

146 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

147 
	gICND
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

149 
U
 
	gm_SQRME
[
N
];

150 
U
 
	gm_EXPVAL
[
N
];

151 
ICND
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
)

153 
	gm_SQRME
[0]=
Op
<
U
>::
mySqr
(
this
->
v®
(0));

154 
	gm_EXPVAL
[0]=
Op
<
U
>::
myExp
(-0.5*
m_SQRME
[0]);

156 
ev®
(cÚ¡ 
k
)

158 
	gl
=
this
->
İEv®
(
k
);

159 ià(0==
this
->
Ëngth
())

161 
this
->
v®
(0)=
Op
<
U
>::
myExp
Ñhis->
İV®
(0));

162 
	gthis
->
Ëngth
()=1;

163 
	gm_SQRME
[0]=
Op
<
U
>::
mySqr
(
this
->
v®
(0));

164 
	gm_EXPVAL
[0]=
Op
<
U
>::
myExp
(-0.5*
m_SQRME
[0]);

166 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

168 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

169 ià(
	gi
>1)

171 
	gi1
=
i
-1;

172 
	gm_SQRME
[
i1
]=
Op
<
U
>::
myZ”o
();

173 
	gm
=(
i1
+1)/2;

174 
	gj
=0;j<
	gm
;++j)

175 
	gOp
<
	gU
>::
myCadd
(
m_SQRME
[
i1
], 
this
->
v®
(i1-
j
)*this->val(j));

176 
	gOp
<
	gU
>::
myCmul
(
m_SQRME
[
i1
],
Op
<
U
>::
myTwo
());

177 ià(0==
i1
%2è
Op
<
U
>::
myCadd
(
m_SQRME
[i1], Op<U>::
mySqr
(
this
->
v®
(
m
)));

179 
	gm_EXPVAL
[
i1
]=
Op
<
U
>::
myZ”o
();

180 
	gj
=0;j<()
	gi1
;++j)

181 
	gOp
<
	gU
>::
myCadd
(
m_EXPVAL
[
i1
], 
Op
<
U
>::
myIÁeg”
(i1-
j
)*
m_SQRME
[i1-j]*m_EXPVAL[j]);

182 
	gOp
<
	gU
>::
myCdiv
(
m_EXPVAL
[
i1
],
Op
<
U
>::
myIÁeg”
(-2*i1));

185 
	gj
=1;j<
	gi
;++j)

186 
	gOp
<
	gU
>::
myCsub
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(
j
è* 
m_EXPVAL
[i-j] *his->val(j));

187 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(i) );

188 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
),his->
İV®
(iè* 
Op
<>::
mySq¹
(2*Op<
U
>::
myPI
()) );

190 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
), 
m_EXPVAL
[0]);

192  
	gthis
->
Ëngth
()=
l
;

195 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

196 
	gTTy³Name
<
	gU
,
	gN
> 
iúd
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

198  
	gTTy³Name
<
	gU
,
	gN
>(
	g¡©ic_ÿ¡
<
	gTTy³NameHV
<U,N>*>(
Ãw
 
	gICND
<U,N>(
iúd
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
())));

	@robot/FADBAD++/fadbad.h

30 #iâdeà
_FADBAD_H


31 
	#_FADBAD_H


	)

33 
	~<m©h.h
>

35 
Çme¥aû
 
	gçdbad


42 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
	sOp


44 
T
 
	tBa£
;

45 
Ba£
 
myIÁeg”
(cÚ¡ 
i
) {  Base(i); }

46 
Ba£
 
myZ”o
(è{  
myIÁeg”
(0); }

47 
Ba£
 
myOÃ
(è{  
myIÁeg”
(1);}

48 
Ba£
 
myTwo
(è{  
myIÁeg”
(2); }

49 
Ba£
 
myPI
() {  3.14159265358979323846; }

50 
T
 
myPos
(cÚ¡ T& 
x
è{  +
	gx
; }

51 
T
 
myNeg
(cÚ¡ T& 
x
è{  -
	gx
; }

52 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gT
& 
myCadd
(
T
& 
x
, cÚ¡ 
U
& 
y
è{  
	gx
+=y; }

53 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gT
& 
myCsub
(
T
& 
x
, cÚ¡ 
U
& 
y
è{  
	gx
-=y; }

54 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gT
& 
myCmul
(
T
& 
x
, cÚ¡ 
U
& 
y
è{  
	gx
*=y; }

55 
	g‹m¶©e
 <
ty³Çme
 
	gU
> 
	gT
& 
myCdiv
(
T
& 
x
, cÚ¡ 
U
& 
y
è{  
	gx
/=y; }

56 
T
 
myInv
(cÚ¡ T& 
x
è{  
myOÃ
()/
	gx
; }

57 
T
 
mySqr
(cÚ¡ T& 
x
è{  x*
	gx
; }

58 
	g‹m¶©e
 <
ty³Çme
 
	gX
,y³Çm
	gY
>

59 
T
 
myPow
(cÚ¡ 
X
& 
x
, cÚ¡ 
Y
& 
y
è{  ::
pow
(x,y); }

60 
T
 
mySq¹
(cÚ¡ T& 
x
è{  ::
sq¹
(x); }

61 
T
 
myLog
(cÚ¡ T& 
x
è{  ::
log
(x); }

62 
T
 
myExp
(cÚ¡ T& 
x
è{  ::
exp
(x); }

63 
T
 
mySš
(cÚ¡ T& 
x
è{  ::
sš
(x); }

64 
T
 
myCos
(cÚ¡ T& 
x
è{  ::
cos
(x); }

65 
T
 
myTª
(cÚ¡ T& 
x
è{  ::
n
(x); }

66 
T
 
myAsš
(cÚ¡ T& 
x
è{  ::
asš
(x); }

67 
T
 
myAcos
(cÚ¡ T& 
x
è{  ::
acos
(x); }

68 
T
 
myAn
(cÚ¡ T& 
x
è{  ::
©ª
(x); }

69 
boŞ
 
myEq
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
==y; }

70 
boŞ
 
myNe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
!=y; }

71 
boŞ
 
myLt
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
<
	gy
; }

72 
boŞ
 
myLe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
<=y; }

73 
boŞ
 
myGt
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
>
	gy
; }

74 
boŞ
 
myGe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
>=y; }

79 
	#BTy³Name
 
B


	)

82 
	#FTy³Name
 
F


	)

85 
	#TTy³Name
 
T


	)

88 
	#INLINE0
 
šlše


	)

91 
	#INLINE1
 
šlše


	)

94 
	#INLINE2
 
šlše


	)

96 #ifdeà
__SUNPRO_CC


99 #undeà
INLINE0


100 #undeà
INLINE1


101 #undeà
INLINE2


102 
	#INLINE0


	)

103 
	#INLINE1


	)

104 
	#INLINE2


	)

108 #ifdeà
_DEBUG


110 
	~<s¡»am
>

111 
	~<io¡»am
>

113 
šlše
 
	$R•ÜtE¼Ü
(cÚ¡ * 
”rmsg
)

115 
¡d
::
cout
<<
”rmsg
<<¡d::
’dl
;

116 
	}
}

118 
	#USER_ASSERT
(
check
,
msg
)\

	)

119 ià(!(
	gcheck
))\

121 
	g¡d
::
o¡ršg¡»am
 
o¡
;\

122 
	go¡
<<"U£¸as£¹iÚ faed: \""<<
	gmsg
<<"\",‡ˆlš"<<
	g__LINE__
<<", f"<<
	g__FILE__
<<
	g¡d
::
’dl
;\

123 
R•ÜtE¼Ü
(
o¡
.
¡r
().
c_¡r
());\

125 
	#INTERNAL_ASSERT
(
check
,
msg
)\

	)

126 ià(!(
	gcheck
))\

128 
	g¡d
::
o¡ršg¡»am
 
o¡
;\

129 
	go¡
<<"IÁ”ÇÈ”rÜ: \""<<
	gmsg
<<"\",‡ˆlš"<<
	g__LINE__
<<", f"<<
	g__FILE__
<<
	g¡d
::
’dl
;\

130 
R•ÜtE¼Ü
(
o¡
.
¡r
().
c_¡r
());\

132 
	#ASSERT
(
check
)\

	)

133 ià(!(
	gcheck
))\

135 
	g¡d
::
o¡ršg¡»am
 
o¡
;\

136 
	go¡
<<"IÁ”ÇÈ”rÜ‡ˆlš"<<
	g__LINE__
<<", f"<<
	g__FILE__
<<
	g¡d
::
’dl
;\

137 
R•ÜtE¼Ü
(
o¡
.
¡r
().
c_¡r
());\

139 #ifdeà
_TRACE


140 
	#DEBUG
(
code
ècode;

	)

142 
	#DEBUG
(
code
)

	)

147 
	#USER_ASSERT
(
check
,
msg
)

	)

148 
	#INTERNAL_ASSERT
(
check
,
msg
)

	)

149 
	#ASSERT
(
check
)

	)

150 
	#DEBUG
(
code
)

	)

	@robot/FADBAD++/fadiff.h

30 #iâdeà
_FADIFF_H


31 
	#_FADIFF_H


	)

33 
	~"çdbad.h
"

35 
Çme¥aû
 
	gçdbad


38 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
=0>

39 şas 
	cFTy³Name


41 
T
 
m_v®
;

42 
T
 
	gm_diff
[
N
];

43 
boŞ
 
	gm_d•’d
;

44 
	gpublic
:

45 
T
 
	tUnd”lyšgTy³
;

46 
FTy³Name
():
m_d•’d
(
çl£
){}

47 
FTy³Name
(cÚ¡ FTy³Name<
T
,
N
>& 
v®
):
m_v®
(v®.m_v®),
m_d•’d
(val.m_depend)

49 ià(
	gm_d•’d
è
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=
v®
.
m_diff
[i];

51 
	g‹m¶©e
 <
şass
 
	gU
> 
FTy³Name
(cÚ¡ 
U
& 
v®
):
m_v®
(v®),
m_d•’d
(
çl£
)

54 
	g‹m¶©e
 <
şass
 
	gU
> 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
=(cÚ¡ 
U
& 
v®
)

56 
m_v®
=
v®
;

57 
	gm_d•’d
=
çl£
;

58  *
	gthis
;

60 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
)

62 ià(
	gthis
==&
v®
è *
this
;

63 
	gm_v®
=
v®
.
m_v®
;

64 
	gm_d•’d
=
v®
.
m_d•’d
;

65 ià(
	gm_d•’d
è
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=
v®
.
m_diff
[i];

66  *
	gthis
;

68 
size
(ècÚ¡ {  
	gm_d•’d
?
	gN
:0; }

69 cÚ¡ 
	gT
& 
	gİ”©Ü
[](cÚ¡ 
	gi
) const

71 
USER_ASSERT
(
i
<
N
 && 
m_d•’d
,"Index "<<i<<" out of bounds [0,"<<N<<"]")

72  
	gm_diff
[
i
];

74 
	gT
& 
	gİ”©Ü
[](cÚ¡ 
	gi
)

76 
USER_ASSERT
(
i
<
N
 && 
m_d•’d
,"Index "<<i<<" out of bounds [0,"<<N<<"]")

77  
	gm_diff
[
i
];

79 cÚ¡ 
	gT
& 
v®
(ècÚ¡ {  
	gm_v®
; }

80 
	gT
& 
x
(è{  
	gm_v®
; }

81 cÚ¡ 
	gT
& 
d”iv
(cÚ¡ 
i
) const

83 
USER_ASSERT
(
i
<
N
,"Index "<<i<<" out of bounds [0,"<<N<<"]")

84 ià(
	gm_d•’d
è 
	gm_diff
[
i
];

85 
T
 
	gz”o
;

86 
	gz”o
=
Op
<
T
>::
myZ”o
();

87  
	gz”o
;

89 
	gT
& 
d
(cÚ¡ 
i
)

91 
USER_ASSERT
(
i
<
N
,"Index "<<i<<" out of bounds [0,"<<N<<"]")

92 ià(
	gm_d•’d
è 
	gm_diff
[
i
];

93 
T
 
	gz”o
;

94 
	gz”o
=
Op
<
T
>::
myZ”o
();

95  
	gz”o
;

98 
	gT
& 
diff
(
idx
)

100 
USER_ASSERT
(
idx
<
N
,"index out of bounds: "<<idx);

101 
	gi
;

102 
	gi
=0;i<
	gidx
;++iè
	gm_diff
[
i
]=
Op
<
T
>::
myZ”o
();

103 
	gm_diff
[
i
++]=
Op
<
T
>::
myOÃ
();

104  ;
	gi
<
	gN
;++iè
	gm_diff
[
i
]=
Op
<
T
>::
myZ”o
();

105 
	gm_d•’d
=
Œue
;

106  
	gm_diff
[
idx
];

108 
boŞ
 
d•’d
(ècÚ¡ {  
	gm_d•’d
; }

109 
£tD•’d
(cÚ¡ 
FTy³Name
<
T
,
N
>&è{ 
	gm_d•’d
=
Œue
; }

110 
£tD•’d
(cÚ¡ 
FTy³Name
<
T
,
N
>&, cÚ¡ FTy³Name<T,N>&è{ 
	gm_d•’d
=
Œue
; }

112 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
+=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
);

113 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
-=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
);

114 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
*=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
);

115 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
/=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
);

116 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
+=(cÚ¡ 
V
& 
v®
);

117 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
-=(cÚ¡ 
V
& 
v®
);

118 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
*=(cÚ¡ 
V
& 
v®
);

119 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& 
	gİ”©Ü
/=(cÚ¡ 
V
& 
v®
);

123 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

124 
şass
 
	gFTy³Name
<
	gT
,0>

126 
T
 
	gm_v®
;

127 
	gm_size
;

128 
T
* 
	gm_diff
;

129 
	gpublic
:

130 
T
 
	tUnd”lyšgTy³
;

131 
FTy³Name
():
m_v®
(),
m_size
(0),
m_diff
(0){}

132 
FTy³Name
(cÚ¡ FTy³Name<
T
>& 
v®
):
m_v®
(v®.m_v®),
m_size
(v®.m_size),
m_diff
(m_size==0?0:
Ãw
 T[m_size])

134 
i
=0;
	gi
<
	gm_size
;++iè
	gm_diff
[i]=
v®
.
m_diff
[i];

136 
	g‹m¶©e
 <
şass
 
	gU
> 
FTy³Name
(cÚ¡ 
U
& 
v®
):
m_v®
(v®),
m_size
(0),
m_diff
(0){}

137 ~
FTy³Name
(){ 
	gd–‘e
[] 
	gm_diff
; }

138 
	g‹m¶©e
 <
şass
 
	gU
> 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
=(cÚ¡ 
U
& 
v®
)

140 
m_v®
=
v®
;

141 
	gm_size
=0;

142 
	gd–‘e
[] 
	gm_diff
;

143 
	gm_diff
=0;

144  *
	gthis
;

146 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
=(cÚ¡ 
FTy³Name
<
T
>& 
v®
)

148 ià(
this
==&
v®
)  *this;

149 
	gm_v®
=
v®
.
m_v®
;

150 ià(
	gv®
.
	gm_size
>0)

152 ià(
	gm_size
==0)

154 
m_size
 = 
v®
.m_size;

155 
	gm_diff
 = 
Ãw
 
T
[
m_size
];

157 
USER_ASSERT
(
m_size
==
v®
.m_size,"derivative vectors‚ot of same size");

158 
	gi
=0;i<
	gv®
.
	gm_size
;++iè
	gm_diff
[
i
]=
v®
.
m_diff
[i];

160 ià(
	gm_size
>0)

162 
	gi
=0;i<
	gm_size
;++iè
	gm_diff
[
i
]=0;

164  *
	gthis
;

166 
size
(ècÚ¡ {  
	gm_size
; }

167 cÚ¡ 
	gT
& 
	gİ”©Ü
[](cÚ¡ 
	gi
) const

169 
USER_ASSERT
(
i
<
m_size
,"index out of bounds: "<<i);

170  
	gm_diff
[
i
];

172 
	gT
& 
	gİ”©Ü
[](cÚ¡ 
	gi
)

174 
USER_ASSERT
(
i
<
m_size
,"index out of bounds: "<<i);

175  
	gm_diff
[
i
];

177 cÚ¡ 
	gT
& 
v®
(ècÚ¡ {  
	gm_v®
; }

178 
	gT
& 
x
(è{  
	gm_v®
; }

179 cÚ¡ 
	gT
& 
d”iv
(cÚ¡ 
i
) const

181 ià(
	gi
<
	gm_size
è 
	gm_diff
[
i
];

182 
T
 
	gz”o
;

183 
	gz”o
=
Op
<
T
>::
myZ”o
();

184  
	gz”o
;

186 
	gT
& 
d
(cÚ¡ 
i
)

188 ià(
	gi
<
	gm_size
è 
	gm_diff
[
i
];

189 
T
 
	gz”o
;

190 
	gz”o
=
Op
<
T
>::
myZ”o
();

191  
	gz”o
;

194 
	gT
& 
diff
(
idx
, 
N
)

196 
USER_ASSERT
(
idx
<
N
,"Index "<<idx<<" out of bounds [0,"<<N<<"]")

197 ià(
	gm_size
==0)

199 
m_size
 = 
N
;

200 
	gm_diff
 = 
Ãw
 
T
[
m_size
];

204 
USER_ASSERT
(
m_size
==
N
,"derivative vectors‚ot of same size "<<m_size<<","<<N);

206 
	gi
;

207 
	gi
=0;i<
	gidx
;++iè
	gm_diff
[
i
]=
Op
<
T
>::
myZ”o
();

208 
	gm_diff
[
i
++]=
Op
<
T
>::
myOÃ
();

209  ;
	gi
<
	gN
;++iè
	gm_diff
[
i
]=
Op
<
T
>::
myZ”o
();

210  
	gm_diff
[
idx
];

212 
boŞ
 
d•’d
(ècÚ¡ {  
	gm_size
!=0; }

213 
£tD•’d
(cÚ¡ 
FTy³Name
<
T
>& 
v®
)

215 
INTERNAL_ASSERT
(
v®
.
m_size
>0,"input is‚ot‡ dependent variable")

216 ià(
	gm_size
==0)

218 
m_size
 = 
v®
.m_size;

219 
	gm_diff
 = 
Ãw
 
T
[
m_size
];

223 
USER_ASSERT
(
m_size
==
v®
.m_size,"derivative vectors‚ot of same size "<<m_size<<","<<val.m_size);

226 
£tD•’d
(cÚ¡ 
FTy³Name
<
T
>& 
v®1
, cÚ¡ FTy³Name<T>& 
v®2
)

228 
USER_ASSERT
(
v®1
.
m_size
==
v®2
.m_size,"derivative vectors‚ot of same size "<<val1.m_size<<","<<val2.m_size);

229 
INTERNAL_ASSERT
(
v®1
.
m_size
>0,"lhs-input is‚ot‡ dependent variable")

230 
INTERNAL_ASSERT
(
v®2
.
m_size
>0,"rhs-input is‚ot‡ dependent variable")

231 ià(
	gm_size
==0)

233 
m_size
=
v®1
.m_size;

234 
	gm_diff
 = 
Ãw
 
T
[
m_size
];

238 
USER_ASSERT
(
m_size
==
v®1
.m_size,"derivative vectors‚ot of same size "<<m_size<<","<<val1.m_size);

242 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
+=(cÚ¡ 
FTy³Name
<
T
>& 
v®
);

243 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
-=(cÚ¡ 
FTy³Name
<
T
>& 
v®
);

244 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
*=(cÚ¡ 
FTy³Name
<
T
>& 
v®
);

245 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
/=(cÚ¡ 
FTy³Name
<
T
>& 
v®
);

246 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
+=(cÚ¡ 
V
& 
v®
);

247 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
-=(cÚ¡ 
V
& 
v®
);

248 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
*=(cÚ¡ 
V
& 
v®
);

249 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
>& 
	gİ”©Ü
/=(cÚ¡ 
V
& 
v®
);

253 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myEq
(
v®1
.
v®
(),
v®2
.val()); }

254 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myNe
(
v®1
.
v®
(),
v®2
.val()); }

255 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®1
, cÚ¡ FTy³Name<T,N>& 
	gv®2
è{  
	gOp
<T>::
myLt
(
v®1
.
v®
(),
v®2
.val()); }

256 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myLe
(
v®1
.
v®
(),
v®2
.val()); }

257 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®1
, cÚ¡ FTy³Name<T,N>& 
	gv®2
è{  
	gOp
<T>::
myGt
(
v®1
.
v®
(),
v®2
.val()); }

258 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myGe
(
v®1
.
v®
(),
v®2
.val()); }

259 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ U& 
	gv®2
è{  
	gOp
<T>::
myEq
(
v®1
.
v®
(),
v®2
); }

260 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
U
& 
v®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myEq
(v®1,
v®2
.
v®
()); }

261 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ U& 
	gv®2
è{  
	gOp
<T>::
myNe
(
v®1
.
v®
(),
v®2
); }

262 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
U
& 
v®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myNe
(v®1,
v®2
.
v®
()); }

263 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®1
, cÚ¡ U& 
	gv®2
è{  
	gOp
<T>::
myLt
(
v®1
.
v®
(),
v®2
); }

264 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ U& 
	gv®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myLt
(
v®1
,
v®2
.
v®
()); }

265 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ U& 
	gv®2
è{  
	gOp
<T>::
myLe
(
v®1
.
v®
(),
v®2
); }

266 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
U
& 
v®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myLe
(v®1,
v®2
.
v®
()); }

267 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®1
, cÚ¡ U& 
	gv®2
è{  
	gOp
<T>::
myGt
(
v®1
.
v®
(),
v®2
); }

268 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ U& 
	gv®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myGt
(
v®1
,
v®2
.
v®
()); }

269 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®1
, cÚ¡ U& 
	gv®2
è{  
	gOp
<T>::
myGe
(
v®1
.
v®
(),
v®2
); }

270 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
U
& 
v®1
, cÚ¡ 
	gFTy³Name
<T,N>& 
	gv®2
è{  
	gOp
<T>::
myGe
(v®1,
v®2
.
v®
()); }

272 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

273 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
add1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,
N
>& 
b
)

275 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
+
b
.
v®
());

276 ià(!
	gb
.
d•’d
()è 
	gc
;

277 
	gc
.
£tD•’d
(
b
);

278 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
b
[i];

279  
	gc
;

281 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

282 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
add1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,0>& 
b
)

284 
	gFTy³Name
<
	gT
,0> 
c
(
a
+
b
.
v®
());

285 ià(!
	gb
.
d•’d
()è 
	gc
;

286 
	gc
.
£tD•’d
(
b
);

287 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
b
[i];

288  
	gc
;

291 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

292 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
add2
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ 
U
& 
b
)

294 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
()+
b
);

295 ià(!
	ga
.
d•’d
()è 
	gc
;

296 
	gc
.
£tD•’d
(
a
);

297 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i];

298  
	gc
;

300 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

301 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
add2
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ 
U
& 
b
)

303 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
()+
b
);

304 ià(!
	ga
.
d•’d
()è 
	gc
;

305 
	gc
.
£tD•’d
(
a
);

306 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i];

307  
	gc
;

310 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

311 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
+ (cÚ¡ 
	gU
& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

313  
add1
(
a
,
b
);

316 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

317 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
+ (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ 
	gU
& 
	gb
)

319  
add2
(
a
,
b
);

322 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

323 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
add3
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ FTy³Name<T,N>& 
b
)

325 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
()+
b
.val());

326 
	gc
.
£tD•’d
(
a
,
b
);

327 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]+
b
[i];

328  
	gc
;

330 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

331 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
add3
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ FTy³Name<T,0>& 
b
)

333 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
()+
b
.val());

334 
	gc
.
£tD•’d
(
a
,
b
);

335 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]+
b
[i];

336  
	gc
;

339 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

340 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
+ (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

342 (
	ga
.
d•’d
()?1:0)|(
b
.depend()?2:0))

344 0:  
FTy³Name
<
T
,
	gN
>(
	ga
.
v®
()+
	gb
.val());

345 1:  
add2
(
a
,
b
.
v®
());

346 2:  
add1
(
a
.
v®
(),
b
);

348  
add3
(
a
,
b
);

351 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

352 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
sub1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,
N
>& 
b
)

354 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
-
b
.
v®
());

355 ià(!
	gb
.
d•’d
()è 
	gc
;

356 
	gc
.
£tD•’d
(
b
);

357 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
Op
<
T
>::
myNeg
(
b
[i]);

358  
	gc
;

360 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

361 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
sub1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,0>& 
b
)

363 
	gFTy³Name
<
	gT
,0> 
c
(
a
-
b
.
v®
());

364 ià(!
	gb
.
d•’d
()è 
	gc
;

365 
	gc
.
£tD•’d
(
b
);

366 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
Op
<
T
>::
myNeg
(
b
[i]);

367  
	gc
;

370 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

371 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
sub2
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ 
U
& 
b
)

373 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
()-
b
);

374 ià(!
	ga
.
d•’d
()è 
	gc
;

375 
	gc
.
£tD•’d
(
a
);

376 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i];

377  
	gc
;

379 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

380 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
sub2
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ 
U
& 
b
)

382 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
()-
b
);

383 ià(!
	ga
.
d•’d
()è 
	gc
;

384 
	gc
.
£tD•’d
(
a
);

385 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i];

386  
	gc
;

389 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

390 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
- (cÚ¡ 
	gU
& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

392  
sub1
(
a
,
b
);

395 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

396 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
- (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ 
	gU
& 
	gb
)

398  
sub2
(
a
,
b
);

401 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

402 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
sub3
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ FTy³Name<T,N>& 
b
)

404 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
()-
b
.val());

405 
	gc
.
£tD•’d
(
a
,
b
);

406 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]-
b
[i];

407  
	gc
;

409 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

410 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
sub3
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ FTy³Name<T,0>& 
b
)

412 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
()-
b
.val());

413 
	gc
.
£tD•’d
(
a
,
b
);

414 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]-
b
[i];

415  
	gc
;

418 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

419 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
- (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

421 (
	ga
.
d•’d
()?1:0)|(
b
.depend()?2:0))

423 0:  
FTy³Name
<
T
,
	gN
>(
	ga
.
v®
()-
	gb
.val());

424 1:  
sub2
(
a
,
b
.
v®
());

425 2:  
sub1
(
a
.
v®
(),
b
);

427  
sub3
(
a
,
b
);

430 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

431 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
mul1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,
N
>& 
b
)

433 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
*
b
.
v®
());

434 ià(!
	gb
.
d•’d
()è 
	gc
;

435 
	gc
.
£tD•’d
(
b
);

436 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
b
[i]*
a
;

437  
	gc
;

439 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

440 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
mul1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,0>& 
b
)

442 
	gFTy³Name
<
	gT
,0> 
c
(
a
*
b
.
v®
());

443 ià(!
	gb
.
d•’d
()è 
	gc
;

444 
	gc
.
£tD•’d
(
b
);

445 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
b
[i]*
a
;

446  
	gc
;

449 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

450 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
mul2
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ 
U
& 
b
)

452 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
()*
b
);

453 ià(!
	ga
.
d•’d
()è 
	gc
;

454 
	gc
.
£tD•’d
(
a
);

455 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
b
;

456  
	gc
;

458 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

459 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
mul2
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ 
U
& 
b
)

461 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
()*
b
);

462 ià(!
	ga
.
d•’d
()è 
	gc
;

463 
	gc
.
£tD•’d
(
a
);

464 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
b
;

465  
	gc
;

468 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

469 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
* (cÚ¡ 
	gU
& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

471  
mul1
(
a
,
b
);

474 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

475 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
* (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ 
	gU
& 
	gb
)

477  
mul2
(
a
,
b
);

480 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

481 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
mul3
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ FTy³Name<T,N>& 
b
)

483 cÚ¡ 
	gT
& 
av®
(
a
.
v®
());

484 cÚ¡ 
	gT
& 
bv®
(
b
.
v®
());

485 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
av®
*
bv®
);

486 
	gc
.
£tD•’d
(
a
,
b
);

487 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
bv®
+
b
[i]*
av®
;

488  
	gc
;

490 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

491 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
mul3
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ FTy³Name<T,0>& 
b
)

493 cÚ¡ 
	gT
& 
av®
(
a
.
v®
());

494 cÚ¡ 
	gT
& 
bv®
(
b
.
v®
());

495 
	gFTy³Name
<
	gT
,0> 
c
(
av®
*
bv®
);

496 
	gc
.
£tD•’d
(
a
,
b
);

497 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
bv®
+
b
[i]*
av®
;

498  
	gc
;

501 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

502 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
* (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

504 (
	ga
.
d•’d
()?1:0)|(
b
.depend()?2:0))

506 0:  
FTy³Name
<
T
,
	gN
>(
	ga
.
v®
()*
	gb
.val());

507 1:  
mul2
(
a
,
b
.
v®
());

508 2:  
mul1
(
a
.
v®
(),
b
);

510  
mul3
(
a
,
b
);

513 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

514 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
div1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,
N
>& 
b
)

516 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
/
b
.
v®
());

517 ià(!
	gb
.
d•’d
()è 
	gc
;

518 
T
 
tmp
(
Op
<T>::
myNeg
(
c
.
v®
()/
b
.val()));

519 
	gc
.
£tD•’d
(
b
);

520 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
tmp
*
b
[i];

521  
	gc
;

523 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

524 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
div1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,0>& 
b
)

526 
	gFTy³Name
<
	gT
,0> 
c
(
a
/
b
.
v®
());

527 ià(!
	gb
.
d•’d
()è 
	gc
;

528 
T
 
tmp
(
Op
<T>::
myNeg
(
c
.
v®
()/
b
.val()));

529 
	gc
.
£tD•’d
(
b
);

530 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
tmp
*
b
[i];

531  
	gc
;

534 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
, 
	gN
>

535 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
div2
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ 
U
& 
b
)

537 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
()/
b
);

538 ià(!
	ga
.
d•’d
()è 
	gc
;

539 
	gc
.
£tD•’d
(
a
);

540 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=(
a
[i])/
b
;

541  
	gc
;

543 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
şass
 
	gU
>

544 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
div2
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ 
U
& 
b
)

546 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
()/
b
);

547 ià(!
	ga
.
d•’d
()è 
	gc
;

548 
	gc
.
£tD•’d
(
a
);

549 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=(
a
[i])/
b
;

550  
	gc
;

553 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

554 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
/ (cÚ¡ 
	gU
& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

556  
div1
(
a
,
b
);

559 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

560 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
/ (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ 
	gU
& 
	gb
)

562  
div2
(
a
,
b
);

565 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

566 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
div3
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ FTy³Name<T,N>& 
b
)

568 cÚ¡ 
	gT
& 
bv®
(
b
.
v®
());

569 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
()/
bv®
);

570 
	gc
.
£tD•’d
(
a
,
b
);

571 cÚ¡ 
	gT
& 
cv®
(
c
.
v®
());

572 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=(
a
[i]-
cv®
*
b
[i])/
bv®
;

573  
	gc
;

575 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

576 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
div3
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ FTy³Name<T,0>& 
b
)

578 cÚ¡ 
	gT
& 
bv®
(
b
.
v®
());

579 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
()/
bv®
);

580 
	gc
.
£tD•’d
(
a
,
b
);

581 cÚ¡ 
	gT
& 
cv®
(
c
.
v®
());

582 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=(
a
[i]-
cv®
*
b
[i])/
bv®
;

583  
	gc
;

586 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

587 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
/ (cÚ¡ FTy³Name<T,N>& 
	ga
, cÚ¡ FTy³Name<T,N>& 
	gb
)

589 (
	ga
.
d•’d
()?1:0)|(
b
.depend()?2:0))

591 0:  
FTy³Name
<
T
,
	gN
>(
	ga
.
v®
()/
	gb
.val());

592 1:  
div2
(
a
,
b
.
v®
());

593 2:  
div1
(
a
.
v®
(),
b
);

595  
div3
(
a
,
b
);

598 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

599 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
+=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
)

601 
	gOp
<
	gT
>::
myCadd
(
m_v®
,
v®
.m_val);

602 ià(!
	gv®
.
d•’d
()è *
	gthis
;

603 ià(
	gthis
->
d•’d
())

605 
	gi
=0;i<
	gN
;++iè
	gOp
<
	gT
>::
myCadd
(
m_diff
[
i
],
v®
[i]);

609 
	gthis
->
£tD•’d
(
v®
);

610 
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=
v®
[i];

612  *
	gthis
;

615 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

616 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
-=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
)

618 
	gOp
<
	gT
>::
myCsub
(
m_v®
,
v®
.m_val);

619 ià(!
	gv®
.
d•’d
()è *
	gthis
;

620 ià(
	gthis
->
d•’d
())

622 
	gi
=0;i<
	gN
;++iè
	gOp
<
	gT
>::
myCsub
(
m_diff
[
i
],
v®
[i]);

626 
	gthis
->
£tD•’d
(
v®
);

627 
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=
Op
<
T
>::
myNeg
(
v®
[i]);

629  *
	gthis
;

632 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

633 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
*=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
)

635 ià(
	gthis
->
d•’d
(è&& 
	gv®
.depend())

637 
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=
m_diff
[i]*
v®
.
m_v®
+val.m_diff[i]*m_val;

639 ià(
	gthis
->
d•’d
())

641 
	gi
=0;i<
	gN
;++iè
	gOp
<
	gT
>::
myCmul
(
m_diff
[
i
],
v®
.
m_v®
);

645 
	gthis
->
£tD•’d
(
v®
);

646 
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=
v®
.
m_diff
[i]*
m_v®
;

648 
	gOp
<
	gT
>::
myCmul
(
m_v®
,
v®
.m_val);

649  *
	gthis
;

652 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

653 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
/=(cÚ¡ 
FTy³Name
<
T
,N>& 
	gv®
)

655 
	gOp
<
	gT
>::
myCdiv
(
m_v®
,
v®
.m_val);

656 ià(
	gthis
->
d•’d
(è&& 
	gv®
.depend())

658 
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=(
m_diff
[i]-
m_v®
*
v®
.m_diff[i])/val.m_val;

660 ià(
	gthis
->
d•’d
())

662 
	gi
=0;i<
	gN
;++iè
	gOp
<
	gT
>::
myCdiv
(
m_diff
[
i
],
v®
.
m_v®
);

666 
	gthis
->
£tD•’d
(
v®
);

667 
	gi
=0;i<
	gN
;++iè
	gm_diff
[
i
]=
Op
<
T
>::
myNeg
(
m_v®
*
v®
.
m_diff
[i]/val.m_val);

669  *
	gthis
;

672 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

673 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
+=(cÚ¡ 
V
& 
v®
)

675 
Op
<
T
>::
myCadd
(
m_v®
,
v®
);

676  *
	gthis
;

678 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

679 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
-=(cÚ¡ 
V
& 
v®
)

681 
Op
<
T
>::
myCsub
(
m_v®
,
v®
);

682  *
	gthis
;

685 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

686 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
*=(cÚ¡ 
V
& 
v®
)

688 
Op
<
T
>::
myCmul
(
m_v®
,
v®
);

689 ià(!
	gthis
->
d•’d
())  *this;

690 
	gi
=0;i<
	gN
;++iè
	gOp
<
	gT
>::
myCmul
(
m_diff
[
i
],
v®
);

691  *
	gthis
;

694 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

695 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,
	gN
>& FTy³Name<T,N>::
İ”©Ü
/=(cÚ¡ 
V
& 
v®
)

697 
Op
<
T
>::
myCdiv
(
m_v®
,
v®
);

698 ià(!
	gthis
->
d•’d
())  *this;

699 
	gi
=0;i<
	gN
;++iè
	gOp
<
	gT
>::
myCdiv
(
m_diff
[
i
],
v®
);

700  *
	gthis
;

703 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

704 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
+=(cÚ¡ 
FTy³Name
<
T
,0>& 
	gv®
)

706 
	gOp
<
	gT
>::
myCadd
(
m_v®
,
v®
.m_val);

707 ià(!
	gv®
.
d•’d
()è *
	gthis
;

708 ià(
	gthis
->
d•’d
())

710 
	gi
=0;i<
	gthis
->
size
();++iè
	gOp
<
	gT
>::
myCadd
(
m_diff
[
i
],
v®
[i]);

714 
	gthis
->
£tD•’d
(
v®
);

715 
	gi
=0;i<
	gthis
->
size
();++iè
	gm_diff
[
i
]=
v®
[i];

717  *
	gthis
;

719 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

720 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
-=(cÚ¡ 
FTy³Name
<
T
,0>& 
	gv®
)

722 
	gOp
<
	gT
>::
myCsub
(
m_v®
,
v®
.m_val);

723 ià(!
	gv®
.
d•’d
()è *
	gthis
;

724 ià(
	gthis
->
d•’d
())

726 
	gi
=0;i<
	gthis
->
size
();++iè
	gOp
<
	gT
>::
myCsub
(
m_diff
[
i
],
v®
[i]);

730 
	gthis
->
£tD•’d
(
v®
);

731 
	gi
=0;i<
	gthis
->
size
();++iè
	gm_diff
[
i
]=
Op
<
T
>::
myNeg
(
v®
[i]);

733  *
	gthis
;

735 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

736 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
*=(cÚ¡ 
FTy³Name
<
T
,0>& 
	gv®
)

738 ià(
	gthis
->
d•’d
(è&& 
	gv®
.depend())

740 
	gi
=0;i<
	gthis
->
size
();++iè
	gm_diff
[
i
]=
m_diff
[i]*
v®
.
m_v®
+val.m_diff[i]*m_val;

742 ià(
	gthis
->
d•’d
())

744 
	gi
=0;i<
	gthis
->
size
();++iè
	gOp
<
	gT
>::
myCmul
(
m_diff
[
i
],
v®
.
m_v®
);

748 
	gthis
->
£tD•’d
(
v®
);

749 
	gi
=0;i<
	gthis
->
size
();++iè
	gm_diff
[
i
]=
v®
.
m_diff
[i]*
m_v®
;

751 
	gOp
<
	gT
>::
myCmul
(
m_v®
,
v®
.m_val);

752  *
	gthis
;

754 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

755 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
/=(cÚ¡ 
FTy³Name
<
T
,0>& 
	gv®
)

757 
	gOp
<
	gT
>::
myCdiv
(
m_v®
,
v®
.m_val);

758 ià(
	gthis
->
d•’d
(è&& 
	gv®
.depend())

760 
	gi
=0;i<
	gthis
->
size
();++iè
	gm_diff
[
i
]=(
m_diff
[i]-
m_v®
*
v®
.m_diff[i])/val.m_val;

762 ià(
	gthis
->
d•’d
())

764 
	gi
=0;i<
	gthis
->
size
();++iè
	gOp
<
	gT
>::
myCdiv
(
m_diff
[
i
],
v®
.
m_v®
);

768 
	gthis
->
£tD•’d
(
v®
);

769 
	gi
=0;i<
	gthis
->
size
();++iè
	gm_diff
[
i
]=
Op
<
T
>::
myNeg
(
m_v®
*
v®
.
m_diff
[i]/val.m_val);

771  *
	gthis
;

773 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

774 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
+=(cÚ¡ 
V
& 
v®
)

776 
Op
<
T
>::
myCadd
(
m_v®
,
v®
);

777  *
	gthis
;

779 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

780 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
-=(cÚ¡ 
V
& 
v®
)

782 
Op
<
T
>::
myCsub
(
m_v®
,
v®
);

783  *
	gthis
;

785 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

786 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
*=(cÚ¡ 
V
& 
v®
)

788 
Op
<
T
>::
myCmul
(
m_v®
,
v®
);

789 ià(!
	gthis
->
d•’d
())  *this;

790 
	gi
=0;i<
	gthis
->
size
();++iè
	gOp
<
	gT
>::
myCmul
(
m_diff
[
i
],
v®
);

791  *
	gthis
;

793 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

794 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gFTy³Name
<
	gT
,0>& FTy³Name<T,0>::
İ”©Ü
/=(cÚ¡ 
V
& 
v®
)

796 
Op
<
T
>::
myCdiv
(
m_v®
,
v®
);

797 ià(!
	gthis
->
d•’d
())  *this;

798 
	gi
=0;i<
	gthis
->
size
();++iè
	gOp
<
	gT
>::
myCdiv
(
m_diff
[
i
],
v®
);

799  *
	gthis
;

802 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gU
, 
	gN
>

803 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
pow1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,
N
>& 
b
)

805 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myPow
(
a
,
b
.
v®
()));

806 ià(!
	gb
.
d•’d
()è 
	gc
;

807 
T
 
tmp
(
c
.
v®
()*
Op
<T>::
myLog
(
a
));

808 
	gc
.
£tD•’d
(
b
);

809 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
tmp
*
b
[i];

810  
	gc
;

812 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gU
>

813 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
pow1
(cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,0>& 
b
)

815 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myPow
(
a
,
b
.
v®
()));

816 ià(!
	gb
.
d•’d
()è 
	gc
;

817 
T
 
tmp
(
c
.
v®
()*
Op
<T>::
myLog
(
a
));

818 
	gc
.
£tD•’d
(
b
);

819 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
tmp
*
b
[i];

820  
	gc
;

823 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gU
, 
	gN
>

824 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
pow2
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ 
U
& 
b
)

826 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myPow
(
a
.
v®
(),
b
));

827 ià(!
	ga
.
d•’d
()è 
	gc
;

828 
T
 
tmp
(
b
*
Op
<T>::
myPow
(
a
.
v®
(),b-Op<T>::
myOÃ
()));

829 
	gc
.
£tD•’d
(
a
);

830 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
tmp
*
a
[i];

831  
	gc
;

833 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gU
>

834 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
pow2
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ 
U
& 
b
)

836 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myPow
(
a
.
v®
(),
b
));

837 ià(!
	ga
.
d•’d
()è 
	gc
;

838 
T
 
tmp
(
b
*
Op
<T>::
myPow
(
a
.
v®
(),b-Op<T>::
myOÃ
()));

839 
	gc
.
£tD•’d
(
a
);

840 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
tmp
*
a
[i];

841  
	gc
;

844 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

845 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
pow
 (cÚ¡ 
U
& 
a
, cÚ¡ 
FTy³Name
<
T
,
N
>& 
b
)

847  
pow1
(
a
,
b
);

850 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
,y³Çm
	gU
>

851 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
pow
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
,cÚ¡ 
U
& 
b
)

853  
pow2
(
a
,
b
);

856 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

857 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
pow3
(cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ FTy³Name<T,N>& 
b
)

859 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myPow
(
a
.
v®
(),
b
.val()));

860 
T
 
tmp
(
b
.
v®
()*
Op
<T>::
myPow
(
a
.v®(),b.v®()-Op<T>::
myOÃ
())),
tmp1
(
c
.v®()*Op<T>::
myLog
(a.val()));

861 
	gc
.
£tD•’d
(
a
,
b
);

862 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
tmp
*
a
[i]+
tmp1
*
b
[i];

863  
	gc
;

865 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

866 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
pow3
(cÚ¡ 
FTy³Name
<
T
,0>& 
a
, cÚ¡ FTy³Name<T,0>& 
b
)

868 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myPow
(
a
.
v®
(),
b
.val()));

869 
T
 
tmp
(
b
.
v®
()*
Op
<T>::
myPow
(
a
.v®(),b.v®()-Op<T>::
myOÃ
())),
tmp1
(
c
.v®()*Op<T>::
myLog
(a.val()));

870 
	gc
.
£tD•’d
(
a
,
b
);

871 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
tmp
*
a
[i]+
tmp1
*
b
[i];

872  
	gc
;

875 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

876 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
pow
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
, cÚ¡ FTy³Name<T,N>& 
b
)

878 (
	ga
.
d•’d
()?1:0)|(
b
.depend()?2:0))

880 0:  
FTy³Name
<
T
,
	gN
>(
	gOp
<
	gT
>::
myPow
(
a
.
v®
(),
b
.val()));

881 1:  
pow2
(
a
,
b
.
v®
());

882 2:  
pow1
(
a
.
v®
(),
b
);

884  
pow3
(
a
,
b
);

888 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

889 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
+ (cÚ¡ FTy³Name<T,N>& 
	ga
)

891 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
a
.
v®
());

892 ià(!
	ga
.
d•’d
()è 
	gc
;

893 
	gc
.
£tD•’d
(
a
);

894 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i];

895  
	gc
;

897 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

898 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
	gİ”©Ü
+ (cÚ¡ FTy³Name<T,0>& 
	ga
)

900 
	gFTy³Name
<
	gT
,0> 
c
(
a
.
v®
());

901 ià(!
	ga
.
d•’d
()è 
	gc
;

902 
	gc
.
£tD•’d
(
a
);

903 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i];

904  
	gc
;

907 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

908 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
	gİ”©Ü
- (cÚ¡ FTy³Name<T,N>& 
	ga
)

910 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myNeg
(
a
.
v®
()));

911 ià(!
	ga
.
d•’d
()è 
	gc
;

912 
	gc
.
£tD•’d
(
a
);

913 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
Op
<
T
>::
myNeg
(
a
[i]);

914  
	gc
;

916 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

917 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
	gİ”©Ü
- (cÚ¡ FTy³Name<T,0>& 
	ga
)

919 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myNeg
(
a
.
v®
()));

920 ià(!
	ga
.
d•’d
()è 
	gc
;

921 
	gc
.
£tD•’d
(
a
);

922 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
Op
<
T
>::
myNeg
(
a
[i]);

923  
	gc
;

926 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

927 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
sqr
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

929 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
mySqr
(
a
.
v®
()));

930 ià(!
	ga
.
d•’d
()è 
	gc
;

931 
T
 
tmp
(
Op
<T>::
myTwo
()*
a
.
v®
());

932 
	gc
.
£tD•’d
(
a
);

933 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
tmp
;

934  
	gc
;

936 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

937 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
sqr
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

939 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
mySqr
(
a
.
v®
()));

940 ià(!
	ga
.
d•’d
()è 
	gc
;

941 
T
 
tmp
(
Op
<T>::
myTwo
()*
a
.
v®
());

942 
	gc
.
£tD•’d
(
a
);

943 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

944  
	gc
;

947 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

948 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
exp
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

950 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myExp
(
a
.
v®
()));

951 ià(!
	ga
.
d•’d
()è 
	gc
;

952 
	gc
.
£tD•’d
(
a
);

953 cÚ¡ 
	gT
& 
cv®
(
c
.
v®
());

954 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
cv®
;

955  
	gc
;

957 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

958 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
exp
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

960 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myExp
(
a
.
v®
()));

961 ià(!
	ga
.
d•’d
()è 
	gc
;

962 
	gc
.
£tD•’d
(
a
);

963 cÚ¡ 
	gT
& 
cv®
(
c
.
v®
());

964 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
cv®
;

965  
	gc
;

968 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

969 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
log
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

971 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myLog
(
a
.
v®
()));

972 ià(!
	ga
.
d•’d
()è 
	gc
;

973 
	gc
.
£tD•’d
(
a
);

974 cÚ¡ 
	gT
& 
av®
(
a
.
v®
());

975 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]/
av®
;

976  
	gc
;

978 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

979 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
log
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

981 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myLog
(
a
.
v®
()));

982 ià(!
	ga
.
d•’d
()è 
	gc
;

983 
	gc
.
£tD•’d
(
a
);

984 cÚ¡ 
	gT
& 
av®
(
a
.
v®
());

985 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]/
av®
;

986  
	gc
;

989 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

990 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
sq¹
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

992 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
mySq¹
(
a
.
v®
()));

993 ià(!
	ga
.
d•’d
()è 
	gc
;

994 
T
 
tmp
(
c
.
v®
()*
Op
<T>::
myTwo
());

995 
	gc
.
£tD•’d
(
a
);

996 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]/
tmp
;

997  
	gc
;

999 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1000 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
sq¹
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

1002 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
mySq¹
(
a
.
v®
()));

1003 ià(!
	ga
.
d•’d
()è 
	gc
;

1004 
T
 
tmp
(
c
.
v®
()*
Op
<T>::
myTwo
());

1005 
	gc
.
£tD•’d
(
a
);

1006 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]/
tmp
;

1007  
	gc
;

1010 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

1011 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
sš
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

1013 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
mySš
(
a
.
v®
()));

1014 ià(!
	ga
.
d•’d
()è 
	gc
;

1015 
T
 
tmp
(
Op
<T>::
myCos
(
a
.
v®
()));

1016 
	gc
.
£tD•’d
(
a
);

1017 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
tmp
;

1018  
	gc
;

1020 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1021 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
sš
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

1023 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
mySš
(
a
.
v®
()));

1024 ià(!
	ga
.
d•’d
()è 
	gc
;

1025 
T
 
tmp
(
Op
<T>::
myCos
(
a
.
v®
()));

1026 
	gc
.
£tD•’d
(
a
);

1027 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

1028  
	gc
;

1031 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

1032 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
cos
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

1034 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myCos
(
a
.
v®
()));

1035 ià(!
	ga
.
d•’d
()è 
	gc
;

1036 
T
 
tmp
(-
Op
<T>::
mySš
(
a
.
v®
()));

1037 
	gc
.
£tD•’d
(
a
);

1038 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
tmp
;

1039  
	gc
;

1041 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1042 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
cos
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

1044 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myCos
(
a
.
v®
()));

1045 ià(!
	ga
.
d•’d
()è 
	gc
;

1046 
T
 
tmp
(-
Op
<T>::
mySš
(
a
.
v®
()));

1047 
	gc
.
£tD•’d
(
a
);

1048 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

1049  
	gc
;

1052 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

1053 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
n
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

1055 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myTª
(
a
.
v®
()));

1056 ià(!
	ga
.
d•’d
()è 
	gc
;

1057 
T
 
tmp
(
Op
<T>::
myOÃ
()+Op<T>::
mySqr
(
c
.
v®
()));

1058 
	gc
.
£tD•’d
(
a
);

1059 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
tmp
;

1060  
	gc
;

1062 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1063 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
n
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

1065 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myTª
(
a
.
v®
()));

1066 ià(!
	ga
.
d•’d
()è 
	gc
;

1067 
T
 
tmp
(
Op
<T>::
myOÃ
()+Op<T>::
mySqr
(
c
.
v®
()));

1068 
	gc
.
£tD•’d
(
a
);

1069 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

1070  
	gc
;

1073 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

1074 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
asš
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

1076 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myAsš
(
a
.
v®
()));

1077 ià(!
	ga
.
d•’d
()è 
	gc
;

1078 
T
 
tmp
(
Op
<T>::
myInv
(Op<T>::
mySq¹
(Op<T>::
myOÃ
()-Op<T>::
mySqr
(
a
.
v®
()))));

1079 
	gc
.
£tD•’d
(
a
);

1080 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
tmp
;

1081  
	gc
;

1083 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1084 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
asš
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

1086 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myAsš
(
a
.
v®
()));

1087 ià(!
	ga
.
d•’d
()è 
	gc
;

1088 
T
 
tmp
(
Op
<T>::
myInv
(Op<T>::
mySq¹
(Op<T>::
myOÃ
()-Op<T>::
mySqr
(
a
.
v®
()))));

1089 
	gc
.
£tD•’d
(
a
);

1090 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

1091  
	gc
;

1094 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

1095 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
acos
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

1097 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myAcos
(
a
.
v®
()));

1098 ià(!
	ga
.
d•’d
()è 
	gc
;

1099 
T
 
tmp
(
Op
<T>::
myNeg
(Op<T>::
myInv
(Op<T>::
mySq¹
(Op<T>::
myOÃ
()-Op<T>::
mySqr
(
a
.
v®
())))));

1100 
	gc
.
£tD•’d
(
a
);

1101 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
tmp
;

1102  
	gc
;

1104 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1105 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
acos
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

1107 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myAcos
(
a
.
v®
()));

1108 ià(!
	ga
.
d•’d
()è 
	gc
;

1109 
T
 
tmp
(
Op
<T>::
myNeg
(Op<T>::
myInv
(Op<T>::
mySq¹
(Op<T>::
myOÃ
()-Op<T>::
mySqr
(
a
.
v®
())))));

1110 
	gc
.
£tD•’d
(
a
);

1111 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

1112  
	gc
;

1115 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gN
>

1116 
INLINE2
 
	gFTy³Name
<
	gT
,
	gN
> 
©ª
 (cÚ¡ 
FTy³Name
<
T
,
N
>& 
a
)

1118 
	gFTy³Name
<
	gT
,
	gN
> 
c
(
Op
<
T
>::
myAn
(
a
.
v®
()));

1119 ià(!
	ga
.
d•’d
()è 
	gc
;

1120 
T
 
tmp
(
Op
<T>::
myInv
(Op<T>::
myOÃ
()+Op<T>::
mySqr
(
a
.
v®
())));

1121 
	gc
.
£tD•’d
(
a
);

1122 
	gi
=0;i<
	gN
;++iè
	gc
[
i
]=
a
[i]*
tmp
;

1123  
	gc
;

1125 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1126 
INLINE2
 
	gFTy³Name
<
	gT
,0> 
©ª
 (cÚ¡ 
FTy³Name
<
T
,0>& 
a
)

1128 
	gFTy³Name
<
	gT
,0> 
c
(
Op
<
T
>::
myAn
(
a
.
v®
()));

1129 ià(!
	ga
.
d•’d
()è 
	gc
;

1130 
T
 
tmp
(
Op
<T>::
myInv
(Op<T>::
myOÃ
()+Op<T>::
mySqr
(
a
.
v®
())));

1131 
	gc
.
£tD•’d
(
a
);

1132 
	gi
=0;i<
	gc
.
size
();++ièc[
i
]=
a
[i]*
tmp
;

1133  
	gc
;

1136 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
	gOp
< 
	gFTy³Name
<U,N> >

1138 
	gFTy³Name
<
	tU
,
	tN
> 
	tT
;

1139 
	gFTy³Name
<
	tU
,
	tN
> 
	tUnd”lyšg
;

1140 
ty³Çme
 
	tOp
<
	tU
>::
	tBa£
 Base;

1141 
Ba£
 
myIÁeg”
(cÚ¡ 
i
) {  Base(i); }

1142 
Ba£
 
myZ”o
(è{  
myIÁeg”
(0); }

1143 
Ba£
 
myOÃ
(è{  
myIÁeg”
(1);}

1144 
Ba£
 
myTwo
(è{  
myIÁeg”
(2); }

1145 
Ba£
 
myPI
(è{  
	gOp
<
	gBa£
>::myPI(); }

1146 
T
 
myPos
(cÚ¡ T& 
x
è{  +
	gx
; }

1147 
T
 
myNeg
(cÚ¡ T& 
x
è{  -
	gx
; }

1148 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCadd
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
+=y; }

1149 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCsub
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
-=y; }

1150 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCmul
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
*=y; }

1151 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gT
& 
myCdiv
(
T
& 
x
, cÚ¡ 
V
& 
y
è{  
	gx
/=y; }

1152 
T
 
myInv
(cÚ¡ T& 
x
è{  
myOÃ
()/
	gx
; }

1153 
T
 
mySqr
(cÚ¡ T& 
x
è{  
	gçdbad
::
sqr
(x); }

1154 
	g‹m¶©e
 <
ty³Çme
 
	gX
,y³Çm
	gY
>

1155 
T
 
myPow
(cÚ¡ 
X
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gçdbad
::
pow
(x,y); }

1156 
T
 
mySq¹
(cÚ¡ T& 
x
è{  
	gçdbad
::
sq¹
(x); }

1157 
T
 
myLog
(cÚ¡ T& 
x
è{  
	gçdbad
::
log
(x); }

1158 
T
 
myExp
(cÚ¡ T& 
x
è{  
	gçdbad
::
exp
(x); }

1159 
T
 
mySš
(cÚ¡ T& 
x
è{  
	gçdbad
::
sš
(x); }

1160 
T
 
myCos
(cÚ¡ T& 
x
è{  
	gçdbad
::
cos
(x); }

1161 
T
 
myTª
(cÚ¡ T& 
x
è{  
	gçdbad
::
n
(x); }

1162 
T
 
myAsš
(cÚ¡ T& 
x
è{  
	gçdbad
::
asš
(x); }

1163 
T
 
myAcos
(cÚ¡ T& 
x
è{  
	gçdbad
::
acos
(x); }

1164 
T
 
myAn
(cÚ¡ T& 
x
è{  
	gçdbad
::
©ª
(x); }

1165 
boŞ
 
myEq
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
==y; }

1166 
boŞ
 
myNe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
!=y; }

1167 
boŞ
 
myLt
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
<
	gy
; }

1168 
boŞ
 
myLe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
<=y; }

1169 
boŞ
 
myGt
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
>
	gy
; }

1170 
boŞ
 
myGe
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
y
è{  
	gx
>=y; }

	@robot/FADBAD++/tadiff.h

30 #iâdeà
_TADIFF_H


31 
	#_TADIFF_H


	)

33 
	~<®gÜ™hm
>

35 #iâdeà
MaxL’gth


36 
	#MaxL’gth
 40

	)

39 
	~"çdbad.h
"

41 
Çme¥aû
 
	gçdbad


44 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

45 şas 
	cTV®ues


47 
	gm_n
;

48 
U
 
	gm_v®
[
N
];

49 
	gpublic
:

50 
TV®ues
():
m_n
(0){
¡d
::
fl
(
m_v®
,m_v®+
N
,
Op
<
U
>::
myZ”o
());}

51 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
ex¶ic™
 
TV®ues
(cÚ¡ 
V
& 
v®
):
m_n
(1){
m_v®
[0]=v®;
	g¡d
::
fl
(m_v®+1,m_v®+
N
,
Op
<
U
>::
myZ”o
());}

52 
	gU
& 
	gİ”©Ü
[](cÚ¡ 
	gi
)

54 
USER_ASSERT
(
i
<
N
,"Index "<<i<<" out of bounds [0,"<<N<<"]")

55  
	gm_v®
[
i
];

57 cÚ¡ 
	gU
& 
	gİ”©Ü
[](cÚ¡ 
	gi
) const

59 
USER_ASSERT
(
i
<
N
,"Index "<<i<<" out of bounds [0,"<<N<<"]")

60  
	gm_v®
[
i
];

62 
Ëngth
(ècÚ¡ {  
	gm_n
; }

63 & 
Ëngth
(è{  
	gm_n
; }

64 
»£t
(){ 
	gm_n
=0; }

67 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

68 şas 
	cTTy³NameHV


70 
	gTV®ues
<
	gU
,
	gN
> 
	gm_v®
;

71 
mubË
 
	gm_rc
;

72 
	g´Ùeùed
:

73 
vœtu®
 ~
TTy³NameHV
(){}

74 
public
:

75 
TTy³NameHV
():
m_rc
(0){}

76 
‹m¶©e
 <
ty³Çme
 
V
> 
ex¶ic™
 
TTy³NameHV
(cÚ¡ V& 
v®
):
m_v®
(v®),
m_rc
(0){}

77 cÚ¡ 
	gU
& 
v®
(cÚ¡ 
i
ècÚ¡ {  
	gm_v®
[i]; }

78 
	gU
& 
v®
(cÚ¡ 
i
è{  
	gm_v®
[i]; }

79 
Ëngth
(ècÚ¡ {  
	gm_v®
.length(); }

80 & 
Ëngth
(è{  
	gm_v®
.length(); }

81 
decRef
(
TTy³NameHV
<
U
,
N
>*& 
pTTy³NameHV
ècÚ¡ { ià(--
	gm_rc
==0è{ 
d–‘e
 
this
; 
	gpTTy³NameHV
=0;} }

82 
šcRef
(ècÚ¡ {++
	gm_rc
;}

84 
vœtu®
 
»£t
(){
	gm_v®
.reset();}

85 
vœtu®
 
ev®
(cÚ¡ 
k
){ 
	gk
+1;}

88 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
=
MaxL’gth
>

89 şas 
	cTTy³Name


91 
´iv©e
:

92 
	sSV


94 
mubË
 
TTy³NameHV
<
U
,
N
>* 
m_pTTy³NameHV
;

95 
SV
(
TTy³NameHV
<
U
,
N
>* 
pTTy³NameHV
):
m_pTTy³NameHV
ÕTTy³NameHV){ m_pTTy³NameHV->
šcRef
(); }

96 
SV
(cÚ¡ 
ty³Çme
 
TTy³Name
<
U
,
N
>::SV& 
sv
):
m_pTTy³NameHV
(sv.m_pTTy³NameHV){ m_pTTy³NameHV->
šcRef
(); }

97 ~
SV
(){ 
	gm_pTTy³NameHV
->
decRef
(
m_pTTy³NameHV
); }

98 
	gTTy³NameHV
<
	gU
,
	gN
>* 
g‘TTy³NameHV
(ècÚ¡ {  
	gm_pTTy³NameHV
; }

99 
£tTTy³NameHV
(
TTy³NameHV
<
U
,
N
>* 
pTTy³NameHV
)

101 ià(
	gm_pTTy³NameHV
!=
pTTy³NameHV
)

103 
m_pTTy³NameHV
->
decRef
(m_pTTypeNameHV);

104 
	gm_pTTy³NameHV
=
pTTy³NameHV
;

105 
	gm_pTTy³NameHV
->
šcRef
();

108 cÚ¡ 
	gU
& 
v®
(ècÚ¡ {  
	gm_pTTy³NameHV
->val(0); }

109 cÚ¡ 
	gU
& 
v®
(cÚ¡ 
i
ècÚ¡ {  
	gm_pTTy³NameHV
->val(i); }

110 
Ëngth
(ècÚ¡ {  
	gm_pTTy³NameHV
->length(); }

111 & 
Ëngth
(è{  
	gm_pTTy³NameHV
->length(); }

112 
	gU
& 
v®
(cÚ¡ 
i
è{  
	gm_pTTy³NameHV
->val(i); }

114 
»£t
(){
	gm_pTTy³NameHV
->reset();}

115 
ev®
(cÚ¡ 
i
){ 
	gm_pTTy³NameHV
->eval(i);}

116 } 
	gm_sv
;

117 
	gpublic
:

118 
U
 
	tUnd”lyšgTy³
;

119 
TTy³Name
():
m_sv
(
Ãw
 
TTy³NameHV
<
U
,
N
>()){}

120 
TTy³Name
(
TTy³NameHV
<
U
,
N
>* 
pTTy³NameHV
):
m_sv
(pTTypeNameHV){}

121 
ex¶ic™
 
TTy³Name
(cÚ¡ 
ty³Çme
 TTy³Name<
U
,
N
>::
SV
& 
sv
):
m_sv
(sv){}

122 
‹m¶©e
 <
ty³Çme
 
V
> 
TTy³Name
(cÚ¡ V& 
v®
):
m_sv
(
Ãw
 
TTy³NameHV
<
U
,
N
>(v®)){
	gm_sv
.
Ëngth
()=N;}

123 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
)

125 ià(
	gthis
==&
v®
è *
this
;

126 
	gm_sv
.
£tTTy³NameHV
(
v®
.
m_sv
.
g‘TTy³NameHV
());

127  *
	gthis
;

129 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
=(cÚ¡ 
V
& 
v®
)

131 
m_sv
.
£tTTy³NameHV
(
Ãw
 
TTy³NameHV
<
U
,
N
>(
v®
));

132 
	gm_sv
.
Ëngth
()=
N
;

133  *
	gthis
;

135 
	gTTy³NameHV
<
	gU
,
	gN
>* 
g‘TTy³NameHV
(ècÚ¡ {  
	gm_sv
.getTTypeNameHV(); }

136 
£tTTy³NameHV
(cÚ¡ 
TTy³NameHV
<
U
,
N
>* 
pTTy³NameHV
è{ 
	gm_sv
.setTTypeNameHV(pTTypeNameHV); }

137 cÚ¡ 
	gU
& 
v®
(ècÚ¡ {  
	gm_sv
.val(); }

138 
Ëngth
(ècÚ¡ {  
	gm_sv
.length(); }

139 cÚ¡ 
	gU
& 
	gİ”©Ü
[](cÚ¡ 
	gi
ècÚ¡ {  
	gm_sv
.
v®
(
i
); }

140 
	gU
& 
	gİ”©Ü
[](cÚ¡ 
	gi
è{ ià(i>=
m_sv
.
Ëngth
()èm_sv.Ëngth()=
i
+1;  
	gm_sv
.
v®
(i);}

142 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
+=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
);

143 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
-=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
);

144 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
*=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
);

145 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
/=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
);

146 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
+=(cÚ¡ 
V
& 
v®
);

147 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
-=(cÚ¡ 
V
& 
v®
);

148 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
*=(cÚ¡ 
V
& 
v®
);

149 
	g‹m¶©e
 <
ty³Çme
 
	gV
> 
	gTTy³Name
<
	gU
,
	gN
>& 
	gİ”©Ü
/=(cÚ¡ 
V
& 
v®
);

151 
»£t
(){
	gm_sv
.reset();}

152 
ev®
(cÚ¡ 
i
){ 
	gm_sv
.eval(i);}

155 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myEq
(
v®1
.
v®
(),
v®2
.val()); }

156 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myNe
(
v®1
.
v®
(),
v®2
.val()); }

157 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®1
, cÚ¡ TTy³Name<U,N>& 
	gv®2
è{  
	gOp
<U>::
myLt
(
v®1
.
v®
(),
v®2
.val()); }

158 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myLe
(
v®1
.
v®
(),
v®2
.val()); }

159 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®1
, cÚ¡ TTy³Name<U,N>& 
	gv®2
è{  
	gOp
<U>::
myGt
(
v®1
.
v®
(),
v®2
.val()); }

160 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myGe
(
v®1
.
v®
(),
v®2
.val()); }

161 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myEq
(
v®1
.
v®
(),
v®2
); }

162 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myEq
(v®1,
v®2
.
v®
()); }

163 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myNe
(
v®1
.
v®
(),
v®2
); }

164 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myNe
(v®1,
v®2
.
v®
()); }

165 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myLt
(
v®1
.
v®
(),
v®2
); }

166 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<(cÚ¡ V& 
	gv®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myLt
(
v®1
,
v®2
.
v®
()); }

167 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myLe
(
v®1
.
v®
(),
v®2
); }

168 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myLe
(v®1,
v®2
.
v®
()); }

169 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myGt
(
v®1
.
v®
(),
v®2
); }

170 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>(cÚ¡ V& 
	gv®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myGt
(
v®1
,
v®2
.
v®
()); }

171 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®1
, cÚ¡ V& 
	gv®2
è{  
	gOp
<U>::
myGe
(
v®1
.
v®
(),
v®2
); }

172 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
> 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
V
& 
v®1
, cÚ¡ 
	gTTy³Name
<U,N>& 
	gv®2
è{  
	gOp
<U>::
myGe
(v®1,
v®2
.
v®
()); }

176 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

177 
şass
 
	gBšTTy³NameHV
 : 
public
 
TTy³NameHV
<
U
,
	gN
>

179 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gm_pOp1
;

180 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gm_pOp2
;

181 
	gpublic
:

182 
BšTTy³NameHV
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):TTy³NameHV<U,
	gN
>(
	gv®
),
m_pOp1
ÕOp1),
m_pOp2
(pOp2)

184 
	gm_pOp1
->
šcRef
();
	gm_pOp2
->incRef();

186 
BšTTy³NameHV
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):TTy³NameHV<U,
	gN
>(),
m_pOp1
ÕOp1),
m_pOp2
(pOp2)

188 
	gm_pOp1
->
šcRef
();
	gm_pOp2
->incRef();

190 
	gvœtu®
 ~
BšTTy³NameHV
()

192 
	gm_pOp1
->
decRef
(
m_pOp1
);
	gm_pOp2
->decRef(
m_pOp2
);

194 
	gTTy³NameHV
<
	gU
,
	gN
>* 
İ1
(è{  
	gm_pOp1
; }

195 
	gTTy³NameHV
<
	gU
,
	gN
>* 
İ2
(è{  
	gm_pOp2
; }

197 
İ1Ev®
(cÚ¡ 
k
){ 
	gthis
->
İ1
()->
ev®
(k);}

198 
İ2Ev®
(cÚ¡ 
k
){ 
	gthis
->
İ2
()->
ev®
(k);}

199 cÚ¡ 
	gU
& 
İ1V®
(cÚ¡ 
k
è{ 
	gthis
->
İ1
()->
v®
(k);}

200 cÚ¡ 
	gU
& 
İ2V®
(cÚ¡ 
k
è{ 
	gthis
->
İ2
()->
v®
(k);}

201 
»£t
(){
İ1
()->»£t();
İ2
()->»£t();
	gTTy³NameHV
<
	gU
,
	gN
>::reset();}

206 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

207 
şass
 
	gUnTTy³NameHV
 : 
public
 
TTy³NameHV
<
U
,
	gN
>

209 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gm_pOp
;

210 
	gpublic
:

211 
UnTTy³NameHV
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):TTy³NameHV<U,
	gN
>(
	gv®
),
m_pOp
(pOp)

213 
	gm_pOp
->
šcRef
();

215 
UnTTy³NameHV
(
TTy³NameHV
<
U
,
N
>* 
pOp
):TTy³NameHV<U,
	gN
>(),
m_pOp
(pOp)

217 
	gm_pOp
->
šcRef
();

219 
	gvœtu®
 ~
UnTTy³NameHV
()

221 
	gm_pOp
->
decRef
(
m_pOp
);

223 
	gTTy³NameHV
<
	gU
,
	gN
>* 
İ
(è{  
	gm_pOp
; }

225 
İEv®
(cÚ¡ 
k
){ 
	gthis
->
İ
()->
ev®
(k);}

226 cÚ¡ 
	gU
& 
İV®
(cÚ¡ 
k
è{ 
	gthis
->
İ
()->
v®
(k);}

227 
»£t
(){
İ
()->»£t();
	gTTy³NameHV
<
	gU
,
	gN
>::reset();}

232 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

233 
	gTTy³NameADD
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

235 
TTy³NameADD
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
,
	gpOp2
){}

236 
TTy³NameADD
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp1
,
	gpOp2
){}

237 
ev®
(cÚ¡ 
k
)

239 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

240 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İ1V®
(i)+this->
İ2V®
(i);

241  
	gthis
->
Ëngth
()=
l
;

243 
	g´iv©e
:

244 
İ”©Ü
=(cÚ¡ 
TTy³NameADD
<
U
,
	gN
>&){}

246 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

247 
	gTTy³NameADD1
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

249 cÚ¡ 
V
 
	gm_a
;

250 
TTy³NameADD1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
TTy³NameHV
<U,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp2
),
m_a
(a){}

251 
TTy³NameADD1
(cÚ¡ 
V
& 
a
, 
TTy³NameHV
<
U
,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp2
),
m_a
(a){}

252 
ev®
(cÚ¡ 
k
)

254 
	gl
=
this
->
İEv®
(
k
);

255 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
m_a
+this->
İV®
(0); 
	gthis
->length()=1; }

256 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i);

257  
	gthis
->
Ëngth
()=
l
;

259 
	g´iv©e
:

260 
İ”©Ü
=(cÚ¡ 
TTy³NameADD1
<
U
,
	gN
,
	gV
>&){}

262 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

263 
	gTTy³NameADD2
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

265 cÚ¡ 
V
 
	gm_b
;

266 
TTy³NameADD2
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
),
m_b
(b){}

267 
TTy³NameADD2
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp1
),
m_b
(b){}

268 
ev®
(cÚ¡ 
k
)

270 
	gl
=
this
->
İEv®
(
k
);

271 ià(0==
this
->
Ëngth
()è{his->
v®
(0)ñhis->
İV®
(0)+
m_b
; 
	gthis
->length()=1; }

272 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i);

273  
	gthis
->
Ëngth
()=
l
;

275 
	g´iv©e
:

276 
İ”©Ü
=(cÚ¡ 
TTy³NameADD2
<
U
,
	gN
,
	gV
>&){}

278 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

279 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
+(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

281 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 && 
v®2
.length()>0 ?

282 
Ãw
 
TTy³NameADD
<
U
,
	gN
>(
	gv®1
.
v®
()+
	gv®2
.v®(),v®1.
g‘TTy³NameHV
(),val2.getTTypeNameHV()):

283 
Ãw
 
TTy³NameADD
<
U
,
	gN
>(
	gv®1
.
g‘TTy³NameHV
(),
	gv®2
.getTTypeNameHV());

284  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

320 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

321 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
+(cÚ¡ 
	gV
& 
	ga
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

323 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®2
.
Ëngth
()>0 ?

324 
Ãw
 
TTy³NameADD1
<
U
,
	gN
,
	gV
>(
	ga
+
	gv®2
.
v®
(),‡, v®2.
g‘TTy³NameHV
()):

325 
Ãw
 
TTy³NameADD1
<
U
,
	gN
,
	gV
>(
	ga
, 
	gv®2
.
g‘TTy³NameHV
());

326  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

328 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

329 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
+(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

331 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0?

332 
Ãw
 
TTy³NameADD2
<
U
,
	gN
,
	gV
>(
	gv®1
.
v®
()+
	gb
, v®1.
g‘TTy³NameHV
(), b):

333 
Ãw
 
TTy³NameADD2
<
U
,
	gN
,
	gV
>(
	gv®1
.
g‘TTy³NameHV
(), 
	gb
);

334  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

339 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

340 
	gTTy³NameSUB
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

342 
TTy³NameSUB
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
,
	gpOp2
){}

343 
TTy³NameSUB
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp1
,
	gpOp2
){}

344 
ev®
(cÚ¡ 
k
)

346 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

347 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İ1V®
(i)-this->
İ2V®
(i);

348  
	gthis
->
Ëngth
()=
l
;

350 
	g´iv©e
:

351 
İ”©Ü
=(cÚ¡ 
TTy³NameSUB
<
U
,
	gN
>&){}

353 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

354 
	gTTy³NameSUB1
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

356 cÚ¡ 
V
 
	gm_a
;

357 
TTy³NameSUB1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
TTy³NameHV
<U,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp2
),
m_a
(a){}

358 
TTy³NameSUB1
(cÚ¡ 
V
& 
a
, 
TTy³NameHV
<
U
,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp2
),
m_a
(a){}

359 
ev®
(cÚ¡ 
k
)

361 
	gl
=
this
->
İEv®
(
k
);

362 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
m_a
-this->
İV®
(0); 
	gthis
->length()=1; }

363 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)=
Op
<
U
>::
myNeg
Ñhis->
İV®
(i));

364  
	gthis
->
Ëngth
()=
l
;

366 
	g´iv©e
:

367 
İ”©Ü
=(cÚ¡ 
TTy³NameSUB1
<
U
,
	gN
,
	gV
>&){}

369 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

370 
	gTTy³NameSUB2
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

372 cÚ¡ 
V
 
	gm_b
;

373 
TTy³NameSUB2
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
),
m_b
(b){}

374 
TTy³NameSUB2
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp1
),
m_b
(b){}

375 
ev®
(cÚ¡ 
k
)

377 
	gl
=
this
->
İEv®
(
k
);

378 ià(0==
this
->
Ëngth
()è{his->
v®
(0)ñhis->
İV®
(0)-
m_b
; 
	gthis
->length()=1; }

379 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i);

380  
	gthis
->
Ëngth
()=
l
;

382 
	g´iv©e
:

383 
İ”©Ü
=(cÚ¡ 
TTy³NameSUB2
<
U
,
	gN
,
	gV
>&){}

385 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

386 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
-(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

388 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 && 
v®2
.length()>0 ?

389 
Ãw
 
TTy³NameSUB
<
U
,
	gN
>(
	gv®1
.
v®
()-
	gv®2
.v®(),v®1.
g‘TTy³NameHV
(),val2.getTTypeNameHV()):

390 
Ãw
 
TTy³NameSUB
<
U
,
	gN
>(
	gv®1
.
g‘TTy³NameHV
(),
	gv®2
.getTTypeNameHV());

391  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

427 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

428 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
-(cÚ¡ 
	gV
& 
	ga
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

430 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®2
.
Ëngth
()>0 ?

431 
Ãw
 
TTy³NameSUB1
<
U
,
	gN
,
	gV
>(
	ga
-
	gv®2
.
v®
(),‡, v®2.
g‘TTy³NameHV
()):

432 
Ãw
 
TTy³NameSUB1
<
U
,
	gN
,
	gV
>(
	ga
, 
	gv®2
.
g‘TTy³NameHV
());

433  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

435 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

436 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
-(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

438 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 ?

439 
Ãw
 
TTy³NameSUB2
<
U
,
	gN
,
	gV
>(
	gv®1
.
v®
()-
	gb
, v®1.
g‘TTy³NameHV
(), b):

440 
Ãw
 
TTy³NameSUB2
<
U
,
	gN
,
	gV
>(
	gv®1
.
g‘TTy³NameHV
(), 
	gb
);

441  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

446 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

447 
	gTTy³NameMUL
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

449 
TTy³NameMUL
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
,
	gpOp2
){}

450 
TTy³NameMUL
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp1
,
	gpOp2
){}

451 
ev®
(cÚ¡ 
k
)

453 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

454 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

456 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

457 
	gj
=0;j<=
i
;++j)

458 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
),this->
İ1V®
(
j
)*this->
İ2V®
(i-j));

460  
	gthis
->
Ëngth
()=
l
;

462 
	g´iv©e
:

463 
İ”©Ü
=(cÚ¡ 
TTy³NameMUL
<
U
,
	gN
>&){}

465 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

466 
	gTTy³NameMUL1
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

468 cÚ¡ 
V
 
	gm_a
;

469 
TTy³NameMUL1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
TTy³NameHV
<U,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp2
),
m_a
(a){}

470 
TTy³NameMUL1
(cÚ¡ 
V
& 
a
, 
TTy³NameHV
<
U
,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp2
),
m_a
(a){}

471 
ev®
(cÚ¡ 
k
)

473 
	gl
=
this
->
İEv®
(
k
);

474 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)=
m_a
*this->
İV®
(i);

475  
	gthis
->
Ëngth
()=
l
;

477 
	g´iv©e
:

478 
İ”©Ü
=(cÚ¡ 
TTy³NameMUL1
<
U
,
	gN
,
	gV
>&){}

480 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

481 
	gTTy³NameMUL2
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

483 cÚ¡ 
V
 
	gm_b
;

484 
TTy³NameMUL2
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
),
m_b
(b){}

485 
TTy³NameMUL2
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp1
),
m_b
(b){}

486 
ev®
(cÚ¡ 
k
)

488 
	gl
=
this
->
İEv®
(
k
);

489 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i)*
m_b
;

490  
	gthis
->
Ëngth
()=
l
;

492 
	g´iv©e
:

493 
İ”©Ü
=(cÚ¡ 
TTy³NameMUL2
<
U
,
	gN
,
	gV
>&){}

495 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

496 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
*(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

498 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 && 
v®2
.length()>0 ?

499 
Ãw
 
TTy³NameMUL
<
U
,
	gN
>(
	gv®1
.
v®
()*
	gv®2
.v®(),v®1.
g‘TTy³NameHV
(),val2.getTTypeNameHV()):

500 
Ãw
 
TTy³NameMUL
<
U
,
	gN
>(
	gv®1
.
g‘TTy³NameHV
(),
	gv®2
.getTTypeNameHV());

501  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

537 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

538 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
*(cÚ¡ 
	gV
& 
	ga
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

540 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®2
.
Ëngth
()>0 ?

541 
Ãw
 
TTy³NameMUL1
<
U
,
	gN
,
	gV
>(
a
*
	gv®2
.
v®
(), 
	ga
, v®2.
g‘TTy³NameHV
()):

542 
Ãw
 
TTy³NameMUL1
<
U
,
	gN
,
	gV
>(
	ga
, 
	gv®2
.
g‘TTy³NameHV
());

543  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

545 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

546 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
*(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

548 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 ?

549 
Ãw
 
TTy³NameMUL2
<
U
,
	gN
,
	gV
>(
	gv®1
.
v®
()*
	gb
, v®1.
g‘TTy³NameHV
(), b):

550 
Ãw
 
TTy³NameMUL2
<
U
,
	gN
,
	gV
>(
	gv®1
.
g‘TTy³NameHV
(), 
	gb
);

551  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

556 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

557 
	gTTy³NameDIV
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

559 
TTy³NameDIV
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
,
	gpOp2
){}

560 
TTy³NameDIV
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, TTy³NameHV<U,N>* 
pOp2
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp1
,
	gpOp2
){}

561 
ev®
(cÚ¡ 
k
)

563 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

564 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

566 
	gthis
->
v®
(
i
)=
this
->
İ1V®
(i);

567 
	gj
=1;j<=
i
;++jè
	gOp
<
	gU
>::
myCsub
(
this
->
v®
(i),this->
İ2V®
(
j
)*this->val(i-j));

568 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
),his->
İ2V®
(0));

570  
	gthis
->
Ëngth
()=
l
;

572 
	g´iv©e
:

573 
İ”©Ü
=(cÚ¡ 
TTy³NameDIV
<
U
,
	gN
>&){}

575 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

576 
	gTTy³NameDIV1
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

578 cÚ¡ 
V
 
	gm_a
;

579 
TTy³NameDIV1
(cÚ¡ 
U
& 
v®
, cÚ¡ 
V
& 
a
, 
TTy³NameHV
<U,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp2
),
m_a
(a){}

580 
TTy³NameDIV1
(cÚ¡ 
V
& 
a
, 
TTy³NameHV
<
U
,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp2
),
m_a
(a){}

581 
ev®
(cÚ¡ 
k
)

583 
	gl
=
this
->
İEv®
(
k
);

584 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
m_a
/this->
İV®
(0); 
	gthis
->length()=1; }

585 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

587 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

588 
	gj
=1;j<=
i
;++jè
	gOp
<
	gU
>::
myCsub
(
this
->
v®
(i),this->
İV®
(
j
)*this->val(i-j));

589 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
),his->
İV®
(0));

591  
	gthis
->
Ëngth
()=
l
;

593 
	g´iv©e
:

594 
İ”©Ü
=(cÚ¡ 
TTy³NameDIV1
<
U
,
	gN
,
	gV
>&){}

596 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

597 
	gTTy³NameDIV2
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

599 cÚ¡ 
V
 
	gm_b
;

600 
TTy³NameDIV2
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
),
m_b
(b){}

601 
TTy³NameDIV2
(
TTy³NameHV
<
U
,
N
>* 
pOp1
, cÚ¡ 
V
& 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp1
),
m_b
(b){}

602 
ev®
(cÚ¡ 
k
)

604 
	gl
=
this
->
İEv®
(
k
);

605 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i)/
m_b
;

606  
	gthis
->
Ëngth
()=
l
;

608 
	g´iv©e
:

609 
İ”©Ü
=(cÚ¡ 
TTy³NameDIV2
<
U
,
	gN
,
	gV
>&){}

611 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

612 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
/(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

614 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 && 
v®2
.length()>0 ?

615 
Ãw
 
TTy³NameDIV
<
U
,
	gN
>(
	gv®1
.
v®
()/
	gv®2
.v®(),v®1.
g‘TTy³NameHV
(),val2.getTTypeNameHV()):

616 
Ãw
 
TTy³NameDIV
<
U
,
	gN
>(
	gv®1
.
g‘TTy³NameHV
(),
	gv®2
.getTTypeNameHV());

617  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

653 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

654 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
/(cÚ¡ 
	gV
& 
	ga
, cÚ¡ TTy³Name<U,N>& 
	gv®2
)

656 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®2
.
Ëngth
()>0 ?

657 
Ãw
 
TTy³NameDIV1
<
U
,
	gN
,
	gV
>(
	ga
/
	gv®2
.
v®
(),‡, v®2.
g‘TTy³NameHV
()):

658 
Ãw
 
TTy³NameDIV1
<
U
,
	gN
,
	gV
>(
	ga
, 
	gv®2
.
g‘TTy³NameHV
());

659  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

661 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

662 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
/(cÚ¡ TTy³Name<U,N>& 
	gv®1
, cÚ¡ 
	gV
& 
	gb
)

664 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 ?

665 
Ãw
 
TTy³NameDIV2
<
U
,
	gN
,
	gV
>(
	gv®1
.
v®
()/
	gb
, v®1.
g‘TTy³NameHV
(), b):

666 
Ãw
 
TTy³NameDIV2
<
U
,
	gN
,
	gV
>(
	gv®1
.
g‘TTy³NameHV
(), 
	gb
);

667  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

672 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
+=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
è{  (*
	gthis
)=(*
this
)+
v®
; }

673 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
-=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
è{  (*
	gthis
)=(*
this
)-
v®
; }

674 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
*=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
è{  (*
	gthis
)=(*
this
)*
v®
; }

675 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
/=(cÚ¡ 
TTy³Name
<
U
,N>& 
	gv®
è{  (*
	gthis
)=(*
this
)/
v®
; }

676 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>em¶©<ty³Çm
	gV
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
+=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)+val; }

677 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>em¶©<ty³Çm
	gV
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
-=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)-val; }

678 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>em¶©<ty³Çm
	gV
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
*=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)*val; }

679 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>em¶©<ty³Çm
	gV
> 
	gTTy³Name
<U,N>& TTy³Name<U,N>::
İ”©Ü
/=(cÚ¡ 
V
& 
v®
è{  (*
this
)=(*this)/val; }

683 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

684 
	gTTy³NameUMINUS
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

686 
TTy³NameUMINUS
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){}

687 
TTy³NameUMINUS
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

688 
ev®
(cÚ¡ 
k
)

690 
	gl
=
this
->
İEv®
(
k
);

691 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)=
Op
<
U
>::
myNeg
Ñhis->
İV®
(i));

692  
	gthis
->
Ëngth
()=
l
;

694 
	g´iv©e
:

695 
İ”©Ü
=(cÚ¡ 
TTy³NameUMINUS
<
U
,
	gN
>&){}

698 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

699 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
-(cÚ¡ TTy³Name<U,N>& 
	gv®
)

701 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

702 
Ãw
 
TTy³NameUMINUS
<
U
,
	gN
>(
	gOp
<
	gU
>::
myNeg
(
v®
.v®()),
	gv®
.
g‘TTy³NameHV
()) :

703 
Ãw
 
TTy³NameUMINUS
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

704  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

709 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

710 
	gTTy³NameUPLUS
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

712 
TTy³NameUPLUS
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){}

713 
TTy³NameUPLUS
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

714 
ev®
(cÚ¡ 
k
)

716 
	gl
=
this
->
İEv®
(
k
);

717 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)=+this->
İV®
(i);

718  
	gthis
->
Ëngth
()=
l
;

720 
	g´iv©e
:

721 
İ”©Ü
=(cÚ¡ 
TTy³NameUPLUS
<
U
,
	gN
>&){}

724 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

725 
	gTTy³Name
<
	gU
,
	gN
> 
	gİ”©Ü
+(cÚ¡ TTy³Name<U,N>& 
	gv®
)

727 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

728 
Ãw
 
TTy³NameUPLUS
<
U
,
	gN
>(+
	gv®
.
v®
(),v®.
g‘TTy³NameHV
()) :

729 
Ãw
 
TTy³NameUPLUS
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

730  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

735 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

736 
	gTTy³NamePOW
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

738 
TTy³NamePOW
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){}

739 
TTy³NamePOW
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

740 
ev®
(cÚ¡ 
k
)

742 
	gl
=
this
->
İEv®
(
k
);

743 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i);

744  
	gthis
->
Ëngth
()=
l
;

746 
	g´iv©e
:

747 
İ”©Ü
=(cÚ¡ 
TTy³NamePOW
<
U
,
	gN
>&){}

749 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

750 
	gTTy³NamePOW1
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

752 
TTy³NamePOW1
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp2
){}

753 
TTy³NamePOW1
(
TTy³NameHV
<
U
,
N
>* 
pOp2
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp2
){}

754 
ev®
(cÚ¡ 
k
)

756 
	gl
=
this
->
İEv®
(
k
);

757 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i);

758  
	gthis
->
Ëngth
()=
l
;

760 
	g´iv©e
:

761 
İ”©Ü
=(cÚ¡ 
TTy³NamePOW1
<
U
,
	gN
,
	gV
>&){}

763 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

764 
	gTTy³NamePOW2
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

766 
TTy³NamePOW2
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp1
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp1
){}

767 
TTy³NamePOW2
(
TTy³NameHV
<
U
,
N
>* 
pOp1
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp1
){}

768 
ev®
(cÚ¡ 
k
)

770 
	gl
=
this
->
İEv®
(
k
);

771 
	gi
=
this
->
Ëngth
();i<
	gl
;++iè
	gthis
->
v®
(
i
)ñhis->
İV®
(i);

772  
	gthis
->
Ëngth
()=
l
;

774 
	g´iv©e
:

775 
İ”©Ü
=(cÚ¡ 
TTy³NamePOW2
<
U
,
	gN
,
	gV
>&){}

777 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

778 
	gTTy³Name
<
	gU
,
	gN
> 
pow
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®1
, cÚ¡ TTy³Name<U,N>& 
v®2
)

780 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
exp
(
v®2
*
log
(
v®1
)));

781 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 && 
v®2
.length()>0 ?

782 
Ãw
 
TTy³NamePOW
<
U
,
	gN
>(
	gOp
<
	gU
>::
myPow
(
v®1
.
v®
(),
v®2
.v®()),
	gtmp
.
g‘TTy³NameHV
()) :

783 
Ãw
 
TTy³NamePOW
<
U
,
	gN
>(
	gtmp
.
g‘TTy³NameHV
());

784  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

824 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

825 
	gTTy³Name
<
	gU
,
	gN
> 
pow
(cÚ¡ 
V
& 
a
, cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®2
)

827 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
exp
(
v®2
*
Op
<
V
>::
myLog
(
a
)));

828 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®2
.
Ëngth
()>0 ?

829 
Ãw
 
TTy³NamePOW1
<
U
,
	gN
,
	gV
>(
	gOp
<
	gU
>::
myPow
(
a
,
v®2
.
v®
()), 
	gtmp
.
g‘TTy³NameHV
()) :

830 
Ãw
 
TTy³NamePOW1
<
U
,
	gN
,
	gV
>(
	gtmp
.
g‘TTy³NameHV
());

831  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

833 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
,y³Çm
	gV
>

834 
	gTTy³Name
<
	gU
,
	gN
> 
pow
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®1
, cÚ¡ 
V
& 
b
)

836 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
exp
(
b
*
log
(
v®1
)));

837 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®1
.
Ëngth
()>0 ?

838 
Ãw
 
TTy³NamePOW2
<
U
,
	gN
,
	gV
>(
	gOp
<
	gU
>::
myPow
(
v®1
.
v®
(),
b
), 
	gtmp
.
g‘TTy³NameHV
()) :

839 
Ãw
 
TTy³NamePOW2
<
U
,
	gN
,
	gV
>(
	gtmp
.
g‘TTy³NameHV
());

840  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

845 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

846 
	gTTy³NameSQR
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

848 
TTy³NameSQR
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){}

849 
TTy³NameSQR
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

850 
ev®
(cÚ¡ 
k
)

852 
	gl
=
this
->
İEv®
(
k
);

853 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
mySqr
Ñhis->
İV®
(0)); 
	gthis
->length()=1; }

854 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

856 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

857 
	gm
=(
i
+1)/2;

858 
	gj
=0;j<
	gm
;++jè
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
),his->
İV®
(i-
j
)*this->opVal(j));

859 
	gOp
<
	gU
>::
myCmul
(
this
->
v®
(
i
), 
Op
<
U
>::
myTwo
());

860 ià(0==
i
%2è
Op
<
U
>::
myCadd
(
this
->
v®
(i), Op<U>::
mySqr
Ñhis->
İV®
(
m
)));

862  
	gthis
->
Ëngth
()=
l
;

864 
	g´iv©e
:

865 
İ”©Ü
=(cÚ¡ 
TTy³NameSQR
<
U
,
	gN
>&){}

867 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

868 
	gTTy³Name
<
	gU
,
	gN
> 
sqr
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

870 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

871 
Ãw
 
TTy³NameSQR
<
U
,
	gN
>(
	gOp
<
	gU
>::
mySqr
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
()) :

872 
Ãw
 
TTy³NameSQR
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

873  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

878 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

879 
	gTTy³NameSQRT
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

881 
TTy³NameSQRT
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){}

882 
TTy³NameSQRT
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

883 
ev®
(cÚ¡ 
k
)

885 
	gl
=
this
->
İEv®
(
k
);

886 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
mySq¹
Ñhis->
İV®
(0)); 
	gthis
->length()=1; }

887 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

889 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

890 
	gm
=(
i
+1)/2;

891 
	gj
=1;j<
	gm
;++jè
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
),his->v®(i-
j
)*this->val(j));

892 
	gOp
<
	gU
>::
myCmul
(
this
->
v®
(
i
), 
Op
<
U
>::
myTwo
());

893 ià(0==
i
%2è
Op
<
U
>::
myCadd
(
this
->
v®
(i), Op<U>::
mySqr
Ñhis->v®(
m
)));

894 
	gthis
->
v®
(
i
)=(
this
->
İV®
(i)-this->v®(i))/(
Op
<
U
>::
myTwo
()*this->val(0));

896  
	gthis
->
Ëngth
()=
l
;

898 
	g´iv©e
:

899 
İ”©Ü
=(cÚ¡ 
TTy³NameSQRT
<
U
,
	gN
>&){}

901 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

902 
	gTTy³Name
<
	gU
,
	gN
> 
sq¹
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

904 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

905 
Ãw
 
TTy³NameSQRT
<
U
,
	gN
>(
	gOp
<
	gU
>::
mySq¹
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
()):

906 
Ãw
 
TTy³NameSQRT
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

907  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

912 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

913 
	gTTy³NameEXP
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

915 
TTy³NameEXP
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){}

916 
TTy³NameEXP
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

917 
ev®
(cÚ¡ 
k
)

919 
	gl
=
this
->
İEv®
(
k
);

920 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
myExp
Ñhis->
İV®
(0)); 
	gthis
->length()=1; }

921 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

923 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

924 
	gj
=0;j<
	gi
;++j)

925 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
), (
Op
<
U
>::
myOÃ
()-Op<U>::
myIÁeg”
(
j
) /

926 
Op
<
U
>::
myIÁeg”
(
i
))*
this
->
İV®
(i-
j
)*this->
v®
(j));

928  
	gthis
->
Ëngth
()=
l
;

930 
	g´iv©e
:

931 
İ”©Ü
=(cÚ¡ 
TTy³NameEXP
<
U
,
	gN
>&){}

933 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

934 
	gTTy³Name
<
	gU
,
	gN
> 
exp
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

936 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

937 
Ãw
 
TTy³NameEXP
<
U
,
	gN
>(
	gOp
<
	gU
>::
myExp
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
()):

938 
Ãw
 
TTy³NameEXP
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

939  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

944 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

945 
	gTTy³NameLOG
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

947 
TTy³NameLOG
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){}

948 
TTy³NameLOG
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

949 
ev®
(cÚ¡ 
k
)

951 
	gl
=
this
->
İEv®
(
k
);

952 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
myLog
Ñhis->
İV®
(0)); 
	gthis
->length()=1; }

953 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

955 
	gthis
->
v®
(
i
)=
this
->
İV®
(i);

956 
	gj
=1;j<
	gi
;++j)

957 
	gOp
<
	gU
>::
myCsub
(
this
->
v®
(
i
), (
Op
<
U
>::
myOÃ
()-Op<U>::
myIÁeg”
(
j
) /

958 
Op
<
U
>::
myIÁeg”
(
i
))*
this
->
İV®
(
j
)*this->
v®
(i-j));

959 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
),his->
İV®
(0));

961  
	gthis
->
Ëngth
()=
l
;

963 
	g´iv©e
:

964 
İ”©Ü
=(cÚ¡ 
TTy³NameLOG
<
U
,
	gN
>&){}

966 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

967 
	gTTy³Name
<
	gU
,
	gN
> 
log
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

969 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

970 
Ãw
 
TTy³NameLOG
<
U
,
	gN
>(
	gOp
<
	gU
>::
myLog
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
()):

971 
Ãw
 
TTy³NameLOG
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

972  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

977 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

978 
	gTTy³NameSIN
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

980 
U
 
	gm_COS
[
N
];

981 
TTy³NameSIN
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){
	gm_COS
[0]=
Op
<U>::
myCos
(
this
->
İV®
(0));}

982 
TTy³NameSIN
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

983 
ev®
(cÚ¡ 
k
)

985 
	gl
=
this
->
İEv®
(
k
);

986 ià(0==
this
->
Ëngth
())

988 
this
->
v®
(0)=
Op
<
U
>::
mySš
Ñhis->
İV®
(0));

989 
	gm_COS
[0]=
Op
<
U
>::
myCos
(
this
->
İV®
(0));

990 
	gthis
->
Ëngth
()=1;

992 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

994 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

995 
	gj
=0;j<
	gi
;++j)

996 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(
j
+1)*
m_COS
[i-1-j]*this->
İV®
(j+1));

997 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(i));

998 
	gm_COS
[
i
]=
Op
<
U
>::
myZ”o
();

999 
	gj
=0;j<
	gi
;++j)

1000 
	gOp
<
	gU
>::
myCsub
(
m_COS
[
i
], 
Op
<
U
>::
myIÁeg”
(
j
+1)*
this
->
v®
(i-1-j)*this->
İV®
(j+1));

1001 
	gOp
<
	gU
>::
myCdiv
(
m_COS
[
i
], 
Op
<
U
>::
myIÁeg”
(i));

1003  
	gthis
->
Ëngth
()=
l
;

1005 
	g´iv©e
:

1006 
İ”©Ü
=(cÚ¡ 
TTy³NameSIN
<
U
,
	gN
>&){}

1008 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1009 
	gTTy³Name
<
	gU
,
	gN
> 
sš
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

1011 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

1012 
Ãw
 
TTy³NameSIN
<
U
,
	gN
>(
	gOp
<
	gU
>::
mySš
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
()):

1013 
Ãw
 
TTy³NameSIN
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

1014  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

1019 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1020 
	gTTy³NameCOS
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

1022 
U
 
	gm_SIN
[
N
];

1023 
TTy³NameCOS
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
){
	gm_SIN
[0]=
Op
<U>::
mySš
(
this
->
İV®
(0));}

1024 
TTy³NameCOS
(
TTy³NameHV
<
U
,
N
>* 
pOp
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
){}

1025 
ev®
(cÚ¡ 
k
)

1027 
	gl
=
this
->
İEv®
(
k
);

1028 ià(0==
this
->
Ëngth
())

1030 
this
->
v®
(0)=
Op
<
U
>::
myCos
Ñhis->
İV®
(0));

1031 
	gm_SIN
[0]=
Op
<
U
>::
mySš
(
this
->
İV®
(0));

1032 
	gthis
->
Ëngth
()=1;

1034 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

1036 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

1037 
	gj
=0;j<
	gi
;++j)

1038 
	gOp
<
	gU
>::
myCsub
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(
j
+1)*
m_SIN
[i-1-j]*this->
İV®
(j+1));

1039 
	gOp
<
	gU
>::
myCdiv
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(i));

1040 
	gm_SIN
[
i
]=
Op
<
U
>::
myZ”o
();

1041 
	gj
=0;j<
	gi
;++j)

1042 
	gOp
<
	gU
>::
myCadd
(
m_SIN
[
i
], 
Op
<
U
>::
myIÁeg”
(
j
+1)*
this
->
v®
(i-1-j)*this->
İV®
(j+1));

1043 
	gOp
<
	gU
>::
myCdiv
(
m_SIN
[
i
], 
Op
<
U
>::
myIÁeg”
(i));

1045  
	gthis
->
Ëngth
()=
l
;

1047 
	g´iv©e
:

1048 
İ”©Ü
=(cÚ¡ 
TTy³NameCOS
<
U
,
	gN
>&){}

1050 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1051 
	gTTy³Name
<
	gU
,
	gN
> 
cos
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

1053 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

1054 
Ãw
 
TTy³NameCOS
<
U
,
	gN
>(
	gOp
<
	gU
>::
myCos
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
()):

1055 
Ãw
 
TTy³NameCOS
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
());

1056  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

1061 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1062 
	gTTy³NameTAN
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

1064 
TTy³NameTAN
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
, TTy³NameHV<U,N>* 
pSqrCos
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
,
	gpSqrCos
){}

1065 
TTy³NameTAN
(
TTy³NameHV
<
U
,
N
>* 
pOp
, TTy³NameHV<U,N>* 
pSqrCos
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp
,
	gpSqrCos
){}

1066 
ev®
(cÚ¡ 
k
)

1068 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

1069 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
myTª
Ñhis->
İ1V®
(0)); 
	gthis
->length()=1; }

1070 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

1072 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

1073 
	gj
=1;j<
	gi
;++j)

1074 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(
j
)*this->v®(j)*this->
İ2V®
(i-j));

1075 
	gthis
->
v®
(
i
)=(
this
->
İ1V®
(i)-this->v®(i)/
Op
<
U
>::
myIÁeg”
(i))/this->
İ2V®
(0);

1077  
	gthis
->
Ëngth
()=
l
;

1079 
	g´iv©e
:

1080 
İ”©Ü
=(cÚ¡ 
TTy³NameTAN
<
U
,
	gN
>&){}

1082 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1083 
	gTTy³Name
<
	gU
,
	gN
> 
n
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

1085 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
sqr
(
cos
(
v®
)));

1086 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

1087 
Ãw
 
TTy³NameTAN
<
U
,
	gN
>(
	gOp
<
	gU
>::
myTª
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV()):

1088 
Ãw
 
TTy³NameTAN
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV());

1089  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

1094 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1095 
	gTTy³NameASIN
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

1097 
TTy³NameASIN
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
, TTy³NameHV<U,N>* 
pSq¹
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
,
	gpSq¹
){}

1098 
TTy³NameASIN
(
TTy³NameHV
<
U
,
N
>* 
pOp
, TTy³NameHV<U,N>* 
pSq¹
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp
,
	gpSq¹
){}

1099 
ev®
(cÚ¡ 
k
)

1101 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

1102 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
myAsš
Ñhis->
İ1V®
(0)); 
	gthis
->length()=1; }

1103 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

1105 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

1106 
	gj
=1;j<
	gi
;++j)

1107 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(
j
)*this->v®(j)*this->
İ2V®
(i-j));

1108 
	gthis
->
v®
(
i
)=(
this
->
İ1V®
(i)-this->v®(i)/
Op
<
U
>::
myIÁeg”
(i))/this->
İ2V®
(0);

1110  
	gthis
->
Ëngth
()=
l
;

1112 
	g´iv©e
:

1113 
İ”©Ü
=(cÚ¡ 
TTy³NameASIN
<
U
,
	gN
>&){}

1115 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1116 
	gTTy³Name
<
	gU
,
	gN
> 
asš
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

1118 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
sq¹
(
Op
<
U
>::
myOÃ
()-
sqr
(
v®
)));

1119 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

1120 
Ãw
 
TTy³NameASIN
<
U
,
	gN
>(
	gOp
<
	gU
>::
myAsš
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV()):

1121 
Ãw
 
TTy³NameASIN
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV());

1122  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

1127 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1128 
	gTTy³NameACOS
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

1130 
TTy³NameACOS
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
, TTy³NameHV<U,N>* 
pSq¹
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
,
	gpSq¹
){}

1131 
TTy³NameACOS
(
TTy³NameHV
<
U
,
N
>* 
pOp
, TTy³NameHV<U,N>* 
pSq¹
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp
,
	gpSq¹
){}

1132 
ev®
(cÚ¡ 
k
)

1134 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

1135 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
myAcos
Ñhis->
İ1V®
(0)); 
	gthis
->length()=1; }

1136 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

1138 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

1139 
	gj
=1;j<
	gi
;++j)

1140 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(
j
)*this->v®(j)*this->
İ2V®
(i-j));

1141 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myNeg
((
this
->
İ1V®
(i)+this->v®(i)/Op<U>::
myIÁeg”
(i))/this->
İ2V®
(0));

1143  
	gthis
->
Ëngth
()=
l
;

1145 
	g´iv©e
:

1146 
İ”©Ü
=(cÚ¡ 
TTy³NameACOS
<
U
,
	gN
>&){}

1148 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1149 
	gTTy³Name
<
	gU
,
	gN
> 
acos
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

1151 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
sq¹
(
Op
<
U
>::
myOÃ
()-
sqr
(
v®
)));

1152 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

1153 
Ãw
 
TTy³NameACOS
<
U
,
	gN
>(
	gOp
<
	gU
>::
myAcos
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV()):

1154 
Ãw
 
TTy³NameACOS
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV());

1155  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

1160 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1161 
	gTTy³NameATAN
 : 
public
 
BšTTy³NameHV
<
U
,
	gN
>

1163 
TTy³NameATAN
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
, TTy³NameHV<U,N>* 
p1pSqr
):
BšTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
,
	gp1pSqr
){}

1164 
TTy³NameATAN
(
TTy³NameHV
<
U
,
N
>* 
pOp
, TTy³NameHV<U,N>* 
p1pSqr
):
BšTTy³NameHV
<U,
	gN
>(
	gpOp
,
	gp1pSqr
){}

1165 
ev®
(cÚ¡ 
k
)

1167 
	gl
=
¡d
::
mš
(
this
->
İ1Ev®
(
k
),this->
İ2Ev®
(k));

1168 ià(0==
this
->
Ëngth
()è{his->
v®
(0)=
Op
<
U
>::
myAn
Ñhis->
İ1V®
(0)); 
	gthis
->length()=1; }

1169 
	gi
=
this
->
Ëngth
();i<
	gl
;++i)

1171 
	gthis
->
v®
(
i
)=
Op
<
U
>::
myZ”o
();

1172 
	gj
=1;j<
	gi
;++j)

1173 
	gOp
<
	gU
>::
myCadd
(
this
->
v®
(
i
), 
Op
<
U
>::
myIÁeg”
(
j
)*this->v®(j)*this->
İ2V®
(i-j));

1174 
	gthis
->
v®
(
i
)=(
this
->
İ1V®
(i)-this->v®(i)/
Op
<
U
>::
myIÁeg”
(i))/this->
İ2V®
(0);

1176  
	gthis
->
Ëngth
()=
l
;

1178 
	g´iv©e
:

1179 
İ”©Ü
=(cÚ¡ 
TTy³NameATAN
<
U
,
	gN
>&){}

1181 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1182 
	gTTy³Name
<
	gU
,
	gN
> 
©ª
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
)

1184 
	gTTy³Name
<
	gU
,
	gN
> 
tmp
(
Op
<
U
>::
myOÃ
()+
sqr
(
v®
));

1185 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=
v®
.
Ëngth
()>0 ?

1186 
Ãw
 
TTy³NameATAN
<
U
,
	gN
>(
	gOp
<
	gU
>::
myAn
(
v®
.v®()), 
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV()):

1187 
Ãw
 
TTy³NameATAN
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
(), 
	gtmp
.getTTypeNameHV());

1188  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

1193 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1194 
	gDIFF
 : 
public
 
UnTTy³NameHV
<
U
,
	gN
>

1196 
	gm_b
;

1197 
DIFF
(cÚ¡ 
U
& 
v®
, 
TTy³NameHV
<U,
N
>* 
pOp
, cÚ¡ 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gv®
,
	gpOp
),
m_b
(b){}

1198 
DIFF
(
TTy³NameHV
<
U
,
N
>* 
pOp
, cÚ¡ 
b
):
UnTTy³NameHV
<U,
	gN
>(
	gpOp
),
m_b
(b){}

1199 
ev®
(cÚ¡ 
k
)

1203 
	gl
=
this
->
İEv®
(
k
+
m_b
);

1207 ià(
	gthis
->
Ëngth
()+
	gm_b
<
	gl
)

1209 
	gi
=
this
->
Ëngth
();i<
	gl
-
	gm_b
;++i)

1211 
	gçù
=1;

1212 
	gj
=
i
+
m_b
;j>
	gi
;--j){ 
	gçù
*=
j
; }

1213 
	gthis
->
v®
(
i
)=
this
->
İV®
(i+
m_b
)*
çù
;

1215 
	gthis
->
Ëngth
()=
l
-
m_b
;

1217  
	gthis
->
Ëngth
();

1219 
	g´iv©e
:

1220 
İ”©Ü
=(cÚ¡ 
DIFF
<
U
,
	gN
>&){}

1222 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
>

1223 
	gTTy³Name
<
	gU
,
	gN
> 
diff
(cÚ¡ 
TTy³Name
<
U
,
N
>& 
v®
, cÚ¡ 
b
)

1229 
	gTTy³NameHV
<
	gU
,
	gN
>* 
	gpHV
=0;

1230 ià(
	gv®
.
Ëngth
()>
	gb
)

1232 
	gçù
=1;

1233 
	gj
=
b
;j>1;--j){ 
	gçù
*=
j
; }

1234 
	gpHV
=
Ãw
 
DIFF
<
U
,
	gN
>(
	gv®
[
b
]*
	gçù
, v®.
g‘TTy³NameHV
(), 
	gb
);

1238 
	gpHV
=
Ãw
 
DIFF
<
U
,
	gN
>(
	gv®
.
g‘TTy³NameHV
(), 
	gb
);

1240  
	gTTy³Name
<
	gU
,
	gN
>(
	gpHV
);

1244 
	g‹m¶©e
 <
ty³Çme
 
	gU
, 
	gN
> 
	gOp
< 
	gTTy³Name
<U,N> >

1246 
	gTTy³Name
<
	tU
,
	tN
> 
	tV
;

1247 
	gTTy³Name
<
	tU
,
	tN
> 
	tUnd”lyšg
;

1248 
ty³Çme
 
	tOp
<
	tU
>::
	tBa£
 Base;

1249 
Ba£
 
myIÁeg”
(cÚ¡ 
i
) {  Base(i); }

1250 
Ba£
 
myZ”o
(è{  
myIÁeg”
(0); }

1251 
Ba£
 
myOÃ
(è{  
myIÁeg”
(1);}

1252 
Ba£
 
myTwo
(è{  
myIÁeg”
(2); }

1253 
Ba£
 
myPI
(è{  
	gOp
<
	gBa£
>::myPI(); }

1254 
V
 
myPos
(cÚ¡ V& 
x
è{  +
	gx
; }

1255 
V
 
myNeg
(cÚ¡ V& 
x
è{  -
	gx
; }

1256 
	g‹m¶©e
 <
ty³Çme
 
	gY
> 
	gV
& 
myCadd
(
V
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gx
+=y; }

1257 
	g‹m¶©e
 <
ty³Çme
 
	gY
> 
	gV
& 
myCsub
(
V
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gx
-=y; }

1258 
	g‹m¶©e
 <
ty³Çme
 
	gY
> 
	gV
& 
myCmul
(
V
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gx
*=y; }

1259 
	g‹m¶©e
 <
ty³Çme
 
	gY
> 
	gV
& 
myCdiv
(
V
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gx
/=y; }

1260 
V
 
myInv
(cÚ¡ V& 
x
è{  
myOÃ
()/
	gx
; }

1261 
V
 
mySqr
(cÚ¡ V& 
x
è{  
	gçdbad
::
sqr
(x); }

1262 
	g‹m¶©e
 <
ty³Çme
 
	gX
,y³Çm
	gY
>

1263 
V
 
myPow
(cÚ¡ 
X
& 
x
, cÚ¡ 
Y
& 
y
è{  
	gçdbad
::
pow
(x,y); }

1264 
V
 
mySq¹
(cÚ¡ V& 
x
è{  
	gçdbad
::
sq¹
(x); }

1265 
V
 
myLog
(cÚ¡ V& 
x
è{  
	gçdbad
::
log
(x); }

1266 
V
 
myExp
(cÚ¡ V& 
x
è{  
	gçdbad
::
exp
(x); }

1267 
V
 
mySš
(cÚ¡ V& 
x
è{  
	gçdbad
::
sš
(x); }

1268 
V
 
myCos
(cÚ¡ V& 
x
è{  
	gçdbad
::
cos
(x); }

1269 
V
 
myTª
(cÚ¡ V& 
x
è{  
	gçdbad
::
n
(x); }

1270 
V
 
myAsš
(cÚ¡ V& 
x
è{  
	gçdbad
::
asš
(x); }

1271 
V
 
myAcos
(cÚ¡ V& 
x
è{  
	gçdbad
::
acos
(x); }

1272 
V
 
myAn
(cÚ¡ V& 
x
è{  
	gçdbad
::
©ª
(x); }

1273 
boŞ
 
myEq
(cÚ¡ 
V
& 
x
, cÚ¡ V& 
y
è{  
	gx
==y; }

1274 
boŞ
 
myNe
(cÚ¡ 
V
& 
x
, cÚ¡ V& 
y
è{  
	gx
!=y; }

1275 
boŞ
 
myLt
(cÚ¡ 
V
& 
x
, cÚ¡ V& 
y
è{  
	gx
<
	gy
; }

1276 
boŞ
 
myLe
(cÚ¡ 
V
& 
x
, cÚ¡ V& 
y
è{  
	gx
<=y; }

1277 
boŞ
 
myGt
(cÚ¡ 
V
& 
x
, cÚ¡ V& 
y
è{  
	gx
>
	gy
; }

1278 
boŞ
 
myGe
(cÚ¡ 
V
& 
x
, cÚ¡ V& 
y
è{  
	gx
>=y; }

	@robot/FADBAD++/test/IReportLogger.h

1 #iâdeà
IREPORT_LOGGER_H


2 
	#IREPORT_LOGGER_H


	)

4 
	~<io¡»am
>

6 şas 
	cIR•ÜtLog


8 
	mpublic
:

9 
vœtu®
 
¡d
::
o¡»am
& 
çed
() =0;

10 
vœtu®
 
	m¡d
::
o¡»am
& 
sucûeded
() =0;

11 ~
	$IR•ÜtLog
(){}

12 
	}
};

14 şas 
	cIR•ÜtLogg”


16 
	mpublic
:

17 
vœtu®
 
run
(
IR•ÜtLog
&) =0;

18 ~
	$IR•ÜtLogg”
(){}

19 
	}
};

	@robot/FADBAD++/test/STDReportLog.h

1 #iâdeà
STD_REPORT_LOG_H


2 
	#STD_REPORT_LOG_H


	)

4 
	~<io¡»am
>

5 
	~"IR•ÜtLogg”.h
"

7 şas 
	cSTDR•ÜtLog
 : 
public
 
IR•ÜtLog


9 
¡d
::
o¡»am
& 
m_os
;

10 
	mm_çed
;

11 
	mm_sucûeded
;

12 
	mİ”©Ü
=(cÚ¡ 
STDR•ÜtLog
&) { }

13 
public
:

14 
	$STDR•ÜtLog
(
¡d
::
o¡»am
& 
os
):
	`m_os
(os),
	`m_çed
(0),
	$m_sucûeded
(0){
	}
}

15 ~
	$STDR•ÜtLog
()

17 
m_os
 << "TÙ® faed :" << 
m_çed
 << 
¡d
::
’dl
;

18 
m_os
 << "TÙ® sucûeded :" << 
m_sucûeded
 << 
¡d
::
’dl
;

19 
m_os
.
	`æush
();

20 
	}
}

21 
	g¡d
::
o¡»am
& 
	$çed
(){
m_çed
++;
m_os
<<"FAILED: "; m_os;
	}
}

22 
	g¡d
::
o¡»am
& 
	$sucûeded
(){
m_sucûeded
++;
m_os
<<"SUCCEEDED: "; m_os;
	}
}

	@robot/FADBAD++/test/TestAll.cpp

1 
	~"STDR•ÜtLog.h
"

3 
	~"Te¡FADBAD.h
"

4 
	~"Te¡TAD.h
"

5 
	~"Te¡UDT.h
"

7 
	$maš
()

9 
STDR•ÜtLog
 
	`log
(
¡d
::
û¼
);

11 
Te¡FADBAD
 
‹¡FADBAD
;

12 
‹¡FADBAD
.
	`run
(
log
);

14 
Te¡TAD
 
‹¡TAD
;

15 
‹¡TAD
.
	`run
(
log
);

17 
Te¡UDT
 
‹¡UDT
;

18 
‹¡UDT
.
	`run
(
log
);

21 
	}
}

	@robot/FADBAD++/test/TestFADBAD.cpp

1 
	~"badiff.h
"

2 
	~"çdiff.h
"

4 
	~"exŒa/ndf.h
"

5 
	~"exŒa/ndçd.h
"

7 
	~<veùÜ
>

8 
	~"Te¡FADBAD.h
"

10 
usšg
 
Çme¥aû
 
	gçdbad
;

14 
	sAdd


16 cÚ¡ * 
Name
(){  "T operator +(const T&, const T&)"; }

17 cÚ¡ 
	mm
=2;

18 cÚ¡ 
	mn
=1;

19 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

20 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

22 
¡d
::
veùÜ
<
T
> 
out
(
n
);

23 
	mout
[0]=
v
[0]+v[1];

24  
	mout
;

26 
	m¡d
::
veùÜ
<> 
pošt
()

28 
¡d
::
veùÜ
< > 
š
(
m
);

29 
	mš
[0]=1.5;

30 
	mš
[1]=-1.5;

31  
	mš
;

34 
	sAdd1


36 cÚ¡ * 
Name
(){  "T operator +(const T&, const T&) same object"; }

37 cÚ¡ 
	mm
=1;

38 cÚ¡ 
	mn
=1;

39 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

40 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

42 
¡d
::
veùÜ
<
T
> 
out
(
n
);

43 
	mout
[0]=
v
[0];

44 
	mout
[0]=
out
[0]+out[0];

45  
	mout
;

47 
	m¡d
::
veùÜ
<> 
pošt
()

49 
¡d
::
veùÜ
< > 
š
(
m
);

50 
	mš
[0]=1.5;

51  
	mš
;

54 
	sCAdd


56 cÚ¡ * 
Name
(){  "T& T::operator +=(const T&)"; }

57 cÚ¡ 
	mm
=2;

58 cÚ¡ 
	mn
=1;

59 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

60 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

62 
¡d
::
veùÜ
<
T
> 
out
(
n
);

63 
	mout
[0]=
v
[0];

64 
	mout
[0]+=
v
[1];

65  
	mout
;

67 
	m¡d
::
veùÜ
<> 
pošt
()

69 
¡d
::
veùÜ
< > 
š
(
m
);

70 
	mš
[0]=1.5;

71 
	mš
[1]=-1.5;

72  
	mš
;

75 
	sCAdd1


77 cÚ¡ * 
Name
(){  "T& T::operator +=(const double)"; }

78 cÚ¡ 
	mm
=1;

79 cÚ¡ 
	mn
=1;

80 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

81 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

83 
¡d
::
veùÜ
<
T
> 
out
(
n
);

84 
	mout
[0]=
v
[0];

85 
	mout
[0]+=117.0;

86  
	mout
;

88 
	m¡d
::
veùÜ
<> 
pošt
()

90 
¡d
::
veùÜ
< > 
š
(
m
);

91 
	mš
[0]=1.5;

92  
	mš
;

95 
	sCAdd2


97 cÚ¡ * 
Name
(){  "T& T::operator +=(const T&) same instance"; }

98 cÚ¡ 
	mm
=1;

99 cÚ¡ 
	mn
=1;

100 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

101 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

103 
¡d
::
veùÜ
<
T
> 
out
(
n
);

104 
	mout
[0]=
v
[0];

105 
	mout
[0]+=
out
[0];

106  
	mout
;

108 
	m¡d
::
veùÜ
<> 
pošt
()

110 
¡d
::
veùÜ
< > 
š
(
m
);

111 
	mš
[0]=1.5;

112  
	mš
;

115 
	sAdd2


117 cÚ¡ * 
Name
(){  "T operator +(const T&, const double)"; }

118 cÚ¡ 
	mm
=1;

119 cÚ¡ 
	mn
=1;

120 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

121 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

123 
¡d
::
veùÜ
<
T
> 
out
(
n
);

124 
	mout
[0]=
v
[0]+117.0;

125  
	mout
;

127 
	m¡d
::
veùÜ
<> 
pošt
()

129 
¡d
::
veùÜ
< > 
š
(
m
);

130 
	mš
[0]=1.5;

131  
	mš
;

134 
	sAdd3


136 cÚ¡ * 
Name
(){  "T operator +(const double, const T&)"; }

137 cÚ¡ 
	mm
=1;

138 cÚ¡ 
	mn
=1;

139 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

140 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

142 
¡d
::
veùÜ
<
T
> 
out
(
n
);

143 
	mout
[0]=118.0+
v
[0];

144  
	mout
;

146 
	m¡d
::
veùÜ
<> 
pošt
()

148 
¡d
::
veùÜ
< > 
š
(
m
);

149 
	mš
[0]=1.5;

150  
	mš
;

153 
	sSub


155 cÚ¡ * 
Name
(){  "T operator -(const T&, const T&)"; }

156 cÚ¡ 
	mm
=2;

157 cÚ¡ 
	mn
=1;

158 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

159 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

161 
¡d
::
veùÜ
<
T
> 
out
(
n
);

162 
	mout
[0]=
v
[0]-v[1];

163  
	mout
;

165 
	m¡d
::
veùÜ
<> 
pošt
()

167 
¡d
::
veùÜ
< > 
š
(
m
);

168 
	mš
[0]=1.5;

169 
	mš
[1]=-1.5;

170  
	mš
;

173 
	sSub1


175 cÚ¡ * 
Name
(){  "T operator -(const T&, const T&) same object"; }

176 cÚ¡ 
	mm
=1;

177 cÚ¡ 
	mn
=1;

178 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

179 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

181 
¡d
::
veùÜ
<
T
> 
out
(
n
);

182 
	mout
[0]=
v
[0];

183 
	mout
[0]=
out
[0]-out[0];

184  
	mout
;

186 
	m¡d
::
veùÜ
<> 
pošt
()

188 
¡d
::
veùÜ
< > 
š
(
m
);

189 
	mš
[0]=1.5;

190  
	mš
;

193 
	sCSub


195 cÚ¡ * 
Name
(){  "T& T::operator -=(const T&)"; }

196 cÚ¡ 
	mm
=2;

197 cÚ¡ 
	mn
=1;

198 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

199 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

201 
¡d
::
veùÜ
<
T
> 
out
(
n
);

202 
	mout
[0]=
v
[0];

203 
	mout
[0]-=
v
[1];

204  
	mout
;

206 
	m¡d
::
veùÜ
<> 
pošt
()

208 
¡d
::
veùÜ
< > 
š
(
m
);

209 
	mš
[0]=1.5;

210 
	mš
[1]=-1.5;

211  
	mš
;

214 
	sCSub1


216 cÚ¡ * 
Name
(){  "T& T::operator -=(const double)"; }

217 cÚ¡ 
	mm
=1;

218 cÚ¡ 
	mn
=1;

219 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

220 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

222 
¡d
::
veùÜ
<
T
> 
out
(
n
);

223 
	mout
[0]=
v
[0];

224 
	mout
[0]-=117.0;

225  
	mout
;

227 
	m¡d
::
veùÜ
<> 
pošt
()

229 
¡d
::
veùÜ
< > 
š
(
m
);

230 
	mš
[0]=1.5;

231  
	mš
;

234 
	sCSub2


236 cÚ¡ * 
Name
(){  "T& T::operator -=(const T&) same instance"; }

237 cÚ¡ 
	mm
=1;

238 cÚ¡ 
	mn
=1;

239 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

240 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

242 
¡d
::
veùÜ
<
T
> 
out
(
n
);

243 
	mout
[0]=
v
[0];

244 
	mout
[0]-=
out
[0];

245  
	mout
;

247 
	m¡d
::
veùÜ
<> 
pošt
()

249 
¡d
::
veùÜ
< > 
š
(
m
);

250 
	mš
[0]=1.5;

251  
	mš
;

254 
	sSub2


256 cÚ¡ * 
Name
(){  "T operator -(const T&, const double)"; }

257 cÚ¡ 
	mm
=1;

258 cÚ¡ 
	mn
=1;

259 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

260 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

262 
¡d
::
veùÜ
<
T
> 
out
(
n
);

263 
	mout
[0]=
v
[0]-117.0;

264  
	mout
;

266 
	m¡d
::
veùÜ
<> 
pošt
()

268 
¡d
::
veùÜ
< > 
š
(
m
);

269 
	mš
[0]=1.5;

270  
	mš
;

273 
	sSub3


275 cÚ¡ * 
Name
(){  "T operator -(const double, const T&)"; }

276 cÚ¡ 
	mm
=1;

277 cÚ¡ 
	mn
=1;

278 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

279 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

281 
¡d
::
veùÜ
<
T
> 
out
(
n
);

282 
	mout
[0]=118.0-
v
[0];

283  
	mout
;

285 
	m¡d
::
veùÜ
<> 
pošt
()

287 
¡d
::
veùÜ
< > 
š
(
m
);

288 
	mš
[0]=1.5;

289  
	mš
;

292 
	sMul


294 cÚ¡ * 
Name
(){  "T operator *(const T&, const T&)"; }

295 cÚ¡ 
	mm
=2;

296 cÚ¡ 
	mn
=1;

297 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

298 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

300 
¡d
::
veùÜ
<
T
> 
out
(
n
);

301 
	mout
[0]=
v
[0]*v[1];

302  
	mout
;

304 
	m¡d
::
veùÜ
<> 
pošt
()

306 
¡d
::
veùÜ
< > 
š
(
m
);

307 
	mš
[0]=1.5;

308 
	mš
[1]=-1.5;

309  
	mš
;

312 
	sMul1


314 cÚ¡ * 
Name
(){  "T operator *(const T&, const T&) same object"; }

315 cÚ¡ 
	mm
=1;

316 cÚ¡ 
	mn
=1;

317 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

318 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

320 
¡d
::
veùÜ
<
T
> 
out
(
n
);

321 
	mout
[0]=
v
[0];

322 
	mout
[0]=
out
[0]*out[0];

323  
	mout
;

325 
	m¡d
::
veùÜ
<> 
pošt
()

327 
¡d
::
veùÜ
< > 
š
(
m
);

328 
	mš
[0]=1.5;

329  
	mš
;

332 
	sCMul


334 cÚ¡ * 
Name
(){  "T& T::operator *=(const T&)"; }

335 cÚ¡ 
	mm
=2;

336 cÚ¡ 
	mn
=1;

337 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

338 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

340 
¡d
::
veùÜ
<
T
> 
out
(
n
);

341 
	mout
[0]=
v
[0];

342 
	mout
[0]*=
v
[1];

343  
	mout
;

345 
	m¡d
::
veùÜ
<> 
pošt
()

347 
¡d
::
veùÜ
< > 
š
(
m
);

348 
	mš
[0]=1.5;

349 
	mš
[1]=-1.5;

350  
	mš
;

353 
	sCMul1


355 cÚ¡ * 
Name
(){  "T& T::operator *=(const double)"; }

356 cÚ¡ 
	mm
=1;

357 cÚ¡ 
	mn
=1;

358 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

359 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

361 
¡d
::
veùÜ
<
T
> 
out
(
n
);

362 
	mout
[0]=
v
[0];

363 
	mout
[0]*=117.0;

364  
	mout
;

366 
	m¡d
::
veùÜ
<> 
pošt
()

368 
¡d
::
veùÜ
< > 
š
(
m
);

369 
	mš
[0]=1.5;

370  
	mš
;

373 
	sCMul2


375 cÚ¡ * 
Name
(){  "T& T::operator *=(const T&) same instance"; }

376 cÚ¡ 
	mm
=1;

377 cÚ¡ 
	mn
=1;

378 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

379 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

381 
¡d
::
veùÜ
<
T
> 
out
(
n
);

382 
	mout
[0]=
v
[0];

383 
	mout
[0]*=
out
[0];

384  
	mout
;

386 
	m¡d
::
veùÜ
<> 
pošt
()

388 
¡d
::
veùÜ
< > 
š
(
m
);

389 
	mš
[0]=1.5;

390  
	mš
;

393 
	sMul2


395 cÚ¡ * 
Name
(){  "T operator *(const T&, const double)"; }

396 cÚ¡ 
	mm
=1;

397 cÚ¡ 
	mn
=1;

398 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

399 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

401 
¡d
::
veùÜ
<
T
> 
out
(
n
);

402 
	mout
[0]=
v
[0]*117.0;

403  
	mout
;

405 
	m¡d
::
veùÜ
<> 
pošt
()

407 
¡d
::
veùÜ
< > 
š
(
m
);

408 
	mš
[0]=1.5;

409  
	mš
;

412 
	sMul3


414 cÚ¡ * 
Name
(){  "T operator *(const double, const T&)"; }

415 cÚ¡ 
	mm
=1;

416 cÚ¡ 
	mn
=1;

417 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

418 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

420 
¡d
::
veùÜ
<
T
> 
out
(
n
);

421 
	mout
[0]=118.0*
v
[0];

422  
	mout
;

424 
	m¡d
::
veùÜ
<> 
pošt
()

426 
¡d
::
veùÜ
< > 
š
(
m
);

427 
	mš
[0]=1.5;

428  
	mš
;

431 
	sDiv


433 cÚ¡ * 
Name
(){  "T operator /(const T&, const T&)"; }

434 cÚ¡ 
	mm
=2;

435 cÚ¡ 
	mn
=1;

436 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

437 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

439 
¡d
::
veùÜ
<
T
> 
out
(
n
);

440 
	mout
[0]=
v
[0]/v[1];

441  
	mout
;

443 
	m¡d
::
veùÜ
<> 
pošt
()

445 
¡d
::
veùÜ
< > 
š
(
m
);

446 
	mš
[0]=1.5;

447 
	mš
[1]=-1.5;

448  
	mš
;

451 
	sDiv1


453 cÚ¡ * 
Name
(){  "T operator /(const T&, const T&) same object"; }

454 cÚ¡ 
	mm
=1;

455 cÚ¡ 
	mn
=1;

456 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

457 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

459 
¡d
::
veùÜ
<
T
> 
out
(
n
);

460 
	mout
[0]=
v
[0];

461 
	mout
[0]=
out
[0]/out[0];

462  
	mout
;

464 
	m¡d
::
veùÜ
<> 
pošt
()

466 
¡d
::
veùÜ
< > 
š
(
m
);

467 
	mš
[0]=1.5;

468  
	mš
;

471 
	sCDiv


473 cÚ¡ * 
Name
(){  "T& T::operator /=(const T&)"; }

474 cÚ¡ 
	mm
=2;

475 cÚ¡ 
	mn
=1;

476 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

477 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

479 
¡d
::
veùÜ
<
T
> 
out
(
n
);

480 
	mout
[0]=
v
[0];

481 
	mout
[0]/=
v
[1];

482  
	mout
;

484 
	m¡d
::
veùÜ
<> 
pošt
()

486 
¡d
::
veùÜ
< > 
š
(
m
);

487 
	mš
[0]=1.5;

488 
	mš
[1]=-1.5;

489  
	mš
;

492 
	sCDiv1


494 cÚ¡ * 
Name
(){  "T& T::operator /=(const double)"; }

495 cÚ¡ 
	mm
=2;

496 cÚ¡ 
	mn
=1;

497 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

498 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

500 
¡d
::
veùÜ
<
T
> 
out
(
n
);

501 
	mout
[0]=
v
[0];

502 
	mout
[0]/=117.0;

503  
	mout
;

505 
	m¡d
::
veùÜ
<> 
pošt
()

507 
¡d
::
veùÜ
< > 
š
(
m
);

508 
	mš
[0]=1.5;

509  
	mš
;

512 
	sCDiv2


514 cÚ¡ * 
Name
(){  "T& T::operator /=(const T&) same instance"; }

515 cÚ¡ 
	mm
=2;

516 cÚ¡ 
	mn
=1;

517 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

518 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

520 
¡d
::
veùÜ
<
T
> 
out
(
n
);

521 
	mout
[0]=
v
[0];

522 
	mout
[0]/=
out
[0];

523  
	mout
;

525 
	m¡d
::
veùÜ
<> 
pošt
()

527 
¡d
::
veùÜ
< > 
š
(
m
);

528 
	mš
[0]=1.5;

529  
	mš
;

532 
	sDiv2


534 cÚ¡ * 
Name
(){  "T operator /(const T&, const double)"; }

535 cÚ¡ 
	mm
=1;

536 cÚ¡ 
	mn
=1;

537 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

538 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

540 
¡d
::
veùÜ
<
T
> 
out
(
n
);

541 
	mout
[0]=
v
[0]/117.0;

542  
	mout
;

544 
	m¡d
::
veùÜ
<> 
pošt
()

546 
¡d
::
veùÜ
< > 
š
(
m
);

547 
	mš
[0]=1.5;

548  
	mš
;

551 
	sDiv3


553 cÚ¡ * 
Name
(){  "T operator /(const double, const T&)"; }

554 cÚ¡ 
	mm
=1;

555 cÚ¡ 
	mn
=1;

556 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

557 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

559 
¡d
::
veùÜ
<
T
> 
out
(
n
);

560 
	mout
[0]=118.0/
v
[0];

561  
	mout
;

563 
	m¡d
::
veùÜ
<> 
pošt
()

565 
¡d
::
veùÜ
< > 
š
(
m
);

566 
	mš
[0]=1.5;

567  
	mš
;

570 
	sPow


572 cÚ¡ * 
Name
(){  "T…ow(const T&, int)"; }

573 cÚ¡ 
	mm
=1;

574 cÚ¡ 
	mn
=1;

575 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

576 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

578 
¡d
::
veùÜ
<
T
> 
out
(
n
);

579 
	mout
[0]=
pow
(
v
[0],3.0);

580  
	mout
;

582 
	m¡d
::
veùÜ
<> 
pošt
()

584 
¡d
::
veùÜ
< > 
š
(
m
);

585 
	mš
[0]=1.5;

586  
	mš
;

589 
	sPow2


591 cÚ¡ * 
Name
(){  "T…ow(const T&, const T&)"; }

592 cÚ¡ 
	mm
=2;

593 cÚ¡ 
	mn
=1;

594 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

595 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

597 
¡d
::
veùÜ
<
T
> 
out
(
n
);

598 
	mout
[0]=
pow
(
v
[0],v[1]);

599  
	mout
;

601 
	m¡d
::
veùÜ
<> 
pošt
()

603 
¡d
::
veùÜ
< > 
š
(
m
);

604 
	mš
[0]=1.5;

605 
	mš
[0]=3.3;

606  
	mš
;

609 
	sUAdd


611 cÚ¡ * 
Name
(){  "T sqr(const T&)"; }

612 cÚ¡ 
	mm
=1;

613 cÚ¡ 
	mn
=1;

614 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

615 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

617 
¡d
::
veùÜ
<
T
> 
out
(
n
);

618 
	mout
[0]=+
v
[0];

619  
	mout
;

621 
	m¡d
::
veùÜ
<> 
pošt
()

623 
¡d
::
veùÜ
< > 
š
(
m
);

624 
	mš
[0]=1.5;

625  
	mš
;

628 
	sUSub


630 cÚ¡ * 
Name
(){  "T sqr(const T&)"; }

631 cÚ¡ 
	mm
=1;

632 cÚ¡ 
	mn
=1;

633 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

634 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

636 
¡d
::
veùÜ
<
T
> 
out
(
n
);

637 
	mout
[0]=-
v
[0];

638  
	mout
;

640 
	m¡d
::
veùÜ
<> 
pošt
()

642 
¡d
::
veùÜ
< > 
š
(
m
);

643 
	mš
[0]=1.5;

644  
	mš
;

647 
	sSqr


649 cÚ¡ * 
Name
(){  "T sqr(const T&)"; }

650 cÚ¡ 
	mm
=1;

651 cÚ¡ 
	mn
=1;

652 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

653 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

655 
¡d
::
veùÜ
<
T
> 
out
(
n
);

656 
	mout
[0]=
sqr
(
v
[0]);

657  
	mout
;

659 
	m¡d
::
veùÜ
<> 
pošt
()

661 
¡d
::
veùÜ
< > 
š
(
m
);

662 
	mš
[0]=1.5;

663  
	mš
;

666 
	sExp


668 cÚ¡ * 
Name
(){  "Tƒxp(const T&)"; }

669 cÚ¡ 
	mm
=1;

670 cÚ¡ 
	mn
=1;

671 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

672 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

674 
¡d
::
veùÜ
<
T
> 
out
(
n
);

675 
	mout
[0]=
exp
(
v
[0]);

676  
	mout
;

678 
	m¡d
::
veùÜ
<> 
pošt
()

680 
¡d
::
veùÜ
< > 
š
(
m
);

681 
	mš
[0]=1.5;

682  
	mš
;

685 
	sLog


687 cÚ¡ * 
Name
(){  "T†og(const T&)"; }

688 cÚ¡ 
	mm
=1;

689 cÚ¡ 
	mn
=1;

690 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

691 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

693 
¡d
::
veùÜ
<
T
> 
out
(
n
);

694 
	mout
[0]=
log
(
v
[0]);

695  
	mout
;

697 
	m¡d
::
veùÜ
<> 
pošt
()

699 
¡d
::
veùÜ
< > 
š
(
m
);

700 
	mš
[0]=1.5;

701  
	mš
;

704 
	sSq¹


706 cÚ¡ * 
Name
(){  "T sqrt(const T&)"; }

707 cÚ¡ 
	mm
=1;

708 cÚ¡ 
	mn
=1;

709 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

710 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

712 
¡d
::
veùÜ
<
T
> 
out
(
n
);

713 
	mout
[0]=
sq¹
(
v
[0]);

714  
	mout
;

716 
	m¡d
::
veùÜ
<> 
pošt
()

718 
¡d
::
veùÜ
< > 
š
(
m
);

719 
	mš
[0]=1.5;

720  
	mš
;

723 
	sSš


725 cÚ¡ * 
Name
(){  "T sin(const T&)"; }

726 cÚ¡ 
	mm
=1;

727 cÚ¡ 
	mn
=1;

728 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

729 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

731 
¡d
::
veùÜ
<
T
> 
out
(
n
);

732 
	mout
[0]=
sš
(
v
[0]);

733  
	mout
;

735 
	m¡d
::
veùÜ
<> 
pošt
()

737 
¡d
::
veùÜ
< > 
š
(
m
);

738 
	mš
[0]=1.5;

739  
	mš
;

742 
	sCos


744 cÚ¡ * 
Name
(){  "T cos(const T&)"; }

745 cÚ¡ 
	mm
=1;

746 cÚ¡ 
	mn
=1;

747 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

748 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

750 
¡d
::
veùÜ
<
T
> 
out
(
n
);

751 
	mout
[0]=
cos
(
v
[0]);

752  
	mout
;

754 
	m¡d
::
veùÜ
<> 
pošt
()

756 
¡d
::
veùÜ
< > 
š
(
m
);

757 
	mš
[0]=1.5;

758  
	mš
;

761 
	sTª


763 cÚ¡ * 
Name
(){  "Tan(const T&)"; }

764 cÚ¡ 
	mm
=1;

765 cÚ¡ 
	mn
=1;

766 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

767 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

769 
¡d
::
veùÜ
<
T
> 
out
(
n
);

770 
	mout
[0]=
n
(
v
[0]);

771  
	mout
;

773 
	m¡d
::
veùÜ
<> 
pošt
()

775 
¡d
::
veùÜ
< > 
š
(
m
);

776 
	mš
[0]=1.5;

777  
	mš
;

780 
	sASš


782 cÚ¡ * 
Name
(){  "T‡sin(const T&)"; }

783 cÚ¡ 
	mm
=1;

784 cÚ¡ 
	mn
=1;

785 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

786 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

788 
¡d
::
veùÜ
<
T
> 
out
(
n
);

789 
	mout
[0]=
asš
(
v
[0]);

790  
	mout
;

792 
	m¡d
::
veùÜ
<> 
pošt
()

794 
¡d
::
veùÜ
< > 
š
(
m
);

795 
	mš
[0]=0.5;

796  
	mš
;

799 
	sACos


801 cÚ¡ * 
Name
(){  "T‡cos(const T&)"; }

802 cÚ¡ 
	mm
=1;

803 cÚ¡ 
	mn
=1;

804 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

805 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

807 
¡d
::
veùÜ
<
T
> 
out
(
n
);

808 
	mout
[0]=
acos
(
v
[0]);

809  
	mout
;

811 
	m¡d
::
veùÜ
<> 
pošt
()

813 
¡d
::
veùÜ
< > 
š
(
m
);

814 
	mš
[0]=0.5;

815  
	mš
;

818 
	sATª


820 cÚ¡ * 
Name
(){  "T‡tan(const T&)"; }

821 cÚ¡ 
	mm
=1;

822 cÚ¡ 
	mn
=1;

823 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

824 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

826 
¡d
::
veùÜ
<
T
> 
out
(
n
);

827 
	mout
[0]=
©ª
(
v
[0]);

828  
	mout
;

830 
	m¡d
::
veùÜ
<> 
pošt
()

832 
¡d
::
veùÜ
< > 
š
(
m
);

833 
	mš
[0]=0.5;

834  
	mš
;

837 
	sNd


839 cÚ¡ * 
Name
(){  "T‚d(const T&) --‚ormal distribution"; }

840 cÚ¡ 
	mm
=1;

841 cÚ¡ 
	mn
=1;

842 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

843 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

845 
¡d
::
veùÜ
<
T
> 
out
(
n
);

846 
	mout
[0]=
nd
(
v
[0]);

847  
	mout
;

849 
	m¡d
::
veùÜ
<> 
pošt
()

851 
¡d
::
veùÜ
< > 
š
(
m
);

852 
	mš
[0]=0.5;

853  
	mš
;

856 
	sCnd


858 cÚ¡ * 
Name
(){  "T cnd(const T&) -- cumulative‚ormal distribution"; }

859 cÚ¡ 
	mm
=1;

860 cÚ¡ 
	mn
=1;

861 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

862 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

864 
¡d
::
veùÜ
<
T
> 
out
(
n
);

865 
	mout
[0]=
úd
(
v
[0]);

866  
	mout
;

868 
	m¡d
::
veùÜ
<> 
pošt
()

870 
¡d
::
veùÜ
< > 
š
(
m
);

871 
	mš
[0]=0.5;

872  
	mš
;

875 
	sIúd


877 cÚ¡ * 
Name
(){  "T cnd(const T&) -- invers cumulative‚ormal distribution"; }

878 cÚ¡ 
	mm
=1;

879 cÚ¡ 
	mn
=1;

880 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

881 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

883 
¡d
::
veùÜ
<
T
> 
out
(
n
);

884 
	mout
[0]=
iúd
(
v
[0]);

885  
	mout
;

887 
	m¡d
::
veùÜ
<> 
pošt
()

889 
¡d
::
veùÜ
< > 
š
(
m
);

890 
	mš
[0]=0.8;

891  
	mš
;

897 
	scsm­


899 cÚ¡ * 
Name
(){  "Cos-Sine map"; }

900 cÚ¡ 
	mm
=2;

901 cÚ¡ 
	mn
=2;

902 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

903 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

905 
¡d
::
veùÜ
<
T
> 
out
(
n
);

906 
	mout
[0]=
cos
(
v
[0]+4*v[1]);

907 
	mout
[1]=
sš
(4*
v
[0]+v[1]);

908  
	mout
;

910 
	m¡d
::
veùÜ
<> 
pošt
()

912 
¡d
::
veùÜ
< > 
š
(
m
);

913 
	mš
[0]=1.5;

914 
	mš
[1]=-1.5;

915  
	mš
;

918 
	sfunc1


920 cÚ¡ * 
Name
(){  "atan[(a sin x)/(1-a cos x)]"; }

921 cÚ¡ 
	mm
=2;

922 cÚ¡ 
	mn
=1;

923 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

924 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

926 
¡d
::
veùÜ
<
T
> 
out
(
n
);

927 
T
 
x
(
v
[0]);

928 
T
 
a
(
v
[1]);

929 
	mout
[0]=
©ª
((
a
*
sš
(
x
))/(1-a*
cos
(x)));

930  
	mout
;

932 
	m¡d
::
veùÜ
<> 
pošt
()

934 
¡d
::
veùÜ
< > 
š
(
m
);

935 
	mš
[0]=1.5;

936 
	mš
[1]=-.456;

937  
	mš
;

954 
	g‹m¶©e
 <
ty³Çme
 
	gC
>

955 
	sFdiff


957 cÚ¡ 
	mm
=
C
::
m
;

958 cÚ¡ 
	mn
=
C
::
n
+C::
m
*C::n;

959 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

960 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

962 
USER_ASSERT
(
v
.
size
()==
C
::
m
,"UNEXPECTED SIZE")

963 
	mi
,
	mj
;

964 
	m¡d
::
veùÜ
< 
F
<
T
> > 
out
(
C
::
n
);

965 
	m¡d
::
veùÜ
< 
F
<
T
> > 
š
(
C
::
m
);

966 
	mi
=0;i<
	mC
::
m
;++i)

968 
	mš
[
i
]=
v
[i];

969 
	mš
[
i
].
diff
(i,
C
::
m
);

971 
	mout
=
C
()(
š
);

972 
	m¡d
::
veùÜ
<
T
> 
»tv®
(
n
);

973 
	mj
=0;j<
	mC
::
n
;++j)

975 
	m»tv®
[
j
]=
out
[j].
x
();

976 
	mi
=0;i<
	mC
::
m
;++i)

978 
	m»tv®
[
C
::
n
+
j
*C::
m
+
i
]=
out
[j].
d
(i);

981  
	m»tv®
;

985 
	g‹m¶©e
 <
ty³Çme
 
	gC
>

986 
	sFFdiff


988 cÚ¡ 
	mm
=
C
::
m
;

989 cÚ¡ 
	mn
=
C
::
n
+C::
m
*C::n;

990 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

991 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

993 
USER_ASSERT
(
v
.
size
()==
C
::
m
,"UNEXPECTED SIZE")

994 
	mi
,
	mj
;

995 
	m¡d
::
veùÜ
< 
F
<
T
,
	mC
::
m
> > 
out
(
C
::
n
);

996 
	m¡d
::
veùÜ
< 
F
<
T
,
	mC
::
m
> > 
š
(
C
::m);

997 
	mi
=0;i<
	mC
::
m
;++i)

999 
	mš
[
i
]=
v
[i];

1000 
	mš
[
i
].
diff
(i);

1002 
	mout
=
C
()(
š
);

1003 
	m¡d
::
veùÜ
<
T
> 
»tv®
(
n
);

1004 
	mj
=0;j<
	mC
::
n
;++j)

1006 
	m»tv®
[
j
]=
out
[j].
x
();

1007 
	mi
=0;i<
	mC
::
m
;++i)

1009 
	m»tv®
[
C
::
n
+
j
*C::
m
+
i
]=
out
[j].
d
(i);

1012  
	m»tv®
;

1016 
	g‹m¶©e
 <
ty³Çme
 
	gC
>

1017 
	sBdiff


1019 cÚ¡ 
	mm
=
C
::
m
;

1020 cÚ¡ 
	mn
=
C
::
n
+C::
m
*C::n;

1021 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

1022 
	m¡d
::
veùÜ
<
T
> 
İ”©Ü
()(cÚ¡ 
¡d
::veùÜ<T>& 
v
)

1024 
USER_ASSERT
(
v
.
size
()==
C
::
m
,"UNEXPECTED SIZE")

1025 
	mi
,
	mj
;

1026 
	m¡d
::
veùÜ
< 
B
<
T
> > 
out
(
C
::
n
);

1027 
	m¡d
::
veùÜ
< 
B
<
T
> > 
š
(
C
::
m
);

1028 
	mi
=0;i<
	mC
::
m
;++i)

1030 
	mš
[
i
]=
v
[i];

1032 
	mout
=
C
()(
š
);

1033 
	mj
=0;j<
	mC
::
n
;++j)

1035 
	mout
[
j
].
diff
(j,
C
::
n
);

1037 
	m¡d
::
veùÜ
<
T
> 
»tv®
(
n
);

1038 
	mj
=0;j<
	mC
::
n
;++j)

1040 
	m»tv®
[
j
]=
out
[j].
x
();

1041 
	mi
=0;i<
	mC
::
m
;++i)

1043 
	m»tv®
[
C
::
n
+
j
*C::
m
+
i
]=
š
[i].
d
(j);

1046  
	m»tv®
;

1050 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1051 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, cÚ¡ std::
veùÜ
<
T
>& 
v
)

1053 
os
 << "[";

1054 
	gi
=0;i<
	gv
.
size
();i++)

1056 
	gos
 << 
	gv
[
i
];

1057 ià(
	gi
<
	gv
.
size
()-1è
	gos
 << ",";

1059 
	gos
 << "]";

1060  
	gos
;

1063 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1064 
	scheck


1066 
runFB
(
IR•ÜtLog
& 
log
);

1067 
runFFB
(
IR•ÜtLog
& 
log
);

1070 
boŞ
 
diff
(cÚ¡ 
¡d
::
veùÜ
<> 
v1
, cÚ¡ std::veùÜ<> 
v2
)

1076 ià(
v1
.
size
()!=
v2
.size()è 
Œue
;

1077 
	gi
=0;i<
	gv1
.
size
();++i)

1078 ià(
çbs
(
v1
[
i
]-
v2
[i])>1e-6)

1081 
	g¡d
::
cout
<<
v1
<<
¡d
::
’dl
;

1082 
	g¡d
::
cout
<<
v2
<<
¡d
::
’dl
;

1083  
	gŒue
;

1086  
	gçl£
;

1089 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1090 
	gcheck
<
	gT
>::
	$runFB
(
IR•ÜtLog
& 
log
)

1092 
¡d
::
veùÜ
<> 
v1
;

1093 
¡d
::
veùÜ
<> 
v2
;

1094 
¡d
::
veùÜ
<> 
v3
;

1097 
Fdiff
< 
T
 > 
Fd
;

1098 
v1
=
	`Fd
(
T
::
	`pošt
());

1102 
Bdiff
< 
T
 > 
Bd
;

1103 
v2
=
	`Bd
(
T
::
	`pošt
());

1106 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 1. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1107 
log
.
	`sucûeded
(è<< "Te¡šg 1. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1110 
Fdiff
< Fdifà< 
T
 > > 
FFd
;

1111 
v1
=
	`FFd
(
T
::
	`pošt
());

1115 
Bdiff
< 
Fdiff
 < 
T
 > > 
BFd
;

1116 
v2
=
	`BFd
(
T
::
	`pošt
());

1119 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 2. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1120 
log
.
	`sucûeded
(è<< "Te¡šg 2. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1123 
Fdiff
< 
Bdiff
 < 
T
 > > 
FBd
;

1124 
v2
=
	`FBd
(
T
::
	`pošt
());

1127 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 2. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1128 
log
.
	`sucûeded
(è<< "Te¡šg 2. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1131 
Bdiff
< Bdifà< 
T
 > > 
BBd
;

1132 
v2
=
	`BBd
(
T
::
	`pošt
());

1135 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 2. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1136 
log
.
	`sucûeded
(è<< "Te¡šg 2. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1139 
Fdiff
 < Fdiff< Fdifà< 
T
 > > > 
FFFd
;

1140 
v1
=
	`FFFd
(
T
::
	`pošt
());

1144 
Bdiff
 < 
Fdiff
< Fdifà< 
T
 > > > 
BFFd
;

1145 
v2
=
	`BFFd
(
T
::
	`pošt
());

1148 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1149 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1152 
Fdiff
 < 
Bdiff
< Fdifà< 
T
 > > > 
FBFd
;

1153 
v2
=
	`FBFd
(
T
::
	`pošt
());

1156 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1157 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1160 
Bdiff
 < Bdiff< 
Fdiff
 < 
T
 > > > 
BBFd
;

1161 
v2
=
	`BBFd
(
T
::
	`pošt
());

1164 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1165 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1168 
Fdiff
 < Fdiff< 
Bdiff
 < 
T
 > > > 
FFBd
;

1169 
v2
=
	`FFBd
(
T
::
	`pošt
());

1172 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1173 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1176 
Bdiff
 < 
Fdiff
< Bdifà< 
T
 > > > 
BFBd
;

1177 
v2
=
	`BFBd
(
T
::
	`pošt
());

1180 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1181 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1184 
Fdiff
 < 
Bdiff
< Bdifà< 
T
 > > > 
FBBd
;

1185 
v2
=
	`FBBd
(
T
::
	`pošt
());

1188 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1189 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1192 
Bdiff
 < Bdiff< Bdifà< 
T
 > > > 
BBBd
;

1193 
v2
=
	`BBBd
(
T
::
	`pošt
());

1196 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1197 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1323 
	}
}

1325 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1326 
	gcheck
<
	gT
>::
	$runFFB
(
IR•ÜtLog
& 
log
)

1328 
¡d
::
veùÜ
<> 
v1
;

1329 
¡d
::
veùÜ
<> 
v2
;

1330 
¡d
::
veùÜ
<> 
v3
;

1333 
FFdiff
< 
T
 > 
Fd
;

1334 
v1
=
	`Fd
(
T
::
	`pošt
());

1338 
Bdiff
< 
T
 > 
Bd
;

1339 
v2
=
	`Bd
(
T
::
	`pošt
());

1342 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 1. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1343 
log
.
	`sucûeded
(è<< "Te¡šg 1. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1346 
FFdiff
< FFdifà< 
T
 > > 
FFd
;

1347 
v1
=
	`FFd
(
T
::
	`pošt
());

1351 
Bdiff
< 
FFdiff
 < 
T
 > > 
BFd
;

1352 
v2
=
	`BFd
(
T
::
	`pošt
());

1355 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 2. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1356 
log
.
	`sucûeded
(è<< "Te¡šg 2. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1359 
FFdiff
< 
Bdiff
 < 
T
 > > 
FBd
;

1360 
v2
=
	`FBd
(
T
::
	`pošt
());

1363 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 2. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1364 
log
.
	`sucûeded
(è<< "Te¡šg 2. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1367 
Bdiff
< Bdifà< 
T
 > > 
BBd
;

1368 
v2
=
	`BBd
(
T
::
	`pošt
());

1371 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 2. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1372 
log
.
	`sucûeded
(è<< "Te¡šg 2. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1375 
FFdiff
 < FFdiff< FFdifà< 
T
 > > > 
FFFd
;

1376 
v1
=
	`FFFd
(
T
::
	`pošt
());

1380 
Bdiff
 < 
FFdiff
< FFdifà< 
T
 > > > 
BFFd
;

1381 
v2
=
	`BFFd
(
T
::
	`pošt
());

1384 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1385 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1388 
FFdiff
 < 
Bdiff
< FFdifà< 
T
 > > > 
FBFd
;

1389 
v2
=
	`FBFd
(
T
::
	`pošt
());

1392 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1393 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1396 
Bdiff
 < Bdiff< 
FFdiff
 < 
T
 > > > 
BBFd
;

1397 
v2
=
	`BBFd
(
T
::
	`pošt
());

1400 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1401 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1404 
FFdiff
 < FFdiff< 
Bdiff
 < 
T
 > > > 
FFBd
;

1405 
v2
=
	`FFBd
(
T
::
	`pošt
());

1408 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1409 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1412 
Bdiff
 < 
FFdiff
< Bdifà< 
T
 > > > 
BFBd
;

1413 
v2
=
	`BFBd
(
T
::
	`pošt
());

1416 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1417 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1420 
FFdiff
 < 
Bdiff
< Bdifà< 
T
 > > > 
FBBd
;

1421 
v2
=
	`FBBd
(
T
::
	`pošt
());

1424 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1425 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1428 
Bdiff
 < Bdiff< Bdifà< 
T
 > > > 
BBBd
;

1429 
v2
=
	`BBBd
(
T
::
	`pošt
());

1432 ià(
	`diff
(
v1
,
v2
)è
log
.
	`çed
(è<< "Te¡šg 3. ord” d”iv©ivçed fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1433 
log
.
	`sucûeded
(è<< "Te¡šg 3. ord” d”iv©ivsucûeded fÜ " << 
T
::
	`Name
(è<< 
¡d
::
’dl
;

1559 
	}
}

1563 
	gTe¡FADBAD
::
	$run
(
IR•ÜtLog
& 
¾og
)

1565 { 
check
<
Add
> 
chk
; chk.
	`runFB
(
¾og
); }

1566 { 
check
<
Add1
> 
chk
; chk.
	`runFB
(
¾og
); }

1567 { 
check
<
CAdd
> 
chk
; chk.
	`runFB
(
¾og
); }

1568 { 
check
<
CAdd1
> 
chk
; chk.
	`runFB
(
¾og
); }

1569 { 
check
<
CAdd2
> 
chk
; chk.
	`runFB
(
¾og
); }

1570 { 
check
<
Add2
> 
chk
; chk.
	`runFB
(
¾og
); }

1571 { 
check
<
Add3
> 
chk
; chk.
	`runFB
(
¾og
); }

1572 { 
check
<
Sub
> 
chk
; chk.
	`runFB
(
¾og
); }

1573 { 
check
<
Sub1
> 
chk
; chk.
	`runFB
(
¾og
); }

1574 { 
check
<
CSub
> 
chk
; chk.
	`runFB
(
¾og
); }

1575 { 
check
<
CSub1
> 
chk
; chk.
	`runFB
(
¾og
); }

1576 { 
check
<
CSub2
> 
chk
; chk.
	`runFB
(
¾og
); }

1577 { 
check
<
Sub2
> 
chk
; chk.
	`runFB
(
¾og
); }

1578 { 
check
<
Sub3
> 
chk
; chk.
	`runFB
(
¾og
); }

1579 { 
check
<
Mul
> 
chk
; chk.
	`runFB
(
¾og
); }

1580 { 
check
<
Mul1
> 
chk
; chk.
	`runFB
(
¾og
); }

1581 { 
check
<
CMul
> 
chk
; chk.
	`runFB
(
¾og
); }

1582 { 
check
<
CMul1
> 
chk
; chk.
	`runFB
(
¾og
); }

1583 { 
check
<
CMul2
> 
chk
; chk.
	`runFB
(
¾og
); }

1584 { 
check
<
Mul2
> 
chk
; chk.
	`runFB
(
¾og
); }

1585 { 
check
<
Mul3
> 
chk
; chk.
	`runFB
(
¾og
); }

1586 { 
check
<
Div
> 
chk
; chk.
	`runFB
(
¾og
); }

1587 { 
check
<
Div1
> 
chk
; chk.
	`runFB
(
¾og
); }

1588 { 
check
<
CDiv
> 
chk
; chk.
	`runFB
(
¾og
); }

1589 { 
check
<
CDiv1
> 
chk
; chk.
	`runFB
(
¾og
); }

1590 { 
check
<
CDiv2
> 
chk
; chk.
	`runFB
(
¾og
); }

1591 { 
check
<
Div2
> 
chk
; chk.
	`runFB
(
¾og
); }

1592 { 
check
<
Div3
> 
chk
; chk.
	`runFB
(
¾og
); }

1593 { 
check
<
Pow
> 
chk
; chk.
	`runFB
(
¾og
); }

1594 { 
check
<
Pow2
> 
chk
; chk.
	`runFB
(
¾og
); }

1595 { 
check
<
UAdd
> 
chk
; chk.
	`runFB
(
¾og
); }

1596 { 
check
<
USub
> 
chk
; chk.
	`runFB
(
¾og
); }

1597 { 
check
<
Sqr
> 
chk
; chk.
	`runFB
(
¾og
); }

1598 { 
check
<
Exp
> 
chk
; chk.
	`runFB
(
¾og
); }

1599 { 
check
<
Log
> 
chk
; chk.
	`runFB
(
¾og
); }

1600 { 
check
<
Sq¹
> 
chk
; chk.
	`runFB
(
¾og
); }

1601 { 
check
<
Sš
> 
chk
; chk.
	`runFB
(
¾og
); }

1602 { 
check
<
Cos
> 
chk
; chk.
	`runFB
(
¾og
); }

1603 { 
check
<
Tª
> 
chk
; chk.
	`runFB
(
¾og
); }

1604 { 
check
<
ASš
> 
chk
; chk.
	`runFB
(
¾og
); }

1605 { 
check
<
ACos
> 
chk
; chk.
	`runFB
(
¾og
); }

1606 { 
check
<
ATª
> 
chk
; chk.
	`runFB
(
¾og
); }

1607 { 
check
<
Nd
> 
chk
; chk.
	`runFB
(
¾og
); }

1608 { 
check
<
Cnd
> 
chk
; chk.
	`runFB
(
¾og
); }

1609 { 
check
<
Iúd
> 
chk
; chk.
	`runFB
(
¾og
); }

1610 { 
check
<
csm­
> 
chk
; chk.
	`runFB
(
¾og
); }

1611 { 
check
<
func1
> 
chk
; chk.
	`runFB
(
¾og
); }

1613 { 
check
<
Add
> 
chk
; chk.
	`runFFB
(
¾og
); }

1614 { 
check
<
Add1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1615 { 
check
<
CAdd
> 
chk
; chk.
	`runFFB
(
¾og
); }

1616 { 
check
<
CAdd1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1617 { 
check
<
CAdd2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1618 { 
check
<
Add1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1619 { 
check
<
Add2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1620 { 
check
<
Sub
> 
chk
; chk.
	`runFFB
(
¾og
); }

1621 { 
check
<
Sub1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1622 { 
check
<
CSub
> 
chk
; chk.
	`runFFB
(
¾og
); }

1623 { 
check
<
CSub1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1624 { 
check
<
CSub2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1625 { 
check
<
Sub1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1626 { 
check
<
Sub2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1627 { 
check
<
Mul
> 
chk
; chk.
	`runFFB
(
¾og
); }

1628 { 
check
<
Mul1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1629 { 
check
<
CMul
> 
chk
; chk.
	`runFFB
(
¾og
); }

1630 { 
check
<
CMul1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1631 { 
check
<
CMul2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1632 { 
check
<
Mul1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1633 { 
check
<
Mul2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1634 { 
check
<
Div
> 
chk
; chk.
	`runFFB
(
¾og
); }

1635 { 
check
<
Div1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1636 { 
check
<
CDiv
> 
chk
; chk.
	`runFFB
(
¾og
); }

1637 { 
check
<
CDiv1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1638 { 
check
<
CDiv2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1639 { 
check
<
Div1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1640 { 
check
<
Div2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1641 { 
check
<
Pow
> 
chk
; chk.
	`runFFB
(
¾og
); }

1642 { 
check
<
Pow2
> 
chk
; chk.
	`runFFB
(
¾og
); }

1643 { 
check
<
UAdd
> 
chk
; chk.
	`runFB
(
¾og
); }

1644 { 
check
<
USub
> 
chk
; chk.
	`runFB
(
¾og
); }

1645 { 
check
<
Sqr
> 
chk
; chk.
	`runFFB
(
¾og
); }

1646 { 
check
<
Exp
> 
chk
; chk.
	`runFFB
(
¾og
); }

1647 { 
check
<
Log
> 
chk
; chk.
	`runFFB
(
¾og
); }

1648 { 
check
<
Sq¹
> 
chk
; chk.
	`runFFB
(
¾og
); }

1649 { 
check
<
Sš
> 
chk
; chk.
	`runFFB
(
¾og
); }

1650 { 
check
<
Cos
> 
chk
; chk.
	`runFFB
(
¾og
); }

1651 { 
check
<
Tª
> 
chk
; chk.
	`runFFB
(
¾og
); }

1652 { 
check
<
ASš
> 
chk
; chk.
	`runFFB
(
¾og
); }

1653 { 
check
<
ACos
> 
chk
; chk.
	`runFFB
(
¾og
); }

1654 { 
check
<
ATª
> 
chk
; chk.
	`runFFB
(
¾og
); }

1655 { 
check
<
Nd
> 
chk
; chk.
	`runFFB
(
¾og
); }

1656 { 
check
<
Cnd
> 
chk
; chk.
	`runFFB
(
¾og
); }

1657 { 
check
<
Iúd
> 
chk
; chk.
	`runFFB
(
¾og
); }

1658 { 
check
<
csm­
> 
chk
; chk.
	`runFFB
(
¾og
); }

1659 { 
check
<
func1
> 
chk
; chk.
	`runFFB
(
¾og
); }

1660 
	}
}

	@robot/FADBAD++/test/TestFADBAD.h

1 #iâdeà
TEST_FADBAD_H


2 
	#TEST_FADBAD_H


	)

4 
	~"IR•ÜtLogg”.h
"

6 şas 
	cTe¡FADBAD
 : 
public
 
IR•ÜtLogg”


8 
public
:

9 
run
(
IR•ÜtLog
& 
¾og
);

	@robot/FADBAD++/test/TestTAD.cpp

1 
	~"diff.h
"

2 
	~"exŒa/ndf.h
"

3 
	~"exŒa/ndçd.h
"

5 
	~"Te¡TAD.h
"

7 
	~<io¡»am
>

9 
usšg
 
Çme¥aû
 
	g¡d
;

10 
usšg
 
Çme¥aû
 
	gçdbad
;

12 
	g‹m¶©e
 <
ty³Çme
 
	gF
, 
	gORDER
>

13 şas 
	cDIÁeg¿l


15 
F
 
	mm_func
;

16 
	mpublic
:

17 
	$DIÁeg¿l
():
	$m_func
(){}

18 
	$DIÁeg¿l
(cÚ¡ 
F
& 
f
):
	$m_func
(
f
){
	}
}

19 
‹m¶©e
 <
ty³Çme
 
aTy³
>

20 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
 
a
, cÚ¡‡Ty³ 
b
)

22 
T
< 
aTy³
 > 
x
,
fx
;

23 
aTy³
 
	`h2
((
b
-
a
)/2),
»s
;

24 
x
=(
a
+
b
)/2;

25 
x
[1]=1;

26 
fx
=
	`m_func
(
x
);

27 
fx
.
	`ev®
(
ORDER
);

28 
»s
=0;

30 
i
=
ORDER
;i>=0;i--)

31 
»s
+=
fx
[
i
]*(
	`pow
(
h2
,i+1)-pow(-h2,i+1))/(i+1);

32  
»s
;

33 
	}
}

36 
	g‹m¶©e
 <
ty³Çme
 
	gF
, 
	gORDER
=5, 
	gN
=10>

37 şas 
	cIÁeg¿l


39 
DIÁeg¿l
<
F
,
ORDER
> 
m_dIÁ
;

40 
	mpublic
:

41 
	$IÁeg¿l
():
	$m_dIÁ
(){}

42 
	$IÁeg¿l
(cÚ¡ 
F
& 
f
):
	$m_dIÁ
(
f
){
	}
}

43 
‹m¶©e
 <
ty³Çme
 
aTy³
>

44 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
 
a
, cÚ¡‡Ty³ 
b
)

46 
i
,
j
;

47 
aTy³
 
»s
=0;

48 
i
=0;i<
N
;i++)

50 
j
=
i
+1;

51 
»s
+=
	`m_dIÁ
((
a
*(
N
-
i
)+
b
*i)/N,×*(N-
j
)+b*j)/N);

53  
»s
;

54 
	}
}

58 
	g‹m¶©e
 <
ty³Çme
 
	gF
,y³Çm
	gU
>

59 şas 
	cTaylÜODE


61 
	mT
<
	mU
> 
	mš
[
F
::
n
];

62 
	mT
<
	mU
> 
	mout
[
F
::
n
];

63 
	mpublic
:

64 
	$TaylÜODE
(){ 
	`F
(
š
,
out
); }

65 
	$»£t
()

67 
j
=0;j<
F
::
n
;++jè
out
[j].
	`»£t
();

68 
	}
}

69 
	gU
& 
	gİ”©Ü
[](cÚ¡ 
	gj
){  
	gš
[
j
][0]; }

70 
	$š™
(è{ 
F
::
	`š™
(
š
); 
	}
}

71 
	$ev®
(
Üd”
)

73 
i
=0;i<
Üd”
;++i)

75 
j
=0;j<
F
::
n
;++j)

77 
out
[
j
].
	`ev®
(
i
);

78 
š
[
j
][
i
+1]=
out
[j][i]/(i+1);

81 
	}
}

82 
	g¡d
::
o¡»am
& 
	$´št
(
¡d
::
o¡»am
& 
o¡
) const

84 
j
=0;j<
F
::
n
;++j)

86 
o¡
<<
j
<<" :";

87 
i
=0;i<
š
[
j
].
	`Ëngth
();++iè
o¡
<<" "<<in[j][i];

88 
o¡
<<
¡d
::
’dl
;

90 
	}
}

91 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
TaylÜODE
<
F
,
	gU
>& 
	gÙh”
)

93 
	gj
=0;j<
	gF
::
n
;++j)

95 ià(
	gš
[
j
].
Ëngth
()!=
Ùh”
.
š
[j].Ëngth()è 
Œue
;

96 ià(
	gout
[
j
].
Ëngth
()!=
Ùh”
.
out
[j].Ëngth()è 
Œue
;

98 
	gj
=0;j<
	gF
::
n
;++j)

100 
	gi
=0;i<
	gš
[
j
].
Ëngth
();++i)

102 ià(
	gš
[
j
][
i
]!=
Ùh”
.
š
[j][i]è 
Œue
;

104 
	gi
=0;i<
	gout
[
j
].
Ëngth
();++i)

106 ià(
	gout
[
j
][
i
]!=
Ùh”
.
out
[j][i]è 
Œue
;

109  
	gçl£
;

113 şas 
	cF1


115 
	mpublic
:

116 
‹m¶©e
 <
ty³Çme
 
aTy³
>

117 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

119 
aTy³
 
	`exx
(
	`exp
(
x
*x));

120  2.0*
x
*
exx
*
	`sš
(exx);

122 
	}
};

124 şas 
	cF2


126 
	mm_a
;

127 
	mpublic
:

128 
	$F2
(cÚ¡ & 
a
):
	$m_a
(
a
){}

129 
‹m¶©e
 <
ty³Çme
 
aTy³
>

130 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

132  1/
	`sq¹
(
m_a
*m_a-
x
*x);

133 
	}
}

136 şas 
	cF3


138 
	mm_a
;

139 
	mpublic
:

140 
	$F3
(cÚ¡ & 
a
):
	$m_a
(
a
){}

141 
‹m¶©e
 <
ty³Çme
 
aTy³
>

142 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

144  
	`sq¹
(
m_a
*m_a-
x
*x);

145 
	}
}

148 şas 
	cF4


150 
	mm_a
;

151 
	mpublic
:

152 
	$F4
(cÚ¡ & 
a
):
	$m_a
(
a
){}

153 
‹m¶©e
 <
ty³Çme
 
aTy³
>

154 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

156  1/(1-2*
m_a
*
	`cos
(
x
)+m_a*m_a);

157 
	}
}

160 şas 
	cF5


162 
	mpublic
:

163 
‹m¶©e
 <
ty³Çme
 
aTy³
>

164 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

166  
	`log
(1-
x
)/x;

168 
	}
};

170 şas 
	cF6


172 
	mpublic
:

173 
‹m¶©e
 <
ty³Çme
 
aTy³
>

174 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

176  
	`log
(
	`exp
(
x
));

178 
	}
};

180 şas 
	cF7


182 
	mpublic
:

183 
‹m¶©e
 <
ty³Çme
 
aTy³
>

184 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

186  
	`sš
(
	`asš
(
x
));

188 
	}
};

190 şas 
	cF8


192 
	mpublic
:

193 
‹m¶©e
 <
ty³Çme
 
aTy³
>

194 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

196  
	`cos
(
	`acos
(
x
));

198 
	}
};

200 şas 
	cF9


202 
	mpublic
:

203 
‹m¶©e
 <
ty³Çme
 
aTy³
>

204 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

206  
	`©ª
(
	`n
(
x
));

208 
	}
};

210 şas 
	cF10


212 
	mpublic
:

213 
‹m¶©e
 <
ty³Çme
 
aTy³
>

214 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

216  
	`sq¹
(
	`sqr
(
x
));

218 
	}
};

220 şas 
	cF11


222 
	mpublic
:

223 
‹m¶©e
 <
ty³Çme
 
aTy³
>

224 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

226  
	`iúd
(
	`úd
(
x
));

228 
	}
};

230 şas 
	cF12


232 
	mpublic
:

233 
‹m¶©e
 <
ty³Çme
 
aTy³
>

234 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

236  
	`exp
(
	`log
(
	`pow
(
x
,x))/x);

238 
	}
};

240 şas 
	cF13


242 
	mpublic
:

243 
‹m¶©e
 <
ty³Çme
 
aTy³
>

244 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

246  
	`exp
(
	`log
(
	`pow
(
x
,1.234))/1.234);

248 
	}
};

250 şas 
	cF14


252 
	mpublic
:

253 
‹m¶©e
 <
ty³Çme
 
aTy³
>

254 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

256  
	`log
(
	`pow
(1.234,
x
))/log(1.234);

258 
	}
};

260 şas 
	cF15


262 
	mpublic
:

263 
‹m¶©e
 <
ty³Çme
 
aTy³
>

264 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

266  (
x
+1.465)-1.465;

268 
	}
};

270 şas 
	cF16


272 
	mpublic
:

273 
‹m¶©e
 <
ty³Çme
 
aTy³
>

274 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

276  (1.465+
x
)-1.465;

278 
	}
};

280 şas 
	cF17


282 
	mpublic
:

283 
‹m¶©e
 <
ty³Çme
 
aTy³
>

284 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

286  (
x
-1.465)+1.465;

288 
	}
};

290 şas 
	cF18


292 
	mpublic
:

293 
‹m¶©e
 <
ty³Çme
 
aTy³
>

294 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

296  -(1.465-
x
)+1.465;

298 
	}
};

300 şas 
	cF19


302 
	mpublic
:

303 
‹m¶©e
 <
ty³Çme
 
aTy³
>

304 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

306  (
x
*1.465)/1.465;

308 
	}
};

310 şas 
	cF20


312 
	mpublic
:

313 
‹m¶©e
 <
ty³Çme
 
aTy³
>

314 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

316  (1.465*
x
)/1.465;

318 
	}
};

320 şas 
	cF21


322 
	mpublic
:

323 
‹m¶©e
 <
ty³Çme
 
aTy³
>

324 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

326  (
x
/1.465)*1.465;

328 
	}
};

330 şas 
	cF22


332 
	mpublic
:

333 
‹m¶©e
 <
ty³Çme
 
aTy³
>

334 
aTy³
 
	$İ”©Ü
 ()(cÚ¡ 
aTy³
& 
x
)

336  1.0/((1.465/
x
)/1.465);

338 
	}
};

340 
	sF23


342 cÚ¡ 
	mn
=2;

343 
	m‹m¶©e
 <
ty³Çme
 
	mU
>

344 
š™
(
U
* 
š
)

346 
	mš
[0][0]=
sš
(0.0);

347 
	mš
[1][0]=
cos
(0.0);

350 
	m‹m¶©e
 <
ty³Çme
 
	mU
>

351 
F23
(cÚ¡ 
U
* 
š
, U* 
out
)

353 
	mout
[0]=+
š
[1];

354 
	mout
[1]=-
š
[0];

358 
	sF24


360 cÚ¡ 
	mn
=3;

361 
	m‹m¶©e
 <
ty³Çme
 
	mU
>

362 
š™
(
U
* 
š
)

364 
	mš
[0][0]=1;

365 
	mš
[1][0]=1;

366 
	mš
[2][0]=1;

369 
	m‹m¶©e
 <
ty³Çme
 
	mU
>

370 
F24
(cÚ¡ 
U
* 
y
, U* 
yp
)

372 
sigma
(10.0),
rho
(28.0);

373 
b‘a
(8.0/3.0);

375 
	myp
[0] = 
sigma
*(
y
[1]-y[0]);

376 
	myp
[1] = 
y
[0]*(
rho
-y[2])-y[1];

377 
	myp
[2] = 
y
[0]*y[1]-
b‘a
*y[2];

383 
	gTe¡TAD
::
	$run
(
IR•ÜtLog
& 
¾og
)

385 
num”iÿl
, 
ª®ytiÿl
;

387 
num”iÿl
=
IÁeg¿l
<
F1
,6,160>()(0.0,2.0);

388 
ª®ytiÿl
=
	`cos
(1.0)-cos(
	`exp
(4.0));

391 ià(
	`çbs
(
num”iÿl
-
ª®ytiÿl
)>0.01)

392 
¾og
.
	`çed
(è<< "IÁeg¿ÈoàF1 faed" << 
’dl
;

394 
¾og
.
	`sucûeded
(è<< "IÁeg¿ÈoàF1 sucûeded" << 
’dl
;

397 
a
=5;

398 
F2
 
	`f2
(
a
);

399 
num”iÿl
=
IÁeg¿l
<
F2
,10,500>(
f2
)(0.0,
a
);

400 
ª®ytiÿl
=3.141592653589793/2;

403 ià(
	`çbs
(
num”iÿl
-
ª®ytiÿl
)>0.01)

404 
¾og
.
	`çed
(è<< "IÁeg¿ÈoàF2 faed" << 
’dl
;

406 
¾og
.
	`sucûeded
(è<< "IÁeg¿ÈoàF2 sucûeded" << 
’dl
;

408 
F3
 
	`f3
(
a
);

409 
num”iÿl
=
IÁeg¿l
<
F3
,6,160>(
f3
)(0.0,
a
);

410 
ª®ytiÿl
=3.141592653589793*
a
*a/4;

413 ià(
	`çbs
(
num”iÿl
-
ª®ytiÿl
)>0.01)

414 
¾og
.
	`çed
(è<< "IÁeg¿ÈoàF3 faed" << 
’dl
;

416 
¾og
.
	`sucûeded
(è<< "IÁeg¿ÈoàF3 sucûeded" << 
’dl
;

418 
a
=0.4;

419 
F4
 
	`f4
(
a
);

420 
num”iÿl
=
IÁeg¿l
<
F4
,6,160>(
f4
)(0.0,2*3.141592653589793);

421 
ª®ytiÿl
=2*3.141592653589793/(1-
a
*a);

424 ià(
	`çbs
(
num”iÿl
-
ª®ytiÿl
)>0.01)

425 
¾og
.
	`çed
(è<< "IÁeg¿ÈoàF4 faed" << 
’dl
;

427 
¾og
.
	`sucûeded
(è<< "IÁeg¿ÈoàF4 sucûeded" << 
’dl
;

429 
num”iÿl
=
IÁeg¿l
<
F5
,6,160>()(0.0,1.0);

430 
ª®ytiÿl
=-
	`pow
(3.141592653589793,2)/6;

433 ià(
	`çbs
(
num”iÿl
-
ª®ytiÿl
)>0.01)

434 
¾og
.
	`çed
(è<< "IÁeg¿ÈoàF5 faed" << 
’dl
;

436 
¾og
.
	`sucûeded
(è<< "IÁeg¿ÈoàF5 sucûeded" << 
’dl
;

438 
T
<> 
x
,
y
;

439 
x
[0]=0.123;

440 
x
[1]=1;

441 
y
=
	`F6
()(
x
);

442 
y
.
	`ev®
(10);

443 
i
=0;i<=10;++i)

445 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-10)

447 
¾og
.
	`çed
(è<< "F6 "<<
i
<<"'th ord” faed" << 
’dl
;

450 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F6 sucûeded" << 
’dl
;

453 
y
=
	`F7
()(
x
);

454 
y
.
	`ev®
(10);

455 
i
=0;i<=10;++i)

457 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-10)

459 
¾og
.
	`çed
(è<< "F7 "<<
i
<<"'th ord” faed" << 
’dl
;

462 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F7 sucûeded" << 
’dl
;

465 
y
=
	`F8
()(
x
);

466 
y
.
	`ev®
(10);

467 
i
=0;i<=10;++i)

469 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-10)

471 
¾og
.
	`çed
(è<< "F8 "<<
i
<<"'th ord” faed" << 
’dl
;

474 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F8 sucûeded" << 
’dl
;

478 
y
=
	`F9
()(
x
);

479 
y
.
	`ev®
(10);

480 
i
=0;i<=10;++i)

482 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-10)

484 
¾og
.
	`çed
(è<< "F9 "<<
i
<<"'th ord” faed" << 
’dl
;

487 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F9 sucûeded" << 
’dl
;

490 
y
=
	`F10
()(
x
);

491 
y
.
	`ev®
(10);

492 
i
=0;i<=10;++i)

494 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-10)

496 
¾og
.
	`çed
(è<< "F10 "<<
i
<<"'th ord” faed" << 
’dl
;

499 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F10 sucûeded" << 
’dl
;

502 
y
=
	`F11
()(
x
);

503 
y
.
	`ev®
(10);

504 
i
=0;i<=10;++i)

506 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-10)

508 
¾og
.
	`çed
(è<< "F11 "<<
i
<<"'th ord” faed" << 
’dl
;

511 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F11 sucûeded" << 
’dl
;

514 
y
=
	`F12
()(
x
);

515 
y
.
	`ev®
(10);

516 
i
=0;i<=10;++i)

518 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

520 
¾og
.
	`çed
(è<< "F12 "<<
i
<<"'th ord” faed" << 
’dl
;

523 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F12 sucûeded" << 
’dl
;

526 
y
=
	`F13
()(
x
);

527 
y
.
	`ev®
(10);

528 
i
=0;i<=10;++i)

530 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

532 
¾og
.
	`çed
(è<< "F13 "<<
i
<<"'th ord” faed" << 
’dl
;

535 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F13 sucûeded" << 
’dl
;

538 
y
=
	`F14
()(
x
);

539 
y
.
	`ev®
(10);

540 
i
=0;i<=10;++i)

542 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

544 
¾og
.
	`çed
(è<< "F14 "<<
i
<<"'th ord” faed" << 
’dl
;

547 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F14 sucûeded" << 
’dl
;

550 
y
=
	`F15
()(
x
);

551 
y
.
	`ev®
(10);

552 
i
=0;i<=10;++i)

554 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

556 
¾og
.
	`çed
(è<< "F15 "<<
i
<<"'th ord” faed" << 
’dl
;

559 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F15 sucûeded" << 
’dl
;

562 
y
=
	`F16
()(
x
);

563 
y
.
	`ev®
(10);

564 
i
=0;i<=10;++i)

566 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

568 
¾og
.
	`çed
(è<< "F16 "<<
i
<<"'th ord” faed" << 
’dl
;

571 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F16 sucûeded" << 
’dl
;

574 
y
=
	`F17
()(
x
);

575 
y
.
	`ev®
(10);

576 
i
=0;i<=10;++i)

578 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

580 
¾og
.
	`çed
(è<< "F17 "<<
i
<<"'th ord” faed" << 
’dl
;

583 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F17 sucûeded" << 
’dl
;

586 
y
=
	`F18
()(
x
);

587 
y
.
	`ev®
(10);

588 
i
=0;i<=10;++i)

590 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

592 
¾og
.
	`çed
(è<< "F18 "<<
i
<<"'th ord” faed" << 
’dl
;

595 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F18 sucûeded" << 
’dl
;

598 
y
=
	`F19
()(
x
);

599 
y
.
	`ev®
(10);

600 
i
=0;i<=10;++i)

602 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

604 
¾og
.
	`çed
(è<< "F19 "<<
i
<<"'th ord” faed" << 
’dl
;

607 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F19 sucûeded" << 
’dl
;

610 
y
=
	`F20
()(
x
);

611 
y
.
	`ev®
(10);

612 
i
=0;i<=10;++i)

614 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

616 
¾og
.
	`çed
(è<< "F20 "<<
i
<<"'th ord” faed" << 
’dl
;

619 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F20 sucûeded" << 
’dl
;

622 
y
=
	`F21
()(
x
);

623 
y
.
	`ev®
(10);

624 
i
=0;i<=10;++i)

626 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

628 
¾og
.
	`çed
(è<< "F21 "<<
i
<<"'th ord” faed" << 
’dl
;

631 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F21 sucûeded" << 
’dl
;

634 
y
=
	`F22
()(
x
);

635 
y
.
	`ev®
(10);

636 
i
=0;i<=10;++i)

638 ià(
	`çbs
(
y
[
i
]-
x
[i])>1e-7)

640 
¾og
.
	`çed
(è<< "F22 "<<
i
<<"'th ord” faed" << 
’dl
;

643 ià(
i
==10è
¾og
.
	`sucûeded
(è<< "F22 sucûeded" << 
’dl
;

648 
TaylÜODE
<
F23
,> 
TF23a
;

649 
TF23a
.
	`»£t
();

650 
TF23a
.
	`š™
();

652 
TF23a
.
	`ev®
(10);

655 
TaylÜODE
<
F23
,> 
TF23b
;

656 
TF23b
.
	`š™
();

657 
TF23b
.
	`»£t
();

659 
TF23b
.
	`ev®
(10);

662 ià(
TF23a
!=
TF23b
)

664 
¾og
.
	`çed
(è<< "F23 faed" << 
’dl
;

668 
¾og
.
	`sucûeded
(è<< "F23 sucûeded" << 
’dl
;

671 
TaylÜODE
<
F24
,> 
TF24a
;

672 
TaylÜODE
<
F24
,> 
TF24b
;

673 
TF24a
.
	`»£t
();

674 
TF24a
.
	`š™
();

675 
TF24a
.
	`ev®
(10);

678 
TF24b
.
	`»£t
();

679 
TF24b
.
	`š™
();

680 
TF24b
.
	`ev®
(10);

683 
TF24b
.
	`š™
();

684 
TF24b
.
	`»£t
();

685 
TF24b
.
	`ev®
(10);

688 ià(
TF24a
!=
TF24b
)

690 
¾og
.
	`çed
(è<< "F24 faed" << 
’dl
;

694 
¾og
.
	`sucûeded
(è<< "F24 sucûeded" << 
’dl
;

699 
	}
}

	@robot/FADBAD++/test/TestTAD.h

1 #iâdeà
TEST_TAD_H


2 
	#TEST_TAD_H


	)

4 
	~"IR•ÜtLogg”.h
"

6 şas 
	cTe¡TAD
 : 
public
 
IR•ÜtLogg”


8 
public
:

9 
run
(
IR•ÜtLog
& 
¾og
);

	@robot/FADBAD++/test/TestUDT.cpp

4 
	~"çdbad.h
"

5 
	~<io¡»am
>

7 
	~"Te¡UDT.h
"

9 
usšg
 
Çme¥aû
 
	gçdbad
;

11 şas 
	cUDT


13 
	mpublic
:

14 
	$UDT
(){ }

15 
	$UDT
(cÚ¡ 
UDT
&){ 
	}
}

16 
	$UDT
(cÚ¡ &){ 
	}
}

17 
	$UDT
(cÚ¡ ){ 
	}
}

18 
UDT
& 
İ”©Ü
=(cÚ¡ UDT&){  *
this
; }

19 
	gUDT
& 
	gİ”©Ü
=(cÚ¡ &){  *
this
; }

20 
	gUDT
& 
	gİ”©Ü
+=(cÚ¡ 
UDT
&){  *
this
; }

21 
	gUDT
& 
	gİ”©Ü
+=(cÚ¡ &){  *
this
; }

22 
	gUDT
& 
	gİ”©Ü
-=(cÚ¡ 
UDT
&){  *
this
; }

23 
	gUDT
& 
	gİ”©Ü
-=(cÚ¡ &){  *
this
; }

26 
UDT
 
	gİ”©Ü
 + (cÚ¡ 
	gUDT
&, const UDT&) {  UDT(); }

27 
UDT
 
	gİ”©Ü
 - (cÚ¡ 
	gUDT
&, const UDT&) {  UDT(); }

28 
UDT
 
	gİ”©Ü
 * (cÚ¡ 
	gUDT
&, const UDT&) {  UDT(); }

29 
UDT
 
	gİ”©Ü
 / (cÚ¡ 
	gUDT
&, const UDT&) {  UDT(); }

30 
UDT
 
	gİ”©Ü
 + (cÚ¡ 
	gUDT
&, const &) {  UDT(); }

31 
UDT
 
	gİ”©Ü
 - (cÚ¡ 
	gUDT
&, const &) {  UDT(); }

32 
UDT
 
	gİ”©Ü
 * (cÚ¡ 
	gUDT
&, const &) {  UDT(); }

33 
UDT
 
	gİ”©Ü
 / (cÚ¡ 
	gUDT
&, const &) {  UDT(); }

34 
UDT
 
	gİ”©Ü
 + (cÚ¡ &, cÚ¡ 
	gUDT
&) {  UDT(); }

35 
UDT
 
	gİ”©Ü
 - (cÚ¡ &, cÚ¡ 
	gUDT
&) {  UDT(); }

36 
UDT
 
	gİ”©Ü
 * (cÚ¡ &, cÚ¡ 
	gUDT
&) {  UDT(); }

37 
UDT
 
	gİ”©Ü
 / (cÚ¡ &, cÚ¡ 
	gUDT
&) {  UDT(); }

38 
UDT
 
	$Exp
(cÚ¡ 
UDT
&è{  
	`UDT
(); 
	}
}

39 
UDT
 
	$Sqr
(cÚ¡ 
UDT
&è{  
	`UDT
(); 
	}
}

40 
UDT
 
	$Sš
(cÚ¡ 
UDT
&è{  
	`UDT
(); 
	}
}

41 
UDT
 
	$Cos
(cÚ¡ 
UDT
&è{  
	`UDT
(); 
	}
}

43 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
UDT
&,cÚ¡ 
	gUDT
&){ 
	gŒue
;}

44 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
UDT
&,cÚ¡ 
	gUDT
&){ 
	gŒue
;}

45 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gUDT
&,cÚ¡ UDT&){ 
	gŒue
;}

46 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gUDT
&,cÚ¡ UDT&){ 
	gŒue
;}

47 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
UDT
&,cÚ¡ 
	gUDT
&){ 
	gŒue
;}

48 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
UDT
&,cÚ¡ 
	gUDT
&){ 
	gŒue
;}

50 
Çme¥aû
 
	gçdbad


52 
	g‹m¶©e
 <> 
	gOp
<
	gUDT
>

54 
UDT
 
	tBa£
;

55 
Ba£
 
myIÁeg”
(cÚ¡ 
i
) {  Base(i); }

56 
Ba£
 
myZ”o
() {  Base(0); }

57 
Ba£
 
myOÃ
() {  Base(1);}

58 
Ba£
 
myTwo
() {  Base(2); }

59 
UDT
 
myPos
(const UDT& ) {  UDT(); }

60 
UDT
 
myNeg
(const UDT& ) {  UDT(); }

61 
	gUDT
& 
myCadd
(
UDT
& 
x
, cÚ¡ UDT& 
y
è{ 
	gx
=x+y;  x; }

62 
	gUDT
& 
myCsub
(
UDT
& 
x
, cÚ¡ UDT& 
y
è{ 
	gx
=x-y;  x; }

63 
	gUDT
& 
myCmul
(
UDT
& 
x
, cÚ¡ UDT& 
y
è{ 
	gx
=x*y;  x; }

64 
	gUDT
& 
myCdiv
(
UDT
& 
x
, cÚ¡ UDT& 
y
è{ 
	gx
=x/y;  x; }

65 
UDT
 
myInv
(cÚ¡ UDT& 
x
è{  
myOÃ
()/
	gx
; }

66 
UDT
 
mySqr
(cÚ¡ UDT& 
x
è{  ::
Sqr
(x); }

67 
UDT
 
myPow
(cÚ¡ UDT& , cÚ¡ è{ 
	gthrow
;  UDT(); }

68 
UDT
 
myPow
(cÚ¡ UDT& , cÚ¡ UDT& ) { 
	gthrow
;  UDT(); }

69 
UDT
 
mySq¹
(cÚ¡ UDT& ) { 
	gthrow
;  UDT(); }

70 
UDT
 
myLog
(cÚ¡ UDT& ) { 
	gthrow
;  UDT(); }

71 
UDT
 
myExp
(cÚ¡ UDT& 
x
è{  ::
Exp
(x); }

72 
UDT
 
mySš
(cÚ¡ UDT& 
x
è{  ::
Sš
(x); }

73 
UDT
 
myCos
(cÚ¡ UDT& 
x
è{  ::
Cos
(x); }

74 
UDT
 
myTª
(cÚ¡ UDT& ) { 
	gthrow
;  UDT(); }

75 
UDT
 
myAsš
(cÚ¡ UDT& ) { 
	gthrow
;  UDT(); }

76 
UDT
 
myAcos
(cÚ¡ UDT& ) { 
	gthrow
;  UDT(); }

77 
UDT
 
myAn
(cÚ¡ UDT& ) { 
	gthrow
;  UDT(); }

78 
boŞ
 
myEq
(cÚ¡ 
UDT
& 
x
, cÚ¡ UDT& 
y
è{  
	gx
==y; }

79 
boŞ
 
myNe
(cÚ¡ 
UDT
& 
x
, cÚ¡ UDT& 
y
è{  
	gx
!=y; }

80 
boŞ
 
myLt
(cÚ¡ 
UDT
& 
x
, cÚ¡ UDT& 
y
è{  
	gx
<
	gy
; }

81 
boŞ
 
myLe
(cÚ¡ 
UDT
& 
x
, cÚ¡ UDT& 
y
è{  
	gx
<=y; }

82 
boŞ
 
myGt
(cÚ¡ 
UDT
& 
x
, cÚ¡ UDT& 
y
è{  
	gx
>
	gy
; }

83 
boŞ
 
myGe
(cÚ¡ 
UDT
& 
x
, cÚ¡ UDT& 
y
è{  
	gx
>=y; }

87 
	~"badiff.h
"

88 
	~"çdiff.h
"

89 
	~"diff.h
"

91 
	g‹m¶©e
< 
	gN
, 
şass
 
	gU
>

92 şas 
	cRecTe¡Ty³s


94 
	mRecTe¡Ty³s
< 
	mN
-1,
	mU
 > 
	ma
;

95 
	mRecTe¡Ty³s
< 
	mN
-1,
	mF
<
	mU
> > 
	mb
;

96 
	mRecTe¡Ty³s
< 
	mN
-1,
	mF
<
	mU
,1> > 
	mc
;

97 
	mRecTe¡Ty³s
< 
	mN
-1,
	mB
<
	mU
> > 
	md
;

98 
	mRecTe¡Ty³s
< 
	mN
-1,
	mT
<
	mU
> > 
	me
;

101 
	g‹m¶©e
< 
ty³Çme
 
	gU
 >

102 
şass
 
	gRecTe¡Ty³s
<0,
	gU
>

104 
	g‹m¶©e
 < 
ty³Çme
 
	gAD
 >

105 
	sTe¡ADTy³


107 
Te¡ADTy³
()

109 
ty³Çme
 
	tAD
::
	tUnd”lyšgTy³
 
	tU
;

110 
	ga
=1.0;

111 
	gb
=2;

112 
U
 
c
(
a
);

113 
UDT
 
d
(
b
);

116 
AD
 
	ge
;

117 
AD
 
f
(
a
);

118 
AD
 
g
(
b
);

119 
AD
 
h
(
c
);

120 
AD
 
i
(
d
);

123 
AD
 
	ge
;

124 
	ge
=
a
;

126 
	ge
=
d
;

129 
AD
 
e
(
a
);

130 
	ge
+=
a
;

132 
	ge
+=
d
;

135 
AD
 
e
(
a
),
f
×),
	gg
;

136 
	gg
=
e
+
f
;

137 
	gg
=
e
+
a
;

138 
	gg
=
a
+
e
;

141 
	gg
=
e
+
d
;

142 
	gg
=
d
+
e
;

145 
AD
 
e
(
a
),
f
×),
	gg
;

146 
	gg
=
e
-
f
;

147 
	gg
=
e
-
a
;

148 
	gg
=
a
-
e
;

151 
	gg
=
e
-
d
;

152 
	gg
=
d
-
e
;

155 
AD
 
e
(
a
),
f
×),
	gg
;

156 
	gg
=
e
*
f
;

157 
	gg
=
e
*
a
;

158 
	gg
=
a
*
e
;

161 
	gg
=
e
*
d
;

162 
	gg
=
d
*
e
;

165 
AD
 
e
(
a
),
f
×),
	gg
;

166 
	gg
=
e
/
f
;

167 
	gg
=
e
/
a
;

168 
	gg
=
a
/
e
;

171 
	gg
=
e
/
d
;

172 
	gg
=
d
/
e
;

175 
AD
 
e
(
a
),
f
×),
	gg
;

176 
boŞ
 
	g»s
;

178 
	g»s
=
e
==
f
;

179 
	g»s
=
e
!=
f
;

180 
	g»s
=
e
<
f
;

181 
	g»s
=
e
<=
f
;

182 
	g»s
=
e
>
f
;

183 
	g»s
=
e
>=
f
;

185 
	g»s
=
e
==
a
;

186 
	g»s
=
e
!=
a
;

187 
	g»s
=
e
<
a
;

188 
	g»s
=
e
<=
a
;

189 
	g»s
=
e
>
a
;

190 
	g»s
=
e
>=
a
;

192 
	g»s
=
a
==
f
;

193 
	g»s
=
a
!=
f
;

194 
	g»s
=
a
<
f
;

195 
	g»s
=
a
<=
f
;

196 
	g»s
=
a
>
f
;

197 
	g»s
=
a
>=
f
;

199 
	g»s
=
e
==
d
;

200 
	g»s
=
e
!=
d
;

201 
	g»s
=
e
<
d
;

202 
	g»s
=
e
<=
d
;

203 
	g»s
=
e
>
d
;

204 
	g»s
=
e
>=
d
;

206 
	g»s
=
d
==
f
;

207 
	g»s
=
d
!=
f
;

208 
	g»s
=
d
<
f
;

209 
	g»s
=
d
<=
f
;

210 
	g»s
=
d
>
f
;

211 
	g»s
=
d
>=
f
;

217 
	gpublic
:

218 
RecTe¡Ty³s
()

220 
Te¡ADTy³
< 
F
<
U
> > 
‹¡1
;

221 
	gTe¡ADTy³
< 
	gF
<
	gU
,1> > 
	g‹¡2
;

222 
	gTe¡ADTy³
< 
	gB
<
	gU
> > 
	g‹¡3
;

223 
	gTe¡ADTy³
< 
	gT
<
	gU
> > 
	g‹¡4
;

227 
	gTe¡UDT
::
	$run
(
IR•ÜtLog
& 
¾og
)

229 
RecTe¡Ty³s
<0,
UDT
> 
t0
;

230 
¾og
.
	`sucûeded
(è<< "U£¸defšedy³e¡†ev– 0 sucûeded" << 
¡d
::
’dl
;

231 
RecTe¡Ty³s
<1,
UDT
> 
t1
;

232 
¾og
.
	`sucûeded
(è<< "U£¸defšedy³e¡†ev– 1 sucûeded" << 
¡d
::
’dl
;

235 
	}
}

	@robot/FADBAD++/test/TestUDT.h

1 #iâdeà
TEST_UDT_H


2 
	#TEST_UDT_H


	)

4 
	~"IR•ÜtLogg”.h
"

6 şas 
	cTe¡UDT
 : 
public
 
IR•ÜtLogg”


8 
public
:

9 
run
(
IR•ÜtLog
& 
¾og
);

	@robot/SimRobot.cpp

1 
	~<boo¡/´og¿m_İtiÚs.hµ
>

2 
	~<veùÜ
>

3 
	~<¡ršg
>

4 
	~"socûr.hµ
"

5 
	~"SimRobÙ.hµ
"

6 
	~"uts/Logg”.hµ
"

7 
	~"uts/İtiÚs.hµ
"

8 
	~"th»ad/Th»adMªag”.hµ
"

10 
	~"Œªsm™‹r/OffNao.hµ
"

11 
	~"bÏckbßrd/BÏckbßrd.hµ
"

12 
	~"mÙiÚ/MÙiÚAd­‹r.hµ
"

13 
	~"³rû±iÚ/P”û±iÚTh»ad.hµ
"

14 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

15 
	~"³rû±iÚ/visiÚ/SimCam”a.hµ
"

17 
Çme¥aû
 
	gpo
 = 
boo¡
::
´og¿m_İtiÚs
;

18 
usšg
 
Çme¥aû
 
	g¡d
;

20 
	gSimRobÙ
::
	$SimRobÙ
(è: 
	$offNaoInU£
(
çl£
) {

21 
VisiÚ
::
ÿm”a
 = 
Ãw
 
	`SimCam”a
();

23 
veùÜ
<
¡ršg
> 
¡r
;

24 
po
::
v¬ŸbËs_m­
 
vm
;

25 
po
::
İtiÚs_desütiÚ
 
cmdlše_İtiÚs
 = 
	`¡Üe_ªd_nÙify
(
¡r
, 
vm
);

26 
	`İtiÚs_´št
(
vm
);

27 
Logg”
::
	`š™
(
vm
["debug.log·th"].
as
<
¡ršg
>(),

28 
vm
["debug.log"].
as
<
¡ršg
>(),

29 
vm
["debug.log.mÙiÚ"].
as
<
boŞ
>());

32 
simO¿şe
 = 
Ãw
 
	`O¿şe
();

33 
simO¿şe
->
	`š™
();

34 
Üaşe
 = 
simO¿şe
;

37 
simBÏckbßrd
 = 
Ãw
 
	`BÏckbßrd
(
vm
);

40 
mÙiÚAd­‹r
 = 
Ãw
 
	`MÙiÚAd­‹r
(
simBÏckbßrd
);

43 
³rû±iÚTh»ad
 = 
Ãw
 
	`P”û±iÚTh»ad
(
simBÏckbßrd
);

45 
offNaoInU£
 = 
vm
["debug.ofâaÙ¿nsm™‹r"].
as
<
boŞ
>();

47 ià(
offNaoInU£
) {

48 
	`±h»ad_ü—‹
(&
ofâaÙ¿nsm™‹r
, 
NULL
, &
§ãlyRun
<
OffNaoT¿nsm™‹r
>,

49 
NULL
);

50 
	`Îog
(
INFO
è<< "Off-NaØT¿nsm™‹¸i ruÂšg" << 
’dl
;

52 
	}
}

54 
	gSimRobÙ
::~
	$SimRobÙ
() {

55 
©‹m±šgShutdown
 = 
Œue
;

56 ià(
offNaoInU£
) {

57 
	`±h»ad_još
(
ofâaÙ¿nsm™‹r
, 
NULL
);

58 
	`Îog
(
INFO
è<< "Off-NaØT¿nsm™‹¸th»ad jošed" << 
’dl
;

61 
d–‘e
 
simO¿şe
;

62 
d–‘e
 
simBÏckbßrd
;

63 
d–‘e
 
mÙiÚAd­‹r
;

64 
d–‘e
 
³rû±iÚTh»ad
;

65 
	}
}

67 
	gSimRobÙ
::
	$run
() {

68 
Üaşe
 = 
simO¿şe
;

70 
mÙiÚAd­‹r
->
	`tick
();

71 
³rû±iÚTh»ad
->
	`tick
();

72 
	}
}

	@robot/SimRobot.hpp

1 #´agm¨
Úû


3 
	~"O¿şe.h
"

5 
şass
 
	gBÏckbßrd
;

6 
şass
 
	gMÙiÚAd­‹r
;

7 
şass
 
	gP”û±iÚTh»ad
;

9 şas 
	cSimRobÙ
 {

10 
	mpublic
:

11 
ex¶ic™
 
SimRobÙ
();

12 ~
SimRobÙ
();

14 
run
();

16 
	m´iv©e
:

17 
boŞ
 
offNaoInU£
;

18 
±h»ad_t
 
	mofâaÙ¿nsm™‹r
;

20 
O¿şe
 *
	msimO¿şe
;

21 
BÏckbßrd
 *
	msimBÏckbßrd
;

22 
MÙiÚAd­‹r
 *
	mmÙiÚAd­‹r
;

23 
P”û±iÚTh»ad
 *
	m³rû±iÚTh»ad
;

	@robot/blackboard/Adapter.hpp

1 #´agm¨
Úû


3 
	~"uts/Logg”.hµ
"

5 
şass
 
	gBÏckbßrd
;

7 şas 
	cAd­‹r
 {

8 
	m´Ùeùed
:

9 
	$Ad­‹r
(
BÏckbßrd
 *
bÏckbßrd
) {

10 
this
->
bÏckbßrd
 = blackboard;

11 
	`Îog
(
INFO
è<< "Ad­‹¸lßded" << 
¡d
::
’dl
;

13 
BÏckbßrd
 *
bÏckbßrd
;

14 
	}
};

	@robot/blackboard/Blackboard.cpp

32 
	~"bÏckbßrd/BÏckbßrd.hµ
"

33 
	~"th»ad/Th»ad.hµ
"

34 
	~<boo¡/assign/li¡_of.hµ
>

35 
	~<boo¡/bšd.hµ
>

36 
	~<boo¡/fÜ—ch.hµ
>

37 
	~<lim™s
>

38 
	~"mÙiÚ/SÚ¬RecÜd”.hµ
"

39 
	~"uts/ªgËs.hµ
"

40 
	~"uts/Logg”.hµ
"

41 
	~"uts/İtiÚs.hµ
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

44 
usšg
 
Çme¥aû
 
	gboo¡
;

46 
	gBÏckbßrd
::
	$BÏckbßrd
(){

47 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
vm
;

48 
¡d
::
veùÜ
<¡d::
¡ršg
> 
¬gv
;

49 
	`¡Üe_ªd_nÙify
(
¬gv
, 
vm
, 
NULL
);

50 
cÚfig
 = 
boo¡
::
´og¿m_İtiÚs
::
	`v¬ŸbËs_m­
(
vm
);

52 
mask
 = 
INITIAL_MASK
;

53 
	`»adO±iÚs
(
vm
);

54 
th»ad
.
cÚfigC®lbacks
["BÏckbßrd"] = 
	`bšd
(&
BÏckbßrd
::
»adO±iÚs
, 
this
, 
_1
);

55 
	`Îog
(
INFO
è<< "In™ŸlisšghbÏckbßrd" << 
’dl
;

56 
	}
}

58 
	gBÏckbßrd
::
	$BÏckbßrd
(cÚ¡ 
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
vm
)

59 : 
	`cÚfig
(
vm
), 
	$mask
(
INITIAL_MASK
) {

60 
	`»adO±iÚs
(
vm
);

61 
th»ad
.
cÚfigC®lbacks
["BÏckbßrd"] = 
	`bšd
(&
BÏckbßrd
::
»adO±iÚs
, 
this
, 
_1
);

62 
th»ad
.
cÚfigC®lbacks
["Logg”"] = &
Logg”
::
»adO±iÚs
;

63 
	`Îog
(
INFO
è<< "In™ŸlisšghbÏckbßrd" << 
’dl
;

64 
	}
}

66 
	gBÏckbßrd
::~
	$BÏckbßrd
() {

67 
th»ad
.
cÚfigC®lbacks
["Blackboard"] =

68 
funùiÚ
<(cÚ¡ 
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &)>();

69 
	`Îog
(
INFO
è<< "BÏckbßrd de¡royed" << 
’dl
;

70 
	}
}

72 
	gBÏckbßrd
::
	$»adO±iÚs
(cÚ¡ 
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

73 
behaviour
.
	`»adO±iÚs
(
cÚfig
);

74 
gameCÚŒŞËr
.
	`»adO±iÚs
(
cÚfig
);

75 
»ûiv”
.
	`»adO±iÚs
(
cÚfig
);

76 
kšem©ics
.
	`»adO±iÚs
(
cÚfig
);

77 
	}
}

79 
	gBehaviourBÏckbßrd
::
	$BehaviourBÏckbßrd
() {

80 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd: behaviour" << 
’dl
;

81 
»adBuf
 = 0;

82 
	}
}

84 
	gBehaviourBÏckbßrd
::
	$»adO±iÚs
(cÚ¡ 
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

85 
skl
 = 
cÚfig
["behaviour.skl"].
as
<
¡ršg
>();

86 
¡ršg
 
a
 = 
cÚfig
["deçuÉ.body"].
as
<string>();

87 ià(
a
 =ğ"NONE"è
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
NONE
;

88 ià(
a
 =ğ"STAND"è
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
STAND
;

89 ià(
a
 =ğ"WALK"è
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
WALK
;

90 ià(
a
 =ğ"DRIBBLE"è
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
DRIBBLE
;

91 ià(
a
 =ğ"INITIAL"è
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
INITIAL
;

92 ià(
a
 =ğ"KICK"è
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
KICK
;

93 ià(
a
 == "GETUP_FRONT")

94 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GETUP_FRONT
;

95 ià(
a
 == "GETUP_BACK")

96 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GETUP_BACK
;

97 ià(
a
 =ğ"DEAD"è
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
DEAD
;

98 ià(
a
 == "REF_PICKUP")

99 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
REF_PICKUP
;

100 ià(
a
 == "THROW_IN")

101 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
THROW_IN
;

102 ià(
a
 == "GOALIE_SIT")

103 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_SIT
;

104 ià(
a
 == "GOALIE_DIVE_LEFT")

105 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_DIVE_LEFT
;

106 ià(
a
 == "GOALIE_DIVE_RIGHT")

107 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_DIVE_RIGHT
;

108 ià(
a
 == "GOALIE_CENTRE")

109 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_CENTRE
;

110 ià(
a
 == "GOALIE_UNCENTRE")

111 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_UNCENTRE
;

112 ià(
a
 == "GOALIE_STAND")

113 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_STAND
;

114 ià(
a
 == "GOALIE_INITIAL")

115 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_INITIAL
;

116 ià(
a
 == "GOALIE_AFTERSIT_INITIAL")

117 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_AFTERSIT_INITIAL
;

118 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
fÜw¬d
 = 
cÚfig
["deçuÉ.fÜw¬d"].
as
<>();

119 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
Ëá
 = 
cÚfig
["deçuÉ.Ëá"].
as
<>();

120 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
tuº
 = 
	`DEG2RAD
(
cÚfig
["deçuÉ.tuº"].
as
<>());

121 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
¥“d
 = 
	`DEG2RAD
(
cÚfig
["deçuÉ.¥“d"].
as
<>());

122 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
pow”
 = 
cÚfig
["deçuÉ.pow”"].
as
<>();

123 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
kickDœeùiÚ
 = 
	`DEG2RAD
(
cÚfig
["deçuÉ.kickDœeùiÚ"].
as
<>());

125 
¡ršg
 
foÙ
 = 
cÚfig
["deçuÉ.foÙ"].
as
<string>();

126 ià(
foÙ
 == "LEFT") {

127 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
foÙ
 = 
AùiÚCommªd
::
Body
::
LEFT
;

129 
»que¡
[
»adBuf
].
aùiÚs
.
body
.
foÙ
 = 
AùiÚCommªd
::
Body
::
RIGHT
;

131 
	}
}

133 
	gLoÿli§tiÚBÏckbßrd
::
	$Loÿli§tiÚBÏckbßrd
() {

134 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd:†oÿli§tiÚ" << 
’dl
;

135 
robÙOb¡aşes
.
	`»£rve
(
MAX_ROBOT_OBSTACLES
);

136 
b®lLo¡CouÁ
 = 
num”ic_lim™s
<
ušt32_t
>::
	`max
();

137 
b®lPosRR
 = 
	`RRCoÜd
();

138 
b®lPosRRC
 = 
	`AbsCoÜd
();

139 
b®lV–RRC
 = 
	`AbsCoÜd
();

140 
b®lV–
 = 
	`AbsCoÜd
();

141 
b®lNeckR–©ive
 = 
	`XYZ_CoÜd
();

142 
b®lPos
 = 
	`AbsCoÜd
();

143 
‹amB®l
 = 
	`T—mB®lInfo
();

144 
sh¬edLoÿli§tiÚBundË
 = 
	`Sh¬edLoÿli§tiÚUpd©eBundË
();

145 
robÙH—dšgSugge¡iÚ
 = 0;

149 
haveP’dšgOutgošgSh¬edBundË
 = 
çl£
;

152 
haveP’dšgIncomšgSh¬edBundË
 = 
¡d
::
veùÜ
<
boŞ
>(5, 
çl£
);

153 
	}
}

155 
	gVisiÚBÏckbßrd
::
	$VisiÚBÏckbßrd
()

157 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd: visiÚ" << 
’dl
;

158 
Ïndm¬ks
.
	`»£rve
(
MAX_LANDMARKS
);

159 
ã‘Boxes
.
	`»£rve
(
MAX_FEET
);

160 
b®ls
.
	`»£rve
(
MAX_BALLS
);

161 
po¡s
.
	`»£rve
(
MAX_POSTS
);

162 
robÙs
.
	`»£rve
(
MAX_ROBOTS
);

163 
f›ldBound¬›s
.
	`»£rve
(
MAX_FIELD_BOUNDARIES
);

164 
f›ldF—tu»s
.
	`»£rve
(
MAX_FIELD_FEATURES
);

165 
mis£dF¿mes
 = 0;

166 
dxdy
 = 
¡d
::
	`make_·œ
(0,0);

167 
gßlA»a
 = 
Po¡Info
::
pNÚe
;

168 
awayGßlProb
 = 0.5f;

169 
homeM­Size
 = 0;

170 
awayM­Size
 = 0;

172 
§l›ncy
 = 
NULL
;

173 
cu¼’tF¿me
 = 
NULL
;

174 
tİF¿me
 = 
NULL
;

175 
bÙF¿me
 = 
NULL
;

177 
numF›ldLšePošts
 = 0;

178 
	}
}

180 
	gP”û±iÚBÏckbßrd
::
	$P”û±iÚBÏckbßrd
() {

181 
kšem©ics
 = 0;

182 
loÿli§tiÚ
 = 0;

183 
visiÚ
 = 0;

184 
behaviour
 = 0;

185 
tÙ®
 = 33;

186 
	}
}

188 
	gMÙiÚBÏckbßrd
::
	$MÙiÚBÏckbßrd
() {

189 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd: mÙiÚ" << 
’dl
;

190 
u±ime
 = 0;

191 
¡d
::
veùÜ
<> 
Ëá
;

192 
Ëá
.
	`»£rve
(
SÚ¬
::
NUMBER_OF_READINGS
/2*
WINDOW_SIZE
);

193 
¡d
::
veùÜ
<> 
middË
;

194 
middË
.
	`»£rve
(
SÚ¬
::
NUMBER_OF_READINGS
/2*
WINDOW_SIZE
);

195 
¡d
::
veùÜ
<> 
right
;

196 
right
.
	`»£rve
(
SÚ¬
::
NUMBER_OF_READINGS
/2*
WINDOW_SIZE
);

197 
sÚ¬Wšdow
.
	`»£rve
(3);

198 
sÚ¬Wšdow
.
	`push_back
(
Ëá
);

199 
sÚ¬Wšdow
.
	`push_back
(
middË
);

200 
sÚ¬Wšdow
.
	`push_back
(
right
);

201 
	}
}

203 
	gRemÙeCÚŒŞBÏckbßrd
::
	$RemÙeCÚŒŞBÏckbßrd
() {

204 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd:„emÙcÚŒŞ" << 
’dl
;

205 
time_»ûived
 = 0;

206 
	}
}

208 
	gKšem©icsBÏckbßrd
::
	$Kšem©icsBÏckbßrd
() {

209 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd: kšem©ics" << 
’dl
;

210 
¡d
::
veùÜ
<> 
Ëá
;

211 
Ëá
.
	`»£rve
(
SÚ¬
::
NUMBER_OF_READINGS
/2*
WINDOW_SIZE
);

212 
¡d
::
veùÜ
<> 
middË
;

213 
middË
.
	`»£rve
(
SÚ¬
::
NUMBER_OF_READINGS
/2*
WINDOW_SIZE
);

214 
¡d
::
veùÜ
<> 
right
;

215 
right
.
	`»£rve
(
SÚ¬
::
NUMBER_OF_READINGS
/2*
WINDOW_SIZE
);

216 
sÚ¬F‹»d
.
	`»£rve
(3);

217 
sÚ¬F‹»d
.
	`push_back
(
Ëá
);

218 
sÚ¬F‹»d
.
	`push_back
(
middË
);

219 
sÚ¬F‹»d
.
	`push_back
(
right
);

220 
	}
}

222 
	gKšem©icsBÏckbßrd
::
	$»adO±iÚs
(cÚ¡ 
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

223 
isC®ib¿tšg
 = 
cÚfig
["kšem©ics.isC®ib¿tšg"].
as
<
boŞ
>();

224 ià(!
isC®ib¿tšg
) {

225 
·¿m‘”s
.
ÿm”aYawBÙtom
 =

226 
cÚfig
["kšem©ics.ÿm”aYawBÙtom"].
as
<>();

227 
·¿m‘”s
.
ÿm”aP™chBÙtom
 =

228 
cÚfig
["kšem©ics.ÿm”aP™chBÙtom"].
as
<>();

229 
·¿m‘”s
.
ÿm”aRŞlBÙtom
 =

230 
cÚfig
["kšem©ics.ÿm”aRŞlBÙtom"].
as
<>();

231 
·¿m‘”s
.
ÿm”aRŞlTİ
 =

232 
cÚfig
["kšem©ics.ÿm”aRŞlTİ"].
as
<>();

233 
·¿m‘”s
.
ÿm”aYawTİ
 = 
cÚfig
["kšem©ics.ÿm”aYawTİ"].
as
<>();

234 
·¿m‘”s
.
ÿm”aP™chTİ
 =

235 
cÚfig
["kšem©ics.ÿm”aP™chTİ"].
as
<>();

236 
·¿m‘”s
.
bodyP™ch
 = 
cÚfig
["kšem©ics.bodyP™ch"].
as
<>();

238 
	}
}

240 
	gGameCÚŒŞËrBÏckbßrd
::
	$GameCÚŒŞËrBÏckbßrd
() {

241 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd: gameCÚŒŞËr" << 
’dl
;

242 
cÚÃùed
 = 
çl£
;

243 
	`mem£t
(&
our_‹am
, 0,  our_team);

244 
	`mem£t
(&
d©a
, 0,  data);

245 
	}
}

247 
	gGameCÚŒŞËrBÏckbßrd
::
	$»adO±iÚs
(cÚ¡ 
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

248 
cÚÃù
 = 
cÚfig
["gamecÚŒŞËr.cÚÃù"].
as
<
boŞ
>();

249 
¶ay”_numb”
 = 
cÚfig
["¶ay”.numb”"].
as
<>();

250 
our_‹am
.
‹amNumb”
 = 
cÚfig
["¶ay”.‹am"].
as
<>();

251 
our_‹am
.
‹amCŞour
 = ()(
cÚfig
["gamecontroller.ourcolour"].

252 
as
<
¡ršg
>() == "red");

253 
‹am_»d
 = 
our_‹am
.
‹amCŞour
;

254 
our_‹am
.
scÜe
 = 
cÚfig
["gamecÚŒŞËr.ourscÜe"].
as
<>();

255 
i
 = 0; i < 
MAX_NUM_PLAYERS
; ++i) {

256 
our_‹am
.
¶ay”s
[
i
].
³ÇÉy
 = 
PENALTY_NONE
;

257 
our_‹am
.
¶ay”s
[
i
].
£csTlUÅ’®i£d
 = 0;

259 
T—mInfo
 
theœ_‹am
;

260 
theœ_‹am
.
‹amNumb”
 = 
cÚfig
["gamecÚŒŞËr.İpÚ’‰—m"].
as
<>();

261 
theœ_‹am
.
‹amCŞour
 = (
our_‹am
.teamColour + 1) % 2;

262 
theœ_‹am
.
scÜe
 = 
cÚfig
["gamecÚŒŞËr.İpÚ’tscÜe"].
as
<>();

263 
i
 = 0; i < 
MAX_NUM_PLAYERS
; ++i) {

264 
theœ_‹am
.
¶ay”s
[
i
].
³ÇÉy
 = 
PENALTY_NONE
;

265 
theœ_‹am
.
¶ay”s
[
i
].
£csTlUÅ’®i£d
 = 0;

269 
m­
<
¡ršg
, > 
gcS‹M­
;

270 
gcS‹M­
["INITIAL"] = 
STATE_INITIAL
;

271 
gcS‹M­
["READY"] = 
STATE_READY
;

272 
gcS‹M­
["SET"] = 
STATE_SET
;

273 
gcS‹M­
["PLAYING"] = 
STATE_PLAYING
;

274 
gcS‹M­
["FINISHED"] = 
STATE_FINISHED
;

275 ià(
gcS‹M­
.
	`couÁ
(
cÚfig
["gamecÚŒŞËr.¡©e"].
as
<
¡ršg
>())) {

276 
d©a
.
¡©e
 = 
gcS‹M­
[
cÚfig
["gamecÚŒŞËr.¡©e"].
as
<
¡ršg
>()];

278 
d©a
.
¡©e
 = 
STATE_INVALID
;

280 
d©a
.
fœ¡H®f
 = 
cÚfig
["gamecÚŒŞËr.fœ¡h®f"].
as
<
boŞ
>();

281 
d©a
.
kickOffT—m
 = ()(
cÚfig
["gamecÚŒŞËr.kickofá—m"].
as
<
¡ršg
>()

283 
m­
<
¡ršg
, > 
gcSecS‹M­
;

284 
gcSecS‹M­
["NORMAL"] = 
STATE2_NORMAL
;

285 
gcSecS‹M­
["PENALTYSHOOT"] = 
STATE2_PENALTYSHOOT
;

286 
gcSecS‹M­
["OVERTIME"] = 
STATE2_OVERTIME
;

287 
gcSecS‹M­
["TIMEOUT"] = 
STATE2_TIMEOUT
;

288 
d©a
.
£cÚd¬yS‹
 = 
gcSecS‹M­
[

289 
cÚfig
["gamecÚŒŞËr.£cÚd¬y¡©e"].
as
<
¡ršg
>()];

290 
d©a
.
£csRemaššg
 = 
cÚfig
["gamecÚŒŞËr.£c¤emaššg"].
as
<>();

291 
d©a
.
‹ams
[
our_‹am
.
‹amCŞour
] = our_team;

292 
d©a
.
‹ams
[
theœ_‹am
.
‹amCŞour
] =heir_team;

293 
	}
}

295 
	gReûiv”BÏckbßrd
::
	$Reûiv”BÏckbßrd
() {

296 
	`BOOST_FOREACH
(
time_t
 & 
Ì
, 
Ï¡Reûived
) {

297 
Ì
 = 0;

299 
	`BOOST_FOREACH
(
boŞ
 &
i
, 
šÿ·c™©ed
) {

300 
i
 = 
Œue
;

302 
	}
}

304 
	gReûiv”BÏckbßrd
::
	$»adO±iÚs
(cÚ¡ 
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

305 
‹am
 = 
cÚfig
["¶ay”.‹am"].
as
<>();

306 
	}
}

308 
	gTh»adBÏckbßrd
::
	$Th»adBÏckbßrd
() {

309 
	`Îog
(
INFO
è<< "In™Ÿlisšg bÏckbßrd:h»ad" << 
’dl
;

310 
	}
}

312 
	gSynchrÚi§tiÚBÏckbßrd
::
	$SynchrÚi§tiÚBÏckbßrd
() {

313 
bu‰Ús
 = 
Ãw
 
boo¡
::
	`mu‹x
();

314 
£rŸliz©iÚ
 = 
Ãw
 
boo¡
::
	`mu‹x
();

315 
	}
}

	@robot/blackboard/Blackboard.hpp

32 #´agm¨
Úû


34 
	~<boo¡/th»ad/mu‹x.hµ
>

35 
	~<boo¡/£rŸliz©iÚ/¥l™_memb”.hµ
>

36 
	~<boo¡/sh¬ed_±r.hµ
>

37 
	~<boo¡/´og¿m_İtiÚs/v¬ŸbËs_m­.hµ
>

38 
	~<boo¡/funùiÚ.hµ
>

39 
	~<sigÇl.h
>

40 
	~<¡ršg
>

41 
	~<m­
>

42 
	~<veùÜ
>

43 
	~<deque
>

45 
	~"³rû±iÚ/behaviour/R—dySklPos™iÚAÎoÿtiÚ.hµ
"

46 
	~"mÙiÚ/g’”©Ü/P’dulumMod–.hµ
"

47 
	~"uts/body.hµ
"

48 
	~"uts/boo¡S”Ÿliz©iÚV¬ŸbËsM­.hµ
"

49 
	~"³rû±iÚ/kšem©ics/P¬am‘”s.hµ
"

50 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

51 
	~"³rû±iÚ/visiÚ/Ùh”/RobÙRegiÚ.hµ
"

52 
	~"³rû±iÚ/loÿli§tiÚ/Loÿli§tiÚDefs.hµ
"

53 
	~"³rû±iÚ/loÿli§tiÚ/Sh¬edLoÿli§tiÚUpd©eBundË.hµ
"

54 
	~"³rû±iÚ/kšem©ics/Po£.hµ
"

55 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

56 
	~"uts/Logg”.hµ
"

57 
	~"Œªsm™‹r/T¿nsm™‹rDefs.hµ
"

58 
	~"ty³s/BehaviourReque¡.hµ
"

60 
	~"ty³s/AùiÚCommªd.hµ
"

61 
	~"ty³s/Bu‰ÚP»s£s.hµ
"

62 
	~"ty³s/Odom‘ry.hµ
"

63 
	~"ty³s/S’sÜV®ues.hµ
"

64 
	~"ty³s/RRCoÜd.hµ
"

65 
	~"ty³s/AbsCoÜd.hµ
"

66 
	~"ty³s/XYZ_CoÜd.hµ
"

67 
	~"ty³s/SPLSnd¬dMes§ge.hµ
"

68 
	~"ty³s/Brßdÿ¡D©a.hµ
"

69 
	~"ty³s/BehaviourSh¬edD©a.hµ
"

71 
	~"ty³s/FoÙInfo.hµ
"

72 
	~"ty³s/B®lInfo.hµ
"

73 
	~"ty³s/Po¡Info.hµ
"

74 
	~"ty³s/RobÙInfo.hµ
"

75 
	~"ty³s/RobÙOb¡aşe.hµ
"

76 
	~"ty³s/F›ldBound¬yInfo.hµ
"

77 
	~"ty³s/F›ldF—tu»Info.hµ
"

78 
	~"ty³s/Ipošt.hµ
"

79 
	~"ty³s/Odom‘ry.hµ
"

80 
	~"ty³s/T—mB®lInfo.hµ
"

81 
	~"ty³s/Cam”aS‘tšgs.hµ
"

83 
Çme¥aû
 
	gVisiÚTe¡


85 
şass
 
	gDumpResuÉ
;

93 
	#»adFrom
(
moduË
, 
compÚ’t
) \

94 
bÏckbßrd
->
	`»ad
(&(bÏckbßrd->
moduË
.
compÚ’t
))

	)

103 
	#»adA¼ay
(
moduË
, 
compÚ’t
, 
de¡
) \

104 
	`memıy
(
de¡
, 
bÏckbßrd
->
moduË
.
compÚ’t
, \

105 (
bÏckbßrd
->
moduË
.
compÚ’t
));

	)

113 
	#wr™eTo
(
moduË
, 
compÚ’t
, 
v®ue
) \

114 
bÏckbßrd
->
	`wr™e
(&(bÏckbßrd->
moduË
.
compÚ’t
), 
v®ue
);

	)

123 
	#wr™eA¼ay
(
moduË
, 
compÚ’t
, 
v®ue
) \

124 
	`memıy
(
bÏckbßrd
->
moduË
.
compÚ’t
, 
v®ue
, \

125 (
bÏckbßrd
->
moduË
.
compÚ’t
));

	)

131 
	#acquœeLock
(
Çme
) \

132 (
bÏckbßrd
->
locks
.
Çme
)->
	`lock
();

	)

138 
	#»Ëa£Lock
(
Çme
) \

139 (
bÏckbßrd
->
locks
.
Çme
)->
	`uÆock
();

	)

149 
şass
 
	gN‘wÜkR—d”
;

150 
şass
 
	gOv”v›wTab
;

152 
	sKšem©icsBÏckbßrd
 {

153 
ex¶ic™
 
Kšem©icsBÏckbßrd
();

154 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

156 
	m¡d
::
veùÜ
< 
¡d
::veùÜ <> > 
sÚ¬F‹»d
;

157 
boŞ
 
	misC®ib¿tšg
;

158 
	mP¬am‘”s
<> 
	m·¿m‘”s
;

159 
S’sÜV®ues
 
	m£nsÜsLagged
;

163 
	sBehaviourBÏckbßrd
 {

164 
ex¶ic™
 
BehaviourBÏckbßrd
();

165 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

166 
BehaviourReque¡
 
	m»que¡
[2];

167 
	m»adBuf
;

168 
	m¡d
::
¡ršg
 
skl
;

169 
AbsCoÜd
 
	mw®kšgTo
;

170 
AbsCoÜd
 
	mshoÙšgTo
;

171 
BehaviourSh¬edD©a
 
	mbehaviourSh¬edD©a
;

175 
	sLoÿli§tiÚBÏckbßrd
 {

176 
ex¶ic™
 
Loÿli§tiÚBÏckbßrd
();

179 
AbsCoÜd
 
	mrobÙPos
;

183 
ušt32_t
 
	mb®lLo¡CouÁ
;

186 
RRCoÜd
 
	mb®lPosRR
;

189 
AbsCoÜd
 
	mb®lPosRRC
;

194 
AbsCoÜd
 
	mb®lV–RRC
;

197 
AbsCoÜd
 
	mb®lV–
;

199 
	mrobÙPosUnû¹ašty
;

200 
	mrobÙH—dšgUnû¹ašty
;

201 
	mrobÙH—dšgSugge¡iÚ
;

203 
	mb®lPosUnû¹ašty
;

205 
	mb®lV–Eig’v®ue
;

208 
AbsCoÜd
 
	mb®lPos
;

211 
T—mB®lInfo
 
	m‹amB®l
;

213 
XYZ_CoÜd
 
	mb®lNeckR–©ive
;

215 
Sh¬edLoÿli§tiÚUpd©eBundË
 
	msh¬edLoÿli§tiÚBundË
;

217 
boŞ
 
	mhaveP’dšgOutgošgSh¬edBundË
;

218 
	m¡d
::
veùÜ
<
boŞ
> 
haveP’dšgIncomšgSh¬edBundË
;

221 
	m¡d
::
veùÜ
<
RobÙOb¡aşe
> 
robÙOb¡aşes
;

227 
	sVisiÚBÏckbßrd
 {

229 
ex¶ic™
 
VisiÚBÏckbßrd
();

231 
št64_t
 
	mtime¡amp
;

234 
	m¡d
::
veùÜ
<
Ipošt
> 
Ïndm¬ks
;

235 
	m¡d
::
veùÜ
<
FoÙInfo
> 
ã‘Boxes
;

236 
	m¡d
::
veùÜ
<
B®lInfo
> 
b®ls
;

237 
B®lHšt
 
	mb®lHšt
;

238 
	m¡d
::
veùÜ
<
Po¡Info
> 
po¡s
;

239 
	m¡d
::
veùÜ
<
RobÙInfo
> 
robÙs
;

240 
	m¡d
::
veùÜ
<
F›ldBound¬yInfo
> 
f›ldBound¬›s
;

241 
	m¡d
::
veùÜ
<
F›ldF—tu»Info
> 
f›ldF—tu»s
;

242 
	mmis£dF¿mes
;

243 
	m¡d
::
·œ
<, > 
	mdxdy
;

244 
	mPo¡Info
::
Ty³
 
gßlA»a
;

245 
	mawayGßlProb
;

246 
	mhomeM­Size
;

247 
	mawayM­Size
;

250 
CŞour
 *
	mtİS®›ncy
;

251 
CŞour
 *
	mbÙS®›ncy
;

252 
CŞour
 *
	m§l›ncy
;

255 
ušt8_t
 cÚ¡* 
	mcu¼’tF¿me
;

256 
ušt8_t
 cÚ¡* 
	mtİF¿me
;

257 
ušt8_t
 cÚ¡* 
	mbÙF¿me
;

260 
Cam”aS‘tšgs
 
	mtİCam”aS‘tšgs
;

261 
Cam”aS‘tšgs
 
	mbÙCam”aS‘tšgs
;

270 
	mnumF›ldLšePošts
;

271 
RRCoÜd
 
	mf›ldLšePošts
[
MAX_FIELD_LINE_POINTS
];

272 
boŞ
 
	mÿnS“BÙtom
[
MAX_POSTS
];

273 
boŞ
 
	mÿnS“BÙtomRobÙ
[
MAX_ROBOTS
];

276 
	sP”û±iÚBÏckbßrd
 {

277 
ex¶ic™
 
P”û±iÚBÏckbßrd
();

278 
ušt32_t
 
	mkšem©ics
;

279 
ušt32_t
 
	mloÿli§tiÚ
;

280 
ušt32_t
 
	mvisiÚ
;

281 
ušt32_t
 
	mbehaviour
;

282 
ušt32_t
 
	mtÙ®
;

285 
	sGameCÚŒŞËrBÏckbßrd
 {

286 
ex¶ic™
 
GameCÚŒŞËrBÏckbßrd
();

287 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

288 
boŞ
 
	mcÚÃù
;

289 
boŞ
 
	mcÚÃùed
;

290 
RoboCupGameCÚŒŞD©a
 
	md©a
;

291 
T—mInfo
 
	mour_‹am
;

292 
boŞ
 
	m‹am_»d
;

293 
	m¶ay”_numb”
;

294 
ušt8_t
 
	mgameS‹
;

295 * 
	mÏ¡GameCÚŒŞËrIPAdd»ss
;

299 
	sMÙiÚBÏckbßrd
 {

300 
ex¶ic™
 
MÙiÚBÏckbßrd
();

301 
S’sÜV®ues
 
	m£nsÜs
;

303 
	m¡d
::
veùÜ
 < 
¡d
::veùÜ <> > 
sÚ¬Wšdow
;

304 
	mu±ime
;

305 
	mAùiÚCommªd
::
AÎ
 
aùive
;

306 
Odom‘ry
 
	modom‘ry
;

307 
Bu‰ÚP»s£s
 
	mbu‰Ús
;

308 
Po£
 
	mpo£
;

309 
XYZ_CoÜd
 
	mcom
;

311 
P’dulumMod–
 
	m³ndulumMod–
;

314 
	sRemÙeCÚŒŞBÏckbßrd
 {

315 
ex¶ic™
 
RemÙeCÚŒŞBÏckbßrd
();

316 
BehaviourReque¡
 
	m»que¡
;

317 
time_t
 
	mtime_»ûived
;

320 
	sReûiv”BÏckbßrd
 {

321 
ex¶ic™
 
Reûiv”BÏckbßrd
();

323 
SPLSnd¬dMes§ge
 
	mmes§ge
[
ROBOTS_PER_TEAM
];

324 
Brßdÿ¡D©a
 
	md©a
[
ROBOTS_PER_TEAM
];

325 
	m‹am
;

326 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

327 
time_t
 
	mÏ¡Reûived
[
ROBOTS_PER_TEAM
];

328 
boŞ
 
	mšÿ·c™©ed
[
ROBOTS_PER_TEAM
];

332 
	sSynchrÚi§tiÚBÏckbßrd
 {

333 
ex¶ic™
 
SynchrÚi§tiÚBÏckbßrd
();

334 
	mboo¡
::
mu‹x
 *
bu‰Ús
;

335 
	mboo¡
::
mu‹x
 *
£rŸliz©iÚ
;

338 
	sTh»adBÏckbßrd
 {

339 
ex¶ic™
 
Th»adBÏckbßrd
();

340 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mboo¡
::
funùiÚ
<(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &)> > 
cÚfigC®lbacks
;

343 şas 
	cBÏckbßrd
 {

344 
ä›nd
 
şass
 
	mboo¡
::
£rŸliz©iÚ
::
acûss
;

345 
	m‹m¶©e
<
şass
 
	mArchive
> 
ä›nd
 

346 
	mboo¡
::
£rŸliz©iÚ
::
	$§ve_cÚ¡ruù_d©a
(
Archive
 &
¬
, cÚ¡ 
BÏckbßrd
 *
t
,

350 
¬
 << 
t
->
cÚfig
;

353 
ä›nd
 
şass
 
Loÿli§tiÚAd­‹r
;

354 
ä›nd
 
şass
 
VisiÚAd­‹r
;

355 
ä›nd
 
şass
 
MÙiÚAd­‹r
;

356 
ä›nd
 
şass
 
BehaviourAd­‹r
;

357 
ä›nd
 
şass
 
GameCÚŒŞËr
;

358 
ä›nd
 
şass
 
OffNaoT¿nsm™‹r
;

359 
ä›nd
 
şass
 
NaoT¿nsm™‹r
;

360 
ä›nd
 
şass
 
T—mT¿nsm™‹r
;

362 
ä›nd
 
şass
 
NaoReûiv”
;

363 
ä›nd
 
şass
 
RemÙeCÚŒŞReûiv”
;

364 
ä›nd
 
şass
 
T—mReûiv”
;

365 
ä›nd
 
şass
 
Kšem©icsAd­‹r
;

366 
ä›nd
 
şass
 
P”û±iÚTh»ad
;

367 
ä›nd
 
şass
 
Kšem©icsC®ib¿tiÚSkl
;

368 
ä›nd
 
şass
 
Th»adMªag”
;

371 
ä›nd
 
şass
 
DumpR—d”
;

372 
ä›nd
 
şass
 
N‘wÜkR—d”
;

373 
ä›nd
 
şass
 
Loÿli§tiÚR—d”
;

374 
ä›nd
 
şass
 
Ov”v›wTab
;

375 
ä›nd
 
şass
 
Cam”aTab
;

376 
ä›nd
 
şass
 
C®ib¿tiÚTab
;

377 
ä›nd
 
şass
 
VisiÚTab
;

378 
ä›nd
 
şass
 
CÚÃùiÚ
;

379 
ä›nd
 
şass
 
V¬ŸbËV›w
;

380 
ä›nd
 
şass
 
F›ldV›w
;

381 
ä›nd
 
şass
 
S’sÜTab
;

382 
ä›nd
 
şass
 
Cam”aPo£Tab
;

383 
ä›nd
 
şass
 
G¿phTab
;

384 
ä›nd
 
şass
 
ZMPTab
;

385 
ä›nd
 
şass
 
VisiÚTe¡Su™eTab
;

386 
ä›nd
 
şass
 
CÚŒŞTab
;

389 
ä›nd
 
şass
 
VisiÚTe¡
::
DumpResuÉ
;

392 
‹m¶©e
 <
şass
 
T
> 
ä›nd
 *
	`§ãlyRun
(* 
foo
);

394 
public
:

395 
ex¶ic™
 
	`BÏckbßrd
();

396 
ex¶ic™
 
	`BÏckbßrd
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
vm
);

397 ~
	`BÏckbßrd
();

400 
‹m¶©e
<
şass
 
T
> cÚ¡ T& 
	`»ad
(cÚ¡ T *
compÚ’t
);

403 
‹m¶©e
<
şass
 
T
> 
	`wr™e
(T *
compÚ’t
, cÚ¡ T& 
v®ue
);

408 
‹m¶©e
<
şass
 
Archive
>

409 
	`sh®lowS”Ÿlize
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
);

413 
‹m¶©e
<
şass
 
Archive
>

414 
	$§ve
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
) const;

418 
‹m¶©e
<
şass
 
Archive
>

419 
	`lßd
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
);

420 #iâdeà
SWIG


421 
	`BOOST_SERIALIZATION_SPLIT_MEMBER
();

433 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
cÚfig
;

438 
OffNaoMask_t
 
mask
;

441 
	`»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

444 
Kšem©icsBÏckbßrd
 
kšem©ics
;

447 
BehaviourBÏckbßrd
 
behaviour
;

450 
Loÿli§tiÚBÏckbßrd
 
loÿli§tiÚ
;

453 
VisiÚBÏckbßrd
 
visiÚ
;

455 
P”û±iÚBÏckbßrd
 
³rû±iÚ
;

458 
GameCÚŒŞËrBÏckbßrd
 
gameCÚŒŞËr
;

461 
MÙiÚBÏckbßrd
 
mÙiÚ
;

464 
Reûiv”BÏckbßrd
 
»ûiv”
;

467 
RemÙeCÚŒŞBÏckbßrd
 
»mÙeCÚŒŞ
;

470 
Th»adBÏckbßrd
 
th»ad
;

473 
SynchrÚi§tiÚBÏckbßrd
 
locks
;

474 
	}
};

476 
	~"BÏckbßrd.tcc
"

	@robot/blackboard/Blackboard.tcc

1 
	~<boo¡/£rŸliz©iÚ/bš¬y_objeù.hµ
>

2 
	~<boo¡/£rŸliz©iÚ/li¡.hµ
>

3 
	~<boo¡/£rŸliz©iÚ/nvp.hµ
>

4 
	~<boo¡/£rŸliz©iÚ/ut™y.hµ
>

5 
	~<boo¡/£rŸliz©iÚ/veùÜ.hµ
>

7 
	g‹m¶©e
<
şass
 
	gT
>

8 cÚ¡ 
	gT
& 
	gBÏckbßrd
::
	$»ad
(cÚ¡ 
T
 *
compÚ’t
) {

9  *
compÚ’t
;

10 
	}
}

12 
	g‹m¶©e
<
şass
 
	gT
>

13 
	gBÏckbßrd
::
	$wr™e
(
T
 *
compÚ’t
, cÚ¡ T& 
v®ue
) {

14 *
compÚ’t
 = 
v®ue
;

15 
	}
}

81 
BOOST_CLASS_VERSION
(
BÏckbßrd
, 16);

83 
	g‹m¶©e
<
şass
 
	gArchive
>

84 
	gBÏckbßrd
::
	$sh®lowS”Ÿlize
(
Archive
 & 
¬
,

85 cÚ¡ 
v”siÚ
) {

87 ià(
v”siÚ
 < 15) {

88 
throw
 
¡d
::
	`ruÁime_”rÜ
("Depricated 2011 dump file detected");

91 
¬
 & 
gameCÚŒŞËr
.
‹am_»d
;

92 
¬
 & 
gameCÚŒŞËr
.
¶ay”_numb”
;

94 
¬
 & 
mÙiÚ
.
£nsÜs
;

95 
¬
 & 
mÙiÚ
.
po£
;

96 
¬
 & 
mÙiÚ
.
com
;

97 
¬
 & 
mÙiÚ
.
odom‘ry
;

98 
¬
 & 
mÙiÚ
.
aùive
;

100 
¬
 & 
³rû±iÚ
.
behaviour
;

101 
¬
 & 
³rû±iÚ
.
kšem©ics
;

102 
¬
 & 
³rû±iÚ
.
loÿli§tiÚ
;

103 
¬
 & 
³rû±iÚ
.
tÙ®
;

104 
¬
 & 
³rû±iÚ
.
visiÚ
;

106 
¬
 & 
behaviour
.
»que¡
;

108 
¬
 & 
kšem©ics
.
sÚ¬F‹»d
;

109 
¬
 & 
kšem©ics
.
·¿m‘”s
;

110 
¬
 & 
kšem©ics
.
£nsÜsLagged
;

113 
¬
 & 
loÿli§tiÚ
.
robÙOb¡aşes
;

115 
¡d
::
veùÜ
<
RobÙInfo
> 
em±y
;

116 
¬
 & 
em±y
;

119 ià(
this
->
mask
 & 
LANDMARKS_MASK
) {

120 
¬
 & 
visiÚ
.
Ïndm¬ks
;

122 
¡d
::
veùÜ
<
Ipošt
> 
em±y
;

123 
¬
 & 
em±y
;

126 
¬
 & 
visiÚ
.
time¡amp
;

127 
¬
 & 
visiÚ
.
gßlA»a
;

128 
¬
 & 
visiÚ
.
awayGßlProb
;

129 
¬
 & 
visiÚ
.
homeM­Size
;

130 
¬
 & 
visiÚ
.
awayM­Size
;

131 
¬
 & 
visiÚ
.
ã‘Boxes
;

132 
¬
 & 
visiÚ
.
b®ls
;

133 
¬
 & 
visiÚ
.
b®lHšt
;

134 
¬
 & 
visiÚ
.
po¡s
;

135 
¬
 & 
visiÚ
.
robÙs
;

136 
¬
 & 
visiÚ
.
f›ldBound¬›s
;

137 
¬
 & 
visiÚ
.
f›ldF—tu»s
;

138 
¬
 & 
visiÚ
.
mis£dF¿mes
;

139 
¬
 & 
visiÚ
.
dxdy
;

140 
¬
 & 
visiÚ
.
tİCam”aS‘tšgs
;

141 
¬
 & 
visiÚ
.
bÙCam”aS‘tšgs
;

143 
¬
 & 
»ûiv”
.
mes§ge
;

144 
¬
 & 
»ûiv”
.
d©a
;

145 
¬
 & 
»ûiv”
.
šÿ·c™©ed
;

147 
¬
 & 
mÙiÚ
.
³ndulumMod–
;

149 
¬
 & 
loÿli§tiÚ
.
robÙPos
;

150 
¬
 & 
loÿli§tiÚ
.
b®lLo¡CouÁ
;

151 
¬
 & 
loÿli§tiÚ
.
b®lPosRR
;

152 
¬
 & 
loÿli§tiÚ
.
b®lPosRRC
;

153 
¬
 & 
loÿli§tiÚ
.
b®lV–RRC
;

154 ià(
v”siÚ
 >= 16) {

155 
¬
 & 
loÿli§tiÚ
.
b®lV–
;

156 
¬
 & 
loÿli§tiÚ
.
b®lPosUnû¹ašty
;

157 
¬
 & 
loÿli§tiÚ
.
b®lV–Eig’v®ue
;

158 
¬
 & 
loÿli§tiÚ
.
robÙPosUnû¹ašty
;

159 
¬
 & 
loÿli§tiÚ
.
robÙH—dšgUnû¹ašty
;

161 
¬
 & 
loÿli§tiÚ
.
b®lNeckR–©ive
;

162 
¬
 & 
loÿli§tiÚ
.
b®lPos
;

163 
¬
 & 
loÿli§tiÚ
.
‹amB®l
;

164 
¬
 & 
loÿli§tiÚ
.
sh¬edLoÿli§tiÚBundË
;

165 
¬
 & 
loÿli§tiÚ
.
haveP’dšgOutgošgSh¬edBundË
;

166 
¬
 & 
loÿli§tiÚ
.
haveP’dšgIncomšgSh¬edBundË
;

167 
	}
}

169 
	g‹m¶©e
<
şass
 
	gArchive
>

170 
	gBÏckbßrd
::
	$§ve
(
Archive
 & 
¬
, cÚ¡ 
v”siÚ
) const {

172 
OffNaoMask_t
 
mask
 = 
this
->mask;

173 ià((
mask
 & 
SALIENCY_MASK
è&& (!
visiÚ
.
tİS®›ncy
 || !visiÚ.
bÙS®›ncy
))

174 
mask
 &ğ(~
SALIENCY_MASK
);

175 ià((
mask
 & 
RAW_IMAGE_MASK
è&& (!
visiÚ
.
tİF¿me
 || !visiÚ.
bÙF¿me
))

176 
mask
 &ğ(~
RAW_IMAGE_MASK
);

177 
¬
 & 
boo¡
::
£rŸliz©iÚ
::
	`make_nvp
("Mask", 
mask
);

179 ià((
mask
 & 
BLACKBOARD_MASK
è&& (mask & 
SALIENCY_MASK
)) {

180 
locks
.
£rŸliz©iÚ
->
	`lock
();

181 ((
BÏckbßrd
*)
this
)->
	`sh®lowS”Ÿlize
(
¬
, 
v”siÚ
);

183 
¬
 & 
boo¡
::
£rŸliz©iÚ
::

184 
	`make_nvp
("TopSaliency",

185 
boo¡
::
£rŸliz©iÚ
::

186 
	`make_bš¬y_objeù
(
visiÚ
.
tİS®›ncy
,

187 (
CŞour
[
IMAGE_COLS
 / 
TOP_SALIENCY_DENSITY
][
IMAGE_ROWS
 / TOP_SALIENCY_DENSITY])));

188 
¬
 & 
boo¡
::
£rŸliz©iÚ
::

189 
	`make_nvp
("BotSaliency",

190 
boo¡
::
£rŸliz©iÚ
::

191 
	`make_bš¬y_objeù
(
visiÚ
.
bÙS®›ncy
,

192 (
CŞour
[
IMAGE_COLS
 / 
BOT_SALIENCY_DENSITY
][
IMAGE_ROWS
 / BOT_SALIENCY_DENSITY])));

193 
locks
.
£rŸliz©iÚ
->
	`uÆock
();

194 } ià(
mask
 & 
BLACKBOARD_MASK
) {

195 ((
BÏckbßrd
*)
this
)->
	`sh®lowS”Ÿlize
(
¬
, 
v”siÚ
);

196 } ià(
mask
 & 
SALIENCY_MASK
) {

198 
¬
 & 
boo¡
::
£rŸliz©iÚ
::

199 
	`make_nvp
("TopSaliency",

200 
boo¡
::
£rŸliz©iÚ
::

201 
	`make_bš¬y_objeù
(
visiÚ
.
tİS®›ncy
,

202 (
CŞour
[
IMAGE_COLS
 / 
TOP_SALIENCY_DENSITY
][
IMAGE_ROWS
 / TOP_SALIENCY_DENSITY])));

203 
¬
 & 
boo¡
::
£rŸliz©iÚ
::

204 
	`make_nvp
("BotSaliency",

205 
boo¡
::
£rŸliz©iÚ
::

206 
	`make_bš¬y_objeù
(
visiÚ
.
bÙS®›ncy
,

207 (
CŞour
[
IMAGE_COLS
 / 
BOT_SALIENCY_DENSITY
][
IMAGE_ROWS
 / BOT_SALIENCY_DENSITY])));

209 ià(
mask
 & 
RAW_IMAGE_MASK
) {

211 
¬
 & 
boo¡
::
£rŸliz©iÚ
::
	`make_nvp
(

213 
boo¡
::
£rŸliz©iÚ
:: 
	`make_bš¬y_objeù
((*)
visiÚ
.
tİF¿me
,

214 (
ušt8_t
[
IMAGE_ROWS
 * 
IMAGE_COLS
 * 2])));

215 
¬
 & 
boo¡
::
£rŸliz©iÚ
::
	`make_nvp
(

217 
boo¡
::
£rŸliz©iÚ
:: 
	`make_bš¬y_objeù
((*)
visiÚ
.
bÙF¿me
,

218 (
ušt8_t
[
IMAGE_ROWS
 * 
IMAGE_COLS
 * 2])));

221 
¬
 & 
loÿli§tiÚ
.
robÙPos
;

222 
	}
}

224 
	g‹m¶©e
<
şass
 
	gArchive
>

225 
	gBÏckbßrd
::
	$lßd
(
Archive
 & 
¬
, cÚ¡ 
v”siÚ
) {

226 
¬
 & 
mask
;

227 ià(
mask
 & 
BLACKBOARD_MASK
)

228 
	`sh®lowS”Ÿlize
(
¬
, 
v”siÚ
);

229 ià(
mask
 & 
SALIENCY_MASK
) {

230 
visiÚ
.
tİS®›ncy
 = (
CŞour
*è
Ãw


231 
CŞour
[
IMAGE_COLS
 / 
TOP_SALIENCY_DENSITY
]

232 [
IMAGE_ROWS
 / 
TOP_SALIENCY_DENSITY
];

234 
¬
 & 
boo¡
::
£rŸliz©iÚ
::
	`make_bš¬y_objeù
(
visiÚ
.
tİS®›ncy
,

235 (
CŞour
[
IMAGE_COLS
 / 
TOP_SALIENCY_DENSITY
][
IMAGE_ROWS
 / TOP_SALIENCY_DENSITY]));

237 
visiÚ
.
bÙS®›ncy
 = (
CŞour
*è
Ãw


238 
CŞour
[
IMAGE_COLS
 / 
BOT_SALIENCY_DENSITY
]

239 [
IMAGE_ROWS
 / 
BOT_SALIENCY_DENSITY
];

241 
¬
 & 
boo¡
::
£rŸliz©iÚ
::
	`make_bš¬y_objeù
(
visiÚ
.
bÙS®›ncy
,

242 (
CŞour
[
IMAGE_COLS
 / 
BOT_SALIENCY_DENSITY
][
IMAGE_ROWS
 / BOT_SALIENCY_DENSITY]));

244 ià(
mask
 & 
RAW_IMAGE_MASK
) {

245 
visiÚ
.
tİF¿me
 = 
Ãw
 
ušt8_t
[
IMAGE_ROWS
 * 
IMAGE_COLS
 * 2];

246 
¬
 & 
boo¡
::
£rŸliz©iÚ
::

247 
	`make_bš¬y_objeù
((*)
visiÚ
.
tİF¿me
,

248 (
ušt8_t
[
IMAGE_ROWS
 * 
IMAGE_COLS
 * 2]));

249 
visiÚ
.
bÙF¿me
 = 
Ãw
 
ušt8_t
[
IMAGE_ROWS
 * 
IMAGE_COLS
 * 2];

250 
¬
 & 
boo¡
::
£rŸliz©iÚ
::

251 
	`make_bš¬y_objeù
((*)
visiÚ
.
bÙF¿me
,

252 (
ušt8_t
[
IMAGE_ROWS
 * 
IMAGE_COLS
 * 2]));

255 
¬
 & 
loÿli§tiÚ
.
robÙPos
;

256 
	}
}

258 
Çme¥aû
 
	gboo¡
 {

259 
Çme¥aû
 
	g£rŸliz©iÚ
 {

268 
	g‹m¶©e
<
şass
 
	gArchive
>

269 
šlše
 
lßd_cÚ¡ruù_d©a
(
Archive
 &
¬
, 
BÏckbßrd
 *
t
,

270 cÚ¡ 
fe_v”siÚ
) {

272 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
cÚfig
;

273 
	g¬
 >> 
	gcÚfig
;

275 ::
Ãw
(
t
è
BÏckbßrd
(
cÚfig
);

	@robot/gamecontroller/GameController.cpp

39 
	~"gamecÚŒŞËr/GameCÚŒŞËr.hµ
"

40 
	~<¬·/š‘.h
>

41 
	~<sys/ty³s.h
>

42 
	~<sys/sock‘.h
>

43 
	~<sys/pŞl.h
>

44 
	~<Ãtš‘/š.h
>

45 
	~<Ãtdb.h
>

46 
	~"bÏckbßrd/BÏckbßrd.hµ
"

47 
	~"uts/Logg”.hµ
"

48 
	~"uts/¥“ch.hµ
"

50 
	#POLL_TIMEOUT
 200

	)

52 
usšg
 
Çme¥aû
 
	g¡d
;

54 
	gGameCÚŒŞËr
::
	$GameCÚŒŞËr
(
BÏckbßrd
 *
bb
)

55 : 
	`Ad­‹r
(
bb
), 
	`‹am_»d
(
çl£
), 
	$cÚÃùed
(
çl£
) {

56 
Ï¡S‹
 = 
STATE_INVALID
;

57 
myLa¡P’®ty
 = 
PENALTY_NONE
;

58 ià(
	`»adFrom
(
gameCÚŒŞËr
, 
cÚÃù
)) {

59 
	`š™Ÿli£CÚÃùiÚ
();

61 
aùOnWhi¡Ë
 = (
bb
->
cÚfig
)["debug.aù_Ú_whi¡Ë"].
as
<
boŞ
>();

62 
	}
}

64 
	gGameCÚŒŞËr
::~
	$GameCÚŒŞËr
() {

65 
	`şo£
(
sock
);

66 
	}
}

68 
	gGameCÚŒŞËr
::
	$tick
() {

77 
ušt8_t
 
´eviousGameS‹
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
gameS‹
);

78 
d©a
 = 
	`»adFrom
(
gameCÚŒŞËr
, data);

79 
‹amNumb”
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
our_‹am
).teamNumber;

80 
¶ay”Numb”
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
¶ay”_numb”
);

82 ià(!
cÚÃùed
 && 
	`»adFrom
(
gameCÚŒŞËr
, 
cÚÃù
)è
	`š™Ÿli£CÚÃùiÚ
();

83 ià(
cÚÃùed
è
	`wœ–essUpd©e
();

84 
bu‰Ús
 = 
	`»adFrom
(
mÙiÚ
, buttons);

85 
	`bu‰ÚUpd©e
();

86 
	`wr™eTo
(
mÙiÚ
, 
bu‰Ús
, buttons);

88 
T—mInfo
 *
our_‹am
 = 
NULL
;

89 ià(
d©a
.
‹ams
[
TEAM_BLUE
].
‹amNumb”
 ==eamNumber) {

90 
our_‹am
 = &(
d©a
.
‹ams
[
TEAM_BLUE
]);

91 
‹am_»d
 = 
çl£
;

92 } ià(
d©a
.
‹ams
[
TEAM_RED
].
‹amNumb”
 ==eamNumber) {

93 
our_‹am
 = &(
d©a
.
‹ams
[
TEAM_RED
]);

94 
‹am_»d
 = 
Œue
;

98 
ušt8_t
 
gameS‹
 = 
d©a
.
¡©e
;

102 ià(
gameS‹
 =ğ
STATE_SET
 && 
´eviousGameS‹
 =ğ
STATE_PLAYING
) {

103 
gameS‹
 = 
´eviousGameS‹
;

107 ià(
gameS‹
 =ğ
STATE_SET
 && 
	`whi¡ËH—rd
(3)) {

108 ià(
aùOnWhi¡Ë
 =ğ
Œue
) {

109 
gameS‹
 = 
STATE_PLAYING
;

110 
cout
 << "WHISTLE HEARD, TELLING TEAM MATES" << 
’dl
;

111 
	`SAY
("Whistle heard");

114 
	`SAY
("Heard whistle‚ot moving");

119 ià(
d©a
.
¡©e
 =ğ
STATE_SET
) {

120 
numT—mm©esPÏyšg
 = 0;

121 
numAùiveT—mm©es
 = 0;

122 
i
 = 0; i < 
ROBOTS_PER_TEAM
; ++i) {

124 ià(
	`»adFrom
(
»ûiv”
, 
d©a
)[
i
].
gameS‹
 =ğ
STATE_PLAYING
) {

125 ++
numT—mm©esPÏyšg
;

127 ià(!
	`»adFrom
(
»ûiv”
, 
šÿ·c™©ed
)[
i
]) {

128 ++
numAùiveT—mm©es
;

133 ià(
gameS‹
 =ğ
STATE_PLAYING
è++
numT—mm©esPÏyšg
;

134 ++
numAùiveT—mm©es
;

137 
¿tio
 = 
numT—mm©esPÏyšg
 / 
numAùiveT—mm©es
;

138 ià(
¿tio
 >ğ0.49 && 
aùOnWhi¡Ë
) {

139 
d©a
.
¡©e
 = 
STATE_PLAYING
;

140 
cout
 << "WHISTLE HEARD BY TEAMMATES ENTERING STATE PLAYING YAY" << 
’dl
;

141 
	`SAY
("Whistle heard byeammates");

145 
	`wr™eTo
(
gameCÚŒŞËr
, 
d©a
, data);

146 
	`wr™eTo
(
gameCÚŒŞËr
, 
our_‹am
, *our_team);

147 
	`wr™eTo
(
gameCÚŒŞËr
, 
‹am_»d
,eam_red);

148 
	`wr™eTo
(
gameCÚŒŞËr
, 
gameS‹
, 
d©a
.
¡©e
);

154 ià(
gameS‹
 =ğ
STATE_PLAYING
 && 
d©a
.
¡©e
 =ğ
STATE_SET
) {

155 
	`wr™eTo
(
gameCÚŒŞËr
, 
gameS‹
, gameState);

157 
	}
}

159 
	gGameCÚŒŞËr
::
	$š™Ÿli£CÚÃùiÚ
() {

160 
	`Îog
(
INFO
) << "GameController: Connecting on…ort "

161 << 
GAMECONTROLLER_DATA_PORT
 << 
’dl
;

162 
¡ršg¡»am
 
s
;

163 
s
 << 
GAMECONTROLLER_DATA_PORT
;

165 
addršfo
 
myInfo
, *
»suÉs
;

166 
	`mem£t
(&
myInfo
, 0,  myInfo);

167 
myInfo
.
ai_çmy
 = 
AF_UNSPEC
;

168 
myInfo
.
ai_sockty³
 = 
SOCK_DGRAM
;

169 
myInfo
.
ai_æags
 = 
AI_PASSIVE
;

171 ià(
	`g‘addršfo
(
NULL
, 
s
.
	`¡r
().
	`c_¡r
(), &
myInfo
, &
»suÉs
) == -1) {

172 
	`Îog
(
ERROR
è<< "GameCÚŒŞËr: Inv®id Add»s InfÜm©iÚ" << 
’dl
;

177 
addršfo
 *
p
;

178 
p
 = 
»suÉs
;… !ğ
NULL
;… =…->
ai_Ãxt
) {

179 ià((
sock
 = 
	`sock‘
(
p
->
ai_çmy
,…->
ai_sockty³
,…->
ai_´ÙocŞ
)) == -1) {

180 
	`Îog
(
INFO
) << "GameController: Cannot use Socket,rying‚ext"

181 << 
’dl
;

185 ià(
	`bšd
(
sock
, 
p
->
ai_addr
,…->
ai_add¾’
) == -1) {

186 
	`şo£
(
sock
);

187 
	`Îog
(
INFO
è<< "GameCÚŒŞËr: CªnÙ Bšd,ryšg‚ext" << 
’dl
;

193 ià(
p
 =ğ
NULL
) {

194 
	`Îog
(
ERROR
è<< "GameCÚŒŞËr: FaedØbšd sock‘" << 
’dl
;

199 
	`ä“addršfo
(
»suÉs
);

201 
	`Îog
(
INFO
è<< "GameCÚŒŞËr: CÚÃùed oÀpÜˆ- " << 
s
.
	`¡r
(è<< 
’dl
;

202 
cÚÃùed
 = 
Œue
;

203 
	`wr™eTo
(
gameCÚŒŞËr
, 
cÚÃùed
, connected);

204 
	}
}

206 
	gGameCÚŒŞËr
::
	$bu‰ÚUpd©e
() {

207 ià(
bu‰Ús
.
	`pİ
(1)) {

208 
	`Îog
(
INFO
è<< "bu‰Ú…ushed onû, sw™chšg s‹" << 
’dl
;

209 
d©a
.
¡©e
) {

210 
STATE_INITIAL
:

211 
STATE_PLAYING
:

212 
d©a
.
¡©e
 = 
STATE_PENALISED
;

213 
d©a
.
‹ams
[
‹am_»d
].
¶ay”s
[
¶ay”Numb”
 - 1].
³ÇÉy
 =

214 
PENALTY_MANUAL
;

215 
	`SAY
("Penalised");

218 
d©a
.
¡©e
 = 
STATE_PLAYING
;

219 
d©a
.
‹ams
[
‹am_»d
].
¶ay”s
[
¶ay”Numb”
 - 1].
³ÇÉy
 =

220 
PENALTY_NONE
;

221 
	`SAY
("Playing");

224 
	}
}

226 
	gGameCÚŒŞËr
::
	$wœ–essUpd©e
() {

228 
by‹sRec›ved
;

229 
sockaddr_¡Üage
 
ş›ÁAdd»ss
;

230 
sockËn_t
 
addr_Ën
 = (
ş›ÁAdd»ss
);

233 
d©aSize
 = (
RoboCupGameCÚŒŞD©a
);

234 
bufãr
[
d©aSize
 + 1];

237 
pŞlfd
 
ufds
[1];

238 
ufds
[0].
fd
 = 
sock
;

239 
ufds
[0].
ev’ts
 = 
POLLIN
;

243 
i
 = 0; i < 5; i++) {

244 
rv
 = 
	`pŞl
(
ufds
, 1, 
POLL_TIMEOUT
);

247 ià(
rv
 > 0) {

248 
by‹sRec›ved
 = 
	`»cväom
(
sock
, 
bufãr
, 
d©aSize
, 0,

249 (
sockaddr
 *)&
ş›ÁAdd»ss
, &
addr_Ën
);

251 
	`wr™eTo
(
gameCÚŒŞËr
, 
Ï¡GameCÚŒŞËrIPAdd»ss
, 
	`š‘_Áß
(

252 ((
sockaddr_š
 *)&
ş›ÁAdd»ss
)->
sš_addr


254 ià(
by‹sRec›ved
 > 0) {

255 
	`·r£D©a
((
RoboCupGameCÚŒŞD©a
*)
bufãr
);

259 
	}
}

261 
boŞ
 
	gGameCÚŒŞËr
::
	$whi¡ËH—rd
(
numSecÚds
) {

262 cÚ¡ *
WHISTLE_FILE_FORMAT
 = "whistle_%Y_%m_%d_%H%M%S.wav";

263 cÚ¡ *
NAO_WHISTLE_LOCATION
 = "/home/nao/whistle";

264 
DIR
 *
dœ
;

265 
dœ’t
 *
’t
;

266 
tm
 
feD©eTime
;

267 
time_t
 
now
 = 
	`time
(0);

268 
boŞ
 
found
 = 
çl£
;

270 ià((
dœ
 = 
	`İ’dœ
 (
NAO_WHISTLE_LOCATION
)è!ğ
NULL
) {

272 (
’t
 = 
	`»addœ
 (
dœ
)è!ğ
NULL
) {

273 
	`¡½time
(
’t
->
d_Çme
, 
WHISTLE_FILE_FORMAT
, &
feD©eTime
);

274 
£cÚds
 = 
	`difáime
(
now
, 
	`mktime
(&
feD©eTime
));

278 ià(
	`abs
(
£cÚds
è< 
numSecÚds
 &&

279 
£cÚds
 < 
numSecÚds
) {

280 
found
 = 
Œue
;

284 
	`şo£dœ
 (
dœ
);

289  
found
;

290 
	}
}

292 
	gGameCÚŒŞËr
::
	$·r£D©a
(
RoboCupGameCÚŒŞD©a
 *
upd©e
) {

293 ià(
	`isV®idD©a
(
upd©e
)) {

295 ià(
upd©e
->
‹ams
[
TEAM_BLUE
].
‹amCŞour
 != TEAM_BLUE) {

296 
	`¿wSw­T—ms
(
upd©e
);

301 ià((
upd©e
->
¡©e
è=ğ
STATE_SET
 && 
d©a
.¡©=ğ
STATE_PLAYING
) {

302 
upd©e
->
¡©e
 = 
STATE_PLAYING
;

306 ià(!
	`gameD©aEqu®
(
upd©e
, &
d©a
)) {

307 
	`memıy
(&
d©a
, 
upd©e
, (
RoboCupGameCÚŒŞD©a
));

310 
	`Îog
(
VERBOSE
è<< "GameCÚŒŞËr: V®id d©a" << 
’dl
;

311 ià(
d©a
.
¡©e
 !ğ
Ï¡S‹
) {

313 
comboS‹
[100];

314 
	`¡rıy
(
comboS‹
, 
gameCÚŒŞËrSecS‹Names
[
upd©e
->
£cÚd¬yS‹
]);

315 
	`¡rÿt
(
comboS‹
, 
gameCÚŒŞËrS‹Names
[
d©a
.
¡©e
]);

316 
	`SAY
(
comboS‹
);

326 
Ï¡S‹
 = 
d©a
.
¡©e
;

329 
ušt8
 
myP’®ty
 = 
d©a
.
‹ams
[
‹am_»d
].
¶ay”s
[
¶ay”Numb”
 - 1].
³ÇÉy
;

331 ià(
myP’®ty
 !ğ
PENALTY_NONE
) {

332 
d©a
.
¡©e
 = 
STATE_PENALISED
;

335 ià(
myP’®ty
 !ğ
myLa¡P’®ty
) {

336 ià(
myP’®ty
 =ğ
PENALTY_NONE
) {

337 
	`SAY
("Unpenalised");

339 
	`SAY
((
	`¡ršg
("Penalised for ") +

340 
gameCÚŒŞËrP’®tyNames
[
myP’®ty
]).
	`c_¡r
());

342 
myLa¡P’®ty
 = 
myP’®ty
;

345 
	`Îog
(
ERROR
è<< "GameCÚŒŞËr: Inv®id d©a" << 
’dl
;

347 
	}
}

349 
boŞ
 
	gGameCÚŒŞËr
::
	$isV®idD©a
(
RoboCupGameCÚŒŞD©a
 *
gameD©a
) {

351 ià(!(
	`checkH—d”
(
gameD©a
->
h—d”
))) {

352 
	`Îog
(
ERROR
) << "GameController: DATA HEADER MISMATCH! "

353 << "Ex³ùed: " << 
GAMECONTROLLER_STRUCT_HEADER


354 << "„eûived: " << 
gameD©a
->
h—d”
 << 
’dl
;

355  
çl£
;

359 ià((*
gameD©a
è!ğ(
RoboCupGameCÚŒŞD©a
)) {

360 
	`Îog
(
ERROR
) << "GameController: RECEIVED PARTIAL PACKET! "

361 << "Ex³ùed: " << (
RoboCupGameCÚŒŞD©a
)

362 << "„eûived: " << (*
gameD©a
è<< 
’dl
;

363  
çl£
;

367 ià(
gameD©a
->
v”siÚ
 !ğ
GAMECONTROLLER_STRUCT_VERSION
) {

368 
	`Îog
(
ERROR
) << "GameController: DATA VERSION MISMATCH! "

369 << "Ex³ùed: " << 
GAMECONTROLLER_STRUCT_VERSION


370 << "„eûived: " << 
gameD©a
->
v”siÚ
 << 
’dl
;

371  
çl£
;

375 ià(!
	`isThisGame
(
gameD©a
)) {

376 
	`Îog
(
ERROR
è<< "GameCÚŒŞËr: DATA NOT FOR THIS GAME!" << 
’dl
;

377  
çl£
;

381  
Œue
;

382 
	}
}

384 
boŞ
 
	gGameCÚŒŞËr
::
	$checkH—d”
(* 
h—d”
) {

385 
i
 = 0; i < 4; i++) {

386 ià(
h—d”
[
i
] !ğ
GAMECONTROLLER_STRUCT_HEADER
[i]è 
çl£
;

388  
Œue
;

389 
	}
}

391 
boŞ
 
	gGameCÚŒŞËr
::
	$isThisGame
(
RoboCupGameCÚŒŞD©a
* 
gameD©a
) {

392 ià(
gameD©a
->
‹ams
[
TEAM_BLUE
].
‹amNumb”
 !=eamNumber &&

393 
gameD©a
->
‹ams
[
TEAM_RED
].
‹amNumb”
 !=eamNumber) {

394  
çl£
;

396  
Œue
;

397 
	}
}

399 
boŞ
 
	gGameCÚŒŞËr
::
	$gameD©aEqu®
(* 
gameD©a
, * 
´evious
) {

400 ià(!
	`memcmp
(
´evious
, 
gameD©a
, (
RoboCupGameCÚŒŞD©a
))) {

401  
Œue
;

403  
çl£
;

404 
	}
}

406 
	gGameCÚŒŞËr
::
	$¿wSw­T—ms
(
RoboCupGameCÚŒŞD©a
* 
gameD©a
) {

407 
size_t
 
‹amSize
 = (
T—mInfo
);

408 
T—mInfo
* 
blueT—m
 = &(
gameD©a
->
‹ams
[
TEAM_BLUE
]);

409 
T—mInfo
* 
»dT—m
 = &(
gameD©a
->
‹ams
[
TEAM_RED
]);

411 
T—mInfo
 
‹mpT—m
;

412 
	`memıy
(&
‹mpT—m
, 
blueT—m
, 
‹amSize
);

415 
	`memıy
(
blueT—m
, 
»dT—m
, 
‹amSize
);

416 
	`memıy
(
»dT—m
, &
‹mpT—m
, 
‹amSize
);

417 
	}
}

	@robot/gamecontroller/GameController.hpp

39 #´agm¨
Úû


41 
	~<dœ’t.h
>

42 
	~<ùime
>

43 
	~<time.h
>

44 
	~<¡ršg
>

45 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

46 
	~"ty³s/Bu‰ÚP»s£s.hµ
"

47 
	~"bÏckbßrd/Ad­‹r.hµ
"

49 şas 
	cGameCÚŒŞËr
 : 
Ad­‹r
 {

50 
public
:

52 
GameCÚŒŞËr
(
BÏckbßrd
 *
bb
);

54 ~
GameCÚŒŞËr
();

56 
tick
();

57 
	m´iv©e
:

58 
RoboCupGameCÚŒŞD©a
 
d©a
;

59 
T—mInfo
 
	mour_‹am
;

60 
boŞ
 
	m‹am_»d
;

61 
boŞ
 
	mcÚÃùed
;

62 
	msock
;

67 
š™Ÿli£CÚÃùiÚ
();

72 
bu‰ÚUpd©e
();

77 
wœ–essUpd©e
();

83 
boŞ
 
whi¡ËH—rd
(
numSecÚds
);

86 
boŞ
 
	maùOnWhi¡Ë
;

92 
·r£D©a
(
RoboCupGameCÚŒŞD©a
 *
upd©e
);

96 
boŞ
 
isV®idD©a
(
RoboCupGameCÚŒŞD©a
 *
gameD©a
);

98 
boŞ
 
checkH—d”
(* 
h—d”
);

100 
boŞ
 
isThisGame
(
RoboCupGameCÚŒŞD©a
 *
gameD©a
);

102 
boŞ
 
gameD©aEqu®
(* 
gameD©a
, * 
´evious
);

104 
¿wSw­T—ms
(
RoboCupGameCÚŒŞD©a
 *
gameD©a
);

109 
ušt8_t
 
	mÏ¡S‹
;

110 
ušt16_t
 
	mmyLa¡P’®ty
;

113 
	m¶ay”Numb”
;

114 
	m‹amNumb”
;

117 
Bu‰ÚP»s£s
 
	mbu‰Ús
;

	@robot/gamecontroller/RoboCupGameControlData.cpp

32 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

34 cÚ¡ *
	ggameCÚŒŞËrSecS‹Names
[] = {

42 cÚ¡ *
	ggameCÚŒŞËrS‹Names
[] = {

52 cÚ¡ *
	ggameCÚŒŞËrP’®tyNames
[] = {

	@robot/gamecontroller/RoboCupGameControlData.hpp

1 #iâdeà
ROBOCUPGAMECONTROLDATA_H


2 
	#ROBOCUPGAMECONTROLDATA_H


	)

4 
	~"SPLCßchMes§ge.h
"

6 
	#GAMECONTROLLER_DATA_PORT
 3838

	)

7 
	#GAMECONTROLLER_RETURN_PORT
 3939

	)

9 
	#GAMECONTROLLER_STRUCT_HEADER
 "RGme"

	)

10 
	#GAMECONTROLLER_STRUCT_VERSION
 9

	)

12 
	#MAX_NUM_PLAYERS
 11

	)

15 
	#TEAM_BLUE
 0

16 
	#TEAM_RED
 1

17 
	#TEAM_YELLOW
 2

18 
	#TEAM_BLACK
 3

19 

	)

21 
	#TEAM_CYAN
 0

	)

22 
	#TEAM_MAGENTA
 1

	)

23 
	#DROPBALL
 255

	)

25 
	#GAME_ROUNDROBIN
 0

	)

26 
	#GAME_PLAYOFF
 1

	)

28 
	#STATE_INITIAL
 0

	)

29 
	#STATE_READY
 1

	)

30 
	#STATE_SET
 2

	)

31 
	#STATE_PLAYING
 3

	)

32 
	#STATE_FINISHED
 4

	)

34 
	#STATE_INVALID
 5

	)

35 
	#STATE_PENALISED
 6

	)

38 
	#STATE2_NORMAL
 0

	)

39 
	#STATE2_PENALTYSHOOT
 1

	)

40 
	#STATE2_OVERTIME
 2

	)

41 
	#STATE2_TIMEOUT
 3

	)

43 
	#PENALTY_NONE
 0

	)

45 
	#PENALTY_SPL_ILLEGAL_BALL_CONTACT
 1

46 
	#PENALTY_SPL_PLAYER_PUSHING
 2

	)

47 
	#PENALTY_SPL_ILLEGAL_MOTION_IN_SET
 3

48 
	#PENALTY_SPL_INACTIVE_PLAYER
 4

49 
	#PENALTY_SPL_ILLEGAL_DEFENDER
 5

50 
	#PENALTY_SPL_LEAVING_THE_FIELD
 6

	)

51 
	#PENALTY_SPL_KICK_OFF_GOAL
 7

52 
	#PENALTY_SPL_REQUEST_FOR_PICKUP
 8

	)

53 
	#PENALTY_SPL_COACH_MOTION
 9

	)

55 
	#PENALTY_HL_KID_BALL_MANIPULATION
 1

	)

56 
	#PENALTY_HL_KID_PHYSICAL_CONTACT
 2

	)

57 
	#PENALTY_HL_KID_ILLEGAL_ATTACK
 3

	)

58 
	#PENALTY_HL_KID_ILLEGAL_DEFENSE
 4

	)

59 
	#PENALTY_HL_KID_REQUEST_FOR_PICKUP
 5

	)

60 
	#PENALTY_HL_KID_REQUEST_FOR_SERVICE
 6

	)

61 
	#PENALTY_HL_KID_REQUEST_FOR_PICKUP_2_SERVICE
 7

	)

63 
	#PENALTY_HL_TEEN_BALL_MANIPULATION
 1

	)

64 
	#PENALTY_HL_TEEN_PHYSICAL_CONTACT
 2

	)

65 
	#PENALTY_HL_TEEN_ILLEGAL_ATTACK
 3

	)

66 
	#PENALTY_HL_TEEN_ILLEGAL_DEFENSE
 4

	)

67 
	#PENALTY_HL_TEEN_REQUEST_FOR_PICKUP
 5

	)

68 
	#PENALTY_HL_TEEN_REQUEST_FOR_SERVICE
 6

	)

69 
	#PENALTY_HL_TEEN_REQUEST_FOR_PICKUP_2_SERVICE
 7

	)

71 
	#PENALTY_SUBSTITUTE
 14

	)

72 
	#PENALTY_MANUAL
 15

	)

75 
	sPÏy”Info


77 
ušt8_t
 
	m³ÇÉy
;

78 
ušt8_t
 
	m£csTlUÅ’®i£d
;

81 
	sT—mInfo


83 
ušt8_t
 
	m‹amNumb”
;

84 
ušt8_t
 
	m‹amCŞour
;

85 
ušt8_t
 
	mscÜe
;

86 
ušt8_t
 
	m³ÇÉyShÙ
;

87 
ušt16_t
 
	msšgËShÙs
;

88 
ušt8_t
 
	mcßchSequ’û
;

89 
ušt8_t
 
	mcßchMes§ge
[
SPL_COACH_MESSAGE_SIZE
];

90 
PÏy”Info
 
	mcßch
;

91 
PÏy”Info
 
	m¶ay”s
[
MAX_NUM_PLAYERS
];

94 
	sRoboCupGameCÚŒŞD©a


96 
	mh—d”
[4];

97 
ušt16_t
 
	mv”siÚ
;

98 
ušt8_t
 
	m·ck‘Numb”
;

99 
ušt8_t
 
	m¶ay”sP”T—m
;

100 
ušt8_t
 
	mgameTy³
;

101 
ušt8_t
 
	m¡©e
;

102 
ušt8_t
 
	mfœ¡H®f
;

103 
ušt8_t
 
	mkickOffT—m
;

104 
ušt8_t
 
	m£cÚd¬yS‹
;

105 
ušt8_t
 
	mdrİInT—m
;

106 
ušt16_t
 
	mdrİInTime
;

107 
ušt16_t
 
	m£csRemaššg
;

108 
ušt16_t
 
	m£cÚd¬yTime
;

109 
T—mInfo
 
	m‹ams
[2];

113 
	#GAMECONTROLLER_RETURN_STRUCT_HEADER
 "RG¹"

	)

114 
	#GAMECONTROLLER_RETURN_STRUCT_VERSION
 2

	)

116 
	#GAMECONTROLLER_RETURN_MSG_MAN_PENALISE
 0

	)

117 
	#GAMECONTROLLER_RETURN_MSG_MAN_UNPENALISE
 1

	)

118 
	#GAMECONTROLLER_RETURN_MSG_ALIVE
 2

	)

120 
	sRoboCupGameCÚŒŞR‘uºD©a


122 
	mh—d”
[4];

123 
ušt8_t
 
	mv”siÚ
;

124 
ušt8_t
 
	m‹am
;

125 
ušt8_t
 
	m¶ay”
;

126 
ušt8_t
 
	mmes§ge
;

128 #ifdeà
__ılu¥lus


130 
RoboCupGameCÚŒŞR‘uºD©a
(è: 
v”siÚ
(
GAMECONTROLLER_RETURN_STRUCT_VERSION
)

132 cÚ¡ * 
š™
 = 
GAMECONTROLLER_RETURN_STRUCT_HEADER
;

133 
	mi
 = 0; i < (
	mh—d”
); ++i)

134 
	mh—d”
[
i
] = 
š™
[i];

140 cÚ¡ * 
gameCÚŒŞËrSecS‹Names
[4];

141 cÚ¡ * 
gameCÚŒŞËrS‹Names
[8];

143 cÚ¡ *
gameCÚŒŞËrP’®tyNames
[17];

	@robot/gamecontroller/SPLCoachMessage.h

1 #iâdeà
SPLCOACHMESSAGE_H


2 
	#SPLCOACHMESSAGE_H


	)

4 
	~<¡dšt.h
>

5 #ifdeà
__ılu¥lus


8 
	#SPL_COACH_MESSAGE_PORT
 3839

	)

10 
	#SPL_COACH_MESSAGE_STRUCT_HEADER
 "SPLC"

	)

11 
	#SPL_COACH_MESSAGE_STRUCT_VERSION
 3

	)

12 
	#SPL_COACH_MESSAGE_SIZE
 81

	)

14 
	tušt8
;

15 
	tušt16
;

16 
	tušt32
;

18 
	sSPLCßchMes§ge


20 
	mh—d”
[4];

21 
ušt8_t
 
	mv”siÚ
;

22 
ušt8_t
 
	m‹am
;

23 
ušt8_t
 
	m£qu’û
;

26 
ušt8_t
 
	mmes§ge
[
SPL_COACH_MESSAGE_SIZE
];

28 #ifdeà
__ılu¥lus


30 
SPLCßchMes§ge
(è: 
v”siÚ
(
SPL_COACH_MESSAGE_STRUCT_VERSION
)

32 cÚ¡ * 
š™
 = 
SPL_COACH_MESSAGE_STRUCT_HEADER
;

33 
	mi
 = 0; i < (
	mh—d”
); ++i)

34 
	mh—d”
[
i
] = 
š™
[i];

	@robot/libagent/AgentData.hpp

32 #´agm¨
Úû


34 
	~<±h»ad.h
>

35 
	~"ty³s/AùiÚCommªd.hµ
"

36 
	~"ty³s/JoštV®ues.hµ
"

37 
	~"ty³s/S’sÜV®ues.hµ
"

38 
	~"ty³s/Bu‰ÚP»s£s.hµ
"

40 
	#AGENT_MEMORY
 "/libag’t-memÜy"

	)

41 
	#AGENT_SEMAPHORE
 "/libag’t-£m­hÜe"

	)

42 
	#AL_ON
 -2.0f

	)

43 
	#AL_commªd
 
¡ifâes£s
[
Jošts
::
LShould”P™ch
]

	)

44 
	#AL_x
 
ªgËs
[
Jošts
::
LShould”P™ch
]

	)

45 
	#AL_y
 
ªgËs
[
Jošts
::
LShould”RŞl
]

	)

46 
	#AL_th‘a
 
ªgËs
[
Jošts
::
LElbowYaw
]

	)

47 
	#AL_äequ’cy
 
ªgËs
[
Jošts
::
LElbowRŞl
]

	)

48 
	#AL_¡İ
 
ªgËs
[
Jošts
::
LHYawP™ch
]

	)

49 
	#AL_»£t
 
ªgËs
[
Jošts
::
LHRŞl
]

	)

50 
	#AL_height
 
ªgËs
[
Jošts
::
LHP™ch
]

	)

51 
	#AL_b’d
 
ªgËs
[
Jošts
::
LKÃeP™ch
]

	)

52 
	#AL_isAùive
 
jošts
.
‹m³¿tu»s
[
Jošts
::
LShould”P™ch
]

	)

54 
	sAg’tD©a
 {

55 vŞ©
ušt8_t
 
	m£nsÜs_»ad
;

56 vŞ©
ušt8_t
 
	m£nsÜs_Ï‹¡
;

57 vŞ©
ušt8_t
 
	maùu©Üs_Ï‹¡
;

58 vŞ©
ušt8_t
 
	maùu©Üs_»ad
;

60 
S’sÜV®ues
 
	m£nsÜs
[3];

61 
Bu‰ÚP»s£s
 
	mbu‰Ús
[3];

62 
JoštV®ues
 
	mjošts
[3];

63 
	mAùiÚCommªd
::
LED
 
Ëds
[3];

64 
	msÚ¬
[3];

65 
	m§yTexts
[3][35];

67 vŞ©
boŞ
 
	m¡ªdšg
;

69 
š™
() {

70 
	m£nsÜs_»ad
 = 0;

71 
	m£nsÜs_Ï‹¡
 = 0;

72 
	maùu©Üs_»ad
 = 0;

73 
	maùu©Üs_Ï‹¡
 = 0;

74 
	mi
 = 0; i < 3; i++) {

75 
	m§yTexts
[
i
][0] = 0;

	@robot/libagent/libagent.cpp

27 
	~"libag’t/libag’t.hµ
"

28 
	~<sys/mmª.h
>

29 
	~<sys/¡©.h
>

30 
	~<sys/time.h
>

31 
	~<sys/wa™.h
>

32 
	~<fú.h
>

33 
	~<uni¡d.h
>

34 
	~<boo¡/bšd.hµ
>

35 
	~<boo¡/Ëxiÿl_ÿ¡.hµ
>

36 
	~<lim™s
>

37 
	~<¡ršg
>

38 
	~<¡ack
>

39 
	~<veùÜ
>

40 
	~"uts/basic_m©hs.hµ
"

41 
	~"uts/body.hµ
"

42 
	~"uts/İtiÚs.hµ
"

46 
	#SAY
(
‹xt
) \

47 ià(
§yTim”
.
	`–­£d_ms
() > 3000) { \

48 
§yTim”
.
	`»¡¬t
(); \

49 
¥“ch
->
po¡
.
	`§y
(
‹xt
); \

50 }

	)

52 
usšg
 
Çme¥aû
 
	gAL
;

53 
usšg
 
	g¡d
::
¡ršg
;

54 
Çme¥aû
 
	gpo
 = 
boo¡
::
´og¿m_İtiÚs
;

56 
	g»t
;

58 cÚ¡ 
	g¡d
::
¡ršg
 
Ag’t
::
Çme
("libagent");

60 
	$´eC®lback_
(
Ag’t
* 
a
) {

61 
a
->
	`´eC®lback
();

62 
	}
}

63 
	$po¡C®lback_
(
Ag’t
* 
a
) {

64 
a
->
	`po¡C®lback
();

65 
	}
}

68 
šlše
 
	$timeNow
() {

69 
ba£
 = 0;

70 
timev®
 
tv
;

71 
	`g‘timeofday
(&
tv
, 0);

72 
time
 = ()(
tv
.
tv_£c
 * 1000 +v.
tv_u£c
 / 1000);

73 ià(!
ba£
)

74 
ba£
 = 
time
 - 10000;

75  
time
 - 
ba£
;

76 
	}
}

78 
	gAg’t
::
	$doN‘wÜkšg
() {

79 
	`SAY
("fixing‚etworking");

80 
»t
 = 
	`sy¡em
("sudo ifconfig wlan0‚etmask 255.255.0.0");

81 
»t
++;

85 
	}
}

87 
	gAg’t
::
	$doAvahi
() {

88 
	`SAY
("fixing‡vahi");

89 
»t
 = 
	`sy¡em
("/bin/su -c '/etc/init.d/avahi-daemon„estart'");

90 
	}
}

92 
	gAg’t
::
	$doB©‹ry
(
ch¬ge
, 
cu¼’t
, 
¡©us
) {

95 
b©‹ry
 = 
ch¬ge
 * 33;

97 ià(
Şd_b©‹ry
 > 
b©‹ry
 && battery <= 10) {

98 
	`SAY
("b©‹ry " + 
boo¡
::
Ëxiÿl_ÿ¡
<
¡ršg
>(
b©‹ry
 * 3) +

101 
Şd_b©‹ry
 = 
b©‹ry
;

102 
¡d
::
b™£t
<16> 
b
 = 
¡©us
;

103 ià(!
Şd_b©‹ry_¡©us
[5] && 
b
[5]) {

104 
log
->
	`šfo
(
Çme
, "Discharging");

105 } ià(!
Şd_b©‹ry_¡©us
[6] && 
b
[6]) {

106 
log
->
	`šfo
(
Çme
, "Fully Charged");

107 } ià(!
Şd_b©‹ry_¡©us
[7] && 
b
[7]) {

108 
log
->
	`šfo
(
Çme
, "Charging");

110 
Şd_b©‹ry_¡©us
 = 
b
;

111 
	}
}

113 
	gAg’t
::
	$doTemps
() {

114 
t
 = 0;

115 ià(
t
 % 100 == 0 &&

116 *
‹m³¿tu»_poš‹rs
[
t
 / 100] > 75 &&

117 !
limp
 && !
sh¬ed_d©a
->
¡ªdšg
 &&

118 
sh¬ed_d©a
->
jošts
[sh¬ed_d©a->
aùu©Üs_»ad
].
¡ifâes£s
[
t
 / 100] > 0)

119 
	`SAY
("OVERHEATING: " + 
Jošts
::
æ™eJoštNames
[
t
 / 100]);

120 
t
 = (ˆ+ 1è% (
Jošts
::
NUMBER_OF_JOINTS
 * 100);

121 
	}
}

123 
	gAg’t
::
	$doBu‰Ús
(
boŞ
 
che¡
, boŞ 
Ëá
, boŞ 
right
) {

125 ià(
che¡_up
 > 
MAX_CLICK_INTERVAL
 && 
che¡_´es£s
) {

126 
bu‰Ús
.
	`push
(
che¡_´es£s
);

127 
che¡_´es£s
 = 0;

128 ià(
bu‰Ús
.
	`pİ
(2)) {

129 ià(
Ëá
 || 
right
) {

130 
h—d_limp
 = !head_limp;

131 
	`SAY
(
¡d
::
	`¡ršg
("head ") +

132 (
h—d_limp
 ? "limp" : "stiff"));

134 ià(
limp
) {

135 
limp
 = 
çl£
;

136 
sh¬ed_d©a
->
¡ªdšg
 = 
Œue
;

138 
limp
 = 
Œue
;

139 
s™_¡•
 = -1.0f;

140 
sh¬ed_d©a
->
¡ªdšg
 = 
çl£
;

142 
	`SAY
(
¡d
::
	`¡ršg
("body ") +

143 (
limp
 ? "limp" : "stiff"));

145 } ià(
bu‰Ús
.
	`pİ
(3)) {

146 ià(
Ëá
 || 
right
) {

147 
	`SAY
("Restarting‚ow key");

152 
»t
 = 
	`sy¡em
("/usr/bin/killall„unswift");

153 
»t
 = 
	`sy¡em
("sudo /sbin/init‡");

156 ià(
sk³d_äames
 > 
MAX_SKIPS
) {

157 
	`SAY
("loaded„unswift");

158 ià(!
	`fÜk
()) {

159 
sched_·¿m
 
s
;

160 
s
.
sched_´iÜ™y
 = 0;

161 
»t
 = 
	`sched_£tscheduËr
(0, 
SCHED_OTHER
, &
s
);

162 
»t
 = 
	`sy¡em
("/usr/bin/killall„unswift");

163 
»t
 = 
	`exeşp
("/home/nao/bin/runswift", "runswift",

164 (*)
NULL
);

167 
	`SAY
("killed„unswift");

168 
»t
 = 
	`sy¡em
("/usr/bin/killall„unswift");

169 
	`wa™pid
(-1, 
NULL
, 
WNOHANG
) > 0) ;

172 } ià(
bu‰Ús
.
	`pİ
(4)) {

173 ià((
Ëá
 || 
right
)) {

174 
	`SAY
("flashing chest board");

175 
»t
 = 
	`sy¡em
("sudo /sbin/init c");

177 
	`SAY
("Restart wifi");

178 
	`sy¡em
("sudo /etc/init.d/runswiftwireless„estart");

185 ià(
che¡_down
 > 300) {

186 ià(
Ëá
 || 
right
) {

187 
	`SAY
("Flashing‡nd Restarting");

188 
»t
 = 
	`sy¡em
("/bin/su -c '/usr/bin/killall„unswift'");

189 
»t
 = 
	`sy¡em
("/bin/su -c '/sbin/init b'");

190 
limp
 = 
Œue
;

191 
che¡_down
 = 
¡d
::
num”ic_lim™s
<>::
	`mš
();

193 
	`SAY
("Shutting down");

194 
»t
 = 
	`sy¡em
("sudo '/usr/bin/killall„unswift'");

195 
»t
 = 
	`sy¡em
("sudo /sbin/halt");

196 
limp
 = 
Œue
;

197 
che¡_down
 = 
¡d
::
num”ic_lim™s
<>::
	`mš
();

202 ià(
che¡
) {

203 ià(
che¡_down
 >= 0) chest_down++;

204 
che¡_up
 = 0;

206 
che¡_up
++;

207 ià(
che¡_down
 > 0) {

208 
che¡_´es£s
++;

209 
che¡_down
 = 0;

212 
	}
}

214 
em±ySck
(
¡d
::
¡ack
<>& 
s
){

215 !
s
.
em±y
()){

216 
s
.
pİ
();

220 
	gAg’t
::
	$doH—dTouch
(
h—dTouchFrÚt
,

221 
h—dTouchR—r
,

222 
h—dTouchMiddË
) {

224 
time_now
 = 
	`timeNow
();

225 ià(
time_now
 - 
Ï¡_´ess_time
 > 500){

226 
	`em±ySck
(
h—d_´ess_¡ack
);

228 ià(
h—d_´ess_¡ack
.
	`em±y
()){

229 
Ï¡_´ess_time
 = 
	`timeNow
();

231 ià(
h—dTouchFrÚt
 && !
h—dTouchR—r
){

232 
h—d_´ess_¡ack
.
	`push
(
HEAD_FRONT
);

233 } ià(
h—dTouchR—r
 && !
h—dTouchFrÚt
){

234 
h—d_´ess_¡ack
.
	`push
(
HEAD_BACK
);

236 } ià(
h—d_´ess_¡ack
.
	`size
() == 1){

237 
Ï¡_´ess_time
 = 
	`timeNow
();

238 ià(
h—dTouchMiddË
 && !
h—dTouchR—r
 && !
h—dTouchFrÚt
){

239 
h—d_´ess_¡ack
.
	`push
(
HEAD_MIDDLE
);

241 } ià(
h—d_´ess_¡ack
.
	`size
() == 2){

242 ià(!
h—dTouchMiddË
){

243 
Ï¡_´ess_time
 = 
	`timeNow
();

244 
h—d_´ess_¡ack
.
	`pİ
();

245 
fœ¡_´ess
 = 
h—d_´ess_¡ack
.
	`tİ
();

246 
h—d_´ess_¡ack
.
	`pİ
();

247 
Ï¡_´ess
 = -1;

248 ià(
h—dTouchFrÚt
){

249 
Ï¡_´ess
 = 
HEAD_FRONT
;

250 } ià(
h—dTouchR—r
){

251 
Ï¡_´ess
 = 
HEAD_BACK
;

253 ià(
Ï¡_´ess
 !ğ
fœ¡_´ess
){

254 ià(
Ï¡_´ess
 =ğ
HEAD_FRONT
){

256 
	`SAY
("kill‡ll„unswift");

257 
»t
 = 
	`sy¡em
("/usr/bin/killall„unswift");

260 ià(
sk³d_äames
 > 
MAX_SKIPS
) {

261 
	`SAY
("loaded„unswift");

262 ià(!
	`fÜk
()) {

263 
sched_·¿m
 
s
;

264 
s
.
sched_´iÜ™y
 = 0;

265 
»t
 = 
	`sched_£tscheduËr
(0, 
SCHED_OTHER
, &
s
);

266 
»t
 = 
	`exeşp
("/home/nao/bin/runswift", "runswift",

267 (*)
NULL
);

274 
	}
}

276 
	gAg’t
::
	$doLEDs
(
AùiÚCommªd
::
LED
& 
Ëds
) {

277 
ušt8_t
 
i
;

280 
ušt16_t
 
tmp
 = 
sh¬ed_d©a
->
£nsÜs
[sh¬ed_d©a->
£nsÜs_Ï‹¡
].

281 
£nsÜs
[
S’sÜs
::
B©‹ry_Ch¬ge
] * 10;

282 
i
 = 
LEDs
::
LeáE¬1
; i <ğLEDs::
LeáE¬10
; ++i) {

283 
Ëd_commªd
[5][
i
][0] = (
tmp
 >= i) ? 1.0f : 0.0f;

287 
i
 = 
LEDs
::
RightE¬1
; i <ğLEDs::
RightE¬10
; ++i) {

288 
boŞ
 
is_Ú
 = 
Ëds
.
rightE¬
 >> (
i
-
LEDs
::
RightE¬1
) & 0x1;

289 
Ëd_commªd
[5][
i
][0] = (
is_Ú
 ? 1.0f : 0.0f);

301 ; 
i
 <ğ
LEDs
::
LeáEyeRed8
; ++i)

302 
Ëd_commªd
[5][
i
][0] = (è
Ëds
.
ËáEye
.
»d
;

303 ; 
i
 <ğ
LEDs
::
LeáEyeG»’8
; ++i)

304 
Ëd_commªd
[5][
i
][0] = (è
Ëds
.
ËáEye
.
g»’
;

305 ; 
i
 <ğ
LEDs
::
LeáEyeBlue8
; ++i)

306 
Ëd_commªd
[5][
i
][0] = (è
Ëds
.
ËáEye
.
blue
;

307 ; 
i
 <ğ
LEDs
::
RightEyeRed8
; ++i)

308 
Ëd_commªd
[5][
i
][0] = (è
Ëds
.
rightEye
.
»d
;

309 ; 
i
 <ğ
LEDs
::
RightEyeG»’8
; ++i)

310 
Ëd_commªd
[5][
i
][0] = (è
Ëds
.
rightEye
.
g»’
;

311 ; 
i
 <ğ
LEDs
::
RightEyeBlue8
; ++i)

312 
Ëd_commªd
[5][
i
][0] = (è
Ëds
.
rightEye
.
blue
;

315 
Ëd_commªd
[5][
LEDs
::
Che¡Red
][0] = (è
Ëds
.
che¡Bu‰Ú
.
»d
;

316 
Ëd_commªd
[5][
LEDs
::
Che¡G»’
][0] = (è
Ëds
.
che¡Bu‰Ú
.
g»’
;

317 
Ëd_commªd
[5][
LEDs
::
Che¡Blue
][0] = (è
Ëds
.
che¡Bu‰Ú
.
blue
;

320 
Ëd_commªd
[5][
LEDs
::
LeáFoÙRed
][0] = (è
Ëds
.
ËáFoÙ
.
»d
;

321 
Ëd_commªd
[5][
LEDs
::
LeáFoÙG»’
][0] = (è
Ëds
.
ËáFoÙ
.
g»’
;

322 
Ëd_commªd
[5][
LEDs
::
LeáFoÙBlue
][0] = (è
Ëds
.
ËáFoÙ
.
blue
;

323 
Ëd_commªd
[5][
LEDs
::
RightFoÙRed
][0] = (è
Ëds
.
rightFoÙ
.
»d
;

324 
Ëd_commªd
[5][
LEDs
::
RightFoÙG»’
][0] = (è
Ëds
.
rightFoÙ
.
g»’
;

325 
Ëd_commªd
[5][
LEDs
::
RightFoÙBlue
][0] = (è
Ëds
.
rightFoÙ
.
blue
;

326 
	}
}

328 
	gAg’t
::
	$´eC®lback
() {

329 
Tim”
 
t
;

331 ià(
shu‰šgDown
) {

335 cÚ¡ 
now
 = 
	`timeNow
();

336 
sh¬ed_d©a
->
aùu©Üs_»ad
 = sh¬ed_d©a->
aùu©Üs_Ï‹¡
;

337 
JoštV®ues
& 
jošts
 = 
sh¬ed_d©a
->jošts[sh¬ed_d©a->
aùu©Üs_»ad
];

338 
S’sÜV®ues
& 
£nsÜs
 = 
sh¬ed_d©a
->£nsÜs[sh¬ed_d©a->
£nsÜs_Ï‹¡
];

341 
¡ršg
 
	`§yText
(
sh¬ed_d©a
->
§yTexts
[sh¬ed_d©a->
aùu©Üs_»ad
]);

342 ià(!
§yText
.
	`em±y
()) {

343 
	`SAY
(
§yText
);

346 
	`doLEDs
(
sh¬ed_d©a
->
Ëds
[sh¬ed_d©a->
aùu©Üs_»ad
]);

347 ià(
limp
 || 
sh¬ed_d©a
->
¡ªdšg
) {

348 
ušt8_t
 
i
;

349 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

350 
h—d_ªgË_commªd
[5][
i
][0] = 
s™_ªgËs
[i];

351 
h—d_¡ifâess_commªd
[5][
i
][0] = 0.0f;

353 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

354 
ªgË_commªd
[5][
i
 - 2][0] = 
s™_ªgËs
[i];

355 
¡ifâess_commªd
[5][
i
 - 2][0] = 0.0f;

360 
blšk
 = 
now
 / 200 & 1;

361 ià(
sh¬ed_d©a
->
¡ªdšg
) {

362 
Ëd_commªd
[5][
LEDs
::
Che¡Red
][0] = 
blšk
;

363 
Ëd_commªd
[5][
LEDs
::
Che¡G»’
][0] = 
blšk
;

364 
Ëd_commªd
[5][
LEDs
::
Che¡Blue
][0] = 0.0;

365 } ià(
sk³d_äames
 <ğ
MAX_SKIPS
) {

366 
Ëd_commªd
[5][
LEDs
::
Che¡Red
][0] = 0.0f;

367 
Ëd_commªd
[5][
LEDs
::
Che¡G»’
][0] = 
blšk
;

368 
Ëd_commªd
[5][
LEDs
::
Che¡Blue
][0] = 0.0f;

370 
Ëd_commªd
[5][
LEDs
::
Che¡Red
][0] = 
blšk
;

371 
Ëd_commªd
[5][
LEDs
::
Che¡G»’
][0] = 0.0f;

372 
Ëd_commªd
[5][
LEDs
::
Che¡Blue
][0] = 0.0f;

374 } ià(
sk³d_äames
 <ğ
MAX_SKIPS
 && 
s™_¡•
 == -1.0f) {

375 
ušt8_t
 
i
;

376 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

377 
h—d_ªgË_commªd
[5][
i
][0] = 
jošts
.
ªgËs
[i];

378 
h—d_¡ifâess_commªd
[5][
i
][0] = 
jošts
.
¡ifâes£s
[i];

380 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

381 
ªgË_commªd
[5][
i
 - 2][0] = 
jošts
.
ªgËs
[i];

382 
¡ifâess_commªd
[5][
i
 - 2][0] = 
jošts
.
¡ifâes£s
[i];

385 ià(
s™_¡•
 == -1.0f) {

386 
s™_¡•
 = 0.0f;

387 
ušt8_t
 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i)

388 
s™_jošts
.
ªgËs
[
i
] = 
£nsÜs
.
jošts
.angles[i];

389 
	`SAY
("lost contact");

391 ià(
s™_¡•
 < 1.0f) {

393 
s™_¡•
 += 0.005f;

394 
ušt8_t
 
i
;

395 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

396 
h—d_ªgË_commªd
[5][
i
][0] = (1 - 
s™_¡•
è* 
s™_jošts
.
ªgËs
[i]

397 + 
s™_¡•
 * 
s™_ªgËs
[
i
];

398 
h—d_¡ifâess_commªd
[5][
i
][0] = 1.0f;

400 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

401 
k
 = (
i
 >ğ
Jošts
::
LShould”P™ch
 &&

402 
i
 <ğ
Jošts
::
LHªd
) ||

403 (
i
 >ğ
Jošts
::
RShould”P™ch
 &&

404 
i
 <ğ
Jošts
::
RHªd
) ? 2 : 1;

405 
k
 = 
	`MIN
(1.0f, k * 
s™_¡•
);

406 
ªgË_commªd
[5][
i
 - 2][0] = (1 - 
k
è* 
s™_jošts
.
ªgËs
[i] +

407 
k
 * 
s™_ªgËs
[
i
];

408 
¡ifâess_commªd
[5][
i
 - 2][0] = 1.0f;

411 
limp
 = 
Œue
;

412 
s™_¡•
 = -1.0f;

413 
ušt8_t
 
i
;

414 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

415 
h—d_ªgË_commªd
[5][
i
][0] = 
s™_ªgËs
[i];

416 
h—d_¡ifâess_commªd
[5][
i
][0] = 0.0f;

418 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

419 
ªgË_commªd
[5][
i
 - 2][0] = 
s™_ªgËs
[i];

420 
¡ifâess_commªd
[5][
i
 - 2][0] = 0.0f;

426 ià(
sk³d_äames
 > 
MAX_SKIPS
) {

427 
Ëd_commªd
[5][
LEDs
::
Che¡Red
][0] = 1.0f;

428 
Ëd_commªd
[5][
LEDs
::
Che¡G»’
][0] = 0.0f;

430 
Ëd_commªd
[5][
LEDs
::
Che¡Red
][0] = 0.0f;

431 
Ëd_commªd
[5][
LEDs
::
Che¡G»’
][0] = 1.0f;

433 
Ëd_commªd
[5][
LEDs
::
Che¡Blue
][0] = 0.0f;

436 
sÚ¬_commªd
[5][0][0] = 
sh¬ed_d©a
->
sÚ¬
[sh¬ed_d©a->
aùu©Üs_»ad
];

438 ià(
h—d_limp
) {

439 
blšk
 = 
now
 / 200 & 1;

440 
Ëd_commªd
[5][
LEDs
::
LeáEyeG»’8
][0] = 
blšk
;

441 
Ëd_commªd
[5][
LEDs
::
RightEyeG»’8
][0] = 
blšk
;

442 
h—d_¡ifâess_commªd
[5][
Jošts
::
H—dYaw
][0] = 0.0f;

443 
h—d_¡ifâess_commªd
[5][
Jošts
::
H—dP™ch
][0] = 0.0f;

446 
h—d_¡ifâess_commªd
[4][0] = ()
now
 + 
time_off£t
;

447 
h—d_ªgË_commªd
[4][0] = ()
now
 + 
time_off£t
;

448 
¡ifâess_commªd
[4][0] = ()
now
 + 
time_off£t
;

449 
ªgË_commªd
[4][0] = ()
now
 + 
time_off£t
;

450 
Ëd_commªd
[4][0] = ()
now
 + 
time_off£t
;

451 
sÚ¬_commªd
[4][0] = ()
now
 + 
time_off£t
;

452 
dcm
->
	`£tAlŸs
(
h—d_¡ifâess_commªd
);

453 
dcm
->
	`£tAlŸs
(
h—d_ªgË_commªd
);

454 ià(
limp
 || 
sh¬ed_d©a
->
¡ªdšg
 ||

455 !(
sk³d_äames
 <ğ
MAX_SKIPS
 && 
s™_¡•
 == -1.0f &&

456 
jošts
.
AL_commªd
 =ğ
AL_ON
)) {

457 
dcm
->
	`£tAlŸs
(
¡ifâess_commªd
);

458 
dcm
->
	`£tAlŸs
(
ªgË_commªd
);

460 
dcm
->
	`£tAlŸs
(
Ëd_commªd
);

461 ià(
sh¬ed_d©a
->
sÚ¬
[sh¬ed_d©a->
aùu©Üs_»ad
] !ğ()
SÚ¬
::
Mode
::
NO_PING
){

465 if(
t
.
	`–­£d_us
() > 1500){

466 
log
->
	`”rÜ
(
Çme
, "´eC®lbackook: " +
boo¡
::
Ëxiÿl_ÿ¡
<
¡ršg
>(
t
.
	`–­£d_us
()));

468 
	}
}

470 
	gAg’t
::
	$po¡C®lback
() {

471 
Tim”
 
t
;

473 ià(
shu‰šgDown
) {

478 
S’sÜV®ues
 
s
;

479 
i
;

480 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i)

481 
s
.
£nsÜs
[
i
] = *
£nsÜ_poš‹rs
[i];

482 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i) {

483 
s
.
jošts
.
ªgËs
 [
i
] = *
jošt_poš‹rs
 [i];

484 
s
.
jošts
.
‹m³¿tu»s
[
i
] = *
‹m³¿tu»_poš‹rs
[i];

485 
s
.
jošts
.
cu¼’ts
 [
i
] = *
cu¼’t_poš‹rs
 [i];

487 
i
 = 0; i < 
SÚ¬
::
NUMBER_OF_READINGS
; ++i)

488 
s
.
sÚ¬
[
i
] = *
sÚ¬_poš‹rs
[i];

491 
i
 = 0; i !ğ
sh¬ed_d©a
->
£nsÜs_Ï‹¡
 &&

492 
i
 !ğ
sh¬ed_d©a
->
£nsÜs_»ad
; ++i) ;

493 
sh¬ed_d©a
->
£nsÜs
[
i
] = 
s
;

495 cÚ¡ *
v
 = 
s
.
£nsÜs
;

496 
	`doB©‹ry
(
v
[
S’sÜs
::
B©‹ry_Ch¬ge
],

497 
v
[
S’sÜs
::
B©‹ry_Cu¼’t
],

498 *
b©‹ry_¡©us_poš‹r
);

499 
	`doBu‰Ús
(
v
[
S’sÜs
::
Che¡Bßrd_Bu‰Ú
],

500 
v
[
S’sÜs
::
LFoÙ_Bum³r_Leá
] || v[S’sÜs::
LFoÙ_Bum³r_Right
],

501 
v
[
S’sÜs
::
RFoÙ_Bum³r_Leá
] || v[S’sÜs::
RFoÙ_Bum³r_Right
]);

503 ià(
v
[
S’sÜs
::
H—d_Touch_FrÚt
] != 0

504 || 
v
[
S’sÜs
::
H—d_Touch_R—r
] != 0

505 || 
v
[
S’sÜs
::
H—d_Touch_MiddË
] != 0){

506 
	`doH—dTouch
(
v
[
S’sÜs
::
H—d_Touch_FrÚt
],

507 
v
[
S’sÜs
::
H—d_Touch_R—r
],

508 
v
[
S’sÜs
::
H—d_Touch_MiddË
]);

510 
	`doTemps
();

512 
sh¬ed_d©a
->
bu‰Ús
[
i
] = buttons;

513 
bu‰Ús
.
	`ş—r
();

514 
sh¬ed_d©a
->
£nsÜs_Ï‹¡
 = 
i
;

518 
	`£m_g‘v®ue
(
£m­hÜe
, &
i
);

519 ià(
i
 <= 0) {

520 
	`£m_po¡
(
£m­hÜe
);

521 ià(
sk³d_äames
 > 
MAX_SKIPS
) {

522 
log
->
	`šfo
(
Çme
, "Back‡fter " +

523 
boo¡
::
Ëxiÿl_ÿ¡
<
¡ršg
>(
sk³d_äames
));

525 
sk³d_äames
 = 0;

527 
sk³d_äames
++;

528 ià(
sk³d_äames
 <= 2)

529 
log
->
	`”rÜ
(
Çme
, "runswift missed one of our cycles");

532 if(
t
.
	`–­£d_us
() > 1500){

533 
log
->
	`”rÜ
(
Çme
, "po¡C®lbackook: " +
boo¡
::
Ëxiÿl_ÿ¡
<
¡ršg
>(
t
.
	`–­£d_us
()));

535 
	}
}

537 
	gAg’t
::
Ag’t
(
boo¡
::
sh¬ed_±r
<
AL
::
ALBrok”
> 
pBrok”
, cÚ¡ 
¡d
::
¡ršg
& 
pName
)

538 : 
ALModuË
(
pBrok”
, 
pName
),

539 
shu‰šgDown
(
çl£
),

540 
sk³d_äames
(0),

541 
s™_¡•
(-1.0f),

542 
limp
(
Œue
),

543 
h—d_limp
(
çl£
),

544 
che¡_down
(0),

545 
che¡_up
(0),

546 
che¡_´es£s
(0),

547 
Şd_b©‹ry
(0),

548 
	$Şd_b©‹ry_¡©us
(0) {

549 
ušt8_t
 
i
;

550 
¡d
::
cout
 << "¡¬tšg?" << std::
’dl
;

553 
log
 = 
Ãw
 
	`ALLogg”Proxy
(
pBrok”
);

554 ià(
log
 =ğ
NULL
)

555 
throw
 
	`ALERROR
(
Çme
, "constructor", "log == NULL");

557 
log
->
	`šfo
(
Çme
, "Constructing");

559 
Œy
 {

560 
po
::
İtiÚs_desütiÚ
 
cmdlše_İtiÚs
 =

561 
	`¡Üe_ªd_nÙify
(
¡d
::
veùÜ
<
¡ršg
>(0), 
vm
, 
NULL
);

562 
wœ–essIwcÚfigArgs
 = 
vm
["ÃtwÜk.wœ–ess.iwcÚfig_æags"].
as
<
¡ršg
>();

563 
wœ–essIfcÚfigArgs
 =

564 
vm
["ÃtwÜk.wœ–ess.¡©ic.ifcÚfig_æags"].
as
<
¡ršg
>();

565 
wœedIfcÚfigArgs
 =

566 
vm
["ÃtwÜk.wœed.¡©ic.ifcÚfig_æags"].
as
<
¡ršg
>();

568 
wœ–essStic
 = 
vm
["ÃtwÜk.wœ–ess.¡©ic"].
as
<
boŞ
>();

569 
wœedStic
 = 
vm
["ÃtwÜk.wœed.¡©ic"].
as
<
boŞ
>();

571 
¶ay”Num
 = 
vm
["¶ay”.numb”"].
as
<>();

572 
‹amNum
 = 
vm
["¶ay”.‹am"].
as
<>();

575 } 
	`ÿtch
 (
po
::
”rÜ
& 
e
) {

576 
log
->
	`”rÜ
(
Çme
, "failed…arsing command†ine‡rguments");

577 
log
->
	`”rÜ
(
Çme
, 
e
.
	`wh©
());

578 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

579 
log
->
	`”rÜ
(
Çme
, "failed…arsing command†ine‡rguments");

580 
log
->
	`”rÜ
(
Çme
, 
e
.
	`wh©
());

583 
dcm
 = 
Ãw
 
	`DCMProxy
(
pBrok”
);

584 ià(
dcm
 =ğ
NULL
)

585 
throw
 
	`ALERROR
(
Çme
, "constructor", "dcm == NULL");

587 
sÚ¬
 = 
Ãw
 
	`ALSÚ¬Proxy
("localhost", 9559);

588 
sÚ¬
->
	`subsüibe
("dcm",50,1.0);

589 
memÜy
 = 
Ãw
 
	`ALMemÜyProxy
(
pBrok”
);

590 ià(
memÜy
 =ğ
NULL
)

591 
throw
 
	`ALERROR
(
Çme
, "constructor", "memory == NULL");

593 
¥“ch
 = 
Ãw
 
	`ALTextToS³echProxy
("localhost", 9559);

594 ià(
¥“ch
 =ğ
NULL
)

595 
throw
 
	`ALERROR
(
Çme
, "constructor", "speech == NULL");

597 
log
->
	`šfo
(
Çme
, "Contructed speech");

599 
Ëg_Çmes
.
	`push_back
("LHYawP™ch"), 
¡ªd_ªgËs
.push_back(0.f);

600 
Ëg_Çmes
.
	`push_back
("LHRŞl"), 
¡ªd_ªgËs
.push_back(0.f);

601 
Ëg_Çmes
.
	`push_back
("LHP™ch"), 
¡ªd_ªgËs
.push_back(
	`DEG2RAD
(-25.f));

602 
Ëg_Çmes
.
	`push_back
("LKÃeP™ch"), 
¡ªd_ªgËs
.push_back(
	`DEG2RAD
(50.f));

603 
Ëg_Çmes
.
	`push_back
("LAnkËP™ch"), 
¡ªd_ªgËs
.push_back(
	`DEG2RAD
(-25.f));

604 
Ëg_Çmes
.
	`push_back
("LAnkËRŞl"), 
¡ªd_ªgËs
.push_back(0.f);

605 
Ëg_Çmes
.
	`push_back
("RHRŞl"), 
¡ªd_ªgËs
.push_back(0.f);

606 
Ëg_Çmes
.
	`push_back
("RHP™ch"), 
¡ªd_ªgËs
.push_back(
	`DEG2RAD
(-25.f));

607 
Ëg_Çmes
.
	`push_back
("RKÃeP™ch"), 
¡ªd_ªgËs
.push_back(
	`DEG2RAD
(50.f));

608 
Ëg_Çmes
.
	`push_back
("RAnkËP™ch"), 
¡ªd_ªgËs
.push_back(
	`DEG2RAD
(-25.f));

609 
Ëg_Çmes
.
	`push_back
("RAnkËRŞl"), 
¡ªd_ªgËs
.push_back(0.f);

612 
sh¬ed_fd
 = 
	`shm_İ’
(
AGENT_MEMORY
, 
O_RDWR
 | 
O_CREAT
, 0600);

613 ià(
sh¬ed_fd
 < 0)

614 
throw
 
	`ALERROR
(
Çme
, "constructor", "shm_open() failed");

616 ià(
	`árunÿ‹
(
sh¬ed_fd
, (
Ag’tD©a
)) == -1)

617 
throw
 
	`ALERROR
(
Çme
, "constructor", "ftruncate() failed");

619 
sh¬ed_d©a
 = (
Ag’tD©a
*è
	`mm­
(
NULL
, (AgentData),

620 
PROT_READ
 | 
PROT_WRITE
,

621 
MAP_SHARED
, 
sh¬ed_fd
, 0);

622 ià(
sh¬ed_d©a
 =ğ
MAP_FAILED
)

623 
throw
 
	`ALERROR
(
Çme
, "constructor", "mmap() failed");

625 
log
->
	`šfo
(
Çme
, "Constructed shared_data");

628 
sh¬ed_d©a
->
	`š™
();

630 
S’sÜV®ues
 
nuÎ_£nsÜs
;

631 
JoštV®ues
 
nuÎ_jošts
;

632 
AùiÚCommªd
::
LED
 
nuÎ_Ëds
;

633 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i) {

634 
nuÎ_jošts
.
ªgËs
[
i
] = 0.0f;

635 
nuÎ_jošts
.
¡ifâes£s
[
i
] = 0.0f;

636 
nuÎ_jošts
.
‹m³¿tu»s
[
i
] = 0.0f;

638 
nuÎ_£nsÜs
.
jošts
 = 
nuÎ_jošts
;

639 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i)

640 
nuÎ_£nsÜs
.
£nsÜs
[
i
] = 0.0f;

641 
i
 = 0; i < 3; ++i) {

642 
sh¬ed_d©a
->
£nsÜs
[
i
] = 
nuÎ_£nsÜs
;

643 
sh¬ed_d©a
->
jošts
[
i
] = 
nuÎ_jošts
;

644 
sh¬ed_d©a
->
Ëds
[
i
] = 
nuÎ_Ëds
;

645 
sh¬ed_d©a
->
sÚ¬
[
i
] = 
SÚ¬
::
Mode
::
NO_PING
;

647 
sh¬ed_d©a
->
¡ªdšg
 = 
çl£
;

650 
£m­hÜe
 = 
	`£m_İ’
(
AGENT_SEMAPHORE
, 
O_RDWR
 | 
O_CREAT
, 0600, 0);

651 ià(
£m­hÜe
 < 0)

652 
throw
 
	`ALERROR
(
Çme
, "constructor", "sem_open() failed");

655 
¡d
::
veùÜ
<¡d::
¡ršg
> 
key_Çmes
;

656 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i)

657 
£nsÜ_poš‹rs
.
	`push_back
((*è
memÜy
->
	`g‘D©aPŒ
(

658 
¡d
::
	`¡ršg
("Device/SubDeviceList/") +

659 
S’sÜs
::
£nsÜNames
[
i
] + "/Sensor/Value"));

660 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i) {

661 
jošt_poš‹rs
.
	`push_back
((*è
memÜy
->
	`g‘D©aPŒ
(

662 
¡d
::
	`¡ršg
("Device/SubDeviceList/") +

663 
Jošts
::
joštNames
[
i
] +

665 
‹m³¿tu»_poš‹rs
.
	`push_back
((*è
memÜy
->
	`g‘D©aPŒ
(

666 
¡d
::
	`¡ršg
("Device/SubDeviceList/") +

667 
Jošts
::
joštNames
[
i
] +

669 
cu¼’t_poš‹rs
.
	`push_back
((*è
memÜy
->
	`g‘D©aPŒ
(

670 
¡d
::
	`¡ršg
("Device/SubDeviceList/") +

671 
Jošts
::
joštNames
[
i
] +

674 
i
 = 0; i < 
SÚ¬
::
NUMBER_OF_READINGS
; ++i){

676 
sÚ¬_poš‹rs
.
	`push_back
((*è
memÜy
->
	`g‘D©aPŒ
(

677 
¡d
::
	`¡ršg
("Device/SubDeviceList/") +

678 
SÚ¬
::
»adšgNames
[
i
]));

682 
b©‹ry_¡©us_poš‹r
 = (*è
memÜy
->

683 
	`g‘D©aPŒ
("Device/SubDeviceList/Battery/Charge/Sensor/Status");

685 
log
->
	`šfo
(
Çme
, "Constructed memory…ointers");

688 
ALV®ue
 
®Ÿs
;

689 
®Ÿs
.
	`¬¿yS‘Size
(2);

690 
®Ÿs
[0] = 
	`¡ršg
("JointAngles");

691 
®Ÿs
[1].
	`¬¿yS‘Size
(
Jošts
::
NUMBER_OF_JOINTS
 - 2);

692 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

693 
®Ÿs
[1][
i
 - 2] = 
	`¡ršg
(
Jošts
::
joštNames
[i]).

694 
	`­³nd
("/Position/Actuator/Value");

696 
dcm
->
	`ü—‹AlŸs
(
®Ÿs
);

697 
®Ÿs
[0] = 
	`¡ršg
("HeadAngles");

698 
®Ÿs
[1].
	`¬¿yS‘Size
(2);

699 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

700 
®Ÿs
[1][
i
] = 
	`¡ršg
(
Jošts
::
joštNames
[i]).

701 
	`­³nd
("/Position/Actuator/Value");

703 
dcm
->
	`ü—‹AlŸs
(
®Ÿs
);

704 
®Ÿs
[0] = 
	`¡ršg
("LEDs");

705 
®Ÿs
[1].
	`¬¿yS‘Size
(
LEDs
::
NUMBER_OF_LEDS
);

706 
i
 = 0; i < 
LEDs
::
NUMBER_OF_LEDS
; ++i) {

707 
®Ÿs
[1][
i
] = 
	`¡ršg
(
LEDs
::
ËdNames
[i]);

709 
dcm
->
	`ü—‹AlŸs
(
®Ÿs
);

710 
®Ÿs
[0] = 
	`¡ršg
("JointStiffnesses");

711 
®Ÿs
[1].
	`¬¿yS‘Size
(
Jošts
::
NUMBER_OF_JOINTS
 - 2);

712 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

713 
®Ÿs
[1][
i
 - 2] = 
	`¡ršg
(
Jošts
::
joštNames
[i]).

714 
	`­³nd
("/Hardness/Actuator/Value");

716 
dcm
->
	`ü—‹AlŸs
(
®Ÿs
);

717 
®Ÿs
[0] = 
	`¡ršg
("HeadStiffnesses");

718 
®Ÿs
[1].
	`¬¿yS‘Size
(2);

719 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

720 
®Ÿs
[1][
i
] = 
	`¡ršg
(
Jošts
::
joštNames
[i]).

721 
	`­³nd
("/Hardness/Actuator/Value");

723 
dcm
->
	`ü—‹AlŸs
(
®Ÿs
);

724 
®Ÿs
[0] = 
	`¡ršg
("Sonar");

725 
®Ÿs
[1].
	`¬¿yS‘Size
(1);

726 
®Ÿs
[1][0] = 
SÚ¬
::
aùu©ÜName
;

727 
dcm
->
	`ü—‹AlŸs
(
®Ÿs
);

730 
ªgË_commªd
.
	`¬¿yS‘Size
(6);

731 
ªgË_commªd
[0] = 
	`¡ršg
("JointAngles");

732 
ªgË_commªd
[1] = 
	`¡ršg
("ClearAfter");

733 
ªgË_commªd
[2] = 
	`¡ršg
("time-separate");

734 
ªgË_commªd
[3] = 0;

735 
ªgË_commªd
[4].
	`¬¿yS‘Size
(1);

736 
ªgË_commªd
[5].
	`¬¿yS‘Size
(
Jošts
::
NUMBER_OF_JOINTS
 - 2);

737 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

738 
ªgË_commªd
[5][
i
 - 2].
	`¬¿yS‘Size
(1);

740 
h—d_ªgË_commªd
.
	`¬¿yS‘Size
(6);

741 
h—d_ªgË_commªd
[0] = 
	`¡ršg
("HeadAngles");

742 
h—d_ªgË_commªd
[1] = 
	`¡ršg
("ClearAfter");

743 
h—d_ªgË_commªd
[2] = 
	`¡ršg
("time-separate");

744 
h—d_ªgË_commªd
[3] = 0;

745 
h—d_ªgË_commªd
[4].
	`¬¿yS‘Size
(1);

746 
h—d_ªgË_commªd
[5].
	`¬¿yS‘Size
(2);

747 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

748 
h—d_ªgË_commªd
[5][
i
].
	`¬¿yS‘Size
(1);

750 
Ëd_commªd
.
	`¬¿yS‘Size
(6);

751 
Ëd_commªd
[0] = 
	`¡ršg
("LEDs");

752 
Ëd_commªd
[1] = 
	`¡ršg
("ClearAfter");

753 
Ëd_commªd
[2] = 
	`¡ršg
("time-separate");

754 
Ëd_commªd
[3] = 0;

755 
Ëd_commªd
[4].
	`¬¿yS‘Size
(1);

756 
Ëd_commªd
[5].
	`¬¿yS‘Size
(
LEDs
::
NUMBER_OF_LEDS
);

757 
i
 = 0; i < 
LEDs
::
NUMBER_OF_LEDS
; ++i) {

758 
Ëd_commªd
[5][
i
].
	`¬¿yS‘Size
(1);

760 
¡ifâess_commªd
.
	`¬¿yS‘Size
(6);

761 
¡ifâess_commªd
[0] = 
	`¡ršg
("JointStiffnesses");

762 
¡ifâess_commªd
[1] = 
	`¡ršg
("ClearAfter");

763 
¡ifâess_commªd
[2] = 
	`¡ršg
("time-separate");

764 
¡ifâess_commªd
[3] = 0;

765 
¡ifâess_commªd
[4].
	`¬¿yS‘Size
(1);

766 
¡ifâess_commªd
[5].
	`¬¿yS‘Size
(
Jošts
::
NUMBER_OF_JOINTS
 - 2);

767 
i
 = 
Jošts
::
LShould”P™ch
; i < Jošts::
NUMBER_OF_JOINTS
; ++i) {

768 
¡ifâess_commªd
[5][
i
 - 2].
	`¬¿yS‘Size
(1);

770 
h—d_¡ifâess_commªd
.
	`¬¿yS‘Size
(6);

771 
h—d_¡ifâess_commªd
[0] = 
	`¡ršg
("HeadStiffnesses");

772 
h—d_¡ifâess_commªd
[1] = 
	`¡ršg
("ClearAfter");

773 
h—d_¡ifâess_commªd
[2] = 
	`¡ršg
("time-separate");

774 
h—d_¡ifâess_commªd
[3] = 0;

775 
h—d_¡ifâess_commªd
[4].
	`¬¿yS‘Size
(1);

776 
h—d_¡ifâess_commªd
[5].
	`¬¿yS‘Size
(2);

777 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

778 
h—d_¡ifâess_commªd
[5][
i
].
	`¬¿yS‘Size
(1);

780 
sÚ¬_commªd
.
	`¬¿yS‘Size
(6);

781 
sÚ¬_commªd
[0] = 
	`¡ršg
("Sonar");

782 
sÚ¬_commªd
[1] = 
	`¡ršg
("ClearAfter");

783 
sÚ¬_commªd
[2] = 
	`¡ršg
("time-separate");

784 
sÚ¬_commªd
[3] = 0;

785 
sÚ¬_commªd
[4].
	`¬¿yS‘Size
(1);

786 
sÚ¬_commªd
[5].
	`¬¿yS‘Size
(1);

787 
sÚ¬_commªd
[5][0].
	`¬¿yS‘Size
(1);

790 
time_off£t
 = ()
dcm
->
	`g‘Time
(0è- 
	`timeNow
();

793 
dcm
->
	`g‘G’”icProxy
()->
	`g‘ModuË
()->
	`©Po¡Proûss
(
boo¡
::
	`bšd
(
po¡C®lback_
, 
this
));

794 
dcm
->
	`g‘G’”icProxy
()->
	`g‘ModuË
()->
	`©P»Proûss
(
boo¡
::
	`bšd
(
´eC®lback_
, 
this
));

796 
log
->
	`šfo
(
Çme
, "Setup callbacks");

798 
»t
 = 
	`sy¡em
("/usr/bin/amixer -qs < /home/nao/data/volumeinfo.dat");

801 
»t
 = 
	`sy¡em
("sudo ifconfig wlan0‚etmask 255.255.0.0");

817 
log
->
	`šfo
(
Çme
, "Constructed");

818 
	}
}

820 
	gAg’t
::~
	$Ag’t
() {

821 
log
->
	`šfo
(
Çme
, "Destroying");

822 
sÚ¬
->
	`unsubsüibe
("dcm");

823 
shu‰šgDown
 = 
Œue
;

824 
»t
 = 
	`sy¡em
("sudo /usr/bin/killall„unswift");

825 ià(
sh¬ed_d©a
 !ğ
MAP_FAILED
è
	`munm­
(sh¬ed_d©a, (
Ag’tD©a
));

826 ià(
sh¬ed_fd
 >ğ0è
	`şo£
(shared_fd);

827 ià(
£m­hÜe
 !ğ
SEM_FAILED
è
	`£m_şo£
(semaphore);

828 
d–‘e
 
dcm
;

829 
d–‘e
 
memÜy
;

830 
d–‘e
 
¥“ch
;

831 
log
->
	`šfo
(
Çme
, "Destroyed");

832 
d–‘e
 
log
;

833 
	}
}

835 "C" 
_ü—‹ModuË
(
boo¡
::
sh¬ed_±r
<
AL
::
ALBrok”
> 
pBrok”
) {

836 
AL
::
ALModuË
::
ü—‹ModuË
<
Ag’t
>(
pBrok”
, "Agent");

	@robot/libagent/libagent.hpp

27 #´agm¨
Úû


29 
	~<£m­hÜe.h
>

30 
	~<b™£t
>

31 
	~<¡ršg
>

32 
	~<veùÜ
>

33 
	~<¡ack
>

34 
	~<boo¡/sh¬ed_±r.hµ
>

35 
	~"®commÚ/®brok”.h
"

36 
	~"®commÚ/®´oxy.h
"

37 
	~"®´ox›s/®logg”´oxy.h
"

38 
	~"®´ox›s/®memÜy´oxy.h
"

39 
	~"®´ox›s/®sÚ¬´oxy.h
"

40 
	~"®´ox›s/®‹x‰o¥“ch´oxy.h
"

41 
	~"®commÚ/®moduË.h
"

42 
	~"®v®ue/®v®ue.h
"

43 
	~"®´ox›s/dcm´oxy.h
"

44 
	~"libag’t/Ag’tD©a.hµ
"

45 
	~"uts/ªgËs.hµ
"

46 
	~"uts/body.hµ
"

47 
	~"uts/İtiÚs.hµ
"

48 
	~"uts/Tim”.hµ
"

50 
Çme¥aû
 
	gAL
 {

51 
şass
 
	gALBrok”
;

54 
	#MAX_SKIPS
 50

	)

55 
	#MAX_CLICK_INTERVAL
 18

	)

58 
	#HEAD_FRONT
 1

	)

59 
	#HEAD_MIDDLE
 2

	)

60 
	#HEAD_BACK
 3

	)

62 cÚ¡ 
	gs™_ªgËs
[
Jošts
::
NUMBER_OF_JOINTS
] = {

66 
DEG2RAD
(65),

67 
DEG2RAD
(10),

68 
DEG2RAD
(-120),

69 
DEG2RAD
(-25),

70 
DEG2RAD
(15),

73 
DEG2RAD
(0),

74 
DEG2RAD
(0),

75 
DEG2RAD
(-50),

76 
DEG2RAD
(125),

77 
DEG2RAD
(-70),

80 
DEG2RAD
(0),

81 
DEG2RAD
(-50),

82 
DEG2RAD
(125),

83 
DEG2RAD
(-70),

86 
DEG2RAD
(65),

87 
DEG2RAD
(-10),

88 
DEG2RAD
(120),

89 
DEG2RAD
(25),

90 
DEG2RAD
(-15),

100 
	#AGENT_VERSION_MAJOR
 "0"

	)

101 
	#AGENT_VERSION_MINOR
 "0"

	)

102 şas 
	cAg’t
 : 
public
 
AL
::
ALModuË
 {

103 
public
:

104 
Ag’t
(
boo¡
::
sh¬ed_±r
<
AL
::
ALBrok”
> 
pBrok”
, cÚ¡ 
¡d
::
¡ršg
& 
pName
);

105 
	mvœtu®
 ~
Ag’t
();

106 cÚ¡ 
	m¡d
::
¡ršg
 
Çme
;

107 
´eC®lback
();

108 
po¡C®lback
();

109 
doLEDs
(
AùiÚCommªd
::
LED
& 
Ëds
);

110 
doBu‰Ús
(
boŞ
 
che¡
, boŞ 
Ëá
, boŞ 
right
);

111 
doB©‹ry
(
ch¬ge
, 
cu¼’t
, 
¡©us
);

112 
doH—dTouch
(
h—dTouchFrÚt
,

113 
h—dTouchR—r
,

114 
h—dTouchMiddË
);

115 
doTemps
();

116 
doN‘wÜkšg
();

117 
doAvahi
();

119 
	m´iv©e
:

120 
AL
::
ALLogg”Proxy
* 
log
;

123 
	mAL
::
DCMProxy
* 
dcm
;

124 
	mAL
::
ALV®ue
 
ªgË_commªd
;

125 
	mAL
::
ALV®ue
 
¡ifâess_commªd
;

126 
	mAL
::
ALV®ue
 
h—d_ªgË_commªd
;

127 
	mAL
::
ALV®ue
 
h—d_¡ifâess_commªd
;

128 
	mAL
::
ALV®ue
 
Ëd_commªd
;

129 
	mAL
::
ALV®ue
 
sÚ¬_commªd
;

130 
	mtime_off£t
;

133 
	mAL
::
ALMemÜyProxy
* 
memÜy
;

134 
	m¡d
::
veùÜ
<*> 
£nsÜ_poš‹rs
;

135 
	m¡d
::
veùÜ
<*> 
jošt_poš‹rs
;

136 
	m¡d
::
veùÜ
<*> 
‹m³¿tu»_poš‹rs
;

137 
	m¡d
::
veùÜ
<*> 
cu¼’t_poš‹rs
;

138 
	m¡d
::
veùÜ
<*> 
sÚ¬_poš‹rs
;

139 * 
	mb©‹ry_¡©us_poš‹r
;

142 
	mAL
::
ALSÚ¬Proxy
* 
sÚ¬
;

144 
	m¡d
::
veùÜ
<
¡d
::
¡ršg
> 
Ëg_Çmes
;

145 
	m¡d
::
veùÜ
<> 
¡ªd_ªgËs
;

148 
	mAL
::
ALTextToS³echProxy
* 
¥“ch
;

149 
Tim”
 
	m§yTim”
;

152 
boŞ
 
	mshu‰šgDown
;

153 
	msh¬ed_fd
;

154 
Ag’tD©a
* 
	msh¬ed_d©a
;

155 
£m_t
* 
	m£m­hÜe
;

158 
	msk³d_äames
;

159 
	ms™_¡•
;

160 
JoštV®ues
 
	ms™_jošts
;

161 
boŞ
 
	mlimp
;

162 
boŞ
 
	mh—d_limp
;

166 
	mche¡_down
;

167 
	mche¡_up
;

168 
Bu‰ÚP»s£s
 
	mbu‰Ús
;

170 
	mche¡_´es£s
;

173 
	m¡d
::
¡ack
<> 
h—d_´ess_¡ack
;

174 
	mÏ¡_´ess_time
;

177 
	mŞd_b©‹ry
;

178 
	m¡d
::
b™£t
<16> 
Şd_b©‹ry_¡©us
;

181 
	mboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
vm
;

182 
	m¡d
::
¡ršg
 
wœ–essIwcÚfigArgs
;

183 
boŞ
 
	mwœ–essStic
;

184 
	m¡d
::
¡ršg
 
wœ–essIfcÚfigArgs
;

185 
boŞ
 
	mwœedStic
;

186 
	m¡d
::
¡ršg
 
wœedIfcÚfigArgs
;

188 
	m‹amNum
;

189 
	m¶ay”Num
;

	@robot/main.cpp

32 
	~<PythÚ.h
>

34 
	~<boo¡/´og¿m_İtiÚs.hµ
>

35 
	~<sigÇl.h
>

36 
	~<”ºo.h
>

37 
	~<fú.h
>

38 
	~<veùÜ
>

39 
	~<m­
>

40 
	~<io¡»am
>

41 
	~<¡ršg
>

42 
	~<sys/fe.h
>

44 
	~"socûr.hµ
"

46 
	~"uts/NaoV”siÚ.hµ
"

47 
	~"uts/Logg”.hµ
"

48 
	~"uts/İtiÚs.hµ
"

50 
	~"³rû±iÚ/behaviour/pythÚ/Regi¡”CÚv”‹rs.hµ
"

52 
	~"th»ad/Th»adMªag”.hµ
"

53 
	~"mÙiÚ/MÙiÚAd­‹r.hµ
"

54 
	~"Œªsm™‹r/OffNao.hµ
"

55 
	~"Œªsm™‹r/T—m.hµ
"

56 
	~"»ûiv”/T—m.hµ
"

57 
	~"»ûiv”/RemÙeCÚŒŞ.hµ
"

58 
	~"gamecÚŒŞËr/GameCÚŒŞËr.hµ
"

59 
	~"³rû±iÚ/P”û±iÚTh»ad.hµ
"

60 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

61 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”a.hµ
"

62 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”aV4.hµ
"

63 
	~"³rû±iÚ/visiÚ/ÿm”a/CombšedCam”a.hµ
"

66 
	~"ty³s/B®lInfo.hµ
"

68 
	#hªdË_”rÜ_’
(
’
, 
msg
) \

70 
”ºo
 = 
’
; \

71 
	`³¼Ü
(
msg
); \

72 
	`ex™
(1); \

73 } 0)

	)

75 
Çme¥aû
 
	gpo
 = 
boo¡
::
´og¿m_İtiÚs
;

76 
usšg
 
Çme¥aû
 
	g¡d
;

77 
usšg
 
Çme¥aû
 
	gboo¡
;

79 
¡ršg
 
g™_v”siÚ
;

87 *
	$shutdownTim”
(* 
¬g
) {

88 
time
 = ()
¬g
;

89 ià(
time
 > 5) {

90 
	`¦“p
(
time
 - 5);

91 
	`SAY
("shutting down");

92 
	`¦“p
(5);

94 
	`¦“p
(
time
);

96 
©‹m±šgShutdown
 = 
Œue
;

97  
NULL
;

98 
	}
}

101 
	$maš
(
¬gc
, **
¬gv
) {

104 
pid_fe
 = 
	`İ’
("/v¬/vŞ©e/runswiá.pid", 
O_CREAT
 | 
O_RDWR
, 0666);

105 
rc
 = 
	`æock
(
pid_fe
, 
LOCK_EX
 | 
LOCK_NB
);

106 ià(
rc
) {

107 ià(
EWOULDBLOCK
 =ğ
”ºo
) {

109 
¡d
::
û¼
 << "AnÙh”„unswiá i ®»ady„uÂšg!" << std::
’dl
;

110 
	`ex™
(1);

117 
po
::
v¬ŸbËs_m­
 
vm
;

118 
Œy
 {

119 
po
::
İtiÚs_desütiÚ
 
	`g’”ic
("Generic options");

120 
g’”ic
.
	`add_İtiÚs
()

124 
po
::
İtiÚs_desütiÚ
 
cmdlše_İtiÚs
 =

125 
	`¡Üe_ªd_nÙify
(
¬gc
, 
¬gv
, 
vm
, &
g’”ic
);

127 ià(
vm
.
	`couÁ
("help")) {

128 
cout
 << 
cmdlše_İtiÚs
 << 
’dl
;

132 ià(
vm
.
	`couÁ
("version")) {

133 
cout
 << "rUNSWiá NaØsocû¸¶ay” " << 
g™_v”siÚ
 << 
’dl
;

137 
cout
 << "rUNSWiá V." << 
g™_v”siÚ
 << 
’dl
;

139 
	`İtiÚs_´št
(
vm
);

140 } 
	`ÿtch
 (
´og¿m_İtiÚs
::
”rÜ
& 
e
) {

141 
û¼
 << "E¼Ü wh’…¬sšg commªd†š¬gum’ts: " << 
e
.
	`wh©
(è<< 
’dl
;

143 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

144 
û¼
 << 
e
.
	`wh©
(è<< 
’dl
;

148 
offNao
 = 
çl£
;

149 
©‹m±šgShutdown
 = 
çl£
;

150 
Th»ad
::
Çme
 = "main";

153 
time_t
 
s_sšû_•och
 = 
	`time
(
NULL
);

154 cÚ¡ 
tm
 *
now
 = 
	`loÿÉime
(&
s_sšû_•och
);

155 
time¡r
[20];

156 
	`¡ráime
(
time¡r
, 20, "%Y-%m-%d-%H-%M-%S", 
now
);

158 
Logg”
::
	`š™
(
vm
["debug.log·th"].
as
<
¡ršg
>(è+ 
	`¡ršg
("/"è+ sŒšg(
time¡r
),

159 
vm
["debug.log"].
as
<
¡ršg
>(),

160 
vm
["debug.log.mÙiÚ"].
as
<
boŞ
>());

165 
	`d‘”mšeNaoV”siÚ
();

168 
BÏckbßrd
 *
bÏckbßrd
 = 
Ãw
 
	`BÏckbßrd
(
vm
);

170 
Cam”a
 *
tİCam”a
 = 
NULL
;

171 
Cam”a
 *
bÙCam”a
 = 
NULL
;

172 ià(
vm
["debug.visiÚ"].
as
<
boŞ
>()) {

173 
	`Îog
(
INFO
è<< "In™Ÿlisšg v4 /dev/video0" << 
¡d
::
’dl
;

174 
tİCam”a
 = 
Ãw
 
	`NaoCam”aV4
(
bÏckbßrd
, "/dev/video0", "camera.top");

176 
	`Îog
(
INFO
è<< "In™Ÿlisšg v4 /dev/video1" << 
¡d
::
’dl
;

177 
bÙCam”a
 = 
Ãw
 
	`NaoCam”aV4
(
bÏckbßrd
, "/dev/video1", "camera.bot",

178 
IO_METHOD_MMAP
,

179 
AL
::
kVGA
);

181 
CombšedCam”a
::
	`£tCam”aTİ
(
tİCam”a
);

182 
CombšedCam”a
::
	`£tCam”aBÙ
(
bÙCam”a
);

185 
	`Îog
(
INFO
è<< "RUNSWIFT socû¸lib¿ry spšnšg up!" << 
’dl
;

187 
	`»gi¡”SigÇlHªdËrs
();

190 
Th»adMªag”
 
	`³rû±iÚ
("Perception", 0);

191 
Th»adMªag”
 
	`mÙiÚ
("Motion", 0);

192 
Th»adMªag”
 
	`gameCÚŒŞËr
("GameController", 0);

193 
Th»adMªag”
 
	`ofâaoT¿nsm™‹r
("OffnaoTransmitter", 50000);

194 
Th»adMªag”
 
	`‹amT¿nsm™‹r
("TeamTransmitter", 200000);

195 
Th»adMªag”
 
	`‹amReûiv”
("TeamReceiver", 100000);

199 ià(
vm
["debug.³rû±iÚ"].
as
<
boŞ
>()) {

200 
³rû±iÚ
.
run
<
P”û±iÚTh»ad
>(
bÏckbßrd
);

201 
	`Îog
(
INFO
è<< "P”û±iÚ i ruÂšg" << 
’dl
;

203 ià(
vm
["debug.mÙiÚ"].
as
<
boŞ
>()) {

204 
mÙiÚ
.
run
<
MÙiÚAd­‹r
>(
bÏckbßrd
);

205 
	`Îog
(
INFO
è<< "MÙiÚ i ruÂšg" << 
’dl
;

207 ià(
vm
["debug.gamecÚŒŞËr"].
as
<
boŞ
>()) {

208 
gameCÚŒŞËr
.
run
<
GameCÚŒŞËr
>(
bÏckbßrd
);

209 
	`Îog
(
INFO
è<< "GameCÚŒŞË¸i ruÂšg" << 
’dl
;

211 ià(
vm
["debug.ofâaÙ¿nsm™‹r"].
as
<
boŞ
>()) {

212 
ofâaoT¿nsm™‹r
.
run
<
OffNaoT¿nsm™‹r
>(
bÏckbßrd
);

213 
	`Îog
(
INFO
è<< "Off-NaØT¿nsm™‹¸i ruÂšg" << 
’dl
;

215 ià(
vm
["debug.ÇÙ¿nsm™‹r"].
as
<
boŞ
>()) {

216 
‹amT¿nsm™‹r
.
run
<
T—mT¿nsm™‹r
>(
bÏckbßrd
);

217 
	`Îog
(
INFO
è<< "NaØT¿nsm™‹¸i ruÂšg" << 
’dl
;

219 ià(
vm
["debug.ÇÜeûiv”"].
as
<
boŞ
>()) {

220 
‹amReûiv”
.
run
<
T—mReûiv”
>(
bÏckbßrd
);

221 
	`Îog
(
INFO
è<< "T—m Reûiv” i ruÂšg" << 
’dl
;

230 ià(
vm
["debug.shutdowÁime"].
as
<>()) {

231 
±h»ad_t
 
tim”
;

232 
	`±h»ad_ü—‹
(&
tim”
, 
NULL
, &
shutdownTim”
,

233 (*)
vm
["debug.shutdowÁime"].
as
<>());

234 
	`Îog
(
INFO
è<< "Tim” i ruÂšg" << 
’dl
;

237 
‹amReûiv”
.
	`još
();

238 
‹amT¿nsm™‹r
.
	`još
();

239 
ofâaoT¿nsm™‹r
.
	`još
();

240 
gameCÚŒŞËr
.
	`još
();

241 
mÙiÚ
.
	`još
();

242 
³rû±iÚ
.
	`još
();

244 
d–‘e
 
bÏckbßrd
;

246 
d–‘e
 
tİCam”a
;

247 
d–‘e
 
bÙCam”a
;

250 
	}
}

	@robot/motion/IKinematics.cpp

1 
	~"IKšem©ics.hµ
"

3 
	~<cm©h
>

5 
	~<Eig’/Eig’
>

7 
usšg
 
Çme¥aû
 
	gEig’
;

9 
	$üİ
(
ªgË
)

11 
ªgË
 <ğ-
M_PI
)‡ngle += 2*M_PI;

12 
ªgË
 > 
M_PI
)‡ngle -= 2*M_PI;

14  
ªgË
;

15 
	}
}

17 
Çme¥aû
 
	gIKšem©ics


86 
NaoLegChaš
 
NaoSŞve
(cÚ¡ 
NaoFoÙT¬g‘
 &
rg‘
, 
Ëá
)

88 cÚ¡ 
	gthighL
 = 0.10000;

89 cÚ¡ 
	gshšL
 = 0.10290;

90 cÚ¡ 
	gfoÙL
 = 0.04519;

92 
NaoLegChaš
 
	gr
;

93 
	gx
, 
	gy
, 
	gz
;

102 
	gr
.
	gh
 = 
rg‘
.
yaw
;

103 ià(
	grg‘
.
	gyaw
 == 0) {

104 
x
 = 
rg‘
.x;

105 
	gy
 = 
rg‘
.
y
;

106 
	gz
 = 
rg‘
.
z
;

108 
VeùÜ3f
 
v
(
rg‘
.
x
,¬g‘.
y
,¬g‘.
z
);

109 
	gAngËAxis
<> 
¯
(-
rg‘
.
yaw
, 
VeùÜ3f
(0, 
sq¹f
(2)/2, sqrtf(2)/2));

110 
	gv
 = 
¯
 * 
v
;

111 
	gx
 = 
v
.
x
(); 
	gy
 = v.
y
(); 
	gz
 = v.
z
();

121 
	gx
 -ğ
foÙL
 * 
sšf
(
rg‘
.
p™ch
);

122 
	gy
 -ğ
foÙL
 * 
cosf
(
rg‘
.
p™ch
è* 
sšf
Ñ¬g‘.
rŞl
);

123 
	gz
 +ğ
foÙL
 * 
cosf
(
rg‘
.
p™ch
è* cosfÑ¬g‘.
rŞl
);

125 
	gr
.
	gthighRŞl
 = 
©ª2f
(
y
, -
z
);

128 cÚ¡ 
	gz_´ime
 = 
z
 / 
cosf
(
r
.
thighRŞl
);

129 cÚ¡ 
	gh
 = 
hypÙf
(
z_´ime
, 
x
);

132 cÚ¡ 
	gA
 = 
acosf
((
shšL
*shšL - 
h
*h - 
thighL
*thighL) / (-2*thighL*h));

133 cÚ¡ 
	gB
 = 
acosf
((
h
*h - 
thighL
*thighL - 
shšL
*shinL) / (-2*thighL*shinL));

134 
	gr
.
	gthighP™ch
 = 
A
 + 
asš
(
x
/
h
è+ 3*
M_PI_2
;

135 
	gr
.
	gkÃeP™ch
 = 
B
 + 
M_PI
;

138 
	gr
.
	gªkËP™ch
 = 
rg‘
.
p™ch
 - 
r
.
kÃeP™ch
 -„.
thighP™ch
;

139 
	gr
.
	gªkËRŞl
 = 
rg‘
.
rŞl
 - 
r
.
thighRŞl
;

145 
	gr
.
	gthighP™ch
 = 3*
M_PI_2
 - 
r
.
thighP™ch
;

146 
	gr
.
	gkÃeP™ch
 = - 
r
.
kÃeP™ch
;

147 
	gr
.
	gªkËP™ch
 = 1*
M_PI_2
 - 
r
.
ªkËP™ch
;

150 
	gr
.
	gh
 = 
üİ
(
r
.
h
 );

151 
	gr
.
	gthighRŞl
 = 
üİ
(
r
.
thighRŞl
 );

152 
	gr
.
	gthighP™ch
 = 
üİ
(
r
.
thighP™ch
);

153 
	gr
.
	gkÃeP™ch
 = 
üİ
(
r
.
kÃeP™ch
 );

154 
	gr
.
	gªkËRŞl
 = 
üİ
(
r
.
ªkËRŞl
 );

155 
	gr
.
	gªkËP™ch
 = 
üİ
(
r
.
ªkËP™ch
);

157  
	gr
;

160 
	g¡d
::
o¡»am
 &
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gNaoLegChaš
 &
	gchaš
)

162 
	gout
 << "chaš.h = " << 
	gchaš
.
	gh
 << 
	g¡d
::
’dl
;

163 
	gout
 << "chaš.thighRŞÈ = " << 
	gchaš
.
	gthighRŞl
 << 
	g¡d
::
’dl
;

164 
	gout
 << "chaš.thighP™ch = " << 
	gchaš
.
	gthighP™ch
 << 
	g¡d
::
’dl
;

165 
	gout
 << "chaš.kÃeP™ch = " << 
	gchaš
.
	gkÃeP™ch
 << 
	g¡d
::
’dl
;

166 
	gout
 << "chaš.ªkËRŞÈ = " << 
	gchaš
.
	gªkËRŞl
 << 
	g¡d
::
’dl
;

167 
	gout
 << "chaš.ªkËP™ch = " << 
	gchaš
.
	gªkËP™ch
 << 
	g¡d
::
’dl
;

169  
	gout
;

173 
	g¡d
::
o¡»am
 &
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gNaoFoÙT¬g‘
 &
	grg‘
)

175 
	gout
 << "x =" << 
	grg‘
.
	gx
 << 
	g¡d
::
’dl
;

176 
	gout
 << "y =" << 
	grg‘
.
	gy
 << 
	g¡d
::
’dl
;

177 
	gout
 << "z =" << 
	grg‘
.
	gz
 << 
	g¡d
::
’dl
;

178 
	gout
 << "p™ch =" << 
	grg‘
.
	gp™ch
 << 
	g¡d
::
’dl
;

179 
	gout
 << "rŞÈ =" << 
	grg‘
.
	grŞl
 << 
	g¡d
::
’dl
;

180 
	gout
 << "yaw =" << 
	grg‘
.
	gyaw
 << 
	g¡d
::
’dl
;

182  
	gout
;

	@robot/motion/IKinematics.hpp

1 #´agm¨
Úû


3 
	~<io¡»am
>

5 
Çme¥aû
 
	gIKšem©ics


7 
	sNaoLegChaš


9 
	gh
;

10 
	gthighP™ch
;

11 
	gthighRŞl
;

12 
	gkÃeP™ch
;

13 
	gªkËP™ch
;

14 
	gªkËRŞl
;

15 
ä›nd
 
	g¡d
::
o¡»am
 &
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gNaoLegChaš
 &
	gchaš
);

18 
	sNaoFoÙT¬g‘


20 
	gx
, 
	gy
, 
	gz
;

21 
	gp™ch
, 
	grŞl
, 
	gyaw
;

22 
ä›nd
 
	g¡d
::
o¡»am
 &
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gNaoFoÙT¬g‘
 &
	grg‘
);

26 
NaoLegChaš
 
NaoSŞve
(cÚ¡ 
NaoFoÙT¬g‘
 &
rg‘
, 
Ëá
 = -1.f);

28 
	g¡d
::
o¡»am
 &
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gNaoLegChaš
 &
	gchaš
);

29 
	g¡d
::
o¡»am
 &
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gNaoFoÙT¬g‘
 &
	grg‘
);

	@robot/motion/MotionAdapter.cpp

32 
	~"mÙiÚ/MÙiÚAd­‹r.hµ
"

34 
	~<boo¡/bšd.hµ
>

36 #ifdeà
SIMULATION


37 
	~"mÙiÚ/touch/SimTouch.hµ
"

38 
	~"mÙiÚ/efãùÜ/SimEfãùÜ.hµ
"

40 
	~"mÙiÚ/touch/Ag’tTouch.hµ
"

41 
	~"mÙiÚ/efãùÜ/Ag’tEfãùÜ.hµ
"

43 
	~"mÙiÚ/touch/NuÎTouch.hµ
"

44 
	~"mÙiÚ/touch/F‹»dTouch.hµ
"

45 
	~"mÙiÚ/efãùÜ/NuÎEfãùÜ.hµ
"

46 
	~"mÙiÚ/g’”©Ü/Cl³dG’”©Ü.hµ
"

47 
	~"mÙiÚ/g’”©Ü/Di¡ribu‹dG’”©Ü.hµ
"

48 
	~"bÏckbßrd/BÏckbßrd.hµ
"

49 
	~"th»ad/Th»ad.hµ
"

50 
	~"uts/Logg”.hµ
"

51 
	~"uts/body.hµ
"

52 
	~"uts/šÿ·c™©ed.hµ
"

53 
	~"ty³s/AùiÚCommªd.hµ
"

54 
	~"ty³s/JoštV®ues.hµ
"

55 
	~"ty³s/S’sÜV®ues.hµ
"

56 
	~"uts/Tim”.hµ
"

58 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

60 
	#SENSOR_LAG
 6

61 

	)

62 
usšg
 
Çme¥aû
 
	g¡d
;

64 
	$cÚ¡ruù
(
Touch
** 
touch
, 
¡d
::
¡ršg
 
Çme
) {

65 #ifdeà
SIMULATION


66 ià(
Çme
 =ğ"Sim"è*
touch
 = (
Touch
*è
Ãw
 
	`SimTouch
();

68 ià(
Çme
 =ğ"Ag’t"è*
touch
 = (
Touch
*è
Ãw
 
	`Ag’tTouch
();

70 ià(
Çme
 =ğ"NuÎ"è*
touch
 = (
Touch
*è
Ãw
 
	`NuÎTouch
();

71 ià(*
touch
 =ğ
NULL
)

72 
	`Îog
(
FATAL
è<< "MÙiÚAd­‹r: NULL " + 
Çme
 + "Touch" << 
’dl
;

73 
	}
}

75 
	$cÚ¡ruù
(
EfãùÜ
** 
efãùÜ
, 
¡d
::
¡ršg
 
Çme
) {

76 #ifdeà
SIMULATION


77 ià(
Çme
 =ğ"Sim"è*
efãùÜ
 = (
EfãùÜ
*è
Ãw
 
	`SimEfãùÜ
();

79 ià(
Çme
 =ğ"Ag’t"è*
efãùÜ
 = (
EfãùÜ
*è
Ãw
 
	`Ag’tEfãùÜ
();

81 ià(
Çme
 =ğ"NuÎ"è*
efãùÜ
 = (
EfãùÜ
*è
Ãw
 
	`NuÎEfãùÜ
();

82 ià(*
efãùÜ
 =ğ
NULL
)

83 
	`Îog
(
FATAL
è<< "MÙiÚAd­‹r: NULL " + 
Çme
 + "EfãùÜ" << 
’dl
;

84 
	}
}

89 
	gMÙiÚAd­‹r
::
	$MÙiÚAd­‹r
(
BÏckbßrd
 *
bb
)

90 : 
	`Ad­‹r
(
bb
), 
	$u±ime
(0) {

91 
	`Îog
(
INFO
è<< "CÚ¡ruùšg MÙiÚAd­‹r" << 
’dl
;

93 
£nsÜBufãr
.
	`ş—r
();

96 
touches
["NuÎ"] = (
Touch
*)(
Ãw
 
	`NuÎTouch
());

97 ià(
touches
["NuÎ"] =ğ
NULL
) {

98 
	`Îog
(
FATAL
è<< "MÙiÚAd­‹r: NULL NuÎTouch" << 
’dl
;

101 #ifdeà
SIMULATION


102 
touches
["Sim"] = (
Touch
*)(
NULL
);

104 
touches
["Ag’t"] = (
Touch
*)(
NULL
);

107 
ÇkedTouch
 = 
touches
["Null"];

108 
touch
 = (
Touch
*è
Ãw
 
	`F‹»dTouch
(
touches
["Null"]);

110 
Di¡ribu‹dG’”©Ü
 * 
g
 = 
Ãw
 
	`Di¡ribu‹dG’”©Ü
(
bb
);

111 
g
->
	`£tPÏy”S³cificG‘ups
(
	`»adFrom
(
gameCÚŒŞËr
, 
¶ay”_numb”
));

113 
g’”©Ü
 = (
G’”©Ü
*è
Ãw
 
	`Cl³dG’”©Ü
Ğ(G’”©Ü *è
g
);

115 ià(
g’”©Ü
 =ğ
NULL
) {

116 
	`Îog
(
FATAL
è<< "MÙiÚAd­‹r: NULL G’”©Ü" << 
’dl
;

119 
efãùÜs
["NuÎ"] = (
EfãùÜ
*)(
Ãw
 
	`NuÎEfãùÜ
());

120 ià(
efãùÜs
["NuÎ"] =ğ
NULL
) {

121 
	`Îog
(
FATAL
è<< "MÙiÚAd­‹r: NULL NuÎEfãùÜ" << 
’dl
;

123 #ifdeà
SIMULATION


124 
efãùÜs
["Sim"] = (
EfãùÜ
*)(
NULL
);

126 
efãùÜs
["Ag’t"] = (
EfãùÜ
*)(
NULL
);

128 
efãùÜ
 = 
efãùÜs
["Null"];

130 
	`»adO±iÚs
(
bb
->
cÚfig
);

131 
touch
->
	`»adO±iÚs
(
bb
->
cÚfig
);

137 
	`Îog
(
INFO
è<< "MÙiÚAd­©” cÚ¡ruùed" << 
¡d
::
’dl
;

138 
	}
}

143 
	gMÙiÚAd­‹r
::~
	$MÙiÚAd­‹r
() {

144 
	`Îog
(
INFO
è<< "De¡royšg MÙiÚAd­‹r" << 
’dl
;

146 
	`wr™eTo
(
th»ad
, 
cÚfigC®lbacks
[
Th»ad
::
Çme
], 
boo¡
::
funùiÚ
<(cÚ¡ boo¡::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &)>());

148 
¡d
::
m­
<¡d::
¡ršg
, 
Touch
*>::
™”©Ü
 
™
 = 
touches
.
	`begš
();

149 
™
 !ğ
touches
.
	`’d
(); it++) {

150 
d–‘e
 
™
->
£cÚd
;

153 
d–‘e
 
g’”©Ü
;

155 
¡d
::
m­
<¡d::
¡ršg
, 
EfãùÜ
*>::
™”©Ü
 
™
 = 
efãùÜs
.
	`begš
();

156 
™
 !ğ
efãùÜs
.
	`’d
(); it++) {

157 
d–‘e
 
™
->
£cÚd
;

159 
	}
}

164 
	gMÙiÚAd­‹r
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

165 
¡d
::
¡ršg
 
e
 = 
cÚfig
["mÙiÚ.efãùÜ"].
as
<string>();

166 
¡d
::
¡ršg
 
t
 = 
cÚfig
["mÙiÚ.touch"].
as
<string>();

167 
	`Îog
(
INFO
è<< "MÙiÚAd­‹¸usšgƒfãùÜ " << 
e
 << "‡ndouch " << 
t
;

171 ià(
touches
.
	`couÁ
(
t
)) {

172 ià(
touches
[
t
] =ğ
NULL
) {

173 
	`cÚ¡ruù
(&
touches
[
t
],);

175 
ÇkedTouch
 = 
touches
[
t
];

176 
touch
 = (
Touch
*è
Ãw
 
	`F‹»dTouch
(
touches
[
t
]);

181 ià(
efãùÜs
.
	`couÁ
(
e
)) {

182 ià(
efãùÜs
[
e
] =ğ
NULL
) {

183 
	`cÚ¡ruù
(&
efãùÜs
[
e
],ƒ);

185 
efãùÜ
 = 
efãùÜs
[
e
];

189 
g’”©Ü
->
	`»adO±iÚs
(
cÚfig
);

190 
	}
}

195 
	gMÙiÚAd­‹r
::
	$tick
() {

196 
Tim”
 
t
;

199 
behaviourR—dBuf
 = 
	`»adFrom
(
behaviour
, 
»adBuf
);

200 
AùiÚCommªd
::
AÎ
 
»que¡
 = 
	`»adFrom
(
behaviour
,„eque¡[
behaviourR—dBuf
]).
aùiÚs
;

203 
S’sÜV®ues
 
£nsÜs
;

204 if(
»que¡
.
body
.
aùiÚTy³
 =ğ
Body
::
MOTION_CALIBRATE
){

207 
£nsÜs
 = 
ÇkedTouch
->
	`g‘S’sÜs
(
kšem©ics
);

208 
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
] = -
	`RAD2DEG
(sensors.sensors[Sensors::InertialSensor_AngleX]);

209 
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
] = -
	`RAD2DEG
(sensors.sensors[Sensors::InertialSensor_AngleY]);

210 
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
] = -sensors.sensors[Sensors::InertialSensor_GyrX];

211 
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrY
] = -sensors.sensors[Sensors::InertialSensor_GyrY];

213 
£nsÜs
 = 
touch
->
	`g‘S’sÜs
(
kšem©ics
);

218 
S’sÜV®ues
 
£nsÜsLagged
;

219 ià(
£nsÜBufãr
.
	`size
() > 0) {

220 
£nsÜsLagged
 = 
£nsÜBufãr
.
	`back
();

222 
£nsÜsLagged
 = 
£nsÜs
;

224 
£nsÜsLagged
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
] = sensors.sensors[Sensors::InertialSensor_AngleX];

225 
£nsÜsLagged
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
] = sensors.sensors[Sensors::InertialSensor_AngleY];

226 
kšem©ics
.
	`£tS’sÜV®ues
(
£nsÜsLagged
);

227 
kšem©ics
.
·¿m‘”s
 = 
	`»adFrom
(kinematics,…arameters);

229 
kšem©ics
.
	`upd©eDHChaš
();

230 
	`wr™eTo
(
mÙiÚ
, 
po£
, 
kšem©ics
.
	`g‘Po£
());

232 
boŞ
 
¡ªdšg
 = 
touch
->
	`g‘Sndšg
();

233 
Bu‰ÚP»s£s
 
bu‰Ús
 = 
touch
->
	`g‘Bu‰Ús
();

234 
	`Îog
(
VERBOSE
) << "touch->getSensorsook "

235 << 
t
.
	`–­£d_ms
(è<< "ms" << 
¡d
::
’dl
;

236 
t
.
	`»¡¬t
();

239 ià(
¡ªdšg
) {

240 
u±ime
 = 0.0f;

242 
u±ime
 += 0.01f;

244 
	`wr™eTo
(
mÙiÚ
, 
u±ime
, uptime);

247 
£nsÜBufãr
.
	`š£¹
(£nsÜBufãr.
	`begš
(), 
£nsÜs
);

248 
	`wr™eTo
(
mÙiÚ
, 
£nsÜs
, sensors);

249 
	`wr™eTo
(
kšem©ics
, 
£nsÜsLagged
, sensorsLagged);

254 ià(
£nsÜBufãr
.
	`size
(è> 
SENSOR_LAG
) {

255 
£nsÜBufãr
.
	`pİ_back
();

259 
»que¡
.
sÚ¬
 = 
sÚ¬RecÜd”
.
	`upd©e
(
£nsÜs
.sonar);

260 
	`wr™eTo
(
mÙiÚ
, 
sÚ¬Wšdow
, 
sÚ¬RecÜd”
.sonarWindow);

262 ià(
	`isInÿ·c™©ed
(
»que¡
.
body
.
aùiÚTy³
)) {

263 
u±ime
 = 0.0f;

265 
bu‰Ús
 |ğ
	`»adFrom
(
mÙiÚ
, buttons);

266 
	`wr™eTo
(
mÙiÚ
, 
bu‰Ús
, buttons);

268 
	`Îog
(
VERBOSE
) << "writeTo /„eadFromook "

269 << 
t
.
	`–­£d_ms
(è<< "ms" << 
¡d
::
’dl
;

270 
t
.
	`»¡¬t
();

272 ià(
¡ªdšg
) {

273 
g’”©Ü
->
	`»£t
();

274 
»que¡
.
body
 = 
AùiÚCommªd
::
Body
::
INITIAL
;

275 
odom‘ry
.
	`ş—r
();

280 
AbsCoÜd
 
robÙPo£
 = 
	`»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

281 
AbsCoÜd
 
b®lAbs
 = 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

282 
AbsCoÜd
 
b®l
 = 
b®lAbs
.
	`cÚv”tToRobÙR–©iveC¬‹sŸn
(
robÙPo£
);

285 
bodyMod–
.
kšem©ics
 = &kinematics;

286 
bodyMod–
.
	`upd©e
(&
odom‘ry
, 
£nsÜs
);

289 
JoštV®ues
 
jošts
 = 
g’”©Ü
->
	`makeJošts
(&
»que¡
, &
odom‘ry
, 
£nsÜs
, 
bodyMod–
, 
b®l
.
	`x
(), b®l.
	`y
());

292 
	`wr™eTo
(
mÙiÚ
, 
com
, 
bodyMod–
.
	`g‘CoM
());

294 
	`wr™eTo
(
mÙiÚ
, 
aùive
, 
»que¡
);

297 
	`wr™eTo
(
mÙiÚ
, 
odom‘ry
, 
	`Odom‘ry
(odometry));

300 
	`wr™eTo
(
mÙiÚ
, 
³ndulumMod–
, 
bodyMod–
.
	`g‘P’dulumMod–
());

301 
	`Îog
(
VERBOSE
) << "generator->makeJointsook "

302 << 
t
.
	`–­£d_ms
(è<< "ms" << 
¡d
::
’dl
;

303 
t
.
	`»¡¬t
();

306 
efãùÜ
->
	`aùu©e
(
jošts
, 
»que¡
.
Ëds
,„eque¡.
sÚ¬
);

307 
	`Îog
(
VERBOSE
) << "effector->actuateook "

308 << 
t
.
	`–­£d_ms
(è<< "ms" << 
¡d
::
’dl
;

309 
	}
}

	@robot/motion/MotionAdapter.hpp

32 #´agm¨
Úû


34 
	~<¡ršg
>

35 
	~<m­
>

36 
	~"mÙiÚ/efãùÜ/EfãùÜ.hµ
"

37 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

38 
	~"mÙiÚ/touch/F‹»dTouch.hµ
"

39 
	~"bÏckbßrd/Ad­‹r.hµ
"

40 
	~"mÙiÚ/g’”©Ü/BodyMod–.hµ
"

41 
	~"³rû±iÚ/kšem©ics/Kšem©ics.hµ
"

42 
	~"mÙiÚ/SÚ¬RecÜd”.hµ
"

58 şas 
	cMÙiÚAd­‹r
 : 
Ad­‹r
 {

59 
public
:

61 
MÙiÚAd­‹r
(
BÏckbßrd
 *
bb
);

63 ~
MÙiÚAd­‹r
();

65 
tick
();

67 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

68 
	m´iv©e
:

69 
Odom‘ry
 
odom‘ry
;

71 
	m¡d
::
veùÜ
<
S’sÜV®ues
> 
£nsÜBufãr
;

73 
SÚ¬RecÜd”
 
	msÚ¬RecÜd”
;

75 
	mu±ime
;

77 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mTouch
*> 
	mtouches
;

78 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mEfãùÜ
*> 
	mefãùÜs
;

80 
Touch
* 
	mÇkedTouch
;

81 
Touch
* 
	mtouch
;

82 
G’”©Ü
* 
	mg’”©Ü
;

83 
EfãùÜ
* 
	mefãùÜ
;

84 
BodyMod–
 
	mbodyMod–
;

85 
Kšem©ics
 
	mkšem©ics
;

	@robot/motion/MotionOdometry.cpp

1 
	~"mÙiÚ/MÙiÚOdom‘ry.hµ
"

3 
	~"uts/body.hµ
"

4 
	~"mÙiÚ/touch/S’sÜOuut.hµ
"

6 
	#ALPHA
 0.3f

	)

7 
	#SLIP_AMOUNT
 0.005f

8 
	#PESSIMISTIC_SCALE
 0.95f

9 
	#SENSOR_LAG
 10

	)

11 
usšg
 
Çme¥aû
 
	g¡d
;

13 
	gMÙiÚOdom‘ry
::
	$MÙiÚOdom‘ry
(è: 
	$isEÇbËd
(
çl£
) {

14 
	`»£t
();

15 
	}
}

17 
Odom‘ry
 
	gMÙiÚOdom‘ry
::
	$upd©eOdom‘ry
(cÚ¡ 
S’sÜV®ues
& 
£nsÜs
, 
Odom‘ry
 
w®kChªge
) {

19 
gyroZ
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyroscİeZ
];

20 ià(
	`abs
(
gyroZ
) > 0) {

21 
isEÇbËd
 = 
Œue
;

24 
Odom‘ry
 
ÏggedW®kChªge
 = 
w®kChªgeBufãr
.
	`back
();

25 
w®kChªgeBufãr
.
	`š£¹
(w®kChªgeBufãr.
	`begš
(), 
w®kChªge
);

26 
w®kChªgeBufãr
.
	`pİ_back
();

27 ià(
isEÇbËd
) {

29 
gyroZ
 *ğ-0.01à* 
PESSIMISTIC_SCALE
;

31 
¦E¼Ü
 = 
gyroZ
 - 
ÏggedW®kChªge
.
tuº
;

32 
¦Av”age
 = 
ALPHA
*
¦E¼Ü
 + (1.f - ALPHA)*slipAverage;

35 ià(
	`çbs
(
¦Av”age
è> 
SLIP_AMOUNT
){

36 
ÏggedW®kChªge
.
tuº
 = 
gyroZ
;

39  
ÏggedW®kChªge
;

40 
	}
}

42 
	gMÙiÚOdom‘ry
::
	$»£t
() {

43 
¦Av”age
 = 0;

44 
w®kChªgeBufãr
.
	`ş—r
();

45 
w®kChªgeBufãr
.
	`size
(è< 
SENSOR_LAG
) {

46 
w®kChªgeBufãr
.
	`push_back
(
	`Odom‘ry
());

48 
	}
}

	@robot/motion/MotionOdometry.hpp

1 #´agm¨
Úû


3 
	~"ty³s/S’sÜV®ues.hµ
"

4 
	~"ty³s/Odom‘ry.hµ
"

6 şas 
	cMÙiÚOdom‘ry
 {

7 
	mpublic
:

8 
MÙiÚOdom‘ry
();

9 
Odom‘ry
 
upd©eOdom‘ry
(cÚ¡ 
S’sÜV®ues
 &
£nsÜs
, Odom‘ry 
w®kChªge
);

10 
»£t
();

12 
	m´iv©e
 :

13 
boŞ
 
isEÇbËd
;

14 
	m¦Av”age
;

15 
	m¡d
::
veùÜ
<
Odom‘ry
> 
w®kChªgeBufãr
;

	@robot/motion/SonarRecorder.cpp

1 
	~"SÚ¬RecÜd”.hµ
"

2 
	~<io¡»am
>

3 
usšg
 
Çme¥aû
 
	g¡d
;

5 
	gSÚ¬RecÜd”
::
	$SÚ¬RecÜd”
(){

7 
commªd_couÁ”
 = 0;

8 
cyşe_couÁ”
 = 0;

9 
fœ¡_ÿÎ
 = 
Œue
;

11 
commªds
.
	`ş—r
();

12 
commªds
.
	`push_back
(
SÚ¬
::
Mode
::
TLRL
);

13 
commªds
.
	`push_back
(
SÚ¬
::
Mode
::
TLRR
);

14 
commªds
.
	`push_back
(
SÚ¬
::
Mode
::
TRRR
);

15 
commªds
.
	`push_back
(
SÚ¬
::
Mode
::
TLRL
);

16 
commªds
.
	`push_back
(
SÚ¬
::
Mode
::
TRRL
);

17 
commªds
.
	`push_back
(
SÚ¬
::
Mode
::
TRRR
);

19 
¡d
::
veùÜ
<> 
Ëá
;

20 
¡d
::
veùÜ
<> 
middË
;

21 
¡d
::
veùÜ
<> 
right
;

22 
sÚ¬Wšdow
.
	`push_back
(
Ëá
);

23 
sÚ¬Wšdow
.
	`push_back
(
middË
);

24 
sÚ¬Wšdow
.
	`push_back
(
right
);

26 
	}
}

30 
	gSÚ¬RecÜd”
::
	$upd©e
(
sÚ¬
[
SÚ¬
::
NUMBER_OF_READINGS
]){

32 ià(
fœ¡_ÿÎ
){

33 
fœ¡_ÿÎ
 = 
çl£
;

34  
commªds
[
commªd_couÁ”
];

37 
cyşe_couÁ”
++;

38 ià(
cyşe_couÁ”
 =ğ
CYCLES_PER_PING
){

39 
cyşe_couÁ”
 = 0;

41  
	`´oûssUpd©e
(
sÚ¬
)+
SÚ¬
::
Mode
::
RBOTH
;

43  
SÚ¬
::
Mode
::
NO_PING
;

46 
	}
}

49 
	gSÚ¬RecÜd”
::
	$´oûssUpd©e
(
sÚ¬
[
SÚ¬
::
NUMBER_OF_READINGS
]){

51 
commªd
 = 
commªds
[
commªd_couÁ”
];

52 
¡d
::
veùÜ
<> 
Ëá
;

53 
¡d
::
veùÜ
<> 
right
;

55 
i
=
SÚ¬
::
Leá0
; i<=SÚ¬::
Leá9
; i++){

56 ià(
sÚ¬
[
i
] < 
SÚ¬
::
MAX
) {

57 if(
sÚ¬
[
i
] <ğ
SÚ¬
::
MIN
){

58 
Ëá
.
	`push_back
(
¡©ic_ÿ¡
 <>(
SÚ¬
::
MIN
*1000.f));

60 
Ëá
.
	`push_back
(
¡©ic_ÿ¡
 <>(
sÚ¬
[
i
]*1000.f));

65 
i
=
SÚ¬
::
Right0
; i<=SÚ¬::
Right9
; i++){

66 ià(
sÚ¬
[
i
] < 
SÚ¬
::
MAX
) {

67 if(
sÚ¬
[
i
] <ğ
SÚ¬
::
MIN
){

68 
right
.
	`push_back
(
¡©ic_ÿ¡
<>(
SÚ¬
::
MIN
*1000.f));

70 
right
.
	`push_back
(
¡©ic_ÿ¡
 <>(
sÚ¬
[
i
]*1000.f));

74 if(
commªd
 =ğ
SÚ¬
::
Mode
::
TLRL
 ){

76 
sÚ¬Wšdow
[
SÚ¬
::
LEFT
].
	`š£¹
(sÚ¬Wšdow[SÚ¬::LEFT].
	`’d
(), 
Ëá
.
	`begš
(),†eft.end());

77 
ËáDrİ
.
	`push_back
(()
Ëá
.
	`size
());

78 if(
ËáDrİ
.
	`size
(è> 
WINDOW_SIZE
){

79 
drİ
 = 
ËáDrİ
.
	`äÚt
();

80 
sÚ¬Wšdow
[
SÚ¬
::
LEFT
].
	`”a£
(sÚ¬Wšdow[SÚ¬::LEFT].
	`begš
(), sÚ¬Wšdow[SÚ¬::LEFT].begš()+
drİ
);

81 
ËáDrİ
.
	`pİ_äÚt
();

83 } ià(
commªd
 =ğ
SÚ¬
::
Mode
::
TRRR
 ){

85 
sÚ¬Wšdow
[
SÚ¬
::
RIGHT
].
	`š£¹
(sÚ¬Wšdow[SÚ¬::RIGHT].
	`’d
(), 
right
.
	`begš
(),„ight.end());

86 
rightDrİ
.
	`push_back
(()
right
.
	`size
());

87 if(
rightDrİ
.
	`size
(è> 
WINDOW_SIZE
){

88 
drİ
 = 
rightDrİ
.
	`äÚt
();

89 
sÚ¬Wšdow
[
SÚ¬
::
RIGHT
].
	`”a£
(sÚ¬Wšdow[SÚ¬::RIGHT].
	`begš
(), sÚ¬Wšdow[SÚ¬::RIGHT].begš()+
drİ
);

90 
rightDrİ
.
	`pİ_äÚt
();

92 } ià(
commªd
 =ğ
SÚ¬
::
Mode
::
TRRL
 ){

94 
sÚ¬Wšdow
[
SÚ¬
::
MIDDLE
].
	`š£¹
(sÚ¬Wšdow[SÚ¬::MIDDLE].
	`’d
(), 
Ëá
.
	`begš
(),†eft.end());

95 
middËDrİ
.
	`push_back
(()
Ëá
.
	`size
());

96 if(
middËDrİ
.
	`size
(è> 
WINDOW_SIZE
){

97 
drİ
 = 
middËDrİ
.
	`äÚt
();

98 
sÚ¬Wšdow
[
SÚ¬
::
MIDDLE
].
	`”a£
(sÚ¬Wšdow[SÚ¬::MIDDLE].
	`begš
(), sÚ¬Wšdow[SÚ¬::MIDDLE].begš()+
drİ
);

99 
middËDrİ
.
	`pİ_äÚt
();

101 } ià(
commªd
 =ğ
SÚ¬
::
Mode
::
TLRR
 ){

103 
sÚ¬Wšdow
[
SÚ¬
::
MIDDLE
].
	`š£¹
(sÚ¬Wšdow[SÚ¬::MIDDLE].
	`’d
(), 
right
.
	`begš
(),„ight.end());

104 
middËDrİ
.
	`push_back
(()
right
.
	`size
());

105 if(
middËDrİ
.
	`size
(è> 
WINDOW_SIZE
){

106 
drİ
 = 
middËDrİ
.
	`äÚt
();

107 
sÚ¬Wšdow
[
SÚ¬
::
MIDDLE
].
	`”a£
(sÚ¬Wšdow[SÚ¬::MIDDLE].
	`begš
(), sÚ¬Wšdow[SÚ¬::MIDDLE].begš()+
drİ
);

108 
middËDrİ
.
	`pİ_äÚt
();

113 ià(
commªd_couÁ”
 =ğ()
commªds
.
	`size
()-1) command_counter = 0;

114 
commªd_couÁ”
++;

115  
commªds
[
commªd_couÁ”
];

117 
	}
}

	@robot/motion/SonarRecorder.hpp

1 #´agm¨
Úû


3 
	~<veùÜ
>

4 
	~<li¡
>

5 
	~"uts/body.hµ
"

8 
	#WINDOW_SIZE
 4

9 
	#CYCLES_PER_PING
 10

	)

16 şas 
	cSÚ¬RecÜd”
 {

17 
	mpublic
:

19 
SÚ¬RecÜd”
();

22 
upd©e
(
sÚ¬
[
SÚ¬
::
NUMBER_OF_READINGS
]);

25 
	m¡d
::
veùÜ
< 
¡d
::veùÜ <> > 
sÚ¬Wšdow
;

28 
	m´iv©e
:

30 
boŞ
 
fœ¡_ÿÎ
;

31 
	mcommªd_couÁ”
;

32 
	mcyşe_couÁ”
;

33 
	m¡d
::
veùÜ
<> 
commªds
;

35 
	m¡d
::
li¡
<> 
ËáDrİ
;

36 
	m¡d
::
li¡
<> 
middËDrİ
;

37 
	m¡d
::
li¡
<> 
rightDrİ
;

39 
´oûssUpd©e
(
sÚ¬
[
SÚ¬
::
NUMBER_OF_READINGS
]);

	@robot/motion/effector/AgentEffector.cpp

32 
	~"mÙiÚ/efãùÜ/Ag’tEfãùÜ.hµ
"

33 
	~<sys/mmª.h
>

34 
	~<fú.h
>

35 
	~<¡dexû±
>

36 
	~"uts/Logg”.hµ
"

37 
	~"uts/¥“ch.hµ
"

42 
	gAg’tEfãùÜ
::
	$Ag’tEfãùÜ
() {

44 
sh¬ed_fd
 = 
	`shm_İ’
(
AGENT_MEMORY
, 
O_RDWR
, 0600);

45 ià(
sh¬ed_fd
 < 0) {

46 
throw
 
¡d
::
	`ruÁime_”rÜ
("AgentEffector: shm_open() failed");

49 
sh¬ed_d©a
 = (
Ag’tD©a
*è
	`mm­
(
NULL
, (AgentData),

50 
PROT_READ
 | 
PROT_WRITE
,

51 
MAP_SHARED
, 
sh¬ed_fd
, 0);

52 ià(
sh¬ed_d©a
 =ğ
MAP_FAILED
) {

53 
throw
 
¡d
::
	`ruÁime_”rÜ
("AgentEffector: mmap() failed");

56 
	`Îog
(
INFO
è<< "Ag’tEfãùÜ cÚ¡ruùed" << 
¡d
::
’dl
;

57 
	}
}

62 
	gAg’tEfãùÜ
::~
	$Ag’tEfãùÜ
() {

63 ià(
sh¬ed_d©a
 !ğ
MAP_FAILED
) {

64 
	`munm­
(
sh¬ed_d©a
, (
Ag’tD©a
));

66 ià(
sh¬ed_fd
 >= 0) {

67 
	`şo£
(
sh¬ed_fd
);

69 
	`Îog
(
INFO
è<< "Ag’tEfãùÜ de¡royed" << 
¡d
::
’dl
;

70 
	}
}

75 
	gAg’tEfãùÜ
::
	$aùu©e
(
JoštV®ues
 
jošts
, 
AùiÚCommªd
::
LED
 
Ëds
,

76 
sÚ¬
) {

77 
boŞ
 
kl_¡ªdšg
 = 
çl£
;

78 
ušt8_t
 
i
;

81 
i
 = 0; i !ğ
sh¬ed_d©a
->
aùu©Üs_Ï‹¡
 &&

82 
i
 !ğ
sh¬ed_d©a
->
aùu©Üs_»ad
; ++i) ;

83 
sh¬ed_d©a
->
Ëds
[
i
] =†eds;

84 
sh¬ed_d©a
->
jošts
[
i
] = joints;

85 
sh¬ed_d©a
->
sÚ¬
[
i
] = sonar;

86 
¡d
::
¡ršg
 
§yText
 = 
	`GET_SAYTEXT
();

87 
size
 = (
sh¬ed_d©a
->
§yTexts
[
i
]);

88 
	`¡ºıy
(
sh¬ed_d©a
->
§yTexts
[
i
], 
§yText
.
	`c_¡r
(), 
size
);

89 
sh¬ed_d©a
->
§yTexts
[
i
][
size
 - 1] = 0;

90 
sh¬ed_d©a
->
aùu©Üs_Ï‹¡
 = 
i
;

94 
sh¬ed_d©a
->
¡ªdšg
 = 
kl_¡ªdšg
;

95 ià(
kl_¡ªdšg
) {

96 
kl_¡ªdšg
 = 
çl£
;

97 
sh¬ed_d©a
->
¡ªdšg
 = 
çl£
;

99 
kl_¡ªdšg
 = 
Œue
;

101 
	}
}

	@robot/motion/effector/AgentEffector.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/efãùÜ/EfãùÜ.hµ
"

35 
	~"libag’t/Ag’tD©a.hµ
"

37 şas 
	cAg’tEfãùÜ
 : 
EfãùÜ
 {

38 
public
:

39 
ex¶ic™
 
Ag’tEfãùÜ
();

40 ~
Ag’tEfãùÜ
();

41 
aùu©e
(
JoštV®ues
 
jošts
, 
AùiÚCommªd
::
LED
 
Ëds
, 
sÚ¬
);

43 
	m´iv©e
:

44 
sh¬ed_fd
;

45 
Ag’tD©a
* 
	msh¬ed_d©a
;

	@robot/motion/effector/Effector.hpp

32 #´agm¨
Úû


34 
	~"ty³s/AùiÚCommªd.hµ
"

35 
	~"ty³s/JoštV®ues.hµ
"

40 şas 
	cEfãùÜ
 {

41 
	mpublic
:

42 
vœtu®
 ~
	$EfãùÜ
() {}

50 
vœtu®
 
	`aùu©e
(
JoštV®ues
 
jošts
, 
AùiÚCommªd
::
LED
 
Ëds
,

51 
sÚ¬
) = 0;

52 
	}
};

	@robot/motion/effector/NullEffector.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/efãùÜ/EfãùÜ.hµ
"

36 şas 
	cNuÎEfãùÜ
 : 
EfãùÜ
 {

37 
public
:

38 
	$aùu©e
(
JoštV®ues
 
jošts
, 
AùiÚCommªd
::
LED
 
Ëds
, 
sÚ¬
) {}

39 
	}
};

	@robot/motion/effector/SimEffector.cpp

1 
	~"O¿şe.h
"

2 
	~"uts/Logg”.hµ
"

3 
	~"mÙiÚ/efãùÜ/SimEfãùÜ.hµ
"

5 
usšg
 
Çme¥aû
 
	g¡d
;

7 
	gSimEfãùÜ
::
	$SimEfãùÜ
() {

8 
	`Îog
(
INFO
è<< "Sim EfãùÜ in™Ÿli£d" << 
’dl
;

9 
	}
}

11 
	gSimEfãùÜ
::~
	$SimEfãùÜ
() {

12 
	`Îog
(
INFO
è<< "Sim EfãùÜ de¡royed" << 
’dl
;

13 
	}
}

15 
	gSimEfãùÜ
::
	$aùu©e
(
JoštV®ues
 
jošts
, 
AùiÚCommªd
::
LED
 
Ëds
,

16 
sÚ¬
) {

17 
Üaşe
->
	`£tJoštAngËs
(
jošts
);

18 
	}
}

	@robot/motion/effector/SimEffector.hpp

1 #´agm¨
Úû


3 
	~"mÙiÚ/efãùÜ/EfãùÜ.hµ
"

5 şas 
	cSimEfãùÜ
 : 
EfãùÜ
 {

6 
public
:

7 
ex¶ic™
 
SimEfãùÜ
();

8 ~
SimEfãùÜ
();

10 
aùu©e
(
JoštV®ues
 
jošts
, 
AùiÚCommªd
::
LED
 
Ëds
, 
sÚ¬
);

	@robot/motion/generator/Action.hpp

1 #´agm¨
Úû


3 
	sAùiÚ
 {

5 
	mªkËRÙ©iÚL
;

6 
	mªkËRÙ©iÚR
;

8 
	mfÜw¬dR
, 
	mfÜw¬dL
, 
	mtuº
, 
	mËá
;

	@robot/motion/generator/ActionGenerator.cpp

32 
	~<f¡»am
>

33 
	~<lim™s
>

34 
	~<cùy³
>

35 
	~"mÙiÚ/g’”©Ü/AùiÚG’”©Ü.hµ
"

36 
	~"uts/Logg”.hµ
"

37 
	~"uts/ªgËs.hµ
"

39 
usšg
 
Çme¥aû
 
	g¡d
;

40 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

42 
	gAùiÚG’”©Ü
::
	$AùiÚG’”©Ü
(
¡d
::
¡ršg
 
f’ame
è: 
	$fe_Çme
(
f’ame
) {

43 
max_™”
 = 0;

44 
cu¼’t_time
 = 
NOT_RUNNING
;

45 
	}
};

47 
	gAùiÚG’”©Ü
::~
	$AùiÚG’”©Ü
() {

48 
	`Îog
(
INFO
è<< "AùiÚG’”©Ü de¡royed" << 
¡d
::
’dl
;

49 
	}
};

51 
boŞ
 
	gAùiÚG’”©Ü
::
	$isAùive
() {

52  
cu¼’t_time
 !ğ
NOT_RUNNING
;

53 
	}
};

55 
	gAùiÚG’”©Ü
::
	$»£t
() {

56 
cu¼’t_time
 = 0;

57 
	}
}

59 
	gAùiÚG’”©Ü
::
	$¡İ
(){

60 
	}
}

62 
JoštV®ues
 
AùiÚG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

63 
Odom‘ry
* 
odom‘ry
,

64 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

65 
BodyMod–
 &
bodyMod–
,

66 
b®lX
,

67 
b®lY
) {

68 
JoštV®ues
 
j
;

69 ià(
cu¼’t_time
 =ğ
NOT_RUNNING
) {

71 
aùive
 = 
»que¡
->
body
;

72 
j
 = 
jošts
[jošts.
	`size
() - 1];

74 
JoštV®ues
 
ÃwJošts
 = 
£nsÜs
.
jošts
;

75 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

76 
ÃwJošts
.
¡ifâes£s
[
i
] = 1.0f;

78 ià(
cu¼’t_time
 =ğ0è
	`š‹½Ş©e
(
ÃwJošts
);

79 
j
 = 
jošts
[
cu¼’t_time
++];

80 ià(
cu¼’t_time
 =ğ(sigÃd )
jošts
.
	`size
())

81 
cu¼’t_time
 = 
NOT_RUNNING
;

84  
j
;

85 
	}
};

87 
	gAùiÚG’”©Ü
::
	$š‹½Ş©e
(
JoštV®ues
 
ÃwJošt
, 
du¿tiÚ
) {

88 ià(
jošts
.
	`em±y
()) {

89 
max_™”
 = 
du¿tiÚ
 / 10;

92 
i
 = 0; i < 
max_™”
; i++) {

93 
jošts
.
	`push_back
(
ÃwJošt
);

95 
jošts
.
	`push_back
(
ÃwJošt
);

97 
šTime
 = 0;

98 
off£t
[
Jošts
::
NUMBER_OF_JOINTS
];

100 ià(
du¿tiÚ
 != 0) {

101 
šTime
 = 
du¿tiÚ
 / 10;

102 
JoštV®ues
 
cu¼’tJošt
 = 
jošts
.
	`back
();

105 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

106 
off£t
[
i
] = (
ÃwJošt
.
ªgËs
[i] - 
cu¼’tJošt
.ªgËs[i]è/ 
šTime
;

109 
i
 = 0; i < 
šTime
; i++) {

110 
JoštV®ues
 
šJošt
;

111 
j
 = 0; j < 
Jošts
::
NUMBER_OF_JOINTS
; j++) {

112 
šJošt
.
ªgËs
[
j
] = 
jošts
.
	`back
().ªgËs[j] + 
off£t
[j];

113 
šJošt
.
¡ifâes£s
[
j
] = 
ÃwJošt
.stiffnesses[j];

115 
jošts
.
	`push_back
(
šJošt
);

119 
JoštV®ues
 
fœ¡Jošt
 = 
jošts
.
	`©
(
max_™”
);

122 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

123 
off£t
[
i
] = (
fœ¡Jošt
.
ªgËs
[i] - 
ÃwJošt
.ªgËs[i]è/ 
max_™”
;

126 
jošts
[0] = 
ÃwJošt
;

127 
i
 = 1; i < 
max_™”
; i++) {

128 
j
 = 0; j < 
Jošts
::
NUMBER_OF_JOINTS
; j++) {

129 
jošts
[
i
].
ªgËs
[
j
] = jošts[˜- 1].ªgËs[j] + 
off£t
[j];

130 
jošts
[
i
].
¡ifâes£s
[
j
] = 
fœ¡Jošt
.stiffnesses[j];

135 
	}
}

137 
	gAùiÚG’”©Ü
::
	$cÚ¡ruùPo£
(
¡d
::
¡ršg
 
·th
) {

138 
if¡»am
 
	`š
(
	`¡ršg
(
·th
 + "/" + 
fe_Çme
 + ".pos").
	`c_¡r
());

139 
	`Îog
(
INFO
è<< "AùiÚG’”©Ü(" << 
fe_Çme
 << "èü—tšg" << 
’dl
;

141 ià(!
š
.
	`is_İ’
()) {

142 
	`Îog
(
FATAL
è<< "AùiÚG’”©Ü cª‚Ù o³À" << 
fe_Çme
 << 
’dl
;

144 
du¿tiÚ
 = 0;

145 
¡ifâess
 = 1.0;

146 
ªgËs
 = 0.0;

147 
	`is¥aû
(
š
.
	`³ek
())) {

148 
š
.
	`ignÜe
();

150 !
š
.
	`eof
()) {

152 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

153 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

156 
JoštV®ues
 
ÃwJošt
;

158 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

159 
	`is¥aû
(
š
.
	`³ek
())) {

160 
š
.
	`ignÜe
();

162 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'$' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

163 
¡d
::
cout
 << "You'» missšg‡ jošˆv®uš " << 
fe_Çme
 << ".pos" << std::
’dl
;

164 
	`ex™
(1);

166 
š
 >> 
ªgËs
;

169 
ÃwJošt
.
ªgËs
[
i
] = 
	`DEG2RAD
(angles);

170 
ÃwJošt
.
¡ifâes£s
[
i
] = 1.0;

174 
	`is¥aû
(
š
.
	`³ek
())) {

175 
š
.
	`ignÜe
();

177 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'$' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

178 
¡d
::
cout
 << "You'» missšg‡ du¿tiÚ iÀ" << 
fe_Çme
 << ".pos" << std::
’dl
;

179 
	`ex™
(1);

181 
š
 >> 
du¿tiÚ
;

184 
	`is¥aû
(
š
.
	`³ek
())) {

185 
š
.
	`ignÜe
();

187 
š
.
	`³ek
() == '#') {

188 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

190 
	`is¥aû
(
š
.
	`³ek
())) {

191 
š
.
	`ignÜe
();

195 ià(
š
.
	`³ek
() == '$') {

196 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '$');

197 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

198 
	`is¥aû
(
š
.
	`³ek
())) {

199 
š
.
	`ignÜe
();

201 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

202 
¡d
::
cout
 << "You'» missšg‡ stifâes v®uš " << 
fe_Çme
 << ".pos" << std::
’dl
;

203 
	`ex™
(1);

205 
š
 >> 
¡ifâess
;

206 
ÃwJošt
.
¡ifâes£s
[
i
] = 
¡ifâess
;

209 
	`is¥aû
(
š
.
	`³ek
())) {

210 
š
.
	`ignÜe
();

212 
š
.
	`³ek
() == '#') {

213 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

215 
	`is¥aû
(
š
.
	`³ek
())) {

216 
š
.
	`ignÜe
();

219 
	`š‹½Ş©e
(
ÃwJošt
, 
du¿tiÚ
);

220 
	`is¥aû
(
š
.
	`³ek
())) {

221 
š
.
	`ignÜe
();

224 
š
.
	`şo£
();

226 
	`Îog
(
INFO
è<< "AùiÚG’”©Ü(" << 
fe_Çme
 << "èü—‹d" << 
’dl
;

227 
	}
}

229 
	gAùiÚG’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

230 
¡d
::
¡ršg
 
·th
 = 
cÚfig
["mÙiÚ.·th"].
as
<std::string>();

231 
	`cÚ¡ruùPo£
(
·th
);

232 
	}
}

	@robot/motion/generator/ActionGenerator.hpp

32 #´agm¨
Úû


34 
	~<¡ršg
>

35 
	~<veùÜ
>

36 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

39 
	#NOT_RUNNING
 -1

	)

42 
	#MAX_STIFF
 1.0

	)

44 şas 
	cAùiÚG’”©Ü
 : 
G’”©Ü
 {

45 
public
:

46 
ex¶ic™
 
AùiÚG’”©Ü
(
¡d
::
¡ršg
 
f’ame
);

47 ~
AùiÚG’”©Ü
();

49 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

50 
Odom‘ry
* 
odom‘ry
,

51 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

52 
BodyMod–
 &
bodyMod–
,

53 
b®lX
,

54 
b®lY
);

55 
vœtu®
 
boŞ
 
isAùive
();

56 
»£t
();

57 
¡İ
();

58 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

60 
	m´iv©e
:

61 
cu¼’t_time
;

62 
	m¡d
::
¡ršg
 
fe_Çme
;

63 
	m¡d
::
veùÜ
<
JoštV®ues
> 
jošts
;

64 
	mAùiÚCommªd
::
Body
 
aùive
;

71 
	mmax_™”
;

84 
š‹½Ş©e
(
JoštV®ues
 
ÃwJošt
, 
du¿tiÚ
 = 0);

91 
cÚ¡ruùPo£
(
¡d
::
¡ršg
 
·th
);

	@robot/motion/generator/BodyModel.cpp

1 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

2 
	~<boo¡/num”ic/ubÏs/io.hµ
>

3 
	~<boo¡/num”ic/ubÏs/lu.hµ
>

4 
	~"BodyMod–.hµ
"

5 
	~"G’”©Ü.hµ
"

6 
	~"uts/body.hµ
"

7 
	~"uts/m©rix_h–³rs.hµ
"

9 cÚ¡ 
	gBodyMod–
::
COM_HEIGHT
 = 200;

10 cÚ¡ 
	gBodyMod–
::
MOTION_DT
 = 1 / 100.0f;

11 cÚ¡ 
	gBodyMod–
::
FOOT_LENGTH
 = 160;

12 cÚ¡ 
	gBodyMod–
::
L_RATE
 = 0.5;

14 
	gBodyMod–
::
	$BodyMod–
(è: 
	`fAccX
(0.0),

15 
	`fAccY
(0.0),

16 
	`f‹»dTÙ®P»ssu»
(0.0),

17 
	`fHighZMPF
(0.0),

18 
	`fLowZMPF
(0.0),

19 
	$fZMPL
(0.0)

21 
¡•CouÁ”
 = 0;

22 
§g™lAcûË¿tiÚ
 = 0.0;

23 
fÜw¬dR
 = 
fÜw¬dL
 = 0.0;

25 
isLeáPha£
 = 
çl£
;

26 
isOnFrÚt
 = 
çl£
;

29 
isStİ³d
 = 
çl£
;

32 
fsLä
 = 
fsLæ
 = 
fsL¼
 = 
fsL¾
 = 0.1;

33 
fsRä
 = 
fsRæ
 = 
fsR¼
 = 
fsR¾
 = 0.1;

34 
	}
}

36 
	gBodyMod–
::
	$upd©e
(
Odom‘ry
 *
odom‘ry
,

37 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
) {

39 
¡•CouÁ”
++;

41 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]; if(
fsLæ
<‹m°
ªd
 fsLfl<5.0) fsLfl =emp;

42 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]; if(
fsLæ
<‹m°
ªd
 fsLfl<5.0) fsLfl =emp;

43 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]; if(
fsLä
<‹m°
ªd
 fsLfr<5.0) fsLfr =emp;

44 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]; if(
fsL¾
<‹m°
ªd
 fsLrl<5.0) fsLrl =emp;

45 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
]; if(
fsL¼
<‹m°
ªd
 fsLrr<5.0) fsLrr =emp;

46 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]; if(
fsRæ
<‹m°
ªd
 fsRfl<5.0) fsRfl =emp;

47 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]; if(
fsRä
<‹m°
ªd
 fsRfr<5.0) fsRfr =emp;

48 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]; if(
fsR¾
<‹m°
ªd
 fsRrl<5.0) fsRrl =emp;

49 
‹mp
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]; if(
fsR¼
<‹m°
ªd
 fsRrr<5.0) fsRrr =emp;

50 
Ï¡ZMPL
 = 
ZMPL
;

51 
ZMPL
 = 0;

53 
´essu»L
 =

54 +
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]/
fsLæ


55 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]/
fsLä


56 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]/
fsL¾


57 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
]/
fsL¼
;

58 
´essu»R
 =

59 +
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]/
fsRæ


60 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]/
fsRä


61 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]/
fsR¾


62 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]/
fsR¼
;

63 
tÙ®P»ssu»
 = 
´essu»L
 + 
´essu»R
;

64 ià(
	`ABS
(
tÙ®P»ssu»
) > 0.000001f) {

65 
ZMPL
 =

66 Ğ.080 * 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]/
fsLæ


67 + .030 * 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]/
fsLä


68 + .080 * 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]/
fsL¾


69 + .030 * 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
]/
fsL¼


70 - .030 * 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]/
fsRæ


71 - .080 * 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]/
fsRä


72 - .030 * 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]/
fsR¾


73 - .080 * 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]/
fsR¼
è/ 
tÙ®P»ssu»
;

76 
isOnFrÚt
 = 
	`isOnFrÚtOfFoÙ
(
£nsÜs
);

77 
	`´oûssUpd©e
(
odom‘ry
, 
£nsÜs
);

78 
	`ob£rv©iÚUpd©e
(
odom‘ry
, 
£nsÜs
);

79 
	}
}

82 
boŞ
 
	gBodyMod–
::
	$isFoÙOnGround
(cÚ¡ 
S’sÜV®ues
 &
£nsÜs
) {

83 
ËáFrÚtL
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
];

84 
ËáFrÚtR
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
];

85 
rightFrÚtL
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
];

86 
rightFrÚtR
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
];

87 
ËáR—rL
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
];

88 
ËáR—rR
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

89 
rightR—rL
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
];

90 
rightR—rR
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
];

91 ià(
isLeáPha£
) {

92  
rightFrÚtL
 > 0.01 && 
rightFrÚtR
 > 0.01 &&

93 
rightR—rL
 > 0.01 && 
rightR—rR
 > 0.01;

95  
ËáFrÚtL
 > 0.01 && 
ËáFrÚtR
 > 0.01 &&

96 
ËáR—rL
 > 0.01 && 
ËáR—rR
 > 0.01;

97 
	}
}

99 
boŞ
 
	gBodyMod–
::
	$isOnFrÚtOfFoÙ
(cÚ¡ 
S’sÜV®ues
 &
£nsÜs
) {

100 
ËáFrÚt
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
] +

101 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
];

102 
rightFrÚt
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
] +

103 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
];

104 
ËáR—r
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
] +

105 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

106 
rightR—r
 = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
] +

107 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
];

108 ià(
isLeáPha£
) {

109  
rightFrÚt
 > 
rightR—r
;

111  
ËáFrÚt
 > 
ËáR—r
;

112 
	}
}

114 
	gBodyMod–
::
	$g‘FoÙZMP
(
boŞ
 
isLeá
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
) {

115 ià(
w®kCyşe
.
	`isDoubËSuµÜtPha£
())  0;

116 
ZMPF
 = 0;

117 
tÙ®P»ssu»
 = 0;

118 ià(
isLeá
) {

119 
tÙ®P»ssu»
 +ğ
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

120 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

121 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

122 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

124 
tÙ®P»ssu»
 +ğ
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

125 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

126 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

127 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
];

129 ià(
isLeá
) {

130 
ZMPF
 =

131 (75.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

132 + (-45.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

133 + (75.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

134 + (-45.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

136 
ZMPF
 =

137 (75.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

138 + (-45.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]

139 + (75.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

140 + (-45.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
];

142 ià(
tÙ®P»ssu»
 == 0)  0;

143 
ZMPF
 /ğ
tÙ®P»ssu»
;

144  
ZMPF
;

145 
	}
}

147 
	gBodyMod–
::
	$g‘HÜizÚlFoÙZMP
(
boŞ
 
isLeá
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
) {

148 
ZMPF
 = 0;

149 
tÙ®P»ssu»
 = 0;

150 ià(
isLeá
) {

151 
tÙ®P»ssu»
 +ğ
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

152 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

153 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

154 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

156 
tÙ®P»ssu»
 +ğ
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

157 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

158 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

159 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
];

161 ià(
isLeá
) {

162 
ZMPF
 =

163 (20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

164 + (20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

165 + (-20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

166 + (-20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

168 
ZMPF
 =

169 (-20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

170 + (-20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]

171 + (20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

172 + (20.0fè* 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
];

174 ià(
tÙ®P»ssu»
 == 0)  0;

175 
ZMPF
 /ğ
tÙ®P»ssu»
;

176  
ZMPF
;

177 
	}
}

179 
	gBodyMod–
::
	$simuÏtiÚUpd©e
(è{
	}
}

181 
BodyMod–
::
	$´oûssUpd©e
(
Odom‘ry
 *
odom‘ry
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
) {

182 
fÜw¬dL
, 
fÜw¬dR
, 
ËáL
, 
ËáR
, 
tuºLR
, 
liáL
, 
liáR
;

183 
w®kCyşe
.
	`g’”©eW®k
(
fÜw¬dL
, 
fÜw¬dR
, 
ËáL
, 
ËáR
, 
tuºLR
, 
liáL
, 
liáR
);

185 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2f
 =

186 
kšem©ics
->
	`ev®u©eDHChaš
(

187 
Kšem©ics
::
FOOT
,

188 
Kšem©ics
::
BODY
,

189 
isLeáPha£
 ? 
Kšem©ics
::
RIGHT_CHAIN
 : Kšem©ics::
LEFT_CHAIN
);

191 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2fOth”
 =

192 
kšem©ics
->
	`ev®u©eDHChaš
(

193 
Kšem©ics
::
FOOT
,

194 
Kšem©ics
::
BODY
,

195 
isLeáPha£
 ? 
Kšem©ics
::
LEFT_CHAIN
 : Kšem©ics::
RIGHT_CHAIN
);

197 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
n2f
 =

198 
kšem©ics
->
	`ev®u©eDHChaš
(

199 
Kšem©ics
::
FOOT
,

200 
Kšem©ics
::
NECK
,

201 
isLeáPha£
 ? 
Kšem©ics
::
RIGHT_CHAIN
 : Kšem©ics::
LEFT_CHAIN
);

204 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
f2w
 =

205 
kšem©ics
->
	`ü—‹FoÙToWÜldT¿nsfÜm
(

206 
isLeáPha£
 ? 
Kšem©ics
::
RIGHT_CHAIN
 : Kšem©ics::
LEFT_CHAIN
);

208 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2w
 = boo¡::num”ic::ubÏs::
	`´od
(
f2w
, 
b2f
);

209 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
n2w
 = boo¡::num”ic::ubÏs::
	`´od
(
f2w
, 
n2f
);

210 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
Üigš
 = 
vec4
<>(0, 0, 0, 1);

211 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
»suÉ
 = boo¡::num”ic::ubÏs::
	`´od
(
b2f
, 
Üigš
);

212 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
rP’d
 = boo¡::num”ic::ubÏs::
	`´od
(
b2w
, 
Üigš
);

213 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ÃckP’d
 = boo¡::num”ic::ubÏs::
	`´od
(
n2w
, 
Üigš
);

225 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
com
 = 
kšem©ics
->
	`ev®u©eMassChaš
();

226 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
comOth”
 = 
	`´od
(
b2fOth”
, 
com
);

227 
ûÁ»OfMassOth”
.
x
 = 
	`comOth”
(0, 0);

228 
ûÁ»OfMassOth”
.
y
 = 
	`comOth”
(1, 0);

229 
ûÁ»OfMassOth”
.
z
 = 
	`comOth”
(2, 0);

230 
com
 = 
	`´od
(
b2f
, com);

231 
ûÁ»OfMass
.
x
 = 
	`com
(0, 0);

232 
ûÁ»OfMass
.
y
 = 
	`com
(1, 0);

233 
ûÁ»OfMass
.
z
 = 
	`com
(2, 0);

241 
zmpFoÙOff£t
 = 0;

242 ià(!
	`g‘W®kCyşe
().
	`isDoubËSuµÜtPha£
()) {

243 
zmpFoÙOff£t
 = 
	`g‘FoÙZMP
(!
isLeáPha£
, 
£nsÜs
);

247 
³ndulumMod–
.
	`´ediùNext
(1/100.0, 
zmpFoÙOff£t
);

258 
suµÜtFoÙPos™iÚ
 = 
	`»suÉ
(0, 0);

261 
W®kCyşe
 
cu¼’tW®kCyşe
 = 
w®kCyşe
;

270 
®pha
 = 0.2;

271 
b‘a
 = 0.5;

273 
³ndulumMod–
.
x
 = (1 - 
b‘a
è*…’dulumMod–.x + (b‘aè* 
suµÜtFoÙPos™iÚ
;

274 ià(
³ndulumMod–
.
w®kCyşe
.
ËáPha£
 =ğ
cu¼’tW®kCyşe
.leftPhase) {

275 
³ndulumMod–
.
dx
 = (1 - 
®pha
è*…’dulumMod–.dx + (®phaè* (³ndulumMod–.
x
 - 
Ï¡P’dulumMod–
.x) * 100;

277 
³ndulumMod–
.
x
 = -pendulumModel.x/1.2;

279 
³ndulumMod–
.
w®kCyşe
 = 
cu¼’tW®kCyşe
;

281 
Ï¡P’dulumMod–
.
x
 = 
³ndulumMod–
.x;

282 
Ï¡P’dulumMod–
.
dx
 = 
³ndulumMod–
.dx;

301 
	}
}

303 
	gBodyMod–
::
	$ob£rv©iÚUpd©e
(
Odom‘ry
 *
odom‘ry
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
) {

313 
	}
}

	@robot/motion/generator/BodyModel.hpp

1 #´agm¨
Úû


2 
	~<io¡»am
>

3 
	~<li¡
>

4 
	~"W®kCyşe.hµ
"

5 
	~"ty³s/JoštV®ues.hµ
"

6 
	~"ty³s/Odom‘ry.hµ
"

7 
	~"ty³s/XYZ_CoÜd.hµ
"

8 
	~"³rû±iÚ/kšem©ics/Kšem©ics.hµ
"

10 
	~"P’dulumMod–.hµ
"

12 şas 
	cBodyMod–
 {

13 
	mpublic
:

14 
BodyMod–
();

15 
upd©e
(
Odom‘ry
 *
odom‘ry
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
);

17 
šlše
 
	$g‘P»ssu»L
() {

18  
´essu»L
;

21 
šlše
 
	$g‘P»ssu»R
() {

22  
´essu»R
;

23 
	}
}

25 
šlše
 
	$g‘FHighZMPF
() {

26  
fHighZMPF
;

27 
	}
}

29 
šlše
 
	$g‘FLowZMPF
() {

30  
fLowZMPF
;

31 
	}
}

33 
šlše
 
	$g‘FAccX
() {

34  
fAccX
;

35 
	}
}

37 
šlše
 
	$g‘FAccY
() {

38  
fAccY
;

39 
	}
}

41 
šlše
 
	$g‘FZMPL
() {

42  
fZMPL
;

43 
	}
}

45 
šlše
 
	$g‘La¡ZMPL
() {

46  
Ï¡ZMPL
;

47 
	}
}

49 
šlše
 
XYZ_CoÜd
 
	$g‘CoM
() {

50  
ûÁ»OfMass
;

51 
	}
}

53 
šlše
 
	$g‘Sag™lAcûË¿tiÚ
() {

54  
§g™lAcûË¿tiÚ
;

55 
	}
}

57 
šlše
 
	$g‘F‹»dTÙ®P»ssu»
() {

58  
f‹»dTÙ®P»ssu»
;

59 
	}
}

61 
šlše
 
	$£tFÜw¬dL
(
fÜw¬dL
) {

62 
this
->
fÜw¬dL
 = forwardL;

63 
	}
}

65 
šlše
 
	$£tFÜw¬dR
(
fÜw¬dR
) {

66 
this
->
fÜw¬dR
 = forwardR;

67 
	}
}

69 
šlše
 
	$£tIsB‘w“nS‹ps
(
boŞ
 
isB‘w“nS‹ps
) {

70 ià(
this
->
isB‘w“nS‹ps
 =ğ
çl£
 && isBetweenSteps) {

71 
	`upd©eS‹pF»qu’cy
();

73 
this
->
isB‘w“nS‹ps
 = isBetweenSteps;

74 
	}
}

76 
šlše
 
boŞ
 
	$g‘IsB‘w“nS‹ps
() {

77  
this
->
isB‘w“nS‹ps
;

78 
	}
}

80 
šlše
 
	$£tIsPau£d
(
boŞ
 
isPau£d
) {

81 
this
->
isPau£d
 = isPaused;

82 
	}
}

84 
šlše
 
boŞ
 
	$g‘IsPau£d
() {

85  
isPau£d
;

86 
	}
}

87 
šlše
 
	$upd©eSag™lAcûË¿tiÚ
(
¡•Size
) {

88 
§g™lAcûË¿tiÚ
 +ğ((
¡•Size
 * 0.5) - sagittalAcceleration) * .3;

89 
	}
}

91 
šlše
 
	$£tTuº
(
tuºL
, 
tuºR
) {

92 
this
->
tuºL
 =urnL;

93 
this
->
tuºR
 =urnR;

94 
	}
}

95 
šlše
 
	$upd©eS‹pF»qu’cy
() {

96 
Ï¡S‹pF»qu’cyDifã»nûs
.
	`push_back
(
¡•CouÁ”
);

97 ià(
Ï¡S‹pF»qu’cyDifã»nûs
.
	`size
() > 2) {

98 
Ï¡S‹pF»qu’cyDifã»nûs
.
	`pİ_äÚt
();

100 
¡•CouÁ”
 = 0;

101 
	}
}

102 
šlše
 
	$g‘R—lS‹pF»qu’cy
() {

103 ià(
Ï¡S‹pF»qu’cyDifã»nûs
.
	`size
() == 0) {

104  
¡•CouÁ”
;

106 
sum
 = 0;

107 
¡d
::
li¡
<>::
™”©Ü
 
™
;

108 
™
 = 
Ï¡S‹pF»qu’cyDifã»nûs
.
	`begš
();

109 
™
 !ğ
Ï¡S‹pF»qu’cyDifã»nûs
.
	`’d
(); ++it) {

110 
sum
 +ğ*
™
;

112  (
sum
 / (
Ï¡S‹pF»qu’cyDifã»nûs
.
	`size
())) * 2 / 100.0f;

113 
	}
}

114 
	$£tIsLeáPha£
(
boŞ
 
b
) {

115 
isLeáPha£
 = 
b
;

116 
	}
}

117 
	$£tW®kCyşe
(
W®kCyşe
 
w
) {

118 
this
->
w®kCyşe
 = 
w
;

119 
	}
}

121 
W®kCyşe
 
	$g‘W®kCyşe
() {

122  
w®kCyşe
;

123 
	}
}

125 
	$£tIsStİ³d
(
boŞ
 
b
) {

126 
isStİ³d
 = 
b
;

127 
	}
}

129 
boŞ
 
	$g‘IsStİ³d
() {

130  
isStİ³d
;

131 
	}
}

133 
P’dulumMod–
 
	$g‘P’dulumMod–
() {

134  
³ndulumMod–
;

135 
	}
}

137 
g‘FoÙZMP
(
boŞ
 
isLeá
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
);

138 
g‘HÜizÚlFoÙZMP
(
boŞ
 
isLeá
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
);

140 
boŞ
 
isFoÙOnGround
(cÚ¡ 
S’sÜV®ues
 &
£nsÜs
);

142 
´oûssUpd©e
(
Odom‘ry
 *
odom‘ry
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
);

143 
ob£rv©iÚUpd©e
(
Odom‘ry
 *
odom‘ry
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
);

144 
simuÏtiÚUpd©e
();

146 
Kšem©ics
 *
	gkšem©ics
;

147 
P’dulumMod–
 
	g³ndulumMod–
;

148 
P’dulumMod–
 
	gÏ¡P’dulumMod–
;

151 
boŞ
 
	gisLeáPha£
;

152 
	gÏ¡ZMPL
;

153 
	gZMPL
;

155 
	g´iv©e
:

156 
W®kCyşe
 
w®kCyşe
;

158 
boŞ
 
	gisStİ³d
;

159 
	gcu¼’täequ’cy
;

160 
	g¡•CouÁ”
;

161 
	g¡d
::
li¡
<> 
Ï¡S‹pF»qu’cyDifã»nûs
;

162 
boŞ
 
	gisB‘w“nS‹ps
;

163 
boŞ
 
	gisPau£d
;

164 
	g§g™lAcûË¿tiÚ
;

165 
	gfÜw¬dL
, 
	gfÜw¬dR
, 
	gtuºL
, 
	gtuºR
;

166 
	g´essu»L
, 
	g´essu»R
;

167 
	gfAccX
;

168 
	gfAccY
;

169 
	gf‹»dTÙ®P»ssu»
;

170 
	gZMPF
;

171 
	gfHighZMPF
;

172 
	gfLowZMPF
;

173 
	gfZMPL
;

174 
	gfsLä
, 
	gfsLæ
, 
	gfsL¼
, 
	gfsL¾
;

175 
	gfsRä
, 
	gfsRæ
, 
	gfsR¼
, 
	gfsR¾
;

177 
XYZ_CoÜd
 
	gûÁ»OfMass
;

178 
XYZ_CoÜd
 
	gûÁ»OfMassOth”
;

180 cÚ¡ 
	gCOM_HEIGHT
;

181 cÚ¡ 
	gMOTION_DT
;

182 cÚ¡ 
	gFOOT_LENGTH
;

183 cÚ¡ 
	gL_RATE
;

185 
boŞ
 
	gisOnFrÚt
;

188 
	gt
;

190 
boŞ
 
isOnFrÚtOfFoÙ
(cÚ¡ 
S’sÜV®ues
 &
£nsÜ
);

	@robot/motion/generator/ClippedGenerator.cpp

32 
	~"mÙiÚ/g’”©Ü/Cl³dG’”©Ü.hµ
"

33 
	~"libag’t/Ag’tD©a.hµ
"

34 
	~"uts/body.hµ
"

35 
	~"uts/ş.hµ
"

36 
	~"uts/Logg”.hµ
"

38 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

40 
	gCl³dG’”©Ü
::
	$Cl³dG’”©Ü
(
G’”©Ü
* 
g
)

41 : 
	`g’”©Ü
(
g
),

42 
	$Şd_exi¡s
(
çl£
) {

43 
	`Îog
(
INFO
è<< "Cl³dG’”©Ü cÚ¡ruùed" << 
¡d
::
’dl
;

44 
	}
}

46 
	gCl³dG’”©Ü
::~
	$Cl³dG’”©Ü
() {

47 
d–‘e
 
g’”©Ü
;

48 
	`Îog
(
INFO
è<< "Cl³dG’”©Ü de¡royed" << 
¡d
::
’dl
;

49 
	}
}

51 
boŞ
 
	gCl³dG’”©Ü
::
	$isAùive
() {

52  
g’”©Ü
->
	`isAùive
();

53 
	}
}

55 
	gCl³dG’”©Ü
::
	$»£t
() {

56 
g’”©Ü
->
	`»£t
();

57 
Şd_exi¡s
 = 
çl£
;

58 
	}
}

60 
	gCl³dG’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

61 
g’”©Ü
->
	`»adO±iÚs
(
cÚfig
);

62 
	}
}

64 
JoštV®ues
 
	gCl³dG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

65 
Odom‘ry
* 
odom‘ry
,

66 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

67 
BodyMod–
 &
bodyMod–
,

68 
b®lX
,

69 
b®lY
) {

70 
JoštV®ues
 
j
 = 
g’”©Ü
->
	`makeJošts
(
»que¡
, 
odom‘ry
, 
£nsÜs
, 
bodyMod–
, 
b®lX
, 
b®lY
);

71 
ušt8_t
 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i) {

73 ià(
j
.
¡ifâes£s
[
i
] >= 0.0f) {

74 
j
.
¡ifâes£s
[
i
] = 
	`CLIP
(j.stiffnesses[i], 0.0f, 1.0f);

76 
j
.
¡ifâes£s
[
i
] = -1.0f;

80 ià(!
	`i¢ª
(
j
.
ªgËs
[
i
])) {

81 
j
.
ªgËs
[
i
] = 
Jošts
::
	`lim™JoštRadŸns
(Jošts::
joštCodes
[i],

82 
j
.
ªgËs
[
i
]);

86 ià(
Şd_exi¡s
) {

87 
j
.
ªgËs
[
i
] = 
	`CLIP
(j.angles[i],

88 
Şd_j
.
ªgËs
[
i
] - 
Jošts
::
RadŸns
::
MaxS³ed
[i],

89 
Şd_j
.
ªgËs
[
i
] + 
Jošts
::
RadŸns
::
MaxS³ed
[i]);

92 
Şd_exi¡s
 = 
Œue
;

93 
Şd_j
 = 
j
;

94  
j
;

95 
	}
}

	@robot/motion/generator/ClippedGenerator.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

36 şas 
	cCl³dG’”©Ü
 : 
G’”©Ü
 {

37 
public
:

38 
ex¶ic™
 
Cl³dG’”©Ü
(
G’”©Ü
* 
g
);

39 ~
Cl³dG’”©Ü
();

40 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

41 
Odom‘ry
* 
odom‘ry
,

42 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

43 
BodyMod–
 &
bodyMod–
,

44 
b®lX
,

45 
b®lY
);

46 
vœtu®
 
boŞ
 
isAùive
();

47 
»£t
();

48 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

50 
	m´iv©e
:

51 
G’”©Ü
* 
g’”©Ü
;

52 
JoštV®ues
 
	mŞd_j
;

53 
boŞ
 
	mŞd_exi¡s
;

	@robot/motion/generator/DeadGenerator.cpp

32 
	~"mÙiÚ/g’”©Ü/D—dG’”©Ü.hµ
"

33 
	~"uts/Logg”.hµ
"

35 
	gD—dG’”©Ü
::
	$D—dG’”©Ü
(è: 
	$ticks
(0) {

36 
	`Îog
(
INFO
è<< "D—dG’”©Ü c»©ed" << 
¡d
::
’dl
;

37 
	}
}

39 
	gD—dG’”©Ü
::~
	$D—dG’”©Ü
() {

40 
	`Îog
(
INFO
è<< "D—dG’”©Ü de¡royed" << 
¡d
::
’dl
;

41 
	}
}

43 
JoštV®ues
 
	gD—dG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

44 
Odom‘ry
* 
odom‘ry
,

45 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

46 
BodyMod–
 &
bodyMod–
,

47 
b®lX
,

48 
b®lY
) {

49 ++
ticks
;

50 
JoštV®ues
 
j
 = 
£nsÜs
.
jošts
;

51 
ušt8_t
 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i)

52 
j
.
¡ifâes£s
[
i
] = -1.0f;

53  
j
;

54 
	}
}

56 
boŞ
 
	gD—dG’”©Ü
::
	$isAùive
() {

57  
ticks
 <ğ
MIN_TICKS
;

58 
	}
}

60 
	gD—dG’”©Ü
::
	$»£t
() {

61 
ticks
 = 0;

62 
	}
}

	@robot/motion/generator/DeadGenerator.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

36 
	#MIN_TICKS
 100

	)

38 şas 
	cD—dG’”©Ü
 : 
G’”©Ü
 {

39 
public
:

40 
ex¶ic™
 
D—dG’”©Ü
();

41 ~
D—dG’”©Ü
();

42 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

43 
Odom‘ry
* 
odom‘ry
,

44 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

45 
BodyMod–
 &
bodyMod–
,

46 
b®lX
,

47 
b®lY
);

48 
vœtu®
 
boŞ
 
isAùive
();

49 
»£t
();

51 
	m´iv©e
:

52 
ticks
;

	@robot/motion/generator/DistributedGenerator.cpp

32 
	~"mÙiÚ/g’”©Ü/Di¡ribu‹dG’”©Ü.hµ
"

33 
	~"mÙiÚ/g’”©Ü/AùiÚG’”©Ü.hµ
"

34 
	~"mÙiÚ/g’”©Ü/D—dG’”©Ü.hµ
"

35 
	~"mÙiÚ/g’”©Ü/H—dG’”©Ü.hµ
"

36 
	~"mÙiÚ/g’”©Ü/NuÎG’”©Ü.hµ
"

37 
	~"mÙiÚ/g’”©Ü/RefPickupG’”©Ü.hµ
"

38 
	~"mÙiÚ/g’”©Ü/SndG’”©Ü.hµ
"

39 
	~"mÙiÚ/g’”©Ü/W®kEngšeP»ProûssÜ.hµ
"

40 
	~"mÙiÚ/g’”©Ü/G‘upG’”©Ü.hµ
"

41 
	~"mÙiÚ/g’”©Ü/F®lAvoidªûG’”©Ü.hµ
"

43 
	~"uts/body.hµ
"

44 
	~"uts/Logg”.hµ
"

46 
usšg
 
	gAùiÚCommªd
::
Body
;

47 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

54 
	gDi¡ribu‹dG’”©Ü
::
	$Di¡ribu‹dG’”©Ü
(
BÏckbßrd
 *
bb
)

55 : 
	`isStİpšg
(
çl£
),

56 
	`cu¼’t_g’”©Ü
(
Body
::
NONE
),

57 
	`´ev_g’”©Ü
(
Body
::
NONE
),

58 
	$»que¡edDive
(
Body
::
NONE
) {

60 
h—dG’”©Ü
 = (
G’”©Ü
*)(
Ãw
 
	`H—dG’”©Ü
());

61 ià(!
h—dG’”©Ü
)

62 
	`Îog
(
FATAL
è<< "h—dG’”©Ü i NULL!" << 
¡d
::
’dl
;

66 
bodyG’”©Üs
[
Body
::
NONE
] = (
G’”©Ü
*)(
Ãw
 
	`NuÎG’”©Ü
());

67 ià(!
bodyG’”©Üs
[
Body
::
NONE
])

68 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[NONE] i NULL!" << 
¡d
::
’dl
;

70 
bodyG’”©Üs
[
Body
::
STAND
] = (
G’”©Ü
*)(
Ãw
 
	`SndG’”©Ü
());

71 ià(!
bodyG’”©Üs
[
Body
::
STAND
])

72 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[STAND] i NULL!" << 
¡d
::
’dl
;

74 
bodyG’”©Üs
[
Body
::
MOTION_CALIBRATE
] =

75 (
G’”©Ü
*)(
Ãw
 
	`AùiÚG’”©Ü
("standStraight"));

76 ià(!
bodyG’”©Üs
[
Body
::
MOTION_CALIBRATE
])

77 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[MOTION_CALIBRATE] i NULL!" << 
¡d
::
’dl
;

79 
bodyG’”©Üs
[
Body
::
STAND_STRAIGHT
] =

80 (
G’”©Ü
*)(
Ãw
 
	`AùiÚG’”©Ü
("standStraight"));

81 ià(!
bodyG’”©Üs
[
Body
::
STAND_STRAIGHT
])

82 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[STAND_STRAIGHT] i NULL!" << 
¡d
::
’dl
;

84 
bodyG’”©Üs
[
Body
::
WALK
] = (
G’”©Ü
*)(
Ãw
 
	`W®kEngšeP»ProûssÜ
(
bb
));

85 ià(!
bodyG’”©Üs
[
Body
::
WALK
])

86 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[WALK] i NULL!" << 
¡d
::
’dl
;

88 
bodyG’”©Üs
[
Body
::
KICK
] = bodyG’”©Üs[Body::
WALK
];

90 
bodyG’”©Üs
[
Body
::
LINE_UP
] = bodyG’”©Üs[Body::
WALK
];

92 
bodyG’”©Üs
[
Body
::
DRIBBLE
] = bodyG’”©Üs[Body::
WALK
];

94 
bodyG’”©Üs
[
Body
::
GETUP_FRONT
] = (
G’”©Ü
*)

95 (
Ãw
 
	`G‘upG’”©Ü
("getupFront"));

96 ià(!
bodyG’”©Üs
[
Body
::
GETUP_FRONT
])

97 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GETUP_FRONT] i NULL!" << 
¡d
::
’dl
;

99 
bodyG’”©Üs
[
Body
::
GETUP_BACK
] = (
G’”©Ü
*)

100 (
Ãw
 
	`G‘upG’”©Ü
("getupBack"));

101 ià(!
bodyG’”©Üs
[
Body
::
GETUP_BACK
])

102 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GETUP_BACK] i NULL!" << 
¡d
::
’dl
;

104 
bodyG’”©Üs
[
Body
::
INITIAL
] = (
G’”©Ü
*)

105 (
Ãw
 
	`AùiÚG’”©Ü
("initial"));

106 ià(!
bodyG’”©Üs
[
Body
::
INITIAL
])

107 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[INITIAL] i NULL!" << 
¡d
::
’dl
;

109 
bodyG’”©Üs
[
Body
::
DEAD
] = (
G’”©Ü
*)(
Ãw
 
	`D—dG’”©Ü
());

110 ià(!
bodyG’”©Üs
[
Body
::
DEAD
])

111 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[DEAD] i NULL!" << 
¡d
::
’dl
;

113 
bodyG’”©Üs
[
Body
::
REF_PICKUP
] = (
G’”©Ü
*)(
Ãw
 
	`RefPickupG’”©Ü
());

114 ià(!
bodyG’”©Üs
[
Body
::
REF_PICKUP
])

115 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[REF_PICKUP] i NULL!" << 
¡d
::
’dl
;

117 
bodyG’”©Üs
[
Body
::
OPEN_FEET
] = (
G’”©Ü
*)

118 (
Ãw
 
	`AùiÚG’”©Ü
("openFeet"));

119 ià(!
bodyG’”©Üs
[
Body
::
OPEN_FEET
])

120 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[OPEN_FEET] i NULL!" << 
¡d
::
’dl
;

122 
bodyG’”©Üs
[
Body
::
THROW_IN
] = (
G’”©Ü
*)

123 (
Ãw
 
	`AùiÚG’”©Ü
("throwIn"));

124 ià(!
bodyG’”©Üs
[
Body
::
THROW_IN
])

125 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[THROW_IN] i NULL!" << 
¡d
::
’dl
;

127 
bodyG’”©Üs
[
Body
::
GOALIE_SIT
] = (
G’”©Ü
*)

128 (
Ãw
 
	`AùiÚG’”©Ü
("goalieSit"));

129 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_SIT
])

130 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_SIT] i NULL!" << 
¡d
::
’dl
;

132 
bodyG’”©Üs
[
Body
::
GOALIE_DIVE_LEFT
] = (
G’”©Ü
*)

133 (
Ãw
 
	`AùiÚG’”©Ü
("goalieDiveLeft"));

134 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_DIVE_LEFT
])

135 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_DIVE_LEFT] i NULL!" << 
¡d
::
’dl
;

137 
bodyG’”©Üs
[
Body
::
GOALIE_DIVE_RIGHT
] = (
G’”©Ü
*)

138 (
Ãw
 
	`AùiÚG’”©Ü
("goalieDiveRight"));

139 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_DIVE_RIGHT
])

140 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_DIVE_RIGHT] i NULL!" << 
¡d
::
’dl
;

142 
bodyG’”©Üs
[
Body
::
GOALIE_CENTRE
] = (
G’”©Ü
*)

143 (
Ãw
 
	`AùiÚG’”©Ü
("defenderSquat"));

144 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_CENTRE
])

145 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_CENTRE] i NULL!" << 
¡d
::
’dl
;

147 
bodyG’”©Üs
[
Body
::
GOALIE_UNCENTRE
] = (
G’”©Ü
*)

148 (
Ãw
 
	`AùiÚG’”©Ü
("goalieUncentre"));

149 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_UNCENTRE
])

150 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_UNCENTRE] i NULL!" << 
¡d
::
’dl
;

152 
bodyG’”©Üs
[
Body
::
GOALIE_STAND
] = (
G’”©Ü
*)

153 (
Ãw
 
	`AùiÚG’”©Ü
("goalieStand"));

154 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_STAND
])

155 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_STAND] i NULL!" << 
¡d
::
’dl
;

157 
bodyG’”©Üs
[
Body
::
GOALIE_INITIAL
] = (
G’”©Ü
*)

158 (
Ãw
 
	`AùiÚG’”©Ü
("goalieInitial"));

159 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_INITIAL
])

160 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_INITIAL] i NULL!" << 
¡d
::
’dl
;

162 
bodyG’”©Üs
[
Body
::
GOALIE_AFTERSIT_INITIAL
] = (
G’”©Ü
*)

163 (
Ãw
 
	`AùiÚG’”©Ü
("goalieInitial"));

164 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_AFTERSIT_INITIAL
])

165 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_AFTERSIT_INITIAL] i NULL!" << 
¡d
::
’dl
;

167 
bodyG’”©Üs
[
Body
::
DEFENDER_CENTRE
] = (
G’”©Ü
*)

168 (
Ãw
 
	`AùiÚG’”©Ü
("defenderCentre"));

169 ià(!
bodyG’”©Üs
[
Body
::
DEFENDER_CENTRE
])

170 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[DEFENDER_CENTRE] i NULL!" << 
¡d
::
’dl
;

172 
bodyG’”©Üs
[
Body
::
GOALIE_PICK_UP
] = (
G’”©Ü
*)

173 (
Ãw
 
	`AùiÚG’”©Ü
("goaliePickup"));

174 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_PICK_UP
])

175 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_PICK_UP] i NULL!" << 
¡d
::
’dl
;

177 
bodyG’”©Üs
[
Body
::
GOALIE_FAST_SIT
] = (
G’”©Ü
*)

178 (
Ãw
 
	`AùiÚG’”©Ü
("goalieFastSit"));

179 ià(!
bodyG’”©Üs
[
Body
::
GOALIE_FAST_SIT
])

180 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GOALIE_FAST_SIT] i NULL!" << 
¡d
::
’dl
;

182 
	`Îog
(
INFO
è<< "Di¡ribu‹dG’”©Ü cÚ¡ruùed" << 
¡d
::
’dl
;

183 
	}
}

188 
	gDi¡ribu‹dG’”©Ü
::~
	$Di¡ribu‹dG’”©Ü
() {

189 
d–‘e
 
h—dG’”©Ü
;

190 
ušt8_t
 
i
 = 0; i < 
Body
::
NUM_ACTION_TYPES
; ++i)

191 ià(
bodyG’”©Üs
[
i
]) {

192 
d–‘e
 
bodyG’”©Üs
[
i
];

193 
ušt8_t
 
j
 = 
i
 + 1; j < 
Body
::
NUM_ACTION_TYPES
; ++j)

194 ià(
bodyG’”©Üs
[
j
] =ğbodyG’”©Üs[
i
])

195 
bodyG’”©Üs
[
j
] = 
NULL
;

197 
	`Îog
(
INFO
è<< "Di¡ribu‹dG’”©Ü de¡royed" << 
¡d
::
’dl
;

198 
	}
}

204 
JoštV®ues
 
	gDi¡ribu‹dG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

205 
Odom‘ry
* 
odom‘ry
,

206 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

207 
BodyMod–
 &
bodyMod–
,

208 
b®lX
,

209 
b®lY
) {

212 if(
»que¡edDive
 =ğ
Body
::
NONE


214 
cu¼’t_g’”©Ü
 =ğ
Body
::
GOALIE_CENTRE
 ||

215 
cu¼’t_g’”©Ü
 =ğ
Body
::
GOALIE_DIVE_LEFT
 ||

216 
cu¼’t_g’”©Ü
 =ğ
Body
::
GOALIE_DIVE_RIGHT
 ||

217 
cu¼’t_g’”©Ü
 =ğ
Body
::
DEFENDER_CENTRE


220 
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
GOALIE_CENTRE
 ||

221 
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
GOALIE_DIVE_LEFT
 ||

222 
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
GOALIE_DIVE_RIGHT
 ||

223 
cu¼’t_g’”©Ü
 =ğ
Body
::
DEFENDER_CENTRE


225 
»que¡edDive
 = 
»que¡
->
body
.
aùiÚTy³
;

228 
JoštV®ues
 
äomBody
;

229 
boŞ
 
u£sH—d
 = 
çl£
;

232 ià(
AùiÚCommªd
::
´iÜ™›s
[
»que¡
->
body
.
aùiÚTy³
] >

233 
AùiÚCommªd
::
´iÜ™›s
[
cu¼’t_g’”©Ü
]) {

234 
	`»£t
();

235 
isStİpšg
 = 
çl£
;

238 ià(!
bodyG’”©Üs
[
cu¼’t_g’”©Ü
]->
	`isAùive
()) {

239 ià(
bodyG’”©Üs
[
cu¼’t_g’”©Ü
] !ğbodyG’”©Üs[
»que¡
->
body
.
aùiÚTy³
]

240 || 
isStİpšg


241 || (
cu¼’t_g’”©Ü
 =ğ
Body
::
GETUP_FRONT
 && 
»que¡
->
body
.
aùiÚTy³
 == Body::GETUP_FRONT)

242 || (
cu¼’t_g’”©Ü
 =ğ
Body
::
GETUP_BACK
 && 
»que¡
->
body
.
aùiÚTy³
 == Body::GETUP_BACK)) {

243 
bodyG’”©Üs
[
cu¼’t_g’”©Ü
]->
	`»£t
();

246 ià(
cu¼’t_g’”©Ü
 =ğ
Body
::
GOALIE_CENTRE
 && 
»que¡
->
body
.
aùiÚTy³
 != Body::GOALIE_CENTRE) {

247 
cu¼’t_g’”©Ü
 = 
Body
::
GOALIE_UNCENTRE
;

249 
cu¼’t_g’”©Ü
 = 
»que¡
->
body
.
aùiÚTy³
;

251 
isStİpšg
 = 
çl£
;

252 } ià(
bodyG’”©Üs
[
cu¼’t_g’”©Ü
]->
	`isAùive
() &&

253 
bodyG’”©Üs
[
cu¼’t_g’”©Ü
] !=

254 
bodyG’”©Üs
[
»que¡
->
body
.
aùiÚTy³
]) {

257 ià(
cu¼’t_g’”©Ü
 !ğ
Body
::
KICK
 || 
»que¡
->
body
.
aùiÚTy³
 !ğBody::
STAND
) {

258 
bodyG’”©Üs
[
cu¼’t_g’”©Ü
]->
	`¡İ
();

259 
isStİpšg
 = 
Œue
;

264 if(
cu¼’t_g’”©Ü
 =ğ
»que¡edDive
){

265 
»que¡edDive
 = 
Body
::
NONE
;

268 
cu¼’t_g’”©Ü
) {

269 
Body
::
NONE
: 
u£sH—d
 = 
çl£
; ;

270 
Body
::
STAND
: 
u£sH—d
 = 
çl£
; ;

271 
Body
::
WALK
: 
u£sH—d
 = 
çl£
; ;

272 
Body
::
GETUP_FRONT
: 
u£sH—d
 = 
Œue
; ;

273 
Body
::
GETUP_BACK
: 
u£sH—d
 = 
Œue
; ;

274 
Body
::
INITIAL
: 
u£sH—d
 = 
Œue
; ;

275 
Body
::
KICK
: 
u£sH—d
 = 
çl£
; ;

276 
Body
::
DRIBBLE
: 
u£sH—d
 = 
çl£
; ;

277 
Body
::
DEAD
: 
u£sH—d
 = 
Œue
; ;

278 
Body
::
REF_PICKUP
: 
u£sH—d
 = 
çl£
; ;

279 
Body
::
OPEN_FEET
: 
u£sH—d
 = 
Œue
; ;

280 
Body
::
THROW_IN
: 
u£sH—d
 = 
çl£
; ;

281 
Body
::
GOALIE_SIT
: 
u£sH—d
 = 
Œue
; ;

282 
Body
::
GOALIE_FAST_SIT
: 
u£sH—d
 = 
Œue
; ;

283 
Body
::
GOALIE_DIVE_LEFT
: 
u£sH—d
 = 
Œue
; ;

284 
Body
::
GOALIE_DIVE_RIGHT
: 
u£sH—d
 = 
Œue
; ;

285 
Body
::
GOALIE_CENTRE
: 
u£sH—d
 = 
Œue
; ;

286 
Body
::
GOALIE_UNCENTRE
: 
u£sH—d
 = 
Œue
; ;

287 
Body
::
GOALIE_STAND
: 
u£sH—d
 = 
Œue
; ;

288 
Body
::
GOALIE_INITIAL
: 
u£sH—d
 = 
Œue
; ;

289 
Body
::
GOALIE_AFTERSIT_INITIAL
: 
u£sH—d
 = 
Œue
; ;

290 
Body
::
GOALIE_PICK_UP
: 
u£sH—d
 = 
Œue
; ;

291 
Body
::
DEFENDER_CENTRE
: 
u£sH—d
 = 
çl£
; ;

292 
Body
::
MOTION_CALIBRATE
: 
u£sH—d
 = 
çl£
; ;

293 
Body
::
STAND_STRAIGHT
: 
u£sH—d
 = 
çl£
; ;

294 
Body
::
LINE_UP
: 
u£sH—d
 = 
çl£
; ;

295 
Body
::
NUM_ACTION_TYPES
: 
u£sH—d
 = 
çl£
; ;

298 
tuº
 = 0;

299 
dœ
 = 0;

300 if(
cu¼’t_g’”©Ü
 =ğ
Body
::
GETUP_FRONT
){

301 
dœ
 = 1;

302 } if(
cu¼’t_g’”©Ü
 =ğ
Body
::
GETUP_BACK
){

303 
dœ
 = -1;

305 if(
´ev_g’”©Ü
 =ğ
Body
::
GOALIE_DIVE_LEFT
){

306 
tuº
 = 
	`DEG2RAD
(
dœ
*80);

307 } ià(
´ev_g’”©Ü
 =ğ
Body
::
GOALIE_DIVE_RIGHT
){

308 
tuº
 = 
	`DEG2RAD
(-
dœ
*80);

310 *
odom‘ry
 = *odom‘ry + 
	`Odom‘ry
(0, 0, 
tuº
);

313 
äomBody
 = 
bodyG’”©Üs
[
cu¼’t_g’”©Ü
]->

314 
	`makeJošts
(
»que¡
, 
odom‘ry
, 
£nsÜs
, 
bodyMod–
, 
b®lX
, 
b®lY
);

316 if(
cu¼’t_g’”©Ü
 =ğ
Body
::
KICK
 && 
»que¡
->
body
.
aùiÚTy³
 =ğBody::
WALK
) {

317 
cu¼’t_g’”©Ü
 = 
Body
::
WALK
;

319 ià(!
u£sH—d
) {

320 
JoštV®ues
 
äomH—d
 = 
h—dG’”©Ü
->

321 
	`makeJošts
(
»que¡
, 
odom‘ry
, 
£nsÜs
, 
bodyMod–
, 
b®lX
, 
b®lY
);

322 
ušt8_t
 
i
 = 
Jošts
::
H—dYaw
; i <ğJošts::
H—dP™ch
; ++i) {

323 
äomBody
.
ªgËs
[
i
] = 
äomH—d
.angles[i];

324 
äomBody
.
¡ifâes£s
[
i
] = 
äomH—d
.stiffnesses[i];

327 
´ev_g’”©Ü
 = 
cu¼’t_g’”©Ü
;

328  
äomBody
;

329 
	}
}

331 
boŞ
 
	gDi¡ribu‹dG’”©Ü
::
	$isAùive
() {

332  
Œue
;

333 
	}
}

336 
	gDi¡ribu‹dG’”©Ü
::
	$£tPÏy”S³cificG‘ups
(
¶ay”Num
) {

337 ià(
¶ay”Num
 != 1) {

339 
G‘upG’”©Ü
 * 
gFrÚt
 = 
Ãw
 
	`G‘upG’”©Ü
("UChileGetUpFront");

340 
gFrÚt
->
	`£tPÏy”S³cificG‘up
(
¶ay”Num
);

341 
G‘upG’”©Ü
 * 
gBack
 = 
Ãw
 
	`G‘upG’”©Ü
("HTWKGetupBack");

342 
gBack
->
	`£tPÏy”S³cificG‘up
(
¶ay”Num
);

344 
bodyG’”©Üs
[
Body
::
GETUP_FRONT
] = (
G’”©Ü
*è
gFrÚt
;

346 ià(!
bodyG’”©Üs
[
Body
::
GETUP_FRONT
])

347 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GETUP_FRONT] i NULL!" << 
¡d
::
’dl
;

349 
bodyG’”©Üs
[
Body
::
GETUP_BACK
] = (
G’”©Ü
*è
gBack
;

351 ià(!
bodyG’”©Üs
[
Body
::
GETUP_BACK
])

352 
	`Îog
(
FATAL
è<< "bodyG’”©Üs[GETUP_BACK] i NULL!" << 
¡d
::
’dl
;

354 
	}
}

356 
	gDi¡ribu‹dG’”©Ü
::
	$»£t
() {

357 
ušt8_t
 
i
 = 0; i < 
Body
::
NUM_ACTION_TYPES
; ++i) {

358 
bodyG’”©Üs
[
i
]->
	`»£t
();

360 
h—dG’”©Ü
->
	`»£t
();

361 
cu¼’t_g’”©Ü
 = 
AùiÚCommªd
::
Body
::
NONE
;

362 
	}
}

364 
	gDi¡ribu‹dG’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

365 
ušt8_t
 
i
 = 0; i < 
Body
::
NUM_ACTION_TYPES
; ++i) {

366 
bodyG’”©Üs
[
i
]->
	`»adO±iÚs
(
cÚfig
);

368 
h—dG’”©Ü
->
	`»adO±iÚs
(
cÚfig
);

369 
	}
}

	@robot/motion/generator/DistributedGenerator.hpp

32 #´agm¨
Úû


34 
	~<m­
>

35 
	~<¡ršg
>

36 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

37 
	~"bÏckbßrd/BÏckbßrd.hµ
"

39 şas 
	cDi¡ribu‹dG’”©Ü
 : 
G’”©Ü
 {

40 
public
:

41 
ex¶ic™
 
Di¡ribu‹dG’”©Ü
(
BÏckbßrd
 *
bb
);

42 ~
Di¡ribu‹dG’”©Ü
();

43 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

44 
Odom‘ry
* 
odom‘ry
,

45 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

46 
BodyMod–
 &
bodyMod–
,

47 
b®lX
,

48 
b®lY
);

49 
vœtu®
 
boŞ
 
isAùive
();

50 
»£t
();

51 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

52 
boŞ
 
	misStİpšg
;

54 
£tPÏy”S³cificG‘ups
(
¶ay”Num
);

56 
	m´iv©e
:

57 
G’”©Ü
* 
bodyG’”©Üs
[
AùiÚCommªd
::
Body
::
NUM_ACTION_TYPES
];

58 
G’”©Ü
* 
	mh—dG’”©Ü
;

59 
	mAùiÚCommªd
::
Body
::
AùiÚTy³
 
cu¼’t_g’”©Ü
;

60 
	mAùiÚCommªd
::
Body
::
AùiÚTy³
 
´ev_g’”©Ü
;

61 
	mAùiÚCommªd
::
Body
::
AùiÚTy³
 
»que¡edDive
;

	@robot/motion/generator/FallAvoidanceGenerator.cpp

32 
	~<f¡»am
>

33 
	~<lim™s
>

34 
	~<cùy³
>

35 
	~"mÙiÚ/g’”©Ü/F®lAvoidªûG’”©Ü.hµ
"

36 
	~"uts/Logg”.hµ
"

37 
	~"uts/ªgËs.hµ
"

38 
	~"uts/body.hµ
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

42 
usšg
 
Çme¥aû
 
	gS’sÜs
;

43 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

45 
	gF®lAvoidªûG’”©Ü
::
	$F®lAvoidªûG’”©Ü
(
¡d
::
¡ršg
 
f’ame
è: 
	$fe_Çme
(
f’ame
) {

46 
max_™”
 = 0;

47 
cu¼’t_time
 = 
NOT_RUNNING
;

48 
´ev_§g_ªg
 = 0;

50 
üouch
 = 
Œue
;

51 
¡abË
 = 
çl£
;

52 
Üigš®_fe_Çme
 = 
f’ame
;

53 
	}
};

55 
	gF®lAvoidªûG’”©Ü
::~
	$F®lAvoidªûG’”©Ü
() {

56 
	`Îog
(
INFO
è<< "F®lAvoidªûG’”©Ü de¡royed" << 
¡d
::
’dl
;

57 
	}
};

59 
boŞ
 
	gF®lAvoidªûG’”©Ü
::
	$isAùive
() {

60  
cu¼’t_time
 !ğ
NOT_RUNNING
;

61 
	}
};

63 
	gF®lAvoidªûG’”©Ü
::
	$»£t
() {

64 
cu¼’t_time
 = 0;

65 
	}
}

67 
	gF®lAvoidªûG’”©Ü
::
	$¡İ
(){

68 
	}
}

70 
JoštV®ues
 
F®lAvoidªûG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

71 
Odom‘ry
* 
odom‘ry
,

72 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

73 
BodyMod–
 &
bodyMod–
,

74 
b®lX
,

75 
b®lY
) {

76 
JoštV®ues
 
j
;

79 
§g_ªg
 = 
	`RAD2DEG
(
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
]);

80 
§g_ªg_v–
 = 
§g_ªg
 - 
´ev_§g_ªg
;

81 
´ev_§g_ªg
 = 
§g_ªg
;

85 ià(
	`isUn¡abË
(
§g_ªg
è&& 
cu¼’t_time
 !ğ
NOT_RUNNING
) {

87 
JoštV®ues
 
ÃwJošts
 = 
£nsÜs
.
jošts
;

88 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

89 
ÃwJošts
.
¡ifâes£s
[
i
] = 1.0f;

91 ià(
cu¼’t_time
 =ğ0è
	`š‹½Ş©e
(
ÃwJošts
);

92 ià(
cu¼’t_time
 =ğ(sigÃd )
jošts
.
	`size
()) {

93 
j
 = 
jošts
[
cu¼’t_time
-1];

96 
cÜ»ùiÚ
 = -1*
§g_ªg
*
ANGLE_ADJUSTMENT
/
SCALE
;

98 
¡d
::
cout
 << "CORRECTION: " << 
cÜ»ùiÚ
 << std::
’dl
;

103 
j
.
ªgËs
[
Jošts
::
RHP™ch
] +ğ
cÜ»ùiÚ
;

104 
j
.
ªgËs
[
Jošts
::
LHP™ch
] +ğ
cÜ»ùiÚ
;

108 
j
 = 
jošts
[
cu¼’t_time
++];

111 ià(
¡abË
)

112 
¡abË
 = 
çl£
;

116 
JoštV®ues
 
ÃwJošts
 = 
£nsÜs
.
jošts
;

117 
¡abË_h
 = 
ÃwJošts
.
ªgËs
[
Jošts
::
RHP™ch
];

118 ià(!
¡abË
) {

119 
¡abË
 = 
Œue
;

120 
¡abË_h
 = 
ÃwJošts
.
ªgËs
[
Jošts
::
RHP™ch
];

123 ià(
cu¼’t_time
 =ğ
NOT_RUNNING
) {

125 
aùive
 = 
»que¡
->
body
;

126 
j
 = 
jošts
[jošts.
	`size
() - 1];

128 
JoštV®ues
 
ÃwJošts
 = 
£nsÜs
.
jošts
;

129 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

130 
j
.
¡ifâes£s
[
i
] = 1.0f;

132 ià(
cu¼’t_time
 =ğ0è
	`š‹½Ş©e
(
ÃwJošts
);

133 ià(
cu¼’t_time
 =ğ(sigÃd )
jošts
.
	`size
(è&& 
üouch
) {

136 ià(
Üigš®_fe_Çme
 != "slowStand") {

137 
üouch
 = 
çl£
;

138 
	`»£t
();

139 
jošts
.
	`ş—r
();

140 
fe_Çme
 = "slowStand";

141 
	`»adO±iÚs
(
cÚfigu¿tiÚ
);

143 
cu¼’t_time
 = 
NOT_RUNNING
;

146 } ià(
cu¼’t_time
 =ğ(sigÃd )
jošts
.
	`size
(è&& !
üouch
){

147 
cu¼’t_time
 = 
NOT_RUNNING
;

148 
üouch
 = 
Œue
;

149 
jošts
.
	`ş—r
();

150 
fe_Çme
 = 
Üigš®_fe_Çme
;

151 
	`»adO±iÚs
(
cÚfigu¿tiÚ
);

154 
j
 = 
jošts
[
cu¼’t_time
++];

164  
j
;

165 
	}
};

167 
boŞ
 
	gF®lAvoidªûG’”©Ü
::
	$isUn¡abË
(
ªgË
) {

170 ià(
cu¼’t_time
 =ğ0 || cu¼’t_tim=ğ(sigÃd )
jošts
.
	`size
()) {

171  
	`ABS
(
ªgË
è> 
STABLE_ANG
;

175 ià(
ªgË
 > 0)

176  
ªgË
 > 
POS_STABLE_ANG
;

178  
ªgË
 < 
NEG_STABLE_ANG
;

181  
çl£
;

182 
	}
}

184 
	gF®lAvoidªûG’”©Ü
::
	$š‹½Ş©e
(
JoštV®ues
 
ÃwJošt
, 
du¿tiÚ
) {

185 ià(
jošts
.
	`em±y
()) {

186 
max_™”
 = 
du¿tiÚ
 / 10;

189 
i
 = 0; i < 
max_™”
; i++) {

190 
jošts
.
	`push_back
(
ÃwJošt
);

192 
jošts
.
	`push_back
(
ÃwJošt
);

194 
šTime
 = 0;

195 
off£t
[
Jošts
::
NUMBER_OF_JOINTS
];

197 ià(
du¿tiÚ
 != 0) {

198 
šTime
 = 
du¿tiÚ
 / 10;

199 
JoštV®ues
 
cu¼’tJošt
 = 
jošts
.
	`back
();

202 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

203 
off£t
[
i
] = (
ÃwJošt
.
ªgËs
[i] - 
cu¼’tJošt
.ªgËs[i]è/ 
šTime
;

206 
i
 = 0; i < 
šTime
; i++) {

207 
JoštV®ues
 
šJošt
;

208 
j
 = 0; j < 
Jošts
::
NUMBER_OF_JOINTS
; j++) {

209 
šJošt
.
ªgËs
[
j
] = 
jošts
.
	`back
().ªgËs[j] + 
off£t
[j];

210 
šJošt
.
¡ifâes£s
[
j
] = 
ÃwJošt
.stiffnesses[j];

212 
jošts
.
	`push_back
(
šJošt
);

216 
JoštV®ues
 
fœ¡Jošt
 = 
jošts
.
	`©
(
max_™”
);

219 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

220 
off£t
[
i
] = (
fœ¡Jošt
.
ªgËs
[i] - 
ÃwJošt
.ªgËs[i]è/ 
max_™”
;

223 
jošts
[0] = 
ÃwJošt
;

224 
i
 = 1; i < 
max_™”
; i++) {

225 
j
 = 0; j < 
Jošts
::
NUMBER_OF_JOINTS
; j++) {

226 
jošts
[
i
].
ªgËs
[
j
] = jošts[˜- 1].ªgËs[j] + 
off£t
[j];

227 
jošts
[
i
].
¡ifâes£s
[
j
] = 
fœ¡Jošt
.stiffnesses[j];

232 
	}
}

234 
	gF®lAvoidªûG’”©Ü
::
	$cÚ¡ruùPo£
(
¡d
::
¡ršg
 
·th
) {

235 
if¡»am
 
	`š
(
	`¡ršg
(
·th
 + "/" + 
fe_Çme
 + ".pos").
	`c_¡r
());

236 
	`Îog
(
INFO
è<< "F®lAvoidªûG’”©Ü(" << 
fe_Çme
 << "èü—tšg" << 
’dl
;

238 ià(!
š
.
	`is_İ’
()) {

239 
	`Îog
(
FATAL
è<< "F®lAvoidªûG’”©Ü cª‚Ù o³À" << 
fe_Çme
 << 
’dl
;

241 
du¿tiÚ
 = 0;

242 
¡ifâess
 = 1.0;

243 
ªgËs
 = 0.0;

244 
	`is¥aû
(
š
.
	`³ek
())) {

245 
š
.
	`ignÜe
();

247 !
š
.
	`eof
()) {

249 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

250 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

253 
JoštV®ues
 
ÃwJošt
;

255 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

256 
	`is¥aû
(
š
.
	`³ek
())) {

257 
š
.
	`ignÜe
();

259 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'$' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

260 
¡d
::
cout
 << "You'» missšg‡ jošˆv®uš " << 
fe_Çme
 << ".pos" << std::
’dl
;

261 
	`ex™
(1);

263 
š
 >> 
ªgËs
;

266 
ÃwJošt
.
ªgËs
[
i
] = 
	`DEG2RAD
(angles);

267 
ÃwJošt
.
¡ifâes£s
[
i
] = 1.0;

271 
	`is¥aû
(
š
.
	`³ek
())) {

272 
š
.
	`ignÜe
();

274 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'$' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

275 
¡d
::
cout
 << "You'» missšg‡ du¿tiÚ iÀ" << 
fe_Çme
 << ".pos" << std::
’dl
;

276 
	`ex™
(1);

278 
š
 >> 
du¿tiÚ
;

281 
	`is¥aû
(
š
.
	`³ek
())) {

282 
š
.
	`ignÜe
();

284 
š
.
	`³ek
() == '#') {

285 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

287 
	`is¥aû
(
š
.
	`³ek
())) {

288 
š
.
	`ignÜe
();

292 ià(
š
.
	`³ek
() == '$') {

293 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '$');

294 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

295 
	`is¥aû
(
š
.
	`³ek
())) {

296 
š
.
	`ignÜe
();

298 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

299 
¡d
::
cout
 << "You'» missšg‡ stifâes v®uš " << 
fe_Çme
 << ".pos" << std::
’dl
;

300 
	`ex™
(1);

302 
š
 >> 
¡ifâess
;

303 
ÃwJošt
.
¡ifâes£s
[
i
] = 
¡ifâess
;

306 
	`is¥aû
(
š
.
	`³ek
())) {

307 
š
.
	`ignÜe
();

309 
š
.
	`³ek
() == '#') {

310 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

312 
	`is¥aû
(
š
.
	`³ek
())) {

313 
š
.
	`ignÜe
();

316 
	`š‹½Ş©e
(
ÃwJošt
, 
du¿tiÚ
);

317 
	`is¥aû
(
š
.
	`³ek
())) {

318 
š
.
	`ignÜe
();

321 
š
.
	`şo£
();

323 
	`Îog
(
INFO
è<< "F®lAvoidªûG’”©Ü(" << 
fe_Çme
 << "èü—‹d" << 
’dl
;

324 
	}
}

326 
	gF®lAvoidªûG’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

327 
cÚfigu¿tiÚ
 = 
cÚfig
;

328 
¡d
::
¡ršg
 
·th
 = 
cÚfig
["mÙiÚ.·th"].
as
<std::string>();

329 
	`cÚ¡ruùPo£
(
·th
);

330 
	}
}

	@robot/motion/generator/FallAvoidanceGenerator.hpp

32 #´agm¨
Úû


34 
	~<¡ršg
>

35 
	~<veùÜ
>

36 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

37 
	~"uts/body.hµ
"

40 
	#NOT_RUNNING
 -1

	)

43 
	#MAX_STIFF
 1.0

	)

45 
	#POS_STABLE_ANG
 15

	)

46 
	#NEG_STABLE_ANG
 -10

	)

47 
	#STABLE_ANG
 12

	)

48 
	#STABLE_ANG_VEL
 0.3

	)

50 
	#ANGLE_ADJUSTMENT
 0.2

	)

51 
	#SCALE
 15

	)

52 
	#MAX_ANGLE
 18.0f

	)

54 
	#INITIAL_HIP_ANG
 -65

	)

56 
	#CROUCH_POSITION
 0

	)

58 şas 
	cF®lAvoidªûG’”©Ü
 : 
G’”©Ü
 {

59 
public
:

60 
ex¶ic™
 
F®lAvoidªûG’”©Ü
(
¡d
::
¡ršg
 
f’ame
);

61 ~
F®lAvoidªûG’”©Ü
();

63 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

64 
Odom‘ry
* 
odom‘ry
,

65 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

66 
BodyMod–
 &
bodyMod–
,

67 
b®lX
,

68 
b®lY
);

69 
vœtu®
 
boŞ
 
isAùive
();

70 
»£t
();

71 
¡İ
();

72 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

74 
	m´iv©e
:

75 
cu¼’t_time
;

76 
	m¡d
::
¡ršg
 
fe_Çme
;

77 
	m¡d
::
¡ršg
 
Üigš®_fe_Çme
;

78 
	m¡d
::
veùÜ
<
JoštV®ues
> 
jošts
;

79 
	mAùiÚCommªd
::
Body
 
aùive
;

80 
	mboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
cÚfigu¿tiÚ
;

81 
	mb®ªûAdju¡m’t
;

82 
	mf‹»dGyroY
;

84 
	m§g_ªg_v–
;

85 
	m´ev_§g_ªg
;

87 
boŞ
 
	m¡abË
;

88 
boŞ
 
	müouch
;

95 
boŞ
 
isUn¡abË
(
ªgË
);

102 
	mmax_™”
;

115 
š‹½Ş©e
(
JoštV®ues
 
ÃwJošt
, 
du¿tiÚ
 = 0);

122 
cÚ¡ruùPo£
(
¡d
::
¡ršg
 
·th
);

	@robot/motion/generator/Generator.hpp

32 #´agm¨
Úû


34 
	~<boo¡/´og¿m_İtiÚs.hµ
>

35 
	~"ty³s/AùiÚCommªd.hµ
"

36 
	~"ty³s/JoštV®ues.hµ
"

37 
	~"ty³s/Odom‘ry.hµ
"

38 
	~"ty³s/S’sÜV®ues.hµ
"

39 
	~"mÙiÚ/g’”©Ü/BodyMod–.hµ
"

45 şas 
	cG’”©Ü
 {

46 
	mpublic
:

47 
vœtu®
 ~
	$G’”©Ü
() {}

59 
vœtu®
 
JoštV®ues
 
	`makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

60 
Odom‘ry
* 
odom‘ry
,

61 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

62 
BodyMod–
 &
bodyMod–
,

63 
b®lX
,

64 
b®lY
) = 0;

69 
vœtu®
 
boŞ
 
	`isAùive
() = 0;

73 
vœtu®
 
	`»£t
() = 0;

78 
vœtu®
 
	$¡İ
() {

79 
	}
}

81 
vœtu®
 
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
è{
	}
}

	@robot/motion/generator/GetupGenerator.cpp

32 
	~<f¡»am
>

33 
	~<lim™s
>

34 
	~<cùy³
>

35 
	~"mÙiÚ/g’”©Ü/G‘upG’”©Ü.hµ
"

36 
	~"uts/Logg”.hµ
"

37 
	~"uts/ªgËs.hµ
"

38 
	~"uts/¥“ch.hµ
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

41 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

43 
	gG‘upG’”©Ü
::
	$G‘upG’”©Ü
(
¡d
::
¡ršg
 
f’ame
è: 
	$fe_Çme
(
f’ame
) {

44 
max_™”
 = 0;

45 
çÎ’
 = 
çl£
;

46 
num_times_çÎ’
 = 0;

47 
cu¼’t_time
 = 
NOT_RUNNING
;

48 
¶ay”_numb”
 = 1;

49 
	}
};

51 
	gG‘upG’”©Ü
::~
	$G‘upG’”©Ü
() {

52 
	`Îog
(
INFO
è<< "G‘upG’”©Ü de¡royed" << 
¡d
::
’dl
;

53 
	}
};

55 
boŞ
 
	gG‘upG’”©Ü
::
	$isAùive
() {

56  
cu¼’t_time
 !ğ
NOT_RUNNING
;

57 
	}
};

59 
	gG‘upG’”©Ü
::
	$»£t
() {

60 
cu¼’t_time
 = 0;

61 
	}
}

63 
	gG‘upG’”©Ü
::
	$¡İ
(){

64 
	}
}

66 
G‘upG’”©Ü
::
	$£tPÏy”S³cificG‘up
(
¶ay”Num
) {

67 
¶ay”_numb”
 = 
¶ay”Num
;

68 
	}
}

70 
JoštV®ues
 
	gG‘upG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

71 
Odom‘ry
* 
odom‘ry
,

72 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

73 
BodyMod–
 &
bodyMod–
,

74 
b®lX
,

75 
b®lY
) {

76 
ªg
[2] = {
	`RAD2DEG
(
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
]),

77 
	`RAD2DEG
(
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
])};

78 
JoštV®ues
 
j
;

79 ià(
cu¼’t_time
 =ğ
NOT_RUNNING
) {

81 
aùive
 = 
»que¡
->
body
;

82 
j
 = 
jošts
[jošts.
	`size
() - 1];

83 
num_times_çÎ’
 = 0;

85 
JoštV®ues
 
ÃwJošts
 = 
£nsÜs
.
jošts
;

86 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

87 
ÃwJošts
.
¡ifâes£s
[
i
] = 1.0f;

89 ià(
cu¼’t_time
 =ğ0è
	`š‹½Ş©e
(
ÃwJošts
);

91 ià(
ªg
[1] < -
FALLEN_ANG
 ||‡ng[0] < -FALLEN_ANG) {

92 ià(
cu¼’t_time
 > 4 && !
çÎ’
) {

93 
çÎ’
 = 
Œue
;

94 
num_times_çÎ’
 ++;

96 
	`»£t
();

97 
jošts
.
	`ş—r
();

99 
fe_Çme
 = 
¶ay”_numb”
 == 1? "getupBack" : "HTWKGetupBack";

100 
	`»adO±iÚs
(
cÚfigu¿tiÚ
);

102 } ià(
ªg
[1] > 
FALLEN_ANG
 ||‡ng[0] > FALLEN_ANG) {

103 ià(
cu¼’t_time
 > 4 && !
çÎ’
) {

104 
çÎ’
ğ
Œue
;

105 
num_times_çÎ’
 ++;

107 
	`»£t
();

108 
jošts
.
	`ş—r
();

109 
fe_Çme
 = 
¶ay”_numb”
 == 1? "getupFront" : "UChileGetUpFront";

110 
	`»adO±iÚs
(
cÚfigu¿tiÚ
);

113 
çÎ’
 = 
çl£
;

115 
j
 = 
jošts
[
cu¼’t_time
++];

116 ià(
cu¼’t_time
 =ğ(sigÃd )
jošts
.
	`size
())

117 
cu¼’t_time
 = 
NOT_RUNNING
;

124 ià(
num_times_çÎ’
 >ğ
CONSECUTIVE_FALLS_ALLOWED
) {

131  
j
;

132 
	}
};

134 
	gG‘upG’”©Ü
::
	$š‹½Ş©e
(
JoštV®ues
 
ÃwJošt
, 
du¿tiÚ
) {

135 ià(
jošts
.
	`em±y
()) {

136 
max_™”
 = 
du¿tiÚ
 / 10;

139 
i
 = 0; i < 
max_™”
; i++) {

140 
jošts
.
	`push_back
(
ÃwJošt
);

142 
jošts
.
	`push_back
(
ÃwJošt
);

144 
šTime
 = 0;

145 
off£t
[
Jošts
::
NUMBER_OF_JOINTS
];

147 ià(
du¿tiÚ
 != 0) {

148 
šTime
 = 
du¿tiÚ
 / 10;

149 
JoštV®ues
 
cu¼’tJošt
 = 
jošts
.
	`back
();

152 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

153 
off£t
[
i
] = (
ÃwJošt
.
ªgËs
[i] - 
cu¼’tJošt
.ªgËs[i]è/ 
šTime
;

156 
i
 = 0; i < 
šTime
; i++) {

157 
JoštV®ues
 
šJošt
;

158 
j
 = 0; j < 
Jošts
::
NUMBER_OF_JOINTS
; j++) {

159 
šJošt
.
ªgËs
[
j
] = 
jošts
.
	`back
().ªgËs[j] + 
off£t
[j];

160 
šJošt
.
¡ifâes£s
[
j
] = 
ÃwJošt
.stiffnesses[j];

162 
jošts
.
	`push_back
(
šJošt
);

166 
JoštV®ues
 
fœ¡Jošt
 = 
jošts
.
	`©
(
max_™”
);

169 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

170 
off£t
[
i
] = (
fœ¡Jošt
.
ªgËs
[i] - 
ÃwJošt
.ªgËs[i]è/ 
max_™”
;

173 
jošts
[0] = 
ÃwJošt
;

174 
i
 = 1; i < 
max_™”
; i++) {

175 
j
 = 0; j < 
Jošts
::
NUMBER_OF_JOINTS
; j++) {

176 
jošts
[
i
].
ªgËs
[
j
] = jošts[˜- 1].ªgËs[j] + 
off£t
[j];

177 
jošts
[
i
].
¡ifâes£s
[
j
] = 
fœ¡Jošt
.stiffnesses[j];

182 
	}
}

184 
	gG‘upG’”©Ü
::
	$cÚ¡ruùPo£
(
¡d
::
¡ršg
 
·th
) {

185 
if¡»am
 
	`š
(
	`¡ršg
(
·th
 + "/" + 
fe_Çme
 + ".pos").
	`c_¡r
());

186 
	`Îog
(
INFO
è<< "G‘upG’”©Ü(" << 
fe_Çme
 << "èü—tšg" << 
’dl
;

188 ià(!
š
.
	`is_İ’
()) {

189 
	`Îog
(
FATAL
è<< "G‘upG’”©Ü cª‚Ù o³À" << 
fe_Çme
 << 
’dl
;

191 
du¿tiÚ
 = 0;

192 
¡ifâess
 = 1.0;

193 
ªgËs
 = 0.0;

194 
	`is¥aû
(
š
.
	`³ek
())) {

195 
š
.
	`ignÜe
();

197 !
š
.
	`eof
()) {

199 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

200 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

203 
JoštV®ues
 
ÃwJošt
;

205 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

206 
	`is¥aû
(
š
.
	`³ek
())) {

207 
š
.
	`ignÜe
();

209 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'$' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

210 
¡d
::
cout
 << "You'» missšg‡ jošˆv®uš " << 
fe_Çme
 << ".pos" << std::
’dl
;

211 
	`ex™
(1);

213 
š
 >> 
ªgËs
;

216 
ÃwJošt
.
ªgËs
[
i
] = 
	`DEG2RAD
(angles);

217 
ÃwJošt
.
¡ifâes£s
[
i
] = 1.0;

221 
	`is¥aû
(
š
.
	`³ek
())) {

222 
š
.
	`ignÜe
();

224 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'$' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

225 
¡d
::
cout
 << "You'» missšg‡ du¿tiÚ iÀ" << 
fe_Çme
 << ".pos" << std::
’dl
;

226 
	`ex™
(1);

228 
š
 >> 
du¿tiÚ
;

231 
	`is¥aû
(
š
.
	`³ek
())) {

232 
š
.
	`ignÜe
();

234 
š
.
	`³ek
() == '#') {

235 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

237 
	`is¥aû
(
š
.
	`³ek
())) {

238 
š
.
	`ignÜe
();

242 ià(
š
.
	`³ek
() == '$') {

243 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '$');

244 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

245 
	`is¥aû
(
š
.
	`³ek
())) {

246 
š
.
	`ignÜe
();

248 ià(
š
.
	`³ek
(è=ğ'#' || in.³ek(è=ğ'\n' || in.³ek(è=ğ
EOF
) {

249 
¡d
::
cout
 << "You'» missšg‡ stifâes v®uš " << 
fe_Çme
 << ".pos" << std::
’dl
;

250 
	`ex™
(1);

252 
š
 >> 
¡ifâess
;

253 
ÃwJošt
.
¡ifâes£s
[
i
] = 
¡ifâess
;

256 
	`is¥aû
(
š
.
	`³ek
())) {

257 
š
.
	`ignÜe
();

259 
š
.
	`³ek
() == '#') {

260 
š
.
	`ignÜe
(
¡d
::
num”ic_lim™s
<>::
	`max
(), '\n');

262 
	`is¥aû
(
š
.
	`³ek
())) {

263 
š
.
	`ignÜe
();

266 
	`š‹½Ş©e
(
ÃwJošt
, 
du¿tiÚ
);

267 
	`is¥aû
(
š
.
	`³ek
())) {

268 
š
.
	`ignÜe
();

271 
š
.
	`şo£
();

273 
	`Îog
(
INFO
è<< "G‘upG’”©Ü(" << 
fe_Çme
 << "èü—‹d" << 
’dl
;

274 
	}
}

276 
	gG‘upG’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

277 
cÚfigu¿tiÚ
 = 
cÚfig
;

278 
¡d
::
¡ršg
 
·th
 = 
cÚfig
["mÙiÚ.·th"].
as
<std::string>();

279 
	`cÚ¡ruùPo£
(
·th
);

280 
	}
}

	@robot/motion/generator/GetupGenerator.hpp

32 #´agm¨
Úû


34 
	~<¡ršg
>

35 
	~<veùÜ
>

36 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

39 
	#NOT_RUNNING
 -1

	)

42 
	#MAX_STIFF
 1.0

	)

44 
	#CONSECUTIVE_FALLS_ALLOWED
 3

	)

46 
	#FALLEN_ANG
 70

	)

48 şas 
	cG‘upG’”©Ü
 : 
G’”©Ü
 {

49 
public
:

50 
ex¶ic™
 
G‘upG’”©Ü
(
¡d
::
¡ršg
 
f’ame
);

51 ~
G‘upG’”©Ü
();

53 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

54 
Odom‘ry
* 
odom‘ry
,

55 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

56 
BodyMod–
 &
bodyMod–
,

57 
b®lX
,

58 
b®lY
);

59 
vœtu®
 
boŞ
 
isAùive
();

60 
»£t
();

61 
¡İ
();

62 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

64 
£tPÏy”S³cificG‘up
(
¶ay”Num
);

66 
	m´iv©e
:

67 
cu¼’t_time
;

68 
	m¡d
::
¡ršg
 
fe_Çme
;

69 
	m¶ay”_numb”
;

70 
	m¡d
::
veùÜ
<
JoštV®ues
> 
jošts
;

71 
	mAùiÚCommªd
::
Body
 
aùive
;

72 
	mboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
cÚfigu¿tiÚ
;

73 
boŞ
 
	mçÎ’
;

74 
	mnum_times_çÎ’
;

81 
	mmax_™”
;

94 
š‹½Ş©e
(
JoštV®ues
 
ÃwJošt
, 
du¿tiÚ
 = 0);

101 
cÚ¡ruùPo£
(
¡d
::
¡ršg
 
·th
);

	@robot/motion/generator/HeadGenerator.cpp

32 
	~"mÙiÚ/g’”©Ü/H—dG’”©Ü.hµ
"

33 
	~"uts/basic_m©hs.hµ
"

34 
	~"uts/ş.hµ
"

35 
	~"uts/Logg”.hµ
"

37 
	gH—dG’”©Ü
::
	$H—dG’”©Ü
()

38 : 
	`yaw
(0.0f),

39 
	$p™ch
(0.0f) {

40 
	`Îog
(
INFO
è<< "H—dG’”©Ü cÚ¡ruùed" << 
¡d
::
’dl
;

41 
	}
}

43 
	gH—dG’”©Ü
::~
	$H—dG’”©Ü
() {

44 
	`Îog
(
INFO
è<< "H—dG’”©Ü de¡royed" << 
¡d
::
’dl
;

45 
	}
}

48 
JoštV®ues
 
	gH—dG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

49 
Odom‘ry
* 
odom‘ry
,

50 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

51 
BodyMod–
 &
bodyMod–
,

52 
b®lX
,

53 
b®lY
) {

55 
desY
 = 0.0, 
desP
 = 0.0;

58 ià(
	`i¢ª
(
»que¡
->
h—d
.
yaw
è|| i¢ªÔeque¡->h—d.
p™ch
)) {

59 
	`Îog
(
INFO
è<< "H—dG’”©Ü: NAN‡ngË - Došg NÙhšg" << 
¡d
::
’dl
;

60  
£nsÜs
.
jošts
;

67 ià(
»que¡
->
h—d
.
isR–©ive
) {

68 
desY
 = 
yaw
 + 
»que¡
->
h—d
.yaw;

71 
desY
 = 
»que¡
->
h—d
.
yaw
;

73 
desP
 = 
»que¡
->
h—d
.
p™ch
;

75 
diffY
 = 
desY
 - 
yaw
;

76 
diffP
 = 
desP
 - 
p™ch
;

77 
diffY
 = 
CLIP
<>(diffY, 
Jošts
::
RadŸns
::
H—dYawS³ed
 *

78 
»que¡
->
h—d
.
yawS³ed
);

79 
diffP
 = 
CLIP
<>(diffP, 
Jošts
::
RadŸns
::
H—dP™chS³ed
 *

80 
»que¡
->
h—d
.
p™chS³ed
);

81 
yaw
 +ğ
diffY
;

82 
p™ch
 +ğ
diffP
;

85 
JoštV®ues
 
j
 = 
£nsÜs
.
jošts
;

86 
j
.
ªgËs
[
Jošts
::
H—dYaw
] = 
yaw
;

87 
j
.
ªgËs
[
Jošts
::
H—dP™ch
] = 
p™ch
;

88 
j
.
¡ifâes£s
[
Jošts
::
H—dYaw
] = 0.8f;

89 
j
.
¡ifâes£s
[
Jošts
::
H—dP™ch
] = 0.8f;

90  
j
;

91 
	}
}

93 
boŞ
 
	gH—dG’”©Ü
::
	$isAùive
() {

94  
Œue
;

95 
	}
}

97 
	gH—dG’”©Ü
::
	$»£t
() {

98 
yaw
 = 0.0f;

99 
p™ch
 = 0.0f;

100 
	}
}

	@robot/motion/generator/HeadGenerator.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

40 şas 
	cH—dG’”©Ü
 : 
G’”©Ü
 {

41 
public
:

42 
ex¶ic™
 
H—dG’”©Ü
();

43 ~
H—dG’”©Ü
();

44 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

45 
Odom‘ry
* 
odom‘ry
,

46 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

47 
BodyMod–
 &
bodyMod–
,

48 
b®lX
,

49 
b®lY
);

50 
vœtu®
 
boŞ
 
isAùive
();

51 
»£t
();

53 
	m´iv©e
:

54 
yaw
;

55 
	mp™ch
;

	@robot/motion/generator/NullGenerator.cpp

32 
	~"mÙiÚ/g’”©Ü/NuÎG’”©Ü.hµ
"

33 
	~"uts/Logg”.hµ
"

35 
	gNuÎG’”©Ü
::
	$NuÎG’”©Ü
() {

36 
	`Îog
(
INFO
è<< "NuÎG’”©Ü c»©ed" << 
¡d
::
’dl
;

37 
	}
}

39 
	gNuÎG’”©Ü
::~
	$NuÎG’”©Ü
() {

40 
	`Îog
(
INFO
è<< "NuÎG’”©Ü de¡royed" << 
¡d
::
’dl
;

41 
	}
}

43 
JoštV®ues
 
	gNuÎG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

44 
Odom‘ry
* 
odom‘ry
,

45 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

46 
BodyMod–
 &
bodyMod–
,

47 
b®lX
,

48 
b®lY
) {

49 
JoštV®ues
 
j
 = 
£nsÜs
.
jošts
;

50 
ušt8_t
 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i)

51 
j
.
¡ifâes£s
[
i
] = 0.0f;

52  
j
;

53 
	}
}

55 
boŞ
 
	gNuÎG’”©Ü
::
	$isAùive
() {

56  
çl£
;

57 
	}
}

59 
	gNuÎG’”©Ü
::
	$»£t
(è{
	}
}

	@robot/motion/generator/NullGenerator.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

36 şas 
	cNuÎG’”©Ü
 : 
G’”©Ü
 {

37 
public
:

38 
ex¶ic™
 
NuÎG’”©Ü
();

39 ~
NuÎG’”©Ü
();

40 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

41 
Odom‘ry
* 
odom‘ry
,

42 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

43 
BodyMod–
 &
bodyMod–
,

44 
b®lX
,

45 
b®lY
);

46 
vœtu®
 
boŞ
 
isAùive
();

47 
»£t
();

	@robot/motion/generator/PendulumModel.cpp

1 
	~"P’dulumMod–.hµ
"

2 
	~<cm©h
>

3 
	~<io¡»am
>

5 
usšg
 
Çme¥aû
 
	g¡d
;

7 
	gP’dulumMod–
::
	$´ediùNext
(
dt
, 
suµÜtPivÙ
){

8 
x
 = x + 
dx
 * 
dt
 + 
accX
 * (dt*dt)/2;

9 
dx
 = dx + 
accX
 * 
dt
;

10 
th‘a
 = 
	`©ª2
((
x
 - 
suµÜtPivÙ
), 
h
);

12 
accX
 = 
g
 * 
	`sš
(
th‘a
è* 
	`cos
(theta);

14 
	}
}

	@robot/motion/generator/PendulumModel.hpp

1 #´agm¨
Úû


3 
	~"W®kCyşe.hµ
"

5 
	sP’dulumMod–
 {

6 
P’dulumMod–
(è: 
x
(0), 
dx
(0), 
accX
(0), 
th‘a
(0), 
w®kCyşe
(0.0f, 0.0f, 0.0f, 0.0f, 0.5, 0.0f) {}

8 
	mx
;

11 
	mdx
;

14 
	maccX
;

17 
	mpsi
;

20 
	mth‘a
;

22 cÚ¡ 
	mh
 = 300.0f;

23 cÚ¡ 
	mg
 = 9806.65f;

26 
W®kCyşe
 
	mw®kCyşe
;

28 
´ediùNext
(
dt
, 
pivÙ
);

30 
	m‹m¶©e
<
şass
 
	mArchive
>

31 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

32 
	m¬
 & 
	mx
;

33 
	m¬
 & 
	mdx
;

34 
	m¬
 & 
	mpsi
;

	@robot/motion/generator/Planner.hpp

1 #´agm¨
Úû


3 
	~"AùiÚ.hµ
"

4 
	~"BodyMod–.hµ
"

5 
	~"ty³s/AùiÚCommªd.hµ
"

7 şas 
	cPÏÂ”
 {

8 
vœtu®
 
AùiÚ
 
g‘AùiÚ
(
BodyMod–
 
p
, 
AùiÚCommªd
::
AÎ
 
a
) = 0;

	@robot/motion/generator/RLPlanner.cpp

1 
	~<f¡»am
>

2 
	~<s¡»am
>

3 
	~<cm©h
>

4 
	~"RLPÏÂ”.hµ
"

6 
usšg
 
Çme¥aû
 
	g¡d
;

8 
	gRLPÏÂ”
::
	$RLPÏÂ”
(
¡d
::
¡ršg
 
fe
) {

10 
	`lßdFe
(
fe
);

11 
	}
}

13 
boŞ
 
	gRLPÏÂ”
::
	$lßdFe
(
¡d
::
¡ršg
 
¶ªÃrFe
) {

14 
if¡»am
 
	`f
(
¶ªÃrFe
.
	`c_¡r
());

15 ià(!
f
.
	`is_İ’
()è 
çl£
;

17 
¡ršg
 
lše
;

18 
lše
 = 
	`g‘LšeNoComm’ts
(
f
);

21 
f
.
	`good
()) {

22 
lše
 = 
	`g‘LšeNoComm’ts
(
f
);

23 
¡ršg¡»am
 
	`s
(
lše
);

24 
gßl
, 
x
, 
xdÙ
, 
t
, 
aùiÚ
;

25 
s
 >> 
gßl
 >> 
x
 >> 
xdÙ
 >> 
t
 >> 
aùiÚ
;

26 
bË
[
gßl
][(
x
+50)/5][(
xdÙ
 + 250)/25][(
t
)/20] = 
aùiÚ
;

28 
f
.
	`şo£
();

29  
Œue
;

30 
	}
}

32 
¡ršg
 
	gRLPÏÂ”
::
	$g‘LšeNoComm’ts
(
if¡»am
 &
f
) {

33 
f
.
	`good
()) {

34 
¡d
::
¡ršg
 
lše
;

35 
	`g‘lše
(
f
, 
lše
);

38 ià(!(
lše
[0] == '/' &&†ine[1] == '/')) †ine;

41 
	}
}

43 
AùiÚ
 
	gRLPÏÂ”
::
	$g‘AùiÚ
(
BodyMod–
 
b
, 
AùiÚCommªd
::
AÎ
 
aùiÚCommªd
) {

44 
AùiÚ
 
a
;

45 
a
.
ªkËRÙ©iÚL
 = 0;

46 
a
.
ªkËRÙ©iÚR
 = 0;

49 
x
 = 
b
.
³ndulumMod–
.x;

50 
dx
 = 
b
.
³ndulumMod–
.dx;

51 
xIndex
 = (
x
 + 50)/5;

52 
dxIndex
 = (
dx
 + 250)/25;

53 
tIndex
 = (
b
.
	`g‘W®kCyşe
().
t
 * 1000/20);

56 ià(
xIndex
 < 0 || xIndex >ğ21è 
a
;

57 ià(
dxIndex
 < 0 || dxIndex >ğ21è 
a
;

58 ià(
tIndex
 < 0 ||Index >ğ25è 
a
;

60 
dœ
 = 1;

61 ià(
aùiÚCommªd
.
body
.
fÜw¬d
 > 20è
dœ
 = 2;

62 ià(
aùiÚCommªd
.
body
.
fÜw¬d
 < -20è
dœ
 = 0;

63 
a
.
ªkËRÙ©iÚL
 = 
bË
[
dœ
][
xIndex
][
dxIndex
][
tIndex
];

64 
a
.
ªkËRÙ©iÚR
 = 
bË
[
dœ
][
xIndex
][
dxIndex
][
tIndex
];

65  
a
;

66 
	}
}

	@robot/motion/generator/RLPlanner.hpp

1 #´agm¨
Úû


3 
	~<¡ršg
>

4 
	~<f¡»am
>

5 
	~"ty³s/AùiÚCommªd.hµ
"

6 
	~"PÏÂ”.hµ
"

7 
	~"BodyMod–.hµ
"

9 şas 
	cRLPÏÂ”
 : 
PÏÂ”
 {

10 
public
:

11 
RLPÏÂ”
(
¡d
::
¡ršg
 
¶ªÃrFe
);

12 
AùiÚ
 
g‘AùiÚ
(
BodyMod–
 
b
, 
AùiÚCommªd
::
AÎ
 
a
);

14 
	m´iv©e
:

15 
boŞ
 
lßdFe
(
¡d
::
¡ršg
 
¶ªÃrFe
);

16 
	m¡d
::
¡ršg
 
g‘LšeNoComm’ts
(
¡d
::
if¡»am
 &
f
);

17 
	mbË
[3][21][21][25];

	@robot/motion/generator/RefPickupGenerator.cpp

32 
	~"mÙiÚ/g’”©Ü/RefPickupG’”©Ü.hµ
"

33 
	~"mÙiÚ/g’”©Ü/SndG’”©Ü.hµ
"

34 
	~"uts/ªgËs.hµ
"

35 
	~"uts/body.hµ
"

36 
	~"uts/Logg”.hµ
"

38 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

40 
	gRefPickupG’”©Ü
::
	$RefPickupG’”©Ü
()

41 : 
	`phi
(
	`DEG2RAD
(0.0f)), 
	`t
(100), 
	`¡İpšg
(
çl£
), 
	$¡İ³d
(
çl£
) {

42 
	`Îog
(
INFO
è<< "RefPickupG’”©Ü cÚ¡ruùed" << 
¡d
::
’dl
;

43 
¡ªdG’
 = (
G’”©Ü
 *)(
Ãw
 
	`SndG’”©Ü
());

44 
	}
}

46 
	gRefPickupG’”©Ü
::~
	$RefPickupG’”©Ü
() {

47 
	`Îog
(
INFO
è<< "RefPickupG’”©Ü de¡royed" << 
¡d
::
’dl
;

48 
d–‘e
 
¡ªdG’
;

49 
	}
}

51 
JoštV®ues
 
	gRefPickupG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

52 
Odom‘ry
* 
odom‘ry
,

53 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

54 
BodyMod–
 &
bodyMod–
,

55 
b®lX
,

56 
b®lY
) {

57 ià(
¡İpšg
)

58 ià(!(--
t
))

59 
¡İpšg
 = !(
¡İ³d
 = 
Œue
);

60  
¡ªdG’
->
	`makeJošts
(
»que¡
,
odom‘ry
,
£nsÜs
,
bodyMod–
,
b®lX
,
b®lY
);

61 
	}
}

63 
boŞ
 
	gRefPickupG’”©Ü
::
	$isAùive
() {

64  !
¡İ³d
 || 
¡ªdG’
->
	`isAùive
();

65 
	}
}

67 
	gRefPickupG’”©Ü
::
	$»£t
() {

68 
t
 = 100;

69 
¡İpšg
 = 
¡İ³d
 = 
çl£
;

70 
¡ªdG’
->
	`»£t
();

71 
	}
}

73 
	gRefPickupG’”©Ü
::
	$¡İ
() {

74 
¡ªdG’
->
	`¡İ
();

75 
¡İpšg
 = 
Œue
;

76 
	}
}

78 
	gRefPickupG’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

79 
¡ªdG’
->
	`»adO±iÚs
(
cÚfig
);

80 
	}
}

	@robot/motion/generator/RefPickupGenerator.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

36 şas 
	cRefPickupG’”©Ü
 : 
G’”©Ü
 {

37 
public
:

38 
ex¶ic™
 
RefPickupG’”©Ü
();

39 ~
RefPickupG’”©Ü
();

40 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

41 
Odom‘ry
* 
odom‘ry
,

42 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

43 
BodyMod–
 &
bodyMod–
,

44 
b®lX
,

45 
b®lY
);

46 
vœtu®
 
boŞ
 
isAùive
();

47 
»£t
();

48 
¡İ
();

49 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

51 
	m´iv©e
:

52 
phi
;

53 
	mt
;

54 
boŞ
 
	m¡İpšg
;

55 
boŞ
 
	m¡İ³d
;

56 
G’”©Ü
 *
	m¡ªdG’
;

	@robot/motion/generator/StandGenerator.cpp

32 
	~"mÙiÚ/g’”©Ü/SndG’”©Ü.hµ
"

33 
	~"mÙiÚ/g’”©Ü/AùiÚG’”©Ü.hµ
"

34 
	~"uts/ªgËs.hµ
"

35 
	~"uts/body.hµ
"

36 
	~"uts/Logg”.hµ
"

38 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

40 
	gSndG’”©Ü
::
	$SndG’”©Ü
()

41 : 
	`phi
(
	$DEG2RAD
(0.0f)) {

42 
	`Îog
(
INFO
è<< "SndG’”©Ü cÚ¡ruùed" << 
¡d
::
’dl
;

43 
posG’
 = (
G’”©Ü
*)(
Ãw
 
	`AùiÚG’”©Ü
("stand"));

44 ià(!
posG’
)

45 
	`Îog
(
FATAL
è<< "¡ªd g’”©Ü i NULL!" << 
¡d
::
’dl
;

46 
	}
}

48 
	gSndG’”©Ü
::~
	$SndG’”©Ü
() {

49 
	`Îog
(
INFO
è<< "SndG’”©Ü de¡royed" << 
¡d
::
’dl
;

50 
d–‘e
 
posG’
;

51 
	}
}

53 
JoštV®ues
 
	gSndG’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

54 
Odom‘ry
* 
odom‘ry
,

55 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

56 
BodyMod–
 &
bodyMod–
,

57 
b®lX
,

58 
b®lY
) {

82  
posG’
->
	`makeJošts
(
»que¡
, 
odom‘ry
, 
£nsÜs
, 
bodyMod–
, 
b®lX
, 
b®lY
);

83 
	}
}

85 
boŞ
 
	gSndG’”©Ü
::
	$isAùive
() {

86  
posG’
->
	`isAùive
();

87 
	}
}

89 
	gSndG’”©Ü
::
	$»£t
() {

90 
posG’
->
	`»£t
();

91 
	}
}

93 
	gSndG’”©Ü
::
	$¡İ
() {

94 
posG’
->
	`¡İ
();

95 
	}
}

97 
	gSndG’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

98 
posG’
->
	`»adO±iÚs
(
cÚfig
);

102 
	}
}

	@robot/motion/generator/StandGenerator.hpp

32 #´agm¨
Úû


34 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

36 şas 
	cSndG’”©Ü
 : 
G’”©Ü
 {

37 
public
:

38 
ex¶ic™
 
SndG’”©Ü
();

39 ~
SndG’”©Ü
();

40 
vœtu®
 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

41 
Odom‘ry
* 
odom‘ry
,

42 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

43 
BodyMod–
 &
bodyMod–
,

44 
b®lX
,

45 
b®lY
);

46 
vœtu®
 
boŞ
 
isAùive
();

47 
»£t
();

48 
¡İ
();

49 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

51 
	m´iv©e
:

52 
phi
;

53 
G’”©Ü
 *
	mposG’
;

	@robot/motion/generator/Walk2014Generator.cpp

44 
	~"mÙiÚ/g’”©Ü/W®k2014G’”©Ü.hµ
"

45 
	~<cm©h
>

46 
	~"uts/ªgËs.hµ
"

47 
	~"uts/body.hµ
"

48 
	~"uts/Logg”.hµ
"

49 
	~"uts/basic_m©hs.hµ
"

50 
	~"uts/¥“ch.hµ
"

51 
	~<®gÜ™hm
>

53 
	#SHIFT_PERIOD
 2.4

54 
	#SHIFT_END_PERIOD
 2.5

55 
	#KICK_STEP_HEIGHT
 0.055

56 
	#BACK_PHASE
 0.75

57 
	#MIN_KICK_PHASE
 0.3

58 
	#MAX_KICK_PHASE
 0.2

59 
	#THROUGH_PHASE
 0.3

60 
	#END_PHASE
 0.6

61 
	#TURN_THRESHOLD
 
	`DEG2RAD
(25)

62 
	#TURN_PERIOD
 0.75

63 
	#TURN_STEP_HEIGHT
 0.024

64 
	#TURN_LEAN
 
	`DEG2RAD
(20.25)

65 
	#TURN_SCALE
 1.15

66 
	#EPSILON
 0.01

67 
	#TURN_EPSILON
 0.05

68 
	#KICK_LEAN_V4
 22.1

	)

69 
	#KICK_LEAN_V5
 21.7

	)

72 
	#FOOT_AVOID_RADIUS
 75

	)

73 
	#TURN_CLIPPING
 0.10

74 
	#NINETY
 1.51

	)

75 
	#FORTY_FIVE
 1.51 / 2

	)

76 
	#TT_DEGREE
 
FORTY_FIVE
 / 2

	)

78 
usšg
 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
;

79 
usšg
 
Çme¥aû
 
	g¡d
;

80 
usšg
 
Çme¥aû
 
	gJošts
;

81 
usšg
 
Çme¥aû
 
	gS’sÜs
;

83 cÚ¡ 
	gMM_PER_M
 = 1000.0;

84 cÚ¡ 
	gCROUCH_STAND_PERIOD
 = 0.5;

85 cÚ¡ 
	gCOM_OFFSET
 = 0.01;

86 cÚ¡ 
	gFORWARD_CHANGE
 = 0.15;

87 cÚ¡ 
	gLEFT_CHANGE
 = 0.2;

88 cÚ¡ 
	gSTAND_HIP_HEIGHT
 = 0.248;

89 cÚ¡ 
	gKNEE_PITCH_RANGE
 = 
DEG2RAD
(60);

90 cÚ¡ 
	gBASE_WALK_PERIOD
 = .25;

91 cÚ¡ 
	gWALK_HIP_HEIGHT
 = .23;

92 cÚ¡ 
	gMAX_FORWARD
 = .3;

93 cÚ¡ 
	gMAX_LEFT
 = .2;

94 cÚ¡ 
	gMAX_TURN
 = .80;

95 cÚ¡ 
	gBASE_LEG_LIFT
 = 0.010;

97 
	gKICK_LEAN
 = 
KICK_LEAN_V5
;

99 
–lsoidCÏmpW®k
(&
fÜw¬d
, &
Ëá
, &
tuº
);

100 
ev®u©eW®kVŞume
(
x
, 
y
, 
z
);

102 
	$checkNaN
(
n
, 
¡ršg
 
s
) {

103 ià(
n
 !=‚) {

106 
	}
}

108 
	gW®k2014G’”©Ü
::
	$W®k2014G’”©Ü
(
BÏckbßrd
 *
bb
) :

109 
	`t
(0.0f), 
	`z
(0.0f), 
	`PI
(3.1415927), 
	$bÏckbßrd
(
bb
) {

110 
	`š™Ÿli£
();

111 
	`Îog
(
INFO
è<< "W®k2014G’”©Ü cÚ¡ruùed" << 
¡d
::
’dl
;

113 
	}
}

115 
	gW®k2014G’”©Ü
::~
	$W®k2014G’”©Ü
() {

116 
	`Îog
(
INFO
è<< "W®k2014G’”©Ü de¡royed" << 
¡d
::
’dl
;

117 
	}
}

119 
	gW®k2014G’”©Ü
::
	$š™Ÿli£
() {

120 
	`Îog
(
INFO
è<< "W®k2014 in™Ÿlizšg" << 
’dl
;

121 
dt
 = 0.01;

122 
t
 = 0.0;

123 
tim”
 = 0.0;

124 
glob®Time
 = 0;

125 
T
 = 
BASE_WALK_PERIOD
;

126 
¡İpšg
 = 
çl£
;

127 
¡İ³d
 = 
Œue
;

128 
ËáL
 = 
ËáR
 = 
Ï¡Leá
 = 
Ëá
 = 0.0;

129 
tuºRL
 = 
tuºRL0
 = 0;

130 
fÜw¬dL
 = 
fÜw¬dR
 = 0.0;

131 
fÜw¬dR0
 = 
fÜw¬dL0
 = 0;

132 
fÜw¬d
 = 
Ï¡FÜw¬d
 = 0.0;

133 
should”P™chL
 = 
should”P™chR
 = 0;

134 
should”RŞlL
 = 
should”RŞlR
 = 0;

135 
hh
 = 
hh0
 = 
STAND_HIP_HEIGHT
;

136 
foÙhL
 = 
foÙhR
 = 0;

137 
thigh
 = 
Limbs
::
ThighL’gth
 / 
MM_PER_M
;

138 
tibŸ
 = 
Limbs
::
TibŸL’gth
 / 
MM_PER_M
;

139 
ªkË
 = 
Limbs
::
FoÙHeight
 / 
MM_PER_M
;

140 
ÃxtFoÙSw™chT
 = 0.0;

141 
¡ifâess
 = 0.9;

142 
w®k2014O±iÚ
 = 
NONE
;

143 
w®kS‹
 = 
NOT_WALKING
;

144 
suµÜtFoÙhasChªged
 = 
çl£
;

145 
comOff£t
 = 0;

146 
´evTuº
 = 
´evFÜw¬dL
 = 
´evFÜw¬dR
 = 0;

147 
´evLeáL
 = 
´evLeáR
 = 0;

148 
exaùS‹psReque¡ed
 = 
çl£
;

151 
kickT
 = 0;

152 
kickPha£
 = 
MAX_KICK_PHASE
;

153 
rock
 = 0;

154 
kÃeP™chL
 = 
kÃeP™chR
 = 
Ï¡KÃeP™ch
 = 0;

155 
ªkËP™chL
 = 
ªkËP™chR
 = 0;

156 
Ï¡KickFÜw¬d
 = 0;

157 
Ï¡Side
 = 0;

158 
Ï¡KickTime
 = 
T
;

159 
dyÇmicSide
 = 0.0f;

160 
tuºAngË
 = 0;

161 
Ï¡Tuº
 = 0;

162 
Ï¡Tuº
 = 0;

163 
mÙiÚOdom‘ry
.
	`»£t
();

164 
	}
}

166 
	gÚLeá
 = 0;

167 
	gÚRight
 = 0;

168 cÚ¡ 
	gfoÙOff£t
 = 50;

169 cÚ¡ 
	gtÛOff£t
 = 40;

170 cÚ¡ 
	gtÛRadius
 = 45;

172 cÚ¡ 
	gfoÙAvoidRadius
 = 150;

173 
boŞ
 
	$š‹r£ùs
(
FoÙInfo
& 
f
, 
Pošt
& 
p
) {

174 
şo£¡X
 = 
¡d
::
	`max
(
p
.
	`x
(), std::
	`mš
(
f
.
robÙBounds
.
a
.x(), f.robÙBounds.
b
.x()));

175 
şo£¡Y
 = 
¡d
::
	`max
(
p
.
	`y
(), std::
	`mš
(
f
.
robÙBounds
.
a
.y(), f.robÙBounds.
b
.y()));

177 
di¡ªûX
 = 
p
.
	`x
(è- 
şo£¡X
;

178 
di¡ªûY
 = 
p
.
	`y
(è- 
şo£¡Y
;

180 
di¡ªûSqu¬ed
 = (
di¡ªûX
 * di¡ªûXè+ (
di¡ªûY
 * distanceY);

182  
di¡ªûSqu¬ed
 < (
tÛRadius
 *oeRadius);

183 
	}
}

185 
	gW®k2014G’”©Ü
::
	$avoidF“t
(&
fÜw¬d
, &
Ëá
, &
tuº
, 
BodyMod–
& 
bodyMod–
) {

187 
veùÜ
<
FoÙInfo
> 
boxes
 = 
	`»adFrom
(
visiÚ
, 
ã‘Boxes
);

189 
boŞ
 
ş³d
 = 
çl£
;

190 
ŞdFÜw¬d
 = 
fÜw¬d
;

191 
ŞdLeá
 = 
Ëá
;

192 ià(
fÜw¬d
 !ğ0 || 
Ëá
 !ğ0 || 
tuº
 != 0) {

193 
Pošt
 
tÛF®l
;

195 ià(
bodyMod–
.
isLeáPha£
) {

196 
tÛF®l
 = 
	`Pošt
(
fÜw¬d
 + 
tÛOff£t
, 
Ëá
 + 
foÙOff£t
);

198 
tÛF®l
 = 
	`Pošt
(
fÜw¬d
 + 
tÛOff£t
, 
Ëá
 - 
foÙOff£t
);

200 
Œue
) {

201 
boŞ
 
šBox
 = 
çl£
;

202 
veùÜ
<
FoÙInfo
>::
™”©Ü
 
™
 = 
boxes
.
	`begš
(); iˆ!ğboxes.
	`’d
(); ++it) {

203 ià(
	`š‹r£ùs
(*
™
, 
tÛF®l
)) {

204 
šBox
 = 
Œue
;

209 ià(
šBox
) {

211 
fÜw¬d
 *= 0.7;

212 
Ëá
 *= 0.7;

213 
ş³d
 = 
Œue
;

214 ià(
bodyMod–
.
isLeáPha£
) {

215 
tÛF®l
 = 
	`Pošt
(
fÜw¬d
 + 
tÛOff£t
, 
Ëá
 + 
foÙOff£t
);

217 
tÛF®l
 = 
	`Pošt
(
fÜw¬d
 + 
tÛOff£t
, 
Ëá
 - 
foÙOff£t
);

219 ià(
Ëá
 <ğ5 && 
fÜw¬d
 <= 5) {

227 ià(
ş³d
) {

228 
cout
 << "### FÜw¬d " << 
ŞdFÜw¬d
 << " -> " << 
fÜw¬d
 << " Leá " << 
ŞdLeá
 << " -> " << 
Ëá
 << 
’dl
;

229 
	`SAY
("I c Feet");

232 
	}
}

234 
	$–lsoidCÏmpW®k
(&
fÜw¬d
, &
Ëá
, &
tuº
, 
¥“d
) {

235 cÚ¡ 
MIN_SPEED
 = 0.0f;

236 cÚ¡ 
MAX_SPEED
 = 1.0f;

237 
¥“d
 = 
	`üİ
(¥“d, 
MIN_SPEED
, 
MAX_SPEED
);

240 
M_FORWARD
 = 
MAX_FORWARD
 * 0.66 + MAX_FORWARD * 0.34 * 
¥“d
;

241 
M_LEFT
 = 
MAX_LEFT
 * 0.66 + MAX_LEFT * 0.34 * 
¥“d
;

242 
M_TURN
 = 
MAX_TURN
 * 0.66 + MAX_TURN * 0.34 * 
¥“d
;

244 
şam³dFÜw¬d
 = 
	`üİ
(
fÜw¬d
, -
M_FORWARD
, M_FORWARD);

245 
şam³dLeá
 = 
	`üİ
(
Ëá
, -
M_LEFT
, M_LEFT);

246 
şam³dTuº
 = 
	`üİ
(
tuº
, -
M_TURN
, M_TURN);

249 
fÜw¬dAmouÁ
 = 
şam³dFÜw¬d
 / 
M_FORWARD
;

250 
ËáAmouÁ
 = 
şam³dLeá
 / 
M_LEFT
;

251 
tuºAmouÁ
 = 
şam³dTuº
 / 
M_TURN
;

253 
x
 = 
	`çbs
(
fÜw¬dAmouÁ
);

254 
y
 = 
	`çbs
(
ËáAmouÁ
);

255 
z
 = 
	`çbs
(
tuºAmouÁ
);

258 ià(
	`ev®u©eW®kVŞume
(
x
, 
y
, 
z
) > 1.0) {

259 
sÿË
 = 0.5;

260 
high
 = 1.0;

261 
low
 = 0.0;

264 
i
 = 0; i < 10; i++) {

266 
x
 = 
	`çbs
(
fÜw¬dAmouÁ
è* 
sÿË
;

267 
y
 = 
	`çbs
(
ËáAmouÁ
è* 
sÿË
;

269 ià(
	`ev®u©eW®kVŞume
(
x
, 
y
, 
z
) > 1.0) {

270 
ÃwSÿË
 = (
sÿË
 + 
low
) / 2.0;

271 
high
 = 
sÿË
;

272 
sÿË
 = 
ÃwSÿË
;

274 
ÃwSÿË
 = (
sÿË
 + 
high
) / 2.0;

275 
low
 = 
sÿË
;

276 
sÿË
 = 
ÃwSÿË
;

280 
fÜw¬dAmouÁ
 *ğ
sÿË
;

281 
ËáAmouÁ
 *ğ
sÿË
;

284 
fÜw¬d
 = 
M_FORWARD
 * 
fÜw¬dAmouÁ
;

285 
Ëá
 = 
M_LEFT
 * 
ËáAmouÁ
;

286 
tuº
 = 
şam³dTuº
;

287 
	}
}

290 
	$ev®u©eW®kVŞume
(
x
, 
y
, 
z
) {

292 
e
 = 1.05;

295 
n
 = 1;

297 
r
 = 2.0 / 
e
;

298 
t
 = 2.0 / 
n
;

300  
	`pow
Õow(
x
, 
r
è+…ow(
y
,„), (
t
 /„)è+…ow(
z
,);

301 
	}
}

303 
JoštV®ues
 
	gW®k2014G’”©Ü
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
, 
Odom‘ry
* 
odom‘ry
, cÚ¡ 
S’sÜV®ues
 &
£nsÜs
, 
BodyMod–
 &
bodyMod–
, 
b®lX
, 
b®lY
) {

305 ià(
w®k2014O±iÚ
 =ğ
NONE
) {

307 
hh
 = 
£nsÜs
.
jošts
.
ªgËs
[
LKÃeP™ch
] / 
KNEE_PITCH_RANGE
 * (
WALK_HIP_HEIGHT
 - 
STAND_HIP_HEIGHT
) + STAND_HIP_HEIGHT;

311 ià(
t
 =ğ0 && 
w®k2014O±iÚ
 !ğ
STEP
) {

313 
aùive
 = 
»que¡
->
body
;

314 
Ï¡FÜw¬d
 = 
fÜw¬d
;

315 
Ï¡Leá
 = 
Ëá
;

316 
fÜw¬d
 = (è
aùive
.fÜw¬d / 
MM_PER_M
;

317 
Ëá
 = (è
aùive
.Ëá / 
MM_PER_M
;

318 
tuº
 = 
aùive
.turn;

319 
pow”
 = 
aùive
.power;

320 
b’d
 = 
aùive
.bend;

321 
¥“d
 = 
aùive
.speed;

322 
foÙ
 = 
aùive
.foot;

323 
isFa¡
 = 
aùive
.isFast;

324 ià(
¡İpšg
) {

326 
¡İ³d
 = 
çl£
;

328 ià(
fÜw¬d
 =ğ0 
ªd
 
Ëá
 =ğ0‡nd 
tuº
 =ğ0‡nd 
pow”
 == 0)

329 
b’d
 = 0;

332 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i) {

333 
‹mp
 = 
£nsÜs
.
jošts
.
‹m³¿tu»s
[
i
];

334 ià(
‹mp
 > 70)

335 
¥“d
 = 
	`MIN
(0.5, speed);

336 ià(
‹mp
 > 75)

337 
¥“d
 = 0;

341 ià(!
exaùS‹psReque¡ed
) {

342 
	`–lsoidCÏmpW®k
(
fÜw¬d
, 
Ëá
, 
tuº
, 
¥“d
);

344 
f
 = 
fÜw¬d
 * 
MM_PER_M
;

345 
l
 = 
Ëá
 * 
MM_PER_M
;

346 
	`avoidF“t
(
f
, 
l
, 
tuº
, 
bodyMod–
);

347 
fÜw¬d
 = 
f
 / 
MM_PER_M
;

348 
Ëá
 = 
l
 / 
MM_PER_M
;

351 
T
 = 
BASE_WALK_PERIOD
 + 0.1 * 
	`abs
(
Ëá
è/ 
MAX_LEFT
;

354 ià(!
exaùS‹psReque¡ed
) {

355 ià(
	`abs
(
fÜw¬d
 - 
Ï¡FÜw¬d
è> 
FORWARD_CHANGE
) {

356 
fÜw¬d
 = 
Ï¡FÜw¬d
 + (fÜw¬d -†a¡FÜw¬dè/ 
	`abs
(fÜw¬d -†a¡FÜw¬dè* 
FORWARD_CHANGE
;

358 ià(
	`abs
(
Ëá
 - 
Ï¡Leá
è> 
LEFT_CHANGE
) {

359 
Ëá
 = 
Ï¡Leá
 + (Ëá -†a¡Leáè/ 
	`abs
Öeá -†a¡Leáè* 
LEFT_CHANGE
;

367 ià(!
exaùS‹psReque¡ed
) {

368 
fÜw¬d
 *ğ2 * 
T
;

369 
Ëá
 *ğ2 * 
T
;

370 
tuº
 *ğ2 * 
T
;

372 
fÜw¬d
 *= 1.0;

373 
Ëá
 *= 0.82;

374 
tuº
 *= 1.43;

376 
tuº
 *= -1;

379 
t
 +ğ
dt
;

380 
glob®Time
 +ğ
dt
;

381 
Ï¡KickTime
 +ğ
dt
;

384 ià(
»que¡
->
body
.
aùiÚTy³
 !ğ
AùiÚCommªd
::
Body
::
KICK
 && 
kickT
 > 0 &&„eque¡->body.aùiÚTy³ !ğAùiÚCommªd::Body::
REF_PICKUP
) {

386 ià(
	`ÿnAbbÜtKick
()) {

388 
kickT
 = 
BACK_PHASE
 + 
kickPha£
 + 
THROUGH_PHASE
;

390 } ià(
aùive
.
aùiÚTy³
 =ğ
AùiÚCommªd
::
Body
::
KICK
) {

394 ià(
Ï¡KickTime
 < 2 * 
T
) {

395 
»que¡
->
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
WALK
;

396 } ià(
	`abs
(
hh
 - 
WALK_HIP_HEIGHT
) < .0001) {

397 ià(
w®k2014O±iÚ
 =ğ
WALK
 || w®k2014O±iÚ =ğ
STEP
) {

399 ià(
	`çbs
(
fÜw¬dL
è< 
EPSILON
 && fabs(
ËáL
è< EPSILON && fabs(
tuºRL
è< 
TURN_EPSILON
 && 
t
 =ğ
dt
) {

404 ià(
w®k2014O±iÚ
 =ğ
WALK
 && 
	`çbs
(
aùive
.
kickDœeùiÚ
è>ğ
TURN_THRESHOLD
) {

406 
tuºAngË
 = 
	`MIN
(
	`DEG2RAD
(90), 
	`çbs
(
aùive
.
kickDœeùiÚ
)) / 2;

407 ià((
aùive
.
foÙ
 =ğ
AùiÚCommªd
::
Body
::
LEFT
 && !
bodyMod–
.
isLeáPha£
) || (active.foot != ActionCommand::Body::LEFT && bodyModel.isLeftPhase)) {

408 
w®k2014O±iÚ
 = 
STEP
;

412 } ià(
	`çbs
(
aùive
.
kickDœeùiÚ
è< 
TURN_THRESHOLD
) {

413 
	`´•Kick
(
aùive
.
foÙ
 =ğ
AùiÚCommªd
::
Body
::
LEFT
, 
bodyMod–
);

421 } ià(
w®k2014O±iÚ
 !ğ
KICK
) {

423 ià(
	`çbs
(
aùive
.
kickDœeùiÚ
è>ğ
TURN_THRESHOLD
) {

424 
tuºAngË
 = 
	`MIN
(
	`DEG2RAD
(90), 
	`çbs
(
aùive
.
kickDœeùiÚ
)) / 2;

425 
w®k2014O±iÚ
 = 
STEP
;

427 
	`´•Kick
(
aùive
.
foÙ
 =ğ
AùiÚCommªd
::
Body
::
LEFT
, 
bodyMod–
);

431 ià(
w®k2014O±iÚ
 !ğ
CROUCH
) {

432 
hh0
 = 
hh
;

433 
tim”
 = 0;

435 
w®k2014O±iÚ
 = 
CROUCH
;

439 ià(
w®k2014O±iÚ
 =ğ
WALK
 
ªd
 
w®kS‹
 !ğ
NOT_WALKING
) {

440 ià(
fÜw¬d
 =ğ0 
ªd
 
Ëá
 =ğ0‡nd 
tuº
 == 0) {

441 
w®kS‹
 = 
STOPPING
;

443 } ià(
b’d
 == 0) {

444 ià(
	`abs
(
hh
 - 
STAND_HIP_HEIGHT
) < .0001) {

445 
w®k2014O±iÚ
 = 
STAND
;

447 ià(
w®k2014O±iÚ
 !ğ
STANDUP
) {

448 
hh0
 = 
hh
;

449 
tim”
 = 0;

451 
w®k2014O±iÚ
 = 
STANDUP
;

453 } ià(
fÜw¬d
 =ğ0 
ªd
 
Ëá
 =ğ0‡nd 
tuº
 =ğ0‡nd 
b’d
 == 1) {

454 ià(
	`abs
(
hh
 - 
WALK_HIP_HEIGHT
) < .0001) {

455 
w®k2014O±iÚ
 = 
READY
;

457 ià(
w®k2014O±iÚ
 !ğ
CROUCH
) {

458 
hh0
 = 
hh
;

459 
tim”
 = 0;

461 
w®k2014O±iÚ
 = 
CROUCH
;

464 ià(
	`abs
(
hh
 - 
WALK_HIP_HEIGHT
) < .0001) {

465 ià(
w®k2014O±iÚ
 !ğ
WALK
) {

467 
w®kS‹
 = 
STARTING
;

468 
ÃxtFoÙSw™chT
 = 
T
;

470 
w®k2014O±iÚ
 = 
WALK
;

472 ià(
w®k2014O±iÚ
 !ğ
CROUCH
) {

473 
hh0
 = 
hh
;

474 
tim”
 = 0;

476 
w®k2014O±iÚ
 = 
CROUCH
;

481 ià(
w®k2014O±iÚ
 =ğ
STAND
) {

482 
hh
 = 
STAND_HIP_HEIGHT
;

483 
fÜw¬d
 = 
Ëá
 = 
tuº
 = 0;

484 
t
 = 
ÃxtFoÙSw™chT
 = 0;

485 
¡ifâess
 = 
pow”
;

486 ià(
¡ifâess
 < 0.2)

487 
¡ifâess
 = 0.2;

488 
comOff£t
 = 0;

489 } ià(
w®k2014O±iÚ
 =ğ
STANDUP
) {

490 
hh
 = 
hh0
 + (
STAND_HIP_HEIGHT
 - hh0è* 
	`·¿bŞicS‹p
(
tim”
, 
CROUCH_STAND_PERIOD
, 0);

491 
fÜw¬d
 = 
Ëá
 = 
tuº
 = 0;

492 
comOff£t
 -= 0.02 * comOffset;

493 
¡ifâess
 = 1;

494 
t
 = 
ÃxtFoÙSw™chT
 = 0;

495 
tim”
 +ğ
dt
;

496 } ià(
w®k2014O±iÚ
 =ğ
CROUCH
) {

497 
fÜw¬d
 = 
Ëá
 = 
tuº
 = 0;

498 
¡ifâess
 = 1;

499 
hh
 = 
hh0
 + (
WALK_HIP_HEIGHT
 - hh0è* 
	`·¿bŞicS‹p
(
tim”
, 
CROUCH_STAND_PERIOD
, 0);

500 
comOff£t
 = 
COM_OFFSET
 * 
	`·¿bŞicS‹p
(
tim”
, 
CROUCH_STAND_PERIOD
, 0);

501 
t
 = 
ÃxtFoÙSw™chT
 = 0;

502 
tim”
 +ğ
dt
;

503 } ià(
w®k2014O±iÚ
 =ğ
WALK
) {

504 
¡ifâess
 = 1;

505 } ià(
w®k2014O±iÚ
 =ğ
KICK
) {

506 
¡ifâess
 = 1;

507 } ià(
w®k2014O±iÚ
 =ğ
STEP
) {

508 
¡ifâess
 = 1;

509 
ÃxtFoÙSw™chT
 = 
TURN_PERIOD
;

511 ià(
w®k2014O±iÚ
 =ğ
READY
) {

512 
fÜw¬d
 = 
Ëá
 = 
tuº
 = 0;

513 
¡ifâess
 = 
pow”
;

514 ià(
¡ifâess
 < 0.4)

515 
¡ifâess
 = 0.4;

516 
t
 = 
ÃxtFoÙSw™chT
 = 0;

520 ià(
w®k2014O±iÚ
 =ğ
WALK
 
ªd
 
ÃxtFoÙSw™chT
 > 0) {

522 
maxFoÙHeight
 = 
BASE_LEG_LIFT
 + 
	`abs
(
fÜw¬d
è* 0.01 +‡bs(
Ëá
) * 0.02;

523 
v¬foÙHeight
 = 
maxFoÙHeight
 * 
	`·¿bŞicR‘uº
(
t
 / 
ÃxtFoÙSw™chT
);

527 ià(
bodyMod–
.
isLeáPha£
) {

528 ià(
weightHasShiáed
) {

530 
fÜw¬dR
 = 
fÜw¬dR0
 + ((
fÜw¬d
è/ 4 - fÜw¬dR0è* 
	`lš—rS‹p
(
t
, 
ÃxtFoÙSw™chT
);

531 
fÜw¬dL
 = 
fÜw¬dL0
 + 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0è* (-(
fÜw¬d
) / 4 - forwardL0);

534 ià(
Ëá
 > 0) {

535 
ËáR
 = 
	`ËáAngË
() / 2;

537 ià(
Ï¡Leá
 * 
Ëá
 < 0)

538 
ËáR
 -ğ
swšgAngË
 * (1 - 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.1));

539 
ËáL
 = -
ËáR
;

541 
ËáL
 = 
swšgAngË
 * (1 - 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.0));

542 
ËáR
 = -
ËáL
;

545 ià(
tuº
 < 0)

546 
tuºRL
 = 
tuºRL0
 + (-.67 * 
tuº
 -uºRL0è* 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.0);

548 
tuºRL
 = 
tuºRL0
 + (-.33 * 
tuº
 -uºRL0è* 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.0);

551 
foÙhL
 = 
v¬foÙHeight
;

552 
foÙhR
 = 0;

555 ià(
nÙ
 
bodyMod–
.
isLeáPha£
) {

556 ià(
weightHasShiáed
) {

558 
fÜw¬dL
 = 
fÜw¬dL0
 + ((
fÜw¬d
è/ 4 - fÜw¬dL0è* 
	`lš—rS‹p
(
t
, 
ÃxtFoÙSw™chT
);

559 
fÜw¬dR
 = 
fÜw¬dR0
 + 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0è* (-(
fÜw¬d
) / 4 - forwardR0);

563 ià(
Ëá
 < 0) {

564 
ËáL
 = 
	`ËáAngË
() / 2;

566 ià(
Ï¡Leá
 * 
Ëá
 < 0)

567 
ËáL
 -ğ
swšgAngË
 * (1 - 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.1));

568 
ËáR
 = -
ËáL
;

570 
ËáR
 = 
swšgAngË
 * (1 - 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.0));

571 
ËáL
 = -
ËáR
;

574 ià(
tuº
 < 0)

575 
tuºRL
 = 
tuºRL0
 + (.33 * 
tuº
 -uºRL0è* 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.0);

577 
tuºRL
 = 
tuºRL0
 + (.67 * 
tuº
 -uºRL0è* 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.0);

580 
foÙhR
 = 
v¬foÙHeight
;

581 
foÙhL
 = 0;

584 ià(
w®kS‹
 =ğ
STARTING
) {

585 
tuºRL
 = 0;

586 
foÙhL
 /= 3.5;

587 
foÙhR
 /= 3.5;

588 
ËáR
 = 
ËáL
 = 0;

589 
fÜw¬dL
 = 
fÜw¬dR
 = 0;

592 
should”P™chR
 = -
fÜw¬dR
 * 6;

593 
should”P™chL
 = -
fÜw¬dL
 * 6;

594 } ià(
w®k2014O±iÚ
 =ğ
KICK
) {

595 ià(
aùive
.
foÙ
 =ğ
AùiÚCommªd
::
Body
::
LEFT
) {

596 
	`makeFÜw¬dKickJošts
(
KICK_LEAN
, 
KICK_STEP_HEIGHT
, 
SHIFT_PERIOD
, 
foÙhL
, 
fÜw¬dL
, 
ËáL
, 
kÃeP™chL
, 
should”RŞlL
, 
ªkËP™chL
, 
b®lY
, 
»que¡
);

597 
ËáR
 = 
ËáL
 * 0.1;

599 
	`makeFÜw¬dKickJošts
(-
KICK_LEAN
 + 1.5, 
KICK_STEP_HEIGHT
 + 0.005, 
SHIFT_PERIOD
, 
foÙhR
, 
fÜw¬dR
, 
ËáR
, 
kÃeP™chR
, 
should”RŞlR
, 
ªkËP™chR
, 
b®lY
, 
»que¡
);

600 
ËáR
 = -leftR;

601 
ËáL
 = 
ËáR
 * 0.12;

603 } ià(
w®k2014O±iÚ
 =ğ
STEP
) {

604 
foÙHeight
 = 
TURN_STEP_HEIGHT
 * 
	`·¿bŞicR‘uº
(
t
 / 
ÃxtFoÙSw™chT
);

605 ià(
aùive
.
foÙ
 !ğ
AùiÚCommªd
::
Body
::
LEFT
) {

606 
foÙhL
 = 
foÙHeight
;

607 
foÙhR
 = 0;

608 
rock
 = 
TURN_LEAN
 * 
	`·¿bŞicR‘uº
(
t
 / 
ÃxtFoÙSw™chT
);

610 
foÙhR
 = 
foÙHeight
;

611 
foÙhL
 = 0;

612 
rock
 = -
TURN_LEAN
 * 
	`·¿bŞicR‘uº
(
t
 / 
ÃxtFoÙSw™chT
);

615 
tuºRL
 = 
tuºAngË
 * 
TURN_SCALE
 * 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.15);

617 ià(
t
 >ğ
ÃxtFoÙSw™chT
 - 
dt
) {

618 ià(
aùive
.
kickDœeùiÚ
 >ğ
TURN_THRESHOLD
) {

619 
aùive
.
kickDœeùiÚ
 -ğ(
tuºAngË
 * 2);

620 } ià(
aùive
.
kickDœeùiÚ
 <ğ-
TURN_THRESHOLD
) {

621 
aùive
.
kickDœeùiÚ
 +ğ(
tuºAngË
 * 2);

624 
Ï¡Tuº
 = 
tuºRL
;

626 
foÙhL
 = 
foÙhR
 = 0;

633 ià((
t
 > 0.75 * 
T
 
ªd
 
bodyMod–
.
ZMPL
 * bodyMod–.
Ï¡ZMPL
 < 0è
Ü
 > 3 * T)

634 
suµÜtFoÙhasChªged
 = 
Œue
;

635 ià(
suµÜtFoÙhasChªged
) {

636 
weightHasShiáed
 = (
bodyMod–
.
isLeáPha£
 !ğ(bodyMod–.
ZMPL
 < 0));

637 
bodyMod–
.
	`£tIsLeáPha£
(bodyMod–.
ZMPL
 < 0);

639 ià(
suµÜtFoÙhasChªged
 
ªd
 
w®k2014O±iÚ
 =ğ
WALK
) {

640 
suµÜtFoÙhasChªged
 = 
çl£
;

642 ià(
bodyMod–
.
isLeáPha£
)

643 
swšgAngË
 = 
ËáL
;

645 
swšgAngË
 = 
ËáR
;

647 ià(
w®kS‹
 =ğ
NOT_WALKING
) {

648 
ÃxtFoÙSw™chT
 = 
T
;

649 
w®kS‹
 = 
STARTING
;

650 } ià(
w®kS‹
 =ğ
STARTING
) {

651 
ÃxtFoÙSw™chT
 = 
T
;

652 
w®kS‹
 = 
WALKING
;

653 } ià(
w®kS‹
 =ğ
WALKING
) {

654 
ÃxtFoÙSw™chT
 = 
T
;

655 
w®kS‹
 = 
WALKING
;

656 } ià(
w®kS‹
 =ğ
STOPPING
) {

657 
ÃxtFoÙSw™chT
 = 
T
;

658 
w®kS‹
 = 
NOT_WALKING
;

660 
cout
 << "Should‚ev” g‘ h”e: w®kS‹ƒ¼Ü" << 
’dl
;

662 
t
 = 0;

664 
tuºRL0
 = 
tuºRL
;

665 
fÜw¬dR0
 = 
fÜw¬dR
;

666 
fÜw¬dL0
 = 
fÜw¬dL
;

672 
f‹»dGyroY
 = 0.8 * f‹»dGyroY + 0.2 * 
£nsÜs
.£nsÜs[
IÃ¹ŸlS’sÜ_GyrY
];

673 
b®ªûAdju¡m’t
 = 
f‹»dGyroY
 / 25;

674 ià(
w®k2014O±iÚ
 =ğ
READY
)

675 
b®ªûAdju¡m’t
 = 0;

678 
f‹»dGyroX
 = 0.8 * f‹»dGyroX + 0.2 * 
£nsÜs
.£nsÜs[
IÃ¹ŸlS’sÜ_GyrX
];

679 
cÜÚ®B®ªûAdju¡m’t
 = 
f‹»dGyroX
 / 25;

682 *
odom‘ry
 = *odom‘ry + 
mÙiÚOdom‘ry
.
	`upd©eOdom‘ry
(
£nsÜs
, upd©eOdom‘ry(
bodyMod–
.
isLeáPha£
));

690 
ËghL
 = 
hh
 - 
foÙhL
 - 
ªkË
;

691 
ËgX0L
 = 
ËghL
 / 
	`cos
(
ËáL
);

692 
ËgXL
 = 
	`sq¹
(
ËgX0L
 *†egX0L + (
fÜw¬dL
 + 
comOff£t
) * (forwardL + comOffset));

693 
b‘a1L
 = 
	`acos
((
thigh
 *high + 
ËgXL
 *†egXL - 
tibŸ
 *ibia) / (2.0f *high *†egXL));

694 
b‘a2L
 = 
	`acos
((
tibŸ
 *ibŸ + 
ËgXL
 *†egXL - 
thigh
 *high) / (2.0f *ibia *†egXL));

695 
‹mpL
 = 
ËgX0L
 / 
ËgXL
;

696 ià(
‹mpL
 > 1.0f)

697 
‹mpL
 = 1.0f;

698 
d–L
 = 
	`asš
(
‹mpL
);

699 
dœL
 = 1.0f;

700 ià((
fÜw¬dL
 + 
comOff£t
) > 0.0f)

701 
dœL
 = -1.0f;

702 
HpL
 = 
b‘a1L
 + 
dœL
 * (
M_PI
 / 2.0à- 
d–L
);

703 
ApL
 = 
b‘a2L
 + 
dœL
 * (
d–L
 - 
M_PI
 / 2.0f);

704 
KpL
 = 
HpL
 + 
ApL
;

707 
ËghR
 = 
hh
 - 
foÙhR
 - 
ªkË
;

708 
ËgX0R
 = 
ËghR
 / 
	`cos
(
ËáR
);

709 
ËgXR
 = 
	`sq¹
(
ËgX0R
 *†egX0R + (
fÜw¬dR
 + 
comOff£t
) * (forwardR + comOffset));

710 
dœR
 = 1.0f;

711 ià((
fÜw¬dR
 + 
comOff£t
) > 0.0f)

712 
dœR
 = -1.0f;

713 
b‘a1R
 = 
	`acos
((
thigh
 *high + 
ËgXR
 *†egXR - 
tibŸ
 *ibia) / (2.0f *high *†egXR));

714 
b‘a2R
 = 
	`acos
((
tibŸ
 *ibŸ + 
ËgXR
 *†egXR - 
thigh
 *high) / (2.0f *ibia *†egXR));

715 
‹mpR
 = 
ËgX0R
 / 
ËgXR
;

716 ià(
‹mpR
 > 1.0f)

717 
‹mpR
 = 1.0f;

718 
d–R
 = 
	`asš
(
‹mpR
);

719 
HpR
 = 
b‘a1R
 + 
dœR
 * (
M_PI
 / 2.0à- 
d–R
);

720 
ApR
 = 
b‘a2R
 + 
dœR
 * (
d–R
 - 
M_PI
 / 2.0f);

721 
KpR
 = 
HpR
 + 
ApR
;

724 
HrL
 = -
ËáL
;

725 
HrR
 = -
ËáR
;

726 
ArL
 = -
HrL
;

727 
ArR
 = -
HrR
;

728 ià(
w®k2014O±iÚ
 =ğ
KICK
 || w®k2014O±iÚ =ğ
STEP
) {

729 
HrL
 +ğ
rock
;

730 
HrR
 +ğ
rock
;

731 
ArL
 -ğ
rock
;

732 
ArR
 -ğ
rock
;

737 
XYZ_CoÜd
 
tL
 = 
	`mf2b
(
z
, -
HpL
, 
HrL
, 
KpL
, -
ApL
, 
ArL
, z, z, z);

738 
XYZ_CoÜd
 
sL
;

739 
Hyp
 = -
tuºRL
;

740 
i
 = 0; i < 3; i++) {

741 
sL
 = 
	`mf2b
(
Hyp
, -
HpL
, 
HrL
, 
KpL
, -
ApL
, 
ArL
, 
z
, z, z);

742 
XYZ_CoÜd
 
	`e
((
tL
.
x
 - 
sL
.x), (tL.
y
 - sL.y), (tL.
z
 - sL.z));

743 
H´
 
h´
 = 
	`hAngËs
(
Hyp
, -
HpL
, 
HrL
, 
KpL
, -
ApL
, 
ArL
, 
z
, z, z, 
e
);

744 
HpL
 -ğ
h´
.
Hp
;

745 
HrL
 +ğ
h´
.
Hr
;

748 
XYZ_CoÜd
 
up
 = 
	`mf2b
(
Hyp
, -
HpL
, 
HrL
, 
KpL
, -
ApL
, 
ArL
, 1.0f, 0.0f, 0.0f);

749 
XYZ_CoÜd
 
ur
 = 
	`mf2b
(
Hyp
, -
HpL
, 
HrL
, 
KpL
, -
ApL
, 
ArL
, 0.0f, 1.0f, 0.0f);

750 
ApL
 = ApL + 
	`asš
(
sL
.
z
 - 
up
.z);

751 
ArL
 = ArL + 
	`asš
(
sL
.
z
 - 
ur
.z);

755 
Hr
 = -
HrR
;

756 
Ar
 = -
ArR
;

758 
XYZ_CoÜd
 
t
 = 
	`mf2b
(
z
, -
HpR
, 
Hr
, 
KpR
, -
ApR
, 
Ar
, z, z, z);

759 
XYZ_CoÜd
 
s
;

760 
Hyp
 = -
tuºRL
;

761 
i
 = 0; i < 3; i++) {

762 
s
 = 
	`mf2b
(
Hyp
, -
HpR
, 
Hr
, 
KpR
, -
ApR
, 
Ar
, 
z
, z, z);

763 
XYZ_CoÜd
 
	`e
((
t
.
x
 - 
s
.x), (t.
y
 - s.y), (t.
z
 - s.z));

764 
H´
 
h´
 = 
	`hAngËs
(
Hyp
, -
HpR
, 
Hr
, 
KpR
, -
ApR
, 
Ar
, 
z
, z, z, 
e
);

765 
HpR
 -ğ
h´
.
Hp
;

766 
Hr
 +ğ
h´
.Hr;

769 
XYZ_CoÜd
 
u1
 = 
	`mf2b
(
Hyp
, -
HpR
, 
Hr
, 
KpR
, -
ApR
, 
Ar
, 1.0f, 0.0f, 0.0f);

770 
XYZ_CoÜd
 
u2
 = 
	`mf2b
(
Hyp
, -
HpR
, 
Hr
, 
KpR
, -
ApR
, 
Ar
, 0.0f, 1.0f, 0.0f);

771 
ApR
 = ApR + 
	`asš
(
s
.
z
 - 
u1
.z);

772 
Ar
 = A¸+ 
	`asš
(
s
.
z
 - 
u2
.z);

774 
HrR
 = -
Hr
;

775 
ArR
 = -
Ar
;

778 
JoštV®ues
 
j
 = 
£nsÜs
.
jošts
;

779 
ušt8_t
 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i)

780 
j
.
¡ifâes£s
[
i
] = 
¡ifâess
;

783 
j
.
ªgËs
[
LShould”P™ch
] = 
	`DEG2RAD
(90è+ 
should”P™chL
;

784 
j
.
ªgËs
[
LShould”RŞl
] = 
	`DEG2RAD
(7è+ 
should”RŞlL
;

785 
j
.
ªgËs
[
LElbowYaw
] = 
	`DEG2RAD
(0);

786 
j
.
ªgËs
[
LElbowRŞl
] = 
	`DEG2RAD
(0);

787 
j
.
ªgËs
[
LWri¡Yaw
] = 
	`DEG2RAD
(0);

788 
j
.
ªgËs
[
RShould”P™ch
] = 
	`DEG2RAD
(90è+ 
should”P™chR
;

789 
j
.
ªgËs
[
RShould”RŞl
] = 
	`DEG2RAD
(-7è- 
should”RŞlR
;

790 
j
.
ªgËs
[
RElbowYaw
] = 
	`DEG2RAD
(0);

791 
j
.
ªgËs
[
RElbowRŞl
] = 
	`DEG2RAD
(0);

792 
j
.
ªgËs
[
RWri¡Yaw
] = 
	`DEG2RAD
(0);

794 
¬mStifâess
 = 0.1f;

795 
j
.
¡ifâes£s
[
Jošts
::
LShould”P™ch
] = 
¬mStifâess
;

796 
j
.
¡ifâes£s
[
Jošts
::
LShould”RŞl
] = 
¬mStifâess
;

797 
j
.
¡ifâes£s
[
Jošts
::
LElbowYaw
] = 
¬mStifâess
;

798 
j
.
¡ifâes£s
[
Jošts
::
LElbowRŞl
] = 
¬mStifâess
;

799 
j
.
¡ifâes£s
[
Jošts
::
LWri¡Yaw
] = 
¬mStifâess
;

800 
j
.
¡ifâes£s
[
Jošts
::
RShould”P™ch
] = 
¬mStifâess
;

801 
j
.
¡ifâes£s
[
Jošts
::
RShould”RŞl
] = 
¬mStifâess
;

802 
j
.
¡ifâes£s
[
Jošts
::
RElbowYaw
] = 
¬mStifâess
;

803 
j
.
¡ifâes£s
[
Jošts
::
RElbowRŞl
] = 
¬mStifâess
;

804 
j
.
¡ifâes£s
[
Jošts
::
RWri¡Yaw
] = 
¬mStifâess
;

807 
j
.
ªgËs
[
Jošts
::
LHYawP™ch
] = -
tuºRL
;

810 
j
.
ªgËs
[
Jošts
::
LHP™ch
] = -
HpL
;

811 
j
.
ªgËs
[
Jošts
::
RHP™ch
] = -
HpR
;

812 
j
.
ªgËs
[
Jošts
::
LKÃeP™ch
] = 
KpL
;

813 
j
.
ªgËs
[
Jošts
::
RKÃeP™ch
] = 
KpR
;

815 
j
.
ªgËs
[
Jošts
::
LAnkËP™ch
] = -
ApL
;

816 
j
.
ªgËs
[
Jošts
::
RAnkËP™ch
] = -
ApR
;

817 ià(
w®k2014O±iÚ
 =ğ
WALK
 
ªd
 
ÃxtFoÙSw™chT
 > 0) {

818 ià(
bodyMod–
.
isLeáPha£
)

819 
j
.
ªgËs
[
Jošts
::
RAnkËP™ch
] +ğ
b®ªûAdju¡m’t
;

821 
j
.
ªgËs
[
Jošts
::
LAnkËP™ch
] +ğ
b®ªûAdju¡m’t
;

822 } ià(
w®k2014O±iÚ
 =ğ
KICK
) {

823 ià(
bodyMod–
.
isLeáPha£
)

824 
j
.
ªgËs
[
Jošts
::
LAnkËP™ch
] +ğ
b®ªûAdju¡m’t
;

826 
j
.
ªgËs
[
Jošts
::
RAnkËP™ch
] +ğ
b®ªûAdju¡m’t
;

828 
j
.
ªgËs
[
Jošts
::
RAnkËP™ch
] +ğ
b®ªûAdju¡m’t
;

829 
j
.
ªgËs
[
Jošts
::
LAnkËP™ch
] +ğ
b®ªûAdju¡m’t
;

833 
j
.
ªgËs
[
Jošts
::
LHRŞl
] = 
HrL
;

834 
j
.
ªgËs
[
Jošts
::
RHRŞl
] = 
HrR
;

835 
j
.
ªgËs
[
Jošts
::
LAnkËRŞl
] = 
ArL
;

836 
j
.
ªgËs
[
Jošts
::
RAnkËRŞl
] = 
ArR
;

839 ià(
w®k2014O±iÚ
 =ğ
KICK
) {

840 
	`addKickJošts
(
j
);

842 ià(
bodyMod–
.
isLeáPha£
)

843 
j
.
ªgËs
[
Jošts
::
RAnkËRŞl
] +ğ
cÜÚ®B®ªûAdju¡m’t
;

845 
j
.
ªgËs
[
Jošts
::
LAnkËRŞl
] +ğ
cÜÚ®B®ªûAdju¡m’t
;

849 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; i++) {

850 
	`checkNaN
(
j
.
ªgËs
[
i
], 
Jošts
::
æ™eJoštNames
[i]);

853  
j
;

854 
	}
}

856 
	gW®k2014G’”©Ü
::
	$w®kKick
(
b®lX
, 
BodyMod–
 &
bodyMod–
) {

858 
d–
 = 0.05;

859 
b®lDi¡X
 = 
b®lX
 / 
MM_PER_M
;

860 ià(
AùiÚCommªd
::
Body
::
LEFT
) {

862 ià(
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 + 
fÜw¬dL0
è< 
fÜw¬d
) {

863 
fÜw¬d
 = (
b®lDi¡X
 - 
d–
 - 
fÜw¬dL0
) / 2;

866 ià(!
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 - 
fÜw¬dR0
è< 
fÜw¬d
 / 2) {

867 
fÜw¬d
 = 
b®lDi¡X
 - 
d–
 - 
fÜw¬dR0
;

870 ià(
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 + 
fÜw¬dL0
) < delta)

871 
fÜw¬d
 = 
	`abs
(
pow”
è* 
MAX_FORWARD
;

872 ià(!
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 - 
fÜw¬dR0
) < delta)

873 
fÜw¬d
 = 
	`abs
(
pow”
è* 
MAX_FORWARD
;

876 ià(
AùiÚCommªd
::
Body
::
RIGHT
) {

878 ià(!
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 + 
fÜw¬dR0
è< 
fÜw¬d
) {

879 
fÜw¬d
 = (
b®lDi¡X
 - 
d–
 - 
fÜw¬dR0
) / 2;

882 ià(
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 - 
fÜw¬dL0
è< 
fÜw¬d
 / 2) {

883 
fÜw¬d
 = 
b®lDi¡X
 - 
d–
 - 
fÜw¬dL0
;

886 ià(!
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 + 
fÜw¬dR0
) < delta)

887 
fÜw¬d
 = 
	`abs
(
pow”
è* 
MAX_FORWARD
;

888 ià(
bodyMod–
.
isLeáPha£
 
	`ªd
 (
b®lDi¡X
 - 
d–
 - 
fÜw¬dL0
) < delta)

889 
fÜw¬d
 = 
	`abs
(
pow”
è* 
MAX_FORWARD
;

892 ià(
fÜw¬d
 > 
MAX_FORWARD
)

893 
fÜw¬d
 = 
MAX_FORWARD
;

894 ià(
fÜw¬d
 > 
MAX_FORWARD
)

895 
fÜw¬d
 = 
MAX_FORWARD
;

897 
	}
}

899 
	gW®k2014G’”©Ü
::
	$´•Kick
(
boŞ
 
isLeá
, 
BodyMod–
 &
bodyMod–
) {

900 
t
 = 0;

901 
w®k2014O±iÚ
 = 
KICK
;

902 
tuºAngË
 = 0;

903 
kickT
 = 0;

904 ià(
isLeá
) {

905 
Ï¡KickFÜw¬d
 = 
fÜw¬dL
;

906 
Ï¡KÃeP™ch
 = 
kÃeP™chL
;

907 
Ï¡Side
 = 
ËáL
;

908 
bodyMod–
.
	`£tIsLeáPha£
(
Œue
);

909 
fÜw¬dR
 = 0;

910 
foÙhR
 = 0;

912 
Ï¡KickFÜw¬d
 = 
fÜw¬dR
;

913 
Ï¡KÃeP™ch
 = 
kÃeP™chR
;

914 
Ï¡Side
 = -
ËáR
;

915 
bodyMod–
.
	`£tIsLeáPha£
(
çl£
);

916 
fÜw¬dL
 = 0;

917 
foÙhL
 = 0;

919 
	}
}

922 
boŞ
 
	gW®k2014G’”©Ü
::
	$ÿnAbbÜtKick
() {

923 
tÙ®Shiá
 = 
SHIFT_PERIOD
 / 4;

924 
h®fShiá
 = 
tÙ®Shiá
 / 2;

925 
·u£Time
 = (
BACK_PHASE
 - 
tÙ®Shiá
) / 2;

926  
kickT
 - 
·u£Time
 < 
h®fShiá
 || (kickT >ğ
tÙ®Shiá
 +…au£Tim&& kickT < 
BACK_PHASE
);

927 
	}
}

929 
	gW®k2014G’”©Ü
::
	$makeFÜw¬dKickJošts
(
kickL—n
, 
kickS‹pH
, 
shiáP”iod
, &
foÙh
, &
fÜw¬dDi¡
, &
side
, &
kÃeP™ch
,

930 &
should”RŞl
, &
ªkËP™ch
, &
b®lY
, 
AùiÚCommªd
::
AÎ
* 
»que¡
) {

932 
kickT
 +ğ
dt
;

933 
kickPha£
 = 
MAX_KICK_PHASE
;

934 
tÙ®Pha£
 = 
BACK_PHASE
 + 
kickPha£
 + 
THROUGH_PHASE
 + 
END_PHASE
;

937 ià(
»que¡
->
body
.
mi§ligÃdKick
) {

938 
dyÇmicSide
 = 0;

939 } ià(
kickT
 < 
BACK_PHASE
 * 0.8) {

940 
dyÇmicSide
 = 
	`çbs
(
b®lY
) - 40;

943 
sideAmp
 = -
	`MAX
(0, 
	`MIN
(50, 
dyÇmicSide
)) / 200.0;

944 
kickAmp
 = -0.07;

945 
kickPow”
;

946 ià(
v4
) {

947 
kickPow”
 = 
	`pow
(
pow”
, 1.5);

949 
kickPow”
 = 
	`pow
(
pow”
, 1.7);

951 
kickBackAmp
 = -
kickAmp
 * 
kickPow”
 * 0.9;

952 
should”RŞlAmp
 = -
sideAmp
 / 2.5;

954 
kÃeP™chAmp
 = 
	`DEG2RAD
(35);

955 
ªkËP™chAmp
 = 
	`DEG2RAD
(35);

956 
ªkËP™chR‘¿ùed
 = 
	`DEG2RAD
(5);

957 ià(!
v4
) {

958 
kickS‹pH
 += 0.01;

961 ià(
Ï¡Tuº
 > 0) {

962 
shiáP”iod
 = 3.5;

966 ià(
kickT
 < 
BACK_PHASE
) {

967 
tÙ®Shiá
 = 
shiáP”iod
 / 4;

968 
h®fShiá
 = 
tÙ®Shiá
 / 2;

969 
·u£Time
 = (
BACK_PHASE
 - 
tÙ®Shiá
) / 2;

971 ià(
t
 >ğ
·u£Time
) {

972 
t2
 = 
t
 - 
·u£Time
;

974 ià(
t2
 < 
tÙ®Shiá
) {

975 
rock
 = 
	`DEG2RAD
(
kickL—n
è* 
	`·¿bŞicS‹p
(
t2
, 
tÙ®Shiá
, 0);

977 ià(
Ï¡Tuº
 > 0) {

978 ià(
t2
 >ğ
h®fShiá
) {

979 
tuºRL
 = 
Ï¡Tuº
 * (1 - 
	`·¿bŞicS‹p
(
t2
 - 
h®fShiá
, halfShift, 0.0));

981 
tuºRL
 = 
Ï¡Tuº
;

984 
rock
 +ğ
	`DEG2RAD
(
kickL—n
è/ 3.5 * 
	`·¿bŞicR‘uº
(
t2
 / 
tÙ®Shiá
);

987 
tuºRL
 = 0;

988 
Ï¡Tuº
 = 0;

992 ià(
t2
 >ğ
tÙ®Shiá
 / 3) {

993 
t3
 = 
t2
 - 
tÙ®Shiá
 / 3;

994 
’dT
 = 
BACK_PHASE
 - 
tÙ®Shiá
 / 3 - 
·u£Time
;

995 
foÙh
 = 
kickS‹pH
 * 
	`·¿bŞicS‹p
(
t3
, 
’dT
, 0);

999 ià(
kickT
 - 
·u£Time
 >ğ
h®fShiá
) {

1000 
kickT2
 = 
kickT
 - 
h®fShiá
 - 
·u£Time
;

1001 
’dT
 = 
BACK_PHASE
 - 
h®fShiá
 - 
·u£Time
;

1002 
fÜw¬dDi¡
 = 
	`š‹½Ş©eSmoÙh
(0, 
kickBackAmp
, 
kickT2
, 
’dT
);

1003 
side
 = 
	`š‹½Ş©eSmoÙh
(0, 
sideAmp
, 
kickT2
, 
’dT
);

1004 
should”RŞl
 = 
	`š‹½Ş©eSmoÙh
(0, 
should”RŞlAmp
, 
kickT2
, 
’dT
);

1005 
kÃeP™ch
 = 
	`š‹½Ş©eSmoÙh
(0, 
kÃeP™chAmp
 * 0.9, 
kickT2
, 
’dT
);

1006 
ªkËP™ch
 = 
	`š‹½Ş©eSmoÙh
(0, 
ªkËP™chR‘¿ùed
, 
kickT2
, 
’dT
);

1010 } ià(
kickT
 < (
BACK_PHASE
 + 
kickPha£
)) {

1011 
fÜw¬dDi¡
 = 
	`š‹½Ş©eSmoÙh
(
kickBackAmp
, 
kickAmp
, 
kickT
 - 
BACK_PHASE
, 
kickPha£
);

1012 
side
 = 
sideAmp
;

1013 
should”RŞl
 = 
should”RŞlAmp
;

1014 
kÃeP™ch
 = 
	`š‹½Ş©eSmoÙh
(
kÃeP™chAmp
 * 0.9, -kÃeP™chAmp, 
kickT
 - 
BACK_PHASE
, 
kickPha£
);

1015 ià(
kickT
 >ğ
BACK_PHASE
) {

1016 
ªkËP™ch
 = 
	`š‹½Ş©eSmoÙh
(
ªkËP™chR‘¿ùed
, 
ªkËP™chAmp
, 
kickT
 - 
BACK_PHASE
, 
kickPha£
);

1019 } ià(
kickT
 < (
BACK_PHASE
 + 
kickPha£
 + 
THROUGH_PHASE
)) {

1020 
fÜw¬dDi¡
 = 
kickAmp
;

1021 
side
 = 
sideAmp
;

1022 
should”RŞl
 = 
should”RŞlAmp
;

1023 
kÃeP™ch
 = -
kÃeP™chAmp
;

1024 
ªkËP™ch
 = 
ªkËP™chAmp
;

1026 } ià(
kickT
 < (
BACK_PHASE
 + 
kickPha£
 + 
THROUGH_PHASE
 + 
END_PHASE
)) {

1027 
fÜw¬dDi¡
 = 
	`š‹½Ş©eSmoÙh
(
Ï¡KickFÜw¬d
, 0, 
kickT
 - 
BACK_PHASE
 - 
kickPha£
 - 
THROUGH_PHASE
, 
END_PHASE
);

1028 
side
 = 
	`š‹½Ş©eSmoÙh
(
Ï¡Side
, 0, 
kickT
 - 
BACK_PHASE
 - 
kickPha£
 - 
THROUGH_PHASE
, 
END_PHASE
);

1029 
should”RŞl
 = 
	`š‹½Ş©eSmoÙh
(
Ï¡Should”RŞlAmp
, 0, 
kickT
 - 
BACK_PHASE
 - 
kickPha£
 - 
THROUGH_PHASE
, 
END_PHASE
);

1030 
kÃeP™ch
 = 
	`š‹½Ş©eSmoÙh
(
Ï¡KÃeP™ch
, 0, 
kickT
 - 
BACK_PHASE
 - 
kickPha£
 - 
THROUGH_PHASE
, 
END_PHASE
);

1031 
ªkËP™ch
 = 
	`š‹½Ş©eSmoÙh
(
Ï¡AnkËP™ch
, 0, 
kickT
 - 
BACK_PHASE
 - 
kickPha£
 - 
THROUGH_PHASE
, 
END_PHASE
);

1033 } ià(
kickT
 < (
tÙ®Pha£
 + 
SHIFT_END_PERIOD
 / 4)) {

1034 
fÜw¬dDi¡
 = 0;

1035 
kÃeP™ch
 = 0;

1036 
ªkËP™ch
 = 0;

1037 
’dT
 = 
tÙ®Pha£
 - 
kickT
;

1038 
rock
 = 
Ï¡Rock
 * 
	`sš
((
’dT
 + 
SHIFT_END_PERIOD
 / 4è/ SHIFT_END_PERIOD * 2 * 
M_PI
);

1039 
foÙh
 = 
Ï¡FoÙh
 * 
	`sš
((
’dT
 + 
SHIFT_END_PERIOD
 / 4è/ SHIFT_END_PERIOD * 2 * 
M_PI
);

1041 
kickT
 = 0;

1042 
rock
 = 0;

1043 
foÙh
 = 0;

1044 
w®k2014O±iÚ
 = 
WALK
;

1045 
w®kS‹
 = 
NOT_WALKING
;

1046 
»que¡
->
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
WALK
;

1047 
Ï¡KickTime
 = 0;

1051 ià(
kickT
 < (
BACK_PHASE
 + 
kickPha£
 + 
THROUGH_PHASE
)) {

1052 
Ï¡KickFÜw¬d
 = 
fÜw¬dDi¡
;

1053 
Ï¡KÃeP™ch
 = 
kÃeP™ch
;

1054 
Ï¡Side
 = 
side
;

1055 
Ï¡FoÙh
 = 
foÙh
;

1056 
Ï¡AnkËP™ch
 = 
ªkËP™ch
;

1057 
Ï¡Rock
 = 
rock
;

1058 
Ï¡Should”RŞlAmp
 = 
should”RŞlAmp
;

1060 
	}
}

1062 
	gW®k2014G’”©Ü
::
	$addKickJošts
(
JoštV®ues
 &
j
) {

1063 
j
.
ªgËs
[
Jošts
::
LKÃeP™ch
] +ğ
kÃeP™chL
;

1064 
j
.
ªgËs
[
Jošts
::
LAnkËP™ch
] +ğ
ªkËP™chL
 + 
should”RŞlL
;

1065 
j
.
ªgËs
[
Jošts
::
LShould”P™ch
] -ğ
kÃeP™chL
;

1067 
j
.
ªgËs
[
Jošts
::
RKÃeP™ch
] +ğ
kÃeP™chR
;

1068 
j
.
ªgËs
[
Jošts
::
RAnkËP™ch
] +ğ
ªkËP™chR
 + 
should”RŞlR
;

1069 
j
.
ªgËs
[
Jošts
::
RShould”P™ch
] -ğ
kÃeP™chR
;

1070 
	}
}

1072 
	gW®k2014G’”©Ü
::
	$ËáAngË
() {

1073 
Ëá_©_t
 = 
Ëá
 * 
	`·¿bŞicS‹p
(
t
, 
ÃxtFoÙSw™chT
, 0.0);

1074 
height
 = 
hh
 - 
ªkË
;

1075  
	`©ª
(
Ëá_©_t
 / 
height
);

1076 
	}
}

1078 
	gW®k2014G’”©Ü
::
	$lš—rS‹p
(
time
, 
³riod
) {

1079 ià(
time
 <= 0)

1081 ià(
time
 >ğ
³riod
)

1083  
time
 / 
³riod
;

1084 
	}
}

1086 
	gW®k2014G’”©Ü
::
	$·¿bŞicR‘uº
(
f
) {

1087 
x
 = 0;

1088 
y
 = 0;

1089 ià(
f
 < 0.25f) {

1090 
y
 = 8 * 
f
 * f;

1092 ià(
f
 >= 0.25f && f < 0.5f) {

1093 
x
 = 0.5à- 
f
;

1094 
y
 = 8 * 
x
 * x;

1095 
y
 = 1.0f - y;

1097 ià(
f
 >= 0.5f && f < 0.75f) {

1098 
x
 = 
f
 - 0.5f;

1099 
y
 = 8 * 
x
 * x;

1100 
y
 = 1.0f - y;

1102 ià(
f
 >= 0.75f && f <= 1.0f) {

1103 
x
 = 1.0à- 
f
;

1104 
y
 = 8 * 
x
 * x;

1106  
y
;

1107 
	}
}

1109 
	gW®k2014G’”©Ü
::
	$·¿bŞicS‹p
(
time
, 
³riod
, 
d—dTimeF¿ùiÚ
) {

1110 
d—dTime
 = 
³riod
 * 
d—dTimeF¿ùiÚ
 / 2;

1111 ià(
time
 < 
d—dTime
 + 
dt
 / 2)

1113 ià(
time
 > 
³riod
 - 
d—dTime
 - 
dt
 / 2)

1115 
timeF¿ùiÚ
 = (
time
 - 
d—dTime
è/ (
³riod
 - 2 * deadTime);

1116 ià(
time
 < 
³riod
 / 2)

1117  2.0 * 
timeF¿ùiÚ
 *imeFraction;

1118  4 * 
timeF¿ùiÚ
 - 2 *imeFraction *imeFraction - 1;

1119 
	}
}

1121 
Odom‘ry
 
	gW®k2014G’”©Ü
::
	$upd©eOdom‘ry
(
boŞ
 
isLeáSwšgFoÙ
) {

1123 
height
 = 
hh
 - 
ªkË
;

1124 
tuºOdo
 = -(
tuºRL
 - 
´evTuº
);

1125 
ËáOdo
 = (
height
 * 
	`n
(
ËáR
è- 
´evLeáR
);

1126 
fÜw¬dOdo
 = (
fÜw¬dR
 - 
´evFÜw¬dR
);

1127 ià(!
isLeáSwšgFoÙ
) {

1128 
tuºOdo
 *= -1;

1129 
ËáOdo
 = (
height
 * 
	`n
(
ËáL
è- 
´evLeáL
);

1130 
fÜw¬dOdo
 = (
fÜw¬dL
 - 
´evFÜw¬dL
);

1132 
fÜw¬dOdo
 *ğ
MM_PER_M
;

1133 
ËáOdo
 *ğ
MM_PER_M
;

1135 
fÜw¬dOdo
 *= 1;

1136 
ËáOdo
 *= 1.23;

1137 
tuºOdo
 *= -.58;

1141 
´evTuº
 = 
tuºRL
;

1142 
´evLeáL
 = 
height
 * 
	`n
(
ËáL
);

1143 
´evLeáR
 = 
height
 * 
	`n
(
ËáR
);

1144 
´evFÜw¬dL
 = 
fÜw¬dL
;

1145 
´evFÜw¬dR
 = 
fÜw¬dR
;

1146  
	`Odom‘ry
(
fÜw¬dOdo
, 
ËáOdo
, 
tuºOdo
);

1147 
	}
}

1149 
boŞ
 
	gW®k2014G’”©Ü
::
	$isAùive
() {

1150  !
¡İ³d
;

1151 
	}
}

1153 
	gW®k2014G’”©Ü
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

1154 
v4
 = 
cÚfig
["mÙiÚ.v4"].
as
<
boŞ
>();

1155 ià(
v4
) {

1156 
KICK_LEAN
 = 
KICK_LEAN_V4
;

1157 
¡d
::
cout
 << "S–eùšg v4 kick†—Àoà" << 
KICK_LEAN_V4
 << 
’dl
;

1159 
	}
}

1160 
	gW®k2014G’”©Ü
::
	$»£t
() {

1161 
	`š™Ÿli£
();

1162 
	`Îog
(
INFO
è<< "W®k2014„e£t" << 
’dl
;

1163 
	}
}

1165 
	gW®k2014G’”©Ü
::
	$¡İ
() {

1167 
¡İpšg
 = 
Œue
;

1168 
	`Îog
(
INFO
è<< "W®k2014 stİ" << 
’dl
;

1169 
	}
}

1171 
	gW®k2014G’”©Ü
::
	$š‹½Ş©eSmoÙh
(
¡¬t
, 
’d
, 
tCu¼’t
, 
tEnd
) {

1172  
¡¬t
 + (
’d
 - s¹è* (1 + 
	`cos
(
M_PI
 * 
tCu¼’t
 / 
tEnd
 - M_PI)) / 2;

1173 
	}
}

1175 
XYZ_CoÜd
 
	gW®k2014G’”©Ü
::
	$mf2b
(
Hyp
, 
Hp
, 
Hr
, 
Kp
, 
Ap
, 
Ar
, 
xf
, 
yf
, 
zf
) {

1180 
XYZ_CoÜd
 
»suÉ
;

1181 
pi
 = 
M_PI
;

1182 
tibŸ
 = 
this
->tibia * 1000;

1183 
thigh
 = 
this
->thigh * 1000;

1184 
k
 = 
	`sq¹
(2.0);

1185 
c1
 = 
	`cos
(
Ap
);

1186 
c2
 = 
	`cos
(
Hr
 + 
pi
 / 4.0);

1187 
c3
 = 
	`cos
(
Hyp
 - 
pi
 / 2.0);

1188 
c4
 = 
	`cos
(
Hp
);

1189 
c5
 = 
	`cos
(
Kp
);

1190 
c6
 = 
	`cos
(
Ar
 - 
pi
 / 2.0);

1191 
s1
 = 
	`sš
(
Kp
);

1192 
s2
 = 
	`sš
(
Hp
);

1193 
s3
 = 
	`sš
(
Hyp
 - 1.0 / 2.0 * 
pi
);

1194 
s4
 = 
	`sš
(
Hr
 + 1.0 / 4.0 * 
pi
);

1195 
s5
 = 
	`sš
(
Ap
);

1196 
s6
 = 
	`sš
(
Ar
 - 1.0 / 2.0 * 
pi
);

1197 
»suÉ
.
x
 = 
thigh
 * (
s2
 * 
s3
 - 
c2
 * 
c3
 * 
c4
è+ 
tibŸ
 * (
s1
 * (c4 * s3 + c2 * c3 * s2è+ 
c5
 * (s2 * s3 - c2 * c3 * c4))

1198 - 
yf


1199 * (
c6
 * (
c1
 * (
s1
 * (
c4
 * 
s3
 + 
c2
 * 
c3
 * 
s2
è+ 
c5
 * (s2 * s3 - c2 * c3 * c4)è- 
s5
 * (s1 * (s2 * s3 - c2 * c3 * c4) - c5 * (c4 * s3 + c2 * c3 * s2)))

1200 + 
c3
 * 
s4
 * 
s6
)

1201 + 
zf


1202 * (
s6
 * (
c1
 * (
s1
 * (
c4
 * 
s3
 + 
c2
 * 
c3
 * 
s2
è+ 
c5
 * (s2 * s3 - c2 * c3 * c4)è- 
s5
 * (s1 * (s2 * s3 - c2 * c3 * c4) - c5 * (c4 * s3 + c2 * c3 * s2)))

1203 - 
c3
 * 
c6
 * 
s4
)

1204 + 
xf
 * (
c1
 * (
s1
 * (
s2
 * 
s3
 - 
c2
 * 
c3
 * 
c4
è- 
c5
 * (c4 * s3 + c2 * c3 * s2)è+ 
s5
 * (s1 * (c4 * s3 + c2 * c3 * s2) + c5 * (s2 * s3 - c2 * c3 * c4)));

1205 
»suÉ
.
y
 = 
xf


1206 * (
c1
 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * kè/ 2.0fè+ 
s1
 * (c4 * ((k * s4) / 2.0f + (c2 * k * s3) / 2.0f) + (c3 * k * s2) / 2.0f))

1207 + 
s5


1208 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f)

1209 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)))

1210 + 
tibŸ
 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
è/ 2.0fè- 
s1
 * (s2 * ((k * s4) / 2.0f + (c2 * k * s3) / 2.0f) - (c3 * c4 * k) / 2.0f))

1211 + 
thigh
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f)

1212 - 
yf


1213 * (
s6
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
) / 2.0f)

1214 + 
c6


1215 * (
c1


1216 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f)

1217 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f))

1218 - 
s5


1219 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)

1220 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f))))

1221 - 
zf


1222 * (
c6
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
) / 2.0f)

1223 - 
s6


1224 * (
c1


1225 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f)

1226 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f))

1227 - 
s5


1228 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)

1229 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f))));

1230 
»suÉ
.
z
 = 
yf


1231 * (
s6
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
) / 2.0f)

1232 + 
c6


1233 * (
c1


1234 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)

1235 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f))

1236 - 
s5


1237 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)

1238 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f))))

1239 - 
tibŸ
 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
è/ 2.0fè- 
s1
 * (s2 * ((k * s4) / 2.0f - (c2 * k * s3) / 2.0f) + (c3 * c4 * k) / 2.0f))

1240 - 
thigh
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)

1241 - 
xf


1242 * (
c1


1243 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)

1244 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f))

1245 + 
s5


1246 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)

1247 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)))

1248 + 
zf


1249 * (
c6
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
) / 2.0f)

1250 - 
s6


1251 * (
c1


1252 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)

1253 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f))

1254 - 
s5


1255 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)

1256 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f))));

1257  
»suÉ
;

1258 
	}
}

1260 
	gW®k2014G’”©Ü
::
H´
 
W®k2014G’”©Ü
::
	$hAngËs
(
Hyp
, 
Hp
, 
Hr
, 
Kp
, 
Ap
, 
Ar
, 
xf
, 
yf
, 
zf
, 
XYZ_CoÜd
 
e
) {

1263 
H´
 
»suÉ
;

1264 
pi
 = 
M_PI
;

1265 
tibŸ
 = 
this
->tibia * 1000;

1266 
thigh
 = 
this
->thigh * 1000;

1267 
k
 = 
	`sq¹
(2.0);

1268 
c1
 = 
	`cos
(
Ap
);

1269 
c2
 = 
	`cos
(
Hr
 + 
pi
 / 4.0);

1270 
c3
 = 
	`cos
(
Hyp
 - 
pi
 / 2.0);

1271 
c4
 = 
	`cos
(
Hp
);

1272 
c5
 = 
	`cos
(
Kp
);

1273 
c6
 = 
	`cos
(
Ar
 - 
pi
 / 2.0);

1274 
s1
 = 
	`sš
(
Kp
);

1275 
s2
 = 
	`sš
(
Hp
);

1276 
s3
 = 
	`sš
(
Hyp
 - 1.0 / 2.0 * 
pi
);

1277 
s4
 = 
	`sš
(
Hr
 + 1.0 / 4.0 * 
pi
);

1278 
s5
 = 
	`sš
(
Ap
);

1279 
s6
 = 
	`sš
(
Ar
 - 1.0 / 2.0 * 
pi
);

1280 
j11
 = 
thigh
 * (
c4
 * 
s3
 + 
c2
 * 
c3
 * 
s2
è- 
tibŸ
 * (
s1
 * (s2 * s3 - c2 * c3 * c4è- 
c5
 * (c4 * s3 + c2 * c3 * s2))

1281 + 
xf
 * (
c1
 * (
s1
 * (
c4
 * 
s3
 + 
c2
 * 
c3
 * 
s2
è+ 
c5
 * (s2 * s3 - c2 * c3 * c4)è- 
s5
 * (s1 * (s2 * s3 - c2 * c3 * c4) - c5 * (c4 * s3 + c2 * c3 * s2)))

1282 + 
c6
 * 
yf
 * (
c1
 * (
s1
 * (
s2
 * 
s3
 - 
c2
 * 
c3
 * 
c4
è- 
c5
 * (c4 * s3 + c2 * c3 * s2)è+ 
s5
 * (s1 * (c4 * s3 + c2 * c3 * s2) + c5 * (s2 * s3 - c2 * c3 * c4)))

1283 - 
s6
 * 
zf
 * (
c1
 * (
s1
 * (
s2
 * 
s3
 - 
c2
 * 
c3
 * 
c4
è- 
c5
 * (c4 * s3 + c2 * c3 * s2)è+ 
s5
 * (s1 * (c4 * s3 + c2 * c3 * s2) + c5 * (s2 * s3 - c2 * c3 * c4)));

1284 
j12
 = 
yf
 * (
c6
 * (
c1
 * (
c3
 * 
s1
 * 
s2
 * 
s4
 - c3 * 
c4
 * 
c5
 * s4è+ 
s5
 * (c3 * c4 * s1 * s4 + c3 * c5 * s2 * s4)è- 
c2
 * c3 * 
s6
)

1285 - 
tibŸ
 * (
c3
 * 
s1
 * 
s2
 * 
s4
 - c3 * 
c4
 * 
c5
 * s4)

1286 - 
zf
 * (
s6
 * (
c1
 * (
c3
 * 
s1
 * 
s2
 * 
s4
 - c3 * 
c4
 * 
c5
 * s4è+ 
s5
 * (c3 * c4 * s1 * s4 + c3 * c5 * s2 * s4)è+ 
c2
 * c3 * 
c6
)

1287 + 
xf
 * (
c1
 * (
c3
 * 
c4
 * 
s1
 * 
s4
 + c3 * 
c5
 * 
s2
 * s4è- 
s5
 * (c3 * s1 * s2 * s4 - c3 * c4 * c5 * s4)è+ c3 * c4 * s4 * 
thigh
;

1288 
j21
 = 
xf


1289 * (
c1
 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
è/ 2.0fè- 
s1
 * (s2 * ((k * s4) / 2.0f + (c2 * k * s3) / 2.0f) - (c3 * c4 * k) / 2.0f))

1290 - 
s5


1291 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)

1292 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f)))

1293 - 
tibŸ
 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * kè/ 2.0fè+ 
s1
 * (c4 * ((k * s4) / 2.0f + (c2 * k * s3) / 2.0f) + (c3 * k * s2) / 2.0f))

1294 - 
thigh
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)

1295 + 
c6
 * 
yf


1296 * (
c1


1297 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)

1298 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f))

1299 + 
s5


1300 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f)

1301 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)))

1302 - 
s6
 * 
zf


1303 * (
c1


1304 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)

1305 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f))

1306 + 
s5


1307 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * k * 
s2
) / 2.0f)

1308 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * 
c4
 * k) / 2.0f)));

1309 
j22
 = 
tibŸ
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f - (k * s3 * s4) / 2.0f))

1310 + 
xf


1311 * (
c1
 * (
c4
 * 
s1
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
è/ 2.0fè+ 
c5
 * 
s2
 * ((c2 * k) / 2.0f - (k * s3 * s4) / 2.0f))

1312 + 
s5
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f - (k * s3 * s4) / 2.0f)))

1313 + 
yf


1314 * (
s6
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
) / 2.0f)

1315 - 
c6


1316 * (
c1
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f - (k * s3 * s4) / 2.0f))

1317 - 
s5
 * (
c4
 * 
s1
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
è/ 2.0fè+ 
c5
 * 
s2
 * ((c2 * k) / 2.0f - (k * s3 * s4) / 2.0f))))

1318 + 
zf


1319 * (
c6
 * ((
k
 * 
s4
è/ 2.0à+ (
c2
 * k * 
s3
) / 2.0f)

1320 + 
s6


1321 * (
c1
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f - (k * s3 * s4) / 2.0f))

1322 - 
s5
 * (
c4
 * 
s1
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
è/ 2.0fè+ 
c5
 * 
s2
 * ((c2 * k) / 2.0f - (k * s3 * s4) / 2.0f))))

1323 + 
c4
 * 
thigh
 * ((
c2
 * 
k
è/ 2.0à- (k * 
s3
 * 
s4
) / 2.0f);

1324 
j31
 = 
tibŸ
 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * kè/ 2.0fè+ 
s1
 * (c4 * ((k * s4) / 2.0f - (c2 * k * s3) / 2.0f) - (c3 * k * s2) / 2.0f))

1325 - 
xf


1326 * (
c1


1327 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)

1328 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f))

1329 - 
s5


1330 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)

1331 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)))

1332 + 
thigh
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)

1333 - 
c6
 * 
yf


1334 * (
c1


1335 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)

1336 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f))

1337 + 
s5


1338 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)

1339 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)))

1340 + 
s6
 * 
zf


1341 * (
c1


1342 * (
c5
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)

1343 + 
s1
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f))

1344 + 
s5


1345 * (
c5
 * (
c4
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè- (
c3
 * k * 
s2
) / 2.0f)

1346 - 
s1
 * (
s2
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
è/ 2.0fè+ (
c3
 * 
c4
 * k) / 2.0f)));

1347 
j32
 = -
tibŸ
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f + (k * s3 * s4) / 2.0f))

1348 - 
xf


1349 * (
c1
 * (
c4
 * 
s1
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
è/ 2.0fè+ 
c5
 * 
s2
 * ((c2 * k) / 2.0f + (k * s3 * s4) / 2.0f))

1350 + 
s5
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f + (k * s3 * s4) / 2.0f)))

1351 - 
yf


1352 * (
s6
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
) / 2.0f)

1353 - 
c6


1354 * (
c1
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f + (k * s3 * s4) / 2.0f))

1355 - 
s5
 * (
c4
 * 
s1
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
è/ 2.0fè+ 
c5
 * 
s2
 * ((c2 * k) / 2.0f + (k * s3 * s4) / 2.0f))))

1356 - 
zf


1357 * (
c6
 * ((
k
 * 
s4
è/ 2.0à- (
c2
 * k * 
s3
) / 2.0f)

1358 + 
s6


1359 * (
c1
 * (
c4
 * 
c5
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
è/ 2.0fè- 
s1
 * 
s2
 * ((c2 * k) / 2.0f + (k * s3 * s4) / 2.0f))

1360 - 
s5
 * (
c4
 * 
s1
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
è/ 2.0fè+ 
c5
 * 
s2
 * ((c2 * k) / 2.0f + (k * s3 * s4) / 2.0f))))

1361 - 
c4
 * 
thigh
 * ((
c2
 * 
k
è/ 2.0à+ (k * 
s3
 * 
s4
) / 2.0f);

1362 
xbe
 = 
e
.
x
;

1363 
ybe
 = 
e
.
y
;

1364 
zbe
 = 
e
.
z
;

1365 
Ïmbda
 = 0.4f;

1366 
Ï2
 = 
Ïmbda
 *†ambda;

1367 
Ï4
 = 
Ï2
 *†a2;

1368 
j322
 = 
j32
 * j32;

1369 
j222
 = 
j22
 * j22;

1370 
j122
 = 
j12
 * j12;

1371 
j212
 = 
j21
 * j21;

1372 
j112
 = 
j11
 * j11;

1373 
j312
 = 
j31
 * j31;

1374 
sigma
 = 1.0f

1375 / (
Ï4
 + 
j112
 * 
j222
 + 
j122
 * 
j212
 + j112 * 
j322
 + j122 * 
j312
 + j212 * j322 + j222 * j312 + j112 * 
Ï2
 + j122 *†a2 + j212 *†a2 + j222 *†a2 + j312 *†a2 + j322 *†a2

1376 - 2.0à* 
j11
 * 
j12
 * 
j21
 * 
j22
 - 2.0à* j11 * j12 * 
j31
 * 
j32
 - 2.0f * j21 * j22 * j31 * j32);

1377 
»suÉ
.
Hp
 = 
sigma
 * 
xbe
 * (
j11
 * 
j222
 + j11 * 
j322
 + j11 * 
Ï2
 - 
j12
 * 
j21
 * 
j22
 - j12 * 
j31
 * 
j32
)

1378 + 
sigma
 * 
ybe
 * (
j122
 * 
j21
 + j21 * 
j322
 + j21 * 
Ï2
 - 
j11
 * 
j12
 * 
j22
 - j22 * 
j31
 * 
j32
)

1379 + 
sigma
 * 
zbe
 * (
j122
 * 
j31
 + 
j222
 * j31 + j31 * 
Ï2
 - 
j11
 * 
j12
 * 
j32
 - 
j21
 * 
j22
 * j32);

1380 
»suÉ
.
Hr
 = 
sigma
 * 
xbe
 * (
j12
 * 
j212
 + j12 * 
j312
 + j12 * 
Ï2
 - 
j11
 * 
j21
 * 
j22
 - j11 * 
j31
 * 
j32
)

1381 + 
sigma
 * 
ybe
 * (
j112
 * 
j22
 + j22 * 
j312
 + j22 * 
Ï2
 - 
j11
 * 
j12
 * 
j21
 - j21 * 
j31
 * 
j32
)

1382 + 
sigma
 * 
zbe
 * (
j112
 * 
j32
 + 
j212
 * j32 + j32 * 
Ï2
 - 
j11
 * 
j12
 * 
j31
 - 
j21
 * 
j22
 * j31);

1383  
»suÉ
;

1384 
	}
}

	@robot/motion/generator/Walk2014Generator.hpp

38 #´agm¨
Úû


40 
	~<cm©h
>

41 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

42 
	~"mÙiÚ/g’”©Ü/BodyMod–.hµ
"

43 
	~"ty³s/XYZ_CoÜd.hµ
"

44 
	~"ty³s/AùiÚCommªd.hµ
"

45 
	~"uts/Tim”.hµ
"

46 
	~"bÏckbßrd/BÏckbßrd.hµ
"

47 
	~"mÙiÚ/MÙiÚOdom‘ry.hµ
"

49 şas 
	cW®k2014G’”©Ü
 : 
G’”©Ü
 {

50 
public
:

51 
ex¶ic™
 
W®k2014G’”©Ü
(
BÏckbßrd
 *
bb
);

52 ~
W®k2014G’”©Ü
();

53 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

54 
Odom‘ry
* 
odom‘ry
,

55 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

56 
BodyMod–
 &
bodyMod–
,

57 
b®lX
,

58 
b®lY
);

60 
boŞ
 
isAùive
();

61 
	mAùiÚCommªd
::
Body
 
aùive
;

63 
	eW®k2014O±iÚ
 {

64 
	mSTAND
 = 0,

65 
	mSTANDUP
 = 1,

66 
	mCROUCH
 = 2,

67 
	mWALK
 = 3,

68 
	mREADY
 = 4,

69 
	mKICK
 = 5,

70 
	mSTEP
 = 6,

71 
	mNONE
 = 7,

72 
	mNUMBER_OF_WALK_OPTIONS


75 
	eW®kS‹
 {

76 
	gWALKING
 = 0,

77 
	gSTARTING
 = 1,

78 
	gSTOPPING
 = 2,

79 
	gNOT_WALKING
 = 3,

80 
	gNUMBER_OF_WALK_STATES


83 
W®k2014O±iÚ
 
	gw®k2014O±iÚ
;

84 
W®kS‹
 
	gw®kS‹
;

85 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

86 
»£t
();

87 
¡İ
();

88 
ä›nd
 
şass
 
	gW®kEngšeP»ProûssÜ
;

90 
	g´iv©e
:

91 
boŞ
 
exaùS‹psReque¡ed
;

93 
boŞ
 
	gv4
;

94 
boŞ
 
	g¡İpšg
;

95 
boŞ
 
	g¡İ³d
;

97 
	gdt
;

98 
	gt
;

99 
	gglob®Time
;

101 
	gtim”
;

102 
	gT
;

104 cÚ¡ 
	gz
;

105 cÚ¡ 
	gPI
;

108 
	gthigh
;

109 
	gtibŸ
;

110 
	gªkË
;

113 
	ghh
;

114 
	ghh0
;

115 
	gfoÙhL
;

116 
	gfoÙhR
;

117 
	gÃxtFoÙSw™chT
;

118 
	gfÜw¬d
;

119 
	gÏ¡FÜw¬d
;

120 
	gfÜw¬dL0
, 
	gfÜw¬dL
;

121 
	gfÜw¬dR0
, 
	gfÜw¬dR
;

122 
	gËáR
;

123 
	gËáL
;

124 
	gËá
, 
	gÏ¡Leá
;

125 
	gtuº
;

126 
	gpow”
;

127 
	gb’d
;

128 
	g¥“d
;

129 
	gAùiÚCommªd
::
Body
::
FoÙ
 
foÙ
;

130 
boŞ
 
	gisFa¡
;

131 
	g¡ifâess
;

132 
	gtuºRL
;

133 
	gtuºRL0
;

134 
	gswšgAngË
;

135 
boŞ
 
	gsuµÜtFoÙhasChªged
;

136 
boŞ
 
	gweightHasShiáed
;

137 
	gb®ªûAdju¡m’t
;

138 
	gcÜÚ®B®ªûAdju¡m’t
;

139 
	gcomOff£t
;

142 
	gf‹»dGyroX
;

143 
	gf‹»dGyroY
;

146 
	gkickT
;

147 
	gkickPha£
;

148 
	grock
;

149 
	gkÃeP™chL
, 
	gkÃeP™chR
, 
	gÏ¡KÃeP™ch
;

150 
	gªkËP™chL
, 
	gªkËP™chR
;

151 
	gÏ¡KickFÜw¬d
;

152 
	gÏ¡Side
;

153 
	gÏ¡AnkËP™ch
;

154 
	gÏ¡Should”RŞlAmp
;

155 
	gÏ¡FoÙh
;

156 
	gÏ¡Rock
;

157 
	gÏ¡KickTime
;

158 
	gshould”P™chL
;

159 
	gshould”P™chR
;

160 
	gshould”RŞlL
;

161 
	gshould”RŞlR
;

162 
	gdyÇmicSide
;

163 
	gtuºAngË
;

164 
	gÏ¡Tuº
;

167 
	g´evTuº
;

168 
	g´evFÜw¬dL
;

169 
	g´evFÜw¬dR
;

170 
	g´evLeáL
;

171 
	g´evLeáR
;

174 
BÏckbßrd
 *
	gbÏckbßrd
;

176 
š™Ÿli£
();

179 
	sH´
 {

180 
	gHp
;

181 
	gHr
;

188 
avoidF“t
(&
fow¬d
, & 
Ëá
, & 
tuº
, 
BodyMod–
& 
bodyMod–
);

194 
ËáAngË
();

196 
MÙiÚOdom‘ry
 
	gmÙiÚOdom‘ry
;

197 
Odom‘ry
 
upd©eOdom‘ry
(
boŞ
 
isLeáSwšgFoÙ
);

202 
·¿bŞicR‘uº
();

203 
·¿bŞicS‹p
(
time
, 
³riod
, 
d—dTimeF¿ùiÚ
);

204 
lš—rS‹p
(
time
, 
³riod
);

205 
š‹½Ş©eSmoÙh
(
¡¬t
, 
’d
, 
tCu¼’t
, 
tEnd
);

212 
w®kKick
(
b®lX
, 
BodyMod–
 &
bodyMod–
);

217 
´•Kick
(
boŞ
 
isLeá
, 
BodyMod–
 &
bodyMod–
);

219 
boŞ
 
ÿnAbbÜtKick
();

224 
makeFÜw¬dKickJošts
(
kickL—n
, 
kickS‹pH
, 
shiáP”iod
, &
foÙh
, &
fÜw¬d
,

225 &
side
, &
kÃeP™ch
, &
should”RŞl
, &
ªkËP™ch
, &
b®lY
, 
AùiÚCommªd
::
AÎ
* 
»que¡
);

230 
addKickJošts
(
JoštV®ues
 &
j
);

233 
XYZ_CoÜd
 
mf2b
(
Hyp
, 
Hp
, 
Hr
, 
Kp
, 
Ap
,

234 
Ar
, 
xf
, 
yf
, 
zf
);

235 
H´
 
hAngËs
(
Hyp
, 
Hp
, 
Hr
, 
Kp
, 
Ap
,

236 
Ar
, 
xf
, 
yf
, 
zf
, 
XYZ_CoÜd
 
e
);

	@robot/motion/generator/WalkCycle.cpp

1 
	~<cm©h
>

2 
	~<io¡»am
>

3 
	~"W®kCyşe.hµ
"

5 cÚ¡ 
	gW®kCyşe
::
movF¿c
 = .4;

7 
	gW®kCyşe
::
	$W®kCyşe
() {

8 
this
->
u£FÜw¬dL
 = 0;

9 
this
->
u£FÜw¬dR
 = 0;

10 
this
->
u£Leá
 = 0;

11 
this
->
u£Tuº
 = 0;

12 
this
->
T
 = 0.5;

13 
this
->
t
 = 0;

14 
this
->
ËáPha£
 = 
çl£
;

16 
	}
}

18 
	gW®kCyşe
::
	$W®kCyşe
(
u£FÜw¬dL
, 
u£FÜw¬dR
, 
u£Leá
,

19 
u£Tuº
, 
T
, 
t
) {

20 
this
->
u£FÜw¬dL
 = useForwardL;

21 
this
->
u£FÜw¬dR
 = useForwardR;

22 
this
->
u£Leá
 = useLeft;

23 
this
->
u£Tuº
 = useTurn;

24 
this
->
T
 = T;

25 
this
->
t
 =;

26 ià(
t
 < 
T
/2.0) {

27 
this
->
ËáPha£
 = 
Œue
;

29 
this
->
ËáPha£
 = 
çl£
;

31 
	}
}

33 
	gW®kCyşe
::
	$g’”©eW®k
(&
fÜw¬dL
, &
fÜw¬dR
,

34 &
ËáL
, &
ËáR
,

35 &
tuºLR
, &
liáL
, &
liáR
) {

50 
pha£LeáT
 = 
t
;

51 
pha£TuºT
 = 
t
;

52 
fÜw¬dL
 = -
u£FÜw¬dL
 / 4.0f;

53 
fÜw¬dR
 = +
u£FÜw¬dR
 / 4.0f;

55 
ËáL
 = 
ËáR
 = 0.0f;

56 ià(
u£Leá
 > 0.0f) {

58 
pha£LeáT
 = (
t
 + 
T
/2.0);

59 ià(
pha£LeáT
 > 
T
)…haseLeftT -= T;

61 
tuºLR
 = 
u£Tuº
 / 8.0f;

62 ià(
u£Tuº
 < 0.0f) {

63 
pha£TuºT
 = (
t
 + 
T
/2.0);

64 ià(
pha£TuºT
 > 
T
)…haseTurnT -=T;

67 
fÜw¬dL
 -ğ
u£FÜw¬dL
 / 
T
 * 
t
;

68 
fÜw¬dR
 -ğ
u£FÜw¬dR
 / 
T
 * 
t
;

69 
ËáL
 -ğ
u£Leá
 / 
T
 * 
pha£LeáT
;

70 
ËáR
 -ğ
u£Leá
 / 
T
 * 
pha£LeáT
;

72 
movT
 = 
movF¿c
 * 
T
;

73 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
è/ 4.0fè* 
T
;

76 ià(
t
 >ğ
¡¬tT
) {

77 ià(
t
 < 
¡¬tT
 + 
movT
 + 
T
 / 
FPS
 && 
ËáPha£
) {

78 
sšu
 = 
	`sq¹
((1.0à- 
	`cos
((
t
 - 
¡¬tT
è* 
M_PI
 / 
movT
)) / 2.0f);

79 ià(
t
 > 
¡¬tT
 + 
movT
è
sšu
 = 1.0f;

80 
fÜw¬dL
 +ğ
u£FÜw¬dL
 * 
sšu
;

82 
fÜw¬dL
 +ğ
u£FÜw¬dL
 * 1.0;

86 
dœ
 = 1;

87 ià(
u£Tuº
 < 0) {

88 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
è/ 4.0fè* 
T
 + T / 2.0f;

90 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
) / 4.0f);

92 ià(
pha£TuºT
 >ğ
¡¬tT
) {

93 ià(
pha£TuºT
 < 
¡¬tT
 + 
movT
 + 
T
 / 
FPS
 && 
ËáPha£
) {

94 
sšu
 = 
	`sq¹
((1.0à- 
	`cos
((
pha£TuºT
 - 
¡¬tT
è* 
M_PI
 / 
movT
)) / 2.0f);

95 ià(
pha£TuºT
 > 
¡¬tT
 + 
movT
è
sšu
 = 1.0f;

96 
tuºLR
 +ğ
dœ
 * 
u£Tuº
 * 
sšu
;

98 
tuºLR
 +ğ
dœ
 * 
u£Tuº
 * 1.0;

103 ià(
u£Leá
 < 0) {

104 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
è/ 4.0fè* 
T
 + T / 2.0f;

106 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
) / 4.0f);

108 ià(
pha£LeáT
 >ğ
¡¬tT
) {

109 ià(
pha£LeáT
 < 
¡¬tT
 + 
movT
 + 
T
 / 
FPS
 && 
ËáPha£
) {

110 
sšu
 = 
	`sq¹
((1.0à- 
	`cos
((
pha£LeáT
 - 
¡¬tT
è* 
M_PI
 / 
movT
)) / 2.0f);

111 ià(
pha£LeáT
 > 
¡¬tT
 + 
movT
è
sšu
 = 1.0f;

112 
ËáL
 +ğ
u£Leá
 * 
sšu
;

114 
ËáL
 +ğ
u£Leá
 * 1.0;

119 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
è/ 4.0fè* 
T
 + T/2.0f;

120 ià(
t
 >ğ
¡¬tT
) {

121 ià(
t
 < 
¡¬tT
 + 
movT
 + 
T
 / 
FPS
 && !
ËáPha£
) {

122 
sšu
 = 
	`sq¹
((1.0à- 
	`cos
((
t
 - 
¡¬tT
è* 
M_PI
 / 
movT
)) / 2.0f);

123 ià(
t
 > 
¡¬tT
 + 
movT
è
sšu
 = 1.0f;

124 
fÜw¬dR
 +ğ
u£FÜw¬dR
 * 
sšu
;

126 
fÜw¬dR
 +ğ
u£FÜw¬dR
 * 1.0;

130 
dœ
 = 1;

131 ià(
u£Tuº
 < 0) {

132 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
) / 4.0f);

133 
dœ
 = -1;

135 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
è/ 4.0fè* 
T
 + T/2.0f;

136 
dœ
 = -1;

139 ià(
pha£TuºT
 >ğ
¡¬tT
) {

140 ià(
pha£TuºT
 < 
¡¬tT
 + 
movT
 + 
T
 / 
FPS
 && !
ËáPha£
) {

141 
sšu
 = 
	`sq¹
((1.0à- 
	`cos
((
pha£TuºT
 - 
¡¬tT
è* 
M_PI
 / 
movT
)) / 2.0f);

142 ià(
pha£TuºT
 > 
¡¬tT
 + 
movT
è
sšu
 = 1.0f;

143 
tuºLR
 +ğ
dœ
 * 
u£Tuº
 * 
sšu
;

145 
tuºLR
 +ğ
dœ
 *
u£Tuº
 * 1.0;

149 ià(
u£Leá
 < 0) {

150 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
) / 4.0f);

152 
¡¬tT
 = ((1.0à- 2.0à* 
movF¿c
è/ 4.0fè* 
T
 + T/2.0f;

154 ià(
pha£LeáT
 >ğ
¡¬tT
) {

155 ià(
pha£LeáT
 < 
¡¬tT
 + 
movT
 + 
T
 / 
FPS
 && !
ËáPha£
) {

156 
sšu
 = 
	`sq¹
((1.0à- 
	`cos
((
pha£LeáT
 - 
¡¬tT
è* 
M_PI
 / 
movT
)) / 2.0f);

157 ià(
pha£LeáT
 > 
¡¬tT
 + 
movT
è
sšu
 = 1.0f;

158 
ËáR
 +ğ
u£Leá
 * 
sšu
;

160 
ËáR
 +ğ
u£Leá
 * 1.0;

165 
	}
}

167 
	gW®kCyşe
::
	$Ãxt
() {

168 
t
 +ğ
T
 / 100.0f;

169 ià(
t
 > 
T
) {

170 
t
 = 0.0f;

174 ià(
t
 > 
T
 / 2) {

175 
ËáPha£
 = 
çl£
;

177 
ËáPha£
 = 
Œue
;

179 
	}
}

182 
boŞ
 
	gW®kCyşe
::
	$isDoubËSuµÜtPha£
() {

183 
D
 = 
T
 - T * 2 * 
movF¿c
;

184 ià(
t
 <ğ
D
/4 || >ğ
T
 - D/4 || (ˆ> T/2 - D/4 && < T/2 + D/4)è 
Œue
;

185  
çl£
;

186 
	}
}

	@robot/motion/generator/WalkCycle.hpp

1 #´agm¨
Úû


9 
	#FPS
 100.0f

	)

10 şas 
	cW®kCyşe
 {

11 
	mpublic
:

12 
W®kCyşe
();

13 
W®kCyşe
(
u£FÜw¬dL
, 
u£FÜw¬dR
, 
u£Leá
,

14 
u£Tuº
, 
T
, 
t
);

17 
	mu£FÜw¬dL
, 
	mu£FÜw¬dR
, 
	mu£Leá
, 
	mu£Tuº
;

18 
	mT
;

21 
	mt
;

22 
boŞ
 
	mËáPha£
;

23 cÚ¡ 
	mmovF¿c
;

26 
g’”©eW®k
(&
fÜw¬dL
, &
fÜw¬dR
,

27 &
ËáL
, &
ËáR
,

28 &
tuºLR
, &
liáL
, &
liáR
);

30 
boŞ
 
isDoubËSuµÜtPha£
();

36 
Ãxt
();

	@robot/motion/generator/WalkEnginePreProcessor.cpp

1 
	~"mÙiÚ/g’”©Ü/W®kEngšeP»ProûssÜ.hµ
"

3 
	#MAX_FORWARD_STEP
 90

	)

5 
	#MAX_LEFT_STEP
 50

	)

7 
	#MAX_TURN_STEP
 
	`DEG2RAD
(20)

	)

9 
	#FOOT_LENGTH
 100

	)

10 
	#FORWARD_GAP
 50

	)

11 
	#LEFT_GAP_DRIBBLE
 40

	)

12 
	#LEFT_GAP_KICK
 45

	)

14 
	#FORWARD_THRESHOLD
 25

	)

15 
	#LEFT_THRESHOLD
 20

	)

18 
usšg
 
Çme¥aû
 
	gAùiÚCommªd
;

19 
usšg
 
Çme¥aû
 
	g¡d
;

21 
	$sign
(
num
) {

22 
sign
 = 1;

23 ià(
num
 < 0) {

24 
sign
 = -1;

26  
sign
;

27 
	}
}

29 
	$toW®kReque¡
(
AùiÚCommªd
::
AÎ
* 
»que¡
) {

30 
»que¡
->
body
.
aùiÚTy³
 = 
Body
::
WALK
;

31 
»que¡
->
body
.
pow”
 = 0;

32 
»que¡
->
body
.
b’d
 = 1;

33 
»que¡
->
body
.
¥“d
 = 1;

34 
	}
}

37 
	gW®kEngšeP»ProûssÜ
::
LšeUpEngše
::
	$LšeUpEngše
(
W®k2014G’”©Ü
* 
w®kEngše
) {

38 
hasS¹ed
 = 
çl£
;

39 
foÙ
 = 
Body
::
LEFT
;

40 
this
->
w®kEngše
 = walkEngine;

41 
	}
}

43 
	gW®kEngšeP»ProûssÜ
::
LšeUpEngše
::
	$¡¬t
(
Body
::
FoÙ
 
foÙ
) {

44 
hasS¹ed
 = 
Œue
;

45 
this
->
foÙ
 = foot;

46 
	}
}

48 
	gW®kEngšeP»ProûssÜ
::
LšeUpEngše
::
	$»£t
() {

49 
hasS¹ed
 = 
çl£
;

50 
w®kEngše
->
exaùS‹psReque¡ed
 = 
çl£
;

51 
	}
}

53 
boŞ
 
	gW®kEngšeP»ProûssÜ
::
LšeUpEngše
::
	$hasEnded
(
AùiÚCommªd
::
AÎ
* 
»que¡
, 
b®lX
, 
b®lY
) {

55 
ËáG­
 = 
LEFT_GAP_DRIBBLE
;

56 ià(
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
KICK
) {

57 
ËáG­
 = 
LEFT_GAP_KICK
;

59 
g­Y
 = 
b®lY
 - 
ËáG­
;

60 ià(
foÙ
 =ğ
Body
::
RIGHT
) {

61 
g­Y
 = 
b®lY
 + 
ËáG­
;

63 
g­X
 = 
b®lX
 - 
FOOT_LENGTH
 - 
FORWARD_GAP
 - 
	`max
(
w®kEngše
->
fÜw¬dL
,w®kEngše->
fÜw¬dR
)*1000;

69  (
	`abs
(
g­X
è< 
FORWARD_THRESHOLD
 &&‡bs(
g­Y
è< 
LEFT_THRESHOLD


70 && 
	`çbs
(
»que¡
->
body
.
tuº
è<„eque¡->body.
¥“d
);

71 
	}
}

73 
	gW®kEngšeP»ProûssÜ
::
LšeUpEngše
::
	$´eProûss
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

74 
b®lX
,

75 
b®lY
) {

76 
fÜw¬d
 = 
b®lX
 - 
FOOT_LENGTH
 - 
FORWARD_GAP
 - 
	`max
(
w®kEngše
->
fÜw¬dL
,w®kEngše->
fÜw¬dR
)*1000;

78 
ËáG­
 = 
LEFT_GAP_DRIBBLE
;

79 ià(
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
KICK
) {

80 
ËáG­
 = 
LEFT_GAP_KICK
;

82 
Ëá
 = 
b®lY
 - 
ËáG­
;

83 ià(
foÙ
 =ğ
Body
::
RIGHT
) {

84 
Ëá
 = 
b®lY
 + 
ËáG­
;

87 
»que¡
->
body
.
fÜw¬d
 = 
	`sign
(fÜw¬dè* 
	`mš
(
MAX_FORWARD_STEP
, 
	`abs
(forward));

88 
»que¡
->
body
.
Ëá
 = 
	`sign
Öeáè* 
	`mš
(
MAX_LEFT_STEP
, 
	`abs
(left));

91 
h—dšg
 = 
	`©ª2
(
b®lY
, 
b®lX
);

92 ià(
	`NORMALISE
(
»que¡
->
body
.
tuº
 - 
h—dšg
è> 
	`DEG2RAD
(30)) {

93 
»que¡
->
body
.
tuº
 = 
	`NORMALISE
(
	`DEG2RAD
(30è+ 
h—dšg
);

94 } ià(
	`NORMALISE
(
»que¡
->
body
.
tuº
 - 
h—dšg
è< -
	`DEG2RAD
(30)) {

95 
»que¡
->
body
.
tuº
 = 
	`NORMALISE
(-
	`DEG2RAD
(30è+ 
h—dšg
);

97 
»que¡
->
body
.
tuº
 = 
	`sign
Ôeque¡->body.tuºè* 
	`mš
(
MAX_TURN_STEP
, 
	`çbs
(request->body.turn/2));

99 
	`toW®kReque¡
(
»que¡
);

100 
w®kEngše
->
exaùS‹psReque¡ed
 = 
Œue
;

101 
	}
}

104 
	gW®kEngšeP»ProûssÜ
::
DribbËEngše
::
	$DribbËEngše
(
W®k2014G’”©Ü
* 
w®kEngše
) {

105 
this
->
w®kEngše
 = walkEngine;

106 
foÙ
 = 
Body
::
LEFT
;

107 
dribbËS‹
 = 
DribbËEngše
::
END
;

108 
	}
}

110 
	gW®kEngšeP»ProûssÜ
::
DribbËEngše
::
	$»£t
() {

111 
dribbËS‹
 = 
DribbËEngše
::
END
;

112 
w®kEngše
->
exaùS‹psReque¡ed
 = 
çl£
;

113 
	}
}

115 
boŞ
 
	gW®kEngšeP»ProûssÜ
::
DribbËEngše
::
	$hasEnded
() {

116  (
dribbËS‹
 =ğ
DribbËEngše
::
END
);

117 
	}
}

119 
	gW®kEngšeP»ProûssÜ
::
DribbËEngše
::
	$¡¬t
(
Body
::
FoÙ
 
foÙ
) {

120 
dribbËS‹
 = 
DribbËEngše
::
INIT
;

121 
this
->
foÙ
 = foot;

122 
	}
}

124 
	gW®kEngšeP»ProûssÜ
::
DribbËEngše
::
	$´eProûss
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

125 
BodyMod–
 &
bodyMod–
) {

126 
dœeùiÚ
 = 1;

127 
boŞ
 
ËáTuºPha£
 = 
Œue
;

128 ià(
foÙ
 =ğ
Body
::
RIGHT
) {

129 
dœeùiÚ
 = -1;

130 
ËáTuºPha£
 = 
çl£
;

134 ià(
dribbËS‹
 =ğ
DribbËEngše
::
INIT
 && 
bodyMod–
.
isLeáPha£
 =ğ
ËáTuºPha£


135 && 
w®kEngše
->
t
 == 0) {

136 
dribbËS‹
 = 
DribbËEngše
::
TURN
;

137 } ià(
dribbËS‹
 =ğ
DribbËEngše
::
TURN
 && 
bodyMod–
.
isLeáPha£
 !ğ
ËáTuºPha£


138 && 
w®kEngše
->
t
 == 0) {

139 
dribbËS‹
 = 
DribbËEngše
::
FORWARD
;

140 } ià(
dribbËS‹
 =ğ
DribbËEngše
::
FORWARD
 && 
bodyMod–
.
isLeáPha£
 =ğ
ËáTuºPha£


141 && 
w®kEngše
->
t
 == 0) {

142 
dribbËS‹
 = 
DribbËEngše
::
END
;

143 
dribbËTim”
.
	`»¡¬t
();

147 
»que¡
->
body
.
Ëá
 = 0;

148 ià(
dribbËS‹
 =ğ
DribbËEngše
::
TURN
) {

149 
»que¡
->
body
.
fÜw¬d
 = 0;

150 
»que¡
->
body
.
tuº
 = 
dœeùiÚ
 * 
	`DEG2RAD
(40);

151 } ià(
dribbËS‹
 =ğ
DribbËEngše
::
FORWARD
) {

152 
»que¡
->
body
.
fÜw¬d
 = 140;

153 
»que¡
->
body
.
tuº
 = 0;

154 } if(
dribbËS‹
 =ğ
DribbËEngše
::
END
) {

155 
»que¡
->
body
.
fÜw¬d
 = 70;

156 
»que¡
->
body
.
tuº
 = 0;

158 
»que¡
->
body
.
fÜw¬d
 = 1;

159 
»que¡
->
body
.
tuº
 = 0;

161 
	`toW®kReque¡
(
»que¡
);

162 
w®kEngše
->
exaùS‹psReque¡ed
 = 
Œue
;

165 
	}
}

168 
	gW®kEngšeP»ProûssÜ
::
	$W®kEngšeP»ProûssÜ
(
BÏckbßrd
 *
bb
) {

169 
w®kEngše
 = 
Ãw
 
	`W®k2014G’”©Ü
(
bb
);

170 
lšeUpEngše
 = 
Ãw
 
	`LšeUpEngše
(
w®kEngše
);

171 
dribbËEngše
 = 
Ãw
 
	`DribbËEngše
(
w®kEngše
);

172 
isKickšg
 = 
çl£
;

173 
	}
}

175 
	gW®kEngšeP»ProûssÜ
::~
	$W®kEngšeP»ProûssÜ
() {

176 
d–‘e
 
w®kEngše
;

177 
d–‘e
 
lšeUpEngše
;

178 
d–‘e
 
dribbËEngše
;

179 
	}
}

181 
boŞ
 
	$isLšeUpRequœed
(
Body
::
AùiÚTy³
 
aùiÚTy³
) {

182  (
aùiÚTy³
 =ğ
Body
::
DRIBBLE
 ||‡ùiÚTy³ =ğBody::
KICK
);

183 
	}
}

185 
JoštV®ues
 
	gW®kEngšeP»ProûssÜ
::
	$makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

186 
Odom‘ry
* 
odom‘ry
,

187 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

188 
BodyMod–
 &
bodyMod–
,

189 
b®lX
,

190 
b®lY
) {

191 
Body
::
AùiÚTy³
 
aùive
 = 
»que¡
->
body
.
aùiÚTy³
;

194 ià(
aùive
 =ğ
Body
::
DRIBBLE
 && 
dribbËEngše
->
dribbËTim”
.
	`–­£d_ms
() < 400) {

195 
	`toW®kReque¡
(
»que¡
);

196 
aùive
 = 
Body
::
WALK
;

197 
»que¡
->
body
.
fÜw¬d
 = 1;

198 
»que¡
->
body
.
Ëá
 = 0;

199 
»que¡
->
body
.
tuº
 = 0;

203 ià(!
isKickšg
) {

204 ià(!
dribbËEngše
->
	`hasEnded
()) {

205 
dribbËEngše
->
	`´eProûss
(
»que¡
, 
bodyMod–
);

206 
aùive
 = 
Body
::
DRIBBLE
;

208 
dribbËEngše
->
	`»£t
();

211 ià(
	`isLšeUpRequœed
(
»que¡
->
body
.
aùiÚTy³
)) {

213 ià(!
lšeUpEngše
->
hasS¹ed
) {

214 
lšeUpEngše
->
	`¡¬t
(
»que¡
->
body
.
foÙ
);

217 ià(!
lšeUpEngše
->
	`hasEnded
(
»que¡
, 
b®lX
, 
b®lY
)) {

219 
lšeUpEngše
->
	`´eProûss
(
»que¡
, 
b®lX
, 
b®lY
);

220 
aùive
 = 
Body
::
LINE_UP
;

222 
lšeUpEngše
->
	`»£t
();

224 ià(
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
DRIBBLE
) {

226 
dribbËEngše
->
	`¡¬t
(
»que¡
->
body
.
foÙ
);

227 
dribbËEngše
->
	`´eProûss
(
»que¡
, 
bodyMod–
);

228 
aùive
 = 
Body
::
DRIBBLE
;

229 } ià(
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
KICK
) {

232 
isKickšg
 = 
Œue
;

236 
lšeUpEngše
->
	`»£t
();

241 ià(
»que¡
->
body
.
aùiÚTy³
 =ğ
Body
::
KICK
) {

242 
»que¡
->
body
.
tuº
 = 0;

243 
»que¡
->
body
.
¥“d
 = 0;

246 
JoštV®ues
 
jošts
 = 
w®kEngše
->
	`makeJošts
(
»que¡
, 
odom‘ry
, 
£nsÜs
, 
bodyMod–
, 
b®lX
, 
b®lY
);

252 ià(
w®kEngše
->
aùive
.
aùiÚTy³
 =ğ
Body
::
KICK
 && 
»que¡
->
body
.aùiÚTy³ =ğBody::
WALK
) {

253 
isKickšg
 = 
çl£
;

256 ià(
isKickšg
 && 
aùive
 =ğ
Body
::
REF_PICKUP
) {

257 
»que¡
->
body
.
aùiÚTy³
 = 
Body
::
KICK
;

259 
»que¡
->
body
.
aùiÚTy³
 = 
aùive
;

263  
jošts
;

264 
	}
}

266 
boŞ
 
	gW®kEngšeP»ProûssÜ
::
	$isAùive
() {

267  
w®kEngše
->
	`isAùive
(è|| !
dribbËEngše
->
	`hasEnded
();

268 
	}
}

270 
	gW®kEngšeP»ProûssÜ
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

271 
w®kEngše
->
	`»adO±iÚs
(
cÚfig
);

272 
	}
}

274 
	gW®kEngšeP»ProûssÜ
::
	$»£t
() {

275 
w®kEngše
->
	`»£t
();

276 
lšeUpEngše
->
	`»£t
();

277 
dribbËEngše
->
	`»£t
();

278 
isKickšg
 = 
çl£
;

279 
	}
}

281 
	gW®kEngšeP»ProûssÜ
::
	$¡İ
() {

282 
w®kEngše
->
	`¡İ
();

283 
	}
}

	@robot/motion/generator/WalkEnginePreProcessor.hpp

1 #´agm¨
Úû


3 
	~"mÙiÚ/g’”©Ü/W®k2014G’”©Ü.hµ
"

4 
	~"mÙiÚ/g’”©Ü/G’”©Ü.hµ
"

5 
	~"uts/Tim”.hµ
"

6 
	~"bÏckbßrd/BÏckbßrd.hµ
"

8 şas 
	cW®kEngšeP»ProûssÜ
 : 
G’”©Ü
 {

9 
public
:

10 
ex¶ic™
 
W®kEngšeP»ProûssÜ
(
BÏckbßrd
 *
bb
);

11 ~
W®kEngšeP»ProûssÜ
();

12 
JoštV®ues
 
makeJošts
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

13 
Odom‘ry
* 
odom‘ry
,

14 cÚ¡ 
S’sÜV®ues
 &
£nsÜs
,

15 
BodyMod–
 &
bodyMod–
,

16 
b®lX
,

17 
b®lY
);

18 
boŞ
 
isAùive
();

19 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

20 
»£t
();

21 
¡İ
();

23 
	m´iv©e
:

25 şas 
	cLšeUpEngše
 {

26 
public
:

27 
ex¶ic™
 
LšeUpEngše
(
W®k2014G’”©Ü
* 
w®kEngše
);

28 
W®k2014G’”©Ü
* 
	mw®kEngše
;

29 
boŞ
 
	mhasS¹ed
;

30 
	mAùiÚCommªd
::
Body
::
FoÙ
 
foÙ
;

31 
»£t
();

32 
¡¬t
(
AùiÚCommªd
::
Body
::
FoÙ
 
foÙ
);

33 
boŞ
 
hasEnded
(
AùiÚCommªd
::
AÎ
* 
»que¡
, 
b®lX
, 
b®lY
);

34 
´eProûss
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

35 
b®lX
,

36 
b®lY
);

39 şas 
	cDribbËEngše
 {

40 
	gpublic
:

41 
ex¶ic™
 
DribbËEngše
(
W®k2014G’”©Ü
* 
w®kEngše
);

43 
	eDribbËS‹
 {

44 
	gINIT
, 
	gTURN
, 
	gFORWARD
, 
	gEND


47 
DribbËS‹
 
	gdribbËS‹
;

48 
Tim”
 
	gdribbËTim”
;

49 
W®k2014G’”©Ü
* 
	gw®kEngše
;

50 
	gAùiÚCommªd
::
Body
::
FoÙ
 
foÙ
;

51 
»£t
();

52 
boŞ
 
hasEnded
();

53 
¡¬t
(
AùiÚCommªd
::
Body
::
FoÙ
 
foÙ
);

54 
´eProûss
(
AùiÚCommªd
::
AÎ
* 
»que¡
,

55 
BodyMod–
 &
bodyMod–
);

58 
boŞ
 
	gisKickšg
;

59 
LšeUpEngše
* 
	glšeUpEngše
;

60 
DribbËEngše
* 
	gdribbËEngše
;

61 
W®k2014G’”©Ü
* 
	gw®kEngše
;

	@robot/motion/touch/AgentTouch.cpp

32 
	~"mÙiÚ/touch/Ag’tTouch.hµ
"

33 
	~<sys/mmª.h
>

34 
	~<fú.h
>

35 
	~<c¡dlib
>

36 
	~<¡dexû±
>

37 
	~"uts/Logg”.hµ
"

39 
	gAg’tTouch
::
	$Ag’tTouch
() {

41 
£m­hÜe
 = 
	`£m_İ’
(
AGENT_SEMAPHORE
, 
O_RDWR
);

42 ià(
£m­hÜe
 < 0)

43 
throw
 
¡d
::
	`ruÁime_”rÜ
("AgentTouch: sem_open() failed");

46 
sh¬ed_fd
 = 
	`shm_İ’
(
AGENT_MEMORY
, 
O_RDWR
, 0600);

47 ià(
sh¬ed_fd
 < 0)

48 
throw
 
¡d
::
	`ruÁime_”rÜ
("AgentTouch: shm_open() failed");

51 
sh¬ed_d©a
 = (
Ag’tD©a
*è
	`mm­
(
NULL
, (AgentData),

52 
PROT_READ
 | 
PROT_WRITE
,

53 
MAP_SHARED
, 
sh¬ed_fd
, 0);

54 ià(
sh¬ed_d©a
 =ğ
MAP_FAILED
)

55 
throw
 
¡d
::
	`ruÁime_”rÜ
("AgentTouch: mmap() failed");

57 
	`Îog
(
INFO
è<< "Ag’tTouch cÚ¡ruùed" << 
¡d
::
’dl
;

58 
	}
}

60 
	gAg’tTouch
::~
	$Ag’tTouch
() {

61 ià(
sh¬ed_d©a
 !ğ
MAP_FAILED
è
	`munm­
(sh¬ed_d©a, (
Ag’tD©a
));

62 ià(
sh¬ed_fd
 >ğ0è
	`şo£
(shared_fd);

63 ià(
£m­hÜe
 !ğ
SEM_FAILED
è
	`£m_şo£
(semaphore);

64 
	`Îog
(
INFO
è<< "Ag’tTouch de¡royed" << 
¡d
::
’dl
;

65 
	}
}

67 
S’sÜV®ues
 
	gAg’tTouch
::
	$g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
) {

68 
	`£m_wa™
(
£m­hÜe
);

69 !
	`£m_Œywa™
(
£m­hÜe
)) ;

70 
sh¬ed_d©a
->
£nsÜs_»ad
 = sh¬ed_d©a->
£nsÜs_Ï‹¡
;

71  
sh¬ed_d©a
->
£nsÜs
[sh¬ed_d©a->
£nsÜs_»ad
];

72 
	}
}

74 
boŞ
 
	gAg’tTouch
::
	$g‘Sndšg
() {

75  
sh¬ed_d©a
->
¡ªdšg
;

76 
	}
}

78 
Bu‰ÚP»s£s
 
	gAg’tTouch
::
	$g‘Bu‰Ús
() {

79  
sh¬ed_d©a
->
bu‰Ús
[sh¬ed_d©a->
£nsÜs_»ad
];

80 
	}
}

	@robot/motion/touch/AgentTouch.hpp

32 #´agm¨
Úû


34 
	~<£m­hÜe.h
>

35 
	~"mÙiÚ/touch/Touch.hµ
"

36 
	~"libag’t/Ag’tD©a.hµ
"

38 şas 
	cAg’tTouch
 : 
Touch
 {

39 
public
:

40 
ex¶ic™
 
Ag’tTouch
();

41 ~
Ag’tTouch
();

42 
S’sÜV®ues
 
g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
);

43 
boŞ
 
g‘Sndšg
();

44 
Bu‰ÚP»s£s
 
g‘Bu‰Ús
();

46 
	m´iv©e
:

47 
sh¬ed_fd
;

48 
Ag’tD©a
* 
	msh¬ed_d©a
;

49 
£m_t
* 
	m£m­hÜe
;

	@robot/motion/touch/FeetState.cpp

1 
	~"mÙiÚ/touch/F“tS‹.hµ
"

3 
usšg
 
Çme¥aû
 
	gboo¡
::
num”ic
::
ubÏs
;

5 
	gF“tS‹
::
	$F“tS‹
(){

6 
i
 = 0; i < 2; i++){

7 
groundCÚù
[
i
] = 
Œue
;

8 
ZMP
[
i
] = 0;

9 
CoP
[
i
][0] = CoP[i][1] = 0;

10 
foÙPos
[
i
][0] = footPos[i][1] = footPos[i][2] = 0;

12 
	}
}

14 
	gF“tS‹
::
	$upd©e
(cÚ¡ 
S’sÜV®ues
 &
£nsÜs
, 
Kšem©ics
 &
kšem©ics
){

15 
foÙS’sÜ
[2][4];

16 
foÙS’sÜ
[0][0] = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
];

17 
foÙS’sÜ
[0][1] = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
];

18 
foÙS’sÜ
[1][0] = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
];

19 
foÙS’sÜ
[1][1] = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
];

20 
foÙS’sÜ
[0][2] = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
];

21 
foÙS’sÜ
[0][3] = 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

22 
foÙS’sÜ
[1][2] = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
];

23 
foÙS’sÜ
[1][3] = 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
];

25 
groundCÚù
[0] = 
Œue
;

26 
groundCÚù
[1] = 
Œue
;

28 
couÁ
 = 0;

29 
i
 = 0; i < 2; i++){

30 
couÁ
 = 0;

31 
j
 = 0; j < 4; j++){

32 
couÁ
 +ğ(
foÙS’sÜ
[
i
][
j
]*1000.0 > 150);

34 if(
couÁ
 < 2è
groundCÚù
[
i
] = 
çl£
;

37 
m©rix
<> 
ËáFoÙChaš
 =

38 
kšem©ics
.
	`ev®u©eDHChaš
(

39 
Kšem©ics
::
FOOT
,

40 
Kšem©ics
::
BODY
,

41 
Kšem©ics
::
LEFT_CHAIN
);

42 
m©rix
<> 
rightFoÙChaš
 =

43 
kšem©ics
.
	`ev®u©eDHChaš
(

44 
Kšem©ics
::
FOOT
,

45 
Kšem©ics
::
BODY
,

46 
Kšem©ics
::
RIGHT_CHAIN
);

47 
m©rix
<> 
Üigš
 = 
vec4
<>(0, 0, 0, 1);

48 
m©rix
<> 
lf
 = 
	`´od
(
ËáFoÙChaš
, 
Üigš
);

49 
m©rix
<> 
rf
 = 
	`´od
(
rightFoÙChaš
, 
Üigš
);

50 
i
 = 0; i < 3; i++){

51 
foÙPos
[0][
i
] = -
	`lf
(i, 0);

52 
foÙPos
[1][
i
] = -
	`rf
(i, 0);

55 
tÙ®
[2][2] = {{0,0}, {0,0}};

56 
curCoP
[2][2] = {{0,0}, {0,0}};

57 
curZMP
[2] = {0,0};

59 
l
 = 0;† < 2;†++){

60 
i
 = 0; i < 4; i++){

61 
j
 = 0; j < 2; j++){

62 
curCoP
[
l
][
j
] +ğ
S’sÜs
::
FSR_POS
[l][
i
][j] * 
foÙS’sÜ
[l][i];

63 
tÙ®
[
l
][
j
] +ğ
foÙS’sÜ
[l][
i
];

64 
curZMP
[
j
] +ğ(
foÙPos
[
l
][j] + 
S’sÜs
::
FSR_POS
[l][
i
][j]è* 
foÙS’sÜ
[l][i];

69 
l
 = 0;† < 2;†++){

70 
j
 = 0; j < 2; j++){

71 if(
tÙ®
[
l
][
j
] > 0.0001){

72 
curCoP
[
l
][
j
] /ğ
tÙ®
[l][j];

74 
curCoP
[
l
][
j
] = 0;

76 
CoP
[
l
][
j
] +ğ0.5 * (
curCoP
[l][j] - CoP[l][j]);

80 
i
 = 0; i < 2; i++){

81 if((
tÙ®
[0][
i
] +otal[1][i]) > 0.00001){

82 
curZMP
[
i
] /ğ(
tÙ®
[0][i] +otal[1][i]);

84 
curZMP
[
i
] = 0;

86 
ZMP
[
i
] +ğ1.0 * (
curZMP
[i] - ZMP[i]);

88 
	}
}

	@robot/motion/touch/FeetState.hpp

1 #´agm¨
Úû


2 
	~"ty³s/S’sÜV®ues.hµ
"

3 
	~"³rû±iÚ/kšem©ics/Kšem©ics.hµ
"

5 şas 
	cF“tS‹
 {

6 
	mpublic
:

7 
F“tS‹
();

8 
upd©e
(cÚ¡ 
S’sÜV®ues
 &
£nsÜs
, 
Kšem©ics
 &
kšem©ics
);

9 
boŞ
 
	mgroundCÚù
[2];

10 
	mCoP
[2][2];

11 
	mfoÙPos
[2][3];

12 
	mZMP
[2];

	@robot/motion/touch/FilteredTouch.cpp

32 
	~<cm©h
>

33 
	~<veùÜ
>

34 
	~"mÙiÚ/touch/F‹»dTouch.hµ
"

35 
	~<sys/time.h
>

36 
	~"uts/Logg”.hµ
"

37 
	~"uts/¥“ch.hµ
"

38 
	~"uts/Tim”.hµ
"

41 
	#GYR_SCALE
 2.35

42 
	#ACC_SCALE
 9.81/65

	)

43 
	#ANG
 0

	)

44 
	#GYR
 1

	)

45 
	#ACC
 2

	)

46 
	#X
 0

	)

47 
	#Y
 1

	)

48 
	#Z
 2

	)

50 
usšg
 
Çme¥aû
 
	g¡d
;

52 
	gF‹»dTouch
::
	$F‹»dTouch
(
Touch
* 
t
)

53 : 
	`touch
(
t
),

54 
	$š™
(
Œue
){

55 
	`Îog
(
INFO
è<< "F‹»dTouch cÚ¡ruùed" << 
¡d
::
’dl
;

57 
kf
[1].
	`š™
(1.0/100.0, 0.01, 0.35, 
Œue
);

58 
kf
[0].
	`š™
(1.0/100.0, 0.01, 0.35, 
çl£
);

61 
Ï¡BodyPos™iÚ
 = 
vec4
<>(0, 0, 390, 1);

64 
i
 = 0; i < 3; i++){

65 
j
 = 0; j < 3; j++){

66 
imuOff£t
[
i
][
j
] = 0;

67 
rg‘Off£t
[
i
][
j
] = 0;

68 
couÁ
[
i
][
j
] = 0;

69 
avg
[
i
][
j
] = 0;

70 
”r
[
i
][
j
] = 0;

71 
k
[
i
][
j
] = 0;

74 
´evAng
[0] =…revAng[1] = 0;

77 
	}
}

79 
	gF‹»dTouch
::~
	$F‹»dTouch
() {

80 
	`Îog
(
INFO
è<< "F‹»dTouch de¡Yroyed" << 
¡d
::
’dl
;

81 
	}
}

83 
	gF‹»dTouch
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
){

84 
imuOff£t
[
GYR
][0] =

85 
cÚfig
["touch.gyrXOff£t"].
as
<>();

86 
imuOff£t
[
GYR
][1] =

87 
cÚfig
["touch.gyrYOff£t"].
as
<>();

88 
rg‘Off£t
[
GYR
][0] = 
imuOff£t
[GYR][0];

89 
rg‘Off£t
[
GYR
][1] = 
imuOff£t
[GYR][1];

90 
rg‘Off£t
[
ANG
][0] = 
	`DEG2RAD
(
cÚfig
["touch.ªgËXOff£t"].
as
<>());

91 
rg‘Off£t
[
ANG
][1] = 
	`DEG2RAD
(
cÚfig
["touch.ªgËYOff£t"].
as
<>());

92 
	}
}

94 
	gF‹»dTouch
::
	$g‘SÿËdGyr
(
isY
){

95  
	`DEG2RAD
(
upd©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
 + 
isY
])/
GYR_SCALE
;

96 
	}
}

98 
	gF‹»dTouch
::
	$f‹rOff£t
(
IMUid
, 
dœ
, 
obs
){

99 cÚ¡ 
´ocE¼
[3] = {0.001, 1, 1};

100 cÚ¡ 
m—sE¼
[3] = {0.004, 12, 12};

101 cÚ¡ 
toCouÁ
[3] = {400, 200, 200};

102 
couÁ
[
IMUid
][
dœ
]++;

103 
avg
[
IMUid
][
dœ
] +ğ
obs
;

104 if(
couÁ
[
IMUid
][
dœ
] > 
toCouÁ
[IMUid]) {

105 
avg
[
IMUid
][
dœ
] =‡vg[IMUid][dœ]/
couÁ
[IMUid][dir];

106 
”r
[
IMUid
][
dœ
] +ğ
´ocE¼
[IMUid];

107 
k
[
IMUid
][
dœ
] = 
”r
[IMUid][dœ]/Ó¼[IMUid][dœ] + 
m—sE¼
[IMUid]);

108 
rg‘Off£t
[
IMUid
][
dœ
] +ğ(
avg
[IMUid][dœ] -¬g‘Off£t[IMUid][dœ]è* 
k
[IMUid][dir];

109 
”r
[
IMUid
][
dœ
] = (1.0 - 
k
[IMUid][dir]) *ƒrr[IMUid][dir];

110 
couÁ
[
IMUid
][
dœ
] = 0;

111 
avg
[
IMUid
][
dœ
] = 0;

113 
	}
}

115 
	gF‹»dTouch
::
	$upd©eIMUOff£t
(){

116 
»®V–
[2];

117 
»®V–
[0] = 
	`RAD2DEG
(
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
] - 
´evAng
[0]) * 100.0;

118 
»®V–
[1] = 
	`RAD2DEG
(
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
] - 
´evAng
[1]) * 100.0;

119 
´evAng
[0] = 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
];

120 
´evAng
[1] = 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
];

122 if(
ã‘S‹
.
groundCÚù
[0] || feetState.groundContact[1]){

124 
i
 = 0; i < 2; i++){

125 if(
	`çbs
(
»®V–
[
i
]) < 0.3){

126 
	`f‹rOff£t
(
GYR
, 
i
, -
upd©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
 + i]);

132 
j
 = 0; j < 3; j++){

133 
i
 = 0; i < 3; i++){

134 
imuOff£t
[
j
][
i
] +ğ(
rg‘Off£t
[j][i] - imuOffset[j][i]) * .03;

139 
i
 = 0; i < 2; i++){

140 
upd©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
 + 
i
] +ğ
imuOff£t
[
ANG
][i];

141 
upd©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
 + 
i
] +ğ
imuOff£t
[
GYR
][i];

143 
i
 = 0; i < 3; i++){

144 
upd©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccX
 + 
i
] +ğ
imuOff£t
[
ACC
][i];

148 
	}
}

150 
	$upd©eAvg
(
numb”
, 
i
) {

151 
sum
[2] = {0, 0};

152 
couÁ
[2] = {0, 0};

153 
avg
;

154 if(
couÁ
[
i
] > 0){

155 
avg
 = ((
sum
[
i
] + 
numb”
è* 
couÁ
[i] - (count[i] + 1) * sum[i])/((count[i]+1) * count[i])

156 + 
sum
[
i
]/
couÁ
[i];

158 
avg
 = 
numb”
;

160 
sum
[
i
] +ğ
numb”
;

161 
couÁ
[
i
]++;

162  
avg
;

163 
	}
}

165 
	gF‹»dTouch
::
	$f‹rS’sÜs
(){

166 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccX
] = 
upd©e
.£nsÜs[S’sÜs::
IÃ¹ŸlS’sÜ_AcûËrom‘”X
];

167 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccY
] = 
upd©e
.£nsÜs[S’sÜs::
IÃ¹ŸlS’sÜ_AcûËrom‘”Y
];

168 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccZ
] = 
upd©e
.£nsÜs[S’sÜs::
IÃ¹ŸlS’sÜ_AcûËrom‘”Z
];

170 
	`upd©eIMUOff£t
();

172 
¡©e
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_C’‹rOfP»ssu»_X
] = 
ã‘S‹
.
CoP
[0][0];

173 
¡©e
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_C’‹rOfP»ssu»_Y
] = 
ã‘S‹
.
CoP
[0][1];

174 
¡©e
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_C’‹rOfP»ssu»_X
] = 
ã‘S‹
.
CoP
[1][0];

175 
¡©e
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_C’‹rOfP»ssu»_Y
] = 
ã‘S‹
.
CoP
[1][1];

177 
m©rix
<> 
obs
[2] = {matrix<>(2, 1), matrix<>(2, 1)};

178 
i
 = 0; i < 2; i++){

179 
obs
[
i
](0, 0èğ
upd©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
 + i];

180 
obs
[
i
](1, 0èğ
	`g‘SÿËdGyr
(i);

181 
m©rix
<> 
e¡
 = 
kf
[
i
].
	`upd©e
(
obs
[i], 
ã‘S‹
);

182 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
 + 
i
] = 
	`e¡
(0, 0);

183 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
 + 
i
] = 
	`e¡
(1, 0);

186 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyroscİeZ
] = 
upd©e
.sensors[Sensors::InertialSensor_GyroscopeZ];

193 
	}
}

195 
S’sÜV®ues
 
	gF‹»dTouch
::
	$g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
) {

196 
upd©e
 = 
touch
->
	`g‘S’sÜs
(
kšem©ics
);

197 
F‹»dTouch
::
kšem©ics
 = kinematics;

199 
timev®
 
tv
;

200 
boŞ
 
§id
 = 
çl£
;

201 
	`g‘timeofday
(&
tv
, 
NULL
);

202 ià(
tv
.
tv_£c
 % 5 =ğ0 && !
§id
) {

203 ià(
upd©e
.
sÚ¬
[0] < 
SÚ¬
::
MIN
) {

207 
§id
 = (
tv
.
tv_£c
 % 5 == 0);

208 ià(
š™
) {

209 
š™
 = 
çl£
;

210 
¡©e
 = 
upd©e
;

211 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
] = 0;

212 
¡©e
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrY
] = 0;

213 
ušt8_t
 
i
 = 0; i < 
SÚ¬
::
NUMBER_OF_READINGS
; ++i) {

214 ià(
¡©e
.
sÚ¬
[
i
] >ğ
SÚ¬
::
INVALID
 )

215 
¡©e
.
sÚ¬
[
i
] = 
SÚ¬
::
DISCARD
;

216 ià(
¡©e
.
sÚ¬
[
i
] <ğ
SÚ¬
::
MIN
)

217 
¡©e
.
sÚ¬
[
i
] = 
SÚ¬
::
MIN
;

220 
¡©e
.
jošts
 = 
upd©e
.joints;

221 
ušt8_t
 
i
;

222 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i){

224 if((
i
 < 
S’sÜs
::
IÃ¹ŸlS’sÜ_AccX
 || i > S’sÜs::
IÃ¹ŸlS’sÜ_AngËY
è&& i !ğS’sÜs::
IÃ¹ŸlS’sÜ_GyroscİeZ
)

225 
¡©e
.
£nsÜs
[
i
] = 
upd©e
.sensors[i];

227 
i
 = 0; i < 
SÚ¬
::
NUMBER_OF_READINGS
; ++i) {

228 ià(
upd©e
.
sÚ¬
[
i
] >ğ
SÚ¬
::
INVALID
)

229 
upd©e
.
sÚ¬
[
i
] = 
SÚ¬
::
DISCARD
;

230 ià(
upd©e
.
sÚ¬
[
i
] >ğ
SÚ¬
::
MIN
)

231 
¡©e
.
sÚ¬
[
i
] +ğ(
upd©e
.sonar[i] - state.sonar[i]) * 1.0;

233 
ã‘S‹
.
	`upd©e
(
upd©e
, 
kšem©ics
);

234 
	`f‹rS’sÜs
();

237 
csv
.
	`log
(
upd©e
, 
¡©e
);

238  
¡©e
;

239 
	}
}

241 
boŞ
 
	gF‹»dTouch
::
	$g‘Sndšg
() {

242  
touch
->
	`g‘Sndšg
();

243 
	}
}

245 
Bu‰ÚP»s£s
 
	gF‹»dTouch
::
	$g‘Bu‰Ús
() {

246  
touch
->
	`g‘Bu‰Ús
();

247 
	}
}

	@robot/motion/touch/FilteredTouch.hpp

32 #´agm¨
Úû


34 
	~<f¡»am
>

35 
	~"mÙiÚ/touch/Touch.hµ
"

36 
	~"mÙiÚ/touch/TÜsoS‹F‹r.hµ
"

37 
	~"mÙiÚ/touch/S’sÜOuut.hµ
"

39 
usšg
 
Çme¥aû
 
	gboo¡
::
num”ic
::
ubÏs
;

41 şas 
	cF‹»dTouch
 : 
Touch
 {

42 
public
:

43 
ex¶ic™
 
F‹»dTouch
(
Touch
* 
t
);

44 ~
F‹»dTouch
();

45 
S’sÜV®ues
 
g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
);

46 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
);

47 
boŞ
 
g‘Sndšg
();

48 
Bu‰ÚP»s£s
 
g‘Bu‰Ús
();

49 
	m´iv©e
:

50 
Touch
* 
touch
;

51 
S’sÜOuut
 
	mcsv
;

52 
boŞ
 
	mš™
;

53 
S’sÜV®ues
 
	m¡©e
;

54 
S’sÜV®ues
 
	mupd©e
;

55 
F“tS‹
 
	mã‘S‹
;

58 
	mimuOff£t
[3][3];

59 
	mrg‘Off£t
[3][3];

60 
	mavg
[3][3];

61 
	mcouÁ
[3][3];

62 
	mk
[3][3];

63 
	m”r
[3][3];

64 
	m´evAng
[2];

67 
Kšem©ics
 
	mkšem©ics
;

68 
	mm©rix
<> 
	mÏ¡BodyPos™iÚ
;

69 
	mm©rix
<> 
	mbodyRÙ©iÚ
;

70 
	mm©rix
<> 
	mbodyOr›Á©iÚ
;

73 
TÜsoS‹F‹r
 
	mkf
[2];

75 
g‘SÿËdGyr
(
isY
);

76 
upd©eIMUOff£t
();

77 
f‹rOff£t
(
IMUid
, 
dœ
, 
obs
);

78 
f‹rS’sÜs
();

	@robot/motion/touch/NullTouch.cpp

32 
	~"NuÎTouch.hµ
"

34 
S’sÜV®ues
 
	gNuÎTouch
::
	$g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
) {

35  
nuÎS’sÜs
;

36 
	}
}

38 
boŞ
 
	gNuÎTouch
::
	$g‘Sndšg
() {

39  
çl£
;

40 
	}
}

42 
Bu‰ÚP»s£s
 
	gNuÎTouch
::
	$g‘Bu‰Ús
() {

43 
Bu‰ÚP»s£s
 
b
;

44  
b
;

45 
	}
}

	@robot/motion/touch/NullTouch.hpp

32 #´agm¨
Úû


34 
	~"Touch.hµ
"

36 şas 
	cNuÎTouch
 : 
Touch
 {

37 
public
:

38 
S’sÜV®ues
 
g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
);

39 
boŞ
 
g‘Sndšg
();

40 
Bu‰ÚP»s£s
 
g‘Bu‰Ús
();

41 
	m´iv©e
:

42 
S’sÜV®ues
 
nuÎS’sÜs
;

	@robot/motion/touch/SensorOutput.cpp

1 
	~"mÙiÚ/touch/S’sÜOuut.hµ
"

3 
usšg
 
Çme¥aû
 
	g¡d
;

5 
	gS’sÜOuut
::
	$’abË
() {

6 
csv
.
	`İ’
("sensors.csv");

7 
csv
 << "accRaw;accOurs;accTheœs;gyrRaw;gyrOurs;gyrTheœs;ªgËOurs;ªgËTheœs" << 
’dl
;

9 
’abËd
 = 
Œue
;

10 
	}
}

12 
	gS’sÜOuut
::
	$log
(
S’sÜV®ues
 
¿w
, S’sÜV®ue 
f‹»d
) {

13 ià(
’abËd
) {

14 ià(
couÁ”
 < 20000) {

15 
csv
 << 
¿w
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccY
] << ";" << 
f‹»d
.£nsÜs[S’sÜs::IÃ¹ŸlS’sÜ_AccY] << ";" <<„aw.£nsÜs[S’sÜs::
IÃ¹ŸlS’sÜ_AcûËrom‘”Y
] << ";"

16 << 
¿w
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
] << ";" << 
f‹»d
.£nsÜs[S’sÜs::IÃ¹ŸlS’sÜ_GyrX] << ";" <<„aw.£nsÜs[S’sÜs::
IÃ¹ŸlS’sÜ_GyroscİeX
] << ";"

17 << 
f‹»d
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
] << ";" << 
¿w
.£nsÜs[S’sÜs::IÃ¹ŸlS’sÜ_AngËX] << 
’dl
;

19 
couÁ”
++;

21 
csv
.
	`şo£
();

24 
	}
}

	@robot/motion/touch/SensorOutput.hpp

1 #´agm¨
Úû


3 
	~<f¡»am
>

4 
	~"ty³s/S’sÜV®ues.hµ
"

7 şas 
	cS’sÜOuut
 {

8 
	mpublic
:

9 
	$S’sÜOuut
(è: 
	`couÁ”
(0), 
	$’abËd
(
çl£
) {}

10 
	`’abË
();

11 
	`log
(
S’sÜV®ues
 
¿w
, S’sÜV®ue 
f‹»d
);

12 
´iv©e
:

13 
¡d
::
of¡»am
 
csv
;

14 
couÁ”
;

15 
boŞ
 
’abËd
;

16 
	}
};

	@robot/motion/touch/SimTouch.cpp

1 
	~"O¿şe.h
"

2 
	~"uts/Logg”.hµ
"

3 
	~"mÙiÚ/touch/SimTouch.hµ
"

5 
usšg
 
Çme¥aû
 
	g¡d
;

7 
	gSimTouch
::
	$SimTouch
(è: 
	$isFœ¡Time
(
Œue
) {

8 
	`Îog
(
INFO
è<< "Sim Touch in™Ÿli£d" << 
’dl
;

9 
	}
}

11 
	gSimTouch
::~
	$SimTouch
() {

12 
	`Îog
(
INFO
è<< "Sim Touch de¡royed" << 
’dl
;

13 
	}
}

15 
S’sÜV®ues
 
	gSimTouch
::
	$g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
) {

16  
Üaşe
->
	`g‘S’sÜV®ues
();

17 
	}
}

19 
boŞ
 
	gSimTouch
::
	$g‘Sndšg
() {

20 ià(
isFœ¡Time
) {

21 
isFœ¡Time
 = 
çl£
;

22  
Œue
;

24  
çl£
;

25 
	}
}

28 
Bu‰ÚP»s£s
 
	gSimTouch
::
	$g‘Bu‰Ús
() {

29  *(
Ãw
 
	`Bu‰ÚP»s£s
());

30 
	}
}

	@robot/motion/touch/SimTouch.hpp

1 #´agm¨
Úû


3 
	~"mÙiÚ/touch/Touch.hµ
"

5 şas 
	cSimTouch
 : 
Touch
 {

6 
public
:

7 
ex¶ic™
 
SimTouch
();

8 ~
SimTouch
();

10 
S’sÜV®ues
 
g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
);

11 
boŞ
 
g‘Sndšg
();

12 
Bu‰ÚP»s£s
 
g‘Bu‰Ús
();

14 
	m´iv©e
:

15 
boŞ
 
isFœ¡Time
;

	@robot/motion/touch/TorsoStateFilter.cpp

1 
	~<cm©h
>

2 
	~"TÜsoS‹F‹r.hµ
"

3 
	~"uts/ªgËs.hµ
"

4 
	~"uts/Tim”.hµ
"

5 
	~"mÙiÚ/touch/F‹»dTouch.hµ
"

7 
	#STATE_DIM
 2

	)

9 
	#PROCESS_ANGLE_SD
 0.01

	)

10 
	#PROCESS_VEL_SD
 0.1

	)

11 
	#SIDE_ANGLE_SD
 0.01

	)

12 
	#SIDE_VEL_SD
 0.1

	)

13 
	#H
 245

	)

15 
	gTÜsoS‹F‹r
::
	$TÜsoS‹F‹r
(){

16 
e¡
 = 
m©rix
<>(
STATE_DIM
, 1);

17 
e¡B¬
 = 
m©rix
<>(
STATE_DIM
, 1);

18 
i
 = 0; i < 
STATE_DIM
; i++){

19 
	`e¡
(
i
, 0èğ
	`e¡B¬
(i, 0) = 0;

22 
covE¡
 = 
m©rix
<>(
STATE_DIM
, STATE_DIM);

23 
covE¡B¬
 = 
m©rix
<>(
STATE_DIM
, STATE_DIM);

25 
covR
 = 
m©rix
<>(
STATE_DIM
, STATE_DIM);

26 
covQ
 = 
m©rix
<>(
STATE_DIM
, STATE_DIM);

28 
i
 = 0; i < 
STATE_DIM
; i++){

29 
j
 = 0; j < 
STATE_DIM
; j++){

30 
	`covE¡
(
i
, 
j
èğcovE¡(i, jèğ
	`covR
(i, jèğ
	`covQ
(i, j) = 0;

34 
	`covR
(0, 0èğ
PROCESS_ANGLE_SD
 * PROCESS_ANGLE_SD;

35 
	`covR
(1, 1èğ
PROCESS_VEL_SD
 * PROCESS_VEL_SD;

36 
	}
}

38 
	gTÜsoS‹F‹r
::
	$š™
(
dt
, 
obsAngËSD
, 
obsV–SD
, 
boŞ
 
äÚl
){

39 
TÜsoS‹F‹r
::
dt
 = dt;

40 
TÜsoS‹F‹r
::
äÚl
 = frontal;

41 
	`covQ
(0, 0èğ
obsAngËSD
 * obsAngleSD;

42 
	`covQ
(0, 1) = covQ(1, 0) = 0;

43 
	`covQ
(1, 1èğ
obsV–SD
 * obsVelSD;

44 if(!
äÚl
){

45 
	`covR
(0, 0èğ
SIDE_ANGLE_SD
*SIDE_ANGLE_SD;

46 
	`covR
(1, 1èğ
SIDE_VEL_SD
*SIDE_VEL_SD;

48 
	}
}

50 
	gTÜsoS‹F‹r
::~
	$TÜsoS‹F‹r
(){
	}
}

53 
m©rix
<> 
šv”t
(m©rix<> &
m
){

54 
‹mp
 = 
m
(1, 1);

55 
m
(1, 1) = m(0, 0);

56 
m
(0, 0èğ
‹mp
;

57 
m
(0, 1) *= -1.0;

58 
m
(1, 0) *= -1.0;

59 
	gd‘
 = 
m
(0, 0) * m(1, 1) - m(1, 0) * m(0, 1);

60 
	gi
 = 0; i < 2; i++){

61 
	gj
 = 0; j < 2; j++){

62 
m
(
i
, 
j
è/ğ
d‘
;

65  
	gm
;

68 
	gTÜsoS‹F‹r
::
g‘Fulüum
(
m©rix
<> 
obs
, 
F“tS‹
 
ã‘S‹
){

69 
	#BACK_LIM
 -55

	)

70 
	#FRONT_LIM
 90

	)

71 
	#COP_OFFSET
 0

	)

72 
	gfulüum
 = 0.0;

73 if(
	gäÚl
){

75 
	gfulüum
 = 
RAD2DEG
(
e¡
(0, 0)) * 6.5;

76 if(
e¡
(0,0è< 0è
	gfulüum
 *= 1.6;

77 if(
	gfulüum
 > 
	gFRONT_LIM
èfulüum = 
FRONT_LIM
;

78 if(
	gfulüum
 < 
	gBACK_LIM
èfulüum = 
BACK_LIM
;

79 if(
	gã‘S‹
.
	ggroundCÚù
[0] && feetState.groundContact[1]){

80 
	gfulüum
 +ğ(
ã‘S‹
.
foÙPos
[0][0] + feetState.footPos[1][0])/2.0;

82 
	gfulüum
 +ğ(
ã‘S‹
.
foÙPos
[0][0]è* f“tS‹.
groundCÚù
[0]

83 + (
ã‘S‹
.
foÙPos
[1][0]è* f“tS‹.
groundCÚù
[1];

86 
	gfulüum
 = -
ã‘S‹
.
ZMP
[1];

89  
	gfulüum
;

92 
	gm©rix
<> 
	gTÜsoS‹F‹r
::
upd©e
(
m©rix
<> 
obs
, 
F“tS‹
 
ã‘S‹
) {

93 
	#g
 9810.0

	)

94 
	gfulüum
 = 
g‘Fulüum
(
obs
, 
ã‘S‹
);

97 
	g®pha
;

98 
	g®pha
 = 
©ª
(
fulüum
 / 
H
);

100 
	gl
 = 
sq¹
(
fulüum
 * fulüum + 
H
 * H);

102 
	gm©rix
<> 
A
(
STATE_DIM
, STATE_DIM);

103 
A
(0, 0èğ1.0 + 
dt
*dt*
g
/(2.0*
l
); A(0, 1) = dt;

104 
A
(1, 0èğ
dt
 * 
g
/
l
; A(1, 1) = 1.0;

106 
	gm©rix
<> 
u
(
STATE_DIM
, 1);

107 
u
(0, 0èğ-
dt
*dt*
g
/(2.0*
l
è* 
®pha
;

108 
u
(1, 0èğ-
dt
 * 
g
/
l
 * 
®pha
;

110 
	ge¡B¬
 = 
´od
(
A
, 
e¡
è+ 
	gu
;

112 
	gm©rix
<> 
	g‹mp
 = 
´od
(
A
, 
covE¡
);

113 
	gcovE¡B¬
 = 
´od
(
‹mp
, 
Œªs
(
A
)è+ 
	gcovR
;

116 
	g‹mp
 = 
covE¡B¬
 + 
covQ
;

117 
	gm©rix
<> 
	gšv”£
 = 
šv”t
(
‹mp
);

118 
	gm©rix
<> 
	gk
 = 
´od
(
covE¡B¬
, 
šv”£
);

120 
	ge¡
 = 
e¡B¬
 + 
´od
(
k
, 
obs
 -ƒstBar);

122 
	gid’t™y_m©rix
<> 
I
(
STATE_DIM
);

123 
	gcovE¡
 = 
´od
(
I
 - 
k
, 
covE¡B¬
);

125  
	gm©rix
<>(
	ge¡
);

	@robot/motion/touch/TorsoStateFilter.hpp

5 #´agm¨
Úû


6 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

7 
	~<boo¡/num”ic/ubÏs/io.hµ
>

8 
	~<io¡»am
>

9 
	~"ty³s/S’sÜV®ues.hµ
"

10 
	~"³rû±iÚ/kšem©ics/Kšem©ics.hµ
"

11 
	~"mÙiÚ/touch/F“tS‹.hµ
"

13 
usšg
 
Çme¥aû
 
	gboo¡
::
num”ic
::
ubÏs
;

14 
usšg
 
Çme¥aû
 
	g¡d
;

16 şas 
	cTÜsoS‹F‹r
 {

17 
	mpublic
:

18 
ex¶ic™
 
TÜsoS‹F‹r
();

19 
	mm©rix
<> 
upd©e
(
m©rix
<> 
obs
, 
F“tS‹
 
ã‘S‹
);

20 
š™
(
dt
, 
obsAngËSD
, 
obsV–SD
, 
boŞ
 
äÚl
);

21 ~
TÜsoS‹F‹r
();

23 
	m´iv©e
:

24 
m©rix
<> 
e¡
;

25 
	mm©rix
<> 
	me¡B¬
;

26 
	mm©rix
<> 
	mcovE¡
;

27 
	mm©rix
<> 
	mcovE¡B¬
;

28 
	mm©rix
<> 
	mcovR
;

29 
	mm©rix
<> 
	mcovQ
;

31 
	mdt
;

32 
boŞ
 
	mäÚl
;

34 
g‘Fulüum
(
m©rix
<> 
obs
, 
F“tS‹
 
ã‘S‹
);

	@robot/motion/touch/Touch.hpp

32 #´agm¨
Úû


34 
	~"ty³s/Bu‰ÚP»s£s.hµ
"

35 
	~"ty³s/S’sÜV®ues.hµ
"

36 
	~"³rû±iÚ/kšem©ics/Kšem©ics.hµ
"

37 
	~<boo¡/´og¿m_İtiÚs/v¬ŸbËs_m­.hµ
>

42 şas 
	cTouch
 {

43 
	mpublic
:

44 
vœtu®
 ~
	$Touch
() {}

49 
vœtu®
 
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
){
	}
}

50 
vœtu®
 
S’sÜV®ues
 
g‘S’sÜs
(
Kšem©ics
 &
kšem©ics
) = 0;

52 
vœtu®
 
boŞ
 
g‘Sndšg
() = 0;

53 
vœtu®
 
Bu‰ÚP»s£s
 
g‘Bu‰Ús
() = 0;

	@robot/perception/PerceptionThread.cpp

32 
	~"³rû±iÚ/P”û±iÚTh»ad.hµ
"

34 
	~<±h»ad.h
>

35 
	~<ùime
>

36 
	~<ut™y
>

37 
	~<boo¡/®gÜ™hm/¡ršg.hµ
>

38 
	~<boo¡/®gÜ™hm/¡ršg/şassifiÿtiÚ.hµ
>

40 
	~"³rû±iÚ/dum³r/P”û±iÚDum³r.hµ
"

41 
	~"³rû±iÚ/behaviour/SaãtySkl.hµ
"

42 
	~"socûr.hµ
"

43 
	~"bÏckbßrd/BÏckbßrd.hµ
"

44 
	~"uts/Logg”.hµ
"

45 
	~"th»ad/Th»ad.hµ
"

46 
	~"boo¡/Ëxiÿl_ÿ¡.hµ
"

47 
	~<boo¡/bšd.hµ
>

49 
usšg
 
Çme¥aû
 
	g¡d
;

50 
usšg
 
Çme¥aû
 
	gboo¡
;

52 
	gP”û±iÚTh»ad
::
	$P”û±iÚTh»ad
(
BÏckbßrd
 *
bb
)

53 : 
	`Ad­‹r
(
bb
),

54 
	`kšem©icsAd­‹r
(
bb
),

55 
	`visiÚAd­‹r
(
bb
),

56 
	`loÿli§tiÚAd­‹r
(
bb
),

57 
	`behaviourAd­‹r
(
bb
),

58 
	$bb_
(
bb
)

60 
dum³r
 = 
NULL
;

62 
	`»Ëa£Lock
(
£rŸliz©iÚ
);

64 
ušt8_t
 cÚ¡* 
tİF¿me
 = 
	`»adFrom
(
visiÚ
,opFrame);

65 
ušt8_t
 cÚ¡* 
bÙF¿me
 = 
	`»adFrom
(
visiÚ
, botFrame);

66 
size_t
 
»t
;

68 ià(
tİF¿me
 !ğ
NULL
 && 
bÙF¿me
 != NULL) {

69 
¡ršg
 
fe
 = "/home/nao/crashframe-" +

70 
boo¡
::
Ëxiÿl_ÿ¡
<
¡ršg
>(
	`time
(
NULL
)) + ".yuv";

71 
FILE
 *
”rÜF¿meFe
 = 
	`fİ’
(
fe
.
	`c_¡r
(), "w");

72 
»t
 = 
	`fwr™e
(
tİF¿me
, 640 * 480 * 2, 1, 
”rÜF¿meFe
);

73 
»t
 = 
	`fwr™e
(
bÙF¿me
, 640 * 480 * 2, 1, 
”rÜF¿meFe
);

74 
	`fşo£
(
”rÜF¿meFe
);

75 
fe
 = "/usr/bin/tail -n 200 /var/volatile/runswift/*/Perception > "

76 + 
fe
 + ".log";

77 
»t
 = 
¡d
::
	`sy¡em
(
fe
.
	`c_¡r
());

81 
	`»adO±iÚs
(
bb
->
cÚfig
);

82 
	`wr™eTo
(
th»ad
, 
cÚfigC®lbacks
[
Th»ad
::
Çme
],

83 
boo¡
::
funùiÚ
<(cÚ¡ boo¡::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &)>

84 (
boo¡
::
	`bšd
(&
P”û±iÚTh»ad
::
»adO±iÚs
, 
this
, 
_1
)));

85 
	}
}

87 
	gP”û±iÚTh»ad
::~
	$P”û±iÚTh»ad
() {

88 
	`Îog
(
INFO
è<< 
__PRETTY_FUNCTION__
 << 
’dl
;

89 
	`wr™eTo
(
th»ad
, 
cÚfigC®lbacks
[
Th»ad
::
Çme
], 
boo¡
::
funùiÚ
<(cÚ¡ boo¡::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &)>());

90 
	}
}

92 
	gP”û±iÚTh»ad
::
	$tick
() {

93 
	`Îog_İ’
(
VERBOSE
è<< "P”û±iÚ Th»ad" << 
’dl
;

95 
Tim”
 
tim”_th»ad
;

96 
Tim”
 
tim”_tick
;

97 
ušt32_t
 
tim”_time
;

102 
	`Îog_İ’
(
VERBOSE
è<< "Kšem©ic Tick" << 
’dl
;

103 
tim”_tick
.
	`»¡¬t
();

104 
kšem©icsAd­‹r
.
	`tick
();

106 
tim”_time
 = 
tim”_tick
.
	`–­£d_us
();

107 ià(
tim”_time
 > 
TICK_MAX_TIME_KINEMATICS
) {

108 
	`Îog_şo£
(
VERBOSE
è<< "Kšem©ic Tick: OK " << 
tim”_time
 << " us" << 
’dl
;

110 
	`Îog_şo£
(
ERROR
è<< "Kšem©ic Tick: TOO LONG " << 
tim”_time
 << " us" << 
’dl
;

116 
	`Îog_İ’
(
VERBOSE
è<< "VisiÚ Tick" << 
’dl
;

117 
tim”_tick
.
	`»¡¬t
();

118 
visiÚAd­‹r
.
	`tick
();

120 
tim”_time
 = 
tim”_tick
.
	`–­£d_us
();

121 ià(
tim”_time
 > 
TICK_MAX_TIME_VISION
) {

122 
	`Îog_şo£
(
VERBOSE
è<< "VisiÚ Tick: OK " << 
tim”_time
 << 
’dl
;

124 
	`Îog_şo£
(
ERROR
è<< "VisiÚ Tick: TOO LONG " << 
tim”_time
 << 
’dl
;

130 
	`Îog_İ’
(
VERBOSE
è<< "Loÿli§tiÚ Tick" << 
’dl
;

131 
tim”_tick
.
	`»¡¬t
();

132 
loÿli§tiÚAd­‹r
.
	`tick
();

134 
tim”_time
 = 
tim”_tick
.
	`–­£d_us
();

135 ià(
tim”_time
 > 
TICK_MAX_TIME_LOCALISATION
) {

136 
	`Îog_şo£
(
VERBOSE
è<< "Loÿli§tiÚ Tick: OK " << 
tim”_time
 << 
’dl
;

138 
	`Îog_şo£
(
ERROR
è<< "Loÿli§tiÚ Tick: TOO LONG " << 
tim”_time
 << 
’dl
;

144 
	`Îog_İ’
(
VERBOSE
è<< "Behaviou¸Tick" << 
’dl
;

145 
tim”_tick
.
	`»¡¬t
();

146 
	`±h»ad_y›ld
();

148 ià(
	`time
(
NULL
è- 
	`»adFrom
(
»mÙeCÚŒŞ
, 
time_»ûived
) < 60) {

150 
wr™eBuf
 = (
	`»adFrom
(
behaviour
, 
»adBuf
) + 1) % 2;

151 
	`wr™eTo
(
behaviour
, 
»que¡
[
wr™eBuf
], 
	`»adFrom
(
»mÙeCÚŒŞ
,„equest));

152 
	`wr™eTo
(
behaviour
, 
»adBuf
, 
wr™eBuf
);

154 
behaviourAd­‹r
.
	`tick
();

157 
tim”_time
 = 
tim”_tick
.
	`–­£d_us
();

158 ià(
tim”_time
 > 
TICK_MAX_TIME_BEHAVIOUR
) {

159 
	`Îog_şo£
(
VERBOSE
è<< "Behaviou¸Tick (ªd…”û±iÚ y›ld): OK " << 
tim”_time
 << 
’dl
;

161 
	`Îog_şo£
(
ERROR
è<< "Behaviou¸Tick (ªd…”û±iÚ y›ld): TOO LONG " << 
tim”_time
 << 
’dl
;

167 
tim”_time
 = 
tim”_th»ad
.
	`–­£d_us
();

168 ià(
tim”_time
 > 
THREAD_MAX_TIME
) {

169 
	`Îog_şo£
(
VERBOSE
è<< "P”û±iÚ Th»ad: OK " << 
tim”_time
 << 
’dl
;

171 
	`Îog_şo£
(
ERROR
è<< "P”û±iÚ Th»ad: TOO LONG " << 
tim”_time
 << 
’dl
;

174 ià(
dum³r
) {

175 ià(
dump_tim”
.
	`–­£d_us
(è> 
dump_¿‹
) {

176 
dump_tim”
.
	`»¡¬t
();

177 
Œy
 {

178 
dum³r
->
	`dump
(
bb_
);

179 } 
	`ÿtch
(cÚ¡ 
¡d
::
exû±iÚ
 &
e
) {

180 
©‹m±šgShutdown
 = 
Œue
;

181 
cout
 << "E¼Ü: " << 
e
.
	`wh©
(è<< 
’dl
;

185 
	}
}

187 
	gP”û±iÚTh»ad
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
& 
cÚfig
) {

188 cÚ¡ 
¡ršg
 &
e
 = 
cÚfig
["visiÚ.ÿm”a_cÚŒŞs"].
as
<string>();

189 
veùÜ
<
¡ršg
> 
vs
;

190 
	`¥l™
(
vs
, 
e
, 
	`is_ªy_of
(",;"));

191 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
ci
 = 
vs
.
	`begš
(); c˜!ğvs.
	`’d
(); ++ci) {

192 
veùÜ
<
¡ršg
> 
nv
;

193 
	`¥l™
(
nv
, *
ci
, 
	`is_ªy_of
(":"));

194 ià(
nv
.
	`size
() != 3)

195 
	`Îog
(
ERROR
è<< "cÚŒŞ should bÿm:cÚŒŞ_id:v®ue" << 
’dl
;

197 
Cam”a
 *
cu¼Cam”a
;

198 if(
	`¡¹Ş
(
nv
[0].
	`c_¡r
(),
NULL
,10) == 0){

199 
cu¼Cam”a
 = 
visiÚAd­‹r
.
combšed_ÿm”a_
->
	`g‘Cam”aBÙ
();

201 
cu¼Cam”a
 = 
visiÚAd­‹r
.
combšed_ÿm”a_
->
	`g‘Cam”aTİ
();

203 if(
	`¡¹oul
(
nv
[1].
	`c_¡r
(), 
NULL
, 10) == 0)

204 
cu¼Cam”a
->
	`£tCÚŒŞ
(22,1);

205 if(
	`¡¹oul
(
nv
[1].
	`c_¡r
(), 
NULL
, 10) == 17)

206 
cu¼Cam”a
->
	`£tCÚŒŞ
(22,0);

207 if(
	`¡¹oul
(
nv
[1].
	`c_¡r
(), 
NULL
, 10) == 19)

208 
cu¼Cam”a
->
	`£tCÚŒŞ
(22,0);

209 
cu¼Cam”a
->
	`£tCÚŒŞ
(
	`¡¹oul
(
nv
[1].
	`c_¡r
(), 
NULL
, 10),

210 
	`¡¹Ş
 (
nv
[2].
	`c_¡r
(), 
NULL
, 10));

214 cÚ¡ 
¡ršg
 &
dumpP©h
 = 
cÚfig
["debug.dump"].
as
<string>();

215 
dump_¿‹
 = 
cÚfig
["visiÚ.dum´©e"].
as
<>() * 1000;

216 ià(
dumpP©h
 == "") {

217 
d–‘e
 
dum³r
;

218 
dum³r
 = 
NULL
;

220 ià(! 
dum³r
 || dum³r->
	`g‘P©h
(è!ğ
dumpP©h
) {

221 
d–‘e
 
dum³r
;

222 
dum³r
 = 
Ãw
 
	`P”û±iÚDum³r
(
dumpP©h
.
	`c_¡r
());

226 
OffNaoMask_t
 
dumpMask
 = 
cÚfig
["debug.mask"].
as
<>();

227 
bb_
->
	`wr™e
(&(bb_->
mask
), 
dumpMask
);

228 
	}
}

	@robot/perception/PerceptionThread.hpp

32 #´agm¨
Úû


34 
	~<PythÚ.h
>

35 
	~<¡ršg
>

36 
	~"³rû±iÚ/visiÚ/VisiÚAd­‹r.hµ
"

37 
	~"³rû±iÚ/loÿli§tiÚ/Loÿli§tiÚAd­‹r.hµ
"

38 
	~"³rû±iÚ/behaviour/BehaviourAd­‹r.hµ
"

39 
	~"³rû±iÚ/kšem©ics/Kšem©icsAd­‹r.hµ
"

40 
	~"³rû±iÚ/dum³r/P”û±iÚDum³r.hµ
"

41 
	~"³rû±iÚ/visiÚ/ÿm”a/CombšedCam”a.hµ
"

42 
	~"bÏckbßrd/Ad­‹r.hµ
"

44 
	#THREAD_MAX_TIME
 33666

	)

46 
	#TICK_MAX_TIME_VISION
 30000

	)

47 
	#TICK_MAX_TIME_KINEMATICS
 30000

	)

48 
	#TICK_MAX_TIME_LOCALISATION
 30000

	)

49 
	#TICK_MAX_TIME_BEHAVIOUR
 30000

	)

53 şas 
	cP”û±iÚTh»ad
 : 
Ad­‹r
 {

54 
public
:

56 
P”û±iÚTh»ad
(
BÏckbßrd
 *
bb
);

58 ~
P”û±iÚTh»ad
();

61 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

64 
tick
();

66 
	m´iv©e
:

67 
Kšem©icsAd­‹r
 
kšem©icsAd­‹r
;

68 
VisiÚAd­‹r
 
	mvisiÚAd­‹r
;

70 
Loÿli§tiÚAd­‹r
 
	mloÿli§tiÚAd­‹r
;

71 
BehaviourAd­‹r
 
	mbehaviourAd­‹r
;

73 
BÏckbßrd
* 
	mbb_
;

75 
P”û±iÚDum³r
 *
	mdum³r
;

76 
Tim”
 
	mdump_tim”
;

77 
	mdump_¿‹
;

	@robot/perception/audio/whistle/pyalsaaudio-0.7/alsaaudio.c

16 
	~"PythÚ.h
"

17 #ià
PY_MAJOR_VERSION
 < 3 && 
PY_MINOR_VERSION
 < 6

18 
	~"¡ršgobjeù.h
"

19 
	#PyUnicode_FromSŒšg
 
PySŒšg_FromSŒšg


	)

21 
	~<®§/asoundlib.h
>

22 
	~<¡dio.h
>

24 
PyDoc_STRVAR
(
®§audio_moduË_doc
,

34 
	mPyObjeù_HEAD
;

35 
	mpcmty³
;

36 
	mpcmmode
;

37 *
	mÿrdÇme
;

39 
¢d_pcm_t
 *
	mhªdË
;

42 
	mchªÃls
;

43 
	m¿‹
;

44 
	mfÜm©
;

45 
¢d_pcm_uäames_t
 
	m³riodsize
;

46 
	mäamesize
;

48 } 
	t®§pcm_t
;

51 
	mPyObjeù_HEAD
;

54 *
	mÿrdÇme
;

55 *
	mcÚŒŞÇme
;

56 
	mcÚŒŞid
;

59 
	mvŞume_ÿp
;

60 
	msw™ch_ÿp
;

61 
	mpchªÃls
;

62 
	mcchªÃls
;

65 
	mpmš
;

66 
	mpmax
;

67 
	mcmš
;

68 
	mcmax
;

69 
¢d_mix”_t
 *
	mhªdË
;

70 } 
	t®§mix”_t
;

76 *
	$Œª¦©e_ÿrdÇme
(*
Çme
)

78 
dæt
[] = "default";

79 *
fuÎ
 = 
NULL
;

81 ià(!
Çme
 || !
	`¡rcmp
Òame, 
dæt
))

82  
	`¡rdup
(
dæt
);

85 ià(
	`¡rchr
(
Çme
, ':'))

86  
	`¡rdup
(
Çme
);

88 
fuÎ
 = 
	`m®loc
(
	`¡¾’
("deçuÉ:CARD="è+ sŒËn(
Çme
) + 1);

89 
	`¥rštf
(
fuÎ
, "deçuÉ:CARD=%s", 
Çme
);

91  
fuÎ
;

92 
	}
}

98 *
	$Œª¦©e_ÿrdidx
(
idx
)

100 
Çme
[32];

102 
	`¥rštf
(
Çme
, "hw:%d", 
idx
);

104  
	`¡rdup
(
Çme
);

105 
	}
}

111 
PyTy³Objeù
 
	gALSAPCMTy³
;

112 
PyObjeù
 *
	gALSAAudioE¼Ü
;

114 
PyObjeù
 *

115 
	$®§ÿrd_li¡
(
PyObjeù
 *
£lf
, PyObjeù *
¬gs
)

117 
rc
;

118 
ÿrd
 = -1;

119 
¢d_ùl_ÿrd_šfo_t
 *
šfo
;

120 
¢d_ùl_t
 *
hªdË
;

121 
PyObjeù
 *
»suÉ
 = 
NULL
;

123 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":cards"))

124  
NULL
;

126 
	`¢d_ùl_ÿrd_šfo_®loÿ
(&
šfo
);

127 
»suÉ
 = 
	`PyLi¡_New
(0);

129 
rc
 = 
	`¢d_ÿrd_Ãxt
(&
ÿrd
); !rc && (card >= 0);

130 
rc
 = 
	`¢d_ÿrd_Ãxt
(&
ÿrd
))

132 
Çme
[32];

133 
”r
;

134 
PyObjeù
 *
™em
;

141 
	`¥rštf
(
Çme
, "hw:%d", 
ÿrd
);

142 ià((
”r
 = 
	`¢d_ùl_İ’
(&
hªdË
, 
Çme
, 0)) < 0) {

143 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,
	`¢d_¡»¼Ü
(
”r
));

144  
NULL
;

146 ià((
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
hªdË
, 
šfo
)) < 0) {

147 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,
	`¢d_¡»¼Ü
(
”r
));

148 
	`¢d_ùl_şo£
(
hªdË
);

149 
	`Py_DECREF
(
»suÉ
);

150  
NULL
;

153 
™em
 = 
	`PyUnicode_FromSŒšg
(
	`¢d_ùl_ÿrd_šfo_g‘_id
(
šfo
));

154 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

155 
	`Py_DECREF
(
™em
);

157 
	`¢d_ùl_şo£
(
hªdË
);

160  
»suÉ
;

161 
	}
}

163 
PyDoc_STRVAR
(
ÿrds_doc
,

168 
	$®§pcm_£tup
(
®§pcm_t
 *
£lf
)

170 
»s
,
dœ
;

171 
v®
;

172 
¢d_pcm_fÜm©_t
 
fmt
;

173 
¢d_pcm_uäames_t
 
äames
;

174 
¢d_pcm_hw_·¿ms_t
 *
hw·¿ms
;

178 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
hw·¿ms
);

179 
»s
 = 
	`¢d_pcm_hw_·¿ms_ªy
(
£lf
->
hªdË
, 
hw·¿ms
);

180 ià(
»s
 < 0)

181  
»s
;

188 
	`¢d_pcm_hw_·¿ms_ªy
(
£lf
->
hªdË
, 
hw·¿ms
);

189 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
£lf
->
hªdË
, 
hw·¿ms
,

190 
SND_PCM_ACCESS_RW_INTERLEAVED
);

191 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
£lf
->
hªdË
, 
hw·¿ms
, s–f->
fÜm©
);

192 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
£lf
->
hªdË
, 
hw·¿ms
,

193 
£lf
->
chªÃls
);

195 
dœ
 = 0;

196 
	`¢d_pcm_hw_·¿ms_£t_¿‹
(
£lf
->
hªdË
, 
hw·¿ms
, s–f->
¿‹
, 
dœ
);

197 
	`¢d_pcm_hw_·¿ms_£t_³riod_size
(
£lf
->
hªdË
, 
hw·¿ms
,

198 
£lf
->
³riodsize
, 
dœ
);

199 
	`¢d_pcm_hw_·¿ms_£t_³riods
(
£lf
->
hªdË
, 
hw·¿ms
, 4, 0);

202 
»s
 = 
	`¢d_pcm_hw_·¿ms
(
£lf
->
hªdË
, 
hw·¿ms
);

206 
	`¢d_pcm_hw_·¿ms_cu¼’t
(
£lf
->
hªdË
, 
hw·¿ms
);

208 
	`¢d_pcm_hw_·¿ms_g‘_fÜm©
(
hw·¿ms
, &
fmt
); 
£lf
->
fÜm©
 = fmt;

209 
	`¢d_pcm_hw_·¿ms_g‘_chªÃls
(
hw·¿ms
, &
v®
); 
£lf
->
chªÃls
 = val;

210 
	`¢d_pcm_hw_·¿ms_g‘_¿‹
(
hw·¿ms
, &
v®
, &
dœ
); 
£lf
->
¿‹
 = val;

211 
	`¢d_pcm_hw_·¿ms_g‘_³riod_size
(
hw·¿ms
, &
äames
, &
dœ
);

212 
£lf
->
³riodsize
 = (è
äames
;

214 
£lf
->
äamesize
 = s–f->
chªÃls
 * 
	`¢d_pcm_hw_·¿ms_g‘_sb™s
(
hw·¿ms
)/8;

216  
»s
;

217 
	}
}

219 
PyObjeù
 *

220 
	$®§pcm_Ãw
(
PyTy³Objeù
 *
ty³
, 
PyObjeù
 *
¬gs
, PyObjeù *
kwds
)

222 
»s
;

223 
®§pcm_t
 *
£lf
;

224 
pcmty³
 = 
SND_PCM_STREAM_PLAYBACK
;

225 
pcmmode
 = 0;

226 *
kw
[] = { "ty³", "mode", "ÿrd", 
NULL
 };

227 *
ÿrdÇme
 = 
NULL
;

229 ià(!
	`PyArg_P¬£Tu¶eAndKeywÜds
(
¬gs
, 
kwds
, "|iiz", 
kw
,

230 &
pcmty³
, &
pcmmode
, &
ÿrdÇme
))

231  
NULL
;

233 ià(!(
£lf
 = (
®§pcm_t
 *)
	`PyObjeù_New
×l§pcm_t, &
ALSAPCMTy³
)))

234  
NULL
;

236 ià(
pcmty³
 !ğ
SND_PCM_STREAM_PLAYBACK
 &&

237 
pcmty³
 !ğ
SND_PCM_STREAM_CAPTURE
)

239 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCMype must be PCM_PLAYBACK (0) "

241  
NULL
;

243 ià(
pcmmode
 < 0 ||…cmmod> 
SND_PCM_ASYNC
) {

244 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Invalid PCM mode");

245  
NULL
;

247 
£lf
->
hªdË
 = 0;

248 
£lf
->
pcmty³
 =…cmtype;

249 
£lf
->
pcmmode
 =…cmmode;

250 
£lf
->
ÿrdÇme
 = 
	`Œª¦©e_ÿrdÇme
(cardname);

251 
£lf
->
chªÃls
 = 2;

252 
£lf
->
¿‹
 = 44100;

253 
£lf
->
fÜm©
 = 
SND_PCM_FORMAT_S16_LE
;

254 
£lf
->
³riodsize
 = 32;

256 
»s
 = 
	`¢d_pcm_İ’
(&(
£lf
->
hªdË
), s–f->
ÿrdÇme
, s–f->
pcmty³
,

257 
£lf
->
pcmmode
);

259 ià(
»s
 >= 0)

260 
»s
 = 
	`®§pcm_£tup
(
£lf
);

262 ià(
»s
 < 0)

264 ià(
£lf
->
hªdË
)

266 
	`¢d_pcm_şo£
(
£lf
->
hªdË
);

267 
£lf
->
hªdË
 = 0;

269 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
»s
));

270  
NULL
;

272  (
PyObjeù
 *)
£lf
;

273 
	}
}

275 
	$®§pcm_d—Îoc
(
®§pcm_t
 *
£lf
)

277 ià(
£lf
->
hªdË
) {

278 
	`¢d_pcm_d¿š
(
£lf
->
hªdË
);

279 
	`¢d_pcm_şo£
(
£lf
->
hªdË
);

281 
	`ä“
(
£lf
->
ÿrdÇme
);

282 
	`PyObjeù_D–
(
£lf
);

283 
	}
}

285 
PyObjeù
 *

286 
	$®§pcm_şo£
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

288 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":close"))

289  
NULL
;

291 ià(
£lf
->
hªdË
)

293 
Py_BEGIN_ALLOW_THREADS


294 
	`¢d_pcm_d¿š
(
£lf
->
hªdË
);

295 
	`¢d_pcm_şo£
(
£lf
->
hªdË
);

296 
Py_END_ALLOW_THREADS


298 
£lf
->
hªdË
 = 0;

301 
	`Py_INCREF
(
Py_NÚe
);

302  
Py_NÚe
;

303 
	}
}

305 
PyDoc_STRVAR
(
pcm_şo£_doc
,

310 
PyObjeù
 *

311 
	$®§pcm_dumpšfo
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

313 
v®
,
v®2
;

314 
¢d_pcm_fÜm©_t
 
fmt
;

315 
dœ
;

316 
¢d_pcm_uäames_t
 
äames
;

317 
¢d_pcm_hw_·¿ms_t
 *
hw·¿ms
;

318 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
hw·¿ms
);

319 
	`¢d_pcm_hw_·¿ms_cu¼’t
(
£lf
->
hªdË
,
hw·¿ms
);

321 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":dumpinfo"))

322  
NULL
;

324 ià(!
£lf
->
hªdË
) {

325 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

326  
NULL
;

329 
	`´štf
("PCM hªdË‚amğ'%s'\n", 
	`¢d_pcm_Çme
(
£lf
->
hªdË
));

330 
	`´štf
("PCM state = %s\n",

331 
	`¢d_pcm_¡©e_Çme
(
	`¢d_pcm_¡©e
(
£lf
->
hªdË
)));

333 
	`¢d_pcm_hw_·¿ms_g‘_acûss
(
hw·¿ms
, (
¢d_pcm_acûss_t
 *è&
v®
);

334 
	`´štf
("acûs ty³ = %s\n", 
	`¢d_pcm_acûss_Çme
((
¢d_pcm_acûss_t
)
v®
));

336 
	`¢d_pcm_hw_·¿ms_g‘_fÜm©
(
hw·¿ms
, &
fmt
);

337 
	`´štf
("format = '%s' (%s)\n",

338 
	`¢d_pcm_fÜm©_Çme
(
fmt
),

339 
	`¢d_pcm_fÜm©_desütiÚ
(
fmt
));

341 
	`¢d_pcm_hw_·¿ms_g‘_subfÜm©
(
hw·¿ms
, (
¢d_pcm_subfÜm©_t
 *)&
v®
);

342 
	`´štf
("subformat = '%s' (%s)\n",

343 
	`¢d_pcm_subfÜm©_Çme
((
¢d_pcm_subfÜm©_t
)
v®
),

344 
	`¢d_pcm_subfÜm©_desütiÚ
((
¢d_pcm_subfÜm©_t
)
v®
));

346 
	`¢d_pcm_hw_·¿ms_g‘_chªÃls
(
hw·¿ms
, &
v®
);

347 
	`´štf
("chªÃl ğ%d\n", 
v®
);

349 
	`¢d_pcm_hw_·¿ms_g‘_¿‹
(
hw·¿ms
, &
v®
, &
dœ
);

350 
	`´štf
("¿‹ = %d bps\n", 
v®
);

352 
	`¢d_pcm_hw_·¿ms_g‘_³riod_time
(
hw·¿ms
, &
v®
, &
dœ
);

353 
	`´štf
("³riodimğ%d us\n", 
v®
);

355 
	`¢d_pcm_hw_·¿ms_g‘_³riod_size
(
hw·¿ms
, &
äames
, &
dœ
);

356 
	`´štf
("³riod sizğ%d f¿mes\n", ()
äames
);

358 
	`¢d_pcm_hw_·¿ms_g‘_bufãr_time
(
hw·¿ms
, &
v®
, &
dœ
);

359 
	`´štf
("bufã¸timğ%d us\n", 
v®
);

361 
	`¢d_pcm_hw_·¿ms_g‘_bufãr_size
(
hw·¿ms
, (
¢d_pcm_uäames_t
 *è&
v®
);

362 
	`´štf
("bufã¸sizğ%d f¿mes\n", 
v®
);

364 
	`¢d_pcm_hw_·¿ms_g‘_³riods
(
hw·¿ms
, &
v®
, &
dœ
);

365 
	`´štf
("³riod ³¸bufã¸ğ%d f¿mes\n", 
v®
);

367 
	`¢d_pcm_hw_·¿ms_g‘_¿‹_numd’
(
hw·¿ms
, &
v®
, &
v®2
);

368 
	`´štf
("exaù„©ğ%d/%d bps\n", 
v®
, 
v®2
);

370 
v®
 = 
	`¢d_pcm_hw_·¿ms_g‘_sb™s
(
hw·¿ms
);

371 
	`´štf
("signifiÿÁ b™ ğ%d\n", 
v®
);

373 
	`¢d_pcm_hw_·¿ms_g‘_³riod_time
(
hw·¿ms
, &
v®
, &
dœ
);

374 
	`´štf
("³riodimğ%d us\n", 
v®
);

376 
v®
 = 
	`¢d_pcm_hw_·¿ms_is_b©ch
(
hw·¿ms
);

377 
	`´štf
("i b©ch = %d\n", 
v®
);

379 
v®
 = 
	`¢d_pcm_hw_·¿ms_is_block_Œªsãr
(
hw·¿ms
);

380 
	`´štf
("i block¿nsã¸ğ%d\n", 
v®
);

382 
v®
 = 
	`¢d_pcm_hw_·¿ms_is_doubË
(
hw·¿ms
);

383 
	`´štf
("i doubË = %d\n", 
v®
);

385 
v®
 = 
	`¢d_pcm_hw_·¿ms_is_h®f_du¶ex
(
hw·¿ms
);

386 
	`´štf
("i h®àdu¶ex = %d\n", 
v®
);

388 
v®
 = 
	`¢d_pcm_hw_·¿ms_is_jošt_du¶ex
(
hw·¿ms
);

389 
	`´štf
("i jošˆdu¶ex = %d\n", 
v®
);

391 
v®
 = 
	`¢d_pcm_hw_·¿ms_ÿn_ov”¿nge
(
hw·¿ms
);

392 
	`´štf
("ÿÀov”¿ngğ%d\n", 
v®
);

394 
v®
 = 
	`¢d_pcm_hw_·¿ms_ÿn_mm­_§m¶e_»sŞutiÚ
(
hw·¿ms
);

395 
	`´štf
("ÿÀmm­ = %d\n", 
v®
);

397 
v®
 = 
	`¢d_pcm_hw_·¿ms_ÿn_·u£
(
hw·¿ms
);

398 
	`´štf
("ÿÀ·u£ = %d\n", 
v®
);

400 
v®
 = 
	`¢d_pcm_hw_·¿ms_ÿn_»sume
(
hw·¿ms
);

401 
	`´štf
("ÿÀ»sumğ%d\n", 
v®
);

403 
v®
 = 
	`¢d_pcm_hw_·¿ms_ÿn_sync_¡¬t
(
hw·¿ms
);

404 
	`´štf
("ÿÀsynø¡¬ˆğ%d\n", 
v®
);

406 
	`Py_INCREF
(
Py_NÚe
);

407  
Py_NÚe
;

408 
	}
}

410 
PyObjeù
 *

411 
	$®§pcm_pcmty³
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

413 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":pcmtype"))

414  
NULL
;

416 ià(!
£lf
->
hªdË
) {

417 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

418  
NULL
;

421  
	`PyLÚg_FromLÚg
(
£lf
->
pcmty³
);

422 
	}
}

424 
PyDoc_STRVAR
(
pcmty³_doc
,

430 
PyObjeù
 *

431 
	$®§pcm_pcmmode
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

433 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":pcmmode"))

434  
NULL
;

436 ià(!
£lf
->
hªdË
) {

437 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

438  
NULL
;

441  
	`PyLÚg_FromLÚg
(
£lf
->
pcmmode
);

442 
	}
}

444 
PyDoc_STRVAR
(
pcmmode_doc
,

453 
PyObjeù
 *

454 
	$®§pcm_ÿrdÇme
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

456 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":cardname"))

457  
NULL
;

459 ià(!
£lf
->
hªdË
) {

460 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

461  
NULL
;

464  
	`PyUnicode_FromSŒšg
(
£lf
->
ÿrdÇme
);

465 
	}
}

467 
PyDoc_STRVAR
(
ÿrdÇme_doc
,

473 
PyObjeù
 *

474 
	$®§pcm_£tchªÃls
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

476 
chªÃls
;

477 
»s
;

478 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"i:£tchªÃls",&
chªÃls
))

479  
NULL
;

481 ià(!
£lf
->
hªdË
) {

482 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

483  
NULL
;

486 
£lf
->
chªÃls
 = channels;

487 
»s
 = 
	`®§pcm_£tup
(
£lf
);

488 ià(
»s
 < 0)

490 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
»s
));

491  
NULL
;

493  
	`PyLÚg_FromLÚg
(
£lf
->
chªÃls
);

494 
	}
}

496 
PyDoc_STRVAR
(
£tchªÃls_doc
,

505 
PyObjeù
 *

506 
	$®§pcm_£Œ©e
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

508 
¿‹
;

509 
»s
;

510 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"i:£Œ©e",&
¿‹
))

511  
NULL
;

513 ià(!
£lf
->
hªdË
)

515 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

516  
NULL
;

519 
£lf
->
¿‹
 =„ate;

520 
»s
 = 
	`®§pcm_£tup
(
£lf
);

521 ià(
»s
 < 0)

523 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
»s
));

524  
NULL
;

526  
	`PyLÚg_FromLÚg
(
£lf
->
¿‹
);

527 
	}
}

529 
PyDoc_STRVAR
(
£Œ©e_doc
,

536 
PyObjeù
 *

537 
	$®§pcm_£tfÜm©
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

539 
fÜm©
;

540 
»s
;

541 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"i:£tfÜm©",&
fÜm©
))

542  
NULL
;

544 ià(!
£lf
->
hªdË
)

546 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

547  
NULL
;

550 
£lf
->
fÜm©
 = format;

551 
»s
 = 
	`®§pcm_£tup
(
£lf
);

552 ià(
»s
 < 0)

554 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
»s
));

555  
NULL
;

557  
	`PyLÚg_FromLÚg
(
£lf
->
fÜm©
);

558 
	}
}

560 
PyDoc_STRVAR
(
£tfÜm©_doc
,

563 
PyObjeù
 *

564 
	$®§pcm_£”iodsize
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

566 
³riodsize
;

567 
»s
;

569 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"i:£”iodsize",&
³riodsize
))

570  
NULL
;

572 ià(!
£lf
->
hªdË
)

574 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

575  
NULL
;

578 
£lf
->
³riodsize
 =…eriodsize;

579 
»s
 = 
	`®§pcm_£tup
(
£lf
);

580 ià(
»s
 < 0)

582 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
»s
));

583  
NULL
;

585  
	`PyLÚg_FromLÚg
(
£lf
->
³riodsize
);

586 
	}
}

588 
PyDoc_STRVAR
(
£”iodsize_doc
,

596 
PyObjeù
 *

597 
	$®§pcm_»ad
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

599 
»s
;

600 
bufãr
[8000];

602 ià(
£lf
->
äamesize
 * s–f->
³riodsize
 > 8000) {

603 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Capture dataoo†arge. "

605  
NULL
;

608 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":read"))

609  
NULL
;

611 ià(!
£lf
->
hªdË
) {

612 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

613  
NULL
;

616 ià(
£lf
->
pcmty³
 !ğ
SND_PCM_STREAM_CAPTURE
)

618 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Cannot„ead from…layback PCM");

619  
NULL
;

622 
Py_BEGIN_ALLOW_THREADS


623 
»s
 = 
	`¢d_pcm_»adi
(
£lf
->
hªdË
, 
bufãr
, s–f->
³riodsize
);

624 ià(
»s
 =ğ-
EPIPE
)

627 
	`¢d_pcm_´•¬e
(
£lf
->
hªdË
);

629 
Py_END_ALLOW_THREADS


631 ià(
»s
 !ğ-
EPIPE
)

633 ià(
»s
 =ğ-
EAGAIN
)

635 
»s
 = 0;

637 ià(
»s
 < 0) {

638 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
»s
));

639  
NULL
;

643 #ià
PY_MAJOR_VERSION
 < 3

644  
	`Py_BudV®ue
("is#", 
»s
, 
bufãr
,„es*
£lf
->
äamesize
);

646  
	`Py_BudV®ue
("iy#", 
»s
, 
bufãr
,„es*
£lf
->
äamesize
);

648 
	}
}

650 
PyDoc_STRVAR
(
»ad_doc
,

663 
PyObjeù
 *
	$®§pcm_wr™e
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

665 
»s
;

666 
d©®’
;

667 *
d©a
;

669 #ià
PY_MAJOR_VERSION
 < 3

670 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"s#:wr™e",&
d©a
,&
d©®’
))

671  
NULL
;

673 
Py_bufãr
 
buf
;

675 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"y*:wr™e",&
buf
))

676  
NULL
;

678 
d©a
 = 
buf
.buf;

679 
d©®’
 = 
buf
.
Ën
;

682 ià(!
£lf
->
hªdË
)

684 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

685  
NULL
;

688 ià(
d©®’
 % 
£lf
->
äamesize
)

690 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,

692  
NULL
;

695 
Py_BEGIN_ALLOW_THREADS


696 
»s
 = 
	`¢d_pcm_wr™ei
(
£lf
->
hªdË
, 
d©a
, 
d©®’
/£lf->
äamesize
);

697 ià(
»s
 =ğ-
EPIPE
)

700 
»s
 = 
	`¢d_pcm_»cov”
(
£lf
->
hªdË
,„es, 1);

701 ià(
»s
 >= 0)

702 
»s
 = 
	`¢d_pcm_wr™ei
(
£lf
->
hªdË
, 
d©a
, 
d©®’
/£lf->
äamesize
);

704 
Py_END_ALLOW_THREADS


706 ià(
»s
 =ğ-
EAGAIN
)

707  
	`PyLÚg_FromLÚg
(0);

708 ià(
»s
 < 0)

710 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,
	`¢d_¡»¼Ü
(
»s
));

711  
NULL
;

714  
	`PyLÚg_FromLÚg
(
»s
);

715 
	}
}

717 
PyDoc_STRVAR
(
wr™e_doc
,

734 
PyObjeù
 *
	$®§pcm_·u£
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

736 
’abËd
=1, 
»s
;

738 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"|i:·u£",&
’abËd
))

739  
NULL
;

741 ià(!
£lf
->
hªdË
) {

742 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

743  
NULL
;

746 
Py_BEGIN_ALLOW_THREADS


747 
»s
 = 
	`¢d_pcm_·u£
(
£lf
->
hªdË
, 
’abËd
);

748 
Py_END_ALLOW_THREADS


750 ià(
»s
 < 0)

752 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,
	`¢d_¡»¼Ü
(
»s
));

753  
NULL
;

755  
	`PyLÚg_FromLÚg
(
»s
);

756 
	}
}

758 
PyDoc_STRVAR
(
·u£_doc
,

764 
PyObjeù
 *

765 
	$®§pcm_pŞldesütÜs
(
®§pcm_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

767 
i
, 
couÁ
, 
rc
;

768 
PyObjeù
 *
»suÉ
;

769 
pŞlfd
 *
fds
;

771 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":polldescriptors"))

772  
NULL
;

774 ià(!
£lf
->
hªdË
)

776 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "PCM device is closed");

777  
NULL
;

780 
couÁ
 = 
	`¢d_pcm_pŞl_desütÜs_couÁ
(
£lf
->
hªdË
);

781 ià(
couÁ
 < 0)

783 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Can't get…oll descriptor count");

784  
NULL
;

787 
fds
 = (
pŞlfd
*)
	`ÿÎoc
(
couÁ
, (pollfd));

788 ià(!
fds
)

790 
	`PyE¼_S‘SŒšg
(
PyExc_MemÜyE¼Ü
, "Out of memory");

791  
NULL
;

794 
»suÉ
 = 
	`PyLi¡_New
(
couÁ
);

795 
rc
 = 
	`¢d_pcm_pŞl_desütÜs
(
£lf
->
hªdË
, 
fds
, ()
couÁ
);

796 ià(
rc
 !ğ
couÁ
)

798 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Can't get…oll descriptors");

799  
NULL
;

802 
i
 = 0; i < 
couÁ
; ++i)

804 
	`PyLi¡_S‘I‹m
(
»suÉ
, 
i
,

805 
	`Py_BudV®ue
("II", 
fds
[
i
].
fd
, fds[i].
ev’ts
));

808  
»suÉ
;

809 
	}
}

811 
PyDoc_STRVAR
(
pcm_pŞldesütÜs_doc
,

820 
PyM‘hodDef
 
	g®§pcm_m‘hods
[] = {

821 {"pcmty³", (
PyCFunùiÚ
)
®§pcm_pcmty³
, 
METH_VARARGS
, 
pcmty³_doc
},

822 {"pcmmode", (
PyCFunùiÚ
)
®§pcm_pcmmode
, 
METH_VARARGS
, 
pcmmode_doc
},

823 {"ÿrdÇme", (
PyCFunùiÚ
)
®§pcm_ÿrdÇme
, 
METH_VARARGS
, 
ÿrdÇme_doc
},

824 {"£tchªÃls", (
PyCFunùiÚ
)
®§pcm_£tchªÃls
, 
METH_VARARGS
,

825 
£tchªÃls_doc
 },

826 {"£Œ©e", (
PyCFunùiÚ
)
®§pcm_£Œ©e
, 
METH_VARARGS
, 
£Œ©e_doc
},

827 {"£tfÜm©", (
PyCFunùiÚ
)
®§pcm_£tfÜm©
, 
METH_VARARGS
, 
£tfÜm©_doc
},

828 {"£”iodsize", (
PyCFunùiÚ
)
®§pcm_£”iodsize
, 
METH_VARARGS
,

829 
£”iodsize_doc
},

830 {"dumpšfo", (
PyCFunùiÚ
)
®§pcm_dumpšfo
, 
METH_VARARGS
},

831 {"»ad", (
PyCFunùiÚ
)
®§pcm_»ad
, 
METH_VARARGS
, 
»ad_doc
},

832 {"wr™e", (
PyCFunùiÚ
)
®§pcm_wr™e
, 
METH_VARARGS
, 
wr™e_doc
},

833 {"·u£", (
PyCFunùiÚ
)
®§pcm_·u£
, 
METH_VARARGS
, 
·u£_doc
},

834 {"şo£", (
PyCFunùiÚ
)
®§pcm_şo£
, 
METH_VARARGS
, 
pcm_şo£_doc
},

835 {"pŞldesütÜs", (
PyCFunùiÚ
)
®§pcm_pŞldesütÜs
, 
METH_VARARGS
,

836 
pcm_pŞldesütÜs_doc
},

837 {
NULL
, NULL}

840 #ià
PY_VERSION_HEX
 < 0x02020000

841 
PyObjeù
 *

842 
	$®§pcm_g‘©Œ
(
®§pcm_t
 *
£lf
, *
Çme
) {

843  
	`Py_FšdM‘hod
(
®§pcm_m‘hods
, (
PyObjeù
 *)
£lf
, 
Çme
);

844 
	}
}

847 
PyTy³Objeù
 
	gALSAPCMTy³
 = {

848 #ià
PY_MAJOR_VERSION
 < 3

849 
PyObjeù_HEAD_INIT
(&
PyTy³_Ty³
)

852 
PyV¬Objeù_HEAD_INIT
(&
PyTy³_Ty³
, 0)

855 (
®§pcm_t
),

858 (
de¡ruùÜ
è
®§pcm_d—Îoc
,

860 #ià
PY_VERSION_HEX
 < 0x02020000

861 (
g‘©Œfunc
)
®§pcm_g‘©Œ
,

874 #ià
PY_VERSION_HEX
 >= 0x02020000

875 
PyObjeù_G’”icG‘A‰r
,

881 
Py_TPFLAGS_DEFAULT
,

889 
®§pcm_m‘hods
,

898 
PyTy³Objeù
 
	gALSAMix”Ty³
;

900 
	#MIXER_CAP_VOLUME
 0x0001

	)

901 
	#MIXER_CAP_VOLUME_JOINED
 0x0002

	)

902 
	#MIXER_CAP_PVOLUME
 0x0004

	)

903 
	#MIXER_CAP_PVOLUME_JOINED
 0x0008

	)

904 
	#MIXER_CAP_CVOLUME
 0x0010

	)

905 
	#MIXER_CAP_CVOLUME_JOINED
 0x0020

	)

907 
	#MIXER_CAP_SWITCH
 0x0001

	)

908 
	#MIXER_CAP_SWITCH_JOINED
 0x0002

	)

909 
	#MIXER_CAP_PSWITCH
 0x0004

	)

910 
	#MIXER_CAP_PSWITCH_JOINED
 0x0008

	)

911 
	#MIXER_CAP_CSWITCH
 0x0010

	)

912 
	#MIXER_CAP_CSWITCH_JOINED
 0x0020

	)

913 
	#MIXER_CAP_CSWITCH_EXCLUSIVE
 0x0040

	)

915 
	#MIXER_CHANNEL_ALL
 -1

	)

918 
	$®§mix”_g‘hªdË
(*
ÿrdÇme
, 
¢d_mix”_t
 **
hªdË
)

920 
”r
;

921 ià((
”r
 = 
	`¢d_mix”_İ’
(
hªdË
, 0)) < 0) ƒrr;

922 ià((
”r
 = 
	`¢d_mix”_©ch
(*
hªdË
, 
ÿrdÇme
)) < 0) ƒrr;

923 ià((
”r
 = 
	`¢d_mix”_£Ëm_»gi¡”
(*
hªdË
, 
NULL
, NULL)) < 0) ƒrr;

924 ià((
”r
 = 
	`¢d_mix”_lßd
(*
hªdË
)) < 0) ƒrr;

927 
	}
}

929 
PyObjeù
 *

930 
	$®§mix”_li¡
(
PyObjeù
 *
£lf
, PyObjeù *
¬gs
)

932 
¢d_mix”_t
 *
hªdË
;

933 
¢d_mix”_£Ëm_id_t
 *
sid
;

934 
¢d_mix”_–em_t
 *
–em
;

935 
”r
;

936 
ÿrdidx
 = 0;

937 
ÿrdÇme
[32];

938 
PyObjeù
 *
»suÉ
;

940 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"|i:mix”s",&
ÿrdidx
))

941  
NULL
;

943 
	`¥rštf
(
ÿrdÇme
, "hw:%d", 
ÿrdidx
);

945 
	`¢d_mix”_£Ëm_id_®loÿ
(&
sid
);

946 
”r
 = 
	`®§mix”_g‘hªdË
(
ÿrdÇme
, &
hªdË
);

947 ià(
”r
 < 0)

949 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,
	`¢d_¡»¼Ü
(
”r
));

950 
	`¢d_mix”_şo£
(
hªdË
);

951  
NULL
;

954 
»suÉ
 = 
	`PyLi¡_New
(0);

956 
–em
 = 
	`¢d_mix”_fœ¡_–em
(
hªdË
);ƒlem;

957 
–em
 = 
	`¢d_mix”_–em_Ãxt
(elem))

959 
PyObjeù
 *
mix”
;

960 
	`¢d_mix”_£Ëm_g‘_id
(
–em
, 
sid
);

961 
mix”
 = 
	`PyUnicode_FromSŒšg
(
	`¢d_mix”_£Ëm_id_g‘_Çme
(
sid
));

962 
	`PyLi¡_Aµ’d
(
»suÉ
,
mix”
);

963 
	`Py_DECREF
(
mix”
);

965 
	`¢d_mix”_şo£
(
hªdË
);

967  
»suÉ
;

968 
	}
}

970 
PyDoc_STRVAR
(
mix”s_doc
,

978 
¢d_mix”_–em_t
 *

979 
	$®§mix”_fšd_–em
(
¢d_mix”_t
 *
hªdË
, *
cÚŒŞ
, 
id
)

981 
¢d_mix”_£Ëm_id_t
 *
sid
;

983 
	`¢d_mix”_£Ëm_id_®loÿ
(&
sid
);

984 
	`¢d_mix”_£Ëm_id_£t_šdex
(
sid
, 
id
);

985 
	`¢d_mix”_£Ëm_id_£t_Çme
(
sid
, 
cÚŒŞ
);

986  
	`¢d_mix”_fšd_£Ëm
(
hªdË
, 
sid
);

987 
	}
}

989 
PyObjeù
 *

990 
	$®§mix”_Ãw
(
PyTy³Objeù
 *
ty³
, 
PyObjeù
 *
¬gs
, PyObjeù *
kwds
)

992 
®§mix”_t
 *
£lf
;

993 
”r
;

994 
ÿrdšdex
 = 0;

995 *
cÚŒŞ
 = "Master";

996 
id
 = 0;

997 
¢d_mix”_–em_t
 *
–em
;

998 
chªÃl
;

999 *
kw
[] = { "cÚŒŞ", "id", "ÿrdšdex", 
NULL
 };

1001 ià(!
	`PyArg_P¬£Tu¶eAndKeywÜds
(
¬gs
, 
kwds
, "|sii", 
kw
,

1002 &
cÚŒŞ
, &
id
, &
ÿrdšdex
))

1003  
NULL
;

1005 ià(!(
£lf
 = (
®§mix”_t
 *)
	`PyObjeù_New
×l§mix”_t, &
ALSAMix”Ty³
)))

1006  
NULL
;

1008 
£lf
->
hªdË
 = 0;

1009 
£lf
->
ÿrdÇme
 = 
	`Œª¦©e_ÿrdidx
(
ÿrdšdex
);

1011 
”r
 = 
	`®§mix”_g‘hªdË
(
£lf
->
ÿrdÇme
, &£lf->
hªdË
);

1012 ià(
”r
<0)

1014 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,
	`¢d_¡»¼Ü
(
”r
));

1015 
	`ä“
(
£lf
->
ÿrdÇme
);

1016  
NULL
;

1019 
£lf
->
cÚŒŞÇme
 = 
	`¡rdup
(
cÚŒŞ
);

1020 
£lf
->
cÚŒŞid
 = 
id
;

1022 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,
cÚŒŞ
,
id
);

1023 ià(!
–em
)

1025 
”¹ext
[128];

1026 
	`¥rštf
(
”¹ext
,"Unableo find mixer control '%s',%i",

1027 
£lf
->
cÚŒŞÇme
,

1028 
£lf
->
cÚŒŞid
);

1029 
	`¢d_mix”_şo£
(
£lf
->
hªdË
);

1030 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,
”¹ext
);

1031  
NULL
;

1034 
£lf
->
vŞume_ÿp
 = s–f->
sw™ch_ÿp
 = 0;

1035 ià(
	`¢d_mix”_£Ëm_has_commÚ_vŞume
(
–em
))

1037 
£lf
->
vŞume_ÿp
 |ğ
MIXER_CAP_VOLUME
;

1038 ià(
	`¢d_mix”_£Ëm_has_¶ayback_vŞume_jošed
(
–em
))

1039 
£lf
->
vŞume_ÿp
 |ğ
MIXER_CAP_VOLUME_JOINED
;

1043 ià(
	`¢d_mix”_£Ëm_has_¶ayback_vŞume
(
–em
))

1045 
£lf
->
vŞume_ÿp
 |ğ
MIXER_CAP_PVOLUME
;

1046 ià(
	`¢d_mix”_£Ëm_has_¶ayback_vŞume_jošed
(
–em
))

1047 
£lf
->
vŞume_ÿp
 |ğ
MIXER_CAP_PVOLUME_JOINED
;

1049 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_vŞume
(
–em
))

1051 
£lf
->
vŞume_ÿp
 |ğ
MIXER_CAP_CVOLUME
;

1052 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_vŞume_jošed
(
–em
))

1053 
£lf
->
vŞume_ÿp
 |ğ
MIXER_CAP_CVOLUME_JOINED
;

1057 ià(
	`¢d_mix”_£Ëm_has_commÚ_sw™ch
(
–em
))

1059 
£lf
->
sw™ch_ÿp
 |ğ
MIXER_CAP_SWITCH
;

1060 ià(
	`¢d_mix”_£Ëm_has_¶ayback_sw™ch_jošed
(
–em
))

1061 
£lf
->
sw™ch_ÿp
 |ğ
MIXER_CAP_SWITCH_JOINED
;

1065 ià(
	`¢d_mix”_£Ëm_has_¶ayback_sw™ch
(
–em
)) {

1066 
£lf
->
sw™ch_ÿp
 |ğ
MIXER_CAP_PSWITCH
;

1067 ià(
	`¢d_mix”_£Ëm_has_¶ayback_sw™ch_jošed
(
–em
))

1068 
£lf
->
sw™ch_ÿp
 |ğ
MIXER_CAP_PSWITCH_JOINED
;

1070 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_sw™ch
(
–em
)) {

1071 
£lf
->
sw™ch_ÿp
 |ğ
MIXER_CAP_CSWITCH
;

1072 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_sw™ch_jošed
(
–em
))

1073 
£lf
->
sw™ch_ÿp
 |ğ
MIXER_CAP_CSWITCH_JOINED
;

1074 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_sw™ch_exşusive
(
–em
))

1075 
£lf
->
sw™ch_ÿp
 |ğ
MIXER_CAP_CSWITCH_EXCLUSIVE
;

1078 
£lf
->
pchªÃls
 = 0;

1079 ià(
£lf
->
vŞume_ÿp
 | 
MIXER_CAP_PVOLUME
 ||

1080 
£lf
->
sw™ch_ÿp
 | 
MIXER_CAP_PSWITCH
)

1082 ià(
	`¢d_mix”_£Ëm_is_¶ayback_mÚo
(
–em
)è
£lf
->
pchªÃls
 = 1;

1084 
chªÃl
=0; chªÃÈ<ğ
SND_MIXER_SCHN_LAST
; channel++) {

1085 ià(
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
chªÃl
))

1086 
£lf
->
pchªÃls
++;

1091 
£lf
->
cchªÃls
 = 0;

1092 ià(
£lf
->
vŞume_ÿp
 | 
MIXER_CAP_CVOLUME
 ||

1093 
£lf
->
sw™ch_ÿp
 | 
MIXER_CAP_CSWITCH
)

1095 ià(
	`¢d_mix”_£Ëm_is_ÿ±u»_mÚo
(
–em
))

1096 
£lf
->
cchªÃls
 = 1;

1099 
chªÃl
=0; chªÃÈ<ğ
SND_MIXER_SCHN_LAST
; channel++) {

1100 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
chªÃl
))

1101 
£lf
->
cchªÃls
++;

1106 
	`¢d_mix”_£Ëm_g‘_¶ayback_vŞume_¿nge
(
–em
, &
£lf
->
pmš
, &£lf->
pmax
);

1107 
	`¢d_mix”_£Ëm_g‘_ÿ±u»_vŞume_¿nge
(
–em
, &
£lf
->
cmš
, &£lf->
cmax
);

1109  (
PyObjeù
 *)
£lf
;

1110 
	}
}

1112 
	$®§mix”_d—Îoc
(
®§mix”_t
 *
£lf
)

1114 ià(
£lf
->
hªdË
) {

1115 
	`¢d_mix”_şo£
(
£lf
->
hªdË
);

1116 
	`ä“
(
£lf
->
ÿrdÇme
);

1117 
	`ä“
(
£lf
->
cÚŒŞÇme
);

1118 
£lf
->
hªdË
 = 0;

1120 
	`PyObjeù_D–
(
£lf
);

1121 
	}
}

1123 
PyObjeù
 *

1124 
	$®§mix”_şo£
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1126 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":close"))

1127  
NULL
;

1129 
	`¢d_mix”_şo£
(
£lf
->
hªdË
);

1130 
	`ä“
(
£lf
->
ÿrdÇme
);

1131 
	`ä“
(
£lf
->
cÚŒŞÇme
);

1132 
£lf
->
hªdË
 = 0;

1134 
	`Py_INCREF
(
Py_NÚe
);

1135  
Py_NÚe
;

1136 
	}
}

1138 
PyDoc_STRVAR
(
mix”_şo£_doc
,

1143 
PyObjeù
 *

1144 
	$®§mix”_ÿrdÇme
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1146 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":cardname"))

1147  
NULL
;

1149 ià(!
£lf
->
hªdË
)

1151 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1152  
NULL
;

1155  
	`PyUnicode_FromSŒšg
(
£lf
->
ÿrdÇme
);

1156 
	}
}

1158 
PyDoc_STRVAR
(
mix”_ÿrdÇme_doc
,

1163 
PyObjeù
 *

1164 
	$®§mix”_mix”
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1166 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":mixer"))

1167  
NULL
;

1169 ià(!
£lf
->
hªdË
)

1171 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1172  
NULL
;

1175  
	`PyUnicode_FromSŒšg
(
£lf
->
cÚŒŞÇme
);

1176 
	}
}

1178 
PyDoc_STRVAR
(
mix”_doc
,

1185 
PyObjeù
 *

1186 
	$®§mix”_mix”id
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1188 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":mixerid"))

1189  
NULL
;

1191 ià(!
£lf
->
hªdË
)

1193 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1194  
NULL
;

1197  
	`PyLÚg_FromLÚg
(
£lf
->
cÚŒŞid
);

1198 
	}
}

1200 
PyDoc_STRVAR
(
mix”id_doc
,

1206 
PyObjeù
 *

1207 
	$®§mix”_vŞumeÿp
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1209 
PyObjeù
 *
»suÉ
;

1210 
PyObjeù
 *
™em
;

1212 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":vŞumeÿp")è 
NULL
;

1214 ià(!
£lf
->
hªdË
)

1216 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1217  
NULL
;

1220 
»suÉ
 = 
	`PyLi¡_New
(0);

1221 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_VOLUME
)

1223 
™em
 = 
	`PyUnicode_FromSŒšg
("Volume");

1224 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1225 
	`Py_DECREF
(
™em
);

1227 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_VOLUME_JOINED
)

1229 
™em
 = 
	`PyUnicode_FromSŒšg
("Joined Volume");

1230 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1231 
	`Py_DECREF
(
™em
);

1233 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_PVOLUME
)

1235 
™em
 = 
	`PyUnicode_FromSŒšg
("Playback Volume");

1236 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1237 
	`Py_DECREF
(
™em
);

1239 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_PVOLUME_JOINED
)

1241 
™em
 = 
	`PyUnicode_FromSŒšg
("Joined Playback Volume");

1242 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1243 
	`Py_DECREF
(
™em
);

1245 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_CVOLUME
)

1247 
™em
 = 
	`PyUnicode_FromSŒšg
("Capture Volume");

1248 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1249 
	`Py_DECREF
(
™em
);

1251 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_CVOLUME_JOINED
)

1253 
™em
 = 
	`PyUnicode_FromSŒšg
("Joined Capture Volume");

1254 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1255 
	`Py_DECREF
(
™em
);

1258  
»suÉ
;

1259 
	}
}

1261 
PyDoc_STRVAR
(
vŞumeÿp_doc
,

1274 
PyObjeù
 *

1275 
	$®§mix”_sw™chÿp
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1277 
PyObjeù
 *
»suÉ
;

1278 
PyObjeù
 *
™em
;

1280 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":switchcap"))

1281  
NULL
;

1283 ià(!
£lf
->
hªdË
)

1285 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1286  
NULL
;

1289 
»suÉ
 = 
	`PyLi¡_New
(0);

1290 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_SWITCH
)

1292 
™em
 = 
	`PyUnicode_FromSŒšg
("Mute");

1293 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1294 
	`Py_DECREF
(
™em
);

1296 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_SWITCH_JOINED
)

1298 
™em
 = 
	`PyUnicode_FromSŒšg
("Joined Mute");

1299 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1300 
	`Py_DECREF
(
™em
);

1302 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_PSWITCH
)

1304 
™em
 = 
	`PyUnicode_FromSŒšg
("Playback Mute");

1305 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1306 
	`Py_DECREF
(
™em
);

1308 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_PSWITCH_JOINED
)

1310 
™em
 = 
	`PyUnicode_FromSŒšg
("Joined Playback Mute");

1311 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1312 
	`Py_DECREF
(
™em
);

1314 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_CSWITCH
)

1316 
™em
 = 
	`PyUnicode_FromSŒšg
("Capture Mute");

1317 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1318 
	`Py_DECREF
(
™em
);

1320 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_CSWITCH_JOINED
)

1322 
™em
 = 
	`PyUnicode_FromSŒšg
("Joined Capture Mute");

1323 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1324 
	`Py_DECREF
(
™em
);

1326 ià(
£lf
->
vŞume_ÿp
&
MIXER_CAP_CSWITCH_EXCLUSIVE
)

1328 
™em
 = 
	`PyUnicode_FromSŒšg
("Capture Exclusive");

1329 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1330 
	`Py_DECREF
(
™em
);

1333  
»suÉ
;

1334 
	}
}

1336 
PyDoc_STRVAR
(
sw™chÿp_doc
,

1351 
	$®§mix”_g‘³rûÁage
(
mš
, 
max
, 
v®ue
)

1354 
¿nge
 = 
max
 - 
mš
;

1355 
tmp
;

1357 ià(
¿nge
 == 0)

1360 
v®ue
 -ğ
mš
;

1361 
tmp
 = 
	`ršt
(()
v®ue
/()
¿nge
 * 100);

1362  
tmp
;

1363 
	}
}

1365 
	$®§mix”_g‘physvŞume
(
mš
, 
max
, 
³rûÁage
)

1368 
¿nge
 = 
max
 - 
mš
;

1369 
tmp
;

1371 ià(
¿nge
 == 0)

1374 
tmp
 = 
	`ršt
(()
¿nge
 * (()
³rûÁage
*.01)è+ 
mš
;

1375  
tmp
;

1376 
	}
}

1378 
PyObjeù
 *

1379 
	$®§mix”_g‘vŞume
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1381 
¢d_mix”_–em_t
 *
–em
;

1382 
dœeùiÚ
;

1383 
chªÃl
;

1384 
iv®
;

1385 *
dœ¡r
 = 0;

1386 
PyObjeù
 *
»suÉ
;

1387 
PyObjeù
 *
™em
;

1389 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"|s:g‘vŞume",&
dœ¡r
))

1390  
NULL
;

1392 ià(!
£lf
->
hªdË
)

1394 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1395  
NULL
;

1398 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1400 ià(!
dœ¡r
)

1402 ià(
£lf
->
pchªÃls
)

1403 
dœeùiÚ
 = 0;

1405 
dœeùiÚ
 = 1;

1407 ià(
	`¡rÿ£cmp
(
dœ¡r
,"playback")==0)

1408 
dœeùiÚ
 = 0;

1409 ià(
	`¡rÿ£cmp
(
dœ¡r
,"capture")==0)

1410 
dœeùiÚ
 = 1;

1413 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Invalid direction‡rgument for mixer");

1414  
NULL
;

1417 
»suÉ
 = 
	`PyLi¡_New
(0);

1419 
chªÃl
 = 0; chªÃÈ<ğ
SND_MIXER_SCHN_LAST
; channel++) {

1420 ià(
dœeùiÚ
 == 0 &&

1421 
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
chªÃl
))

1423 
	`¢d_mix”_£Ëm_g‘_¶ayback_vŞume
(
–em
, 
chªÃl
, &
iv®
);

1424 
™em
 = 
	`PyLÚg_FromLÚg
(
	`®§mix”_g‘³rûÁage
(
£lf
->
pmš
,

1425 
£lf
->
pmax
,

1426 
iv®
));

1427 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1428 
	`Py_DECREF
(
™em
);

1430 ià(
dœeùiÚ
 == 1

1431 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
chªÃl
)

1432 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_vŞume
(
–em
)) {

1433 
	`¢d_mix”_£Ëm_g‘_ÿ±u»_vŞume
(
–em
, 
chªÃl
, &
iv®
);

1434 
™em
 = 
	`PyLÚg_FromLÚg
(
	`®§mix”_g‘³rûÁage
(
£lf
->
cmš
,

1435 
£lf
->
cmax
,

1436 
iv®
));

1437 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1438 
	`Py_DECREF
(
™em
);

1442  
»suÉ
;

1443 
	}
}

1445 
PyDoc_STRVAR
(
g‘vŞume_doc
,

1457 
PyObjeù
 *

1458 
	$®§mix”_g‘¿nge
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1460 
¢d_mix”_–em_t
 *
–em
;

1461 
dœeùiÚ
;

1462 *
dœ¡r
 = 0;

1464 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"|s:g‘¿nge",&
dœ¡r
))

1465  
NULL
;

1467 ià(!
£lf
->
hªdË
)

1469 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1470  
NULL
;

1473 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1475 ià(!
dœ¡r
)

1477 ià(
£lf
->
pchªÃls
)

1478 
dœeùiÚ
 = 0;

1480 
dœeùiÚ
 = 1;

1482 ià(
	`¡rÿ£cmp
(
dœ¡r
,"playback")==0)

1483 
dœeùiÚ
 = 0;

1484 ià(
	`¡rÿ£cmp
(
dœ¡r
,"capture")==0)

1485 
dœeùiÚ
 = 1;

1488 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Invalid‡rgument for direction");

1489  
NULL
;

1491 ià(
dœeùiÚ
 == 0)

1493 ià(
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 0))

1495  
	`Py_BudV®ue
("[ii]", 
£lf
->
pmš
, s–f->
pmax
);

1498 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer has‚o…layback channel");

1499  
NULL
;

1501 ià(
dœeùiÚ
 == 1)

1503 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 0)

1504 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_vŞume
(
–em
)) {

1505  
	`Py_BudV®ue
("[ii]", 
£lf
->
cmš
, s–f->
cmax
);

1508 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer has‚o capture channel "

1510  
NULL
;

1514 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Huh?");

1515  
NULL
;

1516 
	}
}

1518 
PyDoc_STRVAR
(
g‘¿nge_doc
,

1529 
PyObjeù
 *

1530 
	$®§mix”_g‘’um
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1532 
¢d_mix”_–em_t
 *
–em
;

1533 
PyObjeù
 *
–ems
;

1534 
i
, 
couÁ
, 
rc
;

1535 
šdex
;

1536 
Çme
[32];

1537 
PyObjeù
 *
»suÉ
;

1539 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, ":getenum"))

1540  
NULL
;

1542 ià(!
£lf
->
hªdË
)

1544 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1545  
NULL
;

1548 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1549 ià(!
	`¢d_mix”_£Ëm_is_’um”©ed
(
–em
)) {

1551  
	`PyTu¶e_New
(0);

1554 
couÁ
 = 
	`¢d_mix”_£Ëm_g‘_’um_™ems
(
–em
);

1555 ià(
couÁ
 < 0)

1557 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
couÁ
));

1558  
NULL
;

1561 
»suÉ
 = 
	`PyTu¶e_New
(2);

1562 ià(!
»suÉ
)

1563  
NULL
;

1565 
rc
 = 
	`¢d_mix”_£Ëm_g‘_’um_™em
(
–em
, 0, &
šdex
);

1566 if(
rc
)

1568 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
rc
));

1569  
NULL
;

1571 
rc
 = 
	`¢d_mix”_£Ëm_g‘_’um_™em_Çme
(
–em
, 
šdex
, (
Çme
)-1,‚ame);

1572 ià(
rc
)

1574 
	`Py_DECREF
(
»suÉ
);

1575 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
rc
));

1576  
NULL
;

1579 
	`PyTu¶e_S‘I‹m
(
»suÉ
, 0, 
	`PyUnicode_FromSŒšg
(
Çme
));

1581 
–ems
 = 
	`PyLi¡_New
(
couÁ
);

1582 ià(!
–ems
)

1584 
	`Py_DECREF
(
»suÉ
);

1585  
NULL
;

1588 
i
 = 0; i < 
couÁ
; ++i)

1590 
rc
 = 
	`¢d_mix”_£Ëm_g‘_’um_™em_Çme
(
–em
, 
i
, (
Çme
)-1,‚ame);

1591 ià(
rc
) {

1592 
	`Py_DECREF
(
–ems
);

1593 
	`Py_DECREF
(
»suÉ
);

1594 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, 
	`¢d_¡»¼Ü
(
rc
));

1595  
NULL
;

1598 
	`PyLi¡_S‘I‹m
(
–ems
, 
i
, 
	`PyUnicode_FromSŒšg
(
Çme
));

1601 
	`PyTu¶e_S‘I‹m
(
»suÉ
, 1, 
–ems
);

1603  
»suÉ
;

1604 
	}
}

1606 
PyDoc_STRVAR
(
g‘’um_doc
,

1612 
PyObjeù
 *

1613 
	$®§mix”_g‘mu‹
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1615 
¢d_mix”_–em_t
 *
–em
;

1616 
i
;

1617 
iv®
;

1618 
PyObjeù
 *
»suÉ
;

1619 
PyObjeù
 *
™em
;

1621 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":getmute"))

1622  
NULL
;

1624 ià(!
£lf
->
hªdË
)

1626 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1627  
NULL
;

1630 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1631 ià(!
	`¢d_mix”_£Ëm_has_¶ayback_sw™ch
(
–em
))

1633 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Mixer has‚o mute switch");

1634  
NULL
;

1637 
»suÉ
 = 
	`PyLi¡_New
(0);

1639 
i
 = 0; i <ğ
SND_MIXER_SCHN_LAST
; i++)

1641 ià(
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
i
))

1643 
	`¢d_mix”_£Ëm_g‘_¶ayback_sw™ch
(
–em
, 
i
, &
iv®
);

1645 
™em
 = 
	`PyLÚg_FromLÚg
(!
iv®
);

1646 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1647 
	`Py_DECREF
(
™em
);

1650  
»suÉ
;

1651 
	}
}

1653 
PyDoc_STRVAR
(
g‘mu‹_doc
,

1662 
PyObjeù
 *

1663 
	$®§mix”_g‘»c
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1665 
¢d_mix”_–em_t
 *
–em
;

1666 
i
;

1667 
iv®
;

1668 
PyObjeù
 *
»suÉ
;

1669 
PyObjeù
 *
™em
;

1671 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":getrec"))

1672  
NULL
;

1674 ià(!
£lf
->
hªdË
)

1676 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1677  
NULL
;

1680 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1681 ià(!
	`¢d_mix”_£Ëm_has_ÿ±u»_sw™ch
(
–em
))

1683 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Mixer has‚o„ecord switch");

1684  
NULL
;

1687 
»suÉ
 = 
	`PyLi¡_New
(0);

1689 
i
 = 0; i <ğ
SND_MIXER_SCHN_LAST
; i++)

1691 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
i
))

1693 
	`¢d_mix”_£Ëm_g‘_ÿ±u»_sw™ch
(
–em
, 
i
, &
iv®
);

1694 
™em
 = 
	`PyLÚg_FromLÚg
(
iv®
);

1695 
	`PyLi¡_Aµ’d
(
»suÉ
, 
™em
);

1696 
	`Py_DECREF
(
™em
);

1699  
»suÉ
;

1700 
	}
}

1702 
PyDoc_STRVAR
(
g‘»c_doc
,

1710 
PyObjeù
 *

1711 
	$®§mix”_£tvŞume
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1713 
¢d_mix”_–em_t
 *
–em
;

1714 
dœeùiÚ
;

1715 
i
;

1716 
vŞume
;

1717 
physvŞume
;

1718 *
dœ¡r
 = 0;

1719 
chªÃl
 = 
MIXER_CHANNEL_ALL
;

1720 
dÚe
 = 0;

1722 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"l|is:£tvŞume",&
vŞume
,&
chªÃl
,&
dœ¡r
))

1723  
NULL
;

1725 ià(
vŞume
 < 0 || volume > 100)

1727 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Volume must be between 0‡nd 100");

1728  
NULL
;

1731 ià(!
£lf
->
hªdË
)

1733 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1734  
NULL
;

1737 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1739 ià(!
dœ¡r
)

1741 ià(
£lf
->
pchªÃls
)

1742 
dœeùiÚ
 = 0;

1744 
dœeùiÚ
 = 1;

1746 ià(
	`¡rÿ£cmp
(
dœ¡r
,"playback")==0)

1747 
dœeùiÚ
 = 0;

1748 ià(
	`¡rÿ£cmp
(
dœ¡r
,"capture")==0)

1749 
dœeùiÚ
 = 1;

1752 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Invalid direction‡rgument. Use "

1754  
NULL
;

1756 
i
 = 0; i <ğ
SND_MIXER_SCHN_LAST
; i++)

1758 ià(
chªÃl
 =ğ-1 || chªÃÈ=ğ
i
)

1760 ià(
dœeùiÚ
 == 0 &&

1761 
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
i
)) {

1762 
physvŞume
 = 
	`®§mix”_g‘physvŞume
(
£lf
->
pmš
,

1763 
£lf
->
pmax
, 
vŞume
);

1764 
	`¢d_mix”_£Ëm_£t_¶ayback_vŞume
(
–em
, 
i
, 
physvŞume
);

1765 
dÚe
++;

1767 ià(
dœeùiÚ
 == 1

1768 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
chªÃl
)

1769 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_vŞume
(
–em
))

1771 
physvŞume
 = 
	`®§mix”_g‘physvŞume
(
£lf
->
cmš
,£lf->
cmax
,

1772 
vŞume
);

1773 
	`¢d_mix”_£Ëm_£t_ÿ±u»_vŞume
(
–em
, 
i
, 
physvŞume
);

1774 
dÚe
++;

1778 if(!
dÚe
)

1780 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"No such channel");

1781  
NULL
;

1784 
	`Py_INCREF
(
Py_NÚe
);

1785  
Py_NÚe
;

1786 
	}
}

1788 
PyDoc_STRVAR
(
£tvŞume_doc
,

1804 
PyObjeù
 *

1805 
	$®§mix”_£tmu‹
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1807 
¢d_mix”_–em_t
 *
–em
;

1808 
i
;

1809 
mu‹
 = 0;

1810 
dÚe
 = 0;

1811 
chªÃl
 = 
MIXER_CHANNEL_ALL
;

1812 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"i|i:£tmu‹",&
mu‹
,&
chªÃl
))

1813  
NULL
;

1815 ià(!
£lf
->
hªdË
)

1817 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1818  
NULL
;

1821 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1822 ià(!
	`¢d_mix”_£Ëm_has_¶ayback_sw™ch
(
–em
))

1824 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Mixer has‚o mute switch");

1825  
NULL
;

1827 
i
 = 0; i <ğ
SND_MIXER_SCHN_LAST
; i++)

1829 ià(
chªÃl
 =ğ
MIXER_CHANNEL_ALL
 || chªÃÈ=ğ
i
)

1831 ià(
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
i
))

1833 
	`¢d_mix”_£Ëm_£t_¶ayback_sw™ch
(
–em
, 
i
, !
mu‹
);

1834 
dÚe
++;

1838 ià(!
dÚe
)

1840 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Invalid channel‚umber");

1841  
NULL
;

1844 
	`Py_INCREF
(
Py_NÚe
);

1845  
Py_NÚe
;

1846 
	}
}

1848 
PyDoc_STRVAR
(
£tmu‹_doc
,

1859 
PyObjeù
 *

1860 
	$®§mix”_£Œec
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1862 
¢d_mix”_–em_t
 *
–em
;

1863 
i
;

1864 
»c
 = 0;

1865 
dÚe
 = 0;

1866 
chªÃl
 = 
MIXER_CHANNEL_ALL
;

1868 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,"i|i:£Œec",&
»c
,&
chªÃl
))

1869  
NULL
;

1871 ià(!
£lf
->
hªdË
)

1873 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1874  
NULL
;

1877 
–em
 = 
	`®§mix”_fšd_–em
(
£lf
->
hªdË
,£lf->
cÚŒŞÇme
,£lf->
cÚŒŞid
);

1878 ià(!
	`¢d_mix”_£Ëm_has_ÿ±u»_sw™ch
(
–em
))

1880 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Mixer has‚o„ecord switch");

1881  
NULL
;

1883 
i
 = 0; i <ğ
SND_MIXER_SCHN_LAST
; i++)

1885 ià(
chªÃl
 =ğ
MIXER_CHANNEL_ALL
 || chªÃÈ=ğ
i
)

1887 ià(
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
i
))

1889 
	`¢d_mix”_£Ëm_£t_ÿ±u»_sw™ch
(
–em
, 
i
, 
»c
);

1890 
dÚe
++;

1894 ià(!
dÚe
)

1896 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Invalid channel‚umber");

1897  
NULL
;

1900 
	`Py_INCREF
(
Py_NÚe
);

1901  
Py_NÚe
;

1902 
	}
}

1904 
PyDoc_STRVAR
(
£Œec_doc
,

1914 
PyObjeù
 *

1915 
	$®§mix”_pŞldesütÜs
(
®§mix”_t
 *
£lf
, 
PyObjeù
 *
¬gs
)

1917 
i
, 
couÁ
, 
rc
;

1918 
PyObjeù
 *
»suÉ
;

1919 
pŞlfd
 *
fds
;

1921 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
,":polldescriptors"))

1922  
NULL
;

1924 ià(!
£lf
->
hªdË
)

1926 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
, "Mixer is closed");

1927  
NULL
;

1930 
couÁ
 = 
	`¢d_mix”_pŞl_desütÜs_couÁ
(
£lf
->
hªdË
);

1931 ià(
couÁ
 < 0)

1933 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Can't get…oll descriptor count");

1934  
NULL
;

1937 
fds
 = (
pŞlfd
*)
	`ÿÎoc
(
couÁ
, (pollfd));

1938 ià(!
fds
)

1940 
	`PyE¼_S‘SŒšg
(
PyExc_MemÜyE¼Ü
, "Out of memory");

1941  
NULL
;

1944 
»suÉ
 = 
	`PyLi¡_New
(
couÁ
);

1945 
rc
 = 
	`¢d_mix”_pŞl_desütÜs
(
£lf
->
hªdË
, 
fds
, ()
couÁ
);

1946 ià(
rc
 !ğ
couÁ
)

1948 
	`PyE¼_S‘SŒšg
(
ALSAAudioE¼Ü
,"Can't get…oll descriptors");

1949  
NULL
;

1952 
i
 = 0; i < 
couÁ
; ++i)

1954 
	`PyLi¡_S‘I‹m
(
»suÉ
, 
i
,

1955 
	`Py_BudV®ue
("II", 
fds
[
i
].
fd
, fds[i].
ev’ts
));

1958  
»suÉ
;

1959 
	}
}

1961 
PyDoc_STRVAR
(
pŞldesütÜs_doc
,

1967 
PyM‘hodDef
 
	g®§mix”_m‘hods
[] = {

1968 {"ÿrdÇme", (
PyCFunùiÚ
)
®§mix”_ÿrdÇme
, 
METH_VARARGS
,

1969 
mix”_ÿrdÇme_doc
},

1970 {"şo£", (
PyCFunùiÚ
)
®§mix”_şo£
, 
METH_VARARGS
, 
mix”_şo£_doc
},

1971 {"mix”", (
PyCFunùiÚ
)
®§mix”_mix”
, 
METH_VARARGS
, 
mix”_doc
},

1972 {"mix”id", (
PyCFunùiÚ
)
®§mix”_mix”id
, 
METH_VARARGS
, 
mix”id_doc
},

1973 {"sw™chÿp", (
PyCFunùiÚ
)
®§mix”_sw™chÿp
, 
METH_VARARGS
,

1974 
sw™chÿp_doc
},

1975 {"vŞumeÿp", (
PyCFunùiÚ
)
®§mix”_vŞumeÿp
, 
METH_VARARGS
,

1976 
vŞumeÿp_doc
},

1977 {"g‘vŞume", (
PyCFunùiÚ
)
®§mix”_g‘vŞume
, 
METH_VARARGS
,

1978 
g‘vŞume_doc
},

1979 {"g‘¿nge", (
PyCFunùiÚ
)
®§mix”_g‘¿nge
, 
METH_VARARGS
, 
g‘¿nge_doc
},

1980 {"g‘’um", (
PyCFunùiÚ
)
®§mix”_g‘’um
, 
METH_VARARGS
, 
g‘’um_doc
},

1981 {"g‘mu‹", (
PyCFunùiÚ
)
®§mix”_g‘mu‹
, 
METH_VARARGS
, 
g‘mu‹_doc
},

1982 {"g‘»c", (
PyCFunùiÚ
)
®§mix”_g‘»c
, 
METH_VARARGS
, 
g‘»c_doc
},

1983 {"£tvŞume", (
PyCFunùiÚ
)
®§mix”_£tvŞume
, 
METH_VARARGS
,

1984 
£tvŞume_doc
},

1985 {"£tmu‹", (
PyCFunùiÚ
)
®§mix”_£tmu‹
, 
METH_VARARGS
, 
£tmu‹_doc
},

1986 {"£Œec", (
PyCFunùiÚ
)
®§mix”_£Œec
, 
METH_VARARGS
, 
£Œec_doc
},

1987 {"pŞldesütÜs", (
PyCFunùiÚ
)
®§mix”_pŞldesütÜs
, 
METH_VARARGS
,

1988 
pŞldesütÜs_doc
},

1990 {
NULL
, NULL}

1993 #ià
PY_VERSION_HEX
 < 0x02020000

1994 
PyObjeù
 *

1995 
	$®§mix”_g‘©Œ
(
®§pcm_t
 *
£lf
, *
Çme
)

1997  
	`Py_FšdM‘hod
(
®§mix”_m‘hods
, (
PyObjeù
 *)
£lf
, 
Çme
);

1998 
	}
}

2001 
PyTy³Objeù
 
	gALSAMix”Ty³
 = {

2002 #ià
PY_MAJOR_VERSION
 < 3

2003 
PyObjeù_HEAD_INIT
(&
PyTy³_Ty³
)

2006 
PyV¬Objeù_HEAD_INIT
(&
PyTy³_Ty³
, 0)

2009 (
®§mix”_t
),

2012 (
de¡ruùÜ
è
®§mix”_d—Îoc
,

2014 #ià
PY_VERSION_HEX
 < 0x02020000

2015 (
g‘©Œfunc
)
®§mix”_g‘©Œ
,

2028 #ià
PY_VERSION_HEX
 >= 0x02020000

2029 
PyObjeù_G’”icG‘A‰r
,

2035 
Py_TPFLAGS_DEFAULT
,

2043 
®§mix”_m‘hods
,

2052 
PyM‘hodDef
 
	g®§audio_m‘hods
[] = {

2053 { "ÿrds", 
®§ÿrd_li¡
, 
METH_VARARGS
, 
ÿrds_doc
},

2054 { "mix”s", 
®§mix”_li¡
, 
METH_VARARGS
, 
mix”s_doc
},

2059 #ià
PY_MAJOR_VERSION
 >= 3

2061 
	#_EXPORT_INT
(
mod
, 
Çme
, 
v®ue
) \

2062 ià(
	`PyModuË_AddIÁCÚ¡ªt
(
mod
, 
Çme
, (è
v®ue
è=ğ-1è 
NULL
;

	)

2064 
PyModuËDef
 
	g®§audio_moduË
 = {

2065 
PyModuËDef_HEAD_INIT
,

2067 
®§audio_moduË_doc
,

2069 
®§audio_m‘hods
,

2078 
	#_EXPORT_INT
(
mod
, 
Çme
, 
v®ue
) \

2079 ià(
	`PyModuË_AddIÁCÚ¡ªt
(
mod
, 
Çme
, (è
v®ue
è=ğ-1è;

	)

2083 #ià
PY_MAJOR_VERSION
 < 3

2084 
	$š™®§audio
()

2086 
PyObjeù
 *
	$PyIn™_®§audio
()

2089 
PyObjeù
 *
m
;

2090 
ALSAPCMTy³
.
_Ãw
 = 
®§pcm_Ãw
;

2091 
ALSAMix”Ty³
.
_Ãw
 = 
®§mix”_Ãw
;

2093 
	`PyEv®_In™Th»ads
();

2095 #ià
PY_MAJOR_VERSION
 < 3

2096 
m
 = 
	`Py_In™ModuË3
("®§audio", 
®§audio_m‘hods
, 
®§audio_moduË_doc
);

2097 ià(!
m
)

2101 
m
 = 
	`PyModuË_C»©e
(&
®§audio_moduË
);

2102 ià(!
m
)

2103  
NULL
;

2107 
ALSAAudioE¼Ü
 = 
	`PyE¼_NewExû±iÚ
("®§audio.ALSAAudioE¼Ü", 
NULL
,

2108 
NULL
);

2109 ià(!
ALSAAudioE¼Ü
)

2110 #ià
PY_MAJOR_VERSION
 < 3

2113  
NULL
;

2118 
	`Py_INCREF
(&
ALSAPCMTy³
);

2119 
	`PyModuË_AddObjeù
(
m
, "PCM", (
PyObjeù
 *)&
ALSAPCMTy³
);

2121 
	`Py_INCREF
(&
ALSAMix”Ty³
);

2122 
	`PyModuË_AddObjeù
(
m
, "Mix”", (
PyObjeù
 *)&
ALSAMix”Ty³
);

2124 
	`Py_INCREF
(
ALSAAudioE¼Ü
);

2125 
	`PyModuË_AddObjeù
(
m
, "ALSAAudioE¼Ü", 
ALSAAudioE¼Ü
);

2127 
	`_EXPORT_INT
(
m
, "PCM_PLAYBACK",
SND_PCM_STREAM_PLAYBACK
);

2128 
	`_EXPORT_INT
(
m
, "PCM_CAPTURE",
SND_PCM_STREAM_CAPTURE
);

2130 
	`_EXPORT_INT
(
m
, "PCM_NORMAL",0);

2131 
	`_EXPORT_INT
(
m
, "PCM_NONBLOCK",
SND_PCM_NONBLOCK
);

2132 
	`_EXPORT_INT
(
m
, "PCM_ASYNC",
SND_PCM_ASYNC
);

2135 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_S8",
SND_PCM_FORMAT_S8
);

2136 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_U8",
SND_PCM_FORMAT_U8
);

2137 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_S16_LE",
SND_PCM_FORMAT_S16_LE
);

2138 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_S16_BE",
SND_PCM_FORMAT_S16_BE
);

2139 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_U16_LE",
SND_PCM_FORMAT_U16_LE
);

2140 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_U16_BE",
SND_PCM_FORMAT_U16_BE
);

2141 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_S24_LE",
SND_PCM_FORMAT_S24_LE
);

2142 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_S24_BE",
SND_PCM_FORMAT_S24_BE
);

2143 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_U24_LE",
SND_PCM_FORMAT_U24_LE
);

2144 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_U24_BE",
SND_PCM_FORMAT_U24_BE
);

2145 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_S32_LE",
SND_PCM_FORMAT_S32_LE
);

2146 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_S32_BE",
SND_PCM_FORMAT_S32_BE
);

2147 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_U32_LE",
SND_PCM_FORMAT_U32_LE
);

2148 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_U32_BE",
SND_PCM_FORMAT_U32_BE
);

2149 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_FLOAT_LE",
SND_PCM_FORMAT_FLOAT_LE
);

2150 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_FLOAT_BE",
SND_PCM_FORMAT_FLOAT_BE
);

2151 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_FLOAT64_LE",
SND_PCM_FORMAT_FLOAT64_LE
);

2152 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_FLOAT64_BE",
SND_PCM_FORMAT_FLOAT64_BE
);

2153 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_MU_LAW",
SND_PCM_FORMAT_MU_LAW
);

2154 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_A_LAW",
SND_PCM_FORMAT_A_LAW
);

2155 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_IMA_ADPCM",
SND_PCM_FORMAT_IMA_ADPCM
);

2156 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_MPEG",
SND_PCM_FORMAT_MPEG
);

2157 
	`_EXPORT_INT
(
m
, "PCM_FORMAT_GSM",
SND_PCM_FORMAT_GSM
);

2160 
	`_EXPORT_INT
(
m
, "MIXER_CHANNEL_ALL", 
MIXER_CHANNEL_ALL
);

2163 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_UNKNOWN", 
SND_MIXER_SCHN_UNKNOWN
);

2164 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_FRONT_LEFT", 
SND_MIXER_SCHN_FRONT_LEFT
);

2165 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_FRONT_RIGHT", 
SND_MIXER_SCHN_FRONT_RIGHT
);

2166 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_REAR_LEFT", 
SND_MIXER_SCHN_REAR_LEFT
);

2167 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_REAR_RIGHT", 
SND_MIXER_SCHN_REAR_RIGHT
);

2168 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_FRONT_CENTER", 
SND_MIXER_SCHN_FRONT_CENTER
);

2169 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_WOOFER", 
SND_MIXER_SCHN_WOOFER
);

2170 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_SIDE_LEFT", 
SND_MIXER_SCHN_SIDE_LEFT
);

2171 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_SIDE_RIGHT", 
SND_MIXER_SCHN_SIDE_RIGHT
);

2172 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_REAR_CENTER", 
SND_MIXER_SCHN_REAR_CENTER
);

2173 
	`_EXPORT_INT
(
m
, "MIXER_SCHN_MONO", 
SND_MIXER_SCHN_MONO
);

2176 #ià
PY_MAJOR_VERSION
 >= 3

2177  
m
;

2179 
	}
}

	@robot/perception/behaviour/BehaviourAdapter.cpp

32 
	~<PythÚ.h
>

34 
	~<f¡»am
>

35 
	~<lim™s
>

36 
	~<ut™y
>

37 
	~<veùÜ
>

38 
	~<s¡»am
>

39 
	~<¡ršg
>

40 
	~<cm©h
>

41 
	~"³rû±iÚ/behaviour/BehaviourAd­‹r.hµ
"

42 
	~"³rû±iÚ/behaviour/BehaviourH–³rs.hµ
"

44 
	~"R—dySklPos™iÚAÎoÿtiÚ.hµ
"

45 
	~"bÏckbßrd/BÏckbßrd.hµ
"

46 
	~"uts/Logg”.hµ
"

47 
	~"ty³s/BehaviourReque¡.hµ
"

48 
	~"uts/body.hµ
"

49 
	~"uts/¥“ch.hµ
"

50 
	~"uts/basic_m©hs.hµ
"

51 
	~"ty³s/S’sÜV®ues.hµ
"

52 
	~"³rû±iÚ/behaviour/pythÚ/PythÚSkl.hµ
"

54 
	~<boo¡/pythÚ.hµ
>

56 
usšg
 
Çme¥aû
 
	g¡d
;

57 
usšg
 
Çme¥aû
 
	gboo¡
::
pythÚ
;

59 
	gBehaviourAd­‹r
::
	$BehaviourAd­‹r
(
BÏckbßrd
 *
bb
è: 
	`Ad­‹r
(bb), 
	$ÿlib¿tiÚSkl
(
bb
) {

60 
	`Îog
(
INFO
è<< "CÚ¡ruùšg BehaviourAd­‹r" << 
’dl
;

61 
¡d
::
¡ršg
 
ho¡Çme
;

62 
if¡»am
 
	`ho¡fe
 ("/etc/hostname");

63 
	`g‘lše
 (
ho¡fe
, 
ho¡Çme
);

64 
pythÚSkl
 = 
Ãw
 
	`PythÚSkl
(
bb
);

66 
¡d
::
¡ršg¡»am
 
¡¬tupS³ech
;

67 
¡¬tupS³ech
 << 
¡d
::
	`¡ršg
("PÏy” "è<< 
BehaviourH–³rs
::
	`¶ay”Numb”
(
bÏckbßrd
) <<

68 "—m " << 
BehaviourH–³rs
::
	`‹amNumb”
(
bÏckbßrd
) <<

69 "... I‡m ... " << 
ho¡Çme
;

70 
	`SAY
(
¡¬tupS³ech
.
	`¡r
());

71 
	}
}

73 
	gBehaviourAd­‹r
::~
	$BehaviourAd­‹r
() {

74 
	}
}

76 
BehaviourAd­‹r
::
	$tick
() {

77 
BehaviourReque¡
 
behaviourReque¡
;

79 
behaviourReque¡
 = 
pythÚSkl
->
	`execu‹
();

82 ià(
	`»adFrom
(
kšem©ics
, 
isC®ib¿tšg
)) {

83 
behaviourReque¡
 = 
ÿlib¿tiÚSkl
.
	`execu‹
();

89 
¡ršg
 
whichCam”a
 = 
bÏckbßrd
->
cÚfig
["deçuÉ.whichCam”a"].
as
<string>();

90 ià(
whichCam”a
 != "BEHAVIOUR") {

91 ià(
whichCam”a
 == "TOP_CAMERA") {

92 
behaviourReque¡
.
whichCam”a
 = 
TOP_CAMERA
;

93 } ià(
whichCam”a
 == "BOTTOM_CAMERA") {

94 
behaviourReque¡
.
whichCam”a
 = 
BOTTOM_CAMERA
;

99 
AbsCoÜd
 
	`w®kšgTo
(
behaviourReque¡
.
w®kšgToX
,

100 
behaviourReque¡
.
w®kšgToY
,

102 
AbsCoÜd
 
	`shoÙšgTo
(
behaviourReque¡
.
shoÙšgToX
,

103 
behaviourReque¡
.
shoÙšgToY
,

105 
	`wr™eTo
(
behaviour
, 
w®kšgTo
, walkingTo);

106 
	`wr™eTo
(
behaviour
, 
shoÙšgTo
, shootingTo);

109 
wr™eBuf
 = (
	`»adFrom
(
behaviour
, 
»adBuf
) + 1) % 2;

110 
	`wr™eTo
(
behaviour
, 
»que¡
[
wr™eBuf
], 
§ãtySkl
.
	`w¿pReque¡
(
behaviourReque¡
, 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
)));

111 
	`wr™eTo
(
behaviour
, 
»adBuf
, 
wr™eBuf
);

113 ià(
behaviourReque¡
.
»adyPos™iÚAÎoÿtiÚ0
 > 0) {

114 
¡d
::
veùÜ
<> 
»adyAÎoÿtiÚ
;

115 
»adyAÎoÿtiÚ
.
	`push_back
(
behaviourReque¡
.
»adyPos™iÚAÎoÿtiÚ0
);

116 
»adyAÎoÿtiÚ
.
	`push_back
(
behaviourReque¡
.
»adyPos™iÚAÎoÿtiÚ1
);

117 
»adyAÎoÿtiÚ
.
	`push_back
(
behaviourReque¡
.
»adyPos™iÚAÎoÿtiÚ2
);

118 
»adyAÎoÿtiÚ
.
	`push_back
(
behaviourReque¡
.
»adyPos™iÚAÎoÿtiÚ3
);

119 
»adyAÎoÿtiÚ
.
	`push_back
(
behaviourReque¡
.
»adyPos™iÚAÎoÿtiÚ4
);

121 
R—dySklPos™iÚAÎoÿtiÚ
 
	`ÃwPos™iÚAÎoÿtiÚ
(

122 
	`»adFrom
(
gameCÚŒŞËr
, 
¶ay”_numb”
), 
»adyAÎoÿtiÚ
);

124 
R—dySklPos™iÚAÎoÿtiÚ
 
cu¼’tPos™iÚAÎoÿtiÚ
 =

125 
	`»adFrom
(
behaviour
, 
behaviourSh¬edD©a
).
»adyPos™iÚAÎoÿtiÚ
;

126 ià(
ÃwPos™iÚAÎoÿtiÚ
.
	`ÿnOv”ride
(
cu¼’tPos™iÚAÎoÿtiÚ
)) {

127 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
»adyPos™iÚAÎoÿtiÚ
, 
ÃwPos™iÚAÎoÿtiÚ
);

132 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
gßl›A‰ackšg
, 
behaviourReque¡
.goalieAttacking);

133 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
došgB®lLšeUp
, 
behaviourReque¡
.doingBallLineUp);

134 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
isInR—dyMode
, 
behaviourReque¡
.isInReadyMode);

135 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
timeToR—chB®l
, 
behaviourReque¡
.timeToReachBall);

136 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
timeToR—chDeãnd”
, 
behaviourReque¡
.timeToReachDefender);

137 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
timeToR—chMidf›ld”
, 
behaviourReque¡
.timeToReachMidfielder);

138 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
timeToR—chUpf›ld”
, 
behaviourReque¡
.timeToReachUpfielder);

139 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
cu¼’tRŞe
, 
behaviourReque¡
.currentRole);

140 
	}
}

	@robot/perception/behaviour/BehaviourAdapter.hpp

32 #´agm¨
Úû


34 
	~<PythÚ.h
>

35 
	~"³rû±iÚ/behaviour/Kšem©icsC®ib¿tiÚSkl.hµ
"

36 
	~"³rû±iÚ/behaviour/SaãtySkl.hµ
"

37 
	~"bÏckbßrd/Ad­‹r.hµ
"

38 
	~"boo¡/sh¬ed_±r.hµ
"

39 
	~"³rû±iÚ/behaviour/pythÚ/PythÚSkl.hµ
"

41 
şass
 
	gSkl
;

44 şas 
	cBehaviourAd­‹r
 : 
Ad­‹r
 {

45 
public
:

47 
BehaviourAd­‹r
(
BÏckbßrd
 *
bb
);

49 ~
BehaviourAd­‹r
();

51 
tick
();

52 
	m´iv©e
:

53 
PythÚSkl
 *
pythÚSkl
;

54 
	mboo¡
::
sh¬ed_±r
<
Skl
> 
sklIn¡ªû
;

55 
	mboo¡
::
sh¬ed_±r
<
Skl
> 
h—dSkl
;

56 
Kšem©icsC®ib¿tiÚSkl
 
	mÿlib¿tiÚSkl
;

57 
SaãtySkl
 
	m§ãtySkl
;

	@robot/perception/behaviour/BehaviourHelpers.cpp

1 
	~"BehaviourH–³rs.hµ
"

3 
	~<cm©h
>

5 
	~"bÏckbßrd/BÏckbßrd.hµ
"

6 
	~"uts/basic_m©hs.hµ
"

7 
	~"ty³s/AbsCoÜd.hµ
"

8 
	~"ty³s/RRCoÜd.hµ
"

9 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

11 
Çme¥aû
 
	gBehaviourH–³rs
 {

12 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_OFF
(
çl£
, false, false);

13 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_RED
(
Œue
, 
çl£
, false);

14 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_GREEN
(
çl£
, 
Œue
, false);

15 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_BLUE
(
çl£
, f®£, 
Œue
);

16 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_YELLOW
(
Œue
,rue, 
çl£
);

17 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_CYAN
(
çl£
, 
Œue
,rue);

18 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_MAGENTA
(
Œue
, 
çl£
,rue);

19 cÚ¡ 
	gAùiÚCommªd
::
rgb
 
LED_WHITE
(
Œue
,rue,rue);

21 
¶ay”Numb”
(
BÏckbßrd
 *
bÏckbßrd
) {

22  (
»adFrom
(
gameCÚŒŞËr
, 
¶ay”_numb”
));

25 
‹amNumb”
(
BÏckbßrd
 *
bÏckbßrd
) {

26  (
»adFrom
(
gameCÚŒŞËr
, 
our_‹am
.
‹amNumb”
));

29 
ªgËToGßl
(cÚ¡ 
AbsCoÜd
 &
robÙPos
) {

30 
	ggßlX
 = 
FIELD_LENGTH
/2.0;

31 
	ggßlY
 = 0.0;

32 
	gphi
 = 
©ª2f
(
gßlY
 - 
robÙPos
.
y
(), 
gßlX
 -„obÙPos.
x
());

33  
NORMALISE
(
phi
 - 
robÙPos
.
th‘a
());

36 
boŞ
 
isNÙLoÿli£d
(
BÏckbßrd
 *
bÏckbßrd
, 
max_xy_v¬
,

37 
max_th‘a_v¬
) {

38 cÚ¡ 
	gAbsCoÜd
 &
	gpos
 = 
»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

39  ((
	gpos
.
g‘V¬
(0,0è> 
	gmax_xy_v¬
)

40 || (
	gpos
.
g‘V¬
(1,1è> 
	gmax_xy_v¬
)

41 || (
	gpos
.
g‘V¬
(2,2è> 
	gmax_th‘a_v¬
));

44 
boŞ
 
isLoÿli£d
(
BÏckbßrd
 *
bÏckbßrd
, 
mš_xy_v¬
,

45 
mš_th‘a_v¬
) {

46 cÚ¡ 
	gAbsCoÜd
 &
	gpos
 = 
»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

47  ((
	gpos
.
g‘V¬
(0,0è< 
	gmš_xy_v¬
)

48 && (
	gpos
.
g‘V¬
(1,1è< 
	gmš_xy_v¬
)

49 && (
	gpos
.
g‘V¬
(2,2è< 
	gmš_th‘a_v¬
));

52 
RRCoÜd
 
absToRr
(cÚ¡ 
AbsCoÜd
 &
äomPos
, cÚ¡ AbsCoÜd &
toPos
) {

53 
	gdi¡
 = 
hypÙ
(
toPos
.
x
()-
äomPos
.x(),oPos.
y
()-fromPos.y());

54 
	gh—dšg
 = 
NORMALISE
(
©ª2f
(
toPos
.
y
()-
äomPos
.y(),oPos.
x
()-äomPos.x())-äomPos.
th‘a
());

55  
RRCoÜd
(
di¡
, 
h—dšg
);

58 
ªgËToPošt
(
BÏckbßrd
 *
bÏckbßrd
, cÚ¡ 
AbsCoÜd
 &
pošt
) {

59 cÚ¡ 
	gAbsCoÜd
 &
	grobÙPos
 = 
»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

60  
NORMALISE
(
©ª2f
(
pošt
.
y
(è- 
robÙPos
.y(),…ošt.
x
() -„obotPos.x()));

63 
b®lAngËToPošt
(
BÏckbßrd
 *
bÏckbßrd
, cÚ¡ 
AbsCoÜd
 &
pošt
) {

64 cÚ¡ 
	gAbsCoÜd
 &
	gb®lPos
 = 
»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

65  
NORMALISE
(
©ª2f
(
pošt
.
y
(è- 
b®lPos
.y(),…ošt.
x
() - ballPos.x()));

69 
boŞ
 
isAligÃdW™hT¬g‘
(
BÏckbßrd
 *
bÏckbßrd
, 
ªgË
, cÚ¡ 
AbsCoÜd
 &
rg‘
) {

70 
	gxOff£t
;

71 
	gyOff£t
;

72 ià(
	grg‘
.
x
() == 2999) {

73 
xOff£t
 = 0;

74 
	gyOff£t
 = 100;

76 
	gxOff£t
 = 200;

77 
	gyOff£t
 = 0;

79 cÚ¡ 
	gAbsCoÜd
 &
	grobÙPos
 = 
»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

80 
	gªgË1
 = 
NORMALISE
(
BehaviourH–³rs
::
ªgËToPošt
(
bÏckbßrd
,

81 
AbsCoÜd
(
rg‘
.
x
(è+ 
xOff£t
,¬g‘.
y
(è+ 
yOff£t
, 0)è- 
robÙPos
.
th‘a
());

82 
	gªgË2
 = 
NORMALISE
(
ªgËToPošt
(
bÏckbßrd
,

83 
AbsCoÜd
(
rg‘
.
x
(è- 
xOff£t
,¬g‘.
y
(è- 
yOff£t
, 0)è- 
robÙPos
.
th‘a
());

86 
	gªgË1
 -ğ
ªgË
;

87 
	gªgË2
 -ğ
ªgË
;

88 
	gªgË1
 = 
NORMALISE
(
ªgË1
);

89 
	gªgË2
 = 
NORMALISE
(
ªgË2
);

91  ((
	gªgË1
 > 0 && 
	gªgË2
 < 0) || (angle1 < 0 &&‡ngle2 > 0));

95 
boŞ
 
isAligÃdW™hGßl
(
BÏckbßrd
 *
bÏckbßrd
, 
ªgË
, 
§ãty
) {

96 cÚ¡ 
	gAbsCoÜd
 &
	grobÙPos
 = 
»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

97 
	gËáGßl
 = 
NORMALISE
(
b®lAngËToPošt
(
bÏckbßrd
,

98 
AbsCoÜd
(
FIELD_LENGTH
/2, 
§ãty
 * 
GOAL_WIDTH
/2, 0)è- 
robÙPos
.
th‘a
());

99 
	grightGßl
 = 
NORMALISE
(
b®lAngËToPošt
(
bÏckbßrd
,

100 
AbsCoÜd
(
FIELD_LENGTH
/2, 
§ãty
 * -
GOAL_WIDTH
/2, 0)è- 
robÙPos
.
th‘a
());

103 
	gËáGßl
 -ğ
ªgË
;

104 
	grightGßl
 -ğ
ªgË
;

105 
	gËáGßl
 = 
NORMALISE
(
ËáGßl
);

106 
	grightGßl
 = 
NORMALISE
(
rightGßl
);

108  (
	gËáGßl
 > 0 && 
	grightGßl
 < 0) || (leftGoal < 0 &&„ightGoal > 0);

111 
	g¡d
::
·œ
<
RRCoÜd
, > 
g‘Be¡ShoÙPoštRr
(
BÏckbßrd
 *
bÏckbßrd
,

112 
¡d
::
veùÜ
<> 
ªgËs
, cÚ¡ 
AbsCoÜd
 &
pošt
, 
xOff£t
, 
bŸs
) {

113 
	g¡d
::
veùÜ
<
RRCoÜd
> 
pošts
;

114 
	g¡d
::
veùÜ
<>::
™”©Ü
 
i
 = 
ªgËs
.
begš
(); 
	gi
 !ğªgËs.
’d
(); ++i) {

115 
	gpošts
.
push_back
(
BehaviourH–³rs
::
g‘ShoÙPoštRr
(
bÏckbßrd
, *
i
, 
pošt
, 
xOff£t
));

117 
	gbe¡Pošt
 = 0;

118 
	gi
 = 0; i < 
	gpošts
.
size
(); ++i) {

119 ià((
	gpošts
[
i
].
di¡ªû
(è+ 
bŸs
 * 
ABS
(
RAD2DEG
(
ªgËs
[i]))) <

120 (
	gpošts
[
be¡Pošt
].
di¡ªû
(è+ 
bŸs
 * 
ABS
(
RAD2DEG
(
ªgËs
[bestPoint])))) {

121 
	gbe¡Pošt
 = 
i
;

124  
	g¡d
::
·œ
<
RRCoÜd
, >(
	gpošts
[
be¡Pošt
], 
	gªgËs
[bestPoint]);

127 
RRCoÜd
 
g‘ShoÙPoštRr
(
BÏckbßrd
 *
bÏckbßrd
, 
ªgË
,

128 cÚ¡ 
AbsCoÜd
 &
pošt
, 
off£t
) {

130 
AbsCoÜd
 
	gb®lPos
 = 
BehaviourH–³rs
::
g‘B®lPosAbs
(
bÏckbßrd
);

132 
	gEig’
::
VeùÜ2f
 
veùÜ
(
pošt
.
x
(è- 
b®lPos
.x(),…ošt.
y
() - ballPos.y());

133 
	gveùÜ
.
nÜm®ize
();

136 
	gEig’
::
VeùÜ2f
 
lšeup
(40 * 
veùÜ
[1], - 40 * vector[0]);

139 
	gveùÜ
 *ğ
off£t
;

148 
	gEig’
::
VeùÜ2f
 
lšeUpVeùÜ
(
veùÜ
[0] * 
cosf
(-
ªgË
è- veùÜ[1] * 
sšf
(-angle),

149 
veùÜ
[0] * 
sšf
(-
ªgË
è+ veùÜ[1] * 
cosf
(-angle));

151 cÚ¡ 
	gAbsCoÜd
 &
	gpos
 = 
»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

152  
absToRr
(
AbsCoÜd
(
pos
.
x
(),…os.
y
(),…os.
th‘a
()),

153 
AbsCoÜd
(
b®lPos
.
x
(è+ 
lšeUpVeùÜ
[0], b®lPos.
y
() +†ineUpVector[1], 0));

156 
AbsCoÜd
 
g‘B®lPosAbs
(
BÏckbßrd
 *
bÏckbßrd
) {

157  
»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

167 
myWeigh‹dDi¡ªûToB®l
(
BÏckbßrd
 *
bÏckbßrd
) {

168 
	glo¡CouÁ
 = 
»adFrom
(
loÿli§tiÚ
, 
b®lLo¡CouÁ
);

169 
AbsCoÜd
 
	grobÙPos
 = 
»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

171 
AbsCoÜd
 
	gb®lPosAbs
 = 
»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

172 
RRCoÜd
 
	gb®lPos
 = 
b®lPosAbs
.
cÚv”tToRobÙR–©ive
(
robÙPos
);

174 
	gtuºAngË
 = 
ABS
(
NORMALISE
(
BehaviourH–³rs
::
ªgËToGßl
(
robÙPos
)));

175 
	gweigh‹dDi¡
 = 
b®lPos
.
di¡ªû
(è+ 
tuºAngË
*(1000.0/
M_PI
);

176 ià(
	glo¡CouÁ
 > 210) {

177 
	gweigh‹dDi¡
 += 1000;

179 ià(
	glo¡CouÁ
 > 300) {

180 
	gweigh‹dDi¡
 += 2000;

182  
	gweigh‹dDi¡
;

185 
fšdNumInÿ·c™©ed
(
BÏckbßrd
 *
bÏckbßrd
) {

186 cÚ¡ 
boŞ
 *
	gšÿ·c™©ed
 = 
»adFrom
(
»ûiv”
, 
šÿ·c™©ed
);

187 
	gšÿpCouÁ
 = 0;

188 
	gi
 = 0; i < 
	gROBOTS_PER_TEAM
; ++i) {

189 ià(
	gšÿ·c™©ed
[
i
]) {

190 ++
	gšÿpCouÁ
;

193  
	gšÿpCouÁ
;

196 
AbsCoÜd
 
g‘T—mB®l
(
BÏckbßrd
 *
bÏckbßrd
) {

200  
»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

	@robot/perception/behaviour/BehaviourHelpers.hpp

1 #´agm¨
Úû


3 
	~"ty³s/AùiÚCommªd.hµ
"

4 
	~"ty³s/AbsCoÜd.hµ
"

5 
	~"uts/SPLDefs.hµ
"

6 
	~"uts/basic_m©hs.hµ
"

8 
şass
 
	gBÏckbßrd
;

9 
şass
 
	gBehaviourReque¡
;

10 
şass
 
	gPo¡Info
;

11 
şass
 
	gRRCoÜd
;

13 
Çme¥aû
 
	gBehaviourH–³rs
 {

14 
¶ay”Numb”
(
BÏckbßrd
 *
bÏckbßrd
);

15 
‹amNumb”
(
BÏckbßrd
 *
bÏckbßrd
);

16 
ªgËToGßl
(cÚ¡ 
AbsCoÜd
 &
robÙPos
);

17 
boŞ
 
isNÙLoÿli£d
(
BÏckbßrd
 *
bÏckbßrd
, 
max_xy_v¬
 = 1e6,

18 
max_th‘a_v¬
 = 
SQUARE
(
DEG2RAD
(12)));

19 
boŞ
 
isLoÿli£d
(
BÏckbßrd
 *
bÏckbßrd
, 
mš_xy_v¬
 = 6e4,

20 
mš_th‘a_v¬
 = 
DEG2RAD
(3));

21 
RRCoÜd
 
absToRr
(cÚ¡ 
AbsCoÜd
 &
äomPos
, cÚ¡ AbsCoÜd &
toPos
);

22 
ªgËToPošt
(
BÏckbßrd
 *
bÏckbßrd
,

23 cÚ¡ 
AbsCoÜd
 &
pošt
 = AbsCoÜd(
FIELD_LENGTH
/2, 0, 0));

24 
b®lAngËToPošt
(
BÏckbßrd
 *
bÏckbßrd
,

25 cÚ¡ 
AbsCoÜd
 &
pošt
 = AbsCoÜd(
FIELD_LENGTH
/2, 0, 0));

26 
boŞ
 
isAligÃdW™hT¬g‘
(
BÏckbßrd
 *
bÏckbßrd
, 
ªgË
 = 0,

27 cÚ¡ 
AbsCoÜd
 &
rg‘
 = AbsCoÜd(
FIELD_LENGTH
/2, 0, 0));

28 
boŞ
 
isAligÃdW™hGßl
(
BÏckbßrd
 *
bÏckbßrd
, 
ªgË
 = 0, 
§ãty
 = 0.5);

29 
	g¡d
::
·œ
<
RRCoÜd
, > 
g‘Be¡ShoÙPoštRr
(
BÏckbßrd
 *
bÏckbßrd
,

30 
¡d
::
veùÜ
<> 
ªgËs
 = std::vector<>(0.0, 1),

31 cÚ¡ 
AbsCoÜd
 &
pošt
 = AbsCoÜd(
FIELD_LENGTH
/2, 0, 0),

32 
xOff£t
 = -250, 
bŸs
=1.2);

33 
RRCoÜd
 
g‘ShoÙPoštRr
(
BÏckbßrd
 *
bÏckbßrd
, 
ªgË
 = 0,

34 cÚ¡ 
AbsCoÜd
 &
pošt
 = AbsCoÜd(
FIELD_LENGTH
/2, 0, 0),

35 
off£t
 = -250);

36 
AbsCoÜd
 
g‘B®lPosAbs
(
BÏckbßrd
 *
bÏckbßrd
);

38 
myWeigh‹dDi¡ªûToB®l
(
BÏckbßrd
 *
bÏckbßrd
);

39 
	g¡d
::
·œ
<, > 
mšWeigh‹dDi¡ªûToB®l
(
BÏckbßrd
 *
bÏckbßrd
);

41 
fšdNumInÿ·c™©ed
(
BÏckbßrd
 *
bÏckbßrd
);

43 
AbsCoÜd
 
g‘T—mB®l
(
BÏckbßrd
 *
bÏckbßrd
);

45 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_OFF
;

46 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_RED
;

47 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_GREEN
;

48 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_BLUE
;

49 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_YELLOW
;

50 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_CYAN
;

51 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_MAGENTA
;

52 cÚ¡ 
AùiÚCommªd
::
rgb
 
LED_WHITE
;

	@robot/perception/behaviour/KinematicsCalibrationSkill.cpp

1 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

2 
	~<boo¡/num”ic/ubÏs/lu.hµ
>

3 
	~<boo¡/num”ic/ubÏs/io.hµ
>

4 
	~<io¡»am
>

5 
	~<s¡»am
>

6 
	~<¡ršg
>

7 
	~<ut™y
>

8 
	~"³rû±iÚ/behaviour/Kšem©icsC®ib¿tiÚSkl.hµ
"

9 
	~"ty³s/RRCoÜd.hµ
"

10 
	~"bÏckbßrd/BÏckbßrd.hµ
"

11 
	~"ty³s/AùiÚCommªd.hµ
"

12 
	~"³rû±iÚ/kšem©ics/Kšem©ics.hµ
"

13 
	~"³rû±iÚ/kšem©ics/Po£.hµ
"

14 
	~"uts/Logg”.hµ
"

15 
	~"FADBAD++/çdiff.h
"

17 
	gçdbad
::
F
<> 
çdbadAn2
(
çdbad
::F<> 
y
, fadbad::F<> 
x
) {

18 
çdbad
::
F
<> 
PI
 = 3.1415926535;

19 ià(
	gx
 == 0) {

20 ià(
y
 > 0) {

21  
PI
 / 2;

22 } ià(
	gy
 < 0) {

23  -
	gPI
 / 2;

27 } ià(
	gx
 > 0) {

28  
	gçdbad
::
©ª
(
y
 / 
x
);

29 } ià(
	gy
 >ğ0 && 
x
 < 0) {

30  
çdbad
::
©ª
(
y
 / 
x
è+ 
PI
;

31 } ià(
	gy
 < 0 && 
	gx
 < 0) {

32  
	gçdbad
::
©ª
(
y
 / 
x
è- 
PI
;

38 
	gKšem©icsC®ib¿tiÚSkl
::
	$Kšem©icsC®ib¿tiÚSkl
(
BÏckbßrd
 *
bb
è: 
	$Ad­‹r
(
bb
) {

39 
pošts
.
	`push_back
(
¡d
::
	`make_·œ
(-3020 + 1200, -2025));

40 
pošts
.
	`push_back
(
¡d
::
	`make_·œ
(1200, -2025));

41 
pošts
.
	`push_back
(
¡d
::
	`make_·œ
(1200, 0));

42 
pošts
.
	`push_back
(
¡d
::
	`make_·œ
(1200, 2025));

43 
pošts
.
	`push_back
(
¡d
::
	`make_·œ
(-3020 + 1200, 2025));

44 
cu¼’tWaypošt
 = 0;

45 
b“nAtF¿meFÜ
 = 0;

46 
k’R—dšg
 = 
çl£
;

47 
	`»£tG¿d›Ás
();

48 
®pha
 = 
MAX_ALPHA
;

49 
isTİ
 = 
çl£
;

50 
	}
}

52 
	gKšem©icsC®ib¿tiÚSkl
::~
	$Kšem©icsC®ib¿tiÚSkl
(è{
	}
}

69 
çdbad
::
F
<> 
Kšem©icsC®ib¿tiÚSkl
::
objeùiveFunùiÚ
(

70 
P¬am‘”s
<
çdbad
::
F
<> > &
·¿m‘”s
) {

71 
Kšem©ics
 
kšem©ics
;

72 
	gkšem©ics
.
	g£nsÜV®ues
 = 
»adFrom
(
mÙiÚ
, 
£nsÜs
);

73 
	gkšem©ics
.
	g·¿m‘”s
 = 
·¿m‘”s
.
ÿ¡
<>();

75 
	gkšem©ics
.
upd©eDHChaš
();

76 
Po£
 
	gpo£
 = 
kšem©ics
.
g‘Po£
();

80 
Pošt
 
	gcc_p
 = 
»adFrom
(
visiÚ
, 
b®ls
[0].
imageCoÜds
);

81 
	g¡d
::
·œ
<
ušt16_t
, 
	gušt16_t
> 
cc
(
cc_p
.
x
(), cc_p.
y
());

84 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
çdbad
::
F
<> > 
lOrigš
, 
	glOrigš2
;

85 
	gçdbad
::
F
<> 
imgCŞs
 = 
IMAGE_COLS
;

86 
	gçdbad
::
F
<> 
imgRows
 = 
IMAGE_ROWS
;

87 
	gçdbad
::
F
<> 
pix–Size
 = 
TOP_PIXEL_SIZE
;

88 
	gçdbad
::
F
<> 
x
 = 
cc
.
fœ¡
;

89 
	gçdbad
::
F
<> 
y
 = 
cc
.
£cÚd
;

90 
	glOrigš2
 = 
vec4
<
çdbad
::
F
<> >(

91 (((
imgCŞs
è/ 2.0 - 
x
è* 
pix–Size
),

92 (((
	gimgRows
è/ 2.0 - 
	gy
è* 
	gpix–Size
),

96 
	glOrigš
 = 
´od
(

97 
po£
.
g‘C2wT¿nsfÜm
(),

98 
lOrigš2
);

100 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
çdbad
::
F
<> > 
toPix–
, 
	gtoPix–2
;

101 
	gtoPix–2
 = 
vec4
<
çdbad
::
F
<> >(0, 0, 
	gFOCAL_LENGTH
, 1);

102 
	gtoPix–
 = 
´od
(

103 
po£
.
g‘C2wT¿nsfÜm
(),

104 
toPix–2
);

106 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
çdbad
::
F
<> > 
cdœ
(
toPix–
 - 
lOrigš
);

108 
	gçdbad
::
F
<> 
Ïmbda
 = (35 - 
lOrigš
(2, 0)è/ (1.0 * 
cdœ
(2, 0));

109 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
çdbad
::
F
<> > 
š‹rû±
;

110 
	gš‹rû±
 = 
vec4
<
çdbad
::
F
<> >(
lOrigš
(0, 0è+ 
Ïmbda
 * 
cdœ
(0, 0),

111 
lOrigš
(1, 0è+ 
Ïmbda
 * 
cdœ
(1, 0),

114 
	gçdbad
::
F
<> 
di¡ªû
, 
	gh—dšg
;

115 
	gdi¡ªû
 = 
çdbad
::
sq¹
(çdbad::
pow
(
š‹rû±
(0, 0), 2) +

116 
çdbad
::
pow
(
š‹rû±
(1, 0), 2));

117 
	gh—dšg
 = 
çdbadAn2
(
š‹rû±
(1, 0), intercept(0, 0));

118 
	gçdbad
::
F
<> 
px
, 
	gpy
;

119 
	gpx
 = 
çdbad
::
cos
(
h—dšg
è* 
di¡ªû
;

120 
	gpy
 = 
çdbad
::
sš
(
h—dšg
è* 
di¡ªû
;

123 
	gtx
, 
	gty
;

124 
	gtx
 = 
px
.
x
();

125 
	gty
 = 
py
.
x
();

127 
	gmšIndex
 = 0;

128 
	grx
, 
	gry
;

129 
	grx
 = 
pošts
[0].
fœ¡
;

130 
	gry
 = 
pošts
[0].
£cÚd
;

131 
	gbDi¡ªû
 = 
sq¹
(
pow
(
rx
 - 
tx
, 2è+…ow(
ry
 - 
ty
, 2));

132 
	gi
 = 1; i < 
	gpošts
.
size
(); i++) {

133 
	grx
 = 
pošts
[
i
].
fœ¡
;

134 
	gry
 = 
pošts
[
i
].
£cÚd
;

135 
	gcDi¡ªû
 = 
sq¹
(
pow
(
rx
 - 
tx
, 2è+…ow(
ry
 - 
ty
, 2));

136 ià(
	gcDi¡ªû
 < 
	gbDi¡ªû
) {

137 
	gbDi¡ªû
 = 
cDi¡ªû
;

138 
	gmšIndex
 = 
i
;

142 
	gçdbad
::
F
<> 
bx
, 
	gby
;

143 
	gbx
 = 
pošts
[
mšIndex
].
fœ¡
;

144 
	gby
 = 
pošts
[
mšIndex
].
£cÚd
;

145  
	gçdbad
::
sq¹
(
çdbad
::
pow
(
bx
 - 
px
, 2) +

146 
çdbad
::
pow
(
by
 - 
py
, 2));

149 
	gKšem©icsC®ib¿tiÚSkl
::
	$upd©eG¿d›Á
() {

151 
P¬am‘”s
<
çdbad
::
F
<> > 
·¿m‘”s
;

152 
·¿m‘”s
.
ÿm”aYawBÙtom
 = 
	`»adFrom
(
kšem©ics
,

153 
·¿m‘”s
.
ÿm”aYawBÙtom
);

154 
·¿m‘”s
.
ÿm”aP™chBÙtom
 = 
	`»adFrom
(
kšem©ics
,

155 
·¿m‘”s
.
ÿm”aP™chBÙtom
);

156 
·¿m‘”s
.
ÿm”aRŞlBÙtom
 = 
	`»adFrom
(
kšem©ics
,

157 
·¿m‘”s
.
ÿm”aRŞlBÙtom
);

158 
·¿m‘”s
.
ÿm”aYawTİ
 = 
	`»adFrom
(
kšem©ics
,

159 
·¿m‘”s
.
ÿm”aYawTİ
);

160 
·¿m‘”s
.
ÿm”aP™chTİ
 = 
	`»adFrom
(
kšem©ics
,

161 
·¿m‘”s
.
ÿm”aP™chTİ
);

162 
·¿m‘”s
.
ÿm”aRŞlTİ
 = 
	`»adFrom
(
kšem©ics
,

163 
·¿m‘”s
.
ÿm”aRŞlTİ
);

164 
·¿m‘”s
.
bodyP™ch
 = 
	`»adFrom
(
kšem©ics
,…arameters.bodyPitch);

165 
Ï¡P¬ams
 = 
·¿m‘”s
;

168 
·¿m‘”s
.
ÿm”aYawBÙtom
.
	`diff
(0, 7);

169 
·¿m‘”s
.
ÿm”aP™chBÙtom
.
	`diff
(1, 7);

170 
·¿m‘”s
.
ÿm”aRŞlBÙtom
.
	`diff
(2, 7);

172 
·¿m‘”s
.
ÿm”aYawTİ
.
	`diff
(3, 7);

173 
·¿m‘”s
.
ÿm”aP™chTİ
.
	`diff
(4, 7);

174 
·¿m‘”s
.
ÿm”aRŞlTİ
.
	`diff
(5, 7);

176 
·¿m‘”s
.
bodyP™ch
.
	`diff
(6, 7);

179 
çdbad
::
F
<> 
f
 = 
	`objeùiveFunùiÚ
(
·¿m‘”s
);

181 
v®ue
 +ğ
f
.
	`x
();

182 
n
 += 1;

184 
g¿d›Ás
.
ÿm”aYawBÙtom
 +ğ
f
.
	`d
(0);

185 
g¿d›Ás
.
ÿm”aP™chBÙtom
 +ğ
f
.
	`d
(1);

186 
g¿d›Ás
.
ÿm”aRŞlBÙtom
 +ğ
f
.
	`d
(2);

187 
g¿d›Ás
.
ÿm”aYawTİ
 +ğ
f
.
	`d
(3);

188 
g¿d›Ás
.
ÿm”aP™chTİ
 +ğ
f
.
	`d
(4);

189 
g¿d›Ás
.
ÿm”aRŞlTİ
 +ğ
f
.
	`d
(5);

191 
g¿d›Ás
.
bodyP™ch
 +ğ
f
.
	`d
(6);

192 
	}
}

194 
BehaviourReque¡
 
	gKšem©icsC®ib¿tiÚSkl
::
	$execu‹
() {

195 
BehaviourReque¡
 
»que¡
;

196 ià(
	`»adFrom
(
visiÚ
, 
b®ls
).
	`size
() > 0 &&

197 
b“nAtF¿meFÜ
 > 
STABALIZE_FRAMES
) {

198 
	`upd©eG¿d›Á
();

199 
k’R—dšg
 = 
Œue
;

203 ià(
Œue
 && 
cu¼’tWaypošt
 =ğ
pošts
.
	`size
() - 1 &&

204 
k’R—dšg
 =ğ
Œue
) {

205 
P¬am‘”s
<
çdbad
::
F
<> > 
·¿m‘”s
;

206 
·¿m‘”s
.
ÿm”aYawBÙtom
 = 
	`»adFrom
(
kšem©ics
,

207 
·¿m‘”s
.
ÿm”aYawBÙtom
);

208 
·¿m‘”s
.
ÿm”aP™chBÙtom
 = 
	`»adFrom
(
kšem©ics
,

209 
·¿m‘”s
.
ÿm”aP™chBÙtom
);

210 
·¿m‘”s
.
ÿm”aRŞlBÙtom
 = 
	`»adFrom
(
kšem©ics
,

211 
·¿m‘”s
.
ÿm”aRŞlBÙtom
);

212 
·¿m‘”s
.
ÿm”aYawTİ
 = 
	`»adFrom
(
kšem©ics
,

213 
·¿m‘”s
.
ÿm”aYawTİ
);

214 
·¿m‘”s
.
ÿm”aP™chTİ
 = 
	`»adFrom
(
kšem©ics
,

215 
·¿m‘”s
.
ÿm”aP™chTİ
);

216 
·¿m‘”s
.
ÿm”aRŞlTİ
 = 
	`»adFrom
(
kšem©ics
,

217 
·¿m‘”s
.
ÿm”aRŞlTİ
);

218 
·¿m‘”s
.
bodyP™ch
 = 
	`»adFrom
(
kšem©ics
,…arameters.bodyPitch);

221 
	`g¿d›ÁDesûÁ
(
·¿m‘”s
, 
g¿d›Ás
);

224 
	`wr™eTo
(
kšem©ics
, 
·¿m‘”s
.
ÿm”aYawBÙtom
,

225 
·¿m‘”s
.
ÿm”aYawBÙtom
.
	`x
());

226 
	`wr™eTo
(
kšem©ics
, 
·¿m‘”s
.
ÿm”aP™chBÙtom
,

227 
·¿m‘”s
.
ÿm”aP™chBÙtom
.
	`x
());

228 
	`wr™eTo
(
kšem©ics
, 
·¿m‘”s
.
ÿm”aRŞlBÙtom
,

229 
·¿m‘”s
.
ÿm”aRŞlBÙtom
.
	`x
());

230 
	`wr™eTo
(
kšem©ics
, 
·¿m‘”s
.
ÿm”aYawTİ
,

231 
·¿m‘”s
.
ÿm”aYawTİ
.
	`x
());

232 
	`wr™eTo
(
kšem©ics
, 
·¿m‘”s
.
ÿm”aP™chTİ
,

233 
·¿m‘”s
.
ÿm”aP™chTİ
.
	`x
());

234 
	`wr™eTo
(
kšem©ics
, 
·¿m‘”s
.
ÿm”aRŞlTİ
,

235 
·¿m‘”s
.
ÿm”aRŞlTİ
.
	`x
());

237 
	`wr™eTo
(
kšem©ics
, 
·¿m‘”s
.
bodyP™ch
,…¬am‘”s.bodyP™ch.
	`x
());

238 
	`»£tG¿d›Ás
();

239 
isTİ
 = !isTop;

242 
¡d
::
·œ
<, > 
cwp
 = 
pošts
[
cu¼’tWaypošt
];

243 
ªgË
 = 
	`©ª2
(
cwp
.
£cÚd
, cwp.
fœ¡
);

244 ià(
	`abs
(
	`»adFrom
(
mÙiÚ
, 
£nsÜs
).
jošts
.
ªgËs
[
Jošts
::
H—dYaw
] - 
ªgË
) < .01) {

245 
b“nAtF¿meFÜ
++;

248 ià(
k’R—dšg
 =ğ
Œue
) {

249 
b“nAtF¿meFÜ
 = 0;

250 
cu¼’tWaypošt
 = (cu¼’tWaypošˆ+ 1è% 
pošts
.
	`size
();

251 
k’R—dšg
 = 
çl£
;

255 ià(
isTİ
) {

256 
»que¡
.
aùiÚs
.
h—d
 = 
AùiÚCommªd
::
	`H—d
(
ªgË
,

257 
	`DEG2RAD
(5), 
çl£
, 0.5f, 0.5f);

259 
»que¡
.
aùiÚs
.
h—d
 = 
AùiÚCommªd
::
	`H—d
(
ªgË
,

260 
	`DEG2RAD
(-25), 
çl£
, 0.5f, 0.5f);

262 
»que¡
.
aùiÚs
.
body
 = 
AùiÚCommªd
::
Body
::
STAND
;

264  
»que¡
;

265 
	}
}

267 
	gKšem©icsC®ib¿tiÚSkl
::
	$»£tG¿d›Ás
() {

268 
n
 = 0;

269 
v®ue
 = 0;

270 
g¿d›Ás
.
ÿm”aYawBÙtom
 = 0;

271 
g¿d›Ás
.
ÿm”aP™chBÙtom
 = 0;

272 
g¿d›Ás
.
ÿm”aRŞlBÙtom
 = 0;

273 
g¿d›Ás
.
ÿm”aYawTİ
 = 0;

274 
g¿d›Ás
.
ÿm”aP™chTİ
 = 0;

275 
g¿d›Ás
.
ÿm”aRŞlTİ
 = 0;

277 
g¿d›Ás
.
bodyP™ch
 = 0;

278 
	}
}

281 
boŞ
 
	gKšem©icsC®ib¿tiÚSkl
::
g¿d›ÁDesûÁ
(

282 
P¬am‘”s
<
çdbad
::
F
<> > &
·¿m‘”s
,

283 
P¬am‘”s
<
çdbad
::
F
<> > 
g¿d›Ás
) {

284 
·¿m‘”s
.
ÿm”aYawBÙtom
 -ğ
®pha
 * 
g¿d›Ás
.ÿm”aYawBÙtom / 
n
;

285 
	g·¿m‘”s
.
	gÿm”aP™chBÙtom
 -ğ
®pha
 * 
g¿d›Ás
.
ÿm”aP™chBÙtom
 / 
n
;

286 
	g·¿m‘”s
.
	gÿm”aRŞlBÙtom
 -ğ
®pha
 * 
g¿d›Ás
.
ÿm”aRŞlBÙtom
 / 
n
;

287 
	g·¿m‘”s
.
	gÿm”aYawTİ
 -ğ
®pha
 * 
g¿d›Ás
.
ÿm”aYawTİ
 / 
n
;

288 
	g·¿m‘”s
.
	gÿm”aP™chTİ
 -ğ
®pha
 * 
g¿d›Ás
.
ÿm”aP™chTİ
 / 
n
;

289 
	g·¿m‘”s
.
	gÿm”aRŞlTİ
 -ğ
®pha
 * 
g¿d›Ás
.
ÿm”aRŞlTİ
 / 
n
;

290 
	g·¿m‘”s
.
	gbodyP™ch
 -ğ
®pha
 * 
g¿d›Ás
.
bodyP™ch
 / 
n
;

291 
	g®pha
 -= 0.0005;

292 ià(
	g®pha
 < 
	gMIN_ALPHA
) {

293 
	g®pha
 = 
MIN_ALPHA
;

297 
	g¡d
::
cout
 << 
´štP¬ams
(
·¿m‘”s
è<< 
¡d
::
’dl
;

298 
	g¡d
::
cout
 << "Gradients: ";

299 
	g¡d
::
cout
 << 
g¿d›Ás
.
ÿm”aYawBÙtom
.
x
() << " " <<

300 
g¿d›Ás
.
ÿm”aP™chBÙtom
.
x
() << " " <<

301 
g¿d›Ás
.
ÿm”aRŞlBÙtom
.
x
() << " " <<

302 
g¿d›Ás
.
bodyP™ch
.
x
(è<< 
¡d
::
’dl
;

303 
	g¡d
::
cout
 << "V®ue: " << 
v®ue
 / 
n
 << 
¡d
::
’dl
;

304 
	g¡d
::
cout
 << "AÍha: " << 
®pha
 << 
¡d
::
’dl
;

305 
	g¡d
::
cout
 << 
¡d
::
’dl
;

307  
	gçl£
;

310 
	g¡d
::
¡ršg
 
Kšem©icsC®ib¿tiÚSkl
::
´štP¬ams
(

311 
P¬am‘”s
<
çdbad
::
F
<> > &
·¿m‘”s
) {

312 
¡d
::
¡ršg¡»am
 
s
;

313 
	g¡d
::
veùÜ
<
¡d
::
·œ
<¡d::
¡ršg
, > > 
	g¶i¡
;

314 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

315 "ÿm”aYawBÙtom", 
·¿m‘”s
.
ÿm”aYawBÙtom
.
x
()));

316 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

317 "ÿm”aP™chBÙtom", 
·¿m‘”s
.
ÿm”aP™chBÙtom
.
x
()));

318 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

319 "ÿm”aRŞlBÙtom", 
·¿m‘”s
.
ÿm”aRŞlBÙtom
.
x
()));

320 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

321 "ÿm”aYawTİ", 
·¿m‘”s
.
ÿm”aYawTİ
.
x
()));

322 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

323 "ÿm”aP™chTİ", 
·¿m‘”s
.
ÿm”aP™chTİ
.
x
()));

324 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

325 "ÿm”aRŞlTİ", 
·¿m‘”s
.
ÿm”aRŞlTİ
.
x
()));

328 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

329 "bodyP™ch", 
·¿m‘”s
.
bodyP™ch
.
x
()));

331 
	gi
 = 0; i < 
	g¶i¡
.
size
(); i++) {

332 
	gs
 << 
	g¶i¡
[
i
].
	gfœ¡
 << "=" <<…li¡[i].
	g£cÚd
 << 
	g¡d
::
’dl
;

334  
	gs
.
¡r
();

337 
	g¡d
::
¡ršg
 
Kšem©icsC®ib¿tiÚSkl
::
´štP¬ams
(

338 
P¬am‘”s
<> &
·¿m‘”s
) {

339 
¡d
::
¡ršg¡»am
 
s
;

340 
	g¡d
::
veùÜ
<
¡d
::
·œ
<¡d::
¡ršg
, > > 
	g¶i¡
;

341 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

342 "ÿm”aYawBÙtom", 
·¿m‘”s
.
ÿm”aYawBÙtom
));

343 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

344 "ÿm”aP™chBÙtom", 
·¿m‘”s
.
ÿm”aP™chBÙtom
));

345 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

346 "ÿm”aRŞlBÙtom", 
·¿m‘”s
.
ÿm”aRŞlBÙtom
));

347 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

348 "ÿm”aYawTİ", 
·¿m‘”s
.
ÿm”aYawTİ
));

349 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

350 "ÿm”aP™chTİ", 
·¿m‘”s
.
ÿm”aP™chTİ
));

351 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

352 "ÿm”aRŞlTİ", 
·¿m‘”s
.
ÿm”aRŞlTİ
));

354 
	g¶i¡
.
push_back
(
¡d
::
make_·œ
(

355 "bodyP™ch", 
·¿m‘”s
.
bodyP™ch
));

356 
	gi
 = 0; i < 
	g¶i¡
.
size
(); i++) {

357 
	gs
 << 
	g¶i¡
[
i
].
	gfœ¡
 << "=" <<…li¡[i].
	g£cÚd
 << 
	g¡d
::
’dl
;

359  
	gs
.
¡r
();

	@robot/perception/behaviour/KinematicsCalibrationSkill.hpp

1 #´agm¨
Úû


2 
	~<veùÜ
>

3 
	~<ut™y
>

4 
	~<¡ršg
>

5 
	~"³rû±iÚ/kšem©ics/P¬am‘”s.hµ
"

6 
	~"bÏckbßrd/Ad­‹r.hµ
"

7 
	~"ty³s/RRCoÜd.hµ
"

8 
	~"uts/Tim”.hµ
"

9 
	~"ty³s/BehaviourReque¡.hµ
"

10 
	~"FADBAD++/çdiff.h
"

12 
	#MIN_ALPHA
 0.004f

	)

13 
	#MAX_ALPHA
 (
MIN_ALPHA
 * 2)

	)

14 
	#STABALIZE_FRAMES
 25

	)

16 şas 
	cKšem©icsC®ib¿tiÚSkl
 : 
Ad­‹r
 {

17 
public
:

18 
Kšem©icsC®ib¿tiÚSkl
(
BÏckbßrd
 *
bÏckbßrd
);

19 ~
Kšem©icsC®ib¿tiÚSkl
();

21 
BehaviourReque¡
 
execu‹
();

22 
	m¡d
::
¡ršg
 
´štP¬ams
(
P¬am‘”s
<>

23 &
·¿m‘”s
);

24 
	m´iv©e
:

25 
Tim”
 
tim”
;

27 
	mP¬am‘”s
<
	mçdbad
::
F
<> > 
Ï¡P¬ams
;

28 
	mçdbad
::
F
<> 
objeùiveFunùiÚ
(

29 
P¬am‘”s
<
çdbad
::
F
<> > &
·¿m‘”s
);

30 
boŞ
 
g¿d›ÁDesûÁ
(

31 
P¬am‘”s
<
çdbad
::
F
<> > &
·¿m‘”s
,

32 
P¬am‘”s
<
çdbad
::
F
<> > 
g¿d›Ás
);

33 
	m¡d
::
¡ršg
 
´štP¬ams
(
P¬am‘”s
<
çdbad
::
F
<> >

34 &
·¿m‘”s
);

35 
»£tG¿d›Ás
();

36 
upd©eG¿d›Á
();

37 
	m¡d
::
veùÜ
<
¡d
::
·œ
<, > > 
	mpošts
;

38 
	mcu¼’tWaypošt
;

39 
	mb“nAtF¿meFÜ
;

40 
boŞ
 
	mk’R—dšg
;

41 
	mn
;

42 
	mv®ue
;

43 
	m®pha
;

44 
boŞ
 
	misTİ
;

45 
	mP¬am‘”s
<
	mçdbad
::
F
<> > 
g¿d›Ás
;

	@robot/perception/behaviour/ReadySkillPositionAllocation.cpp

8 
	~"R—dySklPos™iÚAÎoÿtiÚ.hµ
"

10 
	~<io¡»am
>

12 
	gR—dySklPos™iÚAÎoÿtiÚ
::
	$R—dySklPos™iÚAÎoÿtiÚ
(è:
	$äomPÏy”Num
(0) {

13 
»adyPos™iÚAÎoÿtiÚ0
 = -1;

14 
»adyPos™iÚAÎoÿtiÚ1
 = -1;

15 
»adyPos™iÚAÎoÿtiÚ2
 = -1;

16 
»adyPos™iÚAÎoÿtiÚ3
 = -1;

17 
»adyPos™iÚAÎoÿtiÚ4
 = -1;

18 
	}
}

20 
	gR—dySklPos™iÚAÎoÿtiÚ
::
R—dySklPos™iÚAÎoÿtiÚ
(
äomPÏy”Num
, 
¡d
::
veùÜ
<> 
pos™iÚAÎoÿtiÚs
) :

21 
	$äomPÏy”Num
(
äomPÏy”Num
) {

22 
»adyPos™iÚAÎoÿtiÚ0
 = 
pos™iÚAÎoÿtiÚs
[0];

23 
»adyPos™iÚAÎoÿtiÚ1
 = 
pos™iÚAÎoÿtiÚs
[1];

24 
»adyPos™iÚAÎoÿtiÚ2
 = 
pos™iÚAÎoÿtiÚs
[2];

25 
»adyPos™iÚAÎoÿtiÚ3
 = 
pos™iÚAÎoÿtiÚs
[3];

26 
»adyPos™iÚAÎoÿtiÚ4
 = 
pos™iÚAÎoÿtiÚs
[4];

27 
	}
}

29 
boŞ
 
	gR—dySklPos™iÚAÎoÿtiÚ
::
	$isV®id
() const {

30  
äomPÏy”Num
 > 0;

31 
	}
}

33 
boŞ
 
	gR—dySklPos™iÚAÎoÿtiÚ
::
	$ÿnOv”ride
(cÚ¡ 
R—dySklPos™iÚAÎoÿtiÚ
 &
Ùh”
) const {

35  
	`isV®id
(è&& (!
Ùh”
.isV®id(è|| 
äomPÏy”Num
 < other.fromPlayerNum);

36 
	}
}

	@robot/perception/behaviour/ReadySkillPositionAllocation.hpp

8 #´agm¨
Úû


10 
	~<veùÜ
>

12 şas 
	cR—dySklPos™iÚAÎoÿtiÚ
 {

13 
	mpublic
:

14 
R—dySklPos™iÚAÎoÿtiÚ
();

15 
R—dySklPos™iÚAÎoÿtiÚ
(
äomPÏy”Num
, 
¡d
::
veùÜ
<> 
pos™iÚAÎoÿtiÚs
);

17 
boŞ
 
	$isV®id
() const;

18 
boŞ
 
	$ÿnOv”ride
(cÚ¡ 
R—dySklPos™iÚAÎoÿtiÚ
 &
Ùh”
) const;

20 
äomPÏy”Num
;

22 
»adyPos™iÚAÎoÿtiÚ0
;

23 
»adyPos™iÚAÎoÿtiÚ1
;

24 
»adyPos™iÚAÎoÿtiÚ2
;

25 
»adyPos™iÚAÎoÿtiÚ3
;

26 
»adyPos™iÚAÎoÿtiÚ4
;

28 
‹m¶©e
<
şass
 
Archive
>

29 
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

30 
¬
 & 
äomPÏy”Num
;

31 
¬
 & 
»adyPos™iÚAÎoÿtiÚ0
;

32 
¬
 & 
»adyPos™iÚAÎoÿtiÚ1
;

33 
¬
 & 
»adyPos™iÚAÎoÿtiÚ2
;

34 
¬
 & 
»adyPos™iÚAÎoÿtiÚ3
;

35 
¬
 & 
»adyPos™iÚAÎoÿtiÚ4
;

37 
	}
};

	@robot/perception/behaviour/SafetySkill.cpp

32 
	~"³rû±iÚ/behaviour/SaãtySkl.hµ
"

33 
	~"uts/basic_m©hs.hµ
"

34 
	~"uts/Logg”.hµ
"

36 
	gSaãtySkl
::
	$SaãtySkl
() {

37 
f‹»d_f¤_sum
 = 5.0;

38 
blšk
 = 0;

39 
cÜ_ªguÏr_v–oc™y
 = 0;

40 
§g_ªguÏr_v–oc™y
 = 0;

41 
´ev_ªgËs
[0] = 0;

42 
´ev_ªgËs
[1] = 0;

43 
	`Îog
(
INFO
è<< "SaãtySkÈcÚ¡ruùed" << 
¡d
::
’dl
;

44 
	}
}

46 
	gSaãtySkl
::~
	$SaãtySkl
() {

47 
	`Îog
(
INFO
è<< "SaãtySkÈde¡royed" << 
¡d
::
’dl
;

48 
	}
}

50 
BehaviourReque¡
 
	gSaãtySkl
::
	$w¿pReque¡
(cÚ¡ 
BehaviourReque¡
 &
»que¡
, cÚ¡ 
S’sÜV®ues
 &
s
) {

51 
BehaviourReque¡
 
r
 = 
»que¡
;

52 if(
r
.
aùiÚs
.
body
.
aùiÚTy³
 =ğ
AùiÚCommªd
::
Body
::
MOTION_CALIBRATE
){

53  
r
;

56 
f¤_sum
 = 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

57 + 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

58 + 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

59 + 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rRight
]

60 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

61 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

62 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

63 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rRight
];

64 
f‹»d_f¤_sum
 = f‹»d_f¤_sum + 0.2 * (
f¤_sum
 - filtered_fsr_sum);

65 
blšk
 = !blink;

85 
ªg
[2] = {
	`RAD2DEG
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
]),

86 
	`RAD2DEG
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
])};

89 if(
ªg
[1] < -
FALLEN_ANG
 ||‡ng[0] < -FALLEN_ANG){

90 
r
.
aùiÚs
.
Ëds
.
ËáEye
 = 
AùiÚCommªd
::
	`rgb
(
blšk
, 0);

91 
r
.
aùiÚs
.
Ëds
.
rightEye
 = 
AùiÚCommªd
::
	`rgb
(
blšk
, 0);

92 
r
.
aùiÚs
.
body
 = 
AùiÚCommªd
::
Body
::
GETUP_BACK
;

93 } if(
ªg
[1] > 
FALLEN_ANG
 ||‡ng[0] > FALLEN_ANG){

94 
r
.
aùiÚs
.
Ëds
.
ËáEye
 = 
AùiÚCommªd
::
	`rgb
(
blšk
, 0);

95 
r
.
aùiÚs
.
Ëds
.
rightEye
 = 
AùiÚCommªd
::
	`rgb
(
blšk
, 0);

96 
r
.
aùiÚs
.
body
 = 
AùiÚCommªd
::
Body
::
GETUP_FRONT
;

97 } ià(
	`ABS
(
ªg
[0]è> 
FALLING_ANG
 || ABS(ang[1]) > FALLING_ANG) {

98 
r
.
aùiÚs
.
Ëds
.
ËáEye
 = 
AùiÚCommªd
::
	`rgb
(
blšk
, blink);

99 
r
.
aùiÚs
.
Ëds
.
rightEye
 = 
AùiÚCommªd
::
	`rgb
(
blšk
, blink);

100 
r
.
aùiÚs
.
body
 = 
AùiÚCommªd
::
Body
::
DEAD
;

101 }ià(
f‹»d_f¤_sum
 < 
MIN_STANDING_WEIGHT
) {

102 
r
.
aùiÚs
.
Ëds
.
ËáEye
 = 
AùiÚCommªd
::
	`rgb
(0, 
blšk
);

103 
r
.
aùiÚs
.
Ëds
.
rightEye
 = 
AùiÚCommªd
::
	`rgb
(0, 
blšk
);

104 
r
.
aùiÚs
.
body
 = 
AùiÚCommªd
::
Body
::
REF_PICKUP
;

107  
r
;

108 
	}
}

	@robot/perception/behaviour/SafetySkill.hpp

32 #´agm¨
Úû


35 
	#MIN_STANDING_WEIGHT
 0.55f

	)

36 
	#FALLEN
 9

	)

37 
	#FALLING
 8

	)

38 
	#FALLEN_ANG
 70

	)

39 
	#FALLING_ANG
 50

40 

	)

42 
	#SAGITTAL
 1

	)

43 
	#CORONAL
 0

	)

45 
	~"ty³s/BehaviourReque¡.hµ
"

46 
	~"ty³s/S’sÜV®ues.hµ
"

48 şas 
	cSaãtySkl
 {

49 
	mpublic
:

50 
SaãtySkl
();

51 ~
SaãtySkl
();

52 
BehaviourReque¡
 
w¿pReque¡
(cÚ¡ BehaviourReque¡ &
»que¡
, cÚ¡ 
S’sÜV®ues
 &
s
);

53 
	m´iv©e
:

54 
f‹»d_f¤_sum
;

55 
	mblšk
;

56 
	m§g_ªguÏr_v–oc™y
;

57 
	mcÜ_ªguÏr_v–oc™y
;

58 
	m´ev_ªgËs
[2];

	@robot/perception/behaviour/python/PythonSkill.cpp

1 
	~"PythÚSkl.hµ
"

2 
	~<io¡»am
>

3 
	~<¡dexû±
>

4 
	~<boo¡/»gex.hµ
>

5 
	~<sigÇl.h
>

6 
	~"bÏckbßrd/BÏckbßrd.hµ
"

7 
	~"uts/¥“ch.hµ
"

8 
	~"th»ad/Th»adMªag”.hµ
"

10 
	~<socûr.hµ
>

12 
	#SWIG_as_void±r
(
a
è
cÚ¡_ÿ¡
< * >(
¡©ic_ÿ¡
< cÚ¡ * >×))

	)

15 
š™robÙ
();

17 
usšg
 
Çme¥aû
 
	g¡d
;

18 
usšg
 
Çme¥aû
 
	gboo¡
::
pythÚ
;

22 
	gPythÚSkl
::
	$PythÚSkl
(
BÏckbßrd
 *
bb
è: 
	$Ad­‹r
(
bb
) {

23 
·th
 = 
bÏckbßrd
->
cÚfig
["behaviour.·th" ].
as
<
¡ršg
>().
	`c_¡r
();

24 
behaviourModuËName
 = "behaviour";

26 
behaviour_moduË
 = 
	`objeù
();

27 
behaviour_tick
 = 
	`objeù
();

29 
robÙModuËName
 = "robot";

31 
	`¡¬tInÙify
();

32 
	`¡¬tPythÚ
();

33 
	}
}

35 
	gPythÚSkl
::
	$¡¬tInÙify
() {

36 
šÙify_fd
 = 
	`šÙify_š™
();

37 
wd
;

38 
wd
 = 
	`šÙify_add_w©ch
(
šÙify_fd
, 
·th
,

39 
IN_MODIFY
 | 
IN_ATTRIB
 | 
IN_MOVED_FROM
 | 
IN_MOVED_TO
 | 
IN_DELETE
);

40 ià(
wd
 < 0) {

41 
	`Îog
(
ERROR
è<< "FaedØ¡¬ˆw©chšg dœecÙry: " << 
·th
 << 
’dl
;

43 
wd
 = 
	`šÙify_add_w©ch
(
šÙify_fd
, (
	`¡ršg
(
·th
è+ "/skls").
	`c_¡r
(),

44 
IN_MODIFY
 | 
IN_ATTRIB
 | 
IN_MOVED_FROM
 | 
IN_MOVED_TO
 | 
IN_DELETE
);

45 ià(
wd
 < 0) {

46 
	`Îog
(
ERROR
è<< "FaedØ¡¬ˆw©chšg dœecÙry: " << 
·th
 << 
’dl
;

48 
šÙify_timeout
.
tv_£c
 = 0;

49 
šÙify_timeout
.
tv_u£c
 = 0;

50 
	}
}

52 
	gPythÚSkl
::
	$¡¬tPythÚ
() {

53 
”rÜOccu»d
 = 
çl£
;

56 ià(
	`Py_IsIn™Ÿlized
()) {

57 
	`Py_Fš®ize
();

61 
	`Py_In™Ÿlize
();

64 
Œy
 {

66 
	`š™robÙ
();

69 
maš_moduË
 = 
	`impÜt
("__main__");

70 
sys_moduË
 = 
	`impÜt
("sys");

73 
objeù
 
sys_·th
 = 
sys_moduË
.
	`©Œ
("path");

74 
sys_·th
.
	`©Œ
("­³nd")(
·th
);

77 
objeù
 
exû±iÚs_moduË
 = 
	`impÜt
("exceptions");

78 
pyKeybßrdIÁ”ru±
 = 
exû±iÚs_moduË
.
	`©Œ
("KeyboardInterrupt");

81 
objeù
 
robÙModuË
 = 
	`impÜt
(
robÙModuËName
);

83 } 
	`ÿtch
 (cÚ¡ 
”rÜ_®»ady_£t
 &
ex
) {

84 
	`hªdËPyE¼Ü
(
ex
);

87 
	`Îog
(
ERROR
è<< "PythÚ faedØ¡¬t." << 
¡d
::
’dl
;

88 
¡d
::
cout
 << "PythÚ faedØ¡¬t. Shu‰šg Down." << std::
’dl
;

92 
©‹m±šgShutdown
 = 
Œue
;

98 
Œy
 {

99 
behaviour_moduË
 = 
	`impÜt
(
behaviourModuËName
);

102 
š™Ÿl_moduËs
 = 
exŒaù
<
diù
>(
sys_moduË
.
	`©Œ
("moduËs"))().
	`cİy
();

104 } 
	`ÿtch
 (cÚ¡ 
”rÜ_®»ady_£t
 &
ex
) {

105 
	`hªdËPyE¼Ü
(
ex
);

108 
	`Îog
(
ERROR
è<< "Could‚Ù†ßd moduË " << 
behaviourModuËName


109 << "." << 
¡d
::
’dl
;

111 
¡d
::
cout
 << "Could‚Ù†ßd moduË " << 
behaviourModuËName


112 << ". Shu‰šg Down." << 
¡d
::
’dl
;

114 
©‹m±šgShutdown
 = 
Œue
;

120 
Œy
 {

122 
behaviour_tick
 = 
behaviour_moduË
.
	`©Œ
("tick");

123 } 
	`ÿtch
 (cÚ¡ 
”rÜ_®»ady_£t
 &
ex
) {

124 
	`hªdËPyE¼Ü
(
ex
);

126 
	}
}

128 
	gPythÚSkl
::
	$»lßdPythÚ
()

131 
diù
 
moduËs
 = 
exŒaù
<diù>(
sys_moduË
.
	`©Œ
("modules"));

132 
moduËs
.
	`ş—r
();

133 
moduËs
.
	`upd©e
(
š™Ÿl_moduËs
);

143 
PyObjeù
 *
Ãw_behaviour_moduË
 = 
	`PyImpÜt_R–ßdModuË
(
behaviour_moduË
.
	`±r
());

145 ià(
	`PyE¼_Occu¼ed
()) {

146 
throw
 
	`”rÜ_®»ady_£t
();

149 
behaviour_moduË
 = 
	`objeù
(
hªdË
<>(
Ãw_behaviour_moduË
));

150 
behaviour_tick
 = 
behaviour_moduË
.
	`©Œ
("tick");

151 
	}
}

154 
	gPythÚSkl
::~
	$PythÚSkl
() {

155 
	`Py_Fš®ize
();

156 
	}
}

158 
BehaviourReque¡
 
	gPythÚSkl
::
	$execu‹
() {

159 
BehaviourReque¡
 
»q
;

160 
Œy
 {

161 
boŞ
 
»lßdN“ded
 = 
	`šÙify_Check
();

162 ià(
»lßdN“ded
 || 
”rÜOccu»d
) {

163 
	`»lßdPythÚ
();

164 
”rÜOccu»d
 = 
çl£
;

165 } ià(! 
”rÜOccu»d
) {

166 
objeù
 
	`bb
(*
bÏckbßrd
);

167 
objeù
 
py_br
 = 
	`behaviour_tick
(
bb
);

168 
»q
 = 
exŒaù
<
BehaviourReque¡
>(
py_br
);

170 
	`doE¼ÜSnû
(
»q
);

172 } 
	`ÿtch
 (cÚ¡ 
”rÜ_®»ady_£t
 &
ex
) {

173 
	`hªdËPyE¼Ü
(
ex
);

174 
	`doE¼ÜSnû
(
»q
);

175 } 
	`ÿtch
 (cÚ¡ 
¡d
::
exû±iÚ
& 
ex
) {

180 
	`Îog
(
SILENT
è<< "Caughˆwd PythÚSkÈexecu‹(èexû±iÚ." << 
¡d
::
’dl
;

181 
throw
 
ex
;

184  
»q
;

185 
	}
}

187 
	gPythÚSkl
::
	$doE¼ÜSnû
(
BehaviourReque¡
 &
»q
)

189 
timev®
 
Ï¡Said
 = {0, 0};

191 
timev®
 
now
, 
diff
;

192 
	`g‘timeofday
(&
now
, 
NULL
);

193 
	`tim”sub
(&
now
, &
Ï¡Said
, &
diff
);

195 ià(
diff
.
tv_£c
 > 10) {

196 
Ï¡Said
 = 
now
;

197 
	`SAY
("Pythonƒrror");

200 
»q
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
STAND
;

201 
»q
.
aùiÚs
.
Ëds
 = 
	`æashLEDs
();

202 
	}
}

204 
	gAùiÚCommªd
::
LED
 
PythÚSkl
::
	$æashLEDs
() {

206 cÚ¡ 
AùiÚCommªd
::
rgb
 
	`”r
(1, 0, 1);

207 cÚ¡ 
AùiÚCommªd
::
rgb
 
	`off
(0, 0, 0);

209 
timev®
 
tv
;

210 
	`g‘timeofday
(&
tv
, 
NULL
);

212 ià((
tv
.
tv_u£c
 / 250000) % 2) {

213  
AùiÚCommªd
::
	`LED
(
”r
,ƒrr,ƒrr,ƒrr,ƒrr);

215  
AùiÚCommªd
::
	`LED
(
off
, off, off, off, off);

217 
	}
}

219 
boŞ
 
	gPythÚSkl
::
	$šÙify_Check
() {

220 
boŞ
 
»lßdN“ded
 = 
çl£
;

221 
	`FD_ZERO
(&
šÙify_fdss
);

222 
	`FD_SET
(
šÙify_fd
, &
šÙify_fdss
);

223 
£Ì‘
 = 
	`£Ëù
(
šÙify_fd
 + 1, &
šÙify_fdss
, 
NULL
, NULL, &
šÙify_timeout
);

224 
i
, 
Ën
;

225 ià(
£Ì‘
 < 0) {

226 
cout
 << "select on inotify fd failed";

227 } ià(
£Ì‘
 && 
	`FD_ISSET
(
šÙify_fd
, &
šÙify_fdss
)) {

229 
i
 = 0;

230 
Ën
 = 
	`»ad
(
šÙify_fd
, 
šÙify_buf
, 
INBUF_LEN
);

231 ià(
Ën
 < 0) {

232 
cout
 << "»ad oÀšÙify fd faed" << 
’dl
;

233 } ià(
Ën
) {

234 
i
 < 
Ën
) {

235 
šÙify_ev’t
 *
ev’t
;

236 
ev’t
 = (
šÙify_ev’t
 *è&
šÙify_buf
[
i
];

237 ià(
ev’t
->
Ën
) {

245 
cout
 << "D‘eùed chªgš " << 
ev’t
->
Çme
 << 
’dl
;

246 
»lßdN“ded
 = 
Œue
;

250 
i
 +ğ(
šÙify_ev’t
è+ 
ev’t
->
Ën
;

254  
»lßdN“ded
;

255 
	}
}

257 
	gPythÚSkl
::
	$hªdËPyE¼Ü
(cÚ¡ 
”rÜ_®»ady_£t
 &
ex
) {

258 
PyObjeù
 *
pyExû±iÚ
 = 
	`PyE¼_Occu¼ed
();

259 ià(
pyExû±iÚ
 !ğ
NULL
) {

260 ià(
	`PyE¼_Giv’Exû±iÚM©ches
(
pyExû±iÚ
, 
pyKeybßrdIÁ”ru±
.
	`±r
())) {

261 
	`hªdËSigÇls
(
SIGINT
, 
NULL
, NULL);

263 
”rÜOccu»d
 = 
Œue
;

265 
	`PyE¼_Pršt
();

266 ià(
	`Py_FlushLše
()) {

267 
	`PyE¼_CË¬
();

274 
throw
 
ex
;

276 
	}
}

278 
PythÚSkl
 *
	gPythÚSkl
::
	$g‘In¡ªû
(
BÏckbßrd
 *
bÏckbßrd
) {

279 ià(
PythÚSkl
::
š¡ªû
 =ğ
NULL
) {

280 
PythÚSkl
::
š¡ªû
 = 
Ãw
 
	`PythÚSkl
(
bÏckbßrd
);

282  
š¡ªû
;

283 
	}
}

285 
PythÚSkl
* 
	gPythÚSkl
::
š¡ªû
 = 
NULL
;

	@robot/perception/behaviour/python/PythonSkill.hpp

1 #´agm¨
Úû


3 
	~<PythÚ.h
>

4 
	~<boo¡/pythÚ.hµ
>

5 
	~<sys/šÙify.h
>

6 
	~<bÏckbßrd/Ad­‹r.hµ
>

7 
	~<ty³s/BehaviourReque¡.hµ
>

8 
	~<uts/Tim”.hµ
>

11 
şass
 
	gBÏckbßrd
;

13 
	#INBUF_LEN
 32 * ((
šÙify_ev’t
è+ 16)

	)

15 şas 
	cPythÚSkl
 : 
Ad­‹r
 {

16 
public
:

17 
PythÚSkl
* 
g‘In¡ªû
(
BÏckbßrd
 *
bÏckbßrd
);

18 
PythÚSkl
(
BÏckbßrd
 *
bÏckbßrd
);

19 ~
PythÚSkl
();

22 
BehaviourReque¡
 
execu‹
();

24 
	m´iv©e
:

26 
PythÚSkl
 *
š¡ªû
;

27 
	mšÙify_fd
;

28 
	mšÙify_buf
[
INBUF_LEN
];

29 
fd_£t
 
	mšÙify_fdss
;

30 
timev®
 
	mšÙify_timeout
;

31 cÚ¡ *
	m·th
;

34 cÚ¡ * 
	mbehaviourModuËName
;

35 cÚ¡ * 
	mrobÙModuËName
;

38 
boŞ
 
	m”rÜOccu»d
;

41 
	mboo¡
::
pythÚ
::
objeù
 
maš_moduË
;

42 
	mboo¡
::
pythÚ
::
objeù
 
sys_moduË
;

44 
	mboo¡
::
pythÚ
::
objeù
 
š™Ÿl_moduËs
;

45 
	mboo¡
::
pythÚ
::
objeù
 
behaviour_moduË
;

46 
	mboo¡
::
pythÚ
::
objeù
 
behaviour_tick
;

47 
	mboo¡
::
pythÚ
::
objeù
 
pyKeybßrdIÁ”ru±
;

50 
¡¬tInÙify
();

52 
¡¬tPythÚ
();

54 
»lßdPythÚ
();

56 
doE¼ÜSnû
(
BehaviourReque¡
 &
»q
);

58 
hªdËPyE¼Ü
(cÚ¡ 
boo¡
::
pythÚ
::
”rÜ_®»ady_£t
 &
ex
);

60 
boŞ
 
šÙify_Check
();

62 
	mAùiÚCommªd
::
LED
 
æashLEDs
();

	@robot/perception/behaviour/python/RegisterConverters.cpp

1 
	~<boo¡/pythÚ.hµ
>

3 
	~<gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
>

5 
	~<ty³s/JoštV®ues.hµ
>

6 
	~<ty³s/S’sÜV®ues.hµ
>

8 
	~"cÚv”‹rs/¬¿y_cÚv.hµ
"

9 
	~"cÚv”‹rs/Eig’M33f_cÚv.hµ
"

10 
	~"cÚv”‹rs/Pošt_cÚv.hµ
"

12 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

13 
	~"ty³s/SPLSnd¬dMes§ge.hµ
"

14 
	~"ty³s/Brßdÿ¡D©a.hµ
"

16 
	~"uts/SPLDefs.hµ
"

19 
	#REG_ARRAY_TYPE
(
ty³
, 
size
) \

20 
boo¡
::
pythÚ
::
to_pythÚ_cÚv”‹r
<
ty³
[
size
],
¬¿y_to_pythÚ
<type,size> >();\

21 
¬¿y_to_pythÚ
<
ty³
, 
size
>::
	`»ady
()

	)

23 
	$»gi¡”_pythÚ_cÚv”‹rs
()

27 
	`REG_ARRAY_TYPE
(, 
S’sÜs
::
NUMBER_OF_SENSORS
);

28 
	`REG_ARRAY_TYPE
(, 
SÚ¬
::
NUMBER_OF_READINGS
);

29 
	`REG_ARRAY_TYPE
(, 
Jošts
::
NUMBER_OF_JOINTS
);

32 
	`REG_ARRAY_TYPE
(
PÏy”Info
, 
MAX_NUM_PLAYERS
);

33 
	`REG_ARRAY_TYPE
(
T—mInfo
 , 2);

36 
	`REG_ARRAY_TYPE
(
boŞ
, 
ROBOTS_PER_TEAM
);

37 
	`REG_ARRAY_TYPE
(
SPLSnd¬dMes§ge
, 
ROBOTS_PER_TEAM
);

38 
	`REG_ARRAY_TYPE
(
Brßdÿ¡D©a
, 
ROBOTS_PER_TEAM
);

39 
	`REG_ARRAY_TYPE
(
time_t
, 
ROBOTS_PER_TEAM
);

41 
	`REG_ARRAY_TYPE
(, 3);

42 
	`REG_ARRAY_TYPE
(, 2);

44 
boo¡
::
pythÚ
::
to_pythÚ_cÚv”‹r
<

45 
Pošt
,

46 
Pošt_to_pythÚ
>();

48 
boo¡
::
pythÚ
::
to_pythÚ_cÚv”‹r
<

49 
PoštF
,

50 
PoštF_to_pythÚ
>();

52 
boo¡
::
pythÚ
::
to_pythÚ_cÚv”‹r
<

53 
Eig’
::
M©rix
<, 3, 3>,

54 
Eig’M33f_to_pythÚ
>();

55 
	}
}

	@robot/perception/behaviour/python/RegisterConverters.hpp

1 #´agm¨
Úû


3 
»gi¡”_pythÚ_cÚv”‹rs
();

	@robot/perception/behaviour/python/RobotModule.cpp

1 
	~<boo¡/pythÚ.hµ
>

2 
	~<boo¡/pythÚ/su™e/šdexšg/veùÜ_šdexšg_su™e.hµ
>

4 
	~<veùÜ
>

6 
	~<bÏckbßrd/BÏckbßrd.hµ
>

8 
	~<gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
>

10 
	~<ty³s/AbsCoÜd.hµ
>

11 
	~<ty³s/AùiÚCommªd.hµ
>

12 
	~<ty³s/B®lInfo.hµ
>

13 
	~<ty³s/BBox.hµ
>

14 
	~<ty³s/BehaviourReque¡.hµ
>

15 
	~<ty³s/BehaviourSh¬edD©a.hµ
>

16 
	~<ty³s/JoštV®ues.hµ
>

17 
	~<ty³s/Po¡Info.hµ
>

18 
	~<ty³s/RobÙInfo.hµ
>

19 
	~<ty³s/RobÙOb¡aşe.hµ
>

20 
	~<ty³s/RRCoÜd.hµ
>

21 
	~<ty³s/XYZ_CoÜd.hµ
>

22 
	~<ty³s/S’sÜV®ues.hµ
>

23 
	~<ty³s/T—mB®lInfo.hµ
>

24 
	~<ty³s/FoÙInfo.hµ
>

26 
	~<uts/body.hµ
>

27 
	~<uts/¥“ch.hµ
>

28 
	~<uts/SPLDefs.hµ
>

30 
	~"Regi¡”CÚv”‹rs.hµ
"

32 
usšg
 
Çme¥aû
 
	gboo¡
::
pythÚ
;

34 cÚ¡ (
	tRRCoÜd
 ::* 
	t¼_g‘_v_cÚ¡_ty³
)() const;

35 cÚ¡ (
	tAbsCoÜd
::*
	tabs_g‘_v_cÚ¡_ty³
)() const;

37 
	$py_§y
(cÚ¡ 
¡d
::
¡ršg
 &
‹xt
è{ 
	`SAY
Ñext); 
	}
}

39 
	$BOOST_PYTHON_MODULE
(
robÙ
)

41 
	`»gi¡”_pythÚ_cÚv”‹rs
();

43 
	~"w¿µ”s/AbsCoÜd_w¿p.ıp
"

44 
	~"w¿µ”s/AùiÚCommªd_w¿p.ıp
"

45 
	~"w¿µ”s/B®lInfo_w¿p.ıp
"

46 
	~"w¿µ”s/BBox_w¿p.ıp
"

47 
	~"w¿µ”s/BehaviourBÏckbßrd_w¿p.ıp
"

48 
	~"w¿µ”s/BehaviourReque¡_w¿p.ıp
"

49 
	~"w¿µ”s/BehaviourSh¬edD©a_w¿p.ıp
"

50 
	~"w¿µ”s/BÏckbßrd_w¿p.ıp
"

51 
	~"w¿µ”s/body_w¿p.ıp
"

52 
	~"w¿µ”s/Brßdÿ¡D©a_w¿p.ıp
"

53 
	~"w¿µ”s/GameCÚŒŞËr_w¿p.ıp
"

54 
	~"w¿µ”s/GameCÚŒŞËrBÏckbßrd_w¿p.ıp
"

55 
	~"w¿µ”s/Kšem©icsBÏckbßrd_w¿p.ıp
"

56 
	~"w¿µ”s/JoštV®ues_w¿p.ıp
"

57 
	~"w¿µ”s/Loÿli§tiÚBÏckbßrd_w¿p.ıp
"

58 
	~"w¿µ”s/MÙiÚBÏckbßrd_w¿p.ıp
"

59 
	~"w¿µ”s/Po¡Info_w¿p.ıp
"

60 
	~"w¿µ”s/Reûiv”BÏckbßrd_w¿p.ıp
"

61 
	~"w¿µ”s/RobÙInfo_w¿p.ıp
"

62 
	~"w¿µ”s/RobÙOb¡aşe_w¿p.ıp
"

63 
	~"w¿µ”s/RRCoÜd_w¿p.ıp
"

64 
	~"w¿µ”s/XYZ_CoÜd_w¿p.ıp
"

65 
	~"w¿µ”s/§y_w¿p.ıp
"

66 
	~"w¿µ”s/S’sÜV®ues_w¿p.ıp
"

67 
	~"w¿µ”s/SPLDefs_w¿p.ıp
"

68 
	~"w¿µ”s/SPLSnd¬dMes§ge_w¿p.ıp
"

69 
	~"w¿µ”s/VisiÚDefs_w¿p.ıp
"

70 
	~"w¿µ”s/veùÜ_w¿p.ıp
"

71 
	~"w¿µ”s/VisiÚBÏckbßrd_w¿p.ıp
"

72 
	~"w¿µ”s/T—mB®lInfo_w¿p.ıp
"

73 
	~"w¿µ”s/R—dySklPos™iÚAÎoÿtiÚ_w¿p.ıp
"

75 
	}
}

	@robot/perception/behaviour/python/converters/EigenM33f_conv.hpp

1 #´agm¨
Úû


3 
	~<boo¡/pythÚ.hµ
>

4 
	~<boo¡/pythÚ/»fcouÁ.hµ
>

6 
	~<Eig’/Eig’
>

8 
	sEig’M33f_to_pythÚ


10 
PyObjeù
* 
cÚv”t
(cÚ¡ 
Eig’
::
M©rix
<, 3, 3> &
m
)

13 
	mboo¡
::
pythÚ
::
šüef
(

14 
boo¡
::
pythÚ
::
make_tu¶e
(

15 
boo¡
::
pythÚ
::
make_tu¶e
(
m
(0,0), m(1,0), m(2,0)),

16 
boo¡
::
pythÚ
::
make_tu¶e
(
m
(0,1), m(1,1), m(2,1)),

17 
boo¡
::
pythÚ
::
make_tu¶e
(
m
(0,2), m(1,2), m(2,2))

18 ).
±r
()

	@robot/perception/behaviour/python/converters/Point_conv.hpp

1 #´agm¨
Úû


3 
	~<boo¡/pythÚ.hµ
>

4 
	~<boo¡/pythÚ/»fcouÁ.hµ
>

6 
	~<ty³s/Pošt.hµ
>

8 
	sPošt_to_pythÚ


10 
PyObjeù
 *
cÚv”t
(cÚ¡ 
Pošt
 &
p
)

13 
	mboo¡
::
pythÚ
::
šüef
(

14 
boo¡
::
pythÚ
::
make_tu¶e
(
p
.
x
(),….
y
()).
±r
()

19 
	sPoštF_to_pythÚ


21 
PyObjeù
 *
cÚv”t
(cÚ¡ 
PoštF
 &
p
)

24 
	mboo¡
::
pythÚ
::
šüef
(

25 
boo¡
::
pythÚ
::
make_tu¶e
(
p
.
x
(),….
y
()).
±r
()

	@robot/perception/behaviour/python/converters/Vector_conv.hpp

1 #´agm¨
Úû


3 
	~<veùÜ
>

5 
	~<boo¡/pythÚ.hµ
>

6 
	~<boo¡/pythÚ/»fcouÁ.hµ
>

8 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

9 
	sVeùÜ_T_to_pythÚ


11 
PyObjeù
* 
cÚv”t
(cÚ¡ 
¡d
::
veùÜ
<
T
> &
v
)

14 
boo¡
::
pythÚ
::
šüef
(

15 
şass_
<
¡d
::
veùÜ
<
X
> >("XVec")

16 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
X
> >())

	@robot/perception/behaviour/python/converters/array_conv.hpp

1 #´agm¨
Úû


3 
	~<boo¡/pythÚ.hµ
>

4 
	~<boo¡/pythÚ/»fcouÁ.hµ
>

7 
	~<¡ruùmemb”.h
>

9 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

10 
	s¬¿y_to_pythÚ


12 
PyObjeù
 *
cÚv”t
(
T
 
p
[
n
])

14 
¬¿y_w¿p
 *
	maw
 = 
PyObjeù_New
×¼ay_w¿p, &
¬¿y_w¿pTy³
);

15 
	maw
->
	mp
 = 
p
;

17  
PyObjeù_In™
((
PyObjeù
 *)
aw
, &
¬¿y_w¿pTy³
);

20 
»ady
()

22  
PyTy³_R—dy
(&
¬¿y_w¿pTy³
);

25 
	m´iv©e
:

26 
	s¬¿y_w¿p
 {

27 
PyObjeù_HEAD


30 
T
 *
p
;

33 
PyM­pšgM‘hods
 
	m¬¿y_w¿p_m­pšg
;

34 
PyTy³Objeù
 
	m¬¿y_w¿pTy³
;

37 
¬¿y_w¿p_d—Îoc
(
¬¿y_w¿p
 *
£lf
);

39 
PyObjeù
 *

40 
¬¿y_w¿p_Ãw
(
PyTy³Objeù
 *
ty³
, 
PyObjeù
 *
¬gs
, PyObjeù *
kwds
);

43 
¬¿y_w¿p_š™
(
¬¿y_w¿p
 *
£lf
, 
PyObjeù
 *
¬gs
, PyObjeù *
kwds
);

45 
PyObjeù
 *

46 
¬¿y_w¿p___g‘™em__
(
¬¿y_w¿p
* 
£lf
, 
PyObjeù
 *
™em
);

48 
Py_ssize_t


49 
¬¿y_w¿p___Ën__
(
¬¿y_w¿p
* 
£lf
);

52 
	~"¬¿y_cÚv.tcc
"

	@robot/perception/behaviour/python/converters/array_conv.tcc

1 #´agm¨
Úû


3 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

5 
	g¬¿y_to_pythÚ
<
	gT
, 
	gn
>::
¬¿y_w¿p_d—Îoc
(

6 
¬¿y_to_pythÚ
<
T
, 
n
>::
¬¿y_w¿p
 *
£lf
)

9 
£lf
->
ob_ty³
->
_ä“
((
PyObjeù
 *)self);

12 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

13 
PyObjeù
 *

14 
	g¬¿y_to_pythÚ
<
	gT
, 
	gn
>::
	$¬¿y_w¿p_Ãw
(

15 
PyTy³Objeù
 *
ty³
,

16 
PyObjeù
 *
¬gs
,

17 
PyObjeù
 *
kwds
)

20 
¬¿y_to_pythÚ
 *
£lf
;

21 
£lf
 = (
¬¿y_to_pythÚ
 *)
ty³
->
	`_®loc
(type, 0);

22  (
PyObjeù
 *)
£lf
;

23 
	}
}

25 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

27 
	g¬¿y_to_pythÚ
<
	gT
, 
	gn
>::
¬¿y_w¿p_š™
(

28 
¬¿y_to_pythÚ
<
T
, 
n
>::
¬¿y_w¿p
 *
£lf
,

29 
PyObjeù
 *
¬gs
,

30 
PyObjeù
 *
kwds
)

36 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

37 
PyObjeù
 *

38 
	g¬¿y_to_pythÚ
<
	gT
, 
	gn
>::
¬¿y_w¿p___g‘™em__
(

39 
¬¿y_to_pythÚ
<
T
, 
n
>::
¬¿y_w¿p
 *
£lf
,

40 
PyObjeù
 *
™em
)

43 ià(! 
PyIÁ_Check
(
™em
)) {

44 
PyObjeù
 *
	gpy_şass
 = 
PyObjeù_G‘A‰rSŒšg
(
™em
, "__class__");

45 
PyObjeù
 *
	gpy_Çme
 = 
PyObjeù_G‘A‰rSŒšg
(
py_şass
, "__name__");

48 
	g¡d
::
¡ršg
 
”r¡r
 = "array indicies must be integers,‚ot ";

49 
	g”r¡r
 +ğ
PySŒšg_AsSŒšg
(
py_Çme
);

51 
PyE¼_S‘SŒšg
(
PyExc_Ty³E¼Ü
, 
”r¡r
.
c_¡r
());

53  
	gNULL
;

56 
	gi
 = 
PyIÁ_AsLÚg
(
™em
);

59 ià(! (0 <ğ()
i
 && ()˜< 
n
)) {

60 
PyE¼_S‘SŒšg
(
PyExc_V®ueE¼Ü
, "array index out of„ange");

61  
	gNULL
;

67 
	gboo¡
::
pythÚ
::
objeù
 
»t
(
£lf
->
p
[
i
]);

68 
	gboo¡
::
pythÚ
::
šüef
(
»t
.
±r
());

70  
	g»t
.
±r
();

73 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

74 
Py_ssize_t


75 
	g¬¿y_to_pythÚ
<
	gT
, 
	gn
>::
¬¿y_w¿p___Ën__
(

76 
¬¿y_to_pythÚ
<
T
, 
n
>::
¬¿y_w¿p
 *
£lf
)

78  
n
;

81 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

82 
PyM­pšgM‘hods
 
	g¬¿y_to_pythÚ
<
	gT
, 
	gn
>::
¬¿y_w¿p_m­pšg
 = {

83 (
Ënfunc
 )
¬¿y_w¿p___Ën__
,

84 (
bš¬yfunc
)
¬¿y_w¿p___g‘™em__
,

85 
NULL


88 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gn
>

89 
PyTy³Objeù
 
	g¬¿y_to_pythÚ
<
	gT
, 
	gn
>::
¬¿y_w¿pTy³
 = {

90 
PyObjeù_HEAD_INIT
(
NULL
)

93 (
¬¿y_w¿p
),

95 (
de¡ruùÜ
)
¬¿y_w¿p_d—Îoc
,

103 &
¬¿y_w¿p_m­pšg
,

110 
Py_TPFLAGS_DEFAULT
,

126 (
š™´oc
)
¬¿y_w¿p_š™
,

128 
¬¿y_w¿p_Ãw
,

	@robot/perception/behaviour/python/wrappers/AbsCoord_wrap.cpp

1 
	gşass_
<
	gAbsCoÜd
>("AbsCoord").

2 
def
(
š™
<, , >()).

3 
add_´İ”ty
("x" , 
abs_g‘_v_cÚ¡_ty³
(&
AbsCoÜd
::
x
 )).

4 
add_´İ”ty
("y" , 
abs_g‘_v_cÚ¡_ty³
(&
AbsCoÜd
::
y
 )).

5 
add_´İ”ty
("th‘a" , 
abs_g‘_v_cÚ¡_ty³
(&
AbsCoÜd
::
th‘a
 )).

6 
def_»adÚly
("weight" , &
AbsCoÜd
::
weight
 ).

7 
add_´İ”ty
("v¬" , 
make_g‘‹r
(&
AbsCoÜd
::
v¬
, 
»tuº_v®ue_pŞicy
<
»tuº_by_v®ue
>()));

	@robot/perception/behaviour/python/wrappers/ActionCommand_wrap.cpp

1 
	gşass_
<
	gAùiÚCommªd
::
Body
>("BodyCommand")

2 .
def
(
š™
<
AùiÚCommªd
::
Body
::
AùiÚTy³
,

6 , 
AùiÚCommªd
::
Body
::
FoÙ
,

7 
boŞ
,

8 
boŞ


11 .
def_»adwr™e
("aùiÚTy³" , &
AùiÚCommªd
::
Body
::
aùiÚTy³
 )

12 .
def_»adwr™e
("fÜw¬d" , &
AùiÚCommªd
::
Body
::
fÜw¬d
 )

13 .
def_»adwr™e
("Ëá" , &
AùiÚCommªd
::
Body
::
Ëá
 )

14 .
def_»adwr™e
("tuº" , &
AùiÚCommªd
::
Body
::
tuº
 )

15 .
def_»adwr™e
("pow”" , &
AùiÚCommªd
::
Body
::
pow”
 )

16 .
def_»adwr™e
("b’d" , &
AùiÚCommªd
::
Body
::
b’d
 )

17 .
def_»adwr™e
("¥“d" , &
AùiÚCommªd
::
Body
::
¥“d
 )

18 .
def_»adwr™e
("kickDœeùiÚ" , &
AùiÚCommªd
::
Body
::
kickDœeùiÚ
)

19 .
def_»adwr™e
("foÙ" , &
AùiÚCommªd
::
Body
::
foÙ
 )

20 .
def_»adwr™e
("isFa¡" , &
AùiÚCommªd
::
Body
::
isFa¡
 )

21 .
def_»adwr™e
("mi§ligÃdKick", &
AùiÚCommªd
::
Body
::
mi§ligÃdKick
);

23 
	gşass_
<
	gAùiÚCommªd
::
H—d
>("HeadCommand")

24 .
def
(
š™
<, , 
boŞ
, , >() )

25 .
def_»adwr™e
("yaw" , &
AùiÚCommªd
::
H—d
::
yaw
 )

26 .
def_»adwr™e
("p™ch" , &
AùiÚCommªd
::
H—d
::
p™ch
 )

27 .
def_»adwr™e
("isR–©ive" , &
AùiÚCommªd
::
H—d
::
isR–©ive
 )

28 .
def_»adwr™e
("yawS³ed" , &
AùiÚCommªd
::
H—d
::
yawS³ed
 )

29 .
def_»adwr™e
("p™chS³ed" , &
AùiÚCommªd
::
H—d
::
p™chS³ed
 );

31 
	gşass_
<
	gAùiÚCommªd
::
rgb
>("rgb")

32 .
def
(
š™
<
boŞ
, bool, bool>() )

33 .
def_»adwr™e
("»d" , &
AùiÚCommªd
::
rgb
::
»d
 )

34 .
def_»adwr™e
("g»’" , &
AùiÚCommªd
::
rgb
::
g»’
 )

35 .
def_»adwr™e
("blue" , &
AùiÚCommªd
::
rgb
::
blue
 );

37 
	gşass_
<
	gAùiÚCommªd
::
LED
>("LEDCommand")

38 .
def
(
š™
<
AùiÚCommªd
::
rgb
,

39 
AùiÚCommªd
::
rgb
,

40 
AùiÚCommªd
::
rgb
,

41 
AùiÚCommªd
::
rgb
,

42 
AùiÚCommªd
::
rgb


45 .
def_»adwr™e
("ËáE¬" , &
AùiÚCommªd
::
LED
::
ËáE¬
 )

46 .
def_»adwr™e
("rightE¬" , &
AùiÚCommªd
::
LED
::
rightE¬
 )

47 .
def_»adwr™e
("ËáEye" , &
AùiÚCommªd
::
LED
::
ËáEye
 )

48 .
def_»adwr™e
("rightEye" , &
AùiÚCommªd
::
LED
::
rightEye
 )

49 .
def_»adwr™e
("che¡Bu‰Ú" , &
AùiÚCommªd
::
LED
::
che¡Bu‰Ú
 )

50 .
def_»adwr™e
("ËáFoÙ" , &
AùiÚCommªd
::
LED
::
ËáFoÙ
 )

51 .
def_»adwr™e
("rightFoÙ" , &
AùiÚCommªd
::
LED
::
rightFoÙ
 );

53 
	gşass_
<
	gAùiÚCommªd
::
AÎ
>("All")

54 .
def
(
š™
<
AùiÚCommªd
::
H—d
, AùiÚCommªd::
Body
, AùiÚCommªd::
LED
, >())

56 .
def_»adwr™e
("h—d" , &
AùiÚCommªd
::
AÎ
::
h—d
 )

57 .
def_»adwr™e
("body" , &
AùiÚCommªd
::
AÎ
::
body
 )

58 .
def_»adwr™e
("Ëds" , &
AùiÚCommªd
::
AÎ
::
Ëds
 )

59 .
def_»adwr™e
("sÚ¬" , &
AùiÚCommªd
::
AÎ
::
sÚ¬
 );

61 
	g’um_
<
	gAùiÚCommªd
::
Body
::
AùiÚTy³
>("ActionType")

62 .
v®ue
("NONE" , 
AùiÚCommªd
::
Body
::
NONE
 )

63 .
v®ue
("STAND" , 
AùiÚCommªd
::
Body
::
STAND
 )

64 .
v®ue
("WALK" , 
AùiÚCommªd
::
Body
::
WALK
 )

65 .
v®ue
("DRIBBLE" , 
AùiÚCommªd
::
Body
::
DRIBBLE
 )

66 .
v®ue
("GETUP_FRONT" , 
AùiÚCommªd
::
Body
::
GETUP_FRONT
 )

67 .
v®ue
("GETUP_BACK" , 
AùiÚCommªd
::
Body
::
GETUP_BACK
 )

68 .
v®ue
("KICK" , 
AùiÚCommªd
::
Body
::
KICK
 )

69 .
v®ue
("INITIAL" , 
AùiÚCommªd
::
Body
::
INITIAL
 )

70 .
v®ue
("DEAD" , 
AùiÚCommªd
::
Body
::
DEAD
 )

71 .
v®ue
("REF_PICKUP" , 
AùiÚCommªd
::
Body
::
REF_PICKUP
 )

72 .
v®ue
("OPEN_FEET" , 
AùiÚCommªd
::
Body
::
OPEN_FEET
 )

73 .
v®ue
("THROW_IN" , 
AùiÚCommªd
::
Body
::
THROW_IN
 )

74 .
v®ue
("GOALIE_SIT" , 
AùiÚCommªd
::
Body
::
GOALIE_SIT
 )

75 .
v®ue
("GOALIE_DIVE_RIGHT" , 
AùiÚCommªd
::
Body
::
GOALIE_DIVE_RIGHT
 )

76 .
v®ue
("GOALIE_DIVE_LEFT" , 
AùiÚCommªd
::
Body
::
GOALIE_DIVE_LEFT
 )

77 .
v®ue
("GOALIE_CENTRE" , 
AùiÚCommªd
::
Body
::
GOALIE_CENTRE
 )

78 .
v®ue
("GOALIE_UNCENTRE" , 
AùiÚCommªd
::
Body
::
GOALIE_UNCENTRE
 )

79 .
v®ue
("GOALIE_STAND" , 
AùiÚCommªd
::
Body
::
GOALIE_STAND
 )

80 .
v®ue
("GOALIE_INITIAL" , 
AùiÚCommªd
::
Body
::
GOALIE_INITIAL
 )

81 .
v®ue
("GOALIE_AFTERSIT_INITIAL" , 
AùiÚCommªd
::
Body
::
GOALIE_AFTERSIT_INITIAL
 )

82 .
v®ue
("GOALIE_PICK_UP" , 
AùiÚCommªd
::
Body
::
GOALIE_PICK_UP
 )

83 .
v®ue
("MOTION_CALIBRATE" , 
AùiÚCommªd
::
Body
::
MOTION_CALIBRATE
 )

84 .
v®ue
("STAND_STRAIGHT" , 
AùiÚCommªd
::
Body
::
STAND_STRAIGHT
 )

85 .
v®ue
("DEFENDER_CENTRE" , 
AùiÚCommªd
::
Body
::
DEFENDER_CENTRE
 )

86 .
v®ue
("LINE_UP" , 
AùiÚCommªd
::
Body
::
LINE_UP
 )

87 .
v®ue
("NUM_ACTION_TYPES" , 
AùiÚCommªd
::
Body
::
NUM_ACTION_TYPES
 );

89 
	g’um_
<
	gAùiÚCommªd
::
Body
::
FoÙ
>("Foot")

90 .
v®ue
("LEFT" , 
AùiÚCommªd
::
Body
::
LEFT
 )

91 .
v®ue
("RIGHT" , 
AùiÚCommªd
::
Body
::
RIGHT
 );

	@robot/perception/behaviour/python/wrappers/BBox_wrap.cpp

1 
	gşass_
<
	gBBox
>("BBox")

2 .
add_´İ”ty
("a" , 
make_g‘‹r
(&
BBox
::
a
, 
»tuº_v®ue_pŞicy
<
»tuº_by_v®ue
>()))

3 .
add_´İ”ty
("b" , 
make_g‘‹r
(&
BBox
::
b
, 
»tuº_v®ue_pŞicy
<
»tuº_by_v®ue
>()))

4 .
def_»adÚly
("width" , &
BBox
::
width
 )

5 .
def_»adÚly
("height" , &
BBox
::
height
 )

6 .
def
 ("w™hš" , &
BBox
::
w™hš
 )

7 .
def
 ("v®idIndex" , &
BBox
::
v®idIndex
);

	@robot/perception/behaviour/python/wrappers/BallInfo_wrap.cpp

1 
	gşass_
<
	gB®lInfo
>("BallInfo")

2 .
def_»adÚly
("¼", &
B®lInfo
::
¼
)

3 .
def_»adÚly
("¿dius", &
B®lInfo
::
¿dius
)

4 .
add_´İ”ty
("imageCoÜds", 
make_g‘‹r
(&
B®lInfo
::
imageCoÜds
, 
»tuº_v®ue_pŞicy
<
»tuº_by_v®ue
>()))

5 .
add_´İ”ty
("ÃckR–©ive", &
B®lInfo
::
ÃckR–©ive
)

6 .
def_»adÚly
("visiÚV¬", &
B®lInfo
::
visiÚV¬
)

7 .
def_»adÚly
("tİCam”a", &
B®lInfo
::
tİCam”a
);

9 
	gşass_
<
	gB®lHšt
>("BallHint")

10 .
def_»adÚly
("ty³" , &
B®lHšt
::
ty³
 );

12 
	g’um_
<
	gB®lHšt
::
Ty³
>("BallHintType")

13 .
v®ue
("bLeá" , 
B®lHšt
::
bLeá
 )

14 .
v®ue
("bRight" , 
B®lHšt
::
bRight
 )

15 .
v®ue
("bHidd’" , 
B®lHšt
::
bHidd’
 )

16 .
v®ue
("bNÚe" , 
B®lHšt
::
bNÚe
 );

	@robot/perception/behaviour/python/wrappers/BehaviourBlackboard_wrap.cpp

1 
	gşass_
<
	gBehaviourBÏckbßrd
>("BehaviourBlackboard")

2 .
def_»adÚly
("skl" , &
BehaviourBÏckbßrd
::
skl
)

3 .
def_»adÚly
("behaviourSh¬edD©a", &
BehaviourBÏckbßrd
::
behaviourSh¬edD©a
);

	@robot/perception/behaviour/python/wrappers/BehaviourRequest_wrap.cpp

1 
	gşass_
<
	gBehaviourReque¡
>("BehaviourRequest")

2 .
def_»adwr™e
("aùiÚs", &
BehaviourReque¡
::
aùiÚs
)

3 .
def_»adwr™e
("gßl›A‰ackšg", &
BehaviourReque¡
::
gßl›A‰ackšg
)

4 .
def_»adwr™e
("došgB®lLšeUp", &
BehaviourReque¡
::
došgB®lLšeUp
)

5 .
def_»adwr™e
("isInR—dyMode", &
BehaviourReque¡
::
isInR—dyMode
)

6 .
def_»adwr™e
("timeToR—chB®l", &
BehaviourReque¡
::
timeToR—chB®l
)

7 .
def_»adwr™e
("timeToR—chDeãnd”", &
BehaviourReque¡
::
timeToR—chDeãnd”
)

8 .
def_»adwr™e
("timeToR—chMidf›ld”", &
BehaviourReque¡
::
timeToR—chMidf›ld”
)

9 .
def_»adwr™e
("timeToR—chUpf›ld”", &
BehaviourReque¡
::
timeToR—chUpf›ld”
)

10 .
def_»adwr™e
("cu¼’tRŞe", &
BehaviourReque¡
::
cu¼’tRŞe
)

11 .
def_»adwr™e
("w®kšgToX", &
BehaviourReque¡
::
w®kšgToX
)

12 .
def_»adwr™e
("w®kšgToY", &
BehaviourReque¡
::
w®kšgToY
)

13 .
def_»adwr™e
("shoÙšgToX", &
BehaviourReque¡
::
shoÙšgToX
)

14 .
def_»adwr™e
("shoÙšgToY", &
BehaviourReque¡
::
shoÙšgToY
)

15 .
def_»adwr™e
("»adyPos™iÚAÎoÿtiÚ0", &
BehaviourReque¡
::
»adyPos™iÚAÎoÿtiÚ0
)

16 .
def_»adwr™e
("»adyPos™iÚAÎoÿtiÚ1", &
BehaviourReque¡
::
»adyPos™iÚAÎoÿtiÚ1
)

17 .
def_»adwr™e
("»adyPos™iÚAÎoÿtiÚ2", &
BehaviourReque¡
::
»adyPos™iÚAÎoÿtiÚ2
)

18 .
def_»adwr™e
("»adyPos™iÚAÎoÿtiÚ3", &
BehaviourReque¡
::
»adyPos™iÚAÎoÿtiÚ3
)

19 .
def_»adwr™e
("»adyPos™iÚAÎoÿtiÚ4", &
BehaviourReque¡
::
»adyPos™iÚAÎoÿtiÚ4
);

	@robot/perception/behaviour/python/wrappers/BehaviourSharedData_wrap.cpp

1 
	gşass_
<
	gBehaviourSh¬edD©a
>("BehaviourSharedData")

2 .
def_»adÚly
("gßl›A‰ackšg", &
BehaviourSh¬edD©a
::
gßl›A‰ackšg
)

3 .
def_»adÚly
("timeToR—chB®l", &
BehaviourSh¬edD©a
::
timeToR—chB®l
)

4 .
def_»adÚly
("timeToR—chUpf›ld”", &
BehaviourSh¬edD©a
::
timeToR—chUpf›ld”
)

5 .
def_»adÚly
("timeToR—chMidf›ld”", &
BehaviourSh¬edD©a
::
timeToR—chMidf›ld”
)

6 .
def_»adÚly
("timeToR—chDeãnd”", &
BehaviourSh¬edD©a
::
timeToR—chDeãnd”
)

7 .
def_»adÚly
("cu¼’tRŞe", &
BehaviourSh¬edD©a
::
cu¼’tRŞe
)

8 .
def_»adÚly
("došgB®lLšeUp", &
BehaviourSh¬edD©a
::
došgB®lLšeUp
)

9 .
def_»adÚly
("isInR—dyMode", &
BehaviourSh¬edD©a
::
isInR—dyMode
)

10 .
def_»adÚly
("»adyPos™iÚAÎoÿtiÚ", &
BehaviourSh¬edD©a
::
»adyPos™iÚAÎoÿtiÚ
);

	@robot/perception/behaviour/python/wrappers/Blackboard_wrap.cpp

1 
	gşass_
<
	gBÏckbßrd
>("Blackboard")

2 .
def_»adÚly
("mÙiÚ" , &
BÏckbßrd
::
mÙiÚ
 )

3 .
def_»adÚly
("visiÚ" , &
BÏckbßrd
::
visiÚ
 )

4 .
def_»adÚly
("loÿli§tiÚ" , &
BÏckbßrd
::
loÿli§tiÚ
 )

5 .
def_»adÚly
("behaviour" , &
BÏckbßrd
::
behaviour
 )

6 .
def_»adÚly
("gameCÚŒŞËr", &
BÏckbßrd
::
gameCÚŒŞËr
)

7 .
def_»adÚly
("»ûiv”" , &
BÏckbßrd
::
»ûiv”
 )

8 .
def_»adÚly
("kšem©ics" , &
BÏckbßrd
::
kšem©ics
 )

	@robot/perception/behaviour/python/wrappers/BroadcastData_wrap.cpp

1 
	gşass_
<
	gBrßdÿ¡D©a
>("BroadcastData")

2 .
def_»adÚly
("¶ay”Num", &
Brßdÿ¡D©a
::
¶ay”Num
)

3 .
def_»adÚly
("‹am", &
Brßdÿ¡D©a
::
‹am
)

4 .
def_»adÚly
("robÙPos", &
Brßdÿ¡D©a
::
robÙPos
)

5 .
def_»adÚly
("lo¡CouÁ", &
Brßdÿ¡D©a
::
lo¡CouÁ
)

6 .
def_»adÚly
("b®lPos", &
Brßdÿ¡D©a
::
b®lPosAbs
)

7 .
def_»adÚly
("b®lPosRR", &
Brßdÿ¡D©a
::
b®lPosRR
)

8 .
def_»adÚly
("behaviourSh¬edD©a", &
Brßdÿ¡D©a
::
behaviourSh¬edD©a
)

9 .
def_»adÚly
("u±ime", &
Brßdÿ¡D©a
::
u±ime
)

10 .
def_»adÚly
("gameS‹", &
Brßdÿ¡D©a
::
gameS‹
);

	@robot/perception/behaviour/python/wrappers/FootInfo_wrap.cpp

	@robot/perception/behaviour/python/wrappers/GameControllerBlackboard_wrap.cpp

1 
	gşass_
<
	gGameCÚŒŞËrBÏckbßrd
>("GameControllerBlackboard").

2 
def_»adÚly
("cÚÃù" , &
GameCÚŒŞËrBÏckbßrd
::
cÚÃù
 ).

3 
def_»adÚly
("cÚÃùed" , &
GameCÚŒŞËrBÏckbßrd
::
cÚÃùed
 ).

4 
def_»adÚly
("d©a" , &
GameCÚŒŞËrBÏckbßrd
::
d©a
 ).

5 
def_»adÚly
("our_‹am" , &
GameCÚŒŞËrBÏckbßrd
::
our_‹am
 ).

6 
def_»adÚly
("‹am_»d" , &
GameCÚŒŞËrBÏckbßrd
::
‹am_»d
 ).

7 
def_»adÚly
("¶ay”_numb”", &
GameCÚŒŞËrBÏckbßrd
::
¶ay”_numb”
);

	@robot/perception/behaviour/python/wrappers/GameController_wrap.cpp

1 
	gşass_
<
	gRoboCupGameCÚŒŞD©a
>("RoboCupGameControlData")

2 .
def_»adÚly
("h—d”" , &
RoboCupGameCÚŒŞD©a
::
h—d”
 )

3 .
def_»adÚly
("v”siÚ" , &
RoboCupGameCÚŒŞD©a
::
v”siÚ
 )

4 .
def_»adÚly
("¶ay”sP”T—m", &
RoboCupGameCÚŒŞD©a
::
¶ay”sP”T—m
)

5 .
def_»adÚly
("¡©e" , &
RoboCupGameCÚŒŞD©a
::
¡©e
 )

6 .
def_»adÚly
("fœ¡H®f" , &
RoboCupGameCÚŒŞD©a
::
fœ¡H®f
 )

7 .
def_»adÚly
("kickOffT—m" , &
RoboCupGameCÚŒŞD©a
::
kickOffT—m
 )

8 .
def_»adÚly
("£cÚd¬yS‹", &
RoboCupGameCÚŒŞD©a
::
£cÚd¬yS‹
)

9 .
def_»adÚly
("drİInT—m" , &
RoboCupGameCÚŒŞD©a
::
drİInT—m
 )

10 .
def_»adÚly
("drİInTime" , &
RoboCupGameCÚŒŞD©a
::
drİInTime
 )

11 .
def_»adÚly
("£csRemaššg" , &
RoboCupGameCÚŒŞD©a
::
£csRemaššg
 )

12 .
add_´İ”ty
("‹ams" , &
RoboCupGameCÚŒŞD©a
::
‹ams
 );

14 
	gşass_
<
	gPÏy”Info
>("PlayerInfo")

15 .
def_»adÚly
("³ÇÉy" , &
PÏy”Info
::
³ÇÉy
 )

16 .
def_»adÚly
("£csTlUÅ’®i£d" , &
PÏy”Info
::
£csTlUÅ’®i£d
);

18 
	gşass_
<
	gT—mInfo
>("TeamInfo")

19 .
def_»adÚly
("‹amNumb”" , &
T—mInfo
::
‹amNumb”
 )

20 .
def_»adÚly
("scÜe" , &
T—mInfo
::
scÜe
 )

21 .
add_´İ”ty
("¶ay”s" , &
T—mInfo
::
¶ay”s
 );

23 
scİe
().
©Œ
("MAX_NUM_PLAYERS" ) = 
MAX_NUM_PLAYERS
;

24 
scİe
().
©Œ
("TEAM_BLUE" ) = 
TEAM_BLUE
;

25 
scİe
().
©Œ
("TEAM_CYAN" ) = 
TEAM_CYAN
;

26 
scİe
().
©Œ
("TEAM_RED" ) = 
TEAM_RED
;

27 
scİe
().
©Œ
("TEAM_MAGENTA" ) = 
TEAM_MAGENTA
;

28 
scİe
().
©Œ
("STATE_INITIAL" ) = 
STATE_INITIAL
;

29 
scİe
().
©Œ
("STATE_READY" ) = 
STATE_READY
;

30 
scİe
().
©Œ
("STATE_SET" ) = 
STATE_SET
;

31 
scİe
().
©Œ
("STATE_PLAYING" ) = 
STATE_PLAYING
;

32 
scİe
().
©Œ
("STATE_FINISHED" ) = 
STATE_FINISHED
;

33 
scİe
().
©Œ
("STATE_INVALID" ) = 
STATE_INVALID
;

34 
scİe
().
©Œ
("STATE_PENALISED" ) = 
STATE_PENALISED
;

35 
scİe
().
©Œ
("STATE2_NORMAL" ) = 
STATE2_NORMAL
;

36 
scİe
().
©Œ
("STATE2_PENALTYSHOOT" ) = 
STATE2_PENALTYSHOOT
;

37 
scİe
().
©Œ
("STATE2_OVERTIME" ) = 
STATE2_OVERTIME
;

38 
scİe
().
©Œ
("STATE2_TIMEOUT" ) = 
STATE2_TIMEOUT
;

39 
scİe
().
©Œ
("PENALTY_NONE" ) = 
PENALTY_NONE
;

40 
scİe
().
©Œ
("PENALTY_SPL_ILLEGAL_BALL_CONTACT" ) = 
PENALTY_SPL_ILLEGAL_BALL_CONTACT
;

41 
scİe
().
©Œ
("PENALTY_SPL_PLAYER_PUSHING" ) = 
PENALTY_SPL_PLAYER_PUSHING
;

42 
scİe
().
©Œ
("PENALTY_SPL_ILLEGAL_MOTION_IN_SET" ) = 
PENALTY_SPL_ILLEGAL_MOTION_IN_SET
;

43 
scİe
().
©Œ
("PENALTY_SPL_INACTIVE_PLAYER" ) = 
PENALTY_SPL_INACTIVE_PLAYER
;

44 
scİe
().
©Œ
("PENALTY_SPL_ILLEGAL_DEFENDER" ) = 
PENALTY_SPL_ILLEGAL_DEFENDER
;

45 
scİe
().
©Œ
("PENALTY_SPL_LEAVING_THE_FIELD" ) = 
PENALTY_SPL_LEAVING_THE_FIELD
;

46 
scİe
().
©Œ
("PENALTY_SPL_KICK_OFF_GOAL" ) = 
PENALTY_SPL_KICK_OFF_GOAL
;

47 
scİe
().
©Œ
("PENALTY_SPL_REQUEST_FOR_PICKUP" ) = 
PENALTY_SPL_REQUEST_FOR_PICKUP
;

48 
scİe
().
©Œ
("PENALTY_HL_KID_BALL_MANIPULATION" ) = 
PENALTY_HL_KID_BALL_MANIPULATION
;

49 
scİe
().
©Œ
("PENALTY_HL_KID_PHYSICAL_CONTACT" ) = 
PENALTY_HL_KID_PHYSICAL_CONTACT
;

50 
scİe
().
©Œ
("PENALTY_HL_KID_ILLEGAL_ATTACK" ) = 
PENALTY_HL_KID_ILLEGAL_ATTACK
;

51 
scİe
().
©Œ
("PENALTY_HL_KID_ILLEGAL_DEFENSE" ) = 
PENALTY_HL_KID_ILLEGAL_DEFENSE
;

52 
scİe
().
©Œ
("PENALTY_HL_KID_REQUEST_FOR_PICKUP" ) = 
PENALTY_HL_KID_REQUEST_FOR_PICKUP
;

53 
scİe
().
©Œ
("PENALTY_HL_TEEN_BALL_MANIPULATION" ) = 
PENALTY_HL_TEEN_BALL_MANIPULATION
;

54 
scİe
().
©Œ
("PENALTY_HL_TEEN_PHYSICAL_CONTACT" ) = 
PENALTY_HL_TEEN_PHYSICAL_CONTACT
;

55 
scİe
().
©Œ
("PENALTY_HL_TEEN_ILLEGAL_ATTACK" ) = 
PENALTY_HL_TEEN_ILLEGAL_ATTACK
;

56 
scİe
().
©Œ
("PENALTY_HL_TEEN_ILLEGAL_DEFENSE" ) = 
PENALTY_HL_TEEN_ILLEGAL_DEFENSE
;

57 
scİe
().
©Œ
("PENALTY_HL_TEEN_REQUEST_FOR_PICKUP"èğ
PENALTY_HL_TEEN_REQUEST_FOR_PICKUP
;

58 
scİe
().
©Œ
("PENALTY_MANUAL" ) = 
PENALTY_MANUAL
;

	@robot/perception/behaviour/python/wrappers/JointValues_wrap.cpp

1 
	gşass_
<
	gJoštV®ues
>("JointValues")

2 .
add_´İ”ty
("ªgËs" , &
JoštV®ues
::
ªgËs
 )

3 .
add_´İ”ty
("¡ifâes£s" , &
JoštV®ues
::
¡ifâes£s
 )

4 .
add_´İ”ty
("‹m³¿tu»s" , &
JoštV®ues
::
‹m³¿tu»s
);

	@robot/perception/behaviour/python/wrappers/KinematicsBlackboard_wrap.cpp

1 
	gşass_
<
	gKšem©icsBÏckbßrd
>("KinematicsBlackboard")

2 .
def_»adÚly
("sÚ¬F‹»d" , &
Kšem©icsBÏckbßrd
::
sÚ¬F‹»d
 )

	@robot/perception/behaviour/python/wrappers/LocalisationBlackboard_wrap.cpp

1 
	gşass_
<
	gLoÿli§tiÚBÏckbßrd
>("LocalisationBlackboard")

2 .
def_»adÚly
("robÙPos", &
Loÿli§tiÚBÏckbßrd
::
robÙPos
)

3 .
def_»adÚly
("b®lLo¡CouÁ", &
Loÿli§tiÚBÏckbßrd
::
b®lLo¡CouÁ
)

4 .
def_»adÚly
("b®lPosRR", &
Loÿli§tiÚBÏckbßrd
::
b®lPosRR
)

5 .
def_»adÚly
("b®lPosRRC", &
Loÿli§tiÚBÏckbßrd
::
b®lPosRRC
)

6 .
def_»adÚly
("b®lV–RRC", &
Loÿli§tiÚBÏckbßrd
::
b®lV–RRC
)

7 .
def_»adÚly
("b®lV–", &
Loÿli§tiÚBÏckbßrd
::
b®lV–
)

8 .
def_»adÚly
("robÙPosUnû¹ašty", &
Loÿli§tiÚBÏckbßrd
::
robÙPosUnû¹ašty
)

9 .
def_»adÚly
("robÙH—dšgUnû¹ašty", &
Loÿli§tiÚBÏckbßrd
::
robÙH—dšgUnû¹ašty
)

10 .
def_»adÚly
("robÙH—dšgSugge¡iÚ", &
Loÿli§tiÚBÏckbßrd
::
robÙH—dšgSugge¡iÚ
)

11 .
def_»adÚly
("b®lPosUnû¹ašty", &
Loÿli§tiÚBÏckbßrd
::
b®lPosUnû¹ašty
)

12 .
def_»adÚly
("b®lV–Eig’v®ue", &
Loÿli§tiÚBÏckbßrd
::
b®lV–Eig’v®ue
)

13 .
def_»adÚly
("b®lPos", &
Loÿli§tiÚBÏckbßrd
::
b®lPos
)

14 .
def_»adÚly
("b®lNeckR–©ive", &
Loÿli§tiÚBÏckbßrd
::
b®lNeckR–©ive
)

15 .
def_»adÚly
("‹amB®l", &
Loÿli§tiÚBÏckbßrd
::
‹amB®l
)

16 .
def_»adÚly
("robÙOb¡aşes", &
Loÿli§tiÚBÏckbßrd
::
robÙOb¡aşes
);

	@robot/perception/behaviour/python/wrappers/MotionBlackboard_wrap.cpp

1 
	gşass_
<
	gMÙiÚBÏckbßrd
>("MotionBlackboard")

2 .
add_´İ”ty
("£nsÜs", &
MÙiÚBÏckbßrd
::
£nsÜs
)

3 .
add_´İ”ty
("aùive", &
MÙiÚBÏckbßrd
::
aùive
);

	@robot/perception/behaviour/python/wrappers/PostInfo_wrap.cpp

1 
	gşass_
<
	gPo¡Info
>("PostInfo").

2 
def_»adwr™e
("¼" , &
Po¡Info
::
¼
 ).

3 
def_»adwr™e
("ty³" , &
Po¡Info
::
ty³
 ).

4 
def_»adwr™e
("imageCoÜds" , &
Po¡Info
::
imageCoÜds
);

6 
	g’um_
<
	gPo¡Info
::
Ty³
>("PostType").

7 
v®ue
("pNÚe" , 
Po¡Info
::
pNÚe
 ).

8 
v®ue
("pLeá" , 
Po¡Info
::
pLeá
 ).

9 
v®ue
("pRight" , 
Po¡Info
::
pRight
 ).

10 
v®ue
("pHome" , 
Po¡Info
::
pHome
 ).

11 
v®ue
("pAway" , 
Po¡Info
::
pAway
 ).

12 
v®ue
("pHomeLeá" , 
Po¡Info
::
pHomeLeá
 ).

13 
v®ue
("pHomeRight" , 
Po¡Info
::
pHomeRight
 ).

14 
v®ue
("pAwayLeá" , 
Po¡Info
::
pAwayLeá
 ).

15 
v®ue
("pAwayRight" , 
Po¡Info
::
pAwayRight
 );

	@robot/perception/behaviour/python/wrappers/RRCoord_wrap.cpp

1 
	gşass_
<
	gRRCoÜd
>("RRCoord").

2 
def
(
š™
<, , >()).

3 
add_´İ”ty
("di¡ªû" , 
¼_g‘_v_cÚ¡_ty³
(&
RRCoÜd
::
di¡ªû
) ).

4 
add_´İ”ty
("h—dšg" , 
¼_g‘_v_cÚ¡_ty³
(&
RRCoÜd
::
h—dšg
) ).

5 
add_´İ”ty
("Ü›Á©iÚ", 
¼_g‘_v_cÚ¡_ty³
(&
RRCoÜd
::
Ü›Á©iÚ
)).

6 
add_´İ”ty
("v¬" , 
make_g‘‹r
(&
RRCoÜd
::
v¬
, 
»tuº_v®ue_pŞicy
<
»tuº_by_v®ue
>()));

	@robot/perception/behaviour/python/wrappers/ReadySkillPositionAllocation_wrap.cpp

1 
	gşass_
<
	gR—dySklPos™iÚAÎoÿtiÚ
>("ReadySkillPositionAllocation")

2 .
def_»adÚly
("äomPÏy”Num", &
R—dySklPos™iÚAÎoÿtiÚ
::
äomPÏy”Num
)

3 .
def_»adÚly
("»adyPos™iÚAÎoÿtiÚ0", &
R—dySklPos™iÚAÎoÿtiÚ
::
»adyPos™iÚAÎoÿtiÚ0
)

4 .
def_»adÚly
("»adyPos™iÚAÎoÿtiÚ1", &
R—dySklPos™iÚAÎoÿtiÚ
::
»adyPos™iÚAÎoÿtiÚ1
)

5 .
def_»adÚly
("»adyPos™iÚAÎoÿtiÚ2", &
R—dySklPos™iÚAÎoÿtiÚ
::
»adyPos™iÚAÎoÿtiÚ2
)

6 .
def_»adÚly
("»adyPos™iÚAÎoÿtiÚ3", &
R—dySklPos™iÚAÎoÿtiÚ
::
»adyPos™iÚAÎoÿtiÚ3
)

7 .
def_»adÚly
("»adyPos™iÚAÎoÿtiÚ4", &
R—dySklPos™iÚAÎoÿtiÚ
::
»adyPos™iÚAÎoÿtiÚ4
);

	@robot/perception/behaviour/python/wrappers/ReceiverBlackboard_wrap.cpp

1 
	gşass_
<
	gReûiv”BÏckbßrd
>("ReceiverBlackboard")

2 .
def_»adÚly
("šÿ·c™©ed" , &
Reûiv”BÏckbßrd
::
šÿ·c™©ed
)

3 .
def_»adÚly
("Ï¡Reûived" , &
Reûiv”BÏckbßrd
::
Ï¡Reûived
 )

4 .
def_»adÚly
("mes§ge" , &
Reûiv”BÏckbßrd
::
mes§ge
 )

5 .
def_»adÚly
("d©a" , &
Reûiv”BÏckbßrd
::
d©a
 );

	@robot/perception/behaviour/python/wrappers/RobotInfo_wrap.cpp

1 
	gşass_
<
	gRobÙInfo
>("RobotInfo")

2 .
def_»adÚly
("¼" , &
RobÙInfo
::
¼
 )

3 .
def_»adÚly
("ty³" , &
RobÙInfo
::
ty³
 );

5 
	g’um_
<
	gRobÙInfo
::
Ty³
>("RobotInfoType")

6 .
v®ue
("rUnknown" , 
RobÙInfo
::
rUnknown
 )

7 .
v®ue
("rBlue" , 
RobÙInfo
::
rBlue
 )

8 .
v®ue
("rRed" , 
RobÙInfo
::
rRed
 );

	@robot/perception/behaviour/python/wrappers/RobotObstacle_wrap.cpp

1 
	gşass_
<
	gRobÙOb¡aşe
>("RobotObstacle")

2 .
def_»adÚly
("¼", &
RobÙOb¡aşe
::
¼
)

3 .
def_»adÚly
("ty³", &
RobÙOb¡aşe
::
ty³
)

4 .
def_»adÚly
("¼c", &
RobÙOb¡aşe
::
¼c
)

5 .
def_»adÚly
("pos", &
RobÙOb¡aşe
::
pos
)

6 .
def_»adÚly
("ng’tH—dšgLeá", &
RobÙOb¡aşe
::
ng’tH—dšgLeá
)

7 .
def_»adÚly
("ng’tH—dšgRight", &
RobÙOb¡aşe
::
ng’tH—dšgRight
)

8 .
def_»adÚly
("evadeVeùÜLeá", &
RobÙOb¡aşe
::
evadeVeùÜLeá
)

9 .
def_»adÚly
("evadeVeùÜRight", &
RobÙOb¡aşe
::
evadeVeùÜRight
);

	@robot/perception/behaviour/python/wrappers/SPLDefs_wrap.cpp

1 
scİe
().
©Œ
("FIELD_LINE_WIDTH" ) = 
FIELD_LINE_WIDTH
;

2 
scİe
().
©Œ
("OFFNAO_FIELD_LENGTH_OFFSET"èğ
OFFNAO_FIELD_LENGTH_OFFSET
;

3 
scİe
().
©Œ
("FIELD_LENGTH_OFFSET" ) = 
FIELD_LENGTH_OFFSET
;

4 
scİe
().
©Œ
("OFFNAO_FIELD_WIDTH_OFFSET" ) = 
OFFNAO_FIELD_WIDTH_OFFSET
;

5 
scİe
().
©Œ
("FIELD_WIDTH_OFFSET" ) = 
FIELD_WIDTH_OFFSET
;

6 
scİe
().
©Œ
("FIELD_WIDTH" ) = 
FIELD_WIDTH
;

7 
scİe
().
©Œ
("FIELD_LENGTH" ) = 
FIELD_LENGTH
;

8 
scİe
().
©Œ
("GOAL_BOX_WIDTH" ) = 
GOAL_BOX_WIDTH
;

9 
scİe
().
©Œ
("GOAL_BOX_LENGTH" ) = 
GOAL_BOX_LENGTH
;

10 
scİe
().
©Œ
("MARKER_DIMENSIONS" ) = 
MARKER_DIMENSIONS
;

11 
scİe
().
©Œ
("DIST_GOAL_LINE_TO_MARKER" ) = 
DIST_GOAL_LINE_TO_MARKER
;

12 
scİe
().
©Œ
("CENTER_CIRCLE_DIAMETER" ) = 
CENTER_CIRCLE_DIAMETER
;

13 
scİe
().
©Œ
("MARKER_CENTER_X" ) = 
MARKER_CENTER_X
;

14 
scİe
().
©Œ
("GOAL_POST_DIAMETER" ) = 
GOAL_POST_DIAMETER
;

15 
scİe
().
©Œ
("GOAL_BAR_DIAMETER" ) = 
GOAL_BAR_DIAMETER
;

16 
scİe
().
©Œ
("GOAL_POST_HEIGHT" ) = 
GOAL_POST_HEIGHT
;

17 
scİe
().
©Œ
("GOAL_WIDTH" ) = 
GOAL_WIDTH
;

18 #ifdeà
USING_SMALL_FIELD


19 
scİe
().
©Œ
("GOAL_SUPPORT_DIMENSIONS" ) = 
GOAL_SUPPORT_DIMENSIONS
;

21 
scİe
().
©Œ
("FULL_FIELD_WIDTH" ) = 
FULL_FIELD_WIDTH
;

22 
scİe
().
©Œ
("OFFNAO_FULL_FIELD_WIDTH" ) = 
OFFNAO_FULL_FIELD_WIDTH
;

23 
scİe
().
©Œ
("FULL_FIELD_LENGTH" ) = 
FULL_FIELD_LENGTH
;

24 
scİe
().
©Œ
("OFFNAO_FULL_FIELD_LENGTH" ) = 
OFFNAO_FULL_FIELD_LENGTH
;

25 
scİe
().
©Œ
("UNKNOWN_COORD" ) = 
UNKNOWN_COORD
;

26 
scİe
().
©Œ
("UNKNOWN_HEADING" ) = 
UNKNOWN_HEADING
;

27 
scİe
().
©Œ
("BALL_RADIUS" ) = 
BALL_RADIUS
;

28 
scİe
().
©Œ
("GOAL_POST_ABS_X" ) = 
GOAL_POST_ABS_X
;

29 
scİe
().
©Œ
("GOAL_POST_ABS_Y" ) = 
GOAL_POST_ABS_Y
;

30 
scİe
().
©Œ
("ROBOTS_PER_TEAM" ) = 
ROBOTS_PER_TEAM
;

	@robot/perception/behaviour/python/wrappers/SPLStandardMessage_wrap.cpp

1 
	gşass_
<
	gSPLSnd¬dMes§ge
>("SPLStandardMessage")

2 .
def_»adÚly
("¶ay”Num", &
SPLSnd¬dMes§ge
::
¶ay”Num
)

3 .
def_»adÚly
("çÎ’", &
SPLSnd¬dMes§ge
::
çÎ’
)

4 .
def_»adÚly
("po£", &
SPLSnd¬dMes§ge
::
po£
)

5 .
def_»adÚly
("w®kšgTo", &
SPLSnd¬dMes§ge
::
w®kšgTo
)

6 .
def_»adÚly
("shoÙšgTo", &
SPLSnd¬dMes§ge
::
shoÙšgTo
)

7 .
def_»adÚly
("b®lAge", &
SPLSnd¬dMes§ge
::
b®lAge
)

8 .
def_»adÚly
("b®l", &
SPLSnd¬dMes§ge
::
b®l
)

9 .
def_»adÚly
("b®lV–", &
SPLSnd¬dMes§ge
::
b®lV–
)

10 .
def_»adÚly
("sugge¡iÚ", &
SPLSnd¬dMes§ge
::
sugge¡iÚ
)

11 .
def_»adÚly
("š‹ÁiÚ", &
SPLSnd¬dMes§ge
::
š‹ÁiÚ
)

12 .
def_»adÚly
("av”ageW®kS³ed", &
SPLSnd¬dMes§ge
::
av”ageW®kS³ed
)

13 .
def_»adÚly
("maxKickDi¡ªû", &
SPLSnd¬dMes§ge
::
maxKickDi¡ªû
)

14 .
def_»adÚly
("cu¼’tPos™iÚCÚfid’û", &
SPLSnd¬dMes§ge
::
cu¼’tPos™iÚCÚfid’û
);

	@robot/perception/behaviour/python/wrappers/SensorValues_wrap.cpp

1 
	gşass_
<
	gS’sÜV®ues
>("SensorValues")

2 .
add_´İ”ty
("jošts" , &
S’sÜV®ues
::
jošts
 )

3 .
add_´İ”ty
("£nsÜs" , &
S’sÜV®ues
::
£nsÜs
)

4 .
add_´İ”ty
("sÚ¬" , &
S’sÜV®ues
::
sÚ¬
 );

	@robot/perception/behaviour/python/wrappers/TeamBallInfo_wrap.cpp

1 
	gşass_
<
	gT—mB®lInfo
>("TeamBallInfo")

2 .
def_»adÚly
("pos" , &
T—mB®lInfo
::
pos
 )

3 .
def_»adÚly
("¡©us" , &
T—mB®lInfo
::
¡©us
 )

4 .
def_»adÚly
("cÚŒibutÜs" , &
T—mB®lInfo
::
cÚŒibutÜs
 );

6 
	g’um_
<
	gT—mB®lInfo
::
Stus
>("TeamBallInfoStatus")

7 .
v®ue
("tNeuŒ®" , 
T—mB®lInfo
::
tNeuŒ®
 )

8 .
v®ue
("tAg»e" , 
T—mB®lInfo
::
tAg»e
 )

9 .
v®ue
("tDi§g»e" , 
T—mB®lInfo
::
tDi§g»e
 );

	@robot/perception/behaviour/python/wrappers/VisionBlackboard_wrap.cpp

1 
	gşass_
<
	gVisiÚBÏckbßrd
>("VisionBlackboard")

2 .
add_´İ”ty
("b®ls" , &
VisiÚBÏckbßrd
::
b®ls
 )

3 .
add_´İ”ty
("po¡s" , &
VisiÚBÏckbßrd
::
po¡s
 )

4 .
add_´İ”ty
("time¡amp", &
VisiÚBÏckbßrd
::
time¡amp
)

5 .
add_´İ”ty
("b®lHšt" , &
VisiÚBÏckbßrd
::
b®lHšt
 );

	@robot/perception/behaviour/python/wrappers/VisionDefs_wrap.cpp

1 
scİe
().
©Œ
("TOP_IMAGE_ROWS"èğ
TOP_IMAGE_ROWS
;

2 
scİe
().
©Œ
("TOP_IMAGE_COLS"èğ
TOP_IMAGE_COLS
;

3 
scİe
().
©Œ
("BOT_IMAGE_ROWS"èğ
BOT_IMAGE_ROWS
;

4 
scİe
().
©Œ
("BOT_IMAGE_COLS"èğ
BOT_IMAGE_COLS
;

5 
scİe
().
©Œ
("IMAGE_ROWS"èğ
IMAGE_ROWS
;

6 
scİe
().
©Œ
("IMAGE_COLS"èğ
IMAGE_COLS
;

7 
scİe
().
©Œ
("IMAGE_HFOV"èğ
IMAGE_HFOV
;

	@robot/perception/behaviour/python/wrappers/XYZ_Coord_wrap.cpp

1 
	gşass_
<
	gXYZ_CoÜd
>("XYZ_Coord")

2 .
def_»adÚly
("x", &
XYZ_CoÜd
::
x
)

3 .
def_»adÚly
("y", &
XYZ_CoÜd
::
y
)

4 .
def_»adÚly
("z", &
XYZ_CoÜd
::
z
);

	@robot/perception/behaviour/python/wrappers/body_wrap.cpp

1 
	g’um_
<
	gJošts
::
JoštCodesEnum
>("Joints")

2 .
v®ue
("H—dYaw" , 
Jošts
::
H—dYaw
 )

3 .
v®ue
("H—dP™ch" , 
Jošts
::
H—dP™ch
 )

4 .
v®ue
("LShould”P™ch" , 
Jošts
::
LShould”P™ch
 )

5 .
v®ue
("LShould”RŞl" , 
Jošts
::
LShould”RŞl
 )

6 .
v®ue
("LElbowYaw" , 
Jošts
::
LElbowYaw
 )

7 .
v®ue
("LElbowRŞl" , 
Jošts
::
LElbowRŞl
 )

8 .
v®ue
("LWri¡Yaw" , 
Jošts
::
LWri¡Yaw
 )

9 .
v®ue
("LHªd" , 
Jošts
::
LHªd
 )

10 .
v®ue
("LHYawP™ch" , 
Jošts
::
LHYawP™ch
 )

11 .
v®ue
("LHRŞl" , 
Jošts
::
LHRŞl
 )

12 .
v®ue
("LHP™ch" , 
Jošts
::
LHP™ch
 )

13 .
v®ue
("LKÃeP™ch" , 
Jošts
::
LKÃeP™ch
 )

14 .
v®ue
("LAnkËP™ch" , 
Jošts
::
LAnkËP™ch
 )

15 .
v®ue
("LAnkËRŞl" , 
Jošts
::
LAnkËRŞl
 )

16 .
v®ue
("RHRŞl" , 
Jošts
::
RHRŞl
 )

17 .
v®ue
("RHP™ch" , 
Jošts
::
RHP™ch
 )

18 .
v®ue
("RKÃeP™ch" , 
Jošts
::
RKÃeP™ch
 )

19 .
v®ue
("RAnkËP™ch" , 
Jošts
::
RAnkËP™ch
 )

20 .
v®ue
("RAnkËRŞl" , 
Jošts
::
RAnkËRŞl
 )

21 .
v®ue
("RShould”P™ch" , 
Jošts
::
RShould”P™ch
 )

22 .
v®ue
("RShould”RŞl" , 
Jošts
::
RShould”RŞl
 )

23 .
v®ue
("RElbowYaw" , 
Jošts
::
RElbowYaw
 )

24 .
v®ue
("RElbowRŞl" , 
Jošts
::
RElbowRŞl
 )

25 .
v®ue
("RWri¡Yaw" , 
Jošts
::
RWri¡Yaw
 )

26 .
v®ue
("RHªd" , 
Jošts
::
RHªd
 )

27 .
v®ue
("NUMBER_OF_JOINTS" , 
Jošts
::
NUMBER_OF_JOINTS
);

29 
scİe
().
©Œ
("H—dYaw_Mš" ) = 
Jošts
::
RadŸns
::
H—dYaw_Mš
;

30 
scİe
().
©Œ
("H—dYaw_Max" ) = 
Jošts
::
RadŸns
::
H—dYaw_Max
;

31 
scİe
().
©Œ
("H—dP™ch_Mš" ) = 
Jošts
::
RadŸns
::
H—dP™ch_Mš
;

32 
scİe
().
©Œ
("H—dP™ch_Max" ) = 
Jošts
::
RadŸns
::
H—dP™ch_Max
;

33 
scİe
().
©Œ
("LShould”P™ch_Mš"èğ
Jošts
::
RadŸns
::
LShould”P™ch_Mš
;

34 
scİe
().
©Œ
("LShould”P™ch_Max"èğ
Jošts
::
RadŸns
::
LShould”P™ch_Max
;

35 
scİe
().
©Œ
("LShould”RŞl_Max" ) = 
Jošts
::
RadŸns
::
LShould”RŞl_Max
;

36 
scİe
().
©Œ
("LShould”RŞl_Mš" ) = 
Jošts
::
RadŸns
::
LShould”RŞl_Mš
;

37 
scİe
().
©Œ
("LElbowYaw_Mš" ) = 
Jošts
::
RadŸns
::
LElbowYaw_Mš
;

38 
scİe
().
©Œ
("LElbowYaw_Max" ) = 
Jošts
::
RadŸns
::
LElbowYaw_Max
;

39 
scİe
().
©Œ
("LElbowRŞl_Mš" ) = 
Jošts
::
RadŸns
::
LElbowRŞl_Mš
;

40 
scİe
().
©Œ
("LElbowRŞl_Max" ) = 
Jošts
::
RadŸns
::
LElbowRŞl_Max
;

41 
scİe
().
©Œ
("LWri¡Yaw_Mš" ) = 
Jošts
::
RadŸns
::
LWri¡Yaw_Mš
;

42 
scİe
().
©Œ
("LWri¡Yaw_Max" ) = 
Jošts
::
RadŸns
::
LWri¡Yaw_Max
;

43 
scİe
().
©Œ
("LHªd_Mš" ) = 
Jošts
::
RadŸns
::
LHªd_Mš
;

44 
scİe
().
©Œ
("LHªd_Max" ) = 
Jošts
::
RadŸns
::
LHªd_Max
;

45 
scİe
().
©Œ
("LHYawP™ch_Mš" ) = 
Jošts
::
RadŸns
::
LHYawP™ch_Mš
;

46 
scİe
().
©Œ
("LHYawP™ch_Max" ) = 
Jošts
::
RadŸns
::
LHYawP™ch_Max
;

47 
scİe
().
©Œ
("LHP™ch_Mš" ) = 
Jošts
::
RadŸns
::
LHP™ch_Mš
;

48 
scİe
().
©Œ
("LHP™ch_Max" ) = 
Jošts
::
RadŸns
::
LHP™ch_Max
;

49 
scİe
().
©Œ
("LHRŞl_Mš" ) = 
Jošts
::
RadŸns
::
LHRŞl_Mš
;

50 
scİe
().
©Œ
("LHRŞl_Max" ) = 
Jošts
::
RadŸns
::
LHRŞl_Max
;

51 
scİe
().
©Œ
("LKÃeP™ch_Mš" ) = 
Jošts
::
RadŸns
::
LKÃeP™ch_Mš
;

52 
scİe
().
©Œ
("LKÃeP™ch_Max" ) = 
Jošts
::
RadŸns
::
LKÃeP™ch_Max
;

53 
scİe
().
©Œ
("LAnkËP™ch_Mš" ) = 
Jošts
::
RadŸns
::
LAnkËP™ch_Mš
;

54 
scİe
().
©Œ
("LAnkËP™ch_Max" ) = 
Jošts
::
RadŸns
::
LAnkËP™ch_Max
;

55 
scİe
().
©Œ
("LAnkËRŞl_Mš" ) = 
Jošts
::
RadŸns
::
LAnkËRŞl_Mš
;

56 
scİe
().
©Œ
("LAnkËRŞl_Max" ) = 
Jošts
::
RadŸns
::
LAnkËRŞl_Max
;

57 
scİe
().
©Œ
("RHP™ch_Mš" ) = 
Jošts
::
RadŸns
::
RHP™ch_Mš
;

58 
scİe
().
©Œ
("RHP™ch_Max" ) = 
Jošts
::
RadŸns
::
RHP™ch_Max
;

59 
scİe
().
©Œ
("RHRŞl_Mš" ) = 
Jošts
::
RadŸns
::
RHRŞl_Mš
;

60 
scİe
().
©Œ
("RHRŞl_Max" ) = 
Jošts
::
RadŸns
::
RHRŞl_Max
;

61 
scİe
().
©Œ
("RKÃeP™ch_Mš" ) = 
Jošts
::
RadŸns
::
RKÃeP™ch_Mš
;

62 
scİe
().
©Œ
("RKÃeP™ch_Max" ) = 
Jošts
::
RadŸns
::
RKÃeP™ch_Max
;

63 
scİe
().
©Œ
("RAnkËP™ch_Mš" ) = 
Jošts
::
RadŸns
::
RAnkËP™ch_Mš
;

64 
scİe
().
©Œ
("RAnkËP™ch_Max" ) = 
Jošts
::
RadŸns
::
RAnkËP™ch_Max
;

65 
scİe
().
©Œ
("RAnkËRŞl_Mš" ) = 
Jošts
::
RadŸns
::
RAnkËRŞl_Mš
;

66 
scİe
().
©Œ
("RAnkËRŞl_Max" ) = 
Jošts
::
RadŸns
::
RAnkËRŞl_Max
;

67 
scİe
().
©Œ
("RShould”P™ch_Mš"èğ
Jošts
::
RadŸns
::
RShould”P™ch_Mš
;

68 
scİe
().
©Œ
("RShould”P™ch_Max"èğ
Jošts
::
RadŸns
::
RShould”P™ch_Max
;

69 
scİe
().
©Œ
("RShould”RŞl_Mš" ) = 
Jošts
::
RadŸns
::
RShould”RŞl_Mš
;

70 
scİe
().
©Œ
("RShould”RŞl_Max" ) = 
Jošts
::
RadŸns
::
RShould”RŞl_Max
;

71 
scİe
().
©Œ
("RElbowYaw_Mš" ) = 
Jošts
::
RadŸns
::
RElbowYaw_Mš
;

72 
scİe
().
©Œ
("RElbowYaw_Max" ) = 
Jošts
::
RadŸns
::
RElbowYaw_Max
;

73 
scİe
().
©Œ
("RElbowRŞl_Mš" ) = 
Jošts
::
RadŸns
::
RElbowRŞl_Mš
;

74 
scİe
().
©Œ
("RElbowRŞl_Max" ) = 
Jošts
::
RadŸns
::
RElbowRŞl_Max
;

75 
scİe
().
©Œ
("RWri¡Yaw_Mš" ) = 
Jošts
::
RadŸns
::
RWri¡Yaw_Mš
;

76 
scİe
().
©Œ
("RWri¡Yaw_Max" ) = 
Jošts
::
RadŸns
::
RWri¡Yaw_Max
;

77 
scİe
().
©Œ
("RHªd_Mš" ) = 
Jošts
::
RadŸns
::
RHªd_Mš
;

78 
scİe
().
©Œ
("RHªd_Max" ) = 
Jošts
::
RadŸns
::
RHªd_Max
;

80 
	g’um_
<
	gS’sÜs
::
S’sÜCodesEnum
>("Sensors")

81 .
v®ue
("IÃ¹ŸlS’sÜ_AccX" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_AccX
 )

82 .
v®ue
("IÃ¹ŸlS’sÜ_AccY" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_AccY
 )

83 .
v®ue
("IÃ¹ŸlS’sÜ_AccZ" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_AccZ
 )

84 .
v®ue
("IÃ¹ŸlS’sÜ_GyrX" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
 )

85 .
v®ue
("IÃ¹ŸlS’sÜ_GyrY" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrY
 )

86 .
v®ue
("IÃ¹ŸlS’sÜ_GyrRef" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrRef
 )

87 .
v®ue
("IÃ¹ŸlS’sÜ_AngËX" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
 )

88 .
v®ue
("IÃ¹ŸlS’sÜ_AngËY" , 
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
 )

89 .
v®ue
("LFoÙ_FSR_FrÚtLeá" , 
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
 )

90 .
v®ue
("LFoÙ_FSR_FrÚtRight" , 
S’sÜs
::
LFoÙ_FSR_FrÚtRight
 )

91 .
v®ue
("LFoÙ_FSR_R—rLeá" , 
S’sÜs
::
LFoÙ_FSR_R—rLeá
 )

92 .
v®ue
("LFoÙ_FSR_R—rRight" , 
S’sÜs
::
LFoÙ_FSR_R—rRight
 )

93 .
v®ue
("LFoÙ_FSR_C’‹rOfP»ssu»_X" , 
S’sÜs
::
LFoÙ_FSR_C’‹rOfP»ssu»_X
)

94 .
v®ue
("LFoÙ_FSR_C’‹rOfP»ssu»_Y" , 
S’sÜs
::
LFoÙ_FSR_C’‹rOfP»ssu»_Y
)

95 .
v®ue
("RFoÙ_FSR_FrÚtLeá" , 
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
 )

96 .
v®ue
("RFoÙ_FSR_FrÚtRight" , 
S’sÜs
::
RFoÙ_FSR_FrÚtRight
 )

97 .
v®ue
("RFoÙ_FSR_R—rLeá" , 
S’sÜs
::
RFoÙ_FSR_R—rLeá
 )

98 .
v®ue
("RFoÙ_FSR_R—rRight" , 
S’sÜs
::
RFoÙ_FSR_R—rRight
 )

99 .
v®ue
("RFoÙ_FSR_C’‹rOfP»ssu»_X" , 
S’sÜs
::
RFoÙ_FSR_C’‹rOfP»ssu»_X
)

100 .
v®ue
("RFoÙ_FSR_C’‹rOfP»ssu»_Y" , 
S’sÜs
::
RFoÙ_FSR_C’‹rOfP»ssu»_Y
)

101 .
v®ue
("LFoÙ_Bum³r_Leá" , 
S’sÜs
::
LFoÙ_Bum³r_Leá
 )

102 .
v®ue
("LFoÙ_Bum³r_Right" , 
S’sÜs
::
LFoÙ_Bum³r_Right
 )

103 .
v®ue
("RFoÙ_Bum³r_Leá" , 
S’sÜs
::
RFoÙ_Bum³r_Leá
 )

104 .
v®ue
("RFoÙ_Bum³r_Right" , 
S’sÜs
::
RFoÙ_Bum³r_Right
 )

105 .
v®ue
("Che¡Bßrd_Bu‰Ú" , 
S’sÜs
::
Che¡Bßrd_Bu‰Ú
 )

106 .
v®ue
("B©‹ry_Ch¬ge" , 
S’sÜs
::
B©‹ry_Ch¬ge
 )

107 .
v®ue
("B©‹ry_Cu¼’t" , 
S’sÜs
::
B©‹ry_Cu¼’t
 )

108 .
v®ue
("US" , 
S’sÜs
::
US
 )

109 .
v®ue
("NUMBER_OF_SENSORS" , 
S’sÜs
::
NUMBER_OF_SENSORS
 );

	@robot/perception/behaviour/python/wrappers/say_wrap.cpp

1 
def
("§y", 
py_§y
);

	@robot/perception/behaviour/python/wrappers/vector_wrap.cpp

1 
	gşass_
<
	g¡d
::
veùÜ
<
AbsCoÜd
> >("AbsCoordVec")

2 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
AbsCoÜd
> >());

4 
	gşass_
<
	g¡d
::
veùÜ
<
RRCoÜd
> >("RRCoordVec")

5 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
RRCoÜd
> >());

7 
	gşass_
<
	g¡d
::
veùÜ
<
RobÙInfo
> >("RobotInfoVec")

8 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
RobÙInfo
> >());

10 
	gşass_
<
	g¡d
::
veùÜ
<
RobÙOb¡aşe
> >("RobotObstacleVec")

11 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
RobÙOb¡aşe
> >());

13 
	gşass_
<
	g¡d
::
veùÜ
<
B®lInfo
> >("BallInfoVec")

14 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
B®lInfo
> >());

16 
	gşass_
<
	g¡d
::
veùÜ
<
Po¡Info
> >("PostInfoVec")

17 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
Po¡Info
> >());

19 
	gşass_
<
	g¡d
::
veùÜ
<> >("FloatVec")

20 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<> >());

22 
	gşass_
<
	g¡d
::
veùÜ
<> >("IntVec")

23 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<> >());

25 
	gşass_
<
	g¡d
::
veùÜ
<
¡d
::vector<> > >("Int2DVec")

26 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<std::vector<> > >());

28 
	gşass_
<
	g¡d
::
veùÜ
<
FoÙInfo
> >("FootInfoVec")

29 .
def
(
veùÜ_šdexšg_su™e
<
¡d
::
veùÜ
<
FoÙInfo
> >());

	@robot/perception/dumper/PerceptionDumper.cpp

1 
	~"P”û±iÚDum³r.hµ
"

3 
	~"bÏckbßrd/BÏckbßrd.hµ
"

5 
	gP”û±iÚDum³r
::
	$P”û±iÚDum³r
(cÚ¡ *
·th
)

6 : 
	`·th
(
·th
), 
	`of
Õ©h), 
	$¬
(
of
)

8 
	}
}

10 
	gP”û±iÚDum³r
::~
	$P”û±iÚDum³r
()

12 
	}
}

14 cÚ¡ 
¡d
::
¡ršg
 &
P”û±iÚDum³r
::
	$g‘P©h
() const

16  
·th
;

17 
	}
}

19 
	gP”û±iÚDum³r
::
	$dump
(
BÏckbßrd
 *
bÏckbßrd
)

21 
¬
 << *
bÏckbßrd
;

22 
	}
}

	@robot/perception/dumper/PerceptionDumper.hpp

1 #´agm¨
Úû


3 
	~<¡ršg
>

4 
	~<f¡»am
>

6 
	~<boo¡/¬chive/bš¬y_ßrchive.hµ
>

8 
şass
 
	gBÏckbßrd
;

10 şas 
	cP”û±iÚDum³r


12 
	mpublic
:

13 
P”û±iÚDum³r
(cÚ¡ *
·th
);

14 
	mvœtu®
 ~
P”û±iÚDum³r
();

16 
dump
(
BÏckbßrd
 *
bÏckbßrd
);

18 cÚ¡ 
	m¡d
::
¡ršg
 &
	$g‘P©h
() const;

20 
´iv©e
:

21 
¡d
::
¡ršg
 
·th
;

22 
¡d
::
of¡»am
 
of
;

23 
boo¡
::
¬chive
::
bš¬y_ßrchive
 
¬
;

	@robot/perception/kinematics/CKF.cpp

3 
	~"CKF.hµ
"

4 
	~"uts/basic_m©hs.hµ
"

7 cÚ¡ 
	gªgË_v¬
 = 
SQUARE
(
DEG2RAD
(1.f));

8 cÚ¡ 
	gv–oc™y_v¬
 = 
SQUARE
(
DEG2RAD
(5.f));

10 cÚ¡ 
	gdt
 = 0.01f;

12 cÚ¡ 
	gacc_v¬
 = 
SQUARE
(
DEG2RAD
(50.f));

13 cÚ¡ 
	ggyro_v¬
 = 
SQUARE
(
DEG2RAD
(1.f));

16 
	gCKF
::
	$CKF
(){

17 
	`»£tF‹r
();

18 
	}
}

20 
	gCKF
::
	$»£tF‹r
(){

21 
¡©e
 = 
Eig’
::
VeùÜ4f
::
	`Z”o
();

23 
Q
 = 
Eig’
::
M©rix
<, 4, 4>::
	`Z”o
();

24 
	`Q
(0,0èğQ(1,1èğ
ªgË_v¬
;

25 
	`Q
(2,2èğQ(3,3èğ
v–oc™y_v¬
;

26 
v¬
 = 
Q
;

28 
R
 = 
Eig’
::
M©rix
<, 4, 4>::
	`Z”o
();

29 
	`R
(0,0èğR(1,1èğ
acc_v¬
;

30 
	`R
(2,2èğR(3,3èğ
gyro_v¬
;

31 
	}
}

35 
	gCKF
::
	$upd©e
(cÚ¡ 
S’sÜV®ues
 &
£nsÜV®ues
){

38 
Eig’
::
M©rix
<, 4, 4> 
F
 = Eig’::M©rix<, 4, 4>::
	`Id’t™y
();

39 
	`F
(0,2èğ
	`cos
(
	`¡©e
(2))*
dt
;

40 
	`F
(1,2èğ
	`sš
(
	`¡©e
(2))*
	`n
(¡©e(1))*
dt
;

41 
	`F
(1,3èğ
dt
;

44 
¡©e
 = 
F
*state;

45 
v¬
 = 
F
*v¬*F.
	`Œª¥o£
()+
Q
;

48 
Eig’
::
VeùÜ4f
 
obs
;

51 
Ax
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccX
];

52 
Ay
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccY
];

53 
Az
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccZ
];

55 
	`obs
(0èğ
	`©ª
(
Ay
/
Az
);

56 
	`obs
(1èğ
	`©ª
(-
Ax
/
Az
)*
	`cos
(obs(0));

57 
	`obs
(2èğ
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
];

58 
	`obs
(3èğ
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrY
];

62 
Eig’
::
M©rix
<, 4, 4> 
K
 = 
v¬
 * (v¬ + 
R
).
	`šv”£
();

63 
¡©e
 = s‹ + 
K
*(
obs
-state);

64 
v¬
 = v¬ - 
K
*var;

68 
	}
}

71 
	gCKF
::
	$g‘FÜw¬dL—n
(){

72  
	`¡©e
(1);

73 
	}
}

76 
	gCKF
::
	$g‘SideL—n
(){

77  
	`¡©e
(0);

78 
	}
}

	@robot/perception/kinematics/CKF.hpp

4 #´agm¨
Úû


7 
	~<veùÜ
>

8 
	~<Eig’/Eig’
>

9 
	~"ty³s/S’sÜV®ues.hµ
"

15 şas 
	cCKF
 {

16 
	mpublic
:

18 
CKF
();

20 
upd©e
(cÚ¡ 
S’sÜV®ues
 &
£nsÜV®ues
);

22 
»£tF‹r
();

24 
g‘SideL—n
();

26 
g‘FÜw¬dL—n
();

28 
	m´iv©e
:

30 
Eig’
::
VeùÜ4f
 
¡©e
;

31 
	mEig’
::
M©rix
<, 4, 4> 
	mv¬
;

32 
	mEig’
::
M©rix
<, 4, 4> 
	mQ
;

33 
	mEig’
::
M©rix
<, 4, 4> 
	mR
;

	@robot/perception/kinematics/Kinematics.cpp

1 
	~"Kšem©ics.hµ
"

3 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

4 
	~<boo¡/num”ic/ubÏs/io.hµ
>

5 
	~<boo¡/num”ic/ubÏs/lu.hµ
>

6 
	~<cm©h
>

7 
	~<şim™s
>

8 
	~<veùÜ
>

10 
	~<³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
>

11 
	~<uts/Tim”.hµ
>

12 
	~<uts/Logg”.hµ
>

13 
	~<uts/body.hµ
>

18 cÚ¡ 
	gVERY_SMALL
 = 0.0001;

30 cÚ¡ 
	gŒunk_Ëngth
 = 
Limbs
::
HOff£tZ
 + Limbs::
NeckOff£tZ
;

34 cÚ¡ 
	gÿm”a_out_bÙtom
 = 50.71;

35 cÚ¡ 
	gÿm”a_up_bÙtom
 = 17.74;

37 cÚ¡ 
	gÿm”a_out_tİ
 = 58.71;

38 cÚ¡ 
	gÿm”a_up_tİ
 = 63.64;

40 cÚ¡ 
	gÿm”a_bÙtom_ªgË
 = 
DEG2RAD
(39.7);

41 cÚ¡ 
	gÿm”a_tİ_ªgË
 = 
DEG2RAD
(1.2);

43 cÚ¡ 
	gd2
 = 
Œunk_Ëngth
 - 
Limbs
::
HOff£tY
;

44 cÚ¡ 
	gd3
 = 
Limbs
::
HOff£tY
 * 
sq¹
(2);

46 cÚ¡ 
	gd1Tİ
 = 
sq¹
(
pow
(
ÿm”a_out_tİ
, 2è+…ow(
ÿm”a_up_tİ
, 2));

47 cÚ¡ 
	ga1Tİ
 = 
©ª
(
ÿm”a_up_tİ
 / 
ÿm”a_out_tİ
è+ 
ÿm”a_tİ_ªgË
;

48 cÚ¡ 
	gl10Tİ
 = 
d1Tİ
 * 
sš
(
a1Tİ
);

49 cÚ¡ 
	gd11Tİ
 = 
d1Tİ
 * 
cos
(
a1Tİ
);

50 cÚ¡ 
	ga3Tİ
 = 
ÿm”a_tİ_ªgË
 - 
M_PI
;

52 cÚ¡ 
	gd1BÙ
 = 
sq¹
(
pow
(
ÿm”a_out_bÙtom
, 2è+…ow(
ÿm”a_up_bÙtom
, 2));

53 cÚ¡ 
	ga1BÙ
 = 
©ª
(
ÿm”a_up_bÙtom
 / 
ÿm”a_out_bÙtom
è+ 
ÿm”a_bÙtom_ªgË
;

54 cÚ¡ 
	gl10BÙ
 = 
d1BÙ
 * 
sš
(
a1BÙ
);

55 cÚ¡ 
	gd11BÙ
 = 
d1BÙ
 * 
cos
(
a1BÙ
);

56 cÚ¡ 
	ga3BÙ
 = 
ÿm”a_bÙtom_ªgË
 - 
M_PI
;

58 
	gKšem©ics
::
	$Kšem©ics
() {

59 
¡d
::
veùÜ
<
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> > 
che¡
;

62 
che¡
.
	`push_back
(
vec4
<>(-96, 100, 
Limbs
::
NeckOff£tZ
 - 50, 1));

63 
che¡
.
	`push_back
(
vec4
<>(-96, 155, 
Limbs
::
NeckOff£tZ
 - 35, 1));

64 
che¡
.
	`push_back
(
vec4
<>(-91, 155, 
Limbs
::
NeckOff£tZ
 - 34, 1));

66 
che¡
.
	`push_back
(
vec4
<>(-90, 155, 
Limbs
::
NeckOff£tZ
 + -30, 1));

67 
che¡
.
	`push_back
(
vec4
<>(-70, 155, 
Limbs
::
NeckOff£tZ
 + 0, 1));

68 
che¡
.
	`push_back
(
vec4
<>(-50, 155, 
Limbs
::
NeckOff£tZ
 + 30, 1));

69 
che¡
.
	`push_back
(
vec4
<>(-30, 155, 
Limbs
::
NeckOff£tZ
 + 30, 1));

70 
che¡
.
	`push_back
(
vec4
<>(-20, 155, 
Limbs
::
NeckOff£tZ
 + 34, 1));

71 
che¡
.
	`push_back
(
vec4
<>(-10, 155, 
Limbs
::
NeckOff£tZ
 + 37, 1));

72 
che¡
.
	`push_back
(
vec4
<>(0, 155, 
Limbs
::
NeckOff£tZ
 + 40, 1));

73 
che¡
.
	`push_back
(
vec4
<>(10, 155, 
Limbs
::
NeckOff£tZ
 + 37, 1));

74 
che¡
.
	`push_back
(
vec4
<>(20, 155, 
Limbs
::
NeckOff£tZ
 + 34, 1));

75 
che¡
.
	`push_back
(
vec4
<>(30, 155, 
Limbs
::
NeckOff£tZ
 + 30, 1));

76 
che¡
.
	`push_back
(
vec4
<>(50, 155, 
Limbs
::
NeckOff£tZ
 + 30, 1));

77 
che¡
.
	`push_back
(
vec4
<>(70, 155, 
Limbs
::
NeckOff£tZ
 + 0, 1));

78 
che¡
.
	`push_back
(
vec4
<>(90, 155, 
Limbs
::
NeckOff£tZ
 + -30, 1));

80 
che¡
.
	`push_back
(
vec4
<>(60, 70, 
Limbs
::
NeckOff£tZ
 - 40, 1));

84 
che¡
.
	`push_back
(
vec4
<>(60, 60, 
Limbs
::
NeckOff£tZ
 - 70, 1));

85 
che¡
.
	`push_back
(
vec4
<>(62, 50, 
Limbs
::
NeckOff£tZ
 - 70, 1));

86 
che¡
.
	`push_back
(
vec4
<>(63, 40, 
Limbs
::
NeckOff£tZ
 - 70, 1));

87 
che¡
.
	`push_back
(
vec4
<>(65, 20, 
Limbs
::
NeckOff£tZ
 - 70, 1));

88 
che¡
.
	`push_back
(
vec4
<>(65, 10, 
Limbs
::
NeckOff£tZ
 - 70, 1));

89 
che¡
.
	`push_back
(
vec4
<>(65, 0, 
Limbs
::
NeckOff£tZ
 - 70, 1));

90 
bodyP¬ts
.
	`push_back
(
che¡
);

91 
che¡
.
	`ş—r
();

94 
che¡
.
	`push_back
(
vec4
<>(65, 0, 
Limbs
::
NeckOff£tZ
 - 70, 1));

95 
che¡
.
	`push_back
(
vec4
<>(65, -10, 
Limbs
::
NeckOff£tZ
 - 70, 1));

96 
che¡
.
	`push_back
(
vec4
<>(65, -20, 
Limbs
::
NeckOff£tZ
 - 70, 1));

97 
che¡
.
	`push_back
(
vec4
<>(63, -40, 
Limbs
::
NeckOff£tZ
 - 70, 1));

98 
che¡
.
	`push_back
(
vec4
<>(62, -50, 
Limbs
::
NeckOff£tZ
 - 70, 1));

99 
che¡
.
	`push_back
(
vec4
<>(60, -60, 
Limbs
::
NeckOff£tZ
 - 70, 1));

104 
che¡
.
	`push_back
(
vec4
<>(60, -70, 
Limbs
::
NeckOff£tZ
 - 40, 1));

106 
che¡
.
	`push_back
(
vec4
<>(90, -155, 
Limbs
::
NeckOff£tZ
 + -30, 1));

107 
che¡
.
	`push_back
(
vec4
<>(70, -155, 
Limbs
::
NeckOff£tZ
 + 0, 1));

108 
che¡
.
	`push_back
(
vec4
<>(50, -155, 
Limbs
::
NeckOff£tZ
 + 10, 1));

109 
che¡
.
	`push_back
(
vec4
<>(30, -155, 
Limbs
::
NeckOff£tZ
 + 10, 1));

110 
che¡
.
	`push_back
(
vec4
<>(20, -155, 
Limbs
::
NeckOff£tZ
 + 14, 1));

111 
che¡
.
	`push_back
(
vec4
<>(10, -155, 
Limbs
::
NeckOff£tZ
 + 17, 1));

112 
che¡
.
	`push_back
(
vec4
<>(0, -155, 
Limbs
::
NeckOff£tZ
 + 20, 1));

113 
che¡
.
	`push_back
(
vec4
<>(-10, -155, 
Limbs
::
NeckOff£tZ
 + 17, 1));

114 
che¡
.
	`push_back
(
vec4
<>(-20, -155, 
Limbs
::
NeckOff£tZ
 + 14, 1));

115 
che¡
.
	`push_back
(
vec4
<>(-30, -155, 
Limbs
::
NeckOff£tZ
 + 10, 1));

116 
che¡
.
	`push_back
(
vec4
<>(-50, -155, 
Limbs
::
NeckOff£tZ
 + 10, 1));

117 
che¡
.
	`push_back
(
vec4
<>(-70, -155, 
Limbs
::
NeckOff£tZ
 + 0, 1));

118 
che¡
.
	`push_back
(
vec4
<>(-90, -155, 
Limbs
::
NeckOff£tZ
 + -30, 1));

120 
che¡
.
	`push_back
(
vec4
<>(-91, -155, 
Limbs
::
NeckOff£tZ
 - 34, 1));

121 
che¡
.
	`push_back
(
vec4
<>(-96, -155, 
Limbs
::
NeckOff£tZ
 - 35, 1));

122 
che¡
.
	`push_back
(
vec4
<>(-96, -100, 
Limbs
::
NeckOff£tZ
 - 50, 1));

123 
bodyP¬ts
.
	`push_back
(
che¡
);

124 
che¡
.
	`ş—r
();

129 
mas£s
.
	`ş—r
();

130 
mas£s
.
	`push_back
(
Limbs
::
TÜsoMass
);

131 
mas£s
.
	`push_back
(
Limbs
::
NeckMass
);

132 
mas£s
.
	`push_back
(
Limbs
::
H—dMass
);

134 
mas£s
.
	`push_back
(
Limbs
::
RightShould”Mass
);

135 
mas£s
.
	`push_back
(
Limbs
::
RightBiûpMass
);

136 
mas£s
.
	`push_back
(
Limbs
::
RightElbowMass
);

137 
mas£s
.
	`push_back
(
Limbs
::
RightFÜ—rmMass
);

138 
mas£s
.
	`push_back
(
Limbs
::
RightHªdMass
);

140 
mas£s
.
	`push_back
(
Limbs
::
LeáShould”Mass
);

141 
mas£s
.
	`push_back
(
Limbs
::
LeáBiûpMass
);

142 
mas£s
.
	`push_back
(
Limbs
::
LeáElbowMass
);

143 
mas£s
.
	`push_back
(
Limbs
::
LeáFÜ—rmMass
);

144 
mas£s
.
	`push_back
(
Limbs
::
LeáHªdMass
);

146 
mas£s
.
	`push_back
(
Limbs
::
RightP–visMass
);

147 
mas£s
.
	`push_back
(
Limbs
::
RightHMass
);

148 
mas£s
.
	`push_back
(
Limbs
::
RightThighMass
);

149 
mas£s
.
	`push_back
(
Limbs
::
RightTibŸMass
);

150 
mas£s
.
	`push_back
(
Limbs
::
RightAnkËMass
);

151 
mas£s
.
	`push_back
(
Limbs
::
RightFoÙMass
);

153 
mas£s
.
	`push_back
(
Limbs
::
LeáP–visMass
);

154 
mas£s
.
	`push_back
(
Limbs
::
LeáHMass
);

155 
mas£s
.
	`push_back
(
Limbs
::
LeáThighMass
);

156 
mas£s
.
	`push_back
(
Limbs
::
LeáTibŸMass
);

157 
mas£s
.
	`push_back
(
Limbs
::
LeáAnkËMass
);

158 
mas£s
.
	`push_back
(
Limbs
::
LeáFoÙMass
);

162 
mas£sCom
.
	`ş—r
();

163 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
TÜsoCoM
));

164 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
NeckCoM
));

165 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
H—dCoM
));

166 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightShould”CoM
));

167 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightBiûpCoM
));

168 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightElbowCoM
));

169 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightFÜ—rmCoM
));

170 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightHªdCoM
));

171 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáShould”CoM
));

172 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáBiûpCoM
));

173 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáElbowCoM
));

174 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáFÜ—rmCoM
));

175 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáHªdCoM
));

176 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightP–visCoM
));

177 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightHCoM
));

178 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightThighCoM
));

179 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightTibŸCoM
));

180 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightAnkËCoM
));

181 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
RightFoÙCoM
));

182 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáP–visCoM
));

183 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáHCoM
));

184 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáThighCoM
));

185 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáTibŸCoM
));

186 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáAnkËCoM
));

187 
mas£sCom
.
	`push_back
(
	`vec4
(
Limbs
::
LeáFoÙCoM
));

190 
i
 = 0; i < 
CAMERA_DH_CHAIN_LEN
; ++i) {

191 
ŒªsfÜmLTİ
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

192 
ŒªsfÜmRTİ
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

193 
ŒªsfÜmLBÙ
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

194 
ŒªsfÜmRBÙ
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

196 
i
 = 0; i < 
HEAD_DH_CHAIN_LEN
; ++i) {

197 
ŒªsfÜmHB
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

199 
i
 = 0; i < 
ARM_DH_CHAIN_LEN
; ++i) {

200 
ŒªsfÜmLAB
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

201 
ŒªsfÜmRAB
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

203 
i
 = 0; i < 
LEG_DH_CHAIN_LEN
; ++i) {

204 
ŒªsfÜmLFB
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

205 
ŒªsfÜmRFB
[
i
] = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

209 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pi2AboutX
 = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, 0);

210 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
Ãgpi2AboutX
 = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 0);

211 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pi4AboutX
 = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 4, 0, 0);

212 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
Ãgpi2AboutXÃgpi2AboutZ
 = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, -M_PI / 2);

213 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pi2AboutXpi2AboutZ
 = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, M_PI / 2);

216 
ŒªsfÜmLTİ
[0] = 
ü—‹DHM©rix
<>(0, 0, 
Limbs
::
FoÙHeight
, 
M_PI
 / 2);

217 
ŒªsfÜmLTİ
[7] = 
ü—‹DHM©rix
<>(0, 3 * 
M_PI
 / 4, 0, 0);

219 
ŒªsfÜmRTİ
[0] = 
ŒªsfÜmLTİ
[0];

220 
ŒªsfÜmRTİ
[7] = 
pi4AboutX
;

222 
ŒªsfÜmLBÙ
[0] = 
ŒªsfÜmLTİ
[0];

223 
ŒªsfÜmLBÙ
[7] = 
ŒªsfÜmLTİ
[7];

225 
ŒªsfÜmRBÙ
[0] = 
ŒªsfÜmRTİ
[0];

226 
ŒªsfÜmRBÙ
[7] = 
ŒªsfÜmRTİ
[7];

229 
ŒªsfÜmHB
[2] = 
pi2AboutX
;

231 
ŒªsfÜmRAB
[0] = 
ü—‹DHM©rix
<>(0, 0, 
Limbs
::
Should”Off£tZ
, 0);

232 
ŒªsfÜmRAB
[1] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 
Limbs
::
Should”Off£tY
, 0);

233 
ŒªsfÜmRAB
[3] = 
pi2AboutX
;

234 
ŒªsfÜmRAB
[5] = 
ü—‹DHM©rix
<>(
Limbs
::
Uµ”ArmL’gth
, 
M_PI
 / 2,

235 
Limbs
::
ElbowOff£tY
, 
M_PI
 / 2);

236 
ŒªsfÜmRAB
[7] = 
Ãgpi2AboutXÃgpi2AboutZ
;

237 
ŒªsfÜmRAB
[8] = 
Ãgpi2AboutX
;

238 
ŒªsfÜmRAB
[10] = 
ü—‹DHM©rix
<>(
Limbs
::
Low”ArmL’gth
, 
M_PI
 / 2, 0, M_PI / 2);

239 
ŒªsfÜmRAB
[12] = 
Ãgpi2AboutXÃgpi2AboutZ
;

240 
ŒªsfÜmRAB
[13] = 
Ãgpi2AboutX
;

242 
ŒªsfÜmLAB
[0] = 
ŒªsfÜmRAB
[0];

243 
ŒªsfÜmLAB
[1] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, -
Limbs
::
Should”Off£tY
, 0);

244 
ŒªsfÜmLAB
[3] = 
ŒªsfÜmRAB
[3];

245 
ŒªsfÜmLAB
[5] = 
ü—‹DHM©rix
<>(
Limbs
::
Uµ”ArmL’gth
, 
M_PI
 / 2,

246 -
Limbs
::
ElbowOff£tY
, 
M_PI
 / 2);

247 
ŒªsfÜmLAB
[7] = 
ŒªsfÜmRAB
[7];

248 
ŒªsfÜmLAB
[8] = 
ŒªsfÜmRAB
[8];

249 
ŒªsfÜmLAB
[10] = 
ŒªsfÜmRAB
[10];

250 
ŒªsfÜmLAB
[12] = 
ŒªsfÜmRAB
[12];

251 
ŒªsfÜmLAB
[13] = 
ŒªsfÜmRAB
[13];

253 
ŒªsfÜmRFB
[0] = 
ü—‹DHM©rix
<>(0, 0, -
Limbs
::
HOff£tZ
, 0);

254 
ŒªsfÜmRFB
[1] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 
Limbs
::
HOff£tY
, 0);

255 
ŒªsfÜmRFB
[3] = 
pi4AboutX
;

256 
ŒªsfÜmRFB
[4] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, -M_PI / 2);

257 
ŒªsfÜmRFB
[6] = 
pi2AboutXpi2AboutZ
;

258 
ŒªsfÜmRFB
[7] = 
Ãgpi2AboutX
;

259 
ŒªsfÜmRFB
[9] = 
pi2AboutX
;

260 
ŒªsfÜmRFB
[10] = 
ü—‹DHM©rix
<>(0, 0, -
Limbs
::
ThighL’gth
, 0);

261 
ŒªsfÜmRFB
[12] = 
pi2AboutX
;

262 
ŒªsfÜmRFB
[13] = 
ü—‹DHM©rix
<>(0, 0, -
Limbs
::
TibŸL’gth
, 0);

263 
ŒªsfÜmRFB
[15] = 
pi2AboutX
;

264 
ŒªsfÜmRFB
[16] = 
ü—‹DHM©rix
<>(0, 0, 0, -
M_PI
 / 2);

265 
ŒªsfÜmRFB
[18] = 
pi2AboutXpi2AboutZ
;

267 
ŒªsfÜmLFB
[0] = 
ŒªsfÜmRFB
[0];

268 
ŒªsfÜmLFB
[1] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, -
Limbs
::
HOff£tY
, 0);

269 
ŒªsfÜmLFB
[3] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 4, 0, 0);

270 
ŒªsfÜmLFB
[4] = 
ŒªsfÜmRFB
[4];

271 
ŒªsfÜmLFB
[6] = 
ŒªsfÜmRFB
[6];

272 
ŒªsfÜmLFB
[7] = 
ŒªsfÜmRFB
[7];

273 
ŒªsfÜmLFB
[9] = 
ŒªsfÜmRFB
[9];

274 
ŒªsfÜmLFB
[10] = 
ŒªsfÜmRFB
[10];

275 
ŒªsfÜmLFB
[12] = 
ŒªsfÜmRFB
[12];

276 
ŒªsfÜmLFB
[13] = 
ŒªsfÜmRFB
[13];

277 
ŒªsfÜmLFB
[15] = 
ŒªsfÜmRFB
[15];

278 
ŒªsfÜmLFB
[16] = 
ŒªsfÜmRFB
[16];

279 
ŒªsfÜmLFB
[18] = 
ŒªsfÜmRFB
[18];

281 
	}
}

283 
	gKšem©ics
::
Chaš


284 
Kšem©ics
::
	$d‘”mšeSuµÜtChaš
() {

285 
lsum
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
] +

286 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
] +

287 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rLeá
] +

288 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rRight
];

289 
rsum
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
] +

290 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
] +

291 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rLeá
] +

292 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rRight
];

293 ià(
lsum
 > 
rsum
è 
LEFT_CHAIN
;

294  
RIGHT_CHAIN
;

295 
	}
}

297 
	gKšem©ics
::
	$upd©eDHChaš
() {

299 
coff£tY
, 
coff£tX
, 
coff£tZ
;

301 
JoštV®ues
 
joštV®ues
 = 
£nsÜV®ues
.
jošts
;

304 
coff£tY
 = 
	`DEG2RAD
(
·¿m‘”s
.
ÿm”aP™chTİ
);

305 
coff£tX
 = 
	`DEG2RAD
(
·¿m‘”s
.
ÿm”aYawTİ
);

306 
coff£tZ
 = 
	`DEG2RAD
(
·¿m‘”s
.
ÿm”aRŞlTİ
);

308 
Cp
 = 
joštV®ues
.
ªgËs
[
Jošts
::
H—dP™ch
];

309 
Cy
 = 
joštV®ues
.
ªgËs
[
Jošts
::
H—dYaw
];

310 
Hyp
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LHYawP™ch
];

311 
HpL
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LHP™ch
];

312 
HrL
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LHRŞl
];

313 
KpL
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LKÃeP™ch
];

314 
ApL
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LAnkËP™ch
];

315 
ArL
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LAnkËRŞl
];

317 
ÿm”aPªInv”£Hack
 = 
ü—‹DHM©rix
<>(0, 0, 
d2
, 0.0);

322 
ŒªsfÜmLTİ
[1] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, M_PI / 2 - 
ArL
);

323 
ŒªsfÜmLTİ
[2] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, -
ApL
);

324 
ŒªsfÜmLTİ
[3] = 
ü—‹DHM©rix
<>(
Limbs
::
TibŸL’gth
, 0, 0, -
KpL
);

325 
ŒªsfÜmLTİ
[4] = 
ü—‹DHM©rix
<>(
Limbs
::
ThighL’gth
, 0, 0, -
HpL
);

326 
ŒªsfÜmLTİ
[5] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, -M_PI / 4 - 
HrL
);

327 
ŒªsfÜmLTİ
[6] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, -
d3
, M_PI / 2 - 
Hyp
);

329 
ŒªsfÜmLTİ
[8] = 
ü—‹DHM©rix
<>(0, 0, 
d2
, 
Cy
);

330 
ŒªsfÜmLTİ
[9] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
a3Tİ
 + 
Cp
);

331 
ŒªsfÜmLTİ
[10] = 
ü—‹DHM©rix
<>(0, -
M_PI
/2, 
l10Tİ
, M_PI / 2 + 
coff£tX
);

332 
ŒªsfÜmLTİ
[11] = 
ü—‹DHM©rix
<>(0, -
M_PI
/2 + 
coff£tY
, 
d11Tİ
, 
coff£tZ
);

335 
HpR
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RHP™ch
];

336 
HrR
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RHRŞl
];

337 
KpR
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RKÃeP™ch
];

338 
ApR
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RAnkËP™ch
];

339 
ArR
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RAnkËRŞl
];

345 
ŒªsfÜmRTİ
[1] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, M_PI / 2 - 
ArR
);

346 
ŒªsfÜmRTİ
[2] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, -
ApR
);

347 
ŒªsfÜmRTİ
[3] = 
ü—‹DHM©rix
<>(
Limbs
::
TibŸL’gth
, 0, 0, -
KpR
);

348 
ŒªsfÜmRTİ
[4] = 
ü—‹DHM©rix
<>(
Limbs
::
ThighL’gth
, 0, 0, -
HpR
);

349 
ŒªsfÜmRTİ
[5] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, M_PI / 4 - 
HrR
);

350 
ŒªsfÜmRTİ
[6] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 
d3
, M_PI / 2 - 
Hyp
);

352 
ŒªsfÜmRTİ
[8] = 
ŒªsfÜmLTİ
[8];

353 
ŒªsfÜmRTİ
[9] = 
ŒªsfÜmLTİ
[9];

354 
ŒªsfÜmRTİ
[10] = 
ŒªsfÜmLTİ
[10];

355 
ŒªsfÜmRTİ
[11] = 
ŒªsfÜmLTİ
[11];

358 
coff£tY
 = 
	`DEG2RAD
(
·¿m‘”s
.
ÿm”aP™chBÙtom
);

359 
coff£tX
 = 
	`DEG2RAD
(
·¿m‘”s
.
ÿm”aYawBÙtom
);

360 
coff£tZ
 = 
	`DEG2RAD
(
·¿m‘”s
.
ÿm”aRŞlBÙtom
);

363 
ŒªsfÜmLBÙ
[1] = 
ŒªsfÜmLTİ
[1];

364 
ŒªsfÜmLBÙ
[2] = 
ŒªsfÜmLTİ
[2];

365 
ŒªsfÜmLBÙ
[3] = 
ŒªsfÜmLTİ
[3];

366 
ŒªsfÜmLBÙ
[4] = 
ŒªsfÜmLTİ
[4];

367 
ŒªsfÜmLBÙ
[5] = 
ŒªsfÜmLTİ
[5];

368 
ŒªsfÜmLBÙ
[6] = 
ŒªsfÜmLTİ
[6];

370 
ŒªsfÜmLBÙ
[8] = 
ŒªsfÜmLTİ
[8];

371 
ŒªsfÜmLBÙ
[9] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
a3BÙ
 + 
Cp
);

372 
ŒªsfÜmLBÙ
[10] = 
ü—‹DHM©rix
<>(0, -
M_PI
/2, 
l10BÙ
, M_PI / 2 + 
coff£tX
);

373 
ŒªsfÜmLBÙ
[11] = 
ü—‹DHM©rix
<>(0, -
M_PI
/2 + 
coff£tY
, 
d11BÙ
, 
coff£tZ
);

377 
ŒªsfÜmRBÙ
[1] = 
ŒªsfÜmRTİ
[1];

378 
ŒªsfÜmRBÙ
[2] = 
ŒªsfÜmRTİ
[2];

379 
ŒªsfÜmRBÙ
[3] = 
ŒªsfÜmRTİ
[3];

380 
ŒªsfÜmRBÙ
[4] = 
ŒªsfÜmRTİ
[4];

381 
ŒªsfÜmRBÙ
[5] = 
ŒªsfÜmRTİ
[5];

382 
ŒªsfÜmRBÙ
[6] = 
ŒªsfÜmRTİ
[6];

384 
ŒªsfÜmRBÙ
[8] = 
ŒªsfÜmRTİ
[8];

385 
ŒªsfÜmRBÙ
[9] = 
ŒªsfÜmLBÙ
[9];

386 
ŒªsfÜmRBÙ
[10] = 
ŒªsfÜmLBÙ
[10];

387 
ŒªsfÜmRBÙ
[11] = 
ŒªsfÜmLBÙ
[11];

391 
ŒªsfÜmHB
[0] = 
ü—‹DHM©rix
<>(0, 0, 
Limbs
::
NeckOff£tZ
, 
Cy
);

392 
ŒªsfÜmHB
[1] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
Cp
);

398 
Sp
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RShould”P™ch
];

399 
Sr
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RShould”RŞl
];

400 
Ey
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RElbowYaw
];

401 
Er
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RElbowRŞl
];

402 
Wy
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RWri¡Yaw
];

405 
ŒªsfÜmRAB
[2] = 
ü—‹DHM©rix
<>(0, -
M_PI
, 0, 
Sp
);

407 
ŒªsfÜmRAB
[4] = 
ü—‹DHM©rix
<>(0, 0, 0, 
Sr
);

410 
ŒªsfÜmRAB
[6] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, 
Ey
);

413 
ŒªsfÜmRAB
[9] = 
ü—‹DHM©rix
<>(0, 0, 0, 
Er
);

415 
ŒªsfÜmRAB
[11] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, 
Wy
);

420 
Sp
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LShould”P™ch
];

421 
Sr
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LShould”RŞl
];

422 
Ey
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LElbowYaw
];

423 
Er
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LElbowRŞl
];

424 
Wy
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LWri¡Yaw
];

427 
ŒªsfÜmLAB
[2] = 
ü—‹DHM©rix
<>(0, -
M_PI
, 0, 
Sp
);

429 
ŒªsfÜmLAB
[4] = 
ü—‹DHM©rix
<>(0, 0, 0, 
Sr
);

432 
ŒªsfÜmLAB
[6] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, 
Ey
);

435 
ŒªsfÜmLAB
[9] = 
ü—‹DHM©rix
<>(0, 0, 0, 
Er
);

437 
ŒªsfÜmLAB
[11] = 
ü—‹DHM©rix
<>(0, 
M_PI
 / 2, 0, 
Wy
);

442 
HpR
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RHP™ch
];

443 
HrR
 = 
joštV®ues
.
ªgËs
[
Jošts
::
RHRŞl
];

446 
ŒªsfÜmRFB
[2] = 
ü—‹DHM©rix
<>(0, -3 * 
M_PI
 / 4, 0, 
Hyp
);

449 
ŒªsfÜmRFB
[5] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
HrR
);

452 
ŒªsfÜmRFB
[8] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
HpR
);

455 
ŒªsfÜmRFB
[11] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
KpR
);

458 
ŒªsfÜmRFB
[14] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
ApR
);

461 
ŒªsfÜmRFB
[17] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
ArR
);

465 
HpL
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LHP™ch
];

466 
HrL
 = 
joštV®ues
.
ªgËs
[
Jošts
::
LHRŞl
];

469 
ŒªsfÜmLFB
[2] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 4, 0, -
Hyp
);

472 
ŒªsfÜmLFB
[5] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
HrL
);

475 
ŒªsfÜmLFB
[8] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
HpL
);

478 
ŒªsfÜmLFB
[11] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
KpL
);

481 
ŒªsfÜmLFB
[14] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
ApL
);

484 
ŒªsfÜmLFB
[17] = 
ü—‹DHM©rix
<>(0, -
M_PI
 / 2, 0, 
ArL
);

486 
	}
}

488 
Po£
 
	gKšem©ics
::
	$g‘Po£
() {

489 
Chaš
 
foÙ
 = 
	`d‘”mšeSuµÜtChaš
();

491 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
c2wTİ
 = 
	`ü—‹Cam”aToWÜldT¿nsfÜm
(
foÙ
, 
Œue
);

492 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
c2wBÙ
 = 
	`ü—‹Cam”aToWÜldT¿nsfÜm
(
foÙ
, 
çl£
);

493 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
n2w
 = 
	`ü—‹NeckToWÜldT¿nsfÜm
(
foÙ
);

494 
¡d
::
·œ
<, > 
hÜizÚ
 = 
	`ÿlcuÏ‹HÜizÚ
(
c2wTİ
);

495 
Po£
 
	`po£
(
c2wTİ
, 
c2wBÙ
, 
n2w
, 
hÜizÚ
);

497 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2cTİ
 =

498 
	`ev®u©eDHChaš
(
BODY
, 
CAMERA
, 
foÙ
, 
Œue
);

499 
	`d‘”mšeBodyExşusiÚA¼ay
(
b2cTİ
, 
po£
.
	`g‘TİExşusiÚA¼ay
(), 
Œue
);

501 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2cBÙ
 =

502 
	`ev®u©eDHChaš
(
BODY
, 
CAMERA
, 
foÙ
, 
çl£
);

503 
	`d‘”mšeBodyExşusiÚA¼ay
(
b2cBÙ
, 
po£
.
	`g‘BÙExşusiÚA¼ay
(), 
çl£
);

505  
po£
;

506 
	}
}

508 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

509 
Kšem©ics
::
	$ü—‹Cam”aToWÜldT¿nsfÜm
(
Chaš
 
foÙ
, 
boŞ
 
tİ
) {

510 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
c2f
 = 
	`ü—‹Cam”aToFoÙT¿nsfÜm
(
foÙ
,
tİ
);

511 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
f2w
 = 
	`ü—‹FoÙToWÜldT¿nsfÜm
(
foÙ
,
tİ
);

512  
	`´od
(
f2w
, 
c2f
);

513 
	}
}

515 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

516 
Kšem©ics
::
	$ü—‹NeckToWÜldT¿nsfÜm
(
Chaš
 
foÙ
) {

517 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
n2f
 = 
	`ü—‹NeckToFoÙT¿nsfÜm
(
foÙ
);

518 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
f2w
 = 
	`ü—‹FoÙToWÜldT¿nsfÜm
(
foÙ
);

519  
	`´od
(
f2w
, 
n2f
);

520 
	}
}

522 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

523 
Kšem©ics
::
	$ev®u©eDHChaš
(
Lšk
 
äom
, Lšk 
to
, 
Chaš
 
foÙ
, 
boŞ
 
tİ
) {

524 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
fš®T¿nsfÜm
 =

525 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

526 ià(
foÙ
 =ğ
RIGHT_CHAIN
) {

527 ià(
tİ
) {

528 
i
 = 
äom
; i < 
to
; i++) {

529 
fš®T¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
	`´od
(finalTransform,

530 
ŒªsfÜmRTİ
[
i
]);

533 
i
 = 
äom
; i < 
to
; i++) {

534 
fš®T¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
	`´od
(finalTransform,

535 
ŒªsfÜmRBÙ
[
i
]);

539 ià(
tİ
) {

540 
i
 = 
äom
; i < 
to
; i++) {

541 
fš®T¿nsfÜm
 =

542 
boo¡
::
num”ic
::
ubÏs
::
	`´od
(
fš®T¿nsfÜm
, 
ŒªsfÜmLTİ
[
i
]);

545 
i
 = 
äom
; i < 
to
; i++) {

546 
fš®T¿nsfÜm
 =

547 
boo¡
::
num”ic
::
ubÏs
::
	`´od
(
fš®T¿nsfÜm
, 
ŒªsfÜmLBÙ
[
i
]);

551  
fš®T¿nsfÜm
;

552 
	}
}

555 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

556 
Kšem©ics
::
	$ev®u©eMassChaš
() {

557 
i
, 
jošt
 = 0;

558 
tÙ®Mass
 = 0;

559 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`fš®T¿nsfÜm
(4, 1);

560 
fš®T¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
z”o_m©rix
<>(4, 1);

563 
fš®T¿nsfÜm
 +ğ
mas£sCom
[
jošt
] * 
mas£s
[joint];

564 
tÙ®Mass
 +ğ
mas£s
[
jošt
];

565 ++
jošt
;

568 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
h—dT¿nsfÜm
 = boo¡::num”ic::ubÏs::
id’t™y_m©rix
<>(4);

569 
i
 = 0; i < 
HEAD_DH_CHAIN_LEN
; ++i) {

570 
h—dT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
	`´od
(h—dT¿nsfÜm, 
ŒªsfÜmHB
[
i
]);

572 ià(
i
 == 0 || i == 2) {

573 
fš®T¿nsfÜm
 +ğ
boo¡
::
num”ic
::
ubÏs
::
	`´od
(
h—dT¿nsfÜm
, 
mas£sCom
[
jošt
]è* 
mas£s
[joint];

574 
tÙ®Mass
 +ğ
mas£s
[
jošt
];

575 ++
jošt
;

580 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
rArmT¿nsfÜm
 = boo¡::num”ic::ubÏs::
id’t™y_m©rix
<>(4);

581 
i
 = 0; i < 
ARM_DH_CHAIN_LEN
; ++i) {

582 
rArmT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
	`´od
ÔArmT¿nsfÜm, 
ŒªsfÜmRAB
[
i
]);

584 ià(
i
 == 3 || i == 4 || i == 8 || i == 9 || i == 13) {

585 
fš®T¿nsfÜm
 +ğ
boo¡
::
num”ic
::
ubÏs
::
	`´od
(
rArmT¿nsfÜm
, 
mas£sCom
[
jošt
]è* 
mas£s
[joint];

586 
tÙ®Mass
 +ğ
mas£s
[
jošt
];

587 ++
jošt
;

592 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
lArmT¿nsfÜm
 = boo¡::num”ic::ubÏs::
id’t™y_m©rix
<>(4);

593 
i
 = 0; i < 
ARM_DH_CHAIN_LEN
; ++i) {

595 
lArmT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
	`´od
ÖArmT¿nsfÜm, 
ŒªsfÜmLAB
[
i
]);

596 ià(
i
 == 3 || i == 4 || i == 8 || i == 9 || i == 13) {

597 
fš®T¿nsfÜm
 +ğ
boo¡
::
num”ic
::
ubÏs
::
	`´od
(
lArmT¿nsfÜm
, 
mas£sCom
[
jošt
]è* 
mas£s
[joint];

598 
tÙ®Mass
 +ğ
mas£s
[
jošt
];

599 ++
jošt
;

604 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
rLegT¿nsfÜm
 = boo¡::num”ic::ubÏs::
id’t™y_m©rix
<>(4);

605 
i
 = 0; i < 
LEG_DH_CHAIN_LEN
; ++i) {

606 
rLegT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
	`´od
ÔLegT¿nsfÜm, 
ŒªsfÜmRFB
[
i
]);

608 ià(
i
 == 3 || i == 7 || i == 9 || i == 12 || i == 15 || i == 18) {

609 
fš®T¿nsfÜm
 +ğ
boo¡
::
num”ic
::
ubÏs
::
	`´od
(
rLegT¿nsfÜm
, 
mas£sCom
[
jošt
]è* 
mas£s
[joint];

610 
tÙ®Mass
 +ğ
mas£s
[
jošt
];

611 ++
jošt
;

616 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
lLegT¿nsfÜm
 = boo¡::num”ic::ubÏs::
id’t™y_m©rix
<>(4);

617 
i
 = 0; i < 
LEG_DH_CHAIN_LEN
; ++i) {

618 
lLegT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
	`´od
ÖLegT¿nsfÜm, 
ŒªsfÜmLFB
[
i
]);

620 ià(
i
 == 3 || i == 7 || i == 9 || i == 12 || i == 15 || i == 18) {

621 
fš®T¿nsfÜm
 +ğ
boo¡
::
num”ic
::
ubÏs
::
	`´od
(
lLegT¿nsfÜm
, 
mas£sCom
[
jošt
]è* 
mas£s
[joint];

622 
tÙ®Mass
 +ğ
mas£s
[
jošt
];

623 ++
jošt
;

627  
fš®T¿nsfÜm
 / 
tÙ®Mass
;

628 
	}
}

630 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

631 
Kšem©ics
::
	$ü—‹Cam”aToFoÙT¿nsfÜm
(
Chaš
 
foÙ
, 
boŞ
 
tİ
) {

632 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2f
 = 
	`ev®u©eDHChaš
(
FOOT
, 
BODY
, 
foÙ
, 
tİ
);

637 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`z
(4, 1);

638 
	`z
(0, 0) = 0;

639 
	`z
(1, 0) = 0;

640 
	`z
(2, 0) = 0;

641 
	`z
(3, 0) = 1;

642 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
hPt
 = 
	`´od
(
b2f
, 
z
);

643 
bodyP™chOff£t
 = 
	`DEG2RAD
(
·¿m‘”s
.
bodyP™ch
);

644 
fÜw¬dL—n
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
];

645 
sideL—n
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
];

647 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜm
 = 
ü—‹DHM©rix
<>(
	`hPt
(0, 0), 0, 0, 0);

648 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(0, 0, 
	`hPt
(2, 0), 
M_PI
 / 2));

649 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(
	`hPt
(1, 0), 0, 0, 0));

650 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(0, 
fÜw¬dL—n
 + 
bodyP™chOff£t
, 0, -
M_PI
 / 2));

651 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(0, 
sideL—n
, 0, 0));

653  
	`´od
(
ŒªsfÜm
, 
	`ev®u©eDHChaš
(
BODY
, 
CAMERA
, 
foÙ
, 
tİ
));

654 
	}
}

656 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

657 
Kšem©ics
::
	$ü—‹NeckToFoÙT¿nsfÜm
(
Chaš
 
foÙ
) {

658 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2f
 = 
	`ev®u©eDHChaš
(
FOOT
, 
BODY
, 
foÙ
);

663 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`z
(4, 1);

664 
	`z
(0, 0) = 0;

665 
	`z
(1, 0) = 0;

666 
	`z
(2, 0) = 0;

667 
	`z
(3, 0) = 1;

668 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
hPt
 = 
	`´od
(
b2f
, 
z
);

669 
bodyP™chOff£t
 = 
	`DEG2RAD
(
·¿m‘”s
.
bodyP™ch
);

670 
fÜw¬dL—n
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
];

671 
sideL—n
 = 
£nsÜV®ues
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
];

673 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜm
 = 
ü—‹DHM©rix
<>(
	`hPt
(0, 0), 0, 0, 0);

674 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(0, 0, 
	`hPt
(2, 0), 
M_PI
 / 2));

675 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(
	`hPt
(1, 0), 0, 0, 0));

676 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(0, 
fÜw¬dL—n
 + 
bodyP™chOff£t
, 0, -
M_PI
 / 2));

677 
ŒªsfÜm
 = 
	`´od
Ñ¿nsfÜm, 
ü—‹DHM©rix
<>(0, 
sideL—n
, 0, 0));

679  
	`´od
(
ŒªsfÜm
, 
ÿm”aPªInv”£Hack
);

680 
	}
}

684 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

685 
Kšem©ics
::
	$ü—‹FoÙToWÜldT¿nsfÜm
(
Chaš
 
foÙ
, 
boŞ
 
tİ
) {

686 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2lf
 =

687 
	`ev®u©eDHChaš
(
FOOT
, 
BODY
, 
foÙ
, 
tİ
);

688 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2rf
 =

689 
	`ev®u©eDHChaš
(
FOOT
, 
BODY
, (
Chaš
è!
foÙ
, 
tİ
);

691 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`rf2b
(4, 4);

692 
	`šv”tM©rix
(
b2rf
, 
rf2b
);

694 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`rf2lf
(4, 4);

695 
rf2lf
 = 
	`´od
(
rf2b
, 
b2lf
);

697 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`z
(4, 1);

698 
	`z
(0, 0) = 0;

699 
	`z
(1, 0) = 0;

700 
	`z
(2, 0) = 0;

701 
	`z
(3, 0) = 1;

702 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`fÜw¬d
(4, 1);

703 
	`fÜw¬d
(0, 0) = 1;

704 
	`fÜw¬d
(1, 0) = 0;

705 
	`fÜw¬d
(2, 0) = 0;

706 
	`fÜw¬d
(3, 0) = 1;

709 
z
 = 
	`´od
(
rf2lf
, z);

712 
fÜw¬d
 = 
	`´od
(
rf2lf
, fÜw¬dè- 
z
;

714 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pos™iÚ
 = -
z
 / 2;

715 
	`pos™iÚ
(3, 0) = 1;

716 
	`pos™iÚ
(2, 0) = 0;

718 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
»suÉ
 =

719 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

720 
»suÉ
 = 
	`´od
(
Œª¦©eM©rix
<>(
	`pos™iÚ
(0, 0),…osition(1, 0), 0),

721 
»suÉ
);

724 
»suÉ
 = 
	`´od
(
rÙ©eZM©rix
<>(-
	`©ª2f
(
	`fÜw¬d
(1, 0), forward(0, 0)) / 2.0),

725 
»suÉ
);

726  
»suÉ
;

727 
	}
}

729 
	gKšem©ics
::
	$£tS’sÜV®ues
(
S’sÜV®ues
 
£nsÜV®ues
) {

730 
this
->
£nsÜV®ues
 = sensorValues;

731 
	}
}

733 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

734 
Kšem©ics
::
ü—‹WÜldToFOVT¿nsfÜm
(

735 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
c2w
) {

736 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
w2c
 = 
c2w
;

738 
šv”tM©rix
(
c2w
, 
w2c
);

740 
	gex
 = 0;

741 
	gey
 = 0;

742 
	gez
 = 1.0 / 
n
(
IMAGE_HFOV
 / 2);

744 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
´ojeùiÚ
 = 
´ojeùiÚM©rix
(
ex
, 
ey
, 
ez
);

745 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜm
 =

746 
boo¡
::
num”ic
::
ubÏs
::
´od
(
´ojeùiÚ
, 
w2c
);

748  
	gŒªsfÜm
;

751 
	gKšem©ics
::
d‘”mšeBodyExşusiÚA¼ay
(

752 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
m
,

753 
št16_t
 *
pošts
, 
boŞ
 
tİ
) {

755 cÚ¡ 
	gCOLS
 = (
tİ
è? 
TOP_IMAGE_COLS
 : 
BOT_IMAGE_COLS
;

757 
	gi
 = 0; i < 
	gPo£
::
EXCLUSION_RESOLUTION
; i++) {

758 
	gpošts
[
i
] = 
TOP_IMAGE_ROWS
;

759 ià(!
	gtİ
è
	gpošts
[
i
] +ğ
BOT_IMAGE_ROWS
;

762 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜm


763 ğ
ü—‹WÜldToFOVT¿nsfÜm
(
m
);

765 
	g·¹
 = 0;…¬ˆ< 
	gbodyP¬ts
.
size
();…art++) {

766 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
Ï¡
 =

767 
fovToImageS·ûT¿nsfÜm
(
ŒªsfÜm
,

768 
bodyP¬ts
[
·¹
][0],

769 
tİ
);

770 
	gi
 = 0; i < 
	gbodyP¬ts
[
·¹
].
size
(); i++) {

771 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
m


772 ğ
fovToImageS·ûT¿nsfÜm
(
ŒªsfÜm
,

773 
bodyP¬ts
[
·¹
][
i
],

774 
tİ
);

775 ià(
m
(2, 0) <= 0) {

776 
Ï¡
 = 
m
;

782 
	glIndex
 = ()(
Ï¡
(0, 0è/ 
COLS
 *

783 
	gPo£
::
EXCLUSION_RESOLUTION
);

784 
	gcIndex
 = ()(
m
(0, 0è/ 
COLS
 *

785 
	gPo£
::
EXCLUSION_RESOLUTION
);

786 
	glPix–
 = 
Ï¡
(1, 0);

787 
	gcPix–
 = 
m
(1, 0);

789 
	gg¿d›Á
 = 0;

790 ià(
	gcIndex
 - 
	glIndex
 != 0) {

791 
d’om
 = 
cIndex
 - 
lIndex
;

792 
	gg¿d›Á
 = (
cPix–
 - 
lPix–
è/ (
d’om
);

794 
	gcIndex
 = 
MIN
(
MAX
(
cIndex
, 0), (è
Po£
::
EXCLUSION_RESOLUTION
);

795 
	glIndex
 = 
MIN
(
MAX
(
lIndex
, 0), (è
Po£
::
EXCLUSION_RESOLUTION
);

796 
	gšdex
 = 
lIndex
;

797 
	gšdex
 !ğ
cIndex
 && 
Ï¡
(2, 0) > 0) {

798 ià(
	gšdex
 >ğ0 && 
šdex
 < 
Po£
::
EXCLUSION_RESOLUTION
 &&

799 
šdex
 !ğ
cIndex
) {

800 
nPix–
 = 
Ï¡
(1, 0è+ 
	gg¿d›Á
 * (
	gšdex
 - 
	glIndex
);

801 ià(
	gnPix–
 < 
	gpošts
[
šdex
]èpošts[šdex] = 
nPix–
;

803 
	gšdex
 +ğ(
cIndex
 - 
lIndex
) > 0 ? 1 : -1;

808 
	gšdex
 = ()(
m
(0, 0è/ 
COLS
 *

809 
	gPo£
::
EXCLUSION_RESOLUTION
);

810 ià(
	gšdex
 >ğ0 && 
šdex
 < 
Po£
::
EXCLUSION_RESOLUTION
) {

811 ià(
m
(1, 0è< 
pošts
[
šdex
]) {

812 
pošts
[
šdex
] = 
m
(1, 0);

815 
	gÏ¡
 = 
m
;

820 
	g¡d
::
·œ
<, > 
	gKšem©ics
::
ÿlcuÏ‹HÜizÚ
(

821 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
c2w
) {

822 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜm
 = 
ü—‹WÜldToFOVT¿nsfÜm
(
c2w
);

829 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pix–1
 = 
vec4
<>(-1000, 
	gINT_MAX
,

831 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pix–2
 = 
vec4
<>(1000, 
	gINT_MAX
,

834 
	gpix–1
 = 
fovToImageS·ûT¿nsfÜm
(
ŒªsfÜm
, 
pix–1
, 
Œue
);

835 
	gpix–2
 = 
fovToImageS·ûT¿nsfÜm
(
ŒªsfÜm
, 
pix–2
, 
Œue
);

838 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
dœ
 = 
pix–1
 - 
pix–2
;

842 
	gÏmbda1
 = -
pix–1
(0, 0è/ 
dœ
(0, 0);

843 
	gÏmbda2
 = (
TOP_IMAGE_COLS
 - 
pix–1
(0, 0)è/ 
dœ
(0, 0);

845 
	gy1
 = 
Ïmbda1
 * 
dœ
(1, 0è+ 
pix–1
(1, 0);

846 
	gy2
 = 
Ïmbda2
 * 
dœ
(1, 0è+ 
pix–1
(1, 0);

848  
	g¡d
::
·œ
<, >(
	gy1
, 
	gy2
);

851 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

852 
Kšem©ics
::
fovToImageS·ûT¿nsfÜm
(

853 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
ŒªsfÜm
,

854 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
pošt
, 
boŞ
 
tİ
) {

857 cÚ¡ 
	gCOLS
 = (
tİ
è? 
TOP_IMAGE_COLS
 : 
BOT_IMAGE_COLS
;

858 cÚ¡ 
	gROWS
 = (
tİ
è? 
TOP_IMAGE_ROWS
 : 
BOT_IMAGE_ROWS
;

861 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pix–
 =

862 
boo¡
::
num”ic
::
ubÏs
::
´od
(
ŒªsfÜm
, 
pošt
);

865 
pix–
(0, 0) /=…ixel(3, 0);

866 
pix–
(1, 0) /=…ixel(3, 0);

867 
pix–
(2, 0) =…ixel(3, 0);

868 
pix–
(3, 0) = 1;

875 
	gxsÿË
 = 
COLS
 / 2;

876 
	gysÿË
 = 
ROWS
 / 2;

877 
pix–
(0, 0èğÕix–(0, 0)è* 
	gxsÿË
 + xscale;

878 
pix–
(1, 0èğÕix–(1, 0)è* 
	gxsÿË
 + 
	gysÿË
;

879  
	gpix–
;

	@robot/perception/kinematics/Kinematics.hpp

31 #´agm¨
Úû


33 
	~<ut™y
>

34 
	~<veùÜ
>

36 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

37 
	~<boo¡/num”ic/ubÏs/io.hµ
>

38 
	~<boo¡/num”ic/ubÏs/lu.hµ
>

40 
	~<³rû±iÚ/kšem©ics/P¬am‘”s.hµ
>

41 
	~<³rû±iÚ/kšem©ics/Po£.hµ
>

42 
	~<³rû±iÚ/visiÚ/ÿm”a/Cam”a.hµ
>

44 
	~<uts/m©rix_h–³rs.hµ
>

45 
	~<ty³s/RRCoÜd.hµ
>

46 
	~<ty³s/JoštV®ues.hµ
>

47 
	~<ty³s/S’sÜV®ues.hµ
>

49 
	~"CKF.hµ
"

51 
	#CAMERA_DH_CHAIN_LEN
 12

	)

52 
	#HEAD_DH_CHAIN_LEN
 3

	)

53 
	#ARM_DH_CHAIN_LEN
 14

	)

54 
	#LEG_DH_CHAIN_LEN
 19

	)

56 şas 
	cKšem©ics
 {

57 
	mpublic
:

58 
ä›nd
 
şass
 
Kšem©icsAd­‹r
;

59 
ä›nd
 
şass
 
	mKšem©icsC®ib¿tiÚSkl
;

60 
ä›nd
 
şass
 
	mCam”aPo£Tab
;

61 
Kšem©ics
();

63 
	eLšk
 {

64 
	mFOOT
 = 0,

65 
	mBODY
 = 8,

66 
	mCAMERA
 = 12,

67 
	mNECK
 = 9

70 
	eChaš
 {

71 
	gLEFT_CHAIN
 = 0,

72 
	gRIGHT_CHAIN
 = 1

76 
Po£
 
g‘Po£
();

78 
upd©eDHChaš
();

80 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

81 
ev®u©eDHChaš
(
Lšk
 
äom
, Lšk 
to
, 
Chaš
 
foÙ
, 
boŞ
 
tİ
 = 
Œue
);

83 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ev®u©eMassChaš
();

85 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

86 
ü—‹BodyToFoÙOnGroundT¿nsfÜm
(
Chaš
 
foÙ
, 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
b2f
);

88 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

89 
ü—‹Cam”aToFoÙT¿nsfÜm
(
Chaš
 
foÙ
, 
boŞ
 
tİ
);

91 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

92 
ü—‹NeckToFoÙT¿nsfÜm
(
Chaš
 
foÙ
);

94 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

95 
ü—‹FoÙToWÜldT¿nsfÜm
(
Chaš
 
foÙ
, 
boŞ
 
tİ
 = 
Œue
);

97 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

98 
ü—‹Cam”aToWÜldT¿nsfÜm
(
Chaš
 
foÙ
, 
boŞ
 
tİ
);

100 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

101 
ü—‹NeckToWÜldT¿nsfÜm
(
Chaš
 
foÙ
);

103 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

104 
ü—‹WÜldToFOVT¿nsfÜm
(

105 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
m
);

107 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

108 
fovToImageS·ûT¿nsfÜm
(

109 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
ŒªsfÜm
,

110 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
pošt
, 
boŞ
 
tİ
);

112 
d‘”mšeBodyExşusiÚA¼ay
(

113 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
m
,

114 
št16_t
 *
pošts
, 
boŞ
 
tİ
);

116 
Chaš
 
d‘”mšeSuµÜtChaš
();

118 
£tS’sÜV®ues
(
S’sÜV®ues
 
£nsÜV®ues
);

120 
	g¡d
::
·œ
<, > 
ÿlcuÏ‹HÜizÚ
(

121 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> &
m
);

124 
	gP¬am‘”s
<> 
	g·¿m‘”s
;

126 
	g´iv©e
:

129 
S’sÜV®ues
 
£nsÜV®ues
;

130 
Chaš
 
	gsuµÜtChaš
;

132 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmLTİ
[
CAMERA_DH_CHAIN_LEN
];

133 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmLBÙ
[
CAMERA_DH_CHAIN_LEN
];

134 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmRTİ
[
CAMERA_DH_CHAIN_LEN
];

135 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmRBÙ
[
CAMERA_DH_CHAIN_LEN
];

137 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ÿm”aPªInv”£Hack
;

140 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmHB
[
HEAD_DH_CHAIN_LEN
];

141 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmRAB
[
ARM_DH_CHAIN_LEN
];

142 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmLAB
[
ARM_DH_CHAIN_LEN
];

143 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmRFB
[
LEG_DH_CHAIN_LEN
];

144 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ŒªsfÜmLFB
[
LEG_DH_CHAIN_LEN
];

147 
	g¡d
::
veùÜ
<> 
mas£s
;

148 
	g¡d
::
veùÜ
<
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> > 
mas£sCom
;

150 
	g¡d
::
veùÜ
<
¡d
::veùÜ<
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> > >

151 
bodyP¬ts
;

	@robot/perception/kinematics/KinematicsAdapter.cpp

32 
	~"Kšem©icsAd­‹r.hµ
"

33 
	~"bÏckbßrd/BÏckbßrd.hµ
"

34 
	~"uts/Logg”.hµ
"

35 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”a.hµ
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	gKšem©icsAd­‹r
::
	$Kšem©icsAd­‹r
(
BÏckbßrd
 *
bb
è: 
	$Ad­‹r
(
bb
è{
	}
}

41 
Kšem©icsAd­‹r
::~
	$Kšem©icsAd­‹r
(è{
	}
}

43 
Kšem©icsAd­‹r
::
	$tick
() {

44 
	`Îog
(
VERBOSE
è<< "Kšem©ics..ickšg‡way" << 
’dl
;

45 
t
.
	`»¡¬t
();

49 
	`Îog
(
VERBOSE
è<< "Kšem©ic took: " << 
t
.
	`–­£d_us
(è<< " us" << 
’dl
;

51 
t
.
	`»¡¬t
();

52 
sÚ¬F‹r
.
	`upd©e
(
	`»adFrom
(
mÙiÚ
, 
sÚ¬Wšdow
));

53 
	`wr™eTo
(
kšem©ics
, 
sÚ¬F‹»d
, 
sÚ¬F‹r
.sonarFiltered);

54 
	`Îog
(
VERBOSE
è<< "SÚ¬ F‹¸took: " << 
t
.
	`–­£d_us
(è<< " us" << 
’dl
;

55 
	}
}

	@robot/perception/kinematics/KinematicsAdapter.hpp

32 #´agm¨
Úû


34 
	~<¡ršg
>

35 
	~"Kšem©ics.hµ
"

36 
	~"SÚ¬F‹r.hµ
"

37 
	~"uts/Tim”.hµ
"

38 
	~"bÏckbßrd/Ad­‹r.hµ
"

41 şas 
	cKšem©icsAd­‹r
 : 
Ad­‹r
 {

42 
public
:

44 
Kšem©icsAd­‹r
(
BÏckbßrd
 *
bb
);

46 ~
Kšem©icsAd­‹r
();

48 
tick
();

49 
	m´iv©e
:

51 
Kšem©ics
 
kšem©ics
;

52 
SÚ¬F‹r
 
	msÚ¬F‹r
;

53 
Tim”
 
	mt
;

	@robot/perception/kinematics/Parameters.cpp

1 
	~"P¬am‘”s.hµ
"

3 
	g‹m¶©e
<>emplate<>

4 
	gP¬am‘”s
<> P¬am‘”s<
	gçdbad
::
F
<> >::
ÿ¡
<>()

6 
P¬am‘”s
<> 
ÿ¡ed
;

8 
	gÿ¡ed
.
	gÿm”aP™chTİ
 = 
ÿm”aP™chTİ
.
x
();

9 
	gÿ¡ed
.
	gÿm”aYawTİ
 = 
ÿm”aYawTİ
.
x
();

10 
	gÿ¡ed
.
	gÿm”aRŞlTİ
 = 
ÿm”aRŞlTİ
.
x
();

12 
	gÿ¡ed
.
	gÿm”aYawBÙtom
 = 
ÿm”aYawBÙtom
.
x
();

13 
	gÿ¡ed
.
	gÿm”aP™chBÙtom
 = 
ÿm”aP™chBÙtom
.
x
();

14 
	gÿ¡ed
.
	gÿm”aRŞlBÙtom
 = 
ÿm”aRŞlBÙtom
.
x
();

16 
	gÿ¡ed
.
	gbodyP™ch
 = 
bodyP™ch
.
x
();

18  
	gÿ¡ed
;

	@robot/perception/kinematics/Parameters.hpp

1 #´agm¨
Úû


2 
	~"FADBAD++/çdiff.h
"

3 
	g‹m¶©e
 <
şass
 
	gT
>

4 şas 
	cP¬am‘”s
 {

5 
	mpublic
:

6 
T
 
ÿm”aP™chTİ
;

7 
T
 
	mÿm”aYawTİ
;

8 
T
 
	mÿm”aRŞlTİ
;

10 
T
 
	mÿm”aYawBÙtom
;

11 
T
 
	mÿm”aP™chBÙtom
;

12 
T
 
	mÿm”aRŞlBÙtom
;

14 
T
 
	mbodyP™ch
;

19 
	m‹m¶©e
<
ty³Çme
 
	mT_
>

20 
	mP¬am‘”s
<
	mT_
> 
ÿ¡
();

22 
	m‹m¶©e
<
şass
 
	mArchive
>

23 
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

24 
¬
 & 
ÿm”aP™chTİ
;

25 
¬
 & 
ÿm”aYawTİ
;

26 
¬
 & 
ÿm”aRŞlTİ
;

27 
¬
 & 
ÿm”aYawBÙtom
;

28 
¬
 & 
ÿm”aP™chBÙtom
;

29 
¬
 & 
ÿm”aRŞlBÙtom
;

30 
¬
 & 
bodyP™ch
;

33 
	}
};

	@robot/perception/kinematics/Pose.cpp

1 
	~"Po£.hµ
"

3 
	~<³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
>

4 
	~<uts/m©rix_h–³rs.hµ
>

6 
	gPo£
::
	$Po£
() {

7 
i
 = 0; i < 
EXCLUSION_RESOLUTION
; i++) {

8 
tİExşusiÚA¼ay
[
i
] = 
TOP_IMAGE_ROWS
;

9 
bÙExşusiÚA¼ay
[
i
] = 
TOP_IMAGE_ROWS
+
BOT_IMAGE_ROWS
;

12 
Üigš
 = 
vec4
<>(0, 0, 0, 1);

13 
zun™
 = 
vec4
<>(0, 0, 0, 1);

14 
tİToFocus
 = 
vec4
<>(0, 0, 
FOCAL_LENGTH
, 1);

15 
bÙToFocus
 = 
vec4
<>(0, 0, 
FOCAL_LENGTH
, 1);

17 
tİCam”aToWÜldT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

18 
bÙCam”aToWÜldT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

19 
tİWÜldToCam”aT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

20 
bÙWÜldToCam”aT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

21 
tİWÜldToCam”aT¿nsfÜmT
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

22 
bÙWÜldToCam”aT¿nsfÜmT
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

23 
ÃckToWÜldT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

24 
wÜldToNeckT¿nsfÜm
 = 
boo¡
::
num”ic
::
ubÏs
::
id’t™y_m©rix
<>(4);

26 
hÜizÚ
 = 
¡d
::
·œ
<, >(0, 0);

27 
	}
}

29 
	gPo£
::
Po£
(
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
tİCam”aToWÜldT¿nsfÜm
,

30 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
bÙCam”aToWÜldT¿nsfÜm
,

31 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ÃckToWÜldT¿nsfÜm
,

32 
¡d
::
·œ
<, > 
hÜizÚ
)

33 : 
tİWÜldToCam”aT¿nsfÜm
(4, 4), 
bÙWÜldToCam”aT¿nsfÜm
(4, 4), 
	$wÜldToNeckT¿nsfÜm
(4, 4)

35 
this
->
tİCam”aToWÜldT¿nsfÜm
 =opCameraToWorldTransform;

36 
this
->
bÙCam”aToWÜldT¿nsfÜm
 = botCameraToWorldTransform;

37 
this
->
ÃckToWÜldT¿nsfÜm
 =‚eckToWorldTransform;

38 
this
->
hÜizÚ
 = horizon;

40 
	`makeCÚ¡ªts
();

41 
	}
}

43 
XYZ_CoÜd
 
	gPo£
::
	$robÙR–©iveToNeckCoÜd
(
RRCoÜd
 
coÜd
, 
h
) const {

44 
Pošt
 
ÿ¹esŸn
 = 
coÜd
.
	`toC¬‹sŸn
();

46 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
p
 = 
vec4
<>(
ÿ¹esŸn
[0], c¬‹sŸn[1], 
h
, 1);

47 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ÃckP
 = 
	`´od
(
wÜldToNeckT¿nsfÜm
, 
p
);

48  
	`XYZ_CoÜd
(
	`ÃckP
(0, 0),‚eckP(1, 0),‚eckP(2, 0));

49 
	}
}

51 
RRCoÜd
 
	gPo£
::
	$imageToRobÙR–©ive
(
Pošt
 
p
, 
h
) const

53 
Pošt
 
¼_p
 = 
	`imageToRobÙXY
(
p
, 
h
);

55 
RRCoÜd
 
r
;

56 
r
.
	`di¡ªû
(èğ
	`hypÙf
(
¼_p
.
	`y
(),„r_p.
	`x
());

57 
r
.
	`h—dšg
(èğ
	`©ª2f
(
¼_p
.
	`y
(),„r_p.
	`x
());

59  
r
;

60 
	}
}

62 
RRCoÜd
 
	gPo£
::
	$imageToRobÙR–©ive
(
x
, 
y
, 
h
) const

64  
	`imageToRobÙR–©ive
(
	`Pošt
(
x
, 
y
), 
h
);

65 
	}
}

67 
Pošt
 
	gPo£
::
	$imageToRobÙXY
(cÚ¡ 
Pošt
 &
image
, 
h
) const

70 
boŞ
 
tİ
 = 
Œue
;

71 
Pošt
 
i
 = 
image
;

72 ià(
image
.
	`y
(è>ğ
TOP_IMAGE_ROWS
) {

73 
tİ
 = 
çl£
;

74 
i
.
	`y
(è-ğ
TOP_IMAGE_ROWS
;

78 cÚ¡ 
COLS
 = (
tİ
è? 
TOP_IMAGE_COLS
 : 
BOT_IMAGE_COLS
;

79 cÚ¡ 
ROWS
 = (
tİ
è? 
TOP_IMAGE_ROWS
 : 
BOT_IMAGE_ROWS
;

80 cÚ¡ 
PIXEL
 = (
tİ
è? 
TOP_PIXEL_SIZE
 : 
BOT_PIXEL_SIZE
;

83 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
lOrigš
, 
lOrigš2
;

84 
lOrigš2
 = 
vec4
<>(

85 (((
COLS
è/ 2.0 - 
i
.
	`x
()è* 
PIXEL
),

86 (((
ROWS
è/ 2.0 - 
i
.
	`y
()è* 
PIXEL
),

90 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
cdœ
;

92 ià(
tİ
) {

93 
lOrigš
 = 
	`´od
(

94 
tİCam”aToWÜldT¿nsfÜm
,

95 
lOrigš2
);

96 
cdœ
 = (
tİToFocus
 - 
lOrigš
);

98 
lOrigš
 = 
	`´od
(

99 
bÙCam”aToWÜldT¿nsfÜm
,

100 
lOrigš2
);

101 
cdœ
 = (
bÙToFocus
 - 
lOrigš
);

105 
Ïmbda
 = (
h
 - 
	`lOrigš
(2, 0)è/ (1.0 * 
	`cdœ
(2, 0));

107 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
š‹rû±
;

108 
š‹rû±
 = 
vec4
<>(
	`lOrigš
(0, 0è+ 
Ïmbda
 * 
	`cdœ
(0, 0),

109 
	`lOrigš
(1, 0è+ 
Ïmbda
 * 
	`cdœ
(1, 0),

110 
h
,

113  
	`Pošt
(
	`š‹rû±
(0, 0), intercept(1, 0));

114 
	}
}

120 
Pošt
 
	gPo£
::
	$robÙToImageXY
(
Pošt
 
robÙ
, 
h
) const

122 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
p
 = 
vec4
<>(
robÙ
.
	`x
(),„obÙ.
	`y
(), 
h
, 1);

124 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
pix–
 = 
	`´od
(
bÙWÜldToCam”aT¿nsfÜmT
,
p
);

126 
	`pix–
(0, 0è/ğ
	`ABS
(pixel(3, 0));

127 
	`pix–
(1, 0è/ğ
	`ABS
(pixel(3, 0));

129 
	`pix–
(0, 0èğÕix–(0, 0è* (
BOT_IMAGE_COLS
 / 2))+(BOT_IMAGE_COLS / 2);

130 
	`pix–
(1, 0èğÕix–(1, 0è* (
BOT_IMAGE_COLS
 / 2))+(
BOT_IMAGE_ROWS
 / 2);

132 ià(
	`pix–
(1 , 0) < 0) {

133 
pix–
 = 
	`´od
(
tİWÜldToCam”aT¿nsfÜmT
,
p
);

135 
	`pix–
(0, 0è/ğ
	`ABS
(pixel(3, 0));

136 
	`pix–
(1, 0è/ğ
	`ABS
(pixel(3, 0));

138 
	`pix–
(0, 0èğÕix–(0, 0è* (
TOP_IMAGE_COLS
 / 2)) + (TOP_IMAGE_COLS / 2);

139 
	`pix–
(1, 0èğÕix–(1, 0è* (
TOP_IMAGE_COLS
 / 2)è+ (
TOP_IMAGE_ROWS
 / 2);

141 
	`pix–
(1, 0è+ğ
TOP_IMAGE_ROWS
;

144  
	`Pošt
(
	`pix–
(0, 0),…ixel(1, 0));

145 
	}
}

147 
	g¡d
::
·œ
<, > 
	gPo£
::
	$g‘HÜizÚ
() const {

148  
hÜizÚ
;

149 
	}
}

151 cÚ¡ 
št16_t
 *
	gPo£
::
	$g‘TİExşusiÚA¼ay
() const {

152  
tİExşusiÚA¼ay
;

153 
	}
}

155 
št16_t
 *
	gPo£
::
	$g‘TİExşusiÚA¼ay
() {

156  
tİExşusiÚA¼ay
;

157 
	}
}

159 cÚ¡ 
št16_t
 *
	gPo£
::
	$g‘BÙExşusiÚA¼ay
() const {

160  
bÙExşusiÚA¼ay
;

161 
	}
}

163 
št16_t
 *
	gPo£
::
	$g‘BÙExşusiÚA¼ay
() {

164  
bÙExşusiÚA¼ay
;

165 
	}
}

167 cÚ¡ 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<>

168 
Po£
::
	$g‘C2wT¿nsfÜm
(
boŞ
 
tİ
) const {

169 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`c
(4, 4);

170 ià(
tİ
) {

171 
	`c
(0, 0èğ
	`tİCam”aToWÜldT¿nsfÜm
(0, 0);

172 
	`c
(1, 0èğ
	`tİCam”aToWÜldT¿nsfÜm
(1, 0);

173 
	`c
(2, 0èğ
	`tİCam”aToWÜldT¿nsfÜm
(2, 0);

174 
	`c
(3, 0èğ
	`tİCam”aToWÜldT¿nsfÜm
(3, 0);

175 
	`c
(0, 1èğ
	`tİCam”aToWÜldT¿nsfÜm
(0, 1);

176 
	`c
(1, 1èğ
	`tİCam”aToWÜldT¿nsfÜm
(1, 1);

177 
	`c
(2, 1èğ
	`tİCam”aToWÜldT¿nsfÜm
(2, 1);

178 
	`c
(3, 1èğ
	`tİCam”aToWÜldT¿nsfÜm
(3, 1);

179 
	`c
(0, 2èğ
	`tİCam”aToWÜldT¿nsfÜm
(0, 2);

180 
	`c
(1, 2èğ
	`tİCam”aToWÜldT¿nsfÜm
(1, 2);

181 
	`c
(2, 2èğ
	`tİCam”aToWÜldT¿nsfÜm
(2, 2);

182 
	`c
(3, 2èğ
	`tİCam”aToWÜldT¿nsfÜm
(3, 2);

183 
	`c
(0, 3èğ
	`tİCam”aToWÜldT¿nsfÜm
(0, 3);

184 
	`c
(1, 3èğ
	`tİCam”aToWÜldT¿nsfÜm
(1, 3);

185 
	`c
(2, 3èğ
	`tİCam”aToWÜldT¿nsfÜm
(2, 3);

186 
	`c
(3, 3èğ
	`tİCam”aToWÜldT¿nsfÜm
(3, 3);

188 
	`c
(0, 0èğ
	`bÙCam”aToWÜldT¿nsfÜm
(0, 0);

189 
	`c
(1, 0èğ
	`bÙCam”aToWÜldT¿nsfÜm
(1, 0);

190 
	`c
(2, 0èğ
	`bÙCam”aToWÜldT¿nsfÜm
(2, 0);

191 
	`c
(3, 0èğ
	`bÙCam”aToWÜldT¿nsfÜm
(3, 0);

192 
	`c
(0, 1èğ
	`bÙCam”aToWÜldT¿nsfÜm
(0, 1);

193 
	`c
(1, 1èğ
	`bÙCam”aToWÜldT¿nsfÜm
(1, 1);

194 
	`c
(2, 1èğ
	`bÙCam”aToWÜldT¿nsfÜm
(2, 1);

195 
	`c
(3, 1èğ
	`bÙCam”aToWÜldT¿nsfÜm
(3, 1);

196 
	`c
(0, 2èğ
	`bÙCam”aToWÜldT¿nsfÜm
(0, 2);

197 
	`c
(1, 2èğ
	`bÙCam”aToWÜldT¿nsfÜm
(1, 2);

198 
	`c
(2, 2èğ
	`bÙCam”aToWÜldT¿nsfÜm
(2, 2);

199 
	`c
(3, 2èğ
	`bÙCam”aToWÜldT¿nsfÜm
(3, 2);

200 
	`c
(0, 3èğ
	`bÙCam”aToWÜldT¿nsfÜm
(0, 3);

201 
	`c
(1, 3èğ
	`bÙCam”aToWÜldT¿nsfÜm
(1, 3);

202 
	`c
(2, 3èğ
	`bÙCam”aToWÜldT¿nsfÜm
(2, 3);

203 
	`c
(3, 3èğ
	`bÙCam”aToWÜldT¿nsfÜm
(3, 3);

205  
c
;

206 
	}
}

208 
	gPo£
::
	$makeCÚ¡ªts
()

210 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
	`´ojeùiÚ
(4, 4);

211 
	`´ojeùiÚ
(0, 0) = 1;

212 
	`´ojeùiÚ
(0, 1) = 0;

213 
	`´ojeùiÚ
(0, 2) = 0;

214 
	`´ojeùiÚ
(0, 3) = 0;

216 
	`´ojeùiÚ
(1, 0) = 0;

217 
	`´ojeùiÚ
(1, 1) = 1;

218 
	`´ojeùiÚ
(1, 2) = 0;

219 
	`´ojeùiÚ
(1, 3) = 0;

221 
	`´ojeùiÚ
(2, 0) = 0;

222 
	`´ojeùiÚ
(2, 1) = 0;

223 
	`´ojeùiÚ
(2, 2) = 1;

224 
	`´ojeùiÚ
(2, 3) = 0;

226 
	`´ojeùiÚ
(3, 0) = 0;

227 
	`´ojeùiÚ
(3, 1) = 0;

228 
	`´ojeùiÚ
(3, 2èğ
	`n
(
CAMERA_FOV_W
 / 2);

229 
	`´ojeùiÚ
(3, 3) = 0;

231 
	`šv”tM©rix
(
tİCam”aToWÜldT¿nsfÜm
, 
tİWÜldToCam”aT¿nsfÜm
);

232 
tİWÜldToCam”aT¿nsfÜmT
 = 
	`´od
(
´ojeùiÚ
, 
tİWÜldToCam”aT¿nsfÜm
);

233 
	`šv”tM©rix
(
bÙCam”aToWÜldT¿nsfÜm
, 
bÙWÜldToCam”aT¿nsfÜm
);

234 
bÙWÜldToCam”aT¿nsfÜmT
 = 
	`´od
(
´ojeùiÚ
, 
bÙWÜldToCam”aT¿nsfÜm
);

236 
	`šv”tM©rix
(
ÃckToWÜldT¿nsfÜm
, 
wÜldToNeckT¿nsfÜm
);

238 
Üigš
 = 
vec4
<>(0, 0, 0, 1);

239 
zun™
 = 
vec4
<>(0, 0, 0, 1);

240 
tİCOrigš
 = 
	`´od
(
tİCam”aToWÜldT¿nsfÜm
, 
Üigš
);

241 
bÙCOrigš
 = 
	`´od
(
bÙCam”aToWÜldT¿nsfÜm
, 
Üigš
);

242 
tİToFocus
 = 
	`´od
(
tİCam”aToWÜldT¿nsfÜm
, 
vec4
<>(0, 0,
FOCAL_LENGTH
, 1));

243 
bÙToFocus
 = 
	`´od
(
bÙCam”aToWÜldT¿nsfÜm
, 
vec4
<>(0, 0,
FOCAL_LENGTH
, 1));

244 
	}
}

	@robot/perception/kinematics/Pose.hpp

32 #´agm¨
Úû


33 
	~<boo¡/£rŸliz©iÚ/v”siÚ.hµ
>

34 
	~<boo¡/£rŸliz©iÚ/£rŸliz©iÚ.hµ
>

36 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

37 
	~<boo¡/num”ic/ubÏs/io.hµ
>

38 
	~<ut™y
>

40 
	~<¡dšt.h
>

42 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aDefš™iÚs.hµ
"

43 
	~"ty³s/Pošt.hµ
"

44 
	~"ty³s/RRCoÜd.hµ
"

45 
	~"ty³s/JoštV®ues.hµ
"

46 
	~"ty³s/XYZ_CoÜd.hµ
"

58 şas 
	cPo£
 {

59 
	mpublic
:

60 
ex¶ic™
 
Po£
(

61 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
tİCam”aToWÜldT¿nsfÜm
,

62 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
bÙCam”aToWÜldT¿nsfÜm
,

63 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ÃckToWÜldT¿nsfÜm
,

64 
¡d
::
·œ
<, > 
hÜizÚ
);

66 
Po£
();

73 
	m¡d
::
·œ
<, > 
	$g‘HÜizÚ
() const;

75 
XYZ_CoÜd
 
	$robÙR–©iveToNeckCoÜd
(
RRCoÜd
 
coÜd
, 
h
) const;

85 
RRCoÜd
 
	$imageToRobÙR–©ive
(
x
, 
y
, 
h
) const;

94 
RRCoÜd
 
	$imageToRobÙR–©ive
(
Pošt
 
p
, 
h
 = 0) const;

96 
Pošt
 
	$imageToRobÙXY
(cÚ¡ 
Pošt
 &
image
, 
h
 = 0) const;

97 
Pošt
 
	$robÙToImageXY
(
Pošt
 
robÙ
, 
h
 = 0) const;

100 cÚ¡ 
št16_t
 *
	$g‘TİExşusiÚA¼ay
() const;

101 
št16_t
 *
	`g‘TİExşusiÚA¼ay
();

102 cÚ¡ 
št16_t
 *
	$g‘BÙExşusiÚA¼ay
() const;

103 
št16_t
 *
	`g‘BÙExşusiÚA¼ay
();

105 cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<>

106 
	$g‘C2wT¿nsfÜm
(
boŞ
 
tİ
 = 
Œue
) const;

108 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
tİCam”aToWÜldT¿nsfÜm
;

109 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
bÙCam”aToWÜldT¿nsfÜm
;

110 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
tİWÜldToCam”aT¿nsfÜm
;

111 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
bÙWÜldToCam”aT¿nsfÜm
;

113 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ÃckToWÜldT¿nsfÜm
;

114 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
wÜldToNeckT¿nsfÜm
;

116 cÚ¡ 
ušt16_t
 
EXCLUSION_RESOLUTION
 = 100;

117 
´iv©e
:

118 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
Üigš
, 
zun™
;

119 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
tİCOrigš
, 
bÙCOrigš
;

120 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
tİToFocus
, 
bÙToFocus
;

121 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
tİWÜldToCam”aT¿nsfÜmT
;

122 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
bÙWÜldToCam”aT¿nsfÜmT
;

124 
	`makeCÚ¡ªts
();

126 
¡d
::
·œ
<, > 
hÜizÚ
;

127 
št16_t
 
tİExşusiÚA¼ay
[
EXCLUSION_RESOLUTION
];

128 
št16_t
 
bÙExşusiÚA¼ay
[
EXCLUSION_RESOLUTION
];

130 #iâdeà
SWIG


131 
	`BOOST_SERIALIZATION_SPLIT_MEMBER
();

134 
ä›nd
 
şass
 
boo¡
::
£rŸliz©iÚ
::
acûss
;

135 
‹m¶©e
<
şass
 
Archive
>

136 
	`£rŸlizeMemb”s
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
);

138 
‹m¶©e
<
şass
 
Archive
>

139 
	$§ve
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
) const;

141 
‹m¶©e
<
şass
 
Archive
>

142 
	`lßd
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
);

145 
	`BOOST_CLASS_VERSION
(
Po£
, 2);

147 
	~"Po£.tcc
"

	@robot/perception/kinematics/Pose.tcc

1 #´agm¨
Úû


3 
	g‹m¶©e
<
şass
 
	gArchive
>

4 
	gPo£
::
	$§ve
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) const

7 
Po£
 *
uncÚ¡ed
 = 
cÚ¡_ÿ¡
<Po£ *>(
this
);

8 
uncÚ¡ed
->
	`£rŸlizeMemb”s
(
¬
, 
fe_v”siÚ
);

9 
	}
}

11 
	g‹m¶©e
<
şass
 
	gArchive
>

12 
	gPo£
::
	$lßd
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

14 
	`£rŸlizeMemb”s
(
¬
, 
fe_v”siÚ
);

15 
	`makeCÚ¡ªts
();

16 
	}
}

18 
	g‹m¶©e
<
şass
 
	gArchive
>

19 
	gPo£
::
	$£rŸlizeMemb”s
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

21 
¬
 & 
tİCam”aToWÜldT¿nsfÜm
;

22 
¬
 & 
bÙCam”aToWÜldT¿nsfÜm
;

24 ià(
fe_v”siÚ
 < 2) {

39 
¬
 & 
Üigš
;

40 
¬
 & 
zun™
;

41 
¬
 & 
tİCOrigš
;

42 
¬
 & 
bÙCOrigš
;

44 
¬
 & 
hÜizÚ
;

45 
¬
 & 
tİExşusiÚA¼ay
;

46 
¬
 & 
bÙExşusiÚA¼ay
;

47 
	}
}

	@robot/perception/kinematics/SonarFilter.cpp

1 
	~"SÚ¬F‹r.hµ
"

3 
	~"uts/Logg”.hµ
"

4 
	~<lim™s
>

6 
	gSÚ¬F‹r
::
	$SÚ¬F‹r
(){

9 
¡d
::
veùÜ
<> 
Ëá
;

10 
¡d
::
veùÜ
<> 
middË
;

11 
¡d
::
veùÜ
<> 
right
;

12 
sÚ¬F‹»d
.
	`push_back
(
Ëá
);

13 
sÚ¬F‹»d
.
	`push_back
(
middË
);

14 
sÚ¬F‹»d
.
	`push_back
(
right
);

16 
	}
}

20 
	gSÚ¬F‹r
::
upd©e
Ğ
¡d
::
veùÜ
< std::veùÜ<> > 
sÚ¬Wšdow
){

21 
Îog
(
DEBUG1
) << "Processing sonar„ight\n";

22 
	gsÚ¬F‹»d
[
SÚ¬
::
LEFT
] = 
şu¡”
(
sÚ¬Wšdow
[SÚ¬::LEFT], 
MERGE_CUTOFF
, 
CONFIDENCE_CUTOFF
);

23 
Îog
(
DEBUG1
) << "Processing sonar middle\n";

24 
	gsÚ¬F‹»d
[
SÚ¬
::
MIDDLE
] = 
şu¡”
(
sÚ¬Wšdow
[SÚ¬::MIDDLE], 
MERGE_CUTOFF
, 
CONFIDENCE_CUTOFF
);

25 
Îog
(
DEBUG1
) << "Processing sonar†eft\n";

26 
	gsÚ¬F‹»d
[
SÚ¬
::
RIGHT
] = 
şu¡”
(
sÚ¬Wšdow
[SÚ¬::RIGHT], 
MERGE_CUTOFF
, 
CONFIDENCE_CUTOFF
);

31 
	g¡d
::
veùÜ
<> 
SÚ¬F‹r
::
şu¡”
(
¡d
::veùÜ<> &
sÚ¬
, 
m”ge_cutoff
, 
cÚfid’û_cutoff
){

33 
	g¡d
::
sÜt
(
sÚ¬
.
begš
(), sÚ¬.
’d
());

34 
	g¡d
::
veùÜ
<> 
»suÉ
;

36 ià(
	gsÚ¬
.
size
()==0è 
»suÉ
;

38 
	gsum
 = 
sÚ¬
[0];

39 
	gcouÁ
 = 1;

40 
	gm—n
 = 
sÚ¬
[0];

42 
Îog
(
DEBUG1
è<< "1¡ M—n: " << 
	gm—n
 << ", ";

44 
	gi
=1;

45 
	gi
< (è
	gsÚ¬
.
size
()){

47 iàĞ
	g¡d
::
abs
(
sÚ¬
[
i
] - 
m—n
è< 
m”ge_cutoff
){

48 
Îog
(
DEBUG1
è<< "m”gšg w™h: " << 
sÚ¬
[
i
];

49 
	gcouÁ
++;

50 
	gsum
 +ğ
sÚ¬
[
i
];

51 
	gm—n
 = 
sum
/
couÁ
;

52 
Îog
(
DEBUG1
è<< ",‚ew m—n: " << 
	gm—n
 << "\n";

54 
Îog
(
DEBUG1
è<< "£·¿‹ from: " << 
	gsÚ¬
[
i
];

55 ià(
	gcouÁ
 >ğ
cÚfid’û_cutoff
 || 
m—n
 < 0.35f){

56 
»suÉ
.
push_back
(
m—n
);

57 
Îog
(
DEBUG1
è<< ", savšg m—n: " << 
	gm—n
;

59 
	gsum
 = 
sÚ¬
[
i
];

60 
	gcouÁ
 = 1;

61 
	gm—n
 = 
sÚ¬
[
i
];

62 
Îog
(
DEBUG1
è<< ",‚ew m—n: " << 
	gm—n
 << "\n";

64 
	gi
++;

66 ià(
	gcouÁ
 >ğ
cÚfid’û_cutoff
 || 
m—n
 < 0.35f){

67 
»suÉ
.
push_back
(
m—n
);

68 
Îog
(
DEBUG1
è<< "Savšg m—n: " << 
	gm—n
 << "\n";

70  
	g»suÉ
;

	@robot/perception/kinematics/SonarFilter.hpp

1 #´agm¨
Úû


3 
	~<veùÜ
>

4 
	~<ut™y
>

5 
	~<li¡
>

6 
	~"uts/body.hµ
"

7 
	~"mÙiÚ/SÚ¬RecÜd”.hµ
"

10 
	#MERGE_CUTOFF
 50

11 
	#CONFIDENCE_CUTOFF
 3

13 

	)

15 şas 
	cSÚ¬F‹r
 {

16 
	mpublic
:

18 
SÚ¬F‹r
();

21 
upd©e
Ğ
¡d
::
veùÜ
< std::veùÜ <> > 
sÚ¬Wšdow
 );

24 
	m¡d
::
veùÜ
< 
¡d
::veùÜ <> > 
sÚ¬F‹»d
;

27 
	m´iv©e
:

30 
¡d
::
veùÜ
<> 
şu¡”
(¡d::veùÜ<> &
sÚ¬
, 
m”ge_cutoff
, 
cÚfid’û_cutoff
);

	@robot/perception/localisation/GaussianUpdateDebugData.hpp

8 #´agm¨
Úû


10 
	~"Loÿli§tiÚUts.hµ
"

12 
	~<Eig’/Eig’
>

13 
	~<io¡»am
>

15 
	sGaussŸnUpd©eDebugD©a
 {

16 
	m´eUpd©eWeight
;

17 
	mEig’
::
M©rixXd
 
´eUpd©eM—n
;

18 
	mEig’
::
M©rixXd
 
´eUpd©eCov¬Ÿnû
;

20 
	mEig’
::
M©rixXd
 
upd©eIÂov©iÚ
;

21 
	mEig’
::
M©rixXd
 
upd©eJacobŸn
;

22 
	mEig’
::
M©rixXd
 
upd©eOb£rv©iÚV¬Ÿnû
;

24 
	mEig’
::
M©rixXd
 
combšedCov¬Ÿnû
;

25 
	mEig’
::
M©rixXd
 
combšedCov¬ŸnûInv
;

26 
	mEig’
::
M©rixXd
 
k®mª
;

28 
	mEig’
::
M©rixXd
 
po¡Upd©eM—n
;

29 
	mEig’
::
M©rixXd
 
po¡Upd©eCov¬Ÿnû
;

31 
	mweightAdju¡m’t
;

32 
	mpo¡Upd©eWeight
;

34 
ouut
() const {

35 
	m¡d
::
cout
 << "´eUpd©eWeight: " << 
´eUpd©eWeight
 << 
¡d
::
’dl
;

37 
´‘tyOuutM©rix
("´eUpd©eM—n", 
´eUpd©eM—n
);

38 
´‘tyOuutM©rix
("´eUpd©eCov¬Ÿnû", 
´eUpd©eCov¬Ÿnû
);

40 
´‘tyOuutM©rix
("upd©eIÂov©iÚ", 
upd©eIÂov©iÚ
);

41 
´‘tyOuutM©rix
("upd©eJacobŸn", 
upd©eJacobŸn
);

42 
´‘tyOuutM©rix
("upd©eOb£rv©iÚV¬Ÿnû", 
upd©eOb£rv©iÚV¬Ÿnû
);

44 
´‘tyOuutM©rix
("combšedCov¬Ÿnû", 
combšedCov¬Ÿnû
);

45 
´‘tyOuutM©rix
("combšedCov¬ŸnûInv", 
combšedCov¬ŸnûInv
);

46 
´‘tyOuutM©rix
("k®mª", 
k®mª
);

48 
´‘tyOuutM©rix
("po¡Upd©eM—n", 
po¡Upd©eM—n
);

49 
´‘tyOuutM©rix
("po¡Upd©eCov¬Ÿnû", 
po¡Upd©eCov¬Ÿnû
);

51 
	m¡d
::
cout
 << "weightAdju¡m’t: " << 
weightAdju¡m’t
 << 
¡d
::
’dl
;

52 
	m¡d
::
cout
 << "po¡Upd©eWeight: " << 
po¡Upd©eWeight
 << 
¡d
::
’dl
;

	@robot/perception/localisation/ICP.cpp

2 
	~"ICP.hµ
"

4 
	~<æßt.h
>

5 
	~<lim™s
>

7 
	~"uts/Logg”.hµ
"

8 
	~"uts/¥“ch.hµ
"

9 
	~"uts/Tim”.hµ
"

10 
	~"uts/basic_m©hs.hµ
"

11 
	~"uts/ªgËs.hµ
"

12 
	~"uts/SPLDefs.hµ
"

13 
	~"Loÿli§tiÚUts.hµ
"

14 
	~"Loÿli§tiÚCÚ¡ªtsProvid”.hµ
"

19 
	#POST_WEIGHT
 1.f

	)

20 
	#FIELD_LINE_WEIGHT
 1.f

	)

21 
	#CORNER_WEIGHT
 1.f

	)

22 
	#T_WEIGHT
 1.f

	)

23 
	#CIRCLE_WEIGHT
 2.f

24 
	#PARALLEL_LINE_WEIGHT
 1.f

	)

27 
	#LOCALISED
 200*200

28 
	#STOP_THRESHOLD
 50*50

29 
	#IMPROVEMENT_THRESHOLD
 20*20

30 
	#MAX_ITERATIONS
 12

	)

33 
	#TEAM_BALL_THRESH
 1000

	)

34 
	#RRC_BALL_THRESH
 800

	)

36 
	#PARALLEL_THRESH
 
	`DEG2RAD
(20)

37 
	#SINGLE_POINT_THRESH
 1000

38 

	)

39 
	#EDGE_ERROR_PERCENT
 0.4f

40 
	#MIN_EDGE_ERROR
 100.f

41 
	#POST_ERROR_PERCENT
 0.2f

42 
	#MIN_POST_ERROR
 200.f

43 

	)

45 cÚ¡ 
	gLoÿli§tiÚCÚ¡ªtsProvid”
& 
cÚ¡ªtsProvid”
(

46 
Loÿli§tiÚCÚ¡ªtsProvid”
::
š¡ªû
());

49 
	#GOAL_PROB_THRESH
 0.90f

	)

52 
	#RADIAN2MM_SCALING
 600

	)

55 
	#FEATURE_WIDTH
 1000

	)

57 
	#NO_MATCH
 -1

	)

63 
	g¡d
::
veùÜ
<
Po¡Info
> 
po¡Obs
;

65 
	g¡d
::
veùÜ
<
P¬®ËlLšesInfo
> 
·¿Î–Lšes
;

66 
	g¡d
::
veùÜ
<> 
·¿Î–LšeTy³s
;

68 
	g¡d
::
veùÜ
<
RRCoÜd
> 
cÜÃrs
;

69 
	g¡d
::
veùÜ
<> 
cÜÃrTy³s
;

71 
	g¡d
::
veùÜ
<
RRCoÜd
> 
TJunùiÚs
;

72 
	g¡d
::
veùÜ
<> 
TJunùiÚTy³s
;

74 
	g¡d
::
veùÜ
<
RRCoÜd
> 
ûÁ»Cœşes
;

76 
	g¡d
::
veùÜ
<
LšeInfo
> 
f›ldLšes
;

78 
	g¡d
::
veùÜ
<> 
lšeL’gths
;

79 
	g¡d
::
veùÜ
<> 
lšePo¡Di¡
;

80 
	g¡d
::
veùÜ
<> 
lšeEdgeDi¡
;

82 
	g¡d
::
veùÜ
<
LšeInfo
> 
f›ldEdgeObs
;

84 
	g™”©iÚ
;

85 
	gmšI‹¿tiÚs
;

86 
boŞ
 
	gnÚLšeF—tu»
;

87 
boŞ
 
	gx_known
;

88 
boŞ
 
	gy_known
;

89 
RRCoÜd
 
	gsšgËF—tu»
;

91 
	gmaxDi¡
;

92 
	gm£
;

93 
	gN
;

94 
	gtÙ®N
;

95 
	g¡d
::
veùÜ
<
Pošt
> 
sourû
;

96 
	g¡d
::
veùÜ
<
Pošt
> 
rg‘
;

97 
	g¡d
::
veùÜ
<
T¬g‘Ty³
> 
rg‘Ty³
;

98 
	g¡d
::
veùÜ
<> 
di¡ªûs
;

99 
	g¡d
::
veùÜ
<> 
weights
;

103 
	g¡d
::
veùÜ
<
AbsCoÜd
> 
®lCœşes
;

104 
	g¡d
::
veùÜ
<
AbsCoÜd
> 
®lCÜÃrs
;

105 
	g¡d
::
veùÜ
<> 
®lCÜÃrTy³s
;

106 
	g¡d
::
veùÜ
<
AbsCoÜd
> 
®lTJunùiÚs
;

107 
	g¡d
::
veùÜ
<> 
®lTJunùiÚTy³s
;

110 
	g¡d
::
veùÜ
<
AbsCoÜd
> 
®lPo¡s
;

111 
	g¡d
::
veùÜ
<> 
®lPo¡Ty³s
;

114 
	g¡d
::
veùÜ
<
LšeInfo
> 
®lF›ldLšes
;

115 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
®lLšeNames
;

116 
	g¡d
::
veùÜ
<> 
®lLšeL’gths
;

117 
	g¡d
::
veùÜ
<> 
®lLšePo¡Di¡
;

118 
	g¡d
::
veùÜ
<
¡d
::
·œ
<, > > 
	g®lLšeEdgeDi¡
;

125 
	g¡d
::
veùÜ
<
¡d
::
·œ
<
LšeInfo
, 
	gLšeInfo
> > 
	g·¿Î–F›ldLšes
;

126 
	g¡d
::
veùÜ
<
¡d
::veùÜ <
Pošt
> > 
·¿Î–Pošts
;

127 
	g¡d
::
veùÜ
<
¡d
::
·œ
<, > > 
	g·¿Î–F›ldL’gths
;

130 
	g¡d
::
veùÜ
<
LšeInfo
> 
®lEdgeLšes
;

134 
AbsCoÜd
 
	gcombšedObs
;

135 
boŞ
 
	ghaveIn™Ÿli£dLªdm¬ks
 = 
çl£
;

138 
š™Lªdm¬ks
();

141 
´•roûssF—tu»s
ĞcÚ¡ 
¡d
::
veùÜ
<
F›ldF—tu»Info
> &
f›ldF—tu»s
,

142 cÚ¡ 
¡d
::
veùÜ
<
Po¡Info
> &
po¡s
,

143 cÚ¡ 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> & 
f›ldBound¬›s
);

148 
assocŸ‹F—tu»s
(
™”©iÚ
);

151 
sŞve
();

154 
™”©e
();

157 
Pošt
 
ŒªsfÜm
(cÚ¡ Pošˆ&
pošt
, 
tx
, 
ty
, 
th‘a
);

160 
ÿlcMSE
();

164 
m©chObs
(cÚ¡ 
RRCoÜd
 
¼
, 
¡d
::
veùÜ
<
AbsCoÜd
> &
Ïndm¬ks
, 
weight
,

165 
ty³
 = 
NO_TYPE
, 
¡d
::
veùÜ
<> 
Ïndm¬kTy³s
 = std::vector<>());

168 
boŞ
 
m©chLše
(cÚ¡ 
LšeInfo
 
lše
, 
Ën2
, 
po¡Di¡2
, 
edgeDi¡
, boŞ 
cÚ¡¿šOr›Á©iÚ
 = 
çl£
);

171 
boŞ
 
m©chEdge
(cÚ¡ 
LšeInfo
 
lše
);

176 
boŞ
 
m©chP¬®ËlLše
(cÚ¡ 
LšeInfo
 
lše1
, cÚ¡ LšeInfØ
lše2
, boŞ 
Üd”Known
 = 
çl£
, boŞ 
fœ¡M©ch
 = false);

179 
obsLmkDiff
(cÚ¡ 
AbsCoÜd
 
obs
, cÚ¡ AbsCoÜd 
lmk
);

183 
di¡LšeToBound¬y
(cÚ¡ 
LšeInfo
 
lše
, cÚ¡ 
F›ldBound¬yInfo
 
bound¬y
);

186 
di¡2ToLšeSeg
(cÚ¡ 
LšeInfo
 
lše
, cÚ¡ 
Pošt
 
¤c
, Pošˆ&
tgt
);

189 
di¡2ToLše
(cÚ¡ 
LšeInfo
 
lše
, cÚ¡ 
Pošt
 
¤c
, Pošˆ&
tgt
 );

193 
addToPoštCloud
(
Pošt
 
p1
, Pošˆ
p2
, 
di¡
, 
weight
, 
T¬g‘Ty³
 
ty³
 = 
POINT
);

197 
addToPoštCloud
(cÚ¡ 
AbsCoÜd
 
obs1
, cÚ¡ AbsCoÜd 
obs2
, 
weight
);

200 
	$»£t
() {

201 
™”©iÚ
 = 0;

202 
maxDi¡
 = 0.f;

203 
m£
 = 0.f;

204 
N
 = 0;

206 ià(!
haveIn™Ÿli£dLªdm¬ks
) {

207 
	`š™Lªdm¬ks
();

208 
haveIn™Ÿli£dLªdm¬ks
 = 
Œue
;

210 
	}
}

212 
AbsCoÜd
 
	gICP
::
	$g‘CombšedObs
(){

213  
combšedObs
;

214 
	}
}

216 
	g¡d
::
veùÜ
<
LšeInfo
> 
ICP
::
	$g‘AÎF›ldLšes
() {

217  
®lF›ldLšes
;

218 
	}
}

221 
	gICP
::
loÿli£
ĞcÚ¡ 
AbsCoÜd
 &
robÙPos
,

222 cÚ¡ 
¡d
::
veùÜ
<
F›ldF—tu»Info
> &
f›ldF—tu»s
,

223 cÚ¡ 
¡d
::
veùÜ
<
Po¡Info
> &
po¡s
,

224 cÚ¡ 
awayGßlProb
,

225 cÚ¡ 
h—dYaw
,

226 cÚ¡ 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> &
f›ldBound¬›s
,

227 cÚ¡ 
AbsCoÜd
 &
b®lRRC
, 
boŞ
 
isLo¡
,

228 cÚ¡ 
AbsCoÜd
 &
‹amB®l
 ){

230 
»£t
();

232 
Tim”
 
	gtim”
;

233 
	gtim”
.
»¡¬t
();

235 
Îog
(
DEBUG1
) << "\nICP called\n";

237 
´•roûssF—tu»s
(
f›ldF—tu»s
, 
po¡s
, 
f›ldBound¬›s
);

239 iàĞ
	gtÙ®N
==0 )  
ICP_NO_OBS
;

242 iàĞ
	gisLo¡
 && 
	gtÙ®N
<=2 && !
f›ldLšes
.
em±y
()è 
ICP_LOST
;

244 
	gcombšedObs
 = 
robÙPos
;

245 
assocŸ‹F—tu»s
(1);

246 
sŞve
();

247 
	g»suÉ
 = 
ICP_LOST
;

250 ià(
	gm£
 < 
	gLOCALISED
 &&

251 
abs
(
combšedObs
.
x
()è< (
	gFULL_FIELD_LENGTH
/2 + 500) &&

252 
abs
(
combšedObs
.
y
()è< (
	gFULL_FIELD_WIDTH
/2 + 500)) {

255 
	gcombšedObs
.
th‘a
(èğ
NORMALISE
(
combšedObs
.theta());

259 ià(
	gN
>=2 && 
nÚLšeF—tu»
) {

260 
x_known
=
Œue
;

261 
	gy_known
=
Œue
;

264 
	gsm®lPosV¬Ÿnû
 = 1.0;

265 
	gÏrgePosV¬Ÿnû
 = -1.0;

266 
	gsm®lH—dšgV¬Ÿnû
 = 1.0;

267 
	gÏrgeH—dšgV¬Ÿnû
 = -1;

269 ià(
	gx_known
) {

270 
	gcombšedObs
.
v¬
(0, 0èğ
sm®lPosV¬Ÿnû
;

272 
	gcombšedObs
.
v¬
(0, 0èğ
ÏrgePosV¬Ÿnû
;

273 ià(
	gy_known
è
	gcombšedObs
.
x
(èğ
robÙPos
.x();

276 ià(
	gy_known
) {

277 
	gcombšedObs
.
v¬
(1, 1èğ
sm®lPosV¬Ÿnû
;

279 
	gcombšedObs
.
v¬
(1, 1èğ
ÏrgePosV¬Ÿnû
;

280 ià(
	gx_known
è
	gcombšedObs
.
y
(èğ
robÙPos
.y();

283 ià(
	gN
==1è
combšedObs
.
v¬
(2, 2èğ
ÏrgeH—dšgV¬Ÿnû
;

284 
	gcombšedObs
.
v¬
(2, 2èğ
sm®lH—dšgV¬Ÿnû
;

286 
	g»suÉ
 = 
N
;

287 
Îog
(
DEBUG1
è<< "ICP†oÿli£d, MSE=" << 
sq¹
(
m£
è<< 
	g¡d
::
’dl
;

290 
Îog
(
DEBUG1
è<< "ICP couldn'ˆloÿli£ o¸nÙ oÀf›ld, MSE=" << 
sq¹
(
m£
è<< 
	g¡d
::
’dl
;

293 
Îog
(
DEBUG1
è<< "ICP†oÿli§tiÚook " << 
	gtim”
.
–­£d_us
(è<< " us" << 
	g¡d
::
’dl
;

294 ià(
	gtim”
.
–­£d_us
() > 30000) {

295 
Îog
(
ERROR
è<< "ICPook " << 
	gtim”
.
–­£d_us
(è<< " us" << 
	g¡d
::
’dl
;

298  
	g»suÉ
;

304 
´•roûssF—tu»s
ĞcÚ¡ 
¡d
::
veùÜ
<
F›ldF—tu»Info
> &
f›ldF—tu»s
,

305 cÚ¡ 
¡d
::
veùÜ
<
Po¡Info
> &
po¡s
,

306 cÚ¡ 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> &
f›ldBound¬›s
){

308 
po¡Obs
 = 
po¡s
;

309 ià(!
	gpo¡s
.
em±y
()è
	gsšgËF—tu»
 = 
po¡s
[0].
¼
;

311 
	gf›ldEdgeObs
.
ş—r
();

313 
	g·¿Î–Lšes
.
ş—r
();

314 
	g·¿Î–LšeTy³s
.
ş—r
();

316 
	gcÜÃrs
.
ş—r
();

317 
	gcÜÃrTy³s
.
ş—r
();

319 
	gTJunùiÚs
.
ş—r
();

320 
	gTJunùiÚTy³s
.
ş—r
();

322 
	gûÁ»Cœşes
.
ş—r
();

324 
	gf›ldLšes
.
ş—r
();

325 
	glšeL’gths
.
ş—r
();

326 
	glšePo¡Di¡
.
ş—r
();

327 
	glšeEdgeDi¡
.
ş—r
();

329 
	gtÙ®N
 = 0;

330 
	gmšI‹¿tiÚs
= 0;

332 
	g¡d
::
veùÜ
<
F›ldF—tu»Info
>::
cÚ¡_™”©Ü
 
ã©u»
 = 
f›ldF—tu»s
.
begš
();

333 ; 
	gã©u»
!=
f›ldF—tu»s
.
’d
(); ++feature){

334 
	gã©u»
->
	gty³
) {

336 
	gF›ldF—tu»Info
::
fP¬®ËlLšes
:

338 if(
·¿Î–Lšes
.
em±y
()è
mšI‹¿tiÚs
++;

341 
P¬®ËlLšesInfo
 
	g¶
 = 
ã©u»
->
·¿Î–lšes
;

342 
boŞ
 
	g¶Known
 = 
çl£
;

343 
	gmšEdgeDi¡
 = 
UNKNOWN_COORD
;

344 
	g¡d
::
veùÜ
<
F›ldBound¬yInfo
>::
cÚ¡_™”©Ü
 
edge
 = 
f›ldBound¬›s
.
begš
();

345 ; 
	gedge
!=
f›ldBound¬›s
.
’d
(); ++edge){

346 
	gdi¡1
 = 
di¡LšeToBound¬y
(
¶
.
l1
, *
edge
);

347 
	gdi¡2
 = 
di¡LšeToBound¬y
(
¶
.
l2
, *
edge
);

349 ià(
	gdi¡1
 !ğ0.à&& 
çbs
(
di¡1
è< 
mšEdgeDi¡
 && fabs(di¡1è< (1.f-
EDGE_ERROR_PERCENT
)*
FIELD_LENGTH
){

350 
mšEdgeDi¡
 = 
çbs
(
di¡1
);

352 
	g¶Known
 = 
Œue
;

354 ià(
	gdi¡2
 !ğ0.à&& 
çbs
(
di¡2
è< 
mšEdgeDi¡
 && fabs(
di¡1
è< (1.f-
EDGE_ERROR_PERCENT
)*
FIELD_LENGTH
){

356 
¶Known
 = 
Œue
;

358 
	gmšEdgeDi¡
 = 
çbs
(
di¡2
);

359 
LšeInfo
 
	g‹mp
 = 
¶
.
l1
;

360 
	g¶
.
	gl1
 = 
¶
.
l2
;

361 
	g¶
.
	gl2
 = 
‹mp
;

365 ià(!
	g¶Known
){

366 
	g¡d
::
veùÜ
<
Po¡Info
>::
cÚ¡_™”©Ü
 
po¡
 = 
po¡Obs
.
begš
();

367 ; 
	gpo¡
!=
po¡Obs
.
’d
(); ++post){

368 
Pošt
 
	gpo¡XY
 = 
po¡
->
¼
.
toC¬‹sŸn
();

369 
Pošt
 
	gdisÿrd
;

370 
	gpo¡Di¡1
 = 
di¡2ToLše
(
¶
.
l1
, 
po¡XY
, 
disÿrd
);

371 
	gpo¡Di¡2
 = 
di¡2ToLše
(
¶
.
l2
, 
po¡XY
, 
disÿrd
);

372 
Îog
(
DEBUG1
è<< "P¬®ËÈlšpo¡ di¡ ¬e: " << 
	gpo¡Di¡1
 << ", " << 
	gpo¡Di¡2
 << "\n";

373 iàĞ
çbs
(
po¡Di¡1
è< 
	gMIN_POST_ERROR
){

374 
Îog
(
DEBUG1
) << "Using dist1 for…ost\n";

375 
	g¶Known
 = 
Œue
;

377 } iàĞ
çbs
(
po¡Di¡2
è< 
	gMIN_POST_ERROR
){

378 
Îog
(
DEBUG1
) << "Using dist1 for…ost, swap†ines\n";

380 
LšeInfo
 
	g‹mp
 = 
¶
.
l1
;

381 
	g¶
.
	gl1
 = 
¶
.
l2
;

382 
	g¶
.
	gl2
 = 
‹mp
;

383 
	g¶Known
 = 
Œue
;

389 
Pošt
 
	glše2mid
 = (
¶
.
l2
.
p1
 +…l.l2.
p2
)/2;

390 
PoštF
 
	glše1VeùÜ
 = (
¶
.
l1
.
p2
 -…l.l1.
p1
).
ÿ¡
<>();

391 
	gside
 = 
lše1VeùÜ
.
x
()*(
lše2mid
.
y
()-
¶
.
l1
.
p1
.y()) -†ine1Vector.y()*(line2mid.x()-pl.l1.p1.x());

392 ià(
	gside
 > 0.f){

393 
Pošt
 
	g‹mp
 = 
¶
.
l1
.
p1
;

394 
	g¶
.
	gl1
.
	gp1
 = 
¶
.
l1
.
p2
;

395 
	g¶
.
	gl1
.
	gp2
 = 
‹mp
;

398 
Pošt
 
	glše1mid
 = (
¶
.
l1
.
p1
 +…l.l1.
p2
)/2;

399 
PoštF
 
	glše2VeùÜ
 = (
¶
.
l2
.
p2
 -…l.l2.
p1
).
ÿ¡
<>();

400 
	gside
 = 
lše2VeùÜ
.
x
()*(
lše1mid
.
y
()-
¶
.
l2
.
p1
.y()) -†ine2Vector.y()*(line1mid.x()-pl.l2.p1.x());

401 ià(
	gside
 > 0.f){

402 
Pošt
 
	g‹mp
 = 
¶
.
l2
.
p1
;

403 
	g¶
.
	gl2
.
	gp1
 = 
¶
.
l2
.
p2
;

404 
	g¶
.
	gl2
.
	gp2
 = 
‹mp
;

407 ià(
	g¶Known
){

408 
	g·¿Î–LšeTy³s
.
push_back
(
PL_KNOWN
);

410 
	g·¿Î–LšeTy³s
.
push_back
(
PL_UNKNOWN
);

412 
	g·¿Î–Lšes
.
push_back
(
¶
);

418 
	gF›ldF—tu»Info
::
fLše
:

419 iàĞ!
ã©u»
->
lšeU£d
){

420 if(
f›ldLšes
.
em±y
()è
mšI‹¿tiÚs
++;

422 
	gf›ldLšes
.
push_back
(
ã©u»
->
lše
);

425 
	gËn2
 = 
DISTANCE_SQR
(
f›ldLšes
.
back
().
p1
.
x
(), f›ldLšes.back().p1.
y
(),

426 
f›ldLšes
.
back
().
p2
.
x
(), f›ldLšes.back().p2.
y
());

427 
	glšeL’gths
.
push_back
(
Ën2
);

430 
	gpo¡Di¡2
 = 
UNKNOWN_COORD
;

431 
PoštF
 
	glšeVeùÜ
 = (
f›ldLšes
.
back
().
p2
 - f›ldLšes.back().
p1
).
ÿ¡
<>();

433 
	g¡d
::
veùÜ
<
Po¡Info
>::
cÚ¡_™”©Ü
 
po¡
 = 
po¡Obs
.
begš
();

434 ; 
	gpo¡
!=
po¡Obs
.
’d
(); ++post){

435 
Pošt
 
	gpo¡XY
 = 
po¡
->
¼
.
toC¬‹sŸn
();

436 
Pošt
 
	gdisÿrd
;

438 
	gdi¡2
 = 
sq¹
(
di¡2ToLše
(
f›ldLšes
.
back
(), 
po¡XY
, 
disÿrd
));

439 ià(
	gdi¡2
 < 
çbs
(
po¡Di¡2
)) {

441 
PoštF
 
	glšeVeùÜ
 = (
f›ldLšes
.
back
().
p2
 - f›ldLšes.back().
p1
).
ÿ¡
<>();

443 
	gside
 = 
lšeVeùÜ
.
x
()*(
po¡XY
.
y
()-
f›ldLšes
.
back
().
p1
.y()) -

444 
lšeVeùÜ
.
y
()*(
po¡XY
.
x
()-
f›ldLšes
.
back
().
p1
.x());

445 ià(
	gside
 > 0.f){

446 
	gpo¡Di¡2
 = 
di¡2
;

448 
	gpo¡Di¡2
 = -
di¡2
;

453 
	glšePo¡Di¡
.
push_back
(
po¡Di¡2
);

456 
	gedgeDi¡
 = 
UNKNOWN_COORD
;

457 
	g¡d
::
veùÜ
<
F›ldBound¬yInfo
>::
cÚ¡_™”©Ü
 
edge
 = 
f›ldBound¬›s
.
begš
();

458 ; 
	gedge
!=
f›ldBound¬›s
.
’d
(); ++edge){

459 
	gdi¡
 = 
di¡LšeToBound¬y
(
f›ldLšes
.
back
(), *
edge
);

460 ià(
	gdi¡
 !ğ0.à&& 
çbs
(
di¡
è< fabs(
edgeDi¡
)){

461 
edgeDi¡
 = 
di¡
;

464 
	glšeEdgeDi¡
.
push_back
(
edgeDi¡
);

468 
	gF›ldF—tu»Info
::
fCÜÃr
:

470 if(
cÜÃrs
.
em±y
()è
mšI‹¿tiÚs
++;

471 
	gcÜÃrs
.
push_back
(
ã©u»
->
¼
);

478 
	g¡d
::
veùÜ
<
F›ldBound¬yInfo
>::
cÚ¡_™”©Ü
 
edge
 = 
f›ldBound¬›s
.
begš
();

479 
F—tu»Ty³
 
	gty³
 = 
C_UNKNOWN
;

481 
LšeInfo
 
	gËá_¬m
, 
	gright_¬m
;

482 
Pošt
 
	gûÁ»
 = 
ã©u»
->
¼
.
toC¬‹sŸn
();

483 
	gËá_¬m_Ü›Á
 = 
NORMALISE
(
ã©u»
->
¼
.
h—dšg
(è- 
M_PI
 + f—tu»->¼.
Ü›Á©iÚ
(è+ 
M_PI_4
);

484 
	gright_¬m_Ü›Á
 = 
NORMALISE
(
ã©u»
->
¼
.
h—dšg
(è- 
M_PI
 + f—tu»->¼.
Ü›Á©iÚ
(è- 
M_PI_4
);

485 
	gËá_¬m
.
	gp1
 = 
ûÁ»
 - 
Pošt
(1000*
cos
(
Ëá_¬m_Ü›Á
), 1000*
sš
(left_arm_orient));

486 
	gËá_¬m
.
	gp2
 = 
ûÁ»
 + 
Pošt
(1000*
cos
(
Ëá_¬m_Ü›Á
), 1000*
sš
(left_arm_orient));

487 
	gright_¬m
.
	gp1
 = 
ûÁ»
 - 
Pošt
(1000*
cos
(
right_¬m_Ü›Á
), 1000*
sš
(right_arm_orient));

488 
	gright_¬m
.
	gp2
 = 
ûÁ»
 + 
Pošt
(1000*
cos
(
right_¬m_Ü›Á
), 1000*
sš
(right_arm_orient));

490 ; 
	gedge
!=
f›ldBound¬›s
.
’d
(); ++edge){

494 
	gdi¡_Ëá
 = 
di¡LšeToBound¬y
(
Ëá_¬m
 , *
edge
);

495 
	gdi¡_right
 = 
di¡LšeToBound¬y
(
right_¬m
 , *
edge
);

497 
Îog
(
DEBUG1
è<< "CÜÃ¸şassifiÿtiÚ: di¡_Ëá, di¡_righˆğ" << 
	gdi¡_Ëá
 << ", " << 
	gdi¡_right
 << "\n";

499 ià(
	gdi¡_Ëá
 < 0.à&& 
çbs
(
di¡_Ëá
) <

500 (1.à+ 
	gEDGE_ERROR_PERCENT
)*(
	gGOAL_BOX_LENGTH
+
	gFIELD_LENGTH_OFFSET
)){

501 
	gty³
 = 
C_GB_RIGHT
;

503 } ià(
	gdi¡_right
 > 0.à&& 
çbs
(
di¡_right
) <

504 (1.à+ 
	gEDGE_ERROR_PERCENT
)*(
	gGOAL_BOX_LENGTH
+
	gFIELD_LENGTH_OFFSET
)){

505 
	gty³
 = 
C_GB_LEFT
;

507 } ià(
	gdi¡_right
 < 0.à&& 
çbs
(
di¡_right
) <

508 (1.à+ 
	gEDGE_ERROR_PERCENT
)*
	g¡d
::
max
(
FIELD_WIDTH_OFFSET
,
FIELD_LENGTH_OFFSET
)){

509 
	gty³
 = 
C_OUTSIDE
;

511 } ià(
	gdi¡_Ëá
 > 0.à&& 
çbs
(
di¡_Ëá
) <

512 (1.à+ 
	gEDGE_ERROR_PERCENT
)*
	g¡d
::
max
(
FIELD_WIDTH_OFFSET
,
FIELD_LENGTH_OFFSET
)){

513 
	gty³
 = 
C_OUTSIDE
;

517 
	gcÜÃrTy³s
.
push_back
(
ty³
);

521 
	gF›ldF—tu»Info
::
fTJunùiÚ
:

523 if(
TJunùiÚs
.
em±y
()è
mšI‹¿tiÚs
++;

525 
	gTJunùiÚs
.
push_back
(
ã©u»
->
¼
);

528 
F—tu»Ty³
 
	gty³
 = 
T_NO_POST
;

529 
	g¡d
::
veùÜ
<
Po¡Info
>::
cÚ¡_™”©Ü
 
po¡
 = 
po¡Obs
.
begš
();

530 ; 
	gpo¡
!=
po¡Obs
.
’d
(); ++post){

532 
Pošt
 
	gtXY
 = 
ã©u»
->
¼
.
toC¬‹sŸn
();

533 
Pošt
 
	gpo¡XY
 = 
po¡
->
¼
.
toC¬‹sŸn
();

534 
	gdi¡2
 = 
DISTANCE_SQR
(
tXY
.
x
(),XY.
y
(), 
po¡XY
.x(),…ostXY.y());

536 ià(
	gdi¡2
 < 
SQUARE
(
GOAL_BOX_WIDTH
 - 
GOAL_WIDTH
)){

538 
	gpo¡Dœ
 = 
©ª2
(
po¡XY
.
y
(è- 
tXY
.y(),…o¡XY.
x
() -XY.x());

539 iàĞ
NORMALISE
(
ã©u»
->
¼
.
h—dšg
(è- f—tu»->¼.
Ü›Á©iÚ
(è- 
po¡Dœ
) > 0 ){

540 
	gty³
 = 
T_POST_RIGHT
;

542 
	gty³
 = 
T_POST_LEFT
;

546 
	gTJunùiÚTy³s
.
push_back
(
ty³
);

550 
	gF›ldF—tu»Info
::
fC’ŒeCœşe
:

551 if(
ûÁ»Cœşes
.
em±y
()è
mšI‹¿tiÚs
++;

552 
	gsšgËF—tu»
 = 
ã©u»
->
¼
;

553 if(!
i¢ª
(
ã©u»
->
¼
.
Ü›Á©iÚ
()) ){

554 
	gtÙ®N
++;

556 
	gûÁ»Cœşes
.
push_back
(
ã©u»
->
¼
);

564 
	gtÙ®N
 +ğ(èĞ
po¡s
.
size
(è+ 4*
·¿Î–Lšes
.size(è+ 2*
f›ldLšes
.size(è+ 
ûÁ»Cœşes
.size() +

565 2*
TJunùiÚs
.
size
(è+ 2*
cÜÃrs
.size() );

569 ià(
	gtÙ®N
 == 0){

570 
Îog
(
DEBUG1
) << "Fieldƒdge is only feature\n";

571 
	g¡d
::
veùÜ
<
F›ldBound¬yInfo
>::
cÚ¡_™”©Ü
 
edge
 = 
f›ldBound¬›s
.
begš
();

572 ; 
	gedge
!=
f›ldBound¬›s
.
’d
(); ++edge){

573 
LšeInfo
 
	glše
;

574 
	glše
.
	gp1
 = 
edge
->
¼Bound¬y
.
p1
;

575 
	glše
.
	gp2
 = 
edge
->
¼Bound¬y
.
p2
;

576 
Pošt
 
	grobÙ
 = Point(0,0);

577 
Pošt
 
	gdisÿrd
;

578 
	gedgeDi¡
 = 
çbs
(
di¡2ToLšeSeg
(
lše
, 
robÙ
, 
disÿrd
));

579 
Îog
(
DEBUG1
è<< "Di¡Øf›ldƒdgi : " << 
sq¹
(
edgeDi¡
) << "\n";

582 iàĞ
	gedgeDi¡
 < 
SQUARE
(2*
¡d
::
max
(
FIELD_LENGTH_OFFSET
, 
FIELD_WIDTH_OFFSET
))){

585 ià(
	glše
.
	gp1
.
y
(è<†še.
	gp2
.y()){

586 
Pošt
 
	g‹mp
 = 
lše
.
p1
;

587 
	glše
.
	gp1
 = 
lše
.
p2
;

588 
	glše
.
	gp2
 = 
‹mp
;

590 
	gf›ldEdgeObs
.
push_back
(
lše
);

593 
	gtÙ®N
 = (è2*
f›ldEdgeObs
.
size
();

594 
	gmšI‹¿tiÚs
++;

599 
	gmšI‹¿tiÚs
 +ğ(è
po¡s
.
size
();

603 
	gmšI‹¿tiÚs
 +ğ(è
·¿Î–Lšes
.
size
();

608 
	$di¡LšeToBound¬y
(cÚ¡ 
LšeInfo
 
lše
, cÚ¡ 
F›ldBound¬yInfo
 
bound¬y
){

610 
PoštF
 
lšeVeùÜ
 = (
lše
.
p2
 -†še.
p1
).
ÿ¡
<>();

611 
lšeVeùÜ
 /ğ
	`hypÙ
ÖšeVeùÜ.
	`x
(),†šeVeùÜ.
	`y
());

613 
PoštF
 
edgeVeùÜ
 = (
bound¬y
.
¼Bound¬y
.
p1
 - bound¬y.¼Bound¬y.
p2
).
ÿ¡
<>();

614 
edgeVeùÜ
 /ğ
	`hypÙ
ÓdgeVeùÜ.
	`x
(),ƒdgeVeùÜ.
	`y
());

617 
dÙ
 = 
lšeVeùÜ
.
	`dÙ
(
edgeVeùÜ
);

618 iàĞ
	`çbs
(
dÙ
è> 
	`cos
(
PARALLEL_THRESH
) ){

619 
LšeInfo
 
edg–še
;

620 
edg–še
.
p1
 = 
bound¬y
.
¼Bound¬y
.p1;

621 
edg–še
.
p2
 = 
bound¬y
.
¼Bound¬y
.p2;

622 
Pošt
 
f›ldEdgePošt
;

623 
di¡
 = 
	`sq¹
(
	`di¡2ToLše
(
edg–še
, (
lše
.
p1
 +†še.
p2
)/2, 
f›ldEdgePošt
));

625 
side
 = 
lšeVeùÜ
.
	`x
()*(
f›ldEdgePošt
.
	`y
()-
lše
.
p1
.y()) -

626 
lšeVeùÜ
.
	`y
()*(
f›ldEdgePošt
.
	`x
()-
lše
.
p1
.x());

627 ià(
side
 > 0.f){

628  
di¡
;

630  -
di¡
;

636 
	}
}

639 
	$assocŸ‹F—tu»s
(
assocŸtiÚ
){

652 
sourû
.
	`ş—r
();

653 
rg‘
.
	`ş—r
();

654 
rg‘Ty³
.
	`ş—r
();

655 
di¡ªûs
.
	`ş—r
();

656 
weights
.
	`ş—r
();

657 
N
 = 0;

658 
thisAssocŸtiÚ
 = 0;

659 
x_known
=
çl£
;

660 
y_known
=
çl£
;

661 
nÚLšeF—tu»
=
çl£
;

663 
	`Îog
(
DEBUG1
) << "Associatinghese features:\n";

666 ià(
po¡Obs
.
	`size
() == 2){

667 
	`Îog
(
DEBUG1
) << "Two…osts\n";

668 
¡d
::
veùÜ
<
Po¡Info
>::
cÚ¡_™”©Ü
 
po¡
 = 
po¡Obs
.
	`begš
();

669 
Ï¡Po¡
 = 
Po¡Info
::
pNÚe
;

670 ; 
po¡
!=
po¡Obs
.
	`’d
(); ++post){

674 
thisPo¡
 = 
po¡
->
ty³
 | (
Ï¡Po¡
 & (
Po¡Info
::
pHome
 | Po¡Info::
pAway
));

677 
Ï¡Po¡
 = 
	`m©chObs
(
po¡
->
¼
, 
®lPo¡s
, 
POST_WEIGHT
, 
thisPo¡
, 
®lPo¡Ty³s
);

680 
nÚLšeF—tu»
 = 
Œue
;

681 
x_known
 = 
Œue
;

682 
y_known
 = 
Œue
;

685 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

688 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

694 if(!
·¿Î–Lšes
.
	`em±y
()){

695 
i
=0; i<()
·¿Î–Lšes
.
	`size
(); i++){

696 ià(
·¿Î–LšeTy³s
[
i
] =ğ
PL_KNOWN
){

697 
	`Îog
(
DEBUG1
) << "Parallel Lines,…oints‡re clockwise, goal†ine†isted first\n";

698 
	`m©chP¬®ËlLše
(
·¿Î–Lšes
[
i
].
l1
,…¬®ËlLšes[i].
l2
, 
Œue
, (
assocŸtiÚ
==1));

700 
	`Îog
(
DEBUG1
) << "Parallel Lines,…oints‡re clockwise, goal†ine is‚ot known\n";

701 
	`m©chP¬®ËlLše
(
·¿Î–Lšes
[
i
].
l1
,…¬®ËlLšes[i].
l2
, 
çl£
, (
assocŸtiÚ
==1));

705 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

708 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

714 if(!
cÜÃrs
.
	`em±y
()){

715 
i
=0; i<()
cÜÃrs
.
	`size
(); i++){

716 ià(
cÜÃrTy³s
[
i
] =ğ
C_GB_RIGHT
){

717 
	`Îog
(
DEBUG1
) << "Corner, GB RIGHT\n";

718 } ià(
cÜÃrTy³s
[
i
] =ğ
C_GB_LEFT
){

719 
	`Îog
(
DEBUG1
) << "Corner, GB LEFT\n";

720 } ià(
cÜÃrTy³s
[
i
] =ğ
C_OUTSIDE
){

721 
	`Îog
(
DEBUG1
) << "Corner, OUTSIDE\n";

723 
	`Îog
(
DEBUG1
) << "Corner, UNKNOWN\n";

725 
	`m©chObs
(
cÜÃrs
[
i
], 
®lCÜÃrs
, 
CORNER_WEIGHT
, 
cÜÃrTy³s
[i], 
®lCÜÃrTy³s
);

727 
nÚLšeF—tu»
 = 
Œue
;

728 
x_known
 = 
Œue
;

729 
y_known
 = 
Œue
;

730 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

736 if(!
TJunùiÚs
.
	`em±y
()){

737 
i
=0; i<()
TJunùiÚs
.
	`size
(); i++){

738 ià(
TJunùiÚTy³s
[
i
] =ğ
T_POST_RIGHT
){

739 
	`Îog
(
DEBUG1
) << "T Junction, POST RIGHT\n";

740 } ià(
TJunùiÚTy³s
[
i
] =ğ
T_POST_LEFT
){

741 
	`Îog
(
DEBUG1
) << "T Junction, POST LEFT\n";

743 
	`Îog
(
DEBUG1
) << "T Junction, NO POST\n";

745 
	`m©chObs
(
TJunùiÚs
[
i
], 
®lTJunùiÚs
, 
T_WEIGHT
, 
TJunùiÚTy³s
[i], 
®lTJunùiÚTy³s
);

747 
x_known
 = 
Œue
;

748 
y_known
 = 
Œue
;

749 
nÚLšeF—tu»
 = 
Œue
;

750 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

756 ià(
po¡Obs
.
	`size
() == 1){

757 
	`Îog
(
DEBUG1
) << "One…ost\n";

759 
	`m©chObs
(
po¡Obs
[0].
¼
, 
®lPo¡s
, 
POST_WEIGHT
,…o¡Obs[0].
ty³
, 
®lPo¡Ty³s
);

760 
nÚLšeF—tu»
 = 
Œue
;

761 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

767 if(!
ûÁ»Cœşes
.
	`em±y
()){

768 
i
=0; i<()
ûÁ»Cœşes
.
	`size
(); i++){

769 
	`Îog
(
DEBUG1
) << "Centre circle\n";

770 
	`m©chObs
(
ûÁ»Cœşes
[
i
], 
®lCœşes
, 
CIRCLE_WEIGHT
);

772 
nÚLšeF—tu»
 = 
Œue
;

773 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

779 if(!
f›ldLšes
.
	`em±y
()){

783 
boŞ
 
cÚ¡¿šOr›Á©iÚ
 = 
çl£
;

785 ià(
N
>=2 && (
nÚLšeF—tu»
 || !
·¿Î–Lšes
.
	`em±y
()è&& ()
ûÁ»Cœşes
.
	`size
()!=N ){

786 
cÚ¡¿šOr›Á©iÚ
 = 
Œue
;

788 
i
=0; i<()
f›ldLšes
.
	`size
(); i++){

789 
	`Îog
(
DEBUG1
è<< "F›ld†šw™h†’gth: " << 
	`sq¹
(
lšeL’gths
[
i
]) << ",…ost dist: " <<

790 
lšePo¡Di¡
[
i
] << ",ƒdgdi¡: " << 
lšeEdgeDi¡
[i] << ", constrain Orientation: "

791 << 
cÚ¡¿šOr›Á©iÚ
 << "\n";

792 
	`m©chLše
(
f›ldLšes
[
i
], 
lšeL’gths
[i], 
lšePo¡Di¡
[i], 
lšeEdgeDi¡
[i], 
cÚ¡¿šOr›Á©iÚ
);

794 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

800 if(
N
==0 && !
f›ldEdgeObs
.
	`em±y
()){

802 
¡d
::
veùÜ
<
LšeInfo
>::
cÚ¡_™”©Ü
 
edge
 = 
f›ldEdgeObs
.
	`begš
();

803 ; 
edge
!=
f›ldEdgeObs
.
	`’d
(); ++edge){

804 
	`Îog
(
DEBUG1
) << "Fieldƒdge\n";

805 
	`m©chEdge
(*
edge
);

807 if(++
thisAssocŸtiÚ
 =ğ
assocŸtiÚ
) {

815 
	}
}

819 
boŞ
 
	$m©chP¬®ËlLše
(cÚ¡ 
LšeInfo
 
lše1
, cÚ¡ LšeInfØ
lše2
, 
boŞ
 
Üd”Known
, boŞ 
fœ¡M©ch
){

821 
boŞ
 
»suÉ
 = 
çl£
;

824 
LšeInfo
 
ab¦še1
, 
ab¦še2
;

825 
ab¦še1
.
p1
 = 
	`ŒªsfÜm
(
lše1
.p1, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

826 
ab¦še1
.
p2
 = 
	`ŒªsfÜm
(
lše1
.p2, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

827 
ab¦še2
.
p1
 = 
	`ŒªsfÜm
(
lše2
.p1, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

828 
ab¦še2
.
p2
 = 
	`ŒªsfÜm
(
lše2
.p2, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

831 
Ën1
 = 
	`DISTANCE_SQR
(
ab¦še1
.
p1
.
	`x
(),‡b¦še1.p1.
	`y
(),‡b¦še1.
p2
.x(),‡bsline1.p2.y());

832 
Ën2
 = 
	`DISTANCE_SQR
(
ab¦še2
.
p1
.
	`x
(),‡b¦še2.p1.
	`y
(),‡b¦še2.
p2
.x(),‡bsline2.p2.y());

835 
mš
 = 
FLT_MAX
;

836 
diff
 = 0.f;

837 
Pošt
 
be¡_tgt1p1
 = 
	`Pošt
(0,0), 
be¡_tgt1p2
 = Pošt(0,0), 
be¡_tgt2p1
 = Pošt(0,0), 
be¡_tgt2p2
 = Point(0,0);

838 
Pošt
 
tgt1p1
, 
tgt1p2
, 
tgt2p1
, 
tgt2p2
;

839 
T¬g‘Ty³
 
tgt1ty³1
=
POINT
, 
tgt1ty³2
=POINT, 
tgt2ty³1
=POINT, 
tgt2ty³2
=POINT;

842 
lmk
 = 0;†mk < ()
·¿Î–F›ldLšes
.
	`size
();†mk++){

845 ià(
Üd”Known
 && (
lmk
%2==1) ) {

850 ià(
·¿Î–F›ldL’gths
[
lmk
].
fœ¡
 < 
Ën1
 ||…¬®ËlF›ldL’gths[lmk].
£cÚd
 < 
Ën2
) ;

853 
diff
 = 
	`di¡2ToLšeSeg
(
·¿Î–F›ldLšes
[
lmk
].
fœ¡
, 
ab¦še1
.
p1
, 
tgt1p1
);

854 
diff
 +ğ
	`di¡2ToLšeSeg
(
·¿Î–F›ldLšes
[
lmk
].
fœ¡
, 
ab¦še1
.
p2
, 
tgt1p2
);

855 
diff
 +ğ
	`di¡2ToLšeSeg
(
·¿Î–F›ldLšes
[
lmk
].
£cÚd
, 
ab¦še2
.
p1
, 
tgt2p1
);

856 
diff
 +ğ
	`di¡2ToLšeSeg
(
·¿Î–F›ldLšes
[
lmk
].
£cÚd
, 
ab¦še2
.
p2
, 
tgt2p2
);

858 
g¿d›Á
 = (
ab¦še1
.
p2
.
	`y
(è-‡b¦še1.
p1
.y())/×b¦še1.p2.
	`x
() -‡bsline1.p2.x());

859 ià(
fœ¡M©ch
 && (
diff
 > 4*
	`SQUARE
(1000è|| 
	`çbs
(
g¿d›Á
) < 1.f) ){

861 
	`Îog
(
DEBUG1
) << "Evaluating Parallel†ine match: matchingo 4 goal box corners\n";

863 
tgt1p1
 = 
·¿Î–Pošts
[
lmk
][0];

864 
diff
 = 
	`DISTANCE_SQR
(
ab¦še1
.
p1
.
	`x
(),‡b¦še1.p1.
	`y
(), 
tgt1p1
.x(),gt1p1.y());

865 
tgt1p2
 = 
·¿Î–Pošts
[
lmk
][1];

866 
diff
 +ğ
	`DISTANCE_SQR
(
ab¦še1
.
p2
.
	`x
(),‡b¦še1.p2.
	`y
(), 
tgt1p2
.x(),gt1p2.y());

867 
tgt2p1
 = 
·¿Î–Pošts
[
lmk
][2];

868 
diff
 +ğ
	`DISTANCE_SQR
(
ab¦še2
.
p1
.
	`x
(),‡b¦še2.p1.
	`y
(), 
tgt2p1
.x(),gt2p1.y());

869 
tgt2p2
 = 
·¿Î–Pošts
[
lmk
][3];

870 
diff
 +ğ
	`DISTANCE_SQR
(
ab¦še2
.
p2
.
	`x
(),‡b¦še2.p2.
	`y
(), 
tgt2p2
.x(),gt2p2.y());

874 ià(
diff
 < 
mš
) {

878 if(
tgt1p1
 =ğ
·¿Î–F›ldLšes
[
lmk
].
fœ¡
.
p1
 ||gt1p1 =ğ·¿Î–F›ldLšes[lmk].fœ¡.
p2
 || 
tÙ®N
<5)

879 
tgt1ty³1
 = 
POINT
;

880 
tgt1ty³1
 = 
VERT_LINE
;

881 if(
tgt1p2
 =ğ
·¿Î–F›ldLšes
[
lmk
].
fœ¡
.
p1
 ||gt1p2 =ğ·¿Î–F›ldLšes[lmk].fœ¡.
p2
 || 
tÙ®N
<5)

882 
tgt1ty³2
 = 
POINT
;

883 
tgt1ty³2
 = 
VERT_LINE
;

884 if(
tgt2p1
 =ğ
·¿Î–F›ldLšes
[
lmk
].
£cÚd
.
p1
 ||gt2p1 =ğ·¿Î–F›ldLšes[lmk].
fœ¡
.
p2
 || 
tÙ®N
<5)

885 
tgt2ty³1
 = 
POINT
;

886 
tgt2ty³1
 = 
VERT_LINE
;

887 if(
tgt2p2
 =ğ
·¿Î–F›ldLšes
[
lmk
].
£cÚd
.
p1
 ||gt2p2 =ğ·¿Î–F›ldLšes[lmk].
fœ¡
.
p2
 || 
tÙ®N
<5)

888 
tgt2ty³2
 = 
POINT
;

889 
tgt2ty³2
 = 
VERT_LINE
;

891 
mš
 = 
diff
;

892 
be¡_tgt1p1
 = 
tgt1p1
;

893 
be¡_tgt1p2
 = 
tgt1p2
;

894 
be¡_tgt2p1
 = 
tgt2p1
;

895 
be¡_tgt2p2
 = 
tgt2p2
;

896 
»suÉ
 = 
Œue
;

900 ià(
»suÉ
) {

902 
	`addToPoštCloud
(
ab¦še1
.
p1
, 
be¡_tgt1p1
, 
	`sq¹
(
mš
), 
PARALLEL_LINE_WEIGHT
/(
	`hypÙ
(
lše1
.p1.
	`x
(),†še1.p1.
	`y
())/1000), 
tgt1ty³1
);

903 
	`addToPoštCloud
(
ab¦še1
.
p2
, 
be¡_tgt1p2
, 
	`sq¹
(
mš
), 
PARALLEL_LINE_WEIGHT
/(
	`hypÙ
(
lše1
.p2.
	`x
(),†še1.p2.
	`y
())/1000), 
tgt1ty³2
);

904 
	`addToPoštCloud
(
ab¦še2
.
p1
, 
be¡_tgt2p1
, 
	`sq¹
(
mš
), 
PARALLEL_LINE_WEIGHT
/(
	`hypÙ
(
lše2
.p1.
	`x
(),†še2.p1.
	`y
())/1000), 
tgt2ty³1
);

905 
	`addToPoštCloud
(
ab¦še2
.
p2
, 
be¡_tgt2p2
, 
	`sq¹
(
mš
), 
PARALLEL_LINE_WEIGHT
/(
	`hypÙ
(
lše2
.p2.
	`x
(),†še2.p2.
	`y
())/1000), 
tgt2ty³2
);

906 
x_known
 = 
Œue
;

909  
»suÉ
;

911 
	}
}

915 
boŞ
 
	$m©chLše
(cÚ¡ 
LšeInfo
 
lše
, 
Ën2
, 
po¡Di¡2
, 
edgeDi¡
, 
boŞ
 
cÚ¡¿šOr›Á©iÚ
){

917 
boŞ
 
»suÉ
 = 
çl£
;

920 
LšeInfo
 
ab¦še
;

921 
ab¦še
.
p1
 = 
	`ŒªsfÜm
(
lše
.p1, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

922 
ab¦še
.
p2
 = 
	`ŒªsfÜm
(
lše
.p2, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

925 
mš
 = 
FLT_MAX
;

926 
diff
 = 0.f;

927 
Pošt
 
be¡_tgt1
 = 
	`Pošt
(0,0), 
be¡_tgt2
 = Point(0,0);

928 
Pošt
 
tgt1
, 
tgt2
;

929 
T¬g‘Ty³
 
ty³1
 = 
POINT
;

930 
T¬g‘Ty³
 
ty³2
 = 
POINT
;

933 
absÜ›Á
 = 
	`©ª2
(
ab¦še
.
p1
.
	`y
(è-‡b¦še.
p2
.y(),‡b¦še.p1.
	`x
() -‡bsline.p2.x());

934 ià(
absÜ›Á
 < 0.f){

935 
absÜ›Á
 +ğ
M_PI
;

938 
lmk
 = 0;†mk < ()
®lF›ldLšes
.
	`size
();†mk++){

940 
LšeInfo
 
f›ldLše
 = 
®lF›ldLšes
[
lmk
];

943 ià(
®lLšeL’gths
[
lmk
] < 
Ën2
) {

948 
boŞ
 
v”tiÿl
 = 
Œue
;

949 ià(
f›ldLše
.
p1
.
	`y
(è=ğf›ldLše.
p2
.y()è
v”tiÿl
 = 
çl£
;

952 ià(
v”tiÿl
 && (
absÜ›Á
 < 
	`DEG2RAD
(30) ||‡bsorient > DEG2RAD(150))){

954 ià(
cÚ¡¿šOr›Á©iÚ
) ;

956 ià(!
v”tiÿl
 && (
absÜ›Á
 > 
	`DEG2RAD
(60) &&‡bsorient < DEG2RAD(120))){

958 ià(
cÚ¡¿šOr›Á©iÚ
) ;

965 
aùu®Po¡Di¡2
 = 
®lLšePo¡Di¡
[
lmk
];

966 
¡d
::
·œ
<,> 
aùu®EdgeDi¡
 = 
®lLšeEdgeDi¡
[
lmk
];

967 iàĞ
v”tiÿl
 && 
ab¦še
.
p2
.
	`y
(è>‡b¦še.
p1
.y() ){

969 
aùu®Po¡Di¡2
 = -actualPostDist2;

970 
aùu®EdgeDi¡
 = 
¡d
::
	`make_·œ
(-aùu®EdgeDi¡.
£cÚd
, -aùu®EdgeDi¡.
fœ¡
);

971 } iàĞ!
v”tiÿl
 && 
ab¦še
.
p2
.
	`x
(è>‡b¦še.
p1
.x() ) {

973 
aùu®Po¡Di¡2
 = -actualPostDist2;

974 
aùu®EdgeDi¡
 = 
¡d
::
	`make_·œ
(-aùu®EdgeDi¡.
£cÚd
, -aùu®EdgeDi¡.
fœ¡
);

978 ià(
po¡Di¡2
 !ğ
UNKNOWN_COORD
){

979 
po¡Diff
 = 
	`çbs
(
po¡Di¡2
 - 
aùu®Po¡Di¡2
);

980 iàĞ
po¡Diff
 > 
MIN_POST_ERROR
 + 
	`çbs
(
aùu®Po¡Di¡2
)*
POST_ERROR_PERCENT
 ) {

986 ià(
edgeDi¡
 !ğ
UNKNOWN_COORD
){

987 
aùu®
 = 
aùu®EdgeDi¡
.
fœ¡
;

988 ià(
edgeDi¡
 < 0){

989 
aùu®
 = 
aùu®EdgeDi¡
.
£cÚd
;

991 
edgeDiff
 = 
	`çbs
(
edgeDi¡
 - 
aùu®
);

992 iàĞ
edgeDiff
 > 
MIN_EDGE_ERROR
 + 
	`çbs
(
aùu®
)*
EDGE_ERROR_PERCENT
 ) {

996 
	`Îog
(
DEBUG1
è<< "\tPossibË " << 
®lLšeNames
[
lmk
] << "\n";

997 
diff
 = 
	`di¡2ToLšeSeg
(
f›ldLše
, 
ab¦še
.
p1
, 
tgt1
);

998 
diff
 +ğ
	`di¡2ToLšeSeg
(
f›ldLše
, 
ab¦še
.
p2
, 
tgt2
);

999 ià(
diff
 < 
mš
) {

1002 if(
tgt1
 =ğ
f›ldLše
.
p1
 ||gt1 =ğf›ldLše.
p2
 || 
tÙ®N
<3 ) 
ty³1
 = 
POINT
;

1003 
ty³1
 = 
HOR_LINE
;

1004 if(
tgt2
 =ğ
f›ldLše
.
p1
 ||gt2 =ğf›ldLše.
p2
 || 
tÙ®N
<3 ) 
ty³2
 = 
POINT
;

1005 
ty³2
 = 
HOR_LINE
;

1006 
mš
 = 
diff
;

1007 
be¡_tgt1
 = 
tgt1
;

1008 
be¡_tgt2
 = 
tgt2
;

1009 
»suÉ
 = 
Œue
;

1013 ià(
»suÉ
) {

1015 iàĞ
be¡_tgt1
.
	`x
()==
be¡_tgt2
.x() ){

1016 
x_known
 = 
Œue
;

1017 ià(
ty³1
 =ğ
HOR_LINE
èty³1 = 
VERT_LINE
;

1018 ià(
ty³2
 =ğ
HOR_LINE
èty³2 = 
VERT_LINE
;

1020 
y_known
 = 
Œue
;

1023 
	`addToPoštCloud
(
ab¦še
.
p1
, 
be¡_tgt1
, 
	`sq¹
(
mš
), 
FIELD_LINE_WEIGHT
/(
	`hypÙ
(
lše
.p1.
	`x
(),†še.p1.
	`y
())/1000), 
ty³1
);

1024 
	`addToPoštCloud
(
ab¦še
.
p2
, 
be¡_tgt2
, 
	`sq¹
(
mš
), 
FIELD_LINE_WEIGHT
/(
	`hypÙ
(
lše
.p2.
	`x
(),†še.p2.
	`y
())/1000), 
ty³2
);

1027  
»suÉ
;

1028 
	}
}

1032 
boŞ
 
	$m©chEdge
(cÚ¡ 
LšeInfo
 
lše
){

1034 
boŞ
 
»suÉ
 = 
çl£
;

1037 
LšeInfo
 
ab¦še
;

1038 
ab¦še
.
p1
 = 
	`ŒªsfÜm
(
lše
.p1, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

1039 
ab¦še
.
p2
 = 
	`ŒªsfÜm
(
lše
.p2, 
combšedObs
.
	`x
(), combšedObs.
	`y
(), combšedObs.
	`th‘a
());

1042 
mš
 = 
FLT_MAX
;

1043 
diff
 = 0.f;

1044 
Pošt
 
be¡_tgt1
 = 
	`Pošt
(0,0), 
be¡_tgt2
 = Point(0,0);

1045 
Pošt
 
tgt1
, 
tgt2
;

1046 
T¬g‘Ty³
 
ty³1
 = 
POINT
;

1047 
T¬g‘Ty³
 
ty³2
 = 
POINT
;

1049 
lmk
 = 0;†mk < ()
®lEdgeLšes
.
	`size
();†mk++){

1051 
LšeInfo
 
edgeLše
 = 
®lEdgeLšes
[
lmk
];

1054 
diff
 = 
	`di¡2ToLšeSeg
(
edgeLše
, 
ab¦še
.
p1
, 
tgt1
);

1055 
diff
 +ğ
	`di¡2ToLšeSeg
(
edgeLše
, 
ab¦še
.
p2
, 
tgt2
);

1056 ià(
diff
 < 
mš
) {

1058 
ty³1
 = 
HOR_LINE
;

1059 
ty³2
 = 
HOR_LINE
;

1060 
mš
 = 
diff
;

1064 
boŞ
 
æT¬g‘s
 = 
çl£
;

1066 ià(
edgeLše
.
p1
.
	`y
(è<ƒdgeLše.
p2
.y(è&& 
tgt1
.y(è> 
tgt2
.y()è
æT¬g‘s
 = 
Œue
;

1067 ià(
edgeLše
.
p2
.
	`y
(è<ƒdgeLše.
p1
.y(è&& 
tgt2
.y(è> 
tgt1
.y()è
æT¬g‘s
 = 
Œue
;

1068 ià(
edgeLše
.
p1
.
	`x
(è<ƒdgeLše.
p2
.x(è&& 
tgt1
.x(è> 
tgt2
.x()è
æT¬g‘s
 = 
Œue
;

1069 ià(
edgeLše
.
p2
.
	`x
(è<ƒdgeLše.
p1
.x(è&& 
tgt2
.x(è> 
tgt1
.x()è
æT¬g‘s
 = 
Œue
;

1071 ià(
æT¬g‘s
){

1072 
be¡_tgt1
 = 
tgt2
;

1073 
be¡_tgt2
 = 
tgt1
;

1075 
be¡_tgt1
 = 
tgt1
;

1076 
be¡_tgt2
 = 
tgt2
;

1078 
»suÉ
 = 
Œue
;

1082 ià(
»suÉ
) {

1084 iàĞ
be¡_tgt1
.
	`x
()==
be¡_tgt2
.x() ){

1085 
x_known
 = 
Œue
;

1086 ià(
ty³1
 =ğ
HOR_LINE
èty³1 = 
VERT_LINE
;

1087 ià(
ty³2
 =ğ
HOR_LINE
èty³2 = 
VERT_LINE
;

1089 
y_known
 = 
Œue
;

1092 
	`addToPoštCloud
(
ab¦še
.
p1
, 
be¡_tgt1
, 
	`sq¹
(
mš
), 
FIELD_LINE_WEIGHT
/(
	`hypÙ
(
lše
.p1.
	`x
(),†še.p1.
	`y
())/1000), 
ty³1
);

1093 
	`addToPoštCloud
(
ab¦še
.
p2
, 
be¡_tgt2
, 
	`sq¹
(
mš
), 
FIELD_LINE_WEIGHT
/(
	`hypÙ
(
lše
.p2.
	`x
(),†še.p2.
	`y
())/1000), 
ty³2
);

1096  
»suÉ
;

1097 
	}
}

1101 
	$di¡2ToLše
(cÚ¡ 
LšeInfo
 
lše
, cÚ¡ 
Pošt
 
¤c
, Pošˆ&
tgt
){

1103 cÚ¡ 
l2
 = 
	`DISTANCE_SQR
(
lše
.
p1
.
	`x
(),†še.p1.
	`y
(),†še.
p2
.x(),†ine.p2.y());

1104 ià(
l2
 == 0.0f) {

1105 
tgt
 = 
lše
.
p1
;

1106  
	`DISTANCE_SQR
(
tgt
.
	`x
(),gt.
	`y
(), 
¤c
.x(), src.y());

1109 cÚ¡ 
t
 = (
¤c
-
lše
.
p1
).
	`dÙ
Öše.
p2
-lše.p1è/ 
l2
;

1110 
PoštF
 
Ën
 = (
lše
.
p2
 -†še.
p1
).
ÿ¡
<>();

1111 
Ën
 =†’*
t
;

1112 
tgt
 = 
lše
.
p1
 + 
Ën
.
ÿ¡
<>();

1113  
	`DISTANCE_SQR
(
tgt
.
	`x
(),gt.
	`y
(), 
¤c
.x(), src.y());

1114 
	}
}

1119 
	$di¡2ToLšeSeg
(cÚ¡ 
LšeInfo
 
lše
, cÚ¡ 
Pošt
 
¤c
, Pošˆ&
tgt
){

1121 cÚ¡ 
l2
 = 
	`DISTANCE_SQR
(
lše
.
p1
.
	`x
(),†še.p1.
	`y
(),†še.
p2
.x(),†ine.p2.y());

1122 ià(
l2
 == 0.0f) {

1123 
tgt
 = 
lše
.
p1
;

1124  
	`DISTANCE_SQR
(
tgt
.
	`x
(),gt.
	`y
(), 
¤c
.x(), src.y());

1127 
boŞ
 
v”tiÿl
 = 
Œue
;

1128 ià(
lše
.
p1
.
	`y
(è=ğlše.
p2
.y()è
v”tiÿl
 = 
çl£
;

1130 cÚ¡ 
t
 = (
¤c
-
lše
.
p1
).
	`dÙ
Öše.
p2
-lše.p1è/ 
l2
;

1131 ià(
t
 < 0.f) {

1132 
tgt
 = 
lše
.
p1
;

1133 ià(
v”tiÿl
è
y_known
 = 
Œue
;

1134 
x_known
 = 
Œue
;

1135 } iàĞ
t
 > 1.f){

1136 
tgt
 = 
lše
.
p2
;

1137 ià(
v”tiÿl
è
y_known
 = 
Œue
;

1138 
x_known
 = 
Œue
;

1140 
PoštF
 
Ën
 = (
lše
.
p2
 -†še.
p1
).
ÿ¡
<>();

1141 
Ën
 =†’*
t
;

1142 
tgt
 = 
lše
.
p1
 + 
Ën
.
ÿ¡
<>();

1144  
	`DISTANCE_SQR
(
tgt
.
	`x
(),gt.
	`y
(), 
¤c
.x(), src.y());

1145 
	}
}

1149 
m©chObs
(cÚ¡ 
RRCoÜd
 
¼
, 
¡d
::
veùÜ
<
AbsCoÜd
> &
Ïndm¬ks
, 
weight
,

1150 
ty³
, 
¡d
::
veùÜ
<> 
Ïndm¬kTy³s
) {

1152 
AbsCoÜd
 
obsAbs
 = 
¼ToAbs
(
¼
, 
combšedObs
);

1154 ifĞ
	gÏndm¬ks
 =ğ
®lCœşes
){

1155 
obsAbs
.
th‘a
(èğ
NORMALISE
(obsAbs.th‘a(è- 
M_PI
);

1158 
	gm©ch
 = 
NO_MATCH
;

1159 
	gmš
 = 
FLT_MAX
;

1160 
	glmk
 = 0;†mk < ()
	gÏndm¬ks
.
size
();†mk++){

1163 ifĞ!
	gÏndm¬kTy³s
.
em±y
() ){

1166 ià(
	gty³
==
T_POST_LEFT
 && 
Ïndm¬kTy³s
[
lmk
]!=T_POST_LEFT) ;

1167 ià(
	gty³
==
T_POST_RIGHT
 && 
Ïndm¬kTy³s
[
lmk
]!=T_POST_RIGHT) ;

1170 ià(
	gty³
==
C_GB_LEFT
 && 
Ïndm¬kTy³s
[
lmk
]!=C_GB_LEFT) ;

1171 ià(
	gty³
==
C_GB_RIGHT
 && 
Ïndm¬kTy³s
[
lmk
]!=C_GB_RIGHT) ;

1172 ià(
	gty³
==
C_OUTSIDE
 && 
Ïndm¬kTy³s
[
lmk
]!=C_OUTSIDE) ;

1175 ià(
	gty³
>=
Po¡Info
::
pNÚe
 && 
ty³
 <=Po¡Info::
pAwayRight
){

1176 iàĞ(
ty³
^
Ïndm¬kTy³s
[
lmk
]) &ype) {

1183 
	gdiff
 = 
obsLmkDiff
(
obsAbs
, 
Ïndm¬ks
[
lmk
]);

1185 ià(
	gdiff
 < 
	gmš
) {

1186 
	gmš
 = 
diff
;

1187 
	gm©ch
 = 
lmk
;

1191 ià(
	gm©ch
!ğ
NO_MATCH
){

1193 
addToPoštCloud
(
obsAbs
, 
Ïndm¬ks
[
m©ch
], 
weight
/(
¼
.
di¡ªû
()/1000));

1194 ià(!
	gÏndm¬kTy³s
.
em±y
()){

1195 
Îog
(
DEBUG1
è<< "Ob£rv©iÚ m©ched w™h†ªdm¬ky³: " << 
	gÏndm¬kTy³s
[
m©ch
] << "\n";

1196  
	gÏndm¬kTy³s
[
m©ch
];

1198  
	gNO_TYPE
;

1201  
	gNO_TYPE
;

1206 
AbsCoÜd
 
	$¼ToAbs
(cÚ¡ 
RRCoÜd
 
obs
, cÚ¡ 
AbsCoÜd
 
robÙPos
) {

1207 
Pošt
 
obsC¬‹sŸn
 = 
obs
.
	`toC¬‹sŸn
();

1208 
Pošt
 
obsAbsPos
 = 
	`ŒªsfÜm
(
obsC¬‹sŸn
, 
robÙPos
.
	`x
(),„obÙPos.
	`y
(),„obÙPos.
	`th‘a
());

1209 
obsTh‘a
 = 
	`NORMALISE
(
robÙPos
.
	`th‘a
(è+ 
obs
.
	`h—dšg
(è- obs.
	`Ü›Á©iÚ
(è+ 
M_PI
 );

1210  
	`AbsCoÜd
(
obsAbsPos
.
	`x
(), obsAbsPos.
	`y
(), 
obsTh‘a
);

1211 
	}
}

1214 
AbsCoÜd
 
	$¼ToAbs
(cÚ¡ 
AbsCoÜd
 
obs
, cÚ¡ AbsCoÜd 
robÙPos
) {

1215 
Pošt
 
obsC¬‹sŸn
 = 
	`Pošt
 (
obs
.
	`x
(), obs.
	`y
());

1216 
obsH—dšg
 = 
	`©ª2
(
obs
.
	`y
(), obs.
	`x
());

1217 
Pošt
 
obsAbsPos
 = 
	`ŒªsfÜm
(
obsC¬‹sŸn
, 
robÙPos
.
	`x
(),„obÙPos.
	`y
(),„obÙPos.
	`th‘a
());

1218 
obsTh‘a
 = 
	`NORMALISE
(
robÙPos
.
	`th‘a
(è+ 
obsH—dšg
 - 
obs
.th‘a(è+ 
M_PI
 );

1219  
	`AbsCoÜd
(
obsAbsPos
.
	`x
(), obsAbsPos.
	`y
(), 
obsTh‘a
);

1220 
	}
}

1223 
	$obsLmkDiff
(cÚ¡ 
AbsCoÜd
 
obs
, cÚ¡ AbsCoÜd 
lmk
) {

1225 
th‘aDiff
 = 0;

1226 ià(!
	`i¢ª
(
obs
.
	`th‘a
()è&& !i¢ª(
lmk
.theta())) {

1227 
th‘aDiff
 = 
	`çbs
(
	`NORMALISE
(
lmk
.
	`th‘a
(è- 
obs
.theta()));

1230 
posDiff
 = 
	`DISTANCE
(
lmk
.
	`x
(),†mk.
	`y
(), 
obs
.x(), obs.y());

1231  
posDiff
 + 
RADIAN2MM_SCALING
*
th‘aDiff
;

1232 
	}
}

1234 
	$addToPoštCloud
(
Pošt
 
p1
, Pošˆ
p2
, 
di¡
, 
weight
, 
T¬g‘Ty³
 
ty³
){

1248 if(
p1
.
	`x
(è=ğ
p2
.x(è&&…1.
	`y
() ==…2.y()){

1249 
p1
.
	`x
() =…1.x()+1;

1250 
p1
.
	`y
() =…1.y()+1;

1253 
	`Îog
(
DEBUG1
è<< "Sourû…ošt: (" << 
p1
.
	`x
(è<< ", " <<…1.
	`y
() << "), ";

1254 
	`Îog
(
DEBUG1
è<< "\tT¬g‘…ošt: (" << 
p2
.
	`x
(è<< ", " <<…2.
	`y
() << "), ";

1255 
	`Îog
(
DEBUG1
è<< "\tDi¡ªû: " << 
	`DISTANCE
(
p1
.
	`x
(),…1.
	`y
(), 
p2
.x(),…2.y()) << ", ";

1256 
	`Îog
(
DEBUG1
è<< "\tWeight: " << 
weight
 << ", ";

1257 
	`Îog
(
DEBUG1
) << "\tTargetType: ";

1258 ià(
ty³
 =ğ
POINT
 ) 
	`Îog
(
DEBUG1
) << "POINT\n";

1259 ià(
ty³
 =ğ
VERT_LINE
 ) 
	`Îog
(
DEBUG1
) << "VERT_LINE\n";

1260 ià(
ty³
 =ğ
HOR_LINE
 ) 
	`Îog
(
DEBUG1
) << "HOR_LINE\n";

1262 
sourû
.
	`push_back
(
p1
);

1263 
rg‘
.
	`push_back
(
p2
);

1264 
rg‘Ty³
.
	`push_back
(
ty³
);

1265 
di¡ªûs
.
	`push_back
(
di¡
);

1266 
weights
.
	`push_back
(
weight
);

1267 
N
 = (è
sourû
.
	`size
();

1269 
	}
}

1273 
	$addToPoštCloud
(cÚ¡ 
AbsCoÜd
 
obs1
, cÚ¡ AbsCoÜd 
obs2
, 
weight
){

1274 
Pošt
 
ûÁ»1
 = 
	`Pošt
Ğ
obs1
.
	`x
(), obs1.
	`y
() );

1275 
Pošt
 
ûÁ»2
 = 
	`Pošt
Ğ
obs2
.
	`x
(), obs2.
	`y
() );

1277 ià(
	`i¢ª
(
obs1
.
	`th‘a
()è|| i¢ª(
obs2
.theta())) {

1280 
di¡
 = 
	`DISTANCE
(
ûÁ»1
.
	`x
(), c’Œe1.
	`y
(), 
ûÁ»2
.x(), centre2.y());

1281 
	`addToPoštCloud
(
ûÁ»1
, 
ûÁ»2
, 
di¡
, 
weight
);

1286 
Pošt
 
off£t1
 = 
	`Pošt
Ğ
	`cos
(
obs1
.
	`th‘a
())*
FEATURE_WIDTH
/2, 
	`sš
(obs1.theta())*FEATURE_WIDTH/2 );

1287 
Pošt
 
off£t2
 = 
	`Pošt
Ğ
	`cos
(
obs2
.
	`th‘a
())*
FEATURE_WIDTH
/2, 
	`sš
(obs2.theta())*FEATURE_WIDTH/2 );

1289 
Pošt
 
¤c1
 = 
ûÁ»1
+
off£t1
;

1290 
Pošt
 
tgt1
 = 
ûÁ»2
+
off£t2
;

1291 
Pošt
 
¤c2
 = 
ûÁ»1
-
off£t1
;

1292 
Pošt
 
tgt2
 = 
ûÁ»2
-
off£t2
;

1294 
di¡
 = 
	`DISTANCE
(
¤c1
.
	`x
(), src1.
	`y
(), 
tgt1
.x(),gt1.y());

1295 
di¡
 +ğ
	`DISTANCE
(
¤c2
.
	`x
(), src2.
	`y
(), 
tgt2
.x(),gt2.y());

1296 
di¡
 /= 2;

1298 
	`addToPoštCloud
(
¤c1
, 
tgt1
, 
di¡
, 
weight
);

1299 
	`addToPoštCloud
(
¤c2
, 
tgt2
, 
di¡
, 
weight
);

1301 
x_known
 = 
Œue
;

1302 
y_known
 = 
Œue
;

1305 
	}
}

1310 
	$sŞve
(){

1312 
	`ÿlcMSE
();

1313 
	`Îog
(
DEBUG1
è<< "S¹šg M—ÀE¼Ü: "<< 
	`sq¹
(
m£
) << " mm\n";

1314 
™”©iÚ
 = 1;

1315 
boŞ
 
cÚv”gšg
 = 
çl£
;

1316 
	`Îog
(
DEBUG1
è<< "\nI‹¿tiÚ: " << 
™”©iÚ
 << "\n";

1320 
AbsCoÜd
 
be¡Pos
;

1321 
be¡MSE
 = 
FLT_MAX
;

1323 
Œue
){

1325 
	`™”©e
();

1328 
	`assocŸ‹F—tu»s
(
™”©iÚ
+1);

1331 
Şd_m£
 = 
m£
;

1332 
	`ÿlcMSE
();

1333 
	`Îog
(
DEBUG1
è<< "M—ÀE¼Ü: "<< 
	`sq¹
(
m£
) << " mm\n";

1335 if(
™”©iÚ
 >ğ
mšI‹¿tiÚs
 && 
m£
 < 
be¡MSE
){

1336 
be¡MSE
 = 
m£
;

1337 
be¡Pos
 = 
combšedObs
;

1340 ià(
™”©iÚ
 >ğ
mšI‹¿tiÚs
 && 
m£
 < 
STOP_THRESHOLD
 ) {

1341 
	`Îog
(
DEBUG1
è<< "\nStİpšg sšûƒ¼Ü b–owh»shŞd" << 
¡d
::
’dl
;

1344 ià(
™”©iÚ
 >ğ
mšI‹¿tiÚs
 && 
Şd_m£
-
m£
 < 
IMPROVEMENT_THRESHOLD
) {

1345 if(
cÚv”gšg
){

1346 
	`Îog
(
DEBUG1
è<< "\nStİpšg dutØcÚv”g’û" << 
¡d
::
’dl
;

1349 
cÚv”gšg
 = 
Œue
;

1352 
cÚv”gšg
 = 
çl£
;

1354 ià(
™”©iÚ
>=
MAX_ITERATIONS
){

1355 
	`Îog
(
DEBUG1
è<< "\nStİpšg‡á” max " << 
MAX_ITERATIONS
 <<" i‹¿tiÚs" << 
¡d
::
’dl
;

1359 
™”©iÚ
++;

1360 
	`Îog
(
DEBUG1
è<< "\nI‹¿tiÚ: " << 
™”©iÚ
 << "\n";

1364 
combšedObs
 = 
be¡Pos
;

1365 
m£
 = 
be¡MSE
;

1367 
	}
}

1371 
	$™”©e
(){

1374 ià(
N
==0) ;

1377 ià(
N
==1){

1378 ià(
	`DISTANCE_SQR
(
sourû
[0].
	`x
(), sourû[0].
	`y
(), 
rg‘
[0].x(),¬g‘[0].y()è> 
	`SQUARE
(
SINGLE_POINT_THRESH
)){

1380 } ià(
sšgËF—tu»
.
	`di¡ªû
(è> 
CENTER_CIRCLE_DIAMETER
/2) {

1384 
h—dšgDiff
 = 
	`©ª2
(
combšedObs
.
	`y
(è- 
rg‘
[0].y(), combšedObs.
	`x
() -arget[0].x())

1385 - 
	`©ª2
(
combšedObs
.
	`y
(è- 
sourû
[0].y(), combšedObs.
	`x
() - source[0].x());

1387 
RRCoÜd
 
adju¡edF—tu»
 = 
sšgËF—tu»
;

1390 
adju¡edF—tu»
.
	`h—dšg
(è+ğ
	`©ª2
(
combšedObs
.
	`y
(è- 
rg‘
[0].y(), combšedObs.
	`x
() -arget[0].x())

1391 - 
	`©ª2
(
combšedObs
.
	`y
(è- 
sourû
[0].y(), combšedObs.
	`x
() - source[0].x());

1394 
AbsCoÜd
 
ÃwSourû
 = 
	`¼ToAbs
(
adju¡edF—tu»
, 
combšedObs
);

1395 
sourû
[0] = 
	`Pošt
(
ÃwSourû
.
	`x
(),‚ewSourû.
	`y
());

1398 
combšedObs
.
	`th‘a
(èğ
	`NORMALISE
(combšedObs.th‘a(è+ 
h—dšgDiff
);

1403 
Pošt
 
sourû_com
 = 
Eig’
::
VeùÜ2i
::
	`Z”o
();

1404 
Pošt
 
rg‘_com
 = 
Eig’
::
VeùÜ2i
::
	`Z”o
();

1405 
i
=0; i<
N
; i++){

1406 
sourû_com
 = sourû_com + 
sourû
[
i
];

1407 
rg‘_com
 =¬g‘_com + 
rg‘
[
i
];

1409 
sourû_com
 = sourû_com / 
N
;

1410 
rg‘_com
 =¬g‘_com / 
N
;

1414 cÚ¡ 
m
 = 
N
*3;

1416 
Eig’
::
M©rixXf
 
	`A
(
m
,3);

1417 
Eig’
::
M©rixXf
 
	`b
(
m
,1);

1418 
Eig’
::
VeùÜ3f
 
»suÉ
;

1420 
Ar
 = 0;

1421 
Ac
 = 0;

1422 
br
 = 0;

1423 
i
=0; i<
N
; i++){

1425 
w
 = 
weights
[
i
];

1426 
Pošt
 
p
 = 
sourû
[
i
] - 
sourû_com
;

1427 
Pošt
 
q
 = 
rg‘
[
i
] - 
rg‘_com
;

1428 
T¬g‘Ty³
 
ty³
 = 
rg‘Ty³
[
i
];

1430 ià(
ty³
 =ğ
POINT
) {

1433 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ
w
;

1434 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1435 
A
.
	`cÛffRef
(
Ar
++, 
Ac
èğ-
w
*
p
.
	`y
();

1436 
Ac
 = 0;

1438 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1439 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ
w
;

1440 
A
.
	`cÛffRef
(
Ar
++, 
Ac
èğ
w
*
p
.
	`x
();

1441 
Ac
 = 0;

1443 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ-
w
*
p
.
	`y
();

1444 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ
w
*
p
.
	`x
();

1445 
A
.
	`cÛffRef
(
Ar
++, 
Ac
èğ
w
*(
p
.
	`x
()*p.x()+p.
	`y
()*p.y());

1446 
Ac
 = 0;

1448 
b
.
	`cÛffRef
(
br
++èğ
w
*(
q
.
	`x
(è- 
p
.x());

1449 
b
.
	`cÛffRef
(
br
++èğ
w
*(
q
.
	`y
(è- 
p
.y());

1450 
b
.
	`cÛffRef
(
br
++èğ
w
*(
p
.
	`x
()*(
q
.
	`y
()-p.y()) -….y()*(q.x()-p.x()));

1452 } ià(
ty³
 =ğ
VERT_LINE
){

1455 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ
w
;

1456 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1457 
A
.
	`cÛffRef
(
Ar
++, 
Ac
èğ-
w
*
p
.
	`y
();

1458 
Ac
 = 0;

1460 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1461 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1462 
A
.
	`cÛffRef
(
Ar
++, 
Ac
) = 0;

1463 
Ac
 = 0;

1465 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ-
w
*
p
.
	`y
();

1466 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1467 
A
.
	`cÛffRef
(
Ar
++, 
Ac
èğ
w
*(
p
.
	`y
()*p.y());

1468 
Ac
 = 0;

1470 
b
.
	`cÛffRef
(
br
++èğ
w
*(
q
.
	`x
(è- 
p
.x());

1471 
b
.
	`cÛffRef
(
br
++) = 0;

1472 
b
.
	`cÛffRef
(
br
++èğ
w
*Ğ-
p
.
	`y
()*(
q
.
	`x
()-p.x()));

1474 } ià(
ty³
 =ğ
HOR_LINE
){

1477 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1478 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1479 
A
.
	`cÛffRef
(
Ar
++, 
Ac
) = 0;

1480 
Ac
 = 0;

1482 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1483 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ
w
;

1484 
A
.
	`cÛffRef
(
Ar
++, 
Ac
èğ
w
*
p
.
	`x
();

1485 
Ac
 = 0;

1487 
A
.
	`cÛffRef
(
Ar
, 
Ac
++) = 0;

1488 
A
.
	`cÛffRef
(
Ar
, 
Ac
++èğ
w
*
p
.
	`x
();

1489 
A
.
	`cÛffRef
(
Ar
++, 
Ac
èğ
w
*(
p
.
	`x
()*p.x());

1490 
Ac
 = 0;

1492 
b
.
	`cÛffRef
(
br
++) = 0;

1493 
b
.
	`cÛffRef
(
br
++èğ
w
*(
q
.
	`y
(è- 
p
.y());

1494 
b
.
	`cÛffRef
(
br
++èğ
w
*(
p
.
	`x
()*(
q
.
	`y
()-p.y()) );

1500 
A
.
	`svd
().
	`sŞve
(
b
,&
»suÉ
);

1503 
	`Îog
(
DEBUG1
) << "Robot…osition update:\n";

1504 
	`Îog
(
DEBUG1
è<< "From: (x,y,th‘aèğ(" << 
combšedObs
.
	`x
() << ", " <<

1505 
combšedObs
.
	`y
(è<< ", " << 
	`RAD2DEG
(combšedObs.
	`th‘a
()) << ")\n";

1507 
Pošt
 
ŞdrobÙ
 = 
	`Pošt
(
combšedObs
.
	`x
(), combšedObs.
	`y
());

1508 
Pošt
 
ŞdrobÙ_Ëss_com
 = 
ŞdrobÙ
 - 
sourû_com
;

1509 
Pošt
 
ÃwrobÙ
 = 
	`ŒªsfÜm
Ğ
ŞdrobÙ_Ëss_com
, 
	`»suÉ
(0),„esuÉ(1),„esuÉ(2)è+ 
rg‘_com
;

1511 
Pošt
 
Şd¤c
 = 
sourû
[0];

1512 
Pošt
 
Şd¤c_Ëss_com
 = 
Şd¤c
 - 
sourû_com
;

1513 
Pošt
 
Ãw¤c
 = 
	`ŒªsfÜm
Ğ
Şd¤c_Ëss_com
, 
	`»suÉ
(0),„esuÉ(1),„esuÉ(2)è+ 
rg‘_com
;

1515 
robÙH—dšgChg
 = 
	`©ª2
(
ÃwrobÙ
.
	`y
(è- 
Ãw¤c
.y(),‚ewrobÙ.
	`x
() -‚ewsrc.x())

1516 - 
	`©ª2
(
ŞdrobÙ
.
	`y
(è- 
Şd¤c
.y(), oldrobÙ.
	`x
() - oldsrc.x());

1518 
combšedObs
 = 
	`AbsCoÜd
(
ÃwrobÙ
.
	`x
(),‚ewrobÙ.
	`y
(), combšedObs.
	`th‘a
()+
robÙH—dšgChg
);

1519 
	`Îog
(
DEBUG1
è<< "To: (x,y,th‘aèğ(" << 
combšedObs
.
	`x
() << ", " <<

1520 
combšedObs
.
	`y
(è<< ", " << 
	`RAD2DEG
(combšedObs.
	`th‘a
()) << ")\n";

1522 
	}
}

1525 
Pošt
 
	$ŒªsfÜm
(cÚ¡ 
Pošt
 &
pošt
, 
tx
, 
ty
, 
th‘a
){

1526 
Pošt
 
»suÉ
;

1527 
»suÉ
.
	`x
(èğ
	`cos
(
th‘a
)*
pošt
.x(è- 
	`sš
Ñh‘a)*pošt.
	`y
(è+ 
tx
;

1528 
»suÉ
.
	`y
(èğ
	`sš
(
th‘a
)*
pošt
.
	`x
(è+ 
	`cos
Ñh‘a)*pošt.y(è+ 
ty
;

1529  
»suÉ
;

1530 
	}
}

1533 
	$ÿlcMSE
(){

1536 
maxDi¡
 = 0.f;

1537 
i
=0; i<
N
; i++){

1538 
di¡
 = 
di¡ªûs
[
i
];

1539 if(
di¡
>
maxDi¡
) maxDist = dist;

1543 
m£
 = 0.f;

1544 
weight_sum
 = 0.f;

1545 
i
=0; i<
N
; i++){

1546 
di¡
 = 
di¡ªûs
[
i
];

1547 
m£
 +ğ(
di¡
*di¡)*
weights
[
i
];

1548 
weight_sum
 +ğ
weights
[
i
];

1550 ià(
N
>0){

1551 
m£
 = m£ / (()
N
*
weight_sum
);

1553 
	}
}

1556 
	$š™Lªdm¬ks
() {

1558 
®lCœşes
.
	`ş—r
();

1559 
®lCÜÃrs
.
	`ş—r
();

1560 
®lCÜÃrTy³s
.
	`ş—r
();

1561 
®lTJunùiÚs
.
	`ş—r
();

1562 
®lTJunùiÚTy³s
.
	`ş—r
();

1564 
®lPo¡s
.
	`ş—r
();

1565 
®lPo¡Ty³s
.
	`ş—r
();

1567 
®lF›ldLšes
.
	`ş—r
();

1568 
®lLšeNames
.
	`ş—r
();

1569 
®lLšeL’gths
.
	`ş—r
();

1570 
®lLšePo¡Di¡
.
	`ş—r
();

1571 
®lLšeEdgeDi¡
.
	`ş—r
();

1573 
·¿Î–F›ldLšes
.
	`ş—r
();

1574 
·¿Î–Pošts
.
	`ş—r
();

1575 
·¿Î–F›ldL’gths
.
	`ş—r
();

1577 
®lEdgeLšes
.
	`ş—r
();

1579 
AbsCoÜd
 
coÜd
;

1582 
coÜd
.
	`x
() = 0.0f;

1583 
coÜd
.
	`y
() = 0.0f;

1584 
coÜd
.
	`th‘a
(èğ-
M_PI_2
;

1585 
®lCœşes
.
	`push_back
(
coÜd
);

1587 
coÜd
.
	`x
() = 0.0f;

1588 
coÜd
.
	`y
() = 0.0f;

1589 
coÜd
.
	`th‘a
(èğ
M_PI_2
;

1590 
®lCœşes
.
	`push_back
(
coÜd
);

1593 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2;

1594 
coÜd
.
	`y
(èğ
GOAL_WIDTH
/2;

1595 
coÜd
.
	`th‘a
(èğ
¡d
::
num”ic_lim™s
<>::
	`qu›t_NaN
( );

1596 
®lPo¡s
.
	`push_back
(
coÜd
);

1597 
®lPo¡Ty³s
.
	`push_back
(
Po¡Info
::
pAwayLeá
);

1599 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2;

1600 
coÜd
.
	`y
(èğ-
GOAL_WIDTH
/2;

1601 
coÜd
.
	`th‘a
(èğ
¡d
::
num”ic_lim™s
<>::
	`qu›t_NaN
( );

1602 
®lPo¡s
.
	`push_back
(
coÜd
);

1603 
®lPo¡Ty³s
.
	`push_back
(
Po¡Info
::
pAwayRight
);

1605 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2;

1606 
coÜd
.
	`y
(èğ-
GOAL_WIDTH
/2;

1607 
coÜd
.
	`th‘a
(èğ
¡d
::
num”ic_lim™s
<>::
	`qu›t_NaN
( );

1608 
®lPo¡s
.
	`push_back
(
coÜd
);

1609 
®lPo¡Ty³s
.
	`push_back
(
Po¡Info
::
pHomeLeá
);

1611 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2;

1612 
coÜd
.
	`y
(èğ
GOAL_WIDTH
/2;

1613 
coÜd
.
	`th‘a
(èğ
¡d
::
num”ic_lim™s
<>::
	`qu›t_NaN
( );

1614 
®lPo¡s
.
	`push_back
(
coÜd
);

1615 
®lPo¡Ty³s
.
	`push_back
(
Po¡Info
::
pHomeRight
);

1618 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2;

1619 
coÜd
.
	`y
(èğ
FIELD_WIDTH
/2;

1620 
coÜd
.
	`th‘a
(èğ-3*
M_PI_4
;

1621 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1622 
®lCÜÃrTy³s
.
	`push_back
(
C_OUTSIDE
);

1624 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2;

1625 
coÜd
.
	`y
(èğ-
FIELD_WIDTH
/2;

1626 
coÜd
.
	`th‘a
(èğ3*
M_PI_4
;

1627 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1628 
®lCÜÃrTy³s
.
	`push_back
(
C_OUTSIDE
);

1630 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2;

1631 
coÜd
.
	`y
(èğ
FIELD_WIDTH
/2;

1632 
coÜd
.
	`th‘a
(èğ-
M_PI_4
;

1633 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1634 
®lCÜÃrTy³s
.
	`push_back
(
C_OUTSIDE
);

1636 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2;

1637 
coÜd
.
	`y
(èğ-
FIELD_WIDTH
/2;

1638 
coÜd
.
	`th‘a
(èğ
M_PI_4
;

1639 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1640 
®lCÜÃrTy³s
.
	`push_back
(
C_OUTSIDE
);

1642 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
;

1643 
coÜd
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

1644 
coÜd
.
	`th‘a
(èğ-
M_PI_4
;

1645 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1646 
®lCÜÃrTy³s
.
	`push_back
(
C_GB_LEFT
);

1648 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
;

1649 
coÜd
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

1650 
coÜd
.
	`th‘a
(èğ
M_PI_4
;

1651 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1652 
®lCÜÃrTy³s
.
	`push_back
(
C_GB_RIGHT
);

1654 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
;

1655 
coÜd
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

1656 
coÜd
.
	`th‘a
(èğ-3*
M_PI_4
;

1657 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1658 
®lCÜÃrTy³s
.
	`push_back
(
C_GB_RIGHT
);

1660 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
;

1661 
coÜd
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

1662 
coÜd
.
	`th‘a
(èğ3*
M_PI_4
;

1663 
®lCÜÃrs
.
	`push_back
(
coÜd
);

1664 
®lCÜÃrTy³s
.
	`push_back
(
C_GB_LEFT
);

1668 
coÜd
.
	`x
() = 0;

1669 
coÜd
.
	`y
(èğ-
FIELD_WIDTH
/2;

1670 
coÜd
.
	`th‘a
(èğ
M_PI_2
;

1671 
®lTJunùiÚs
.
	`push_back
(
coÜd
);

1672 
®lTJunùiÚTy³s
.
	`push_back
(
T_NO_POST
);

1674 
coÜd
.
	`x
() = 0;

1675 
coÜd
.
	`y
(èğ
FIELD_WIDTH
/2;

1676 
coÜd
.
	`th‘a
(èğ-
M_PI_2
;

1677 
®lTJunùiÚs
.
	`push_back
(
coÜd
);

1678 
®lTJunùiÚTy³s
.
	`push_back
(
T_NO_POST
);

1680 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2;

1681 
coÜd
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

1682 
coÜd
.
	`th‘a
(èğ-
M_PI
;

1683 
®lTJunùiÚs
.
	`push_back
(
coÜd
);

1684 
®lTJunùiÚTy³s
.
	`push_back
(
T_POST_RIGHT
);

1686 
coÜd
.
	`x
(èğ
FIELD_LENGTH
/2;

1687 
coÜd
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

1688 
coÜd
.
	`th‘a
(èğ-
M_PI
;

1689 
®lTJunùiÚs
.
	`push_back
(
coÜd
);

1690 
®lTJunùiÚTy³s
.
	`push_back
(
T_POST_LEFT
);

1692 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2;

1693 
coÜd
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

1694 
coÜd
.
	`th‘a
() = 0;

1695 
®lTJunùiÚs
.
	`push_back
(
coÜd
);

1696 
®lTJunùiÚTy³s
.
	`push_back
(
T_POST_LEFT
);

1698 
coÜd
.
	`x
(èğ-
FIELD_LENGTH
/2;

1699 
coÜd
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

1700 
coÜd
.
	`th‘a
() = 0;

1701 
®lTJunùiÚs
.
	`push_back
(
coÜd
);

1702 
®lTJunùiÚTy³s
.
	`push_back
(
T_POST_RIGHT
);

1705 
LšeInfo
 
lše
;

1706 
LšeInfo
 
lše1
;

1707 
LšeInfo
 
lše2
;

1714 
lše
.
p1
 = 
	`Pošt
(+
FIELD_LENGTH
/2,-
FIELD_WIDTH
/2);

1715 
lše
.
p2
 = 
	`Pošt
(-
FIELD_LENGTH
/2,-
FIELD_WIDTH
/2);

1716 
®lF›ldLšes
.
	`push_back
(
lše
);

1717 
®lLšeNames
.
	`push_back
("Right Sideline");

1718 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
FIELD_LENGTH
));

1719 
®lLšePo¡Di¡
.
	`push_back
(-(
FIELD_WIDTH
-
GOAL_WIDTH
)/2 );

1720 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(+(
FIELD_WIDTH_OFFSET
),-(FIELD_WIDTH_OFFSET+
FIELD_WIDTH
)));

1723 
lše
.
p1
 = 
	`Pošt
(+
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2);

1724 
lše
.
p2
 = 
	`Pošt
(-
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2);

1725 
®lF›ldLšes
.
	`push_back
(
lše
);

1726 
®lLšeNames
.
	`push_back
("Left Sideline");

1727 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
FIELD_LENGTH
));

1728 
®lLšePo¡Di¡
.
	`push_back
(+(
FIELD_WIDTH
-
GOAL_WIDTH
)/2 );

1729 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(+(
FIELD_WIDTH_OFFSET
+
FIELD_WIDTH
), -FIELD_WIDTH_OFFSET));

1732 
lše
.
p1
 = 
	`Pošt
(-
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2);

1733 
lše
.
p2
 = 
	`Pošt
(-
FIELD_LENGTH
/2,-
FIELD_WIDTH
/2);

1734 
®lF›ldLšes
.
	`push_back
(
lše
);

1735 
®lLšeNames
.
	`push_back
("Home Goal Line");

1736 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
FIELD_WIDTH
));

1737 
®lLšePo¡Di¡
.
	`push_back
( 0.f );

1738 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
Ğ
FIELD_LENGTH
+
FIELD_LENGTH_OFFSET
,-FIELD_LENGTH_OFFSET));

1741 
lše1
.
p1
 = 
	`Pošt
(
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2);

1742 
lše1
.
p2
 = 
	`Pošt
(
FIELD_LENGTH
/2,-
FIELD_WIDTH
/2);

1743 
®lF›ldLšes
.
	`push_back
(
lše1
);

1744 
®lLšeNames
.
	`push_back
("Away Goal Line");

1745 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
FIELD_WIDTH
));

1746 
®lLšePo¡Di¡
.
	`push_back
( 0.f );

1747 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(+
FIELD_LENGTH_OFFSET
, -(
FIELD_LENGTH
+FIELD_LENGTH_OFFSET)));

1750 
lše2
.
p1
 = 
	`Pošt
(0, 
FIELD_WIDTH
/2);

1751 
lše2
.
p2
 = 
	`Pošt
(0,-
FIELD_WIDTH
/2);

1752 
®lF›ldLšes
.
	`push_back
(
lše2
);

1753 
®lLšeNames
.
	`push_back
("Half Way Line");

1754 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
FIELD_WIDTH
));

1755 
®lLšePo¡Di¡
.
	`push_back
(
FIELD_LENGTH
/2);

1756 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(+(
FIELD_LENGTH
/2+
FIELD_LENGTH_OFFSET
),

1757 -(
FIELD_LENGTH
/2+
FIELD_LENGTH_OFFSET
)));

1760 
lše2
.
p1
 = 
	`Pošt
(-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
, +
GOAL_BOX_WIDTH
/2);

1761 
lše2
.
p2
 = 
	`Pošt
(-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
, -
GOAL_BOX_WIDTH
/2);

1762 
®lF›ldLšes
.
	`push_back
(
lše2
);

1763 
®lLšeNames
.
	`push_back
("Home Goal Box Line");

1764 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
GOAL_BOX_WIDTH
));

1765 
®lLšePo¡Di¡
.
	`push_back
(-
GOAL_BOX_LENGTH
);

1766 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
((
FIELD_LENGTH
 - 
GOAL_BOX_LENGTH
 + 
FIELD_LENGTH_OFFSET
),

1767 -(
GOAL_BOX_LENGTH
 + 
FIELD_LENGTH_OFFSET
)));

1770 
·¿Î–F›ldLšes
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
lše
, 
lše2
));

1771 
·¿Î–F›ldL’gths
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
	`SQUARE
(
FIELD_WIDTH
), SQUARE(
GOAL_BOX_WIDTH
)));

1772 
¡d
::
veùÜ
<
Pošt
> 
pošts
;

1773 
pošts
.
	`push_back
(
	`Pošt
(-
FIELD_LENGTH
/2,-
GOAL_BOX_WIDTH
/2));

1774 
pošts
.
	`push_back
(
	`Pošt
(-
FIELD_LENGTH
/2,
GOAL_BOX_WIDTH
/2));

1775 
pošts
.
	`push_back
(
lše2
.
p1
);

1776 
pošts
.
	`push_back
(
lše2
.
p2
);

1777 
·¿Î–Pošts
.
	`push_back
(
pošts
);

1779 
·¿Î–F›ldLšes
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
lše2
, 
lše1
));

1780 
·¿Î–F›ldL’gths
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
	`SQUARE
(
GOAL_BOX_WIDTH
), SQUARE(
FIELD_WIDTH
)));

1781 
pošts
.
	`ş—r
();

1782 
pošts
.
	`push_back
(
lše2
.
p1
);

1783 
pošts
.
	`push_back
(
lše2
.
p2
);

1784 
pošts
.
	`push_back
(
	`Pošt
(-
FIELD_LENGTH
/2,-
GOAL_BOX_WIDTH
/2));

1785 
pošts
.
	`push_back
(
	`Pošt
(-
FIELD_LENGTH
/2,
GOAL_BOX_WIDTH
/2));

1786 
·¿Î–Pošts
.
	`push_back
(
pošts
);

1790 
lše2
.
p1
 = 
	`Pošt
(
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
, +
GOAL_BOX_WIDTH
/2);

1791 
lše2
.
p2
 = 
	`Pošt
(
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
, -
GOAL_BOX_WIDTH
/2);

1792 
®lF›ldLšes
.
	`push_back
(
lše2
);

1793 
®lLšeNames
.
	`push_back
("Away Goal Box Line");

1794 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
GOAL_BOX_WIDTH
));

1795 
®lLšePo¡Di¡
.
	`push_back
(
GOAL_BOX_LENGTH
);

1796 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(+(
GOAL_BOX_LENGTH
 + 
FIELD_LENGTH_OFFSET
),

1797 -(
FIELD_LENGTH
 - 
GOAL_BOX_LENGTH
 + 
FIELD_LENGTH_OFFSET
)));

1800 
·¿Î–F›ldLšes
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
lše1
, 
lše2
));

1801 
·¿Î–F›ldL’gths
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
	`SQUARE
(
FIELD_WIDTH
), SQUARE(
GOAL_BOX_WIDTH
)));

1802 
pošts
.
	`ş—r
();

1803 
pošts
.
	`push_back
(
	`Pošt
(
FIELD_LENGTH
/2, 
GOAL_BOX_WIDTH
/2));

1804 
pošts
.
	`push_back
(
	`Pošt
(
FIELD_LENGTH
/2, -
GOAL_BOX_WIDTH
/2));

1805 
pošts
.
	`push_back
(
lše2
.
p2
);

1806 
pošts
.
	`push_back
(
lše2
.
p1
);

1807 
·¿Î–Pošts
.
	`push_back
(
pošts
);

1809 
·¿Î–F›ldLšes
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
lše2
, 
lše1
));

1810 
·¿Î–F›ldL’gths
.
	`push_back
Ğ
¡d
::
	`make_·œ
(
	`SQUARE
(
GOAL_BOX_WIDTH
), SQUARE(
FIELD_WIDTH
)));

1811 
pošts
.
	`ş—r
();

1812 
pošts
.
	`push_back
(
lše2
.
p2
);

1813 
pošts
.
	`push_back
(
lše2
.
p1
);

1814 
pošts
.
	`push_back
(
	`Pošt
(
FIELD_LENGTH
/2, 
GOAL_BOX_WIDTH
/2));

1815 
pošts
.
	`push_back
(
	`Pošt
(
FIELD_LENGTH
/2, -
GOAL_BOX_WIDTH
/2));

1816 
·¿Î–Pošts
.
	`push_back
(
pošts
);

1820 
lše
.
p1
 = 
	`Pošt
(-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
, -
GOAL_BOX_WIDTH
/2);

1821 
lše
.
p2
 = 
	`Pošt
(-
FIELD_LENGTH
/2, -
GOAL_BOX_WIDTH
/2);

1822 
®lF›ldLšes
.
	`push_back
(
lše
);

1823 
®lLšeNames
.
	`push_back
("Home Goal Box Left Side");

1824 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
GOAL_BOX_LENGTH
));

1825 
®lLšePo¡Di¡
.
	`push_back
(-(
GOAL_BOX_WIDTH
-
GOAL_WIDTH
)/2 );

1826 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(+Ğ(
FULL_FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2 ),

1827 -Ğ
FULL_FIELD_WIDTH
 - 
FIELD_WIDTH_OFFSET
 - (
FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2)));

1830 
lše
.
p1
 = 
	`Pošt
(-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
, 
GOAL_BOX_WIDTH
/2);

1831 
lše
.
p2
 = 
	`Pošt
(-
FIELD_LENGTH
/2, 
GOAL_BOX_WIDTH
/2);

1832 
®lF›ldLšes
.
	`push_back
(
lše
);

1833 
®lLšeNames
.
	`push_back
("Home Goal Box Right Side");

1834 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
GOAL_BOX_LENGTH
));

1835 
®lLšePo¡Di¡
.
	`push_back
((
GOAL_BOX_WIDTH
-
GOAL_WIDTH
)/2 );

1836 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(
FULL_FIELD_WIDTH
 - 
FIELD_WIDTH_OFFSET
 - (
FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2,

1837 -Ğ(
FULL_FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2 )));

1840 
lše
.
p1
 = 
	`Pošt
(
FIELD_LENGTH
/2, -
GOAL_BOX_WIDTH
/2);

1841 
lše
.
p2
 = 
	`Pošt
(
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
, -
GOAL_BOX_WIDTH
/2);

1842 
®lF›ldLšes
.
	`push_back
(
lše
);

1843 
®lLšeNames
.
	`push_back
("Away Goal Box Right Side");

1844 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
GOAL_BOX_LENGTH
));

1845 
®lLšePo¡Di¡
.
	`push_back
(-(
GOAL_BOX_WIDTH
-
GOAL_WIDTH
)/2 );

1846 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
((
FULL_FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2,

1847 -Ğ
FULL_FIELD_WIDTH
 - 
FIELD_WIDTH_OFFSET
 - (
FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2)));

1850 
lše
.
p1
 = 
	`Pošt
(
FIELD_LENGTH
/2, 
GOAL_BOX_WIDTH
/2);

1851 
lše
.
p2
 = 
	`Pošt
(
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
, 
GOAL_BOX_WIDTH
/2);

1852 
®lF›ldLšes
.
	`push_back
(
lše
);

1853 
®lLšeNames
.
	`push_back
("Away Goal Box Left Side");

1854 
®lLšeL’gths
.
	`push_back
(
	`SQUARE
(
GOAL_BOX_LENGTH
));

1855 
®lLšePo¡Di¡
.
	`push_back
((
GOAL_BOX_WIDTH
-
GOAL_WIDTH
)/2 );

1856 
®lLšeEdgeDi¡
.
	`push_back
(
¡d
::
	`make_·œ
(
FULL_FIELD_WIDTH
 - 
FIELD_WIDTH_OFFSET
 - (
FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2,

1857 -(
FULL_FIELD_WIDTH
-
GOAL_BOX_WIDTH
)/2 ));

1862 
lše
.
p1
 = 
	`Pošt
(-
FULL_FIELD_LENGTH
/2,-
FULL_FIELD_WIDTH
/2);

1863 
lše
.
p2
 = 
	`Pošt
(-
FULL_FIELD_LENGTH
/2,
FULL_FIELD_WIDTH
/2);

1864 
®lEdgeLšes
.
	`push_back
(
lše
);

1867 
lše
.
p1
 = 
	`Pošt
(
FULL_FIELD_LENGTH
/2,
FULL_FIELD_WIDTH
/2);

1868 
lše
.
p2
 = 
	`Pošt
(
FULL_FIELD_LENGTH
/2,-
FULL_FIELD_WIDTH
/2);

1869 
®lEdgeLšes
.
	`push_back
(
lše
);

1873 
lše
.
p1
 = 
	`Pošt
(+
FULL_FIELD_LENGTH
/2,-
FULL_FIELD_WIDTH
/2);

1874 
lše
.
p2
 = 
	`Pošt
(-
FULL_FIELD_LENGTH
/2,-
FULL_FIELD_WIDTH
/2);

1875 
®lEdgeLšes
.
	`push_back
(
lše
);

1878 
lše
.
p1
 = 
	`Pošt
(-
FULL_FIELD_LENGTH
/2, 
FULL_FIELD_WIDTH
/2);

1879 
lše
.
p2
 = 
	`Pošt
(+
FULL_FIELD_LENGTH
/2, 
FULL_FIELD_WIDTH
/2);

1880 
®lEdgeLšes
.
	`push_back
(
lše
);

1883 
	}
}

	@robot/perception/localisation/ICP.hpp

3 #´agm¨
Úû


5 
	~<veùÜ
>

6 
	~<¡ršg
>

7 
	~<Eig’/Eig’
>

9 
	~"ty³s/Pošt.hµ
"

10 
	~"ty³s/AbsCoÜd.hµ
"

11 
	~"ty³s/Po¡Info.hµ
"

12 
	~"ty³s/T—mB®lInfo.hµ
"

13 
	~"ty³s/F›ldF—tu»Info.hµ
"

14 
	~"ty³s/F›ldBound¬yInfo.hµ
"

16 
	#ICP_LOST
 -1

	)

17 
	#ICP_NO_OBS
 0

	)

18 
	#ICP_LOCALISED
 1

	)

20 
	ttime¡amp_t
;

21 
	eT¬g‘Ty³
 { 
	mPOINT
, 
	mVERT_LINE
, 
	mHOR_LINE
 };

24 
	eF—tu»Ty³
 { 
	mNO_TYPE
 = 0x10,

27 
	mT_NO_POST
 = 0x20, 
	mT_POST_LEFT
 = 0x30, 
	mT_POST_RIGHT
 = 0x40,

30 
	mC_GB_LEFT
 = 0x50, 
	mC_GB_RIGHT
 = 0x60, 
	mC_OUTSIDE
 = 0x70, 
	mC_UNKNOWN
 = 0x80,

33 
	mPL_KNOWN
 = 0x100, 
	mPL_UNKNOWN
 = 0x200

39 şas 
	cICP
 {

40 
	mpublic
:

41 
ICP
();

47 
loÿli£
ĞcÚ¡ 
AbsCoÜd
 &
robÙPos
,

48 cÚ¡ 
¡d
::
veùÜ
<
F›ldF—tu»Info
> &
f›ldF—tu»s
,

49 cÚ¡ 
¡d
::
veùÜ
<
Po¡Info
> &
po¡s
,

50 cÚ¡ 
awayGßlProb
,

51 cÚ¡ 
h—dYaw
,

52 cÚ¡ 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> &
f›ldBound¬y
,

53 cÚ¡ 
AbsCoÜd
 &
b®lRRC
, 
boŞ
 
isLo¡
,

54 cÚ¡ 
AbsCoÜd
 &
‹amB®l
 = AbsCoÜd(
NAN
,NAN,NAN) );

56 
AbsCoÜd
 
g‘CombšedObs
();

58 
	m¡d
::
veùÜ
<
LšeInfo
> 
g‘AÎF›ldLšes
();

63 
AbsCoÜd
 
¼ToAbs
(cÚ¡ 
RRCoÜd
 
obs
, cÚ¡ AbsCoÜd 
robÙPos
);

66 
AbsCoÜd
 
¼ToAbs
(cÚ¡ AbsCoÜd 
obs
, cÚ¡ AbsCoÜd 
robÙPos
);

	@robot/perception/localisation/LocalisationAdapter.cpp

33 
	~<veùÜ
>

34 
	~<®gÜ™hm
>

35 
	~<f¡»am
>

36 
	~"Loÿli£r.hµ
"

37 
	~"Loÿli§tiÚAd­‹r.hµ
"

38 
	~"Loÿli§tiÚDefs.hµ
"

40 
	~"bÏckbßrd/BÏckbßrd.hµ
"

41 
	~"uts/Logg”.hµ
"

42 
	~"uts/šÿ·c™©ed.hµ
"

43 
	~"uts/Tim”.hµ
"

44 
	~"ty³s/Brßdÿ¡D©a.hµ
"

45 
	~"ty³s/B®lInfo.hµ
"

46 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

47 
	~"³rû±iÚ/loÿli§tiÚ/robÙf‹r/ty³s/RobÙF‹rUpd©e.hµ
"

49 
usšg
 
Çme¥aû
 
	g¡d
;

51 
	gLoÿli§tiÚAd­‹r
::
	$Loÿli§tiÚAd­‹r
(
BÏckbßrd
 *
bb
è: 
	$Ad­‹r
(
bb
) {

52 
fœ¡Cyşe
 = 
Œue
;

53 
¶ay”Numb”
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
¶ay”_numb”
);

54 
´evTime¡amp
 = 0;

55 
numF¿mesSšûS“n
 = 0;

56 
´evGameS‹
 = 0;

57 
isInP’®tyShoÙout
 = 
çl£
;

59 
L
 = 
Ãw
 
	`Loÿli£r
(
¶ay”Numb”
);

60 
robÙF‹r
 = 
Ãw
 
	`RobÙF‹r
();

62 ià(
LOCALISATION_DEBUG
) {

63 
logSŒ—m
.
	`İ’
("loÿli§tiÚ.log", 
¡d
::
ios
::
bš¬y
);

64 
logSŒ—m
.
	`rdbuf
()->
	`pub£tbuf
(0,0);

66 
	}
}

68 
	gLoÿli§tiÚAd­‹r
::~
	$Loÿli§tiÚAd­‹r
() {

69 
d–‘e
 
L
;

70 
d–‘e
 
robÙF‹r
;

72 ià(
LOCALISATION_DEBUG
) {

73 
logSŒ—m
.
	`şo£
();

75 
	}
}

77 
	gtÙ®F¿mes
 = 0;

78 
	gäamesBuck‘s
[] = {0, 0, 0, 0, 0, 0};

80 
	$logFPS
(
ås
) {

81 
tÙ®F¿mes
++;

82 ià(
ås
 <= 10) {

83 
äamesBuck‘s
[0]++;

84 } ià(
ås
 <= 15) {

85 
äamesBuck‘s
[1]++;

86 } ià(
ås
 <= 20) {

87 
äamesBuck‘s
[2]++;

88 } ià(
ås
 <=25) {

89 
äamesBuck‘s
[3]++;

90 } ià(
ås
 <= 30) {

91 
äamesBuck‘s
[4]++;

92 } ià(
ås
 > 30) {

93 
äamesBuck‘s
[5]++;

96 ià(
tÙ®F¿mes
 % 60 == 0) {

97 
¡d
::
cout
 << std::
’dl
;

98 
¡d
::
cout
 << "< 10: \t" << (100 * 
äamesBuck‘s
[0])/
tÙ®F¿mes
 << std::
’dl
;

99 
¡d
::
cout
 << "< 15: \t" << (100 * 
äamesBuck‘s
[1])/
tÙ®F¿mes
 << std::
’dl
;

100 
¡d
::
cout
 << "< 20: \t" << (100 * 
äamesBuck‘s
[2])/
tÙ®F¿mes
 << std::
’dl
;

101 
¡d
::
cout
 << "< 25: \t" << (100 * 
äamesBuck‘s
[3])/
tÙ®F¿mes
 << std::
’dl
;

102 
¡d
::
cout
 << "< 30: \t" << (100 * 
äamesBuck‘s
[4])/
tÙ®F¿mes
 << std::
’dl
;

103 
¡d
::
cout
 << "> 30: \t" << (100 * 
äamesBuck‘s
[5])/
tÙ®F¿mes
 << std::
’dl
;

105 
	}
}

107 
	gLoÿli§tiÚAd­‹r
::
	$tick
() {

108 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ..ickšg‡way" << 
’dl
;

109 
Tim”
 
tim”
;

110 
tim”
.
	`»¡¬t
();

111 cÚ¡ 
AùiÚCommªd
::
AÎ
 
aùive
 = 
	`»adFrom
(
mÙiÚ
,‡ctive);

114 cÚ¡ 
Odom‘ry
 &
ÃwOdom‘ry
 = 
	`»adFrom
(
mÙiÚ
, 
odom‘ry
);

116 
Odom‘ry
 
odom‘ryDiff
;

117 ià(!
fœ¡Cyşe
) {

118 
odom‘ryDiff
 = (
ÃwOdom‘ry
 - 
´evOdom‘ry
);

120 
´evOdom‘ry
 = 
ÃwOdom‘ry
;

122 
št64_t
 
time¡amp
 = 
	`»adFrom
(
visiÚ
,imestamp);

123 
dTimeSecÚds
 = 0.0;

124 ià(!
fœ¡Cyşe
) {

126 
dTimeSecÚds
 = (
time¡amp
 - 
´evTime¡amp
) / 1000000.0;

131 
´evTime¡amp
 = 
time¡amp
;

134 
S’sÜV®ues
 
v®ues
 = 
	`»adFrom
(
kšem©ics
, 
£nsÜsLagged
);

135 
VisiÚUpd©eBundË
 
	`visiÚUpd©eBundË
(

136 
	`»adFrom
(
visiÚ
, 
f›ldBound¬›s
),

137 
	`»adFrom
(
visiÚ
, 
f›ldF—tu»s
),

138 
	`»adFrom
(
visiÚ
, 
po¡s
),

139 
	`»adFrom
(
visiÚ
, 
robÙs
),

140 
	`g‘T—mm©ePo£s
(),

141 
	`»adFrom
(
gameCÚŒŞËr
, 
‹am_»d
),

142 
	`»adFrom
(
visiÚ
, 
awayGßlProb
),

143 
v®ues
.
jošts
.
ªgËs
[
Jošts
::
H—dYaw
],

144 
	`»adFrom
(
visiÚ
, 
b®ls
),

145 !
	`amTuºšgH—d
(
aùive
),

146 !
	`amW®kšg
(
aùive
));

148 ià(
	`haveT¿ns™iÚedS‘ToPÏy
(è&& 
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
£cÚd¬yS‹
 !ğ
STATE2_PENALTYSHOOT
) {

149 
L
->
	`¡¬tOfPÏyRe£t
();

152 
boŞ
 
došgB®lLšeUp
 = 
	`»adFrom
(
behaviour
, 
behaviourSh¬edD©a
).doingBallLineUp;

153 
L
->
	`£tLšeUpMode
(
došgB®lLšeUp
);

155 
boŞ
 
isInR—dyMode
 = 
	`»adFrom
(
behaviour
, 
behaviourSh¬edD©a
).isInReadyMode;

156 
L
->
	`£tR—dyMode
(
isInR—dyMode
);

160 
boŞ
 
isP’®i£d
 =

161 
	`»adFrom
(
gameCÚŒŞËr
, 
our_‹am
).
¶ay”s
[
¶ay”Numb”
 - 1].
³ÇÉy
 !ğ
PENALTY_NONE
;

163 
	`hªdËMySh¬edDi¡ributiÚ
();

164 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ.. hªdË sh¬edook " << 
tim”
.
	`–­£d_us
(è<< 
’dl
;

165 
tim”
.
	`»¡¬t
();

168 
Loÿli£rBundË
 
	`loÿli£rBundË
(

169 
odom‘ryDiff
,

170 
visiÚUpd©eBundË
,

171 
aùive
,

172 
isP’®i£d
,

173 
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
¡©e
,

174 
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
£cÚd¬yS‹
,

175 
dTimeSecÚds
);

177 ià(
LOCALISATION_DEBUG
) {

178 
logSŒ—m
 << 
loÿli£rBundË
;

179 
logSŒ—m
.
	`æush
();

182 ià(
isP’®i£d
) {

183 ià(
isInP’®tyShoÙout
) {

184 
L
->
	`»£tToP’®tyShoÙout
();

186 
L
->
	`£tRe£t
();

188 } ià(
	`ÿnLoÿli£InS‹
(
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
¡©e
,„—dFrom(
behaviour
, 
skl
))) {

189 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ..†oÿlisšg" << 
’dl
;

190 
L
->
	`loÿli£
(
loÿli£rBundË
, 
	`ÿnDoOb£rv©iÚs
());

192 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ..†oÿlisšgook " << 
tim”
.
	`–­£d_us
(è<< 
’dl
;

193 
tim”
.
	`»¡¬t
();

196 ià(
	`ÿnLoÿli£InS‹
(
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
¡©e
,„—dFrom(
behaviour
, 
skl
)) &&

197 !
isInP’®tyShoÙout
) {

198 
	`hªdËIncomšgSh¬edUpd©e
();

201 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ.. sh¬ed upd©took " << 
tim”
.
	`–­£d_us
(è<< 
’dl
;

202 
tim”
.
	`»¡¬t
();

204 
RobÙF‹rUpd©e
 
upd©e
;

205 
upd©e
.
visu®RobÙs
 = 
	`»adFrom
(
visiÚ
, 
robÙs
);

206 
upd©e
.
robÙPos
 = 
	`»adFrom
(
loÿli§tiÚ
,„obotPos);

207 
upd©e
.
h—dYaw
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
).
jošts
.
ªgËs
[
Jošts
::
H—dYaw
];

208 
upd©e
.
odom‘ryDiff
 = odometryDiff;

209 
upd©e
.
isInÿ·c™©ed
 = 
	`isInÿ·c™©ed
(
aùive
.
body
.
aùiÚTy³
);

211 
robÙF‹r
->
	`upd©e
(
upd©e
);

213 
	`wr™eResuÉToBÏckbßrd
();

214 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ.. bÏckbßrd wr™took " << 
tim”
.
	`–­£d_us
(è<< 
’dl
;

215 
tim”
.
	`»¡¬t
();

217 
fœ¡Cyşe
 = 
çl£
;

219 ià(
	`haveT¿ns™iÚedIÁoS‘
(è&& 
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
£cÚd¬yS‹
 =ğ
STATE2_PENALTYSHOOT
) {

220 
isInP’®tyShoÙout
 = 
Œue
;

221 
L
->
	`»£tToP’®tyShoÙout
();

232 
h—dšg
 = 
	`g‘RobÙH—dšgSugge¡iÚ
(
visiÚUpd©eBundË
);

233 
	`wr™eTo
(
loÿli§tiÚ
, 
robÙH—dšgSugge¡iÚ
, 
h—dšg
)

235 
´evGameS‹
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
¡©e
;

236 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ..Ù®ook " << 
tim”
.
	`–­£d_us
(è<< 
’dl
;

237 
	`Îog
(
VERBOSE
è<< "Loÿli§tiÚ: Fšished" << 
¡d
::
’dl
;

238 
	}
}

240 
boŞ
 
	gLoÿli§tiÚAd­‹r
::
	$ÿnLoÿli£InS‹
(
ušt8_t
 
¡©e
, 
¡d
::
¡ršg
 
skl
) {

241 ià(
skl
 == "GameController") {

242  
¡©e
 =ğ
STATE_READY
 || s‹ =ğ
STATE_SET
 || s‹ =ğ
STATE_PLAYING
;

244  
Œue
;

246 
	}
}

248 
	gLoÿli§tiÚAd­‹r
::
	$g‘RobÙH—dšgSugge¡iÚ
(
VisiÚUpd©eBundË
 
visiÚUpd©eBundË
) {

249 
h—dšg
 = 0;

250 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
şo£¡Lšes
;

251 
şo£¡Di¡ªû
 = 1000000.0;

252 
i
 = 0; i < 
visiÚUpd©eBundË
.
f›ldF—tu»s
.
	`size
(); i++) {

253 ià(
visiÚUpd©eBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fLše
) {

255 ià(
visiÚUpd©eBundË
.
f›ldF—tu»s
[
i
].
	`di¡ªû
(è< 
şo£¡Di¡ªû
) {

256 
şo£¡Lšes
.
	`push_back
(
visiÚUpd©eBundË
.
f›ldF—tu»s
[
i
]);

260 ià(
şo£¡Lšes
.
	`size
() > 0) {

261 
F›ldF—tu»Info
 
şo£¡Lše
 = 
şo£¡Lšes
[şo£¡Lšes.
	`size
() - 1];

263 
p1Di¡ªûSqu¬ed
 = 
	`pow
(
şo£¡Lše
.
lše
.
p1
.
	`x
(), 2è+…ow(şo£¡Lše.lše.p1.
	`y
(), 2);

264 
p2Di¡ªûSqu¬ed
 = 
	`pow
(
şo£¡Lše
.
lše
.
p2
.
	`x
(), 2è+…ow(şo£¡Lše.lše.p2.
	`y
(), 2);

265 ià(
p1Di¡ªûSqu¬ed
 > 
p2Di¡ªûSqu¬ed
) {

266 
h—dšg
 = 
	`©ª2
(
şo£¡Lše
.
lše
.
p1
.
	`y
(), clo£¡Lše.lše.p1.
	`x
());

271 
h—dšg
 = 
	`©ª2
(
şo£¡Lše
.
lše
.
p2
.
	`y
(), clo£¡Lše.lše.p2.
	`x
());

277  
h—dšg
;

278 
	}
}

280 
boŞ
 
	gLoÿli§tiÚAd­‹r
::
	$ÿnDoOb£rv©iÚs
() {

281 
AùiÚCommªd
::
Body
::
AùiÚTy³
 
cu¼’tAùiÚ
 = 
	`»adFrom
(
mÙiÚ
, 
aùive
).
body
.
aùiÚTy³
;

283 
boŞ
 
isPickedUp
 = (
cu¼’tAùiÚ
 =ğ
AùiÚCommªd
::
Body
::
REF_PICKUP
);

284 
boŞ
 
isDivšg
 = (
cu¼’tAùiÚ
 =ğ
AùiÚCommªd
::
Body
::
GOALIE_DIVE_LEFT
 || cu¼’tAùiÚ =ğAùiÚCommªd::Body::
GOALIE_DIVE_RIGHT
);

285 
boŞ
 
isD—d
 = (
cu¼’tAùiÚ
 =ğ
AùiÚCommªd
::
Body
::
DEAD
);

286 
boŞ
 
isG‘tšgUp
 =

287 (
cu¼’tAùiÚ
 =ğ
AùiÚCommªd
::
Body
::
GETUP_FRONT
è|| (cu¼’tAùiÚ =ğAùiÚCommªd::Body::
GETUP_BACK
);

290  !
isPickedUp
 && !
isDivšg
 && !
isG‘tšgUp
 && !
isD—d
;

291 
	}
}

293 
boŞ
 
	gLoÿli§tiÚAd­‹r
::
	$haveT¿ns™iÚedS‘ToPÏy
() {

294 
ušt8_t
 
curGameS‹
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
¡©e
;

295  
´evGameS‹
 =ğ
STATE_SET
 && 
curGameS‹
 =ğ
STATE_PLAYING
;

296 
	}
}

298 
boŞ
 
	gLoÿli§tiÚAd­‹r
::
	$haveT¿ns™iÚedIÁoS‘
() {

299 
ušt8_t
 
curGameS‹
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
d©a
).
¡©e
;

300  
´evGameS‹
 !ğ
STATE_SET
 && 
curGameS‹
 == STATE_SET;

301 
	}
}

303 
	g¡d
::
veùÜ
<
AbsCoÜd
> 
Loÿli§tiÚAd­‹r
::
	$g‘T—mm©ePo£s
() {

304 cÚ¡ 
Brßdÿ¡D©a
 *
‹amD©a
 = 
	`»adFrom
(
»ûiv”
, 
d©a
);

305 cÚ¡ 
boŞ
 *
šÿ·c™©ed
 = 
	`»adFrom
(
»ûiv”
, incapacitated);

307 
¡d
::
veùÜ
<
AbsCoÜd
> 
»suÉ
;

308 
i
 = 0; i < 
ROBOTS_PER_TEAM
; i++) {

309 ià(
i
 !ğ(
¶ay”Numb”
 - 1) &&

310 !
šÿ·c™©ed
[
i
] &&

311 
‹amD©a
[
i
].
u±ime
 > 1.0f &&

312 
‹amD©a
[
i
].
acB
 !ğ
Body
::
DEAD
 &&

313 
‹amD©a
[
i
].
acB
 !ğ
Body
::
REF_PICKUP
) {

314 
»suÉ
.
	`push_back
(
‹amD©a
[
i
].
robÙPos
);

317  
»suÉ
;

318 
	}
}

320 
boŞ
 
	gLoÿli§tiÚAd­‹r
::
	$amW®kšg
(cÚ¡ 
AùiÚCommªd
::
AÎ
 &
commªds
) {

321  
	`abs
(
commªds
.
body
.
fÜw¬d
è> 0 ||‡bs(commªds.body.
Ëá
è> 0 ||‡bs(commªds.body.
tuº
) > 0;

322 
	}
}

324 
boŞ
 
	gLoÿli§tiÚAd­‹r
::
	$amTuºšgH—d
(cÚ¡ 
AùiÚCommªd
::
AÎ
 &
commªds
) {

325  
	`abs
(
commªds
.
h—d
.
yawS³ed
) > 0.1;

326 
	}
}

328 
	gLoÿli§tiÚAd­‹r
::
	$wr™eResuÉToBÏckbßrd
() {

329 
AbsCoÜd
 
robÙPos
 = 
L
->
	`g‘RobÙPo£
();

330 
AbsCoÜd
 
b®lPos™iÚ
 = 
L
->
	`g‘B®lPos™iÚ
();

331 
RRCoÜd
 
b®lPosRR
 = 
b®lPos™iÚ
.
	`cÚv”tToRobÙR–©ive
(
robÙPos
);

332 
AbsCoÜd
 
b®lPosRRC
 = 
b®lPos™iÚ
.
	`cÚv”tToRobÙR–©iveC¬‹sŸn
(
robÙPos
);

333 
AbsCoÜd
 
b®lV–oc™y
 = 
L
->
	`g‘B®lV–oc™y
();

335 
robÙPosUnû¹ašty
 = 
L
->
	`g‘RobÙPosUnû¹ašty
();

336 
robÙH—dšgUnû¹ašty
 = 
L
->
	`g‘RobÙH—dšgUnû¹ašty
();

337 
b®lPosUnû¹ašty
 = 
L
->
	`g‘B®lPosUnû¹ašty
();

338 
b®lV–Eig’v®ue
 = 
L
->
	`g‘B®lV–oc™yUnû¹ašty
();

340 
AbsCoÜd
 
	`ÃxtB®l
(
b®lPos™iÚ
.
	`x
(è+ 
b®lV–oc™y
.x(), b®lPos™iÚ.
	`y
() + ballVelocity.y(), 0.0f);

341 
AbsCoÜd
 
ÃxtB®lRRC
 = 
ÃxtB®l
.
	`cÚv”tToRobÙR–©iveC¬‹sŸn
(
robÙPos
);

342 
AbsCoÜd
 
	`b®lV–RRC
(
ÃxtB®lRRC
.
	`x
(è- 
b®lPosRRC
.x(),‚extB®lRRC.
	`y
() - ballPosRRC.y(), 0.0f);

344 
Po£
 
po£
 = 
	`»adFrom
(
mÙiÚ
,…ose);

345 
XYZ_CoÜd
 
b®lNeckR–©ive
 = 
po£
.
	`robÙR–©iveToNeckCoÜd
(
b®lPosRR
, 
BALL_RADIUS
);

347 
ušt32_t
 
b®lLo¡CouÁ
 = 
L
->
	`g‘B®lLo¡CouÁ
();

349 
Sh¬edLoÿli§tiÚUpd©eBundË
 
sh¬edLoÿli§tiÚBundË
 = 
L
->
	`g‘Sh¬edUpd©eD©a
();

351 
	`acquœeLock
(
£rŸliz©iÚ
);

352 
	`wr™eTo
(
loÿli§tiÚ
, 
robÙPos
,„obotPos);

353 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lLo¡CouÁ
, ballLostCount);

354 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lPos
, 
b®lPos™iÚ
);

355 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lPosRR
, ballPosRR);

356 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lPosRRC
, ballPosRRC);

357 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lV–RRC
, ballVelRRC);

358 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lV–
, 
b®lV–oc™y
);

359 
	`wr™eTo
(
loÿli§tiÚ
, 
robÙPosUnû¹ašty
,„obotPosUncertainty);

360 
	`wr™eTo
(
loÿli§tiÚ
, 
robÙH—dšgUnû¹ašty
,„obotHeadingUncertainty);

361 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lPosUnû¹ašty
, ballPosUncertainty);

362 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lV–Eig’v®ue
, ballVelEigenvalue);

363 
	`wr™eTo
(
loÿli§tiÚ
, 
‹amB®l
, 
	`T—mB®lInfo
());

364 
	`wr™eTo
(
loÿli§tiÚ
, 
b®lNeckR–©ive
, ballNeckRelative);

365 
	`wr™eTo
(
loÿli§tiÚ
, 
sh¬edLoÿli§tiÚBundË
, sharedLocalisationBundle);

366 
	`wr™eTo
(
loÿli§tiÚ
, 
haveP’dšgOutgošgSh¬edBundË
, 
Œue
);

367 
	`wr™eTo
(
loÿli§tiÚ
, 
haveP’dšgIncomšgSh¬edBundË
, 
¡d
::
veùÜ
<
boŞ
>(5, 
çl£
));

368 
	`wr™eTo
(
loÿli§tiÚ
, 
robÙOb¡aşes
, 
robÙF‹r
->
f‹»dRobÙs
);

369 
	`»Ëa£Lock
(
£rŸliz©iÚ
);

370 
	}
}

372 
	g¡d
::
veùÜ
<
RobÙOb¡aşe
> 
Loÿli§tiÚAd­‹r
::
	$g‘RobÙsFromF‹r
() {

373  
robÙF‹r
->
f‹»dRobÙs
;

374 
	}
}

376 
	gLoÿli§tiÚAd­‹r
::
	$hªdËMySh¬edDi¡ributiÚ
() {

377 ià(!
	`»adFrom
(
loÿli§tiÚ
, 
haveP’dšgOutgošgSh¬edBundË
)) {

378 
L
->
	`»£tSh¬edUpd©eD©a
();

380 
	}
}

382 
	gLoÿli§tiÚAd­‹r
::
	$hªdËIncomšgSh¬edUpd©e
() {

383 
¡d
::
veùÜ
<
boŞ
> 
šcomšgSh¬edUpd©es
 = 
	`»adFrom
(
loÿli§tiÚ
, 
haveP’dšgIncomšgSh¬edBundË
);

384 
i
 = 0; i < 
šcomšgSh¬edUpd©es
.
	`size
(); i++) {

385 ià(
šcomšgSh¬edUpd©es
[
i
]) {

386 
Brßdÿ¡D©a
 
šcomšgD©a
 = 
	`»adFrom
(
»ûiv”
, 
d©a
)[
i
];

387 
L
->
	`­¶yRemÙeUpd©e
(
šcomšgD©a
, incomšgD©a.
¶ay”Num
);

390 
	}
}

400 
	gLoÿli§tiÚAd­‹r
::
	$hªdËOb£rv©iÚM—su»m’ts
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚUpd©eBundË
) {

401 ià(
visiÚUpd©eBundË
.
visibËB®ls
.
	`size
() == 0) {

402 
numF¿mesSšûS“n
++;

403 ià(
numF¿mesSšûS“n
 > 150) {

404 ià(
di¡ªûOb£rv©iÚs
.
	`size
() > 100) {

405 
	`ouutV¬Ÿnûs
();

408 
numF¿mesSšûS“n
 = 0;

409 
di¡ªûOb£rv©iÚs
.
	`ş—r
();

410 
h—dšgOb£rv©iÚs
.
	`ş—r
();

413 
numF¿mesSšûS“n
 = 0;

414 
di¡ªûOb£rv©iÚs
.
	`push_back
(
visiÚUpd©eBundË
.
visibËB®ls
[0].
¼
.
	`di¡ªû
());

415 
h—dšgOb£rv©iÚs
.
	`push_back
(
visiÚUpd©eBundË
.
visibËB®ls
[0].
¼
.
	`h—dšg
());

417 
	}
}

419 
	gLoÿli§tiÚAd­‹r
::
	$ouutV¬Ÿnûs
() {

420 
¡d
::
	`sÜt
(
di¡ªûOb£rv©iÚs
.
	`begš
(), di¡ªûOb£rv©iÚs.
	`’d
());

421 
¡d
::
	`sÜt
(
h—dšgOb£rv©iÚs
.
	`begš
(), h—dšgOb£rv©iÚs.
	`’d
());

423 
ou›rsR©io
 = 0.1;

425 
di¡ªûM—n
 = 
	`g‘M—n
(
di¡ªûOb£rv©iÚs
, 
ou›rsR©io
);

426 
di¡ªûV¬Ÿnûs
 = 
	`g‘V¬Ÿnû
(
di¡ªûOb£rv©iÚs
, 
di¡ªûM—n
, 
ou›rsR©io
);

428 
h—dšgM—n
 = 
	`g‘M—n
(
h—dšgOb£rv©iÚs
, 
ou›rsR©io
);

429 
h—dšgV¬Ÿnû
 = 
	`g‘V¬Ÿnû
(
h—dšgOb£rv©iÚs
, 
h—dšgM—n
, 
ou›rsR©io
);

431 
¡d
::
cout
 << "v¬Ÿnû obs: " << 
di¡ªûM—n
 << " " << 
di¡ªûV¬Ÿnûs
 << " "

432 << 
h—dšgM—n
 << " " << 
h—dšgV¬Ÿnû
 << 
¡d
::
’dl
;

433 
	}
}

435 
	gLoÿli§tiÚAd­‹r
::
g‘M—n
(cÚ¡ 
¡d
::
veùÜ
<> &
v®s
, 
ou›rsR©io
) {

436 
	gou›rs
 = 
v®s
.
size
(è* 
ou›rsR©io
;

437 
	gsum
 = 0.0;

438 
	gcouÁ
 = 0;

440 
	gi
 = 
ou›rs
; i < 
	gv®s
.
size
(è- 
	gou›rs
; i++) {

441 
	gcouÁ
++;

442 
	gsum
 +ğ
v®s
[
i
];

445  
	gsum
 / 
	gcouÁ
;

448 
	gLoÿli§tiÚAd­‹r
::
g‘V¬Ÿnû
(cÚ¡ 
¡d
::
veùÜ
<> &
v®s
, 
m—n
,

449 
ou›rsR©io
) {

450 
	gou›rs
 = 
v®s
.
size
(è* 
ou›rsR©io
;

451 
	gsum
 = 0.0;

452 
	gcouÁ
 = 0;

454 
	gi
 = 
ou›rs
; i < 
	gv®s
.
size
(è- 
	gou›rs
; i++) {

455 
	gcouÁ
++;

456 
	gdiff
 = 
v®s
[
i
] - 
m—n
;

457 
	gsum
 +ğ
diff
 * diff;

460  
	gsum
 / 
	gcouÁ
;

	@robot/perception/localisation/LocalisationAdapter.hpp

32 #´agm¨
Úû


34 
	~<¡ršg
>

35 
	~<f¡»am
>

37 
	~"bÏckbßrd/Ad­‹r.hµ
"

38 
	~"ty³s/Odom‘ry.hµ
"

39 
	~"ty³s/AùiÚCommªd.hµ
"

40 
	~"VisiÚUpd©eBundË.hµ
"

41 
	~"robÙf‹r/RobÙF‹r.hµ
"

44 
şass
 
	gLoÿli£r
;

45 
şass
 
	gRobÙF‹r
;

48 şas 
	cLoÿli§tiÚAd­‹r
 : 
Ad­‹r
 {

49 
public
:

51 
Loÿli§tiÚAd­‹r
(
BÏckbßrd
 *
bb
);

53 ~
Loÿli§tiÚAd­‹r
();

55 
tick
();

61 
g‘RobÙH—dšgSugge¡iÚ
(
VisiÚUpd©eBundË
 
visiÚUpd©eBundË
);

65 
	m¡d
::
veùÜ
<
RobÙOb¡aşe
> 
g‘RobÙsFromF‹r
();

67 
	m´iv©e
:

69 
Loÿli£r
 *
L
;

70 
RobÙF‹r
 *
	mrobÙF‹r
;

71 
boŞ
 
	mfœ¡Cyşe
;

72 
	m¶ay”Numb”
;

73 
Odom‘ry
 
	m´evOdom‘ry
;

74 
št64_t
 
	m´evTime¡amp
;

75 
ušt8_t
 
	m´evGameS‹
;

77 
boŞ
 
	misInP’®tyShoÙout
;

79 
	m¡d
::
of¡»am
 
logSŒ—m
;

81 
boŞ
 
ÿnLoÿli£InS‹
(
ušt8_t
 
¡©e
, 
¡d
::
¡ršg
 
skl
);

82 
boŞ
 
ÿnDoOb£rv©iÚs
();

84 
boŞ
 
haveT¿ns™iÚedS‘ToPÏy
();

85 
boŞ
 
haveT¿ns™iÚedIÁoS‘
();

86 
	m¡d
::
veùÜ
<
AbsCoÜd
> 
g‘T—mm©ePo£s
();

88 
boŞ
 
amW®kšg
(cÚ¡ 
AùiÚCommªd
::
AÎ
 &
commªds
);

89 
boŞ
 
amTuºšgH—d
(cÚ¡ 
AùiÚCommªd
::
AÎ
 &
commªds
);

91 
wr™eResuÉToBÏckbßrd
();

92 
hªdËMySh¬edDi¡ributiÚ
();

93 
hªdËIncomšgSh¬edUpd©e
();

96 
	m¡d
::
veùÜ
<> 
di¡ªûOb£rv©iÚs
;

97 
	m¡d
::
veùÜ
<> 
h—dšgOb£rv©iÚs
;

98 
	mnumF¿mesSšûS“n
;

100 
hªdËOb£rv©iÚM—su»m’ts
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚUpd©eBundË
);

101 
ouutV¬Ÿnûs
();

103 
g‘M—n
(cÚ¡ 
¡d
::
veùÜ
<> &
v®s
, 
ou›rsR©io
);

104 
g‘V¬Ÿnû
(cÚ¡ 
¡d
::
veùÜ
<> &
v®s
, 
m—n
, 
ou›rsR©io
);

	@robot/perception/localisation/LocalisationConstantsProvider.cpp

32 
	~"Loÿli§tiÚCÚ¡ªtsProvid”.hµ
"

33 
	~"uts/basic_m©hs.hµ
"

34 
	~"uts/ªgËs.hµ
"

35 
	~<cm©h
>

36 
	~<io¡»am
>

38 
	gLoÿli§tiÚCÚ¡ªtsProvid”
::
	$Loÿli§tiÚCÚ¡ªtsProvid”
() :

39 
	`keyV®ues
(
¡©ic_ÿ¡
<>(
NUM_CONSTANTS
)) {

41 
	`£t
(
MEAN_DIST_SIMILARITY_THRESHOLD
, 200.0);

42 
	`£t
(
MEAN_DIST_SIMILARITY_THRESHOLD_NEAR_GOALS
, 100.0);

44 
	`£t
(
MEAN_HEADING_SIMILARITY_THRESHOLD
, 
	`DEG2RAD
(20.0));

45 
	`£t
(
MEAN_HEADING_SIMILARITY_THRESHOLD_NEAR_GOALS
, 
	`DEG2RAD
(10.0));

47 
	`£t
(
COVARIANCE_DIST_SIMILARITY_THRESHOLD
, 400000.0);

48 
	`£t
(
BALL_FRICTION
, 0.98);

50 
	`£t
(
ROBOT_POS_MOTION_UPDATE_COVARIANCE_A
, 2.75);

51 
	`£t
(
ROBOT_POS_MOTION_UPDATE_COVARIANCE_C
, 85437.3);

52 
	`£t
(
ROBOT_HEADING_MOTION_UPDATE_COVARIANCE_A
, 3.11);

53 
	`£t
(
ROBOT_HEADING_MOTION_UPDATE_COVARIANCE_C
, 0.8);

55 
	`£t
(
BALL_POS_MOTION_UPDATE_COVARIANCE_C
, 244290.0);

56 
	`£t
(
BALL_UNSEEN_POS_MOTION_UPDATE_COVARIANCE_C
, 6000000.0);

57 
	`£t
(
BALL_POS_MOTION_UPDATE_LINE_UP_COVARIANCE_C
, 150000.0);

58 
	`£t
(
BALL_VEL_MOTION_UPDATE_COVARIANCE_C
, 361396.0);

60 
	`£t
(
REMOTE_OBSERVATION_UNCERTAINTY_FACTOR
, 4.0);

61 
	`£t
(
SHARED_GAUSSIAN_RESET_UNCERTAINTY_FACTOR
, 1000.0);

62 
	`£t
(
TEAMMATE_ODOMETRY_UNCERTAINTY_SCALE
, 4.0);

64 
	`£t
(
INVALID_OBSERVATION_PROBABILITY
, 0.3);

65 
	`£t
(
INVALID_ICP_PROBABILITY
, 0.8);

66 
	`£t
(
INVALID_REMOTE_OBSERVATION_PROBABILITY
, 0.5);

67 
	`£t
(
INVALID_REMOTE_OBSERVATION_PROBABILITY_GOALIE
, 0.8);

68 
	`£t
(
INVALID_TEAMMATE_ROBOT_OBSERVATION_PROBABILITY
, 0.8);

70 
	`£t
(
MIN_MODE_WEIGHT
, 0.001);

72 
	`£t
(
SYMMETRIC_MODE_WEIGHT
, 0.002);

73 
	`£t
(
TEAMMATE_FLIP_WEIGHT
, 0.01);

75 
	`£t
(
UNRELIABLE_DISTANCE_CUTOFF_FACTOR
, 0.66);

76 
	`£t
(
UNRELIABLE_DISTANCE_VARIANCE_SCALE
, 4.0);

77 
	`£t
(
UNRELIABLE_HEADING_VARIANCE_SCALE
, 2.0);

79 
	`£t
(
BALL_MAX_DISTANCE_OBSERVATION
, 4000.0);

80 
	`£t
(
GOALPOST_MAX_DISTANCE_OBSERVATION
, 4000.0);

81 
	`£t
(
CENTRE_CIRCLE_MAX_DISTANCE_OBSERVATION
, 4000.0);

82 
	`£t
(
TEAMMATE_ROBOT_MAX_DISTANCE_OBSERVATION
, 3000.0);

84 
	`£t
(
HEADING_VARIANCE
, 0.3);

85 
	`£t
(
DISTANCE_VARIANCE_B
, 0.00144844);

86 
	`£t
(
DISTANCE_VARIANCE_C
, 9.04618);

88 
	`£t
(
TEAMMATE_ROBOT_HEADING_VARIANCE
, 0.8);

89 
	`£t
(
TEAMMATE_ROBOT_DISTANCE_VARIANCE_SCALE
, 9.0);

91 
	`£t
(
ICP_DISTANCE_VARIANCE_SCALE
, 1.0);

92 
	`£t
(
ICP_HEADING_VARIANCE
, 0.4);

93 
	}
}

95 
	gLoÿli§tiÚCÚ¡ªtsProvid”
& Loÿli§tiÚCÚ¡ªtsProvid”::
	$š¡ªû
() {

96 
Loÿli§tiÚCÚ¡ªtsProvid”
 
´ovid”
;

97  
´ovid”
;

98 
	}
}

100 
	gLoÿli§tiÚCÚ¡ªtsProvid”
::
	$g‘
(
Loÿli§tiÚCÚ¡ªt
 
key
) const {

101  
keyV®ues
[
¡©ic_ÿ¡
<>(
key
)];

102 
	}
}

104 
	gLoÿli§tiÚCÚ¡ªtsProvid”
::
	$£t
(
Loÿli§tiÚCÚ¡ªt
 
key
, 
v®ue
) {

105 
keyV®ues
[
¡©ic_ÿ¡
<>(
key
)] = 
v®ue
;

106 
	}
}

108 
	gLoÿli§tiÚCÚ¡ªtsProvid”
::
	$£tR—dyMode
(
boŞ
 
’abËd
) {

110 ià(
’abËd
) {

111 
	`£t
(
UNRELIABLE_DISTANCE_CUTOFF_FACTOR
, 0.5);

112 
	`£t
(
GOALPOST_MAX_DISTANCE_OBSERVATION
, 5000.0);

114 
	`£t
(
UNRELIABLE_DISTANCE_CUTOFF_FACTOR
, 0.66);

115 
	`£t
(
GOALPOST_MAX_DISTANCE_OBSERVATION
, 4000.0);

117 
	}
}

	@robot/perception/localisation/LocalisationConstantsProvider.hpp

32 #´agm¨
Úû


34 
	~<veùÜ
>

40 şas 
	cLoÿli§tiÚCÚ¡ªtsProvid”
 {

41 
	mpublic
:

46 
	eLoÿli§tiÚCÚ¡ªt
 {

51 
MEAN_DIST_SIMILARITY_THRESHOLD
,

55 
	mMEAN_DIST_SIMILARITY_THRESHOLD_NEAR_GOALS
,

58 
	mMEAN_HEADING_SIMILARITY_THRESHOLD
,

60 
	mMEAN_HEADING_SIMILARITY_THRESHOLD_NEAR_GOALS
,

63 
	mCOVARIANCE_DIST_SIMILARITY_THRESHOLD
,

68 
	mBALL_FRICTION
,

75 
	mROBOT_POS_MOTION_UPDATE_COVARIANCE_A
,

76 
	mROBOT_POS_MOTION_UPDATE_COVARIANCE_C
,

77 
	mROBOT_HEADING_MOTION_UPDATE_COVARIANCE_A
,

78 
	mROBOT_HEADING_MOTION_UPDATE_COVARIANCE_C
,

81 
	mBALL_POS_MOTION_UPDATE_COVARIANCE_C
,

82 
	mBALL_UNSEEN_POS_MOTION_UPDATE_COVARIANCE_C
,

83 
	mBALL_POS_MOTION_UPDATE_LINE_UP_COVARIANCE_C
,

86 
	mBALL_VEL_MOTION_UPDATE_COVARIANCE_C
,

92 
	mREMOTE_OBSERVATION_UNCERTAINTY_FACTOR
,

94 
	mSHARED_GAUSSIAN_RESET_UNCERTAINTY_FACTOR
,

97 
	mTEAMMATE_ODOMETRY_UNCERTAINTY_SCALE
,

103 
	mINVALID_OBSERVATION_PROBABILITY
,

105 
	mINVALID_ICP_PROBABILITY
,

108 
	mINVALID_REMOTE_OBSERVATION_PROBABILITY
,

111 
	mINVALID_REMOTE_OBSERVATION_PROBABILITY_GOALIE
,

112 
	mINVALID_TEAMMATE_ROBOT_OBSERVATION_PROBABILITY
,

113 
	mMIN_MODE_WEIGHT
,

117 
	mSYMMETRIC_MODE_WEIGHT
,

118 
	mTEAMMATE_FLIP_WEIGHT
,

121 
	mMIN_SYMMETRIC_BALL_DISTANCE_FROM_CENTRE
,

123 
	mUNRELIABLE_DISTANCE_CUTOFF_FACTOR
,

124 
	mUNRELIABLE_DISTANCE_VARIANCE_SCALE
,

125 
	mUNRELIABLE_HEADING_VARIANCE_SCALE
,

129 
	mBALL_MAX_DISTANCE_OBSERVATION
,

130 
	mGOALPOST_MAX_DISTANCE_OBSERVATION
,

131 
	mCENTRE_CIRCLE_MAX_DISTANCE_OBSERVATION
,

132 
	mTEAMMATE_ROBOT_MAX_DISTANCE_OBSERVATION
,

136 
	mHEADING_VARIANCE
,

140 
	mDISTANCE_VARIANCE_B
,

141 
	mDISTANCE_VARIANCE_C
,

143 
	mTEAMMATE_ROBOT_HEADING_VARIANCE
,

144 
	mTEAMMATE_ROBOT_DISTANCE_VARIANCE_SCALE
,

147 
	mICP_DISTANCE_VARIANCE_SCALE
,

149 
	mICP_HEADING_VARIANCE
,

151 
	mNUM_CONSTANTS


158 
	gLoÿli§tiÚCÚ¡ªtsProvid”
& 
š¡ªû
();

163 
	$g‘
(
Loÿli§tiÚCÚ¡ªt
 
key
) const;

169 
	`£t
(
Loÿli§tiÚCÚ¡ªt
 
key
, 
v®ue
);

171 
	`£tR—dyMode
(
boŞ
 
’abËd
);

173 
´iv©e
:

174 
¡d
::
veùÜ
<> 
keyV®ues
;

176 
	`Loÿli§tiÚCÚ¡ªtsProvid”
();

177 
	}
};

	@robot/perception/localisation/LocalisationDefs.hpp

32 #´agm¨
Úû


34 
	~"uts/SPLDefs.hµ
"

35 
	~"uts/ªgËs.hµ
"

38 
	#PI_8
 (
M_PI_4
 / 2.0)

	)

41 
	#FIELD_X_CLIP
 ((
FIELD_LENGTH
 / 2.0fè+ 
FIELD_LENGTH_OFFSET
 / 2.0f)

	)

42 
	#FIELD_Y_CLIP
 ((
FIELD_WIDTH
 / 2.0fè+ 
FIELD_WIDTH_OFFSET
 / 2.0f)

	)

45 
	#MAX_ROBOT_OBSTACLES
 7

	)

47 
	#OFFNAO_TEAM
 
TEAM_BLUE


	)

51 
	mX
 = 0,

52 
	mY
,

53 
	mTHETA
,

54 
	mSTATE_VEC_DIM


55 } 
	tS‹VeùÜ
;

58 
	#FIELD_DIAGONAL
 \

59 
	`sq¹
(
	`SQUARE
(
FULL_FIELD_WIDTH
è+ SQUARE(
FULL_FIELD_LENGTH
))

	)

61 
	#IS_VALID_DIST
(
di¡
) \

62 (
di¡
 <ğ
FIELD_DIAGONAL
)

	)

66 
	#MAIN_DIM
 19

	)

69 
	#SHARED_DIM
 7

	)

73 
šlše
 
	$mšH—dšgDiff
(
th‘aA
, 
th‘aB
) {

74 
mšTh‘a
 = 
	`MIN_ANGLE_360
(
	`RAD2DEG
(
th‘aA
),

75 
	`RAD2DEG
(
th‘aB
));

76 ià(
mšTh‘a
 < -180) minTheta += 360;

77 ià(
mšTh‘a
 > 180) minTheta -= 360;

78  
mšTh‘a
;

79 
	}
}

81 
	#LOCALISATION_DEBUG
 false

	@robot/perception/localisation/LocalisationUtils.cpp

32 
	~"Loÿli§tiÚUts.hµ
"

33 
	~"uts/Logg”.hµ
"

35 
	~<io¡»am
>

37 
boŞ
 
	$absDi¡Clo£
(cÚ¡ 
AbsCoÜd
 &
abs1
, cÚ¡ AbsCoÜd &
abs2
, 
di¡Th»shŞd
){

38  (
	`abs
(
abs1
.
	`x
(è- 
abs2
.x()è<ğ
di¡Th»shŞd
) &&

39 (
	`abs
(
abs1
.
	`y
(è- 
abs2
.y()è<ğ
di¡Th»shŞd
);

40 
	}
}

42 
boŞ
 
	$absClo£
(cÚ¡ 
AbsCoÜd
 &
abs1
, cÚ¡ AbsCoÜd &
abs2
, 
h—dšgTh»shŞd
){

43  (
	`abs
(
abs1
.
	`x
(è- 
abs2
.x()è<ğ
ABS_DIST_THRESHOLD
) &&

44 (
	`abs
(
abs1
.
	`y
(è- 
abs2
.y()è<ğ
ABS_DIST_THRESHOLD
) &&

45 (
	`çbs
(
	`NORMALISE
(
abs1
.
	`th‘a
(è- 
abs2
.th‘a())è<ğ
h—dšgTh»shŞd
);

46 
	}
}

50 
	$mšMah®ªobisDi¡ªû
(cÚ¡ 
AbsCoÜd
 &
abs1
, cÚ¡ AbsCoÜd &
abs2
) {

51 
Eig’
::
VeùÜ2f
 
	`posDiff
(
abs1
.
	`x
(è- 
abs2
.x(),‡bs1.
	`y
() -‡bs2.y());

52 
h—dšgDiff
 = 
	`çbs
(
	`NORMALISE
(
abs1
.
	`th‘a
(è- 
abs2
.theta()));

54 
Eig’
::
M©rix
<, 1, 1> 
posDi¡Squ¬ed1
 = 
posDiff
.
	`Œª¥o£
(è* 
abs1
.
v¬
.
block
<2,2>(0,0).
	`šv”£
() *…osDiff;

55 
h—dšgDi¡Squ¬ed1
 = 
h—dšgDiff
 * (1/
abs1
.
	`v¬
(2,2)) * headingDiff;

56 
mahaDi¡1
 = 
	`sq¹
(
posDi¡Squ¬ed1
[0]è+ sq¹(
h—dšgDi¡Squ¬ed1
);

58 
Eig’
::
M©rix
<, 1, 1> 
posDi¡Squ¬ed2
 = 
posDiff
.
	`Œª¥o£
(è* 
abs2
.
v¬
.
block
<2,2>(0,0).
	`šv”£
() *…osDiff;

59 
h—dšgDi¡Squ¬ed2
 = 
h—dšgDiff
 * (1/
abs2
.
	`v¬
(2,2)) * headingDiff;

60 
mahaDi¡2
 = 
	`sq¹
(
posDi¡Squ¬ed2
[0]è+ sq¹(
h—dšgDi¡Squ¬ed2
);

62  
¡d
::
	`mš
(
mahaDi¡1
, 
mahaDi¡2
);

63 
	}
}

66 
	$mah®ªobisDi¡ªû
(cÚ¡ 
AbsCoÜd
 &
abs
, cÚ¡ AbsCoÜd &
¡©e
) {

67 
Eig’
::
VeùÜ2f
 
	`posDiff
(
abs
.
	`x
(è- 
¡©e
.x(),‡bs.
	`y
() - state.y());

68 
h—dšgDiff
 = 
	`çbs
(
	`NORMALISE
(
abs
.
	`th‘a
(è- 
¡©e
.theta()));

70 
Eig’
::
M©rix
<, 1, 1> 
posDi¡Squ¬ed
 = 
posDiff
.
	`Œª¥o£
(è* 
¡©e
.
v¬
.
block
<2,2>(0,0).
	`šv”£
() *…osDiff;

71 
h—dšgDi¡Squ¬ed
 = 
h—dšgDiff
 * (1/
¡©e
.
	`v¬
(2,2)) * headingDiff;

74 
posDi¡
 = 
	`sq¹
(
posDi¡Squ¬ed
[0]);

75 
h—dšgDi¡
 = 
	`sq¹
(
h—dšgDi¡Squ¬ed
);

76  
posDi¡
 + 
h—dšgDi¡
;

77 
	}
}

80 
	$mah®ªobisDi¡ªûPos
(cÚ¡ 
AbsCoÜd
 &
abs
, cÚ¡ AbsCoÜd &
¡©e
) {

81 
Eig’
::
VeùÜ2f
 
	`posDiff
(
abs
.
	`x
(è- 
¡©e
.x(),‡bs.
	`y
() - state.y());

82 
Eig’
::
M©rix
<, 1, 1> 
posDi¡Squ¬ed
 = 
posDiff
.
	`Œª¥o£
(è* 
¡©e
.
v¬
.
block
<2,2>(0,0).
	`šv”£
() *…osDiff;

83  
	`sq¹
(
posDi¡Squ¬ed
[0]);

84 
	}
}

86 
	$mah®ªobisDi¡ªûPosSQR
(cÚ¡ 
AbsCoÜd
 &
abs
, cÚ¡ AbsCoÜd &
¡©e
) {

87 
Eig’
::
VeùÜ2f
 
	`posDiff
(
abs
.
	`x
(è- 
¡©e
.x(),‡bs.
	`y
() - state.y());

88  (
posDiff
.
	`Œª¥o£
(è* 
¡©e
.
v¬
.
block
<2,2>(0,0).
	`šv”£
() *…osDiff)[0];

89 
	}
}

92 
mah®ªobisDi¡ªûSQR
(cÚ¡ 
PoštF
 &
obs
, cÚ¡ PoštF &
¡©e
, cÚ¡ 
Eig’
::
M©rix
<, 2, 2> &
¡©e_v¬
) {

93 
PoštF
 
	gposDiff
 = 
obs
 - 
¡©e
;

94 
	gEig’
::
M©rix
<, 1, 1> 
	gposDi¡Squ¬ed
 = 
posDiff
.
Œª¥o£
(è* 
¡©e_v¬
.
šv”£
() *…osDiff;

95  
	gposDi¡Squ¬ed
[0];

98 
	$logAbsCoÜd
(cÚ¡ 
AbsCoÜd
 
abs
, 
¡d
::
¡ršg
 
Çme
) {

99 
¡d
::
cout
 << 
Çme
 << ": (" << 
abs
.
	`x
(è<< "," <<‡bs.
	`y
(è<< "," << 
	`RAD2DEG
×bs.
	`th‘a
()è<< ")" << std::
’dl
;

100 
	}
}

102 
	$logAbsCoÜdV¬
(cÚ¡ 
AbsCoÜd
 
abs
, 
¡d
::
¡ršg
 
Çme
) {

103 
¡d
::
cout
 << 
Çme
 << ": (" << 
abs
.
	`x
(è<< "," <<‡bs.
	`y
(è<< "," << 
	`RAD2DEG
×bs.
	`th‘a
()è<< ")" << std::
’dl
;

104 
¡d
::
cout
 << 
Çme
 << " v¬: (" << 
abs
.
	`v¬
(
X
,Xè<< "," <<‡bs.v¬(
Y
,Yè<< "," <<‡bs.v¬(
THETA
,THETAè<< ")" << std::
’dl
;

105 
	}
}

107 
	$logAbsCoÜdCov
(cÚ¡ 
AbsCoÜd
 
abs
, 
¡d
::
¡ršg
 
Çme
) {

108 
¡d
::
cout
 << 
Çme
 << ": (" << 
abs
.
	`x
(è<< "," <<‡bs.
	`y
(è<< "," << 
	`RAD2DEG
×bs.
	`th‘a
()è<< ")" << std::
’dl
;

109 
¡d
::
cout
 << 
Çme
 << " cov¬Ÿnû:" << std::
’dl
;

110 
¡d
::
cout
 << 
abs
.
	`v¬
(0,0è<< " , " <<‡bs.v¬(0,1è<< " , " <<‡bs.v¬(0,2è<< std::
’dl
;

111 
¡d
::
cout
 << 
abs
.
	`v¬
(1,0è<< " , " <<‡bs.v¬(1,1è<< " , " <<‡bs.v¬(1,2è<< std::
’dl
;

112 
¡d
::
cout
 << 
abs
.
	`v¬
(2,0è<< " , " <<‡bs.v¬(2,1è<< " , " <<‡bs.v¬(2,2è<< std::
’dl
;

113 
	}
}

115 
	gEig’
::
M©rixXd
 
	$¥¬£MuÉliÿtiÚ
(

116 cÚ¡ 
Eig’
::
M©rixXd
 &
lhs
, 
rowS¹
, 
cŞS¹
, 
rowEnd
, 
cŞEnd
,

117 cÚ¡ 
Eig’
::
M©rixXd
 &
rhs
) {

119 ià(
lhs
.
	`cŞs
(è!ğ
rhs
.
	`rows
()) {

120 
¡d
::
cout
 << "¥¬£MuÉliÿtiÚ(èERROR: incom·tibË m©riûs" << std::
’dl
;

121  
Eig’
::
	`M©rixXd
();

124 
Eig’
::
M©rixXd
 
	`»suÉ
(
lhs
.
	`rows
(), 
rhs
.
	`cŞs
());

125 
»suÉ
.
	`£tZ”o
();

126 
i
 = 
rowS¹
; i < 
rowEnd
; i++) {

127 
j
 = 
cŞS¹
; j < 
cŞEnd
; j++) {

128 
k
 = 0; k < (è
rhs
.
	`cŞs
(); k++) {

129 
	`»suÉ
(
i
, 
k
è+ğ
	`lhs
(i, 
j
è* 
	`rhs
(j, k);

134  
»suÉ
;

135 
	}
}

137 
	gEig’
::
M©rixXd
 
	$¥¬£MuÉliÿtiÚ
(

138 cÚ¡ 
Eig’
::
M©rixXd
 &
lhs
,

139 cÚ¡ 
Eig’
::
M©rixXd
 &
rhs
, 
rowS¹
, 
cŞS¹
, 
rowEnd
, 
cŞEnd
) {

141 ià(
lhs
.
	`cŞs
(è!ğ
rhs
.
	`rows
()) {

142 
¡d
::
cout
 << "¥¬£MuÉliÿtiÚ(èERROR: incom·tibË m©riûs" << std::
’dl
;

143  
Eig’
::
	`M©rixXd
();

146 
Eig’
::
M©rixXd
 
	`»suÉ
(
lhs
.
	`rows
(), 
rhs
.
	`cŞs
());

147 
»suÉ
.
	`£tZ”o
();

149 
i
 = 0; i < (è
lhs
.
	`rows
(); i++) {

150 
j
 = 
rowS¹
; j < 
rowEnd
; j++) {

151 
k
 = 
cŞS¹
; k < 
cŞEnd
; k++) {

152 
	`»suÉ
(
i
, 
k
è+ğ
	`lhs
(i, 
j
è* 
	`rhs
(j, k);

157  
»suÉ
;

158 
	}
}

	@robot/perception/localisation/LocalisationUtils.hpp

32 #´agm¨
Úû


34 
	~"Loÿli§tiÚDefs.hµ
"

35 
	~"ty³s/AbsCoÜd.hµ
"

36 
	~<Eig’/Eig’
>

37 
	~<io¡»am
>

38 
	~<iomª
>

39 
	~<ios
>

41 
	#ABS_DIST_THRESHOLD
 500

	)

42 
	#MAHA_DIST_THRESHOLD
 3

	)

44 
	#TEAM_BALL_ABS_THRESHOLD
 750.0

	)

45 
	#TEAM_BALL_ABS_FAR_THRESHOLD
 2000.0

	)

46 
	#TEAM_BALL_MAHA_THRESHOLD
 1.0

	)

48 
	#MY_ASSERT
(
X
, 
Y
èià(!(X)è{ 
¡d
::
cout
 << "ERROR DETECTED: " << Y << std::
’dl
; } 
	`as£¹
(X)

	)

49 
	#MY_ASSERT_2
(
X
èià(!(X)è{ 
¡d
::
cout
 << "ERROR DETECTED" << std::
’dl
; } 
	`as£¹
(X)

	)

51 
boŞ
 
absDi¡Clo£
(cÚ¡ 
AbsCoÜd
 &
abs1
, cÚ¡ AbsCoÜd &
abs2
, 
di¡Th»shŞd
);

53 
boŞ
 
absClo£
(cÚ¡ 
AbsCoÜd
 &
abs1
, cÚ¡ AbsCoÜd &
abs2
, 
h—dšgTh»shŞd
);

55 
mšMah®ªobisDi¡ªû
(cÚ¡ 
AbsCoÜd
 &
abs1
, cÚ¡ AbsCoÜd &
abs2
);

57 
mah®ªobisDi¡ªû
(cÚ¡ 
AbsCoÜd
 &
abs
, cÚ¡ AbsCoÜd &
¡©e
);

59 
mah®ªobisDi¡ªûPos
(cÚ¡ 
AbsCoÜd
 &
abs
, cÚ¡ AbsCoÜd &
¡©e
);

61 
mah®ªobisDi¡ªûPosSQR
(cÚ¡ 
AbsCoÜd
 &
abs
, cÚ¡ AbsCoÜd &
¡©e
);

63 
mah®ªobisDi¡ªûSQR
(cÚ¡ 
PoštF
 &
obs
, cÚ¡ PoštF &
¡©e
, cÚ¡ 
Eig’
::
M©rix
<, 2, 2> &
¡©e_v¬
);

68 
šlše
 
	$g‘95CF
(
lim™
) {

69  
lim™
 *†imit / 4.0f;

70 
	}
}

72 
	g‹m¶©e
<
	gROWS
, 
	gCOLS
>

73 
	gEig’
::
M©rixXd
 
cİySticToDyÇmicM©rix
(cÚ¡ 
Eig’
::
M©rix
<, 
ROWS
, 
COLS
> &
m©rix
) {

74 
	gEig’
::
M©rixXd
 
»suÉ
(
ROWS
, 
COLS
);

75 
	gi
 = 0; i < 
	gROWS
; i++) {

76 
	gj
 = 0; j < 
	gCOLS
; j++) {

77 
»suÉ
(
i
, 
j
èğ
m©rix
(i, j);

80  
	g»suÉ
;

83 
	gEig’
::
M©rixXd
 
¥¬£MuÉliÿtiÚ
(

84 cÚ¡ 
Eig’
::
M©rixXd
 &
lhs
, 
rowS¹
, 
cŞS¹
, 
rowEnd
, 
cŞEnd
,

85 cÚ¡ 
Eig’
::
M©rixXd
 &
rhs
);

87 
	gEig’
::
M©rixXd
 
¥¬£MuÉliÿtiÚ
(

88 cÚ¡ 
Eig’
::
M©rixXd
 &
lhs
,

89 cÚ¡ 
Eig’
::
M©rixXd
 &
rhs
, 
rowS¹
, 
cŞS¹
, 
rowEnd
, 
cŞEnd
);

91 
šlše
 
	$´‘tyOuutM©rix
(
¡d
::
¡ršg
 
Çme
, cÚ¡ 
Eig’
::
M©rixXd
 &
m©rix
) {

92 ià(
m©rix
.
	`cŞs
() == 1) {

93 
¡d
::
cout
 << 
Çme
 << ":";

94 
i
 = 0; i < 
m©rix
.
	`rows
(); i++) {

95 
¡d
::
cout
 << "\t" << std::
fixed
 << std::
	`£»cisiÚ
(1è<< 
	`m©rix
(
i
, 0);

97 
¡d
::
cout
 << std::
’dl
;

99 
¡d
::
cout
 << 
Çme
 << std::
’dl
;

100 
i
 = 0; i < 
m©rix
.
	`rows
(); i++) {

101 
j
 = 0; j < 
m©rix
.
	`cŞs
(); j++) {

102 
¡d
::
cout
 << std::
fixed
 << std::
	`£»cisiÚ
(1è<< 
	`m©rix
(
i
, 
j
) << "\t";

104 
¡d
::
cout
 << std::
’dl
;

107 
	}
}

110 
logAbsCoÜd
(cÚ¡ 
AbsCoÜd
 
abs
, 
¡d
::
¡ršg
 
Çme
);

111 
logAbsCoÜdV¬
(cÚ¡ 
AbsCoÜd
 
abs
, 
¡d
::
¡ršg
 
Çme
);

112 
logAbsCoÜdCov
(cÚ¡ 
AbsCoÜd
 
abs
, 
¡d
::
¡ršg
 
Çme
);

	@robot/perception/localisation/Localiser.cpp

32 
	~<ÿs£¹
>

34 
	~"Loÿli£r.hµ
"

35 
	~"Loÿli§tiÚUts.hµ
"

36 
	~"uts/Logg”.hµ
"

37 
	~"uts/šÿ·c™©ed.hµ
"

38 
	~"uts/¥“ch.hµ
"

40 cÚ¡ 
	gMAX_GAUSSIANS
 = 8;

42 
	gLoÿli£r
::
	$Loÿli£r
(
¶ay”Numb”
) {

43 
this
->
myPÏy”Numb”
 = 
¶ay”Numb”
;

44 
b®lLo¡CouÁ
 = 0;

45 
wÜldDi¡ributiÚ
 = 
Ãw
 
	`MuÉiGaussŸnDi¡ributiÚ
(
MAX_GAUSSIANS
, 
¶ay”Numb”
);

46 
sh¬edDi¡ributiÚ
 = 
Ãw
 
	`Sh¬edDi¡ributiÚ
();

47 
	}
}

49 
	gLoÿli£r
::~
	$Loÿli£r
() {

50 
d–‘e
 
wÜldDi¡ributiÚ
;

51 
d–‘e
 
sh¬edDi¡ributiÚ
;

52 
	}
}

54 
	gLoÿli£r
::
	$£tRe£t
() {

55 
wÜldDi¡ributiÚ
->
	`»£tDi¡ributiÚToP’®i£dPo£
();

56 
	`»£tSh¬edUpd©eD©a
();

57 
	}
}

59 
	gLoÿli£r
::
	$»£tToP’®tyShoÙout
() {

60 
wÜldDi¡ributiÚ
->
	`»£tToP’®tyShoÙout
();

61 
	}
}

63 
	gLoÿli£r
::
	$£tLšeUpMode
(
boŞ
 
’abËd
) {

64 
wÜldDi¡ributiÚ
->
	`£tLšeUpMode
(
’abËd
);

65 
	}
}

67 
	gLoÿli£r
::
	$£tR—dyMode
(
boŞ
 
’abËd
) {

68 
Loÿli§tiÚCÚ¡ªtsProvid”
& 
	`cÚ¡ªtsProvid”
(Loÿli§tiÚCÚ¡ªtsProvid”::
	`š¡ªû
());

69 
cÚ¡ªtsProvid”
.
	`£tR—dyMode
(
’abËd
);

71 
wÜldDi¡ributiÚ
->
	`£tR—dyMode
(
’abËd
);

72 
sh¬edDi¡ributiÚ
->
	`£tR—dyMode
(
’abËd
);

73 
	}
}

75 
	gLoÿli£r
::
	$¡¬tOfPÏyRe£t
() {

76 
wÜldDi¡ributiÚ
->
	`¡¬tOfPÏyRe£t
();

77 
	`»£tSh¬edUpd©eD©a
();

78 
	}
}

80 
AbsCoÜd
 
	gLoÿli£r
::
	$g‘RobÙPo£
() {

81 
	`as£¹
(
wÜldDi¡ributiÚ
 !ğ
NULL
);

82  
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘RobÙPo£
();

83 
	}
}

85 
AbsCoÜd
 
	gLoÿli£r
::
	$g‘B®lPos™iÚ
() {

86 
	`as£¹
(
wÜldDi¡ributiÚ
 !ğ
NULL
);

87  
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘B®lPos™iÚ
();

88 
	}
}

90 
AbsCoÜd
 
	gLoÿli£r
::
	$g‘B®lV–oc™y
() {

91 
	`as£¹
(
wÜldDi¡ributiÚ
 !ğ
NULL
);

92  
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘B®lV–oc™y
();

93 
	}
}

95 
	gLoÿli£r
::
	$g‘B®lLo¡CouÁ
() {

96  
b®lLo¡CouÁ
;

97 
	}
}

99 
	gLoÿli£r
::
	$g‘RobÙPosUnû¹ašty
() const {

100  
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘RobÙPosUnû¹ašty
();

101 
	}
}

103 
	gLoÿli£r
::
	$g‘RobÙH—dšgUnû¹ašty
() const {

104  
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘RobÙH—dšgUnû¹ašty
();

105 
	}
}

107 
	gLoÿli£r
::
	$g‘B®lPosUnû¹ašty
() const {

108  
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘B®lPosUnû¹ašty
();

109 
	}
}

111 
	gLoÿli£r
::
	$g‘B®lV–oc™yUnû¹ašty
() const {

112  
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘B®lV–oc™yUnû¹ašty
();

113 
	}
}

115 
Sh¬edLoÿli§tiÚUpd©eBundË
 
	gLoÿli£r
::
	$g‘Sh¬edUpd©eD©a
() const {

116  
sh¬edDi¡ributiÚ
->
	`g‘Brßdÿ¡D©a
();

117 
	}
}

119 
	gLoÿli£r
::
	$»£tSh¬edUpd©eD©a
() {

120 cÚ¡ 
Sim¶eGaussŸn
 *
tİGaussŸn
 = 
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
();

121 
sh¬edDi¡ributiÚ
->
	`»£t
(
tİGaussŸn
);

122 
	}
}

124 
	gLoÿli£r
::
	$loÿli£
(cÚ¡ 
Loÿli£rBundË
 &
lb
, cÚ¡ 
boŞ
 
ÿnDoOb£rv©iÚs
) {

125 ià(
lb
.
visiÚUpd©eBundË
.
visibËB®ls
.
	`size
() > 1) {

126 
¡d
::
cout
 << "MULTIBALL!!" << std::
’dl
;

129 
boŞ
 
ÿnS“B®l
 = 
lb
.
visiÚUpd©eBundË
.
visibËB®ls
.
	`size
() > 0;

131 
wÜldDi¡ributiÚ
->
	`´oûssUpd©e
(
lb
.
odom‘ry
,†b.
dTimeSecÚds
, 
ÿnS“B®l
);

132 ià(
ÿnDoOb£rv©iÚs
) {

133 
wÜldDi¡ributiÚ
->
	`visiÚUpd©e
(
lb
.
visiÚUpd©eBundË
);

136 
sh¬edDi¡ributiÚ
->
	`´oûssUpd©e
(
lb
.
odom‘ry
,†b.
dTimeSecÚds
, 
ÿnS“B®l
);

137 ià(
ÿnDoOb£rv©iÚs
 && 
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘HaveLa¡VisiÚUpd©e
()) {

138 
sh¬edDi¡ributiÚ
->
	`visiÚUpd©e
(

139 
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘La¡Aµl›dICPUpd©e
(),

140 
wÜldDi¡ributiÚ
->
	`g‘TİGaussŸn
()->
	`g‘La¡Aµl›dVisiÚUpd©e
());

143 ià(
lb
.
visiÚUpd©eBundË
.
visibËB®ls
.
	`size
(è> 0 && 
ÿnDoOb£rv©iÚs
) {

144 
b®lLo¡CouÁ
 = 0;

146 
b®lLo¡CouÁ
++;

149 
	}
}

151 
	gLoÿli£r
::
	$­¶yRemÙeUpd©e
(cÚ¡ 
Brßdÿ¡D©a
 &
brßdÿ¡D©a
, 
¶ay”Numb”
) {

153 ià(
¶ay”Numb”
 =ğ
myPÏy”Numb”
 || !
brßdÿ¡D©a
.
sh¬edLoÿli§tiÚBundË
.
isUpd©eV®id
) {

157 
	`MY_ASSERT_2
(
¶ay”Numb”
 >= 1 &&…layerNumber <= 5);

161 
‹amm©eIndex
 = 0;

162 ià(
¶ay”Numb”
 < 
myPÏy”Numb”
) {

163 
‹amm©eIndex
 = 
¶ay”Numb”
 - 1;

165 
‹amm©eIndex
 = 
¶ay”Numb”
 - 2;

168 
	`MY_ASSERT
(
‹amm©eIndex
 >= 0 &&eammateIndex <= 3, "InvalideammateIndex");

169 
wÜldDi¡ributiÚ
->
	`­¶yRemÙeUpd©e
(
brßdÿ¡D©a
, 
‹amm©eIndex
, 
¶ay”Numb”
 == 1);

170 
	}
}

172 
	gLoÿli£r
::
	$g‘La¡Ob£rv©iÚLik–yhood
() const {

173  
wÜldDi¡ributiÚ
->
	`g‘La¡Ob£rv©iÚLik–yhood
();

174 
	}
}

	@robot/perception/localisation/Localiser.hpp

31 #´agm¨
Úû


33 
	~<veùÜ
>

34 
	~<memÜy
>

35 
	~<m­
>

37 
	~"MuÉiGaussŸnDi¡ributiÚ.hµ
"

38 
	~"Sh¬edDi¡ributiÚ.hµ
"

39 
	~"Sh¬edLoÿli§tiÚUpd©eBundË.hµ
"

40 
	~"VisiÚUpd©eBundË.hµ
"

41 
	~"Loÿli§tiÚCÚ¡ªtsProvid”.hµ
"

42 
	~"ty³s/AbsCoÜd.hµ
"

43 
	~"ty³s/Odom‘ry.hµ
"

44 
	~"ty³s/AùiÚCommªd.hµ
"

45 
	~"ty³s/Brßdÿ¡D©a.hµ
"

46 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

48 
	sLoÿli£rBundË
 {

49 
Loÿli£rBundË
():

50 
odom‘ry
(),

51 
visiÚUpd©eBundË
(),

52 
acAùive
(),

53 
isP’®i£d
(
çl£
),

54 
¡©e
(0),

55 
¡©e2
(0),

56 
dTimeSecÚds
(0.0) {}

58 
Loÿli£rBundË
(cÚ¡ 
Odom‘ry
 &
odom‘ry
,

59 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚUpd©eBundË
,

60 cÚ¡ 
AùiÚCommªd
::
AÎ
 &
acAùive
,

61 cÚ¡ 
boŞ
 &
isP’®i£d
,

62 cÚ¡ 
ušt8
 &
¡©e
,

63 cÚ¡ 
ušt8
 &
¡©e2
,

64 cÚ¡ 
dTimeSecÚds
) :

65 
odom‘ry
(odometry),

66 
visiÚUpd©eBundË
(visionUpdateBundle),

67 
acAùive
(acActive),

68 
isP’®i£d
(isPenalised),

69 
¡©e
(state),

70 
¡©e2
(state2),

71 
dTimeSecÚds
(dTimeSeconds) {}

73 
Odom‘ry
 
	modom‘ry
;

74 
VisiÚUpd©eBundË
 
	mvisiÚUpd©eBundË
;

75 
	mAùiÚCommªd
::
AÎ
 
acAùive
;

76 
boŞ
 
	misP’®i£d
;

77 
ušt8
 
	m¡©e
;

78 
ušt8
 
	m¡©e2
;

79 
	mdTimeSecÚds
;

82 şas 
	cLoÿli£r
 {

83 
	mpublic
:

84 
Loÿli£r
(
¶ay”Numb”
);

85 ~
Loÿli£r
();

91 
£tRe£t
();

93 
»£tToP’®tyShoÙout
();

100 
£tLšeUpMode
(
boŞ
 
’abËd
);

106 
£tR—dyMode
(
boŞ
 
’abËd
);

112 
¡¬tOfPÏyRe£t
();

114 
AbsCoÜd
 
g‘RobÙPo£
();

115 
AbsCoÜd
 
g‘B®lPos™iÚ
();

116 
AbsCoÜd
 
g‘B®lV–oc™y
();

117 
g‘B®lLo¡CouÁ
();

119 
	$g‘RobÙPosUnû¹ašty
() const;

120 
	$g‘RobÙH—dšgUnû¹ašty
() const;

121 
	$g‘B®lPosUnû¹ašty
() const;

122 
	$g‘B®lV–oc™yUnû¹ašty
() const;

124 
Sh¬edLoÿli§tiÚUpd©eBundË
 
	$g‘Sh¬edUpd©eD©a
() const;

125 
	`»£tSh¬edUpd©eD©a
();

127 
	`loÿli£
(cÚ¡ 
Loÿli£rBundË
 &
lb
, cÚ¡ 
boŞ
 
ÿnDoOb£rv©iÚs
);

128 
	`­¶yRemÙeUpd©e
(cÚ¡ 
Brßdÿ¡D©a
 &
brßdÿ¡D©a
, 
¶ay”Numb”
);

130 
	$g‘La¡Ob£rv©iÚLik–yhood
() const;

132 
´iv©e
:

133 
myPÏy”Numb”
;

134 
b®lLo¡CouÁ
;

136 
MuÉiGaussŸnDi¡ributiÚ
 *
wÜldDi¡ributiÚ
;

137 
Sh¬edDi¡ributiÚ
 *
sh¬edDi¡ributiÚ
;

140 
šlše
 
¡d
::
o¡»am
& 
İ”©Ü
<<(¡d::o¡»am& 
os
, cÚ¡ 
Loÿli£rBundË
& 
bundË
) {

141 
os
.
	`wr™e
((*è&(
bundË
.
odom‘ry
), (
Odom‘ry
));

142 
os
 << 
bundË
.
visiÚUpd©eBundË
;

143 
os
.
	`wr™e
((*è&(
bundË
.
dTimeSecÚds
), ());

145  
os
;

146 
	}
}

148 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gLoÿli£rBundË
& 
	gbundË
) {

149 
	gis
.
»ad
((*è&(
bundË
.
odom‘ry
), (
Odom‘ry
));

150 ià(
	gis
.
eof
(è|| !is.
good
()) {

151  
	gis
;

154 
	gis
 >> 
	gbundË
.
	gvisiÚUpd©eBundË
;

155 ià(
	gis
.
eof
(è|| !is.
good
()) {

156  
	gis
;

159 
	gis
.
»ad
((*è&(
bundË
.
dTimeSecÚds
), ());

160  
	gis
;

	@robot/perception/localisation/MultiGaussianDistribution.cpp

32 
	~"MuÉiGaussŸnDi¡ributiÚ.hµ
"

33 
	~"Loÿli§tiÚCÚ¡ªtsProvid”.hµ
"

34 
	~"Sim¶eGaussŸn.hµ
"

35 
	~"VisiÚUpd©eBundË.hµ
"

36 
	~"ty³s/Odom‘ry.hµ
"

37 
	~"Loÿli§tiÚUts.hµ
"

38 
	~"uts/Logg”.hµ
"

39 
	~"uts/¥“ch.hµ
"

41 
	~<ÿs£¹
>

42 
	~<veùÜ
>

43 
	~<®gÜ™hm
>

45 
	~"Eig’/Geom‘ry
"

46 
	~"Eig’/LU
"

48 
usšg
 
Çme¥aû
 
	gEig’
;

50 cÚ¡ 
	gLoÿli§tiÚCÚ¡ªtsProvid”
& 
cÚ¡ªtsProvid”
(

51 
Loÿli§tiÚCÚ¡ªtsProvid”
::
š¡ªû
());

56 
	sGuassŸnSÜtFunùiÚ
 {

57 
boŞ
 
İ”©Ü
()(cÚ¡ 
Sim¶eGaussŸn
 *
	mlhs
, cÚ¡ Sim¶eGaussŸÀ*
	mrhs
) {

58  
	mlhs
->
g‘Weight
(è> 
	mrhs
->getWeight();

62 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$MuÉiGaussŸnDi¡ributiÚ
(
maxGaussŸns
, 
¶ay”Numb”
) :

63 
	`maxGaussŸns
(
maxGaussŸns
), 
	`¶ay”Numb”
(
¶ay”Numb”
),

64 
	$‹amB®lT¿ck”
(
¶ay”Numb”
) {

65 
	`MY_ASSERT
(
maxGaussŸns
 > 0, "invalid‚umber of maxGaussians");

66 
	`»£tDi¡ributiÚToP’®i£dPo£
();

67 
Ï¡Ob£rv©iÚLik–yhood
 = 0.00001;

69 
isInR—dyMode
 = 
çl£
;

70 
haveS“nLªdm¬ks
 = 
çl£
;

71 
numVisiÚUpd©esInR—dy
 = 0;

72 
	}
}

74 
	gMuÉiGaussŸnDi¡ributiÚ
::~
	$MuÉiGaussŸnDi¡ributiÚ
() {

75 
i
 = 0; i < 
modes
.
	`size
(); i++) {

76 
d–‘e
 
modes
[
i
];

78 
	}
}

80 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$»£tDi¡ributiÚToP’®i£dPo£
() {

81 
Eig’
::
M©rixXd
 
	`m—n
(
MAIN_DIM
, 1);

82 
Eig’
::
M©rixXd
 
	`´eviousTİ
(
MAIN_DIM
, 1);

83 
boŞ
 
hasP»viousLoÿli§tiÚ
 = 
çl£
;

85 ià(
modes
.
	`size
() == 0) {

86 
m—n
 << -2.0*
FIELD_LENGTH
/6.0, 
FIELD_WIDTH
/2.0, -
M_PI
/2.0,

96 
m—n
 = 
modes
.
	`äÚt
()->
	`g‘M—n
();

97 
	`m—n
(0, 0èğ-
FIELD_LENGTH
/3.0;

98 
	`m—n
(1, 0èğ
FIELD_WIDTH
/2.0;

99 
	`m—n
(2, 0èğ-
M_PI
/2.0;

101 
´eviousTİ
 = 
modes
.
	`äÚt
()->
	`g‘M—n
();

102 
hasP»viousLoÿli§tiÚ
 = 
Œue
;

105 
Eig’
::
M©rixXd
 
	`dŸgÚ®V¬Ÿnû
(
MAIN_DIM
, 1);

106 
dŸgÚ®V¬Ÿnû
 << 
	`g‘95CF
(
FULL_FIELD_LENGTH
/4.0), g‘95CF(
FULL_FIELD_WIDTH
/4.0), g‘95CF(
M_PI
 / 4.0),

107 
	`g‘95CF
(10.0*
FULL_FIELD_LENGTH
), g‘95CF(10.0*
FULL_FIELD_WIDTH
),

108 
	`g‘95CF
(10000.0), get95CF(10000.0),

110 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

111 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

112 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

113 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
);

115 
modes
.
	`ş—r
();

116 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0/4.0, 
m—n
, 
dŸgÚ®V¬Ÿnû
));

118 
	`m—n
(1, 0) *= -1.0;

119 
	`m—n
(2, 0) *= -1.0;

120 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0/4.0, 
m—n
, 
dŸgÚ®V¬Ÿnû
));

123 
	`m—n
(0, 0è+ğ
FIELD_LENGTH
/6.0;

124 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0/4.0, 
m—n
, 
dŸgÚ®V¬Ÿnû
));

126 
	`m—n
(1, 0) *= -1.0;

127 
	`m—n
(2, 0) *= -1.0;

128 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0/4.0, 
m—n
, 
dŸgÚ®V¬Ÿnû
));

130 
	`m—n
(0, 0) = -3900;

131 
	`m—n
(1, 0) = 0;

132 
	`m—n
(2, 0) = 0;

133 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0/4.0, 
m—n
, 
dŸgÚ®V¬Ÿnû
));

135 
	`m—n
(0, 0) = -800;

136 
	`m—n
(1, 0) = 0;

137 
	`m—n
(2, 0) = 0;

138 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0/8.0, 
m—n
, 
dŸgÚ®V¬Ÿnû
));

140 ià(
hasP»viousLoÿli§tiÚ
) {

141 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0/8.0, 
´eviousTİ
, 
dŸgÚ®V¬Ÿnû
));

143 
	}
}

145 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$»£tToP’®tyShoÙout
() {

146 
Eig’
::
M©rixXd
 
	`m—n
(
MAIN_DIM
, 1);

148 ià(
¶ay”Numb”
 == 1) {

149 
m—n
 << -
FIELD_LENGTH
/2.0, 0.0, 0.0,

158 
m—n
 << 2200.0, 0.0, 0.0,

168 
Eig’
::
M©rixXd
 
	`dŸgÚ®V¬Ÿnû
(
MAIN_DIM
, 1);

169 
dŸgÚ®V¬Ÿnû
 << 
	`g‘95CF
(
FULL_FIELD_WIDTH
/4.0), g‘95CF(FULL_FIELD_WIDTH/4.0), g‘95CF(
M_PI
 / 8.0),

170 
	`g‘95CF
(10.0*
FULL_FIELD_WIDTH
), get95CF(10.0*FULL_FIELD_WIDTH),

171 
	`g‘95CF
(10000.0), get95CF(10000.0),

173 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

174 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

175 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

176 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
);

178 
modes
.
	`ş—r
();

179 
modes
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 1.0, 
m—n
, 
dŸgÚ®V¬Ÿnû
));

180 
	}
}

182 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$£tLšeUpMode
(
boŞ
 
’abËd
) {

183 
i
 = 0; i < 
modes
.
	`size
(); i++) {

184 
modes
[
i
]->
	`£tLšeUpMode
(
’abËd
);

186 
	}
}

188 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$£tR—dyMode
(
boŞ
 
’abËd
) {

189 
isInR—dyMode
 = 
’abËd
;

190 ià(!
isInR—dyMode
) {

191 
numVisiÚUpd©esInR—dy
 = 0;

192 
haveS“nLªdm¬ks
 = 
çl£
;

195 
i
 = 0; i < 
modes
.
	`size
(); i++) {

196 
modes
[
i
]->
	`£tR—dyMode
(
’abËd
);

198 
	}
}

200 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$¡¬tOfPÏyRe£t
() {

202 
i
 = 1; i < 
modes
.
	`size
(); i++) {

203 ià(
modes
[
i
]->
	`g‘RobÙPo£
().
	`x
() > 0.0) {

204 
modes
[
i
]->
	`£tWeight
(0.0);

208 
AbsCoÜd
 
robÙPo£
 = 
modes
.
	`äÚt
()->
	`g‘RobÙPo£
();

215 ià(
robÙPo£
.
	`x
(è> 1000.0 || (robÙPo£.x(è> 0.0 && 
	`çbs
ÔobÙPo£.
	`th‘a
()è> 
M_PI
/2.0)) {

216 
Sim¶eGaussŸn
 *
æ³dMode
 = 
modes
.
	`äÚt
()->
	`ü—‹Symm‘ricGaussŸn
();

217 
modes
.
	`äÚt
()->
	`£tWeight
(0.0);

218 
modes
.
	`push_back
(
æ³dMode
);

221 
	`fixupDi¡ributiÚ
();

222 
	}
}

224 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$´oûssUpd©e
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

225 cÚ¡ 
boŞ
 
ÿnS“B®l
) {

226 
	`MY_ASSERT
(
	`checkV®idDi¡ributiÚ
(
modes
), "invalid distribution @…rocessUpdate start");

227 
i
 = 0; i < 
modes
.
	`size
(); i++) {

228 
modes
[
i
]->
	`´oûssUpd©e
(
odom‘ry
, 
dTimeSecÚds
, 
ÿnS“B®l
);

230 
	`MY_ASSERT
(
	`checkV®idDi¡ributiÚ
(
modes
), "invalid distribution @…rocessUpdateƒnd");

231 
	}
}

233 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$visiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
) {

234 
	`MY_ASSERT
(
	`checkV®idDi¡ributiÚ
(
modes
), "invalid distribution @ visionUpdate start");

236 
‹amB®lT¿ck”
.
	`deÿy
();

237 
haveS“nLªdm¬ks
 = 
visiÚBundË
.
po¡s
.
	`size
() > 0;

239 ià(
isInR—dyMode
) {

240 
numVisiÚUpd©esInR—dy
++;

243 
Ï¡Ob£rv©iÚLik–yhood
 = -1.0;

245 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
®lNewModes
;

246 
i
 = 0; i < 
modes
.
	`size
(); i++) {

247 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ÃwModes
 = 
modes
[
i
]->
	`visiÚUpd©e
(
visiÚBundË
);

248 
®lNewModes
.
	`š£¹
×ÎNewModes.
	`’d
(), 
ÃwModes
.
	`begš
(),‚ewModes.end());

250 ià(
i
 =ğ0 && (
visiÚBundË
.
f›ldF—tu»s
.
	`size
(è> 0 || visiÚBundË.
po¡s
.size() > 0 ||

251 
visiÚBundË
.
visibËB®ls
.
	`size
() > 0)) {

252 
j
 = 0; j < 
ÃwModes
.
	`size
(); j++) {

253 
weightAdju¡m’t
 = 
ÃwModes
[
j
]->
	`g‘Weight
();

254 ià(
weightAdju¡m’t
 > 
Ï¡Ob£rv©iÚLik–yhood
) {

255 
Ï¡Ob£rv©iÚLik–yhood
 = 
weightAdju¡m’t
;

261 
modes
.
	`š£¹
(modes.
	`’d
(), 
®lNewModes
.
	`begš
(),‡llNewModes.end());

266 ià(
	`isInIn™ŸlS‹
(è&& 
haveS“nLªdm¬ks
) {

267 
i
 = 0; i < 
modes
.
	`size
(); i++) {

268 ià(
modes
[
i
]->
	`g‘HaveLa¡VisiÚUpd©e
()) {

269 
modes
[
i
]->
	`doICPUpd©e
(
visiÚBundË
, 
Œue
);

275 ià(
¶ay”Numb”
 == 1) {

276 
i
 = 0; i < 
modes
.
	`size
(); i++) {

277 ià(
modes
[
i
]->
	`g‘RobÙPo£
().
	`x
() > 0.0) {

278 
modes
[
i
]->
	`£tWeight
(modes[i]->
	`g‘Weight
() * 0.00001);

283 
	`fixupDi¡ributiÚ
();

290 ià(!
	`isInIn™ŸlS‹
()) {

291 ià(!
modes
.
	`em±y
(è&& modes.
	`äÚt
()->
	`g‘HaveLa¡VisiÚUpd©e
()) {

292 
Sim¶eGaussŸn
 *
noICPMode
 = 
modes
.
	`äÚt
()->
	`ü—‹S¶™GaussŸn
();

293 
šv®idICPProbab™y
 =

294 
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
INVALID_ICP_PROBABILITY
);

296 
iıWeight
 = 
modes
.
	`äÚt
()->
	`doICPUpd©e
(
visiÚBundË
, 
çl£
);

297 ià(
iıWeight
 < 
šv®idICPProbab™y
) {

298 
modes
.
	`äÚt
()->
	`£tWeight
(0.0);

299 
modes
.
	`push_back
(
noICPMode
);

301 
d–‘e
 
noICPMode
;

304 
	`fixupDi¡ributiÚ
();

308 ià(
modes
.
	`em±y
()) {

309 
¡d
::
cout
 << "Di¡ributiÚ i em±y! Thi i bad,„e£‰šgØš™ŸÈ¡©tØ»cov”" << std::
’dl
;

310 
	`»£tDi¡ributiÚToP’®i£dPo£
();

313 
	`MY_ASSERT
(
	`checkV®idDi¡ributiÚ
(
modes
), "invalid distribution @ visionUpdateƒnd");

314 
	}
}

316 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$­¶yRemÙeUpd©e
(

317 cÚ¡ 
Brßdÿ¡D©a
 &
brßdÿ¡D©a
, 
‹amm©eIndex
, 
boŞ
 
isFromGßl›
) {

318 
	`MY_ASSERT
(
	`checkV®idDi¡ributiÚ
(
modes
), "invalid distribution @„emoteUpdate start");

320 ià(
brßdÿ¡D©a
.
sh¬edLoÿli§tiÚBundË
.
haveB®lUpd©es
) {

321 
	`addSymm‘ricMode
(
modes
);

324 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
®lNewModes
;

325 
boŞ
 
amIGßl›
 = (
¶ay”Numb”
 == 1);

326 
i
 = 0; i < 
modes
.
	`size
(); i++) {

327 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ÃwModes
 = 
modes
[
i
]->
	`­¶yRemÙeUpd©e
(

328 
brßdÿ¡D©a
.
sh¬edLoÿli§tiÚBundË
, 
‹amm©eIndex
, 
amIGßl›
);

330 
®lNewModes
.
	`š£¹
×ÎNewModes.
	`’d
(), 
ÃwModes
.
	`begš
(),‚ewModes.end());

332 
modes
.
	`š£¹
(modes.
	`’d
(), 
®lNewModes
.
	`begš
(),‡llNewModes.end());

335 ià(!
amIGßl›
) {

336 
‹amB®lT¿ck”
.
	`addT—mm©eOb£rv©iÚ
(
brßdÿ¡D©a
);

337 
i
 = 0; i < 
modes
.
	`size
(); i++) {

338 ià(
‹amB®lT¿ck”
.
	`isModeFl³d
(*
modes
[
i
])) {

339 ià(
i
 == 0) {

340 
	`SAY
("Teammates flipping me");

343 
weightSÿË
 = 
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
TEAMMATE_FLIP_WEIGHT
);

344 
modes
[
i
]->
	`£tWeight
(modes[i]->
	`g‘Weight
(è* 
weightSÿË
);

349 
	`fixupDi¡ributiÚ
();

350 
	`MY_ASSERT
(
	`checkV®idDi¡ributiÚ
(
modes
), "invalid distribution @„emoteUpdateƒnd");

351 
	}
}

353 cÚ¡ 
Sim¶eGaussŸn
* 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$g‘TİGaussŸn
() const {

354 
	`MY_ASSERT
(
	`checkV®idDi¡ributiÚ
(
modes
), "invalid distribution @ getTopGaussian");

355  
modes
[0];

356 
	}
}

358 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$g‘La¡Ob£rv©iÚLik–yhood
() const {

359  
Ï¡Ob£rv©iÚLik–yhood
;

360 
	}
}

362 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$doT—mm©eRobÙVisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
) {

363 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
®lNewModes
;

364 
i
 = 0; i < 
modes
.
	`size
(); i++) {

365 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ÃwModes
 = 
modes
[
i
]->
	`visiÚT—mm©eRobÙsUpd©e
(
visiÚBundË
);

366 
®lNewModes
.
	`š£¹
×ÎNewModes.
	`’d
(), 
ÃwModes
.
	`begš
(),‚ewModes.end());

369 
modes
.
	`š£¹
(modes.
	`’d
(), 
®lNewModes
.
	`begš
(),‡llNewModes.end());

370 
	`fixupDi¡ributiÚ
();

371 
	}
}

373 
boŞ
 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$isInIn™ŸlS‹
() {

374  
isInR—dyMode
;

375 
	}
}

377 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$fixupDi¡ributiÚ
() {

378 
¡d
::
	`sÜt
(
modes
.
	`begš
(), modes.
	`’d
(), 
	`GuassŸnSÜtFunùiÚ
());

379 
	`nÜm®i£Di¡ributiÚ
(
modes
);

380 
	`m”geSim¬Modes
(
modes
);

381 
¡d
::
	`sÜt
(
modes
.
	`begš
(), modes.
	`’d
(), 
	`GuassŸnSÜtFunùiÚ
());

382 
	`nÜm®i£Di¡ributiÚ
(
modes
);

383 
	`»moveUÆik–yModes
(
modes
);

384 
	`»moveExûssModes
(
modes
, 
maxGaussŸns
);

385 
	`nÜm®i£Di¡ributiÚ
(
modes
);

386 
	}
}

388 
	gMuÉiGaussŸnDi¡ributiÚ
::
nÜm®i£Di¡ributiÚ
(cÚ¡ 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
) {

389 
weightSum
 = 0.0;

390 
	gi
 = 0; i < 
	gdi¡ributiÚ
.
size
(); i++) {

391 
	gweightSum
 +ğ
di¡ributiÚ
[
i
]->
g‘Weight
();

395 
	gsÿË
 = 1.0 / 
weightSum
;

396 
	gi
 = 0; i < 
	gdi¡ributiÚ
.
size
(); i++) {

397 
	gdi¡ributiÚ
[
i
]->
£tWeight
(
di¡ributiÚ
[i]->
g‘Weight
(è* 
sÿË
);

401 
	gMuÉiGaussŸnDi¡ributiÚ
::
m”geSim¬Modes
(cÚ¡ 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
) {

402 
i
 = 0; 
	gi
 < 
	gdi¡ributiÚ
.
size
() - 1; i++) {

403 ià(
	gdi¡ributiÚ
[
i
]->
g‘Weight
() > 0.0) {

404 
	g¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
sim¬GaussŸns
;

406 
	gj
 = 
i
 + 1; j < 
	gdi¡ributiÚ
.
size
(); j++) {

407 ià(
	gdi¡ributiÚ
[
i
]->
isSim¬To
(*
di¡ributiÚ
[
j
])) {

408 
	gsim¬GaussŸns
.
push_back
(
di¡ributiÚ
[
j
]);

412 
	gj
 = 0; j < 
	gsim¬GaussŸns
.
size
(); j++) {

413 
	gdi¡ributiÚ
[
i
]->
m”geW™h
(*
sim¬GaussŸns
[
j
]);

419 
	gMuÉiGaussŸnDi¡ributiÚ
::
»moveUÆik–yModes
(
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
) {

420 
MY_ASSERT
(
checkV®idDi¡ributiÚ
(
di¡ributiÚ
), "invalid distribution @„emoveUnlikelyModes");

422 
	gmšWeight
 = 
cÚ¡ªtsProvid”
.
g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
MIN_MODE_WEIGHT
);

423 
	gdi¡ributiÚ
.
back
()->
g‘Weight
(è< 
	gmšWeight
 && di¡ributiÚ.
size
() > 1) {

424 
d–‘e
 
	gdi¡ributiÚ
.
back
();

425 
	gdi¡ributiÚ
.
pİ_back
();

429 
	gMuÉiGaussŸnDi¡ributiÚ
::
»moveExûssModes
(

430 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
, 
maxGaussŸns
) {

431 
MY_ASSERT
(
checkV®idDi¡ributiÚ
(
di¡ributiÚ
), "invalid distribution @„emoveExcessModes");

433 
	gdi¡ributiÚ
.
size
(è> 
	gmaxGaussŸns
) {

434 
d–‘e
 
	gdi¡ributiÚ
.
back
();

435 
	gdi¡ributiÚ
.
pİ_back
();

439 
	gMuÉiGaussŸnDi¡ributiÚ
::
addBa£lšeModes
(
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
) {

440 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ba£lše
 = Sim¶eGaussŸn::
ü—‹Ba£lšeGaussŸns
();

441 
	gdi¡ributiÚ
.
š£¹
(
di¡ributiÚ
.
’d
(), 
ba£lše
.
begš
(), baseline.end());

444 
	gMuÉiGaussŸnDi¡ributiÚ
::
addSymm‘ricMode
(
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
) {

445 
AbsCoÜd
 
b®lPos
 = 
di¡ributiÚ
.
äÚt
()->
g‘B®lPos™iÚ
();

446 
	gäomC’Œe
 = 
sq¹
(
b®lPos
.
x
()*b®lPos.x(è+ b®lPos.
y
()*ballPos.y());

450 ià(
	gäomC’Œe
 >= 1300.0) {

451 
Sim¶eGaussŸn
 *
symm‘ric
 = 
di¡ributiÚ
.
äÚt
()->
ü—‹Symm‘ricGaussŸn
();

452 
	gdi¡ributiÚ
.
push_back
(
symm‘ric
);

456 
boŞ
 
	gMuÉiGaussŸnDi¡ributiÚ
::
checkV®idDi¡ributiÚ
(

457 cÚ¡ 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
) {

458 ià(
di¡ributiÚ
.
size
() == 0) {

459 
¡d
::
cout
 << "Inv®id di¡ributiÚ,ƒm±y" << std::
’dl
;

460  
	gçl£
;

463 
	gi
 = 0; i < 
	gdi¡ributiÚ
.
size
(); i++) {

464 ià(
	gdi¡ributiÚ
[
i
]->
g‘Weight
() < 0.0 || distribution[i]->getWeight() > 1.0) {

465 
	g¡d
::
cout
 << "Inv®id di¡ributiÚ, weighˆšv®id: " << 
di¡ributiÚ
[
i
]->
g‘Weight
(è<< 
¡d
::
’dl
;

466  
	gçl£
;

470 ià(
	gi
 < (
	gdi¡ributiÚ
.
size
() - 1) &&

471 
	gdi¡ributiÚ
[
i
]->
g‘Weight
() < distribution[i + 1]->getWeight()) {

472 
	g¡d
::
cout
 << "Inv®id di¡ributiÚ, unÜd”ed" << 
¡d
::
’dl
;

473  
	gçl£
;

477  
	gŒue
;

480 
	gMuÉiGaussŸnDi¡ributiÚ
::
	$´štModes
() const {

482 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*>::
cÚ¡_™”©Ü
 
™
;

483 
i
 = 0;

484 
™
 = 
modes
.
	`begš
(); iˆ!ğmodes.
	`’d
(); ++it) {

485 
¡d
::
cout
 << 
i
 << " : " << (*
™
)->
	`g‘RobÙPo£
().
	`x
() << ", "

486 << (*
™
)->
	`g‘RobÙPo£
().
	`y
() << ", "

487 << (*
™
)->
	`g‘RobÙPo£
().
	`th‘a
() << " - "

488 << (*
™
)->
	`g‘Weight
() << " | ";

489 
¡d
::
cout
 << std::
’dl
;

490 ++
i
;

492 
¡d
::
cout
 << std::
’dl
;

493 
	}
}

	@robot/perception/localisation/MultiGaussianDistribution.hpp

31 #´agm¨
Úû


33 
	~"Sim¶eGaussŸn.hµ
"

34 
	~"VisiÚUpd©eBundË.hµ
"

35 
	~"T—mB®lT¿ck”.hµ
"

36 
	~"ty³s/Odom‘ry.hµ
"

37 
	~"ty³s/Brßdÿ¡D©a.hµ
"

39 
	~<veùÜ
>

46 şas 
	cMuÉiGaussŸnDi¡ributiÚ
 {

47 
	mpublic
:

48 
ex¶ic™
 
MuÉiGaussŸnDi¡ributiÚ
(
maxGaussŸns
, 
¶ay”Numb”
);

49 
	mvœtu®
 ~
MuÉiGaussŸnDi¡ributiÚ
();

56 
»£tDi¡ributiÚToP’®i£dPo£
();

62 
»£tToP’®tyShoÙout
();

74 
£tLšeUpMode
(
boŞ
 
’abËd
);

81 
£tR—dyMode
(
boŞ
 
’abËd
);

88 
¡¬tOfPÏyRe£t
();

95 
´oûssUpd©e
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
, cÚ¡ 
boŞ
 
ÿnS“B®l
);

100 
visiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
);

105 
­¶yRemÙeUpd©e
(cÚ¡ 
Brßdÿ¡D©a
 &
brßdÿ¡D©a
, 
‹amm©eIndex
, 
boŞ
 
isFromGßl›
);

111 cÚ¡ 
Sim¶eGaussŸn
* 
	$g‘TİGaussŸn
() const;

114 
	$g‘La¡Ob£rv©iÚLik–yhood
() const;

117 
	$´štModes
() const;

119 
´iv©e
:

121 cÚ¡ 
maxGaussŸns
;

122 cÚ¡ 
¶ay”Numb”
;

126 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
modes
;

128 
Ï¡Ob£rv©iÚLik–yhood
;

130 
boŞ
 
isInR—dyMode
;

131 
boŞ
 
haveS“nLªdm¬ks
;

132 
numVisiÚUpd©esInR—dy
;

133 
T—mB®lT¿ck”
 
‹amB®lT¿ck”
;

136 
	`doT—mm©eRobÙVisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
);

137 
boŞ
 
	`isInIn™ŸlS‹
();

138 
	`fixupDi¡ributiÚ
();

143 
	`nÜm®i£Di¡ributiÚ
(cÚ¡ 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
);

148 
	`m”geSim¬Modes
(cÚ¡ 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
);

154 
	`»moveUÆik–yModes
(
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
);

159 
	`»moveExûssModes
(
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
, 
maxGaussŸns
);

167 
	`addBa£lšeModes
(
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
);

169 
	`addSymm‘ricMode
(
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
);

171 
boŞ
 
	`checkV®idDi¡ributiÚ
(cÚ¡ 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
di¡ributiÚ
);

	@robot/perception/localisation/ObservedPostsHistory.cpp

8 
	~"Ob£rvedPo¡sHi¡Üy.hµ
"

9 
	~<io¡»am
>

12 
	gOb£rvedPo¡sHi¡Üy
::
	$Ob£rvedPo¡sHi¡Üy
(
mšF¿meG­Po¡Ob£rv©iÚ
):

13 
	$mšF¿meG­Po¡Ob£rv©iÚ
(
mšF¿meG­Po¡Ob£rv©iÚ
è{
	}
}

16 
Ob£rvedPo¡sHi¡Üy
::
	$addOb£rvedPo¡
(cÚ¡ 
Po¡Ty³
 &
po¡Ty³
) {

17 ià(
po¡Ty³
 =ğ
MY_LEFT
) {

18 
ob£rvedPo¡s
.
	`push_äÚt
(
OWN_POST_LEFT
);

19 } ià(
po¡Ty³
 =ğ
MY_RIGHT
) {

20 
ob£rvedPo¡s
.
	`push_äÚt
(
OWN_POST_RIGHT
);

21 } ià(
po¡Ty³
 =ğ
OPPONENT_LEFT
) {

22 
ob£rvedPo¡s
.
	`push_äÚt
(
OPPONENT_POST_LEFT
);

23 } ià(
po¡Ty³
 =ğ
OPPONENT_RIGHT
) {

24 
ob£rvedPo¡s
.
	`push_äÚt
(
OPPONENT_POST_RIGHT
);

26 
ob£rvedPo¡s
.
	`push_äÚt
(
NONE
);

29 
ob£rvedPo¡s
.
	`size
(è> 
mšF¿meG­Po¡Ob£rv©iÚ
) {

30 
ob£rvedPo¡s
.
	`pİ_back
();

32 
	}
}

35 
	gOb£rvedPo¡sHi¡Üy
::
	$addNoOb£rvedPo¡s
() {

36 
ob£rvedPo¡s
.
	`push_äÚt
(
NONE
);

37 
ob£rvedPo¡s
.
	`size
(è> 
mšF¿meG­Po¡Ob£rv©iÚ
) {

38 
ob£rvedPo¡s
.
	`pİ_back
();

40 
	}
}

43 
boŞ
 
	gOb£rvedPo¡sHi¡Üy
::
	$ÿnOb£rvePo¡Ty³
(cÚ¡ 
Po¡Ty³
 &
po¡Ty³
) const {

44 
Ob£rvedPo¡Side
 
di§ÎowedOb£rv©iÚLeá
;

45 
Ob£rvedPo¡Side
 
di§ÎowedOb£rv©iÚRight
;

46 ià(
po¡Ty³
 =ğ
MY_LEFT
 ||…o¡Ty³ =ğ
MY_RIGHT
) {

47 
di§ÎowedOb£rv©iÚLeá
 = 
OPPONENT_POST_LEFT
;

48 
di§ÎowedOb£rv©iÚRight
 = 
OPPONENT_POST_RIGHT
;

50 
di§ÎowedOb£rv©iÚLeá
 = 
OWN_POST_LEFT
;

51 
di§ÎowedOb£rv©iÚRight
 = 
OWN_POST_RIGHT
;

54 
¡d
::
li¡
<
Ob£rvedPo¡Side
>::
cÚ¡_™”©Ü
 
™
 = 
ob£rvedPo¡s
.
	`begš
();

55 
™
 !ğ
ob£rvedPo¡s
.
	`’d
()) {

56 ià(*
™
 =ğ
di§ÎowedOb£rv©iÚLeá
 ||

57 *
™
 =ğ
di§ÎowedOb£rv©iÚRight
) {

58  
çl£
;

60 ++
™
;

63  
Œue
;

64 
	}
}

67 
boŞ
 
	gOb£rvedPo¡sHi¡Üy
::
	$isSim¬To
(cÚ¡ 
Ob£rvedPo¡sHi¡Üy
 &
Ùh”
) const {

68 
Ob£rvedPo¡Side
 
mySide
 = 
NONE
;

69 
¡d
::
li¡
<
Ob£rvedPo¡Side
>::
cÚ¡_™”©Ü
 
™
 = 
ob£rvedPo¡s
.
	`begš
();

70 
™
 !ğ
ob£rvedPo¡s
.
	`’d
()) {

71 ià(*
™
 !ğ
NONE
) {

72 
mySide
 = *
™
;

74 ++
™
;

77 
Ob£rvedPo¡Side
 
Ùh”Side
 = 
NONE
;

78 
™
 = 
Ùh”
.
ob£rvedPo¡s
.
	`begš
();

79 
™
 !ğ
Ùh”
.
ob£rvedPo¡s
.
	`’d
()) {

80 ià(*
™
 !ğ
NONE
) {

81 
Ùh”Side
 = *
™
;

83 ++
™
;

87 
boŞ
 
myHome
 = (
mySide
 =ğ
OWN_POST_LEFT
 || mySid=ğ
OWN_POST_RIGHT
);

88 
boŞ
 
İHome
 = (
Ùh”Side
 =ğ
OWN_POST_LEFT
 || oth”Sid=ğ
OWN_POST_RIGHT
);

89 ià(
myHome
 !ğ
İHome
è 
çl£
;

92 
n
 = 4;

93 
i
 = 0;

94 
™
 = 
Ùh”
.
ob£rvedPo¡s
.
	`begš
();

95 
¡d
::
li¡
<
Ob£rvedPo¡Side
>::
cÚ¡_™”©Ü
 
jt
 = 
ob£rvedPo¡s
.
	`begš
();

96 
™
 !ğ
Ùh”
.
ob£rvedPo¡s
.
	`’d
() &&

97 
jt
 !ğ
ob£rvedPo¡s
.
	`’d
() &&

98 
i
 < 
n
) {

99 ià(*
™
 !ğ*
jt
è 
çl£
;

100 ++
i
;

101 ++
™
;

102 ++
jt
;

105  
Œue
;

106 
	}
}

109 
	gOb£rvedPo¡sHi¡Üy
& Ob£rvedPo¡sHi¡Üy::
	$m”gedW™h
(cÚ¡ 
Ob£rvedPo¡sHi¡Üy
 &
Ùh”
) {

110 
¡d
::
li¡
<
Ob£rvedPo¡Side
>::
™”©Ü
 
™
 = 
ob£rvedPo¡s
.
	`begš
();

111 
¡d
::
li¡
<
Ob£rvedPo¡Side
>::
cÚ¡_™”©Ü
 
Ùh”_™
 = 
Ùh”
.
ob£rvedPo¡s
.
	`begš
();

113 
™
 !ğ
ob£rvedPo¡s
.
	`’d
(è&& 
Ùh”_™
 !ğ
Ùh”
.observedPosts.end()) {

114 ià(*
™
 =ğ
NONE
) {

115 *
™
 = *
Ùh”_™
;

118 ++
™
;

119 ++
Ùh”_™
;

122  *
this
;

123 
	}
}

125 
Ob£rvedPo¡sHi¡Üy
 
	gOb£rvedPo¡sHi¡Üy
::
	$ü—‹Symm‘ricHi¡Üy
() const {

126 
Ob£rvedPo¡sHi¡Üy
 
	`ÃwHi¡Üy
(
mšF¿meG­Po¡Ob£rv©iÚ
);

127 
ÃwHi¡Üy
.
ob£rvedPo¡s
 = observedPosts;

129 
¡d
::
li¡
<
Ob£rvedPo¡Side
>::
™”©Ü
 
™
 = 
ÃwHi¡Üy
.
ob£rvedPo¡s
.
	`begš
();

130 
™
 !ğ
ÃwHi¡Üy
.
ob£rvedPo¡s
.
	`’d
()) {

131 ià(*
™
 =ğ
OWN_POST_LEFT
) {

132 *
™
 = 
OPPONENT_POST_LEFT
;

133 } ià(*
™
 =ğ
OWN_POST_RIGHT
) {

134 *
™
 = 
OPPONENT_POST_RIGHT
;

135 } ià(*
™
 =ğ
OPPONENT_POST_LEFT
) {

136 *
™
 = 
OWN_POST_LEFT
;

137 } ià(*
™
 =ğ
OPPONENT_POST_RIGHT
) {

138 *
™
 = 
OWN_POST_RIGHT
;

140 *
™
 = 
NONE
;

142 ++
™
;

145  
ÃwHi¡Üy
;

146 
	}
}

148 
	gOb£rvedPo¡sHi¡Üy
::
	$´štHi¡Üy
() const {

149 
¡d
::
li¡
<
Ob£rvedPo¡Side
>::
cÚ¡_™”©Ü
 
™
 = 
ob£rvedPo¡s
.
	`begš
();

150 
¡d
::
cout
 << "history = ";

151 
™
 !ğ
ob£rvedPo¡s
.
	`’d
()) {

152 
¡d
::
cout
 << *
™
 << " ";

153 ++
™
;

155 
¡d
::
cout
 << std::
’dl
;

156 
	}
}

	@robot/perception/localisation/ObservedPostsHistory.hpp

8 #´agm¨
Úû


10 
	~"Po¡Ty³.hµ
"

11 
	~<li¡
>

30 şas 
	cOb£rvedPo¡sHi¡Üy
 {

31 
	mpublic
:

32 
Ob£rvedPo¡sHi¡Üy
(
mšF¿meG­Po¡Ob£rv©iÚ
);

37 
addOb£rvedPo¡
(cÚ¡ 
Po¡Ty³
 &
po¡Ty³
);

42 
addNoOb£rvedPo¡s
();

50 
boŞ
 
	$ÿnOb£rvePo¡Ty³
(cÚ¡ 
Po¡Ty³
 &
po¡Ty³
) const;

52 
boŞ
 
	$isSim¬To
(cÚ¡ 
Ob£rvedPo¡sHi¡Üy
 &
Ùh”
) const;

53 
Ob£rvedPo¡sHi¡Üy
& 
	`m”gedW™h
(cÚ¡ Ob£rvedPo¡sHi¡Üy &
Ùh”
);

55 
Ob£rvedPo¡sHi¡Üy
 
	$ü—‹Symm‘ricHi¡Üy
() const;

56 
	$´štHi¡Üy
() const;

58 
´iv©e
:

59 
	eOb£rvedPo¡Side
 {

60 
OWN_POST_LEFT
,

61 
OWN_POST_RIGHT
,

62 
OPPONENT_POST_LEFT
,

63 
OPPONENT_POST_RIGHT
,

64 
NONE
,

67 
mšF¿meG­Po¡Ob£rv©iÚ
;

68 
¡d
::
li¡
<
Ob£rvedPo¡Side
> 
ob£rvedPo¡s
;

69 
	}
};

	@robot/perception/localisation/PostType.hpp

8 #´agm¨
Úû


11 
	ePo¡Ty³
 {

12 
	mMY_LEFT
,

13 
	mMY_RIGHT
,

14 
	mOPPONENT_LEFT
,

15 
	mOPPONENT_RIGHT
,

	@robot/perception/localisation/SharedDistribution.cpp

8 
	~"Sh¬edDi¡ributiÚ.hµ
"

9 
	~"Loÿli§tiÚCÚ¡ªtsProvid”.hµ
"

10 
	~"uts/Logg”.hµ
"

12 cÚ¡ 
	gLoÿli§tiÚCÚ¡ªtsProvid”
& 
cÚ¡ªtsProvid”
(

13 
Loÿli§tiÚCÚ¡ªtsProvid”
::
š¡ªû
());

15 
	gSh¬edDi¡ributiÚ
::
	$Sh¬edDi¡ributiÚ
() :

16 
	`b®lS“nCouÁ
(0),

17 
	`äamesCouÁ
(0),

18 
	`haveVisiÚUpd©es
(
çl£
),

19 
	`sh¬edGaussŸn
(
Sim¶eGaussŸn
::
	`ü—‹Ba£lšeSh¬edGaussŸn
()),

20 
	`sh¬edDx
(0.0),

21 
	`sh¬edDy
(0.0),

22 
	`sh¬edDh
(0.0),

23 
	`sh¬edCov¬ŸnûDx
(0.0),

24 
	`sh¬edCov¬ŸnûDy
(0.0),

25 
	$sh¬edCov¬ŸnûDh
(0.0è{
	}
}

27 
	gSh¬edDi¡ributiÚ
::~
	$Sh¬edDi¡ributiÚ
() {

28 
d–‘e
 
sh¬edGaussŸn
;

29 
	}
}

31 
	gSh¬edDi¡ributiÚ
::
	$´oûssUpd©e
(

32 cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
, cÚ¡ 
boŞ
 
ÿnS“B®l
) {

33 
Odom‘ryUpd©eResuÉ
 
odom‘ryResuÉ
 = 
sh¬edGaussŸn
->
	`´oûssUpd©e
(
odom‘ry
, 
dTimeSecÚds
, 
ÿnS“B®l
);

35 
sh¬edDx
 +ğ
odom‘ryResuÉ
.
dx
;

36 
sh¬edDy
 +ğ
odom‘ryResuÉ
.
dy
;

37 
sh¬edDh
 +ğ
odom‘ryResuÉ
.
dh
;

39 
sh¬edCov¬ŸnûDx
 +ğ
odom‘ryResuÉ
.
covDx
;

40 
sh¬edCov¬ŸnûDy
 +ğ
odom‘ryResuÉ
.
covDy
;

41 
sh¬edCov¬ŸnûDh
 +ğ
odom‘ryResuÉ
.
covDh
;

42 
	}
}

44 
	gSh¬edDi¡ributiÚ
::
	$visiÚUpd©e
(cÚ¡ 
StÜedICPUpd©e
 &
iıUpd©e
, cÚ¡ 
UniMod®VisiÚUpd©e
 &
vu
) {

45 
äamesCouÁ
++;

46 ià(
vu
.
visiÚBundË
.
visibËB®ls
.
	`size
() > 0) {

47 
b®lS“nCouÁ
++;

50 
sh¬edGaussŸn
->
	`­¶yOb£rv©iÚ
(
iıUpd©e
.
upd©eDim’siÚ
, iıUpd©e.
šnov©iÚ
, iıUpd©e.
jacobŸn
,

51 
iıUpd©e
.
ob£rv©iÚV¬Ÿnû
, 
çl£
);

52 
obsDim
 = 
sh¬edGaussŸn
->
	`uniMod®VisiÚUpd©e
(
vu
);

54 ià(
obsDim
 > 0 || 
iıUpd©e
.
upd©eDim’siÚ
 > 0) {

55 
haveVisiÚUpd©es
 = 
Œue
;

57 
	}
}

59 
Sh¬edLoÿli§tiÚUpd©eBundË
 
	gSh¬edDi¡ributiÚ
::
	$g‘Brßdÿ¡D©a
() {

60 
b®lS“nF¿ùiÚ
 = 0.0;

61 ià(
äamesCouÁ
 > 0) {

62 
b®lS“nF¿ùiÚ
 = (è
b®lS“nCouÁ
 / (è
äamesCouÁ
;

65 
Sh¬edLoÿli§tiÚUpd©eBundË
 
toS’d
 = 
	`Sh¬edLoÿli§tiÚUpd©eBundË
(

66 
b®lS“nF¿ùiÚ
,

67 
sh¬edGaussŸn
->
	`g‘M—n
(),

68 
sh¬edGaussŸn
->
	`g‘Cov¬Ÿnû
(),

69 
haveVisiÚUpd©es
,

70 
b®lS“nCouÁ
 > 0,

71 
sh¬edDx
,

72 
sh¬edDy
,

73 
sh¬edDh
,

74 
sh¬edCov¬ŸnûDx
,

75 
sh¬edCov¬ŸnûDy
,

76 
sh¬edCov¬ŸnûDh
);

78  
toS’d
;

79 
	}
}

81 
	gSh¬edDi¡ributiÚ
::
	$»£t
(cÚ¡ 
Sim¶eGaussŸn
 *
tİDi¡ributiÚ
) {

82 
sh¬edGaussŸn
->
	`»£tM—n
(
tİDi¡ributiÚ
->
	`g‘M—n
());

84 
cov¬ŸnûSÿËFaùÜ
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

85 
Loÿli§tiÚCÚ¡ªtsProvid”
::
SHARED_GAUSSIAN_RESET_UNCERTAINTY_FACTOR
);

86 
sh¬edGaussŸn
->
	`»£tCov¬Ÿnû
(
tİDi¡ributiÚ
->
	`g‘Cov¬Ÿnû
(è* 
cov¬ŸnûSÿËFaùÜ
);

88 
sh¬edDx
 = 0.0;

89 
sh¬edDy
 = 0.0;

90 
sh¬edDh
 = 0.0;

92 
sh¬edCov¬ŸnûDx
 = 0.0;

93 
sh¬edCov¬ŸnûDy
 = 0.0;

94 
sh¬edCov¬ŸnûDh
 = 0.0;

96 
haveVisiÚUpd©es
 = 
çl£
;

98 
b®lS“nCouÁ
 = 0;

99 
äamesCouÁ
 = 0;

100 
	}
}

102 
	gSh¬edDi¡ributiÚ
::
	$£tR—dyMode
(
boŞ
 
’abËd
) {

103 
sh¬edGaussŸn
->
	`£tR—dyMode
(
’abËd
);

104 
	}
}

	@robot/perception/localisation/SharedDistribution.hpp

31 #´agm¨
Úû


33 
	~"ty³s/Odom‘ry.hµ
"

34 
	~"ty³s/B®lInfo.hµ
"

35 
	~"Sim¶eGaussŸn.hµ
"

36 
	~"Sh¬edLoÿli§tiÚUpd©eBundË.hµ
"

49 şas 
	cSh¬edDi¡ributiÚ
 {

50 
	mpublic
:

51 
Sh¬edDi¡ributiÚ
();

52 
	mvœtu®
 ~
Sh¬edDi¡ributiÚ
();

54 
´oûssUpd©e
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
, cÚ¡ 
boŞ
 
ÿnS“B®l
);

56 
visiÚUpd©e
(cÚ¡ 
StÜedICPUpd©e
 &
iıUpd©e
, cÚ¡ 
UniMod®VisiÚUpd©e
 &
vu
);

61 
Sh¬edLoÿli§tiÚUpd©eBundË
 
g‘Brßdÿ¡D©a
();

68 
»£t
(cÚ¡ 
Sim¶eGaussŸn
 *
tİDi¡ributiÚ
);

69 
£tR—dyMode
(
boŞ
 
’abËd
);

71 
	m´iv©e
:

72 
b®lS“nCouÁ
;

73 
	mäamesCouÁ
;

75 
boŞ
 
	mhaveVisiÚUpd©es
;

76 
Sim¶eGaussŸn
 *
	msh¬edGaussŸn
;

78 
	msh¬edDx
;

79 
	msh¬edDy
;

80 
	msh¬edDh
;

82 
	msh¬edCov¬ŸnûDx
;

83 
	msh¬edCov¬ŸnûDy
;

84 
	msh¬edCov¬ŸnûDh
;

	@robot/perception/localisation/SharedLocalisationUpdateBundle.hpp

8 #´agm¨
Úû


10 
	~"Loÿli§tiÚUts.hµ
"

11 
	~"Loÿli§tiÚDefs.hµ
"

12 
	~"ty³s/boo¡S”Ÿliz©iÚEig’Ty³s.hµ
"

13 
	~<Eig’/Eig’
>

14 
	~<veùÜ
>

16 
	#MAX_SHARED_BALLS
 1

	)

18 
	sSh¬edLoÿli§tiÚUpd©eBundË
 {

19 
Sh¬edLoÿli§tiÚUpd©eBundË
() :

20 
b®lS“nF¿ùiÚ
(0.0),

21 
isUpd©eV®id
(
çl£
),

22 
sh¬edUpd©eM—n
(),

23 
sh¬edUpd©eCov¬Ÿnû
(),

24 
haveVisiÚUpd©es
(
çl£
),

25 
haveB®lUpd©es
(
çl£
),

26 
sh¬edDx
(0.0f),

27 
sh¬edDy
(0.0f),

28 
sh¬edDh
(0.0f),

29 
sh¬edCov¬ŸnûDx
(0.0f),

30 
sh¬edCov¬ŸnûDy
(0.0f),

31 
sh¬edCov¬ŸnûDh
(0.0f) {}

33 
Sh¬edLoÿli§tiÚUpd©eBundË
(

34 cÚ¡ 
b®lS“nF¿ùiÚ
,

35 cÚ¡ 
Eig’
::
M©rixXd
 &
sh¬edUpd©eM—nIn
,

36 cÚ¡ 
Eig’
::
M©rixXd
 &
sh¬edUpd©eCov¬ŸnûIn
,

37 cÚ¡ 
boŞ
 
haveVisiÚUpd©es
,

38 cÚ¡ 
boŞ
 
haveB®lUpd©es
,

39 cÚ¡ 
sh¬edDx
,

40 cÚ¡ 
sh¬edDy
,

41 cÚ¡ 
sh¬edDh
,

42 cÚ¡ 
sh¬edCov¬ŸnûDx
,

43 cÚ¡ 
sh¬edCov¬ŸnûDy
,

44 cÚ¡ 
sh¬edCov¬ŸnûDh
) :

45 
b®lS“nF¿ùiÚ
(ballSeenFraction),

46 
isUpd©eV®id
(
Œue
),

47 
haveVisiÚUpd©es
(haveVisionUpdates),

48 
haveB®lUpd©es
(haveBallUpdates),

49 
sh¬edDx
(sharedDx),

50 
sh¬edDy
(sharedDy),

51 
sh¬edDh
(sharedDh),

52 
sh¬edCov¬ŸnûDx
(sharedCovarianceDx),

53 
sh¬edCov¬ŸnûDy
(sharedCovarianceDy),

54 
sh¬edCov¬ŸnûDh
(sharedCovarianceDh) {

56 
	mi
 = 0; i < 
	mSHARED_DIM
; i++) {

57 
	mthis
->
sh¬edUpd©eM—n
(
i
, 0èğ
sh¬edUpd©eM—nIn
(i, 0);

60 
	mrow
 = 0;„ow < 
	mSHARED_DIM
;„ow++) {

61 
	mcŞ
 = 0; cŞ < 
	mSHARED_DIM
; col++) {

62 
	mthis
->
sh¬edUpd©eCov¬Ÿnû
(
row
, 
cŞ
èğ
sh¬edUpd©eCov¬ŸnûIn
(row, col);

67 
	mb®lS“nF¿ùiÚ
;

68 
boŞ
 
	misUpd©eV®id
;

70 
	mEig’
::
M©rix
<, 
	mSHARED_DIM
, 1> 
	msh¬edUpd©eM—n
;

71 
	mEig’
::
M©rix
<, 
	mSHARED_DIM
, SHARED_DIM> 
	msh¬edUpd©eCov¬Ÿnû
;

72 
boŞ
 
	mhaveVisiÚUpd©es
;

73 
boŞ
 
	mhaveB®lUpd©es
;

75 
	msh¬edDx
;

76 
	msh¬edDy
;

77 
	msh¬edDh
;

79 
	msh¬edCov¬ŸnûDx
;

80 
	msh¬edCov¬ŸnûDy
;

81 
	msh¬edCov¬ŸnûDh
;

83 
ouut
() const {

84 
	m¡d
::
cout
 << "dx,dy,dz: " << 
sh¬edDx
 << " " << 
sh¬edDy
 << " " << 
sh¬edDh
 << 
¡d
::
’dl
;

85 
	m¡d
::
cout
 << "cdx,cdy,cdz: " << 
sh¬edCov¬ŸnûDx
 << " " << 
sh¬edCov¬ŸnûDy
 << " "

86 << 
sh¬edCov¬ŸnûDh
 << 
¡d
::
’dl
;

88 
´‘tyOuutM©rix
("sh¬edUpd©eM—n", 
cİySticToDyÇmicM©rix
<
SHARED_DIM
, 1>(
sh¬edUpd©eM—n
));

89 
´‘tyOuutM©rix
("sh¬edUpd©eCov¬Ÿnû", 
cİySticToDyÇmicM©rix
<
SHARED_DIM
, SHARED_DIM>(
sh¬edUpd©eCov¬Ÿnû
));

92 
	m‹m¶©e
<
şass
 
	mArchive
>

93 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

94 
	m¬
 & 
	mb®lS“nF¿ùiÚ
;

95 
	m¬
 & 
	misUpd©eV®id
;

96 
	m¬
 & 
	msh¬edUpd©eM—n
;

97 
	m¬
 & 
	msh¬edUpd©eCov¬Ÿnû
;

98 
	m¬
 & 
	mhaveVisiÚUpd©es
;

99 
	m¬
 & 
	mhaveB®lUpd©es
;

100 
	m¬
 & 
	msh¬edDx
;

101 
	m¬
 & 
	msh¬edDy
;

102 
	m¬
 & 
	msh¬edDh
;

103 
	m¬
 & 
	msh¬edCov¬ŸnûDx
;

104 
	m¬
 & 
	msh¬edCov¬ŸnûDy
;

105 
	m¬
 & 
	msh¬edCov¬ŸnûDh
;

109 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gSh¬edLoÿli§tiÚUpd©eBundË
& 
	gbundË
) {

110 
	gos
 << (è
	gbundË
.
	gisUpd©eV®id
 << 
	g¡d
::
’dl
;

112 
	gi
 = 0; i < 
	gSHARED_DIM
; i++) {

113 
	gos
 << 
	gbundË
.
sh¬edUpd©eM—n
(
i
, 0è<< 
	g¡d
::
’dl
;

116 
	gi
 = 0; i < 
	gSHARED_DIM
; i++) {

117 
	gj
 = 0; j < 
	gSHARED_DIM
; j++) {

118 
	gos
 << 
	gbundË
.
sh¬edUpd©eCov¬Ÿnû
(
i
, 
j
è<< 
	g¡d
::
’dl
;

122 
	gos
 << 
	gbundË
.
	gsh¬edDx
 << 
	g¡d
::
’dl
;

123 
	gos
 << 
	gbundË
.
	gsh¬edDy
 << 
	g¡d
::
’dl
;

124 
	gos
 << 
	gbundË
.
	gsh¬edDh
 << 
	g¡d
::
’dl
;

126 
	gos
 << 
	gbundË
.
	gsh¬edCov¬ŸnûDx
 << 
	g¡d
::
’dl
;

127 
	gos
 << 
	gbundË
.
	gsh¬edCov¬ŸnûDy
 << 
	g¡d
::
’dl
;

128 
	gos
 << 
	gbundË
.
	gsh¬edCov¬ŸnûDh
 << 
	g¡d
::
’dl
;

130  
	gos
;

133 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gSh¬edLoÿli§tiÚUpd©eBundË
& 
	gbundË
) {

134 
	gisUpd©eV®id
;

135 
	gis
 >> 
	gisUpd©eV®id
;

136 
	gbundË
.
	gisUpd©eV®id
 = (
boŞ
è
isUpd©eV®id
;

138 
	gi
 = 0; i < 
	gSHARED_DIM
; i++) {

139 
	gis
 >> 
	gbundË
.
sh¬edUpd©eM—n
(
i
, 0);

142 
	gi
 = 0; i < 
	gSHARED_DIM
; i++) {

143 
	gj
 = 0; j < 
	gSHARED_DIM
; j++) {

144 
	gis
 >> 
	gbundË
.
sh¬edUpd©eCov¬Ÿnû
(
i
, 
j
);

148 
	gis
 >> 
	gbundË
.
	gsh¬edDx
;

149 
	gis
 >> 
	gbundË
.
	gsh¬edDy
;

150 
	gis
 >> 
	gbundË
.
	gsh¬edDh
;

152 
	gis
 >> 
	gbundË
.
	gsh¬edCov¬ŸnûDx
;

153 
	gis
 >> 
	gbundË
.
	gsh¬edCov¬ŸnûDy
;

154 
	gis
 >> 
	gbundË
.
	gsh¬edCov¬ŸnûDh
;

156  
	gis
;

	@robot/perception/localisation/SimpleGaussian.cpp

2 
	~"Sim¶eGaussŸn.hµ
"

4 
	~"Eig’/Geom‘ry
"

5 
	~"Eig’/LU
"

7 
	~"Loÿli§tiÚCÚ¡ªtsProvid”.hµ
"

8 
	~"Loÿli§tiÚUts.hµ
"

9 
	~"Loÿli§tiÚDefs.hµ
"

10 
	~"Sh¬edLoÿli§tiÚUpd©eBundË.hµ
"

11 
	~"V¬ŸnûProvid”.hµ
"

12 
	~"uts/basic_m©hs.hµ
"

13 
	~"uts/Logg”.hµ
"

14 
	~"uts/SPLDefs.hµ
"

15 
	~"uts/ªgËs.hµ
"

17 
	~<cm©h
>

18 
	~<iomª
>

19 
	~<ios
>

20 
	~<c¡dio
>

22 
usšg
 
Çme¥aû
 
	gEig’
;

25 cÚ¡ 
	gEPSILON
 = 0.0001;

26 cÚ¡ 
	gMAX_BALL_VELOCITY
 = 1000.0;

30 cÚ¡ 
	gMAX_MEASUREMENT_DIM
 = 13;

32 cÚ¡ 
	gLoÿli§tiÚCÚ¡ªtsProvid”
& 
cÚ¡ªtsProvid”
(

33 
Loÿli§tiÚCÚ¡ªtsProvid”
::
š¡ªû
());

36 cÚ¡ 
	gROBOT_X_DIM
 = 0;

37 cÚ¡ 
	gROBOT_Y_DIM
 = 1;

38 cÚ¡ 
	gROBOT_H_DIM
 = 2;

40 cÚ¡ 
	gBALL_X_DIM
 = 3;

41 cÚ¡ 
	gBALL_Y_DIM
 = 4;

42 cÚ¡ 
	gBALL_DX_DIM
 = 5;

43 cÚ¡ 
	gBALL_DY_DIM
 = 6;

45 cÚ¡ 
	gTEAM_INDEX_OFFSET
 = 7;

46 cÚ¡ 
	gNUM_TEAMMATES
 = 4;

48 
	$com¶exMagn™ude
(
»®
, 
imagš¬y
) {

49  
	`sq¹
(
»®
*»® + 
imagš¬y
*imaginary);

50 
	}
}

52 
M©rixXd
 
	$g‘Re£tDŸgÚ®V¬Ÿnû
(cÚ¡ 
dim
) {

53 
M©rixXd
 
	`dŸgÚ®V¬Ÿnû
(
dim
, 1);

54 ià(
dim
 =ğ
MAIN_DIM
) {

55 
dŸgÚ®V¬Ÿnû
 << 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

56 
	`g‘95CF
(10.0*
FULL_FIELD_LENGTH
), g‘95CF(10.0*
FULL_FIELD_WIDTH
),

57 
	`g‘95CF
(10000.0), get95CF(10000.0),

59 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

60 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

61 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

62 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
);

63 } ià(
dim
 =ğ
SHARED_DIM
) {

64 
dŸgÚ®V¬Ÿnû
 << 
	`g‘95CF
(
FULL_FIELD_LENGTH
), g‘95CF(
FULL_FIELD_WIDTH
), g‘95CF(
M_PI
),

65 
	`g‘95CF
(10.0*
FULL_FIELD_LENGTH
), g‘95CF(10.0*
FULL_FIELD_WIDTH
),

66 
	`g‘95CF
(10000.0), get95CF(10000.0);

68 
	`MY_ASSERT
(
çl£
, "Invalid„eset dimension");

70  
dŸgÚ®V¬Ÿnû
;

71 
	}
}

73 
	$g‘T—mm©eIndex
(cÚ¡ 
‹amm©eIndex
, cÚ¡ 
po£Dim
) {

74 
	`MY_ASSERT
(
‹amm©eIndex
 >= 0 &&eammateIndex <= 3, "unexpectedeammate index");

75 
	`MY_ASSERT
(
po£Dim
 >ğ
ROBOT_X_DIM
 &&…o£Dim <ğ
ROBOT_H_DIM
, "invalid…oseDim");

76  
TEAM_INDEX_OFFSET
 + 
‹amm©eIndex
*3 + 
po£Dim
;

77 
	}
}

80 
	gUniMod®VisiÚUpd©e
::
	$UniMod®VisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
):

81 
	`visiÚBundË
(
visiÚBundË
),

82 
	`po¡Ty³s
(
¡d
::
veùÜ
<
Po¡Ty³
>()è{
	}
}

84 
UniMod®VisiÚUpd©e
::
	$UniMod®VisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

85 cÚ¡ 
Po¡Ty³
 &
po¡Ty³
) :

86 
	$visiÚBundË
(
visiÚBundË
) {

87 
this
->
po¡Ty³s
.
	`push_back
(
po¡Ty³
);

88 
	}
}

90 
	gUniMod®VisiÚUpd©e
::
UniMod®VisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

91 cÚ¡ 
¡d
::
veùÜ
<
Po¡Ty³
> &
po¡Ty³s
) :

92 
visiÚBundË
(visionBundle),

93 
	$po¡Ty³s
(
po¡Ty³s
è{
	}
}

95 
	gUniMod®T—mm©eUpd©e
::
UniMod®T—mm©eUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

96 cÚ¡ 
¡d
::
veùÜ
<
RobÙInfo
> &
‹amm©eRobÙs
, cÚ¡ 
AbsCoÜd
 &
‹amm©ePos™iÚ
) :

97 
visiÚBundË
(visiÚBundË), 
	$‹amm©eRobÙs
(
‹amm©eRobÙs
) {

98 
this
->
‹amm©ePos™iÚs
.
	`push_back
(
‹amm©ePos™iÚ
);

99 
	}
}

101 
	gUniMod®T—mm©eUpd©e
::
UniMod®T—mm©eUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

102 cÚ¡ 
¡d
::
veùÜ
<
RobÙInfo
> &
‹amm©eRobÙs
, cÚ¡ std::veùÜ<
AbsCoÜd
> &
‹amm©ePos™iÚs
) :

103 
visiÚBundË
(visiÚBundË), 
‹amm©eRobÙs
Ñ—mm©eRobÙs), 
	$‹amm©ePos™iÚs
(
‹amm©ePos™iÚs
è{
	}
}

106 
	g¡d
::
veùÜ
<
Sim¶eGaussŸn
*> Sim¶eGaussŸn::
	$ü—‹Ba£lšeGaussŸns
() {

107 
M©rixXd
 
	`m—n
(
MAIN_DIM
, 1);

111 
m—n
 << 0.0, 0.0, 
M_PI
/2.0,

119 
ba£lšeWeight
 = 0.0;

123 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
»suÉ
;

124 
»suÉ
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 
ba£lšeWeight
, 
m—n
, 
	`g‘Re£tDŸgÚ®V¬Ÿnû
(MAIN_DIM)));

126 
	`m—n
(
ROBOT_H_DIM
, 0èğ-
M_PI
/2.0;

127 
»suÉ
.
	`push_back
(
Ãw
 
	`Sim¶eGaussŸn
(
MAIN_DIM
, 
ba£lšeWeight
, 
m—n
, 
	`g‘Re£tDŸgÚ®V¬Ÿnû
(MAIN_DIM)));

129  
»suÉ
;

130 
	}
}

132 
Sim¶eGaussŸn
* 
	gSim¶eGaussŸn
::
	$ü—‹Ba£lšeSh¬edGaussŸn
() {

133 
M©rixXd
 
	`m—n
(
SHARED_DIM
, 1);

136 
m—n
 << 0.0, 0.0, 
M_PI
/2.0,

140  
Ãw
 
	`Sim¶eGaussŸn
(
SHARED_DIM
, 1.0, 
m—n
, 
	`g‘Re£tDŸgÚ®V¬Ÿnû
(SHARED_DIM));

141 
	}
}

143 
	gSim¶eGaussŸn
::
	$§n™yCheck
() const {

144 ià(
LOCALISATION_DEBUG
 && !
	`isS‹V®id
()) {

145 
¡d
::
cout
 << "SANITY CHECK FAILED" << std::
’dl
;

147 
	}
}

149 
	gSim¶eGaussŸn
::
	$Sim¶eGaussŸn
(

150 cÚ¡ 
dim
,

151 cÚ¡ 
weight
,

152 cÚ¡ 
Eig’
::
M©rixXd
 &
m—n
,

153 cÚ¡ 
Eig’
::
M©rixXd
 &
dŸgÚ®V¬Ÿnû
) :

154 
	`DIM
(
dim
),

155 
	`id’t™y
(
M©rixXd
::
	`Id’t™y
(
dim
, dim)),

156 
	`weight
(
weight
),

157 
	`m—n
(
m—n
),

158 
	`cov¬Ÿnû
(
M©rixXd
::
	`Id’t™y
(
dim
, dim)),

159 
	`došgB®lLšeUp
(
çl£
),

160 
	`isInR—dyMode
(
çl£
),

161 
	`haveLa¡VisiÚUpd©e
(
çl£
),

162 
	$ob£rvedPo¡sHi¡Üy
(5) {

164 
cov¬Ÿnû
.
	`£tZ”o
();

165 
i
 = 0; i < 
dim
; i++) {

166 
	`cov¬Ÿnû
(
i
, ièğ
	`dŸgÚ®V¬Ÿnû
(i, 0);

168 
	}
}

170 
	gSim¶eGaussŸn
::
	$Sim¶eGaussŸn
(

171 cÚ¡ 
dim
,

172 cÚ¡ 
weight
,

173 cÚ¡ 
Eig’
::
M©rixXd
 &
m—n
,

174 cÚ¡ 
Eig’
::
M©rixXd
 &
cov¬Ÿnû
,

175 
boŞ
 
došgB®lLšeUp
,

176 
boŞ
 
isInR—dyMode
,

177 cÚ¡ 
Ob£rvedPo¡sHi¡Üy
 &
ob£rvedPo¡sHi¡Üy
) :

178 
	`DIM
(
dim
),

179 
	`id’t™y
(
M©rixXd
::
	`Id’t™y
(
dim
, dim)),

180 
	`weight
(
weight
),

181 
	`m—n
(
m—n
),

182 
	`cov¬Ÿnû
(
cov¬Ÿnû
),

183 
	`došgB®lLšeUp
(
došgB®lLšeUp
),

184 
	`isInR—dyMode
(
isInR—dyMode
),

185 
	`haveLa¡VisiÚUpd©e
(
Œue
),

186 
	$ob£rvedPo¡sHi¡Üy
(
ob£rvedPo¡sHi¡Üy
è{
	}
}

188 
	gSim¶eGaussŸn
::
	$»£tM—n
(cÚ¡ 
Eig’
::
M©rixXd
 &
¤c
) {

189 
	`MY_ASSERT
(()
¤c
.
	`rows
(è>ğ
DIM
, "resetMean() called with incompatible src");

190 
i
 = 0; i < 
DIM
; i++) {

191 
	`m—n
(
i
, 0èğ
	`¤c
(i, 0);

193 
	}
}

195 
	gSim¶eGaussŸn
::
	$»£tCov¬Ÿnû
(cÚ¡ 
Eig’
::
M©rixXd
 &
¤c
) {

196 
	`MY_ASSERT
(()
¤c
.
	`rows
(è>ğ
DIM
 && ()¤c.
	`cŞs
() >= DIM, "resetCovariance() called with incompatible src");

197 
i
 = 0; i < 
DIM
; i++) {

198 
j
 = 0; j < 
DIM
; j++) {

199 
	`cov¬Ÿnû
(
i
, 
j
èğ
	`¤c
(i, j);

202 
	}
}

204 
	gSim¶eGaussŸn
::
	$£tLšeUpMode
(
boŞ
 
’abËd
) {

205 
došgB®lLšeUp
 = 
’abËd
;

206 
	}
}

208 
	gSim¶eGaussŸn
::
	$£tR—dyMode
(
boŞ
 
’abËd
) {

209 
isInR—dyMode
 = 
’abËd
;

210 
	}
}

212 
Odom‘ryUpd©eResuÉ
 
	gSim¶eGaussŸn
::
	$´oûssUpd©e
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

213 cÚ¡ 
boŞ
 
ÿnS“B®l
) {

214 
Odom‘ryUpd©eResuÉ
 
odom‘ryUpd©eResuÉ
;

216 
	`upd©eM—nVeùÜW™hOdom‘ry
(
odom‘ry
, 
dTimeSecÚds
, 
odom‘ryUpd©eResuÉ
);

217 
	`upd©eCov¬ŸnûW™hOdom‘ry
(
odom‘ry
, 
dTimeSecÚds
, 
ÿnS“B®l
, 
odom‘ryUpd©eResuÉ
);

219 
	`şToF›ld
(
m—n
);

220 
	`şB®lOutOfRobÙ
(
m—n
);

222  
odom‘ryUpd©eResuÉ
;

223 
	}
}

225 
	g¡d
::
veùÜ
<
Sim¶eGaussŸn
*> Sim¶eGaussŸn::
	$visiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
) {

226 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ÃwModes
;

228 ià(
visiÚBundË
.
po¡s
.
	`size
() == 0) {

229 
	`addNoPo¡sOb£rv©iÚMode
(
visiÚBundË
, 
ÃwModes
);

230 } ià(
visiÚBundË
.
po¡s
.
	`size
() == 1) {

231 
	`addOÃPo¡Ob£rv©iÚModes
(
visiÚBundË
, 
ÃwModes
);

232 } ià(
visiÚBundË
.
po¡s
.
	`size
() == 2) {

233 
	`addTwoPo¡Ob£rv©iÚModes
(
visiÚBundË
, 
ÃwModes
);

236 
this
->
weight
 *ğ
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

237 
Loÿli§tiÚCÚ¡ªtsProvid”
::
INVALID_OBSERVATION_PROBABILITY
);

238 
ob£rvedPo¡sHi¡Üy
.
	`addNoOb£rvedPo¡s
();

240 
haveLa¡VisiÚUpd©e
 = 
çl£
;

242  
ÃwModes
;

243 
	}
}

245 
	g¡d
::
veùÜ
<
Sim¶eGaussŸn
*> Sim¶eGaussŸn::
	$visiÚT—mm©eRobÙsUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
) {

246 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ÃwModes
;

248 
¡d
::
veùÜ
<
RobÙInfo
> 
‹amm©eRobÙs
;

249 
i
 = 0; i < 
visiÚBundË
.
robÙs
.
	`size
(); i++) {

250 ià((
visiÚBundË
.
amIOnRedT—m
 && visiÚBundË.
robÙs
[
i
].
ty³
 =ğ
RobÙInfo
::
rRed
) ||

251 (!
visiÚBundË
.
amIOnRedT—m
 && visiÚBundË.
robÙs
[
i
].
ty³
 =ğ
RobÙInfo
::
rBlue
)) {

252 
‹amm©eRobÙs
.
	`push_back
(
visiÚBundË
.
robÙs
[
i
]);

257 ià(
‹amm©eRobÙs
.
	`size
() > 0 &&eammateRobots.size() <= 2) {

258 ià(
‹amm©eRobÙs
.
	`size
() == 1) {

259 
i
 = 0; i < 
visiÚBundË
.
‹amm©ePos™iÚs
.
	`size
(); i++) {

260 
UniMod®T—mm©eUpd©e
 
	`‹amm©eUpd©e
(
visiÚBundË
, 
‹amm©eRobÙs
, visiÚBundË.
‹amm©ePos™iÚs
[
i
]);

261 
Sim¶eGaussŸn
 *
¥l™GaussŸn
 = 
	`ü—‹S¶™GaussŸn
();

262 
¥l™GaussŸn
->
	`uniMod®T—mm©eRobÙVisiÚUpd©e
(
‹amm©eUpd©e
);

263 
ÃwModes
.
	`push_back
(
¥l™GaussŸn
);

265 } ià(
‹amm©eRobÙs
.
	`size
() == 2) {

266 
i
 = 0; i < 
visiÚBundË
.
‹amm©ePos™iÚs
.
	`size
(); i++) {

267 
j
 = 0; j < 
visiÚBundË
.
‹amm©ePos™iÚs
.
	`size
(); j++) {

268 ià(
i
 =ğ
j
) {

272 
¡d
::
veùÜ
<
AbsCoÜd
> 
cho£nPos™iÚs
;

273 
cho£nPos™iÚs
.
	`push_back
(
visiÚBundË
.
‹amm©ePos™iÚs
[
i
]);

274 
cho£nPos™iÚs
.
	`push_back
(
visiÚBundË
.
‹amm©ePos™iÚs
[
j
]);

276 
UniMod®T—mm©eUpd©e
 
	`‹amm©eUpd©e
(
visiÚBundË
, 
‹amm©eRobÙs
, 
cho£nPos™iÚs
);

277 
Sim¶eGaussŸn
 *
¥l™GaussŸn
 = 
	`ü—‹S¶™GaussŸn
();

278 
¥l™GaussŸn
->
	`uniMod®T—mm©eRobÙVisiÚUpd©e
(
‹amm©eUpd©e
);

279 
ÃwModes
.
	`push_back
(
¥l™GaussŸn
);

284 
this
->
weight
 *ğ
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

285 
Loÿli§tiÚCÚ¡ªtsProvid”
::
INVALID_TEAMMATE_ROBOT_OBSERVATION_PROBABILITY
);

288  
ÃwModes
;

289 
	}
}

291 
	gSim¶eGaussŸn
::
	$uniMod®VisiÚUpd©e
(cÚ¡ 
UniMod®VisiÚUpd©e
 &
vu
) {

292 
Eig’
::
M©rixXd
 
	`šnov©iÚ
(
MAX_MEASUREMENT_DIM
, 1);

293 
Eig’
::
M©rixXd
 
	`jacobŸn
(
MAX_MEASUREMENT_DIM
, 
DIM
);

294 
Eig’
::
M©rixXd
 
	`ob£rv©iÚV¬Ÿnû
(
MAX_MEASUREMENT_DIM
, MAX_MEASUREMENT_DIM);

295 
šnov©iÚ
.
	`£tZ”o
();

296 
jacobŸn
.
	`£tZ”o
();

297 
ob£rv©iÚV¬Ÿnû
.
	`£tZ”o
();

299 
cu¼’tDim’siÚ
 = 0;

300 
uÄ–ŸbËDi¡ªûCutoff
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

301 
Loÿli§tiÚCÚ¡ªtsProvid”
::
UNRELIABLE_DISTANCE_CUTOFF_FACTOR
);

303 ià(
vu
.
po¡Ty³s
.
	`size
() == 0) {

304 
ob£rvedPo¡sHi¡Üy
.
	`addNoOb£rvedPo¡s
();

306 
ob£rvedPo¡sHi¡Üy
.
	`addOb£rvedPo¡
(
vu
.
po¡Ty³s
[0]);

309 
	`MY_ASSERT
(
vu
.
po¡Ty³s
.
	`size
(è<ğvu.
visiÚBundË
.
po¡s
.size(), "postypes morehan visible…osts");

310 
i
 = 0; i < 
vu
.
po¡Ty³s
.
	`size
(); i++) {

311 
AbsCoÜd
 
po¡Pos™iÚ
 = 
	`g‘GßÍo¡Pos™iÚ
(
vu
.
po¡Ty³s
[
i
]);

312 
maxDi¡ªû
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

313 
Loÿli§tiÚCÚ¡ªtsProvid”
::
GOALPOST_MAX_DISTANCE_OBSERVATION
);

314 ià(!
vu
.
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

315 
maxDi¡ªû
 *ğ
uÄ–ŸbËDi¡ªûCutoff
;

322 
boŞ
 
u£Di¡ªû
 = 
vu
.
visiÚBundË
.
po¡s
[
i
].
¼
.
	`di¡ªû
(è< 
maxDi¡ªû
 &&

323 
vu
.
visiÚBundË
.
po¡s
[
i
].
Œu¡Di¡ªû
;

325 
cu¼’tDim’siÚ
 = 
	`addGßlPo¡M—su»m’t
(

326 
vu
.
visiÚBundË
,

327 
vu
.
visiÚBundË
.
po¡s
[
i
].
¼
,

328 
po¡Pos™iÚ
,

329 
u£Di¡ªû
,

330 
šnov©iÚ
,

331 
jacobŸn
,

332 
ob£rv©iÚV¬Ÿnû
,

333 
cu¼’tDim’siÚ
);

336 
i
 = 0; i < 
vu
.
visiÚBundË
.
f›ldF—tu»s
.
	`size
(); i++) {

337 ià(
vu
.
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fC’ŒeCœşe
) {

338 
maxDi¡ªû
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

339 
Loÿli§tiÚCÚ¡ªtsProvid”
::
CENTRE_CIRCLE_MAX_DISTANCE_OBSERVATION
);

340 ià(!
vu
.
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

341 
maxDi¡ªû
 *ğ
uÄ–ŸbËDi¡ªûCutoff
;

344 
boŞ
 
u£Di¡ªû
 = 
vu
.
visiÚBundË
.
f›ldF—tu»s
[
i
].
¼
.
	`di¡ªû
(è< 
maxDi¡ªû
 &&

345 
vu
.
visiÚBundË
.
f›ldF—tu»s
[
i
].
¼
.
	`di¡ªû
() > 0.0;

346 
cu¼’tDim’siÚ
 = 
	`addF›ldF—tu»M—su»m’t
(

347 
vu
.
visiÚBundË
,

348 
	`AbsCoÜd
(0.0, 0.0, 0.0),

349 
vu
.
visiÚBundË
.
f›ldF—tu»s
[
i
].
¼
,

350 
u£Di¡ªû
,

351 
šnov©iÚ
,

352 
jacobŸn
,

353 
ob£rv©iÚV¬Ÿnû
,

354 
cu¼’tDim’siÚ
);

359 
i
 = 0; i < 
vu
.
visiÚBundË
.
f›ldF—tu»s
.
	`size
(); i++) {

360 ià(
vu
.
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fP’®tySpÙ
 &&

361 
vu
.
visiÚBundË
.
f›ldF—tu»s
[
i
].
¼
.
	`di¡ªû
() < 2000.0 &&

362 
	`ÿnOb£rveP’®tySpÙ
()) {

364 
cu¼’tDim’siÚ
 = 
	`addF›ldF—tu»M—su»m’t
(

365 
vu
.
visiÚBundË
,

366 
	`g‘P’®tySpÙPos™iÚ
(),

367 
vu
.
visiÚBundË
.
f›ldF—tu»s
[
i
].
¼
,

368 
Œue
,

369 
šnov©iÚ
,

370 
jacobŸn
,

371 
ob£rv©iÚV¬Ÿnû
,

372 
cu¼’tDim’siÚ
);

379 ià(
vu
.
visiÚBundË
.
visibËB®ls
.
	`size
(è=ğ1 && !
isInR—dyMode
) {

380 
maxDi¡ªû
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

381 
Loÿli§tiÚCÚ¡ªtsProvid”
::
BALL_MAX_DISTANCE_OBSERVATION
);

382 ià(!
vu
.
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

383 
maxDi¡ªû
 *ğ
uÄ–ŸbËDi¡ªûCutoff
;

386 
boŞ
 
u£Di¡ªû
 = 
vu
.
visiÚBundË
.
visibËB®ls
[0].
¼
.
	`di¡ªû
(è< 
maxDi¡ªû
 &&

387 
vu
.
visiÚBundË
.
visibËB®ls
[0].
¼
.
	`di¡ªû
() > 0.0;

388 
cu¼’tDim’siÚ
 = 
	`addB®lM—su»m’t
(

389 
vu
.
visiÚBundË
,

390 
vu
.
visiÚBundË
.
visibËB®ls
[0].
¼
,

391 
u£Di¡ªû
,

392 
šnov©iÚ
,

393 
jacobŸn
,

394 
ob£rv©iÚV¬Ÿnû
,

395 
cu¼’tDim’siÚ
);

398 
	`­¶yOb£rv©iÚ
(
cu¼’tDim’siÚ
, 
šnov©iÚ
, 
jacobŸn
, 
ob£rv©iÚV¬Ÿnû
, 
Œue
);

411 
haveLa¡VisiÚUpd©e
 = 
Œue
;

412 
Ï¡VisiÚUpd©e
 = 
vu
;

414  
cu¼’tDim’siÚ
;

415 
	}
}

417 
	gSim¶eGaussŸn
::
	$uniMod®T—mm©eRobÙVisiÚUpd©e
(cÚ¡ 
UniMod®T—mm©eUpd©e
 &
vu
) {

418 
Eig’
::
M©rixXd
 
	`šnov©iÚ
(
MAX_MEASUREMENT_DIM
, 1);

419 
Eig’
::
M©rixXd
 
	`jacobŸn
(
MAX_MEASUREMENT_DIM
, 
DIM
);

420 
Eig’
::
M©rixXd
 
	`ob£rv©iÚV¬Ÿnû
(
MAX_MEASUREMENT_DIM
, MAX_MEASUREMENT_DIM);

421 
šnov©iÚ
.
	`£tZ”o
();

422 
jacobŸn
.
	`£tZ”o
();

423 
ob£rv©iÚV¬Ÿnû
.
	`£tZ”o
();

425 
cu¼’tDim’siÚ
 = 0;

426 
uÄ–ŸbËDi¡ªûCutoff
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

427 
Loÿli§tiÚCÚ¡ªtsProvid”
::
UNRELIABLE_DISTANCE_CUTOFF_FACTOR
);

429 
maxDi¡ªû
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

430 
Loÿli§tiÚCÚ¡ªtsProvid”
::
TEAMMATE_ROBOT_MAX_DISTANCE_OBSERVATION
);

431 ià(!
vu
.
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

432 
maxDi¡ªû
 *ğ
uÄ–ŸbËDi¡ªûCutoff
;

435 
i
 = 0; i < 
vu
.
‹amm©eRobÙs
.
	`size
(); i++) {

436 
boŞ
 
u£Di¡ªû
 = 
vu
.
‹amm©eRobÙs
[
i
].
¼
.
	`di¡ªû
(è< 
maxDi¡ªû
;

437 
cu¼’tDim’siÚ
 = 
	`addT—mm©eM—su»m’t
(

438 
vu
.
visiÚBundË
,

439 
vu
.
‹amm©eRobÙs
[
i
].
¼
,

440 
vu
.
‹amm©ePos™iÚs
[
i
],

441 
u£Di¡ªû
,

442 
šnov©iÚ
,

443 
jacobŸn
,

444 
ob£rv©iÚV¬Ÿnû
,

445 
cu¼’tDim’siÚ
);

448 
	`­¶yOb£rv©iÚ
(
cu¼’tDim’siÚ
, 
šnov©iÚ
, 
jacobŸn
, 
ob£rv©iÚV¬Ÿnû
, 
Œue
);

449 
	}
}

451 
	gSim¶eGaussŸn
::
	$­¶yOb£rv©iÚ
(
obsDim’siÚ
, cÚ¡ 
Eig’
::
M©rixXd
 &
šnov©iÚ
,

452 cÚ¡ 
Eig’
::
M©rixXd
 &
jacobŸn
, cÚ¡ Eig’::M©rixXd &
ob£rv©iÚV¬Ÿnû
, cÚ¡ 
boŞ
 
upd©eWeight
) {

453 ià(
obsDim’siÚ
 > 0) {

454 
Eig’
::
M©rixXd
 
f™‹dJacobŸn
;

455 ià((è
jacobŸn
.
	`cŞs
(è< 
DIM
) {

456 
f™‹dJacobŸn
.
	`£tZ”o
(
jacobŸn
.
	`rows
(), 
DIM
);

457 
i
 = 0; i < 
jacobŸn
.
	`rows
(); i++) {

458 
j
 = 0; j < 
jacobŸn
.
	`cŞs
(); j++) {

459 
	`f™‹dJacobŸn
(
i
, 
j
èğ
	`jacobŸn
(i, j);

462 } ià((è
jacobŸn
.
	`cŞs
(è> 
DIM
) {

463 
f™‹dJacobŸn
 = 
jacobŸn
.
	`block
(0, 0, jacobŸn.
	`rows
(), 
DIM
);

465 
f™‹dJacobŸn
 = 
jacobŸn
;

468  
	`³rfÜmK®mªUpd©e
(
obsDim’siÚ
, 
šnov©iÚ
, 
f™‹dJacobŸn
, 
ob£rv©iÚV¬Ÿnû
, 
upd©eWeight
);

472 
	}
}

474 
	gSim¶eGaussŸn
::
	$doICPUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
, cÚ¡ 
boŞ
 
upd©eWeight
) {

475 
Eig’
::
M©rixXd
 
	`šnov©iÚ
(3, 1);

476 
Eig’
::
M©rixXd
 
	`jacobŸn
(3, 
DIM
);

477 
Eig’
::
M©rixXd
 
	`ob£rv©iÚV¬Ÿnû
(3, 3);

478 
šnov©iÚ
.
	`£tZ”o
();

479 
jacobŸn
.
	`£tZ”o
();

480 
ob£rv©iÚV¬Ÿnû
.
	`£tZ”o
();

485 
boŞ
 
haveKeyICPF—tu»s
 = 
	`g‘ICPQu®™yPo¡s
(
visiÚBundË
).
	`size
() > 0;

487 ià(!
haveKeyICPF—tu»s
) {

488 
i
 = 0; i < 
visiÚBundË
.
f›ldF—tu»s
.
	`size
(); i++) {

489 ià(
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fCÜÃr
 ||

490 
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fTJunùiÚ
 ||

491 
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fC’ŒeCœşe
 ||

492 
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fXJunùiÚ
 ||

493 
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fP¬®ËlLšes
 ||

494 
visiÚBundË
.
f›ldF—tu»s
[
i
].
ty³
 =ğ
F›ldF—tu»Info
::
fP’®tySpÙ
) {

495 ià(
visiÚBundË
.
f›ldF—tu»s
[
i
].
	`di¡ªû
() < 2500.0) {

496 
haveKeyICPF—tu»s
 = 
Œue
;

510 
cu¼’tDim’siÚ
 = 
	`³rfÜmICPUpd©e
(

511 
visiÚBundË
,

512 
šnov©iÚ
,

513 
jacobŸn
,

514 
ob£rv©iÚV¬Ÿnû
,

515 0, 
haveKeyICPF—tu»s
);

516 
	`MY_ASSERT
(
cu¼’tDim’siÚ
 >= 0 && currentDimension <= 3, "icp dimension unexpected");

518 
¡ÜedICPUpd©e
 = 
	`StÜedICPUpd©e
(
cu¼’tDim’siÚ
, 
šnov©iÚ
, 
jacobŸn
, 
ob£rv©iÚV¬Ÿnû
);

519 
weightUpd©e
 = 
	`­¶yOb£rv©iÚ
(
cu¼’tDim’siÚ
, 
šnov©iÚ
, 
jacobŸn
, 
ob£rv©iÚV¬Ÿnû
, 
upd©eWeight
);

523 ià(
cu¼’tDim’siÚ
 =ğ0 && 
upd©eWeight
 && 
visiÚBundË
.
f›ldF—tu»s
.
	`size
() > 0) {

524 
weightUpd©e
 *= 0.5;

525 
weight
 *= 0.5;

528  
weightUpd©e
;

529 
	}
}

531 
Sim¶eGaussŸn
* 
	gSim¶eGaussŸn
::
	$ü—‹Symm‘ricGaussŸn
() {

532 
symm‘ryWeight
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

533 
Loÿli§tiÚCÚ¡ªtsProvid”
::
SYMMETRIC_MODE_WEIGHT
);

535 
Eig’
::
M©rixXd
 
»æeùedM—n
 = 
m—n
;

536 
	`»æeùedM—n
(
ROBOT_X_DIM
, 0) *= -1.0;

537 
	`»æeùedM—n
(
ROBOT_Y_DIM
, 0) *= -1.0;

538 
	`»æeùedM—n
(
ROBOT_H_DIM
, 0èğ
	`nÜm®i£Th‘a
(
	`m—n
(ROBOT_H_DIM, 0è+ 
M_PI
);

539 
	`»æeùedM—n
(
BALL_X_DIM
, 0) *= -1.0;

540 
	`»æeùedM—n
(
BALL_Y_DIM
, 0) *= -1.0;

541 
	`»æeùedM—n
(
BALL_DX_DIM
, 0) *= -1.0;

542 
	`»æeùedM—n
(
BALL_DY_DIM
, 0) *= -1.0;

544  
Ãw
 
	`Sim¶eGaussŸn
(
DIM
, 
symm‘ryWeight
 * 
weight
, 
»æeùedM—n
, 
cov¬Ÿnû
,

545 
došgB®lLšeUp
, 
isInR—dyMode
, 
ob£rvedPo¡sHi¡Üy
.
	`ü—‹Symm‘ricHi¡Üy
());

546 
	}
}

548 
	g¡d
::
veùÜ
<
Sim¶eGaussŸn
*> Sim¶eGaussŸn::
	$­¶yRemÙeUpd©e
(

549 cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
, 
‹amm©eIndex
, 
boŞ
 
amGßl›
) {

551 
	`MY_ASSERT
(
DIM
 =ğ
MAIN_DIM
, "dim‚oƒqualo main dim in‡pply„emote");

552 
	`MY_ASSERT
(
‹amm©eIndex
 >= 0 &&eammateIndex <= 3, "apply„emote invalideammate index");

554 
	`upd©eM—nVeùÜW™hRemÙeOdom‘ry
(
upd©eBundË
, 
‹amm©eIndex
);

555 
	`upd©eCov¬ŸnûW™hRemÙeOdom‘ry
(
upd©eBundË
, 
‹amm©eIndex
);

557 ià(!
upd©eBundË
.
haveVisiÚUpd©es
 || 
došgB®lLšeUp
 || 
	`isB®lTooClo£FÜRemÙeUpd©e
()) {

558  
¡d
::
veùÜ
<
Sim¶eGaussŸn
*>();

562 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ÃwModes
;

563 
Sim¶eGaussŸn
 *
¥l™GaussŸn
 = 
	`ü—‹S¶™GaussŸn
();

565 
»mÙeUpd©eInv®idProbab™y
 = 0.0;

566 ià(
amGßl›
) {

567 
»mÙeUpd©eInv®idProbab™y
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

568 
Loÿli§tiÚCÚ¡ªtsProvid”
::
INVALID_REMOTE_OBSERVATION_PROBABILITY_GOALIE
);

570 
»mÙeUpd©eInv®idProbab™y
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

571 
Loÿli§tiÚCÚ¡ªtsProvid”
::
INVALID_REMOTE_OBSERVATION_PROBABILITY
);

573 
¥l™GaussŸn
->
weight
 *ğ
»mÙeUpd©eInv®idProbab™y
;

574 
ÃwModes
.
	`push_back
(
¥l™GaussŸn
);

577 
Eig’
::
M©rixXd
 
	`jacobŸn
(
SHARED_DIM
, 
DIM
);

578 
jacobŸn
.
	`£tZ”o
();

581 
	`jacobŸn
(
BALL_X_DIM
, BALL_X_DIM) = 1.0;

582 
	`jacobŸn
(
BALL_Y_DIM
, BALL_Y_DIM) = 1.0;

583 
	`jacobŸn
(
BALL_DX_DIM
, BALL_DX_DIM) = 1.0;

584 
	`jacobŸn
(
BALL_DY_DIM
, BALL_DY_DIM) = 1.0;

587 cÚ¡ 
po£XIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_X_DIM
);

588 cÚ¡ 
po£YIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_Y_DIM
);

589 cÚ¡ 
po£HIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_H_DIM
);

590 
	`jacobŸn
(
ROBOT_X_DIM
, 
po£XIndex
) = 1.0;

591 
	`jacobŸn
(
ROBOT_Y_DIM
, 
po£YIndex
) = 1.0;

592 
	`jacobŸn
(
ROBOT_H_DIM
, 
po£HIndex
) = 1.0;

594 
M©rixXd
 
	`šnov©iÚ
(
SHARED_DIM
, 1);

595 
	`šnov©iÚ
(
ROBOT_X_DIM
, 0èğ
upd©eBundË
.
	`sh¬edUpd©eM—n
(ROBOT_X_DIM, 0è- 
	`m—n
(
po£XIndex
, 0);

596 
	`šnov©iÚ
(
ROBOT_Y_DIM
, 0èğ
upd©eBundË
.
	`sh¬edUpd©eM—n
(ROBOT_Y_DIM, 0è- 
	`m—n
(
po£YIndex
, 0);

597 
	`šnov©iÚ
(
ROBOT_H_DIM
, 0èğ
	`nÜm®i£Th‘a
(
upd©eBundË
.
	`sh¬edUpd©eM—n
(ROBOT_H_DIM, 0è- 
	`m—n
(
po£HIndex
, 0));

598 
	`šnov©iÚ
(
BALL_X_DIM
, 0èğ
upd©eBundË
.
	`sh¬edUpd©eM—n
(BALL_X_DIM, 0è- 
	`m—n
(BALL_X_DIM, 0);

599 
	`šnov©iÚ
(
BALL_Y_DIM
, 0èğ
upd©eBundË
.
	`sh¬edUpd©eM—n
(BALL_Y_DIM, 0è- 
	`m—n
(BALL_Y_DIM, 0);

600 
	`šnov©iÚ
(
BALL_DX_DIM
, 0èğ
upd©eBundË
.
	`sh¬edUpd©eM—n
(BALL_DX_DIM, 0è- 
	`m—n
(BALL_DX_DIM, 0);

601 
	`šnov©iÚ
(
BALL_DY_DIM
, 0èğ
upd©eBundË
.
	`sh¬edUpd©eM—n
(BALL_DY_DIM, 0è- 
	`m—n
(BALL_DY_DIM, 0);

603 
unû¹aštyFaùÜ
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

604 
Loÿli§tiÚCÚ¡ªtsProvid”
::
REMOTE_OBSERVATION_UNCERTAINTY_FACTOR
);

605 
M©rixXd
 
	`ob£rv©iÚV¬Ÿnû
(
SHARED_DIM
, SHARED_DIM);

606 
i
 = 0; i < 
SHARED_DIM
; i++) {

607 
j
 = 0; j < 
SHARED_DIM
; j++) {

608 
	`ob£rv©iÚV¬Ÿnû
(
i
, 
j
èğ
upd©eBundË
.
	`sh¬edUpd©eCov¬Ÿnû
(i, jè* 
unû¹aštyFaùÜ
;

612 
Ï¡WeightAdju¡m’t
 =

613 
	`³rfÜmTrimmedK®mªUpd©e
(
šnov©iÚ
, 
jacobŸn
, 
ob£rv©iÚV¬Ÿnû
, 
Œue
,rue);

618 ià(
Ï¡WeightAdju¡m’t
 < 
»mÙeUpd©eInv®idProbab™y
) {

619 
	`cov¬Ÿnû
(
po£XIndex
,…oseXIndex) *= 2.0;

620 
	`cov¬Ÿnû
(
po£YIndex
,…oseYIndex) *= 2.0;

621 
	`cov¬Ÿnû
(
po£HIndex
,…oseHIndex) *= 2.0;

624 
	`§n™yCheck
();

625  
ÃwModes
;

626 
	}
}

628 
AbsCoÜd
 
	gSim¶eGaussŸn
::
	$g‘RobÙPo£
() const {

629 
AbsCoÜd
 
»suÉ
 = 
	`AbsCoÜd
(
	`m—n
(
ROBOT_X_DIM
, 0), m—n(
ROBOT_Y_DIM
, 0), m—n(
ROBOT_H_DIM
, 0));

630 
i
 = 0; i < 3; i++) {

631 
j
 = 0; j < 3; j++) {

632 
»suÉ
.
	`v¬
(
i
, 
j
èğ
	`cov¬Ÿnû
(i, j);

635  
»suÉ
;

636 
	}
}

638 
AbsCoÜd
 
	gSim¶eGaussŸn
::
	$g‘B®lPos™iÚ
() const {

639 
AbsCoÜd
 
»suÉ
 = 
	`AbsCoÜd
(
	`m—n
(
BALL_X_DIM
, 0), m—n(
BALL_Y_DIM
, 0), 0);

640 
i
 = 0; i < 2; i++) {

641 
j
 = 0; j < 2; j++) {

642 
»suÉ
.
	`v¬
(
i
, 
j
èğ
	`cov¬Ÿnû
(
BALL_X_DIM
 + i, BALL_X_DIM + j);

645  
»suÉ
;

646 
	}
}

648 
AbsCoÜd
 
	gSim¶eGaussŸn
::
	$g‘B®lV–oc™y
() const {

649 
AbsCoÜd
 
»suÉ
 = 
	`AbsCoÜd
(
	`m—n
(
BALL_DX_DIM
, 0), m—n(
BALL_DY_DIM
, 0), 0);

650 
i
 = 0; i < 2; i++) {

651 
j
 = 0; j < 2; j++) {

652 
»suÉ
.
	`v¬
(
i
, 
j
èğ
	`cov¬Ÿnû
(
BALL_DX_DIM
 + i, BALL_DX_DIM + j);

655  
»suÉ
;

656 
	}
}

658 
	gSim¶eGaussŸn
::
	$g‘RobÙPosUnû¹ašty
() const {

659 
Eig’
::
M©rixXd
 
pos™iÚCov¬Ÿnû
 = 
cov¬Ÿnû
.
	`block
(
ROBOT_X_DIM
, ROBOT_X_DIM, 2, 2);

660 
Eig’SŞv”
<
M©rixXd
> 
	`es
(
pos™iÚCov¬Ÿnû
);

662 
v®ue0
 = 
	`sq¹
(
	`com¶exMagn™ude
(
es
.
	`eig’v®ues
()[0].
	`»®
(),ƒs.eig’v®ues()[0].
	`imag
()));

663 
v®ue1
 = 
	`sq¹
(
	`com¶exMagn™ude
(
es
.
	`eig’v®ues
()[1].
	`»®
(),ƒs.eig’v®ues()[1].
	`imag
()));

664  
v®ue0
 * 
v®ue1
;

665 
	}
}

667 
	gSim¶eGaussŸn
::
	$g‘RobÙH—dšgUnû¹ašty
() const {

668  
	`sq¹
(
	`cov¬Ÿnû
(
ROBOT_H_DIM
, ROBOT_H_DIM));

669 
	}
}

671 
	gSim¶eGaussŸn
::
	$g‘B®lPosUnû¹ašty
() const {

672 
Eig’
::
M©rixXd
 
pos™iÚCov¬Ÿnû
 = 
cov¬Ÿnû
.
	`block
(
BALL_X_DIM
, BALL_X_DIM, 2, 2);

673 
Eig’SŞv”
<
M©rixXd
> 
	`es
(
pos™iÚCov¬Ÿnû
);

675 
v®ue0
 = 
	`sq¹
(
	`com¶exMagn™ude
(
es
.
	`eig’v®ues
()[0].
	`»®
(),ƒs.eig’v®ues()[0].
	`imag
()));

676 
v®ue1
 = 
	`sq¹
(
	`com¶exMagn™ude
(
es
.
	`eig’v®ues
()[1].
	`»®
(),ƒs.eig’v®ues()[1].
	`imag
()));

677  
v®ue0
 * 
v®ue1
;

678 
	}
}

680 
	gSim¶eGaussŸn
::
	$g‘B®lV–oc™yUnû¹ašty
() const {

681 
Eig’
::
M©rixXd
 
v–oc™yCov¬Ÿnû
 = 
cov¬Ÿnû
.
	`block
(
BALL_DX_DIM
, BALL_DX_DIM, 2, 2);

682 
Eig’SŞv”
<
M©rixXd
> 
	`es
(
v–oc™yCov¬Ÿnû
);

684 
v®ue0
 = 
	`sq¹
(
	`com¶exMagn™ude
(
es
.
	`eig’v®ues
()[0].
	`»®
(),ƒs.eig’v®ues()[0].
	`imag
()));

685 
v®ue1
 = 
	`sq¹
(
	`com¶exMagn™ude
(
es
.
	`eig’v®ues
()[1].
	`»®
(),ƒs.eig’v®ues()[1].
	`imag
()));

686  
	`MAX
(
v®ue0
, 
v®ue1
);

687 
	}
}

689 
boŞ
 
	gSim¶eGaussŸn
::
	$isSim¬To
(cÚ¡ 
Sim¶eGaussŸn
 &
Ùh”
) const {

690 ià(!
ob£rvedPo¡sHi¡Üy
.
	`isSim¬To
(
Ùh”
.observedPostsHistory)) {

691  
çl£
;

697 
xDiff
 = 
	`m—n
(
ROBOT_X_DIM
, 0è- 
Ùh”
.mean(ROBOT_X_DIM, 0);

698 
yDiff
 = 
	`m—n
(
ROBOT_Y_DIM
, 0è- 
Ùh”
.mean(ROBOT_Y_DIM, 0);

699 
h—dšgDiff
 = 
	`MIN_THETA_DIFF
(
	`m—n
(
ROBOT_H_DIM
, 0), 
Ùh”
.mean(ROBOT_H_DIM, 0));

700 
posDiff
 = 
	`sq¹
(
xDiff
*xDifà+ 
yDiff
*yDiff);

702 
‹amm©eIndex
 = 0;—mm©eIndex < 
NUM_TEAMMATES
;eammateIndex++) {

703 cÚ¡ 
po£XIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_X_DIM
);

704 cÚ¡ 
po£YIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_Y_DIM
);

705 cÚ¡ 
po£HIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_H_DIM
);

707 
xDiff
 = 
	`m—n
(
po£XIndex
, 0è- 
Ùh”
.mean(poseXIndex, 0);

708 
yDiff
 = 
	`m—n
(
po£YIndex
, 0è- 
Ùh”
.mean(poseYIndex, 0);

710 
h—dšgDiff
 = 
	`MAX
(h—dšgDiff, 
	`MIN_THETA_DIFF
(
	`m—n
(
po£HIndex
, 0), 
Ùh”
.mean(poseHIndex, 0)));

711 
posDiff
 = 
	`MAX
ÕosDiff, 
	`sq¹
(
xDiff
*xDifà+ 
yDiff
*yDiff));

714 
xDiff
 = 
	`m—n
(
BALL_X_DIM
, 0è- 
Ùh”
.mean(BALL_X_DIM, 0);

715 
yDiff
 = 
	`m—n
(
BALL_Y_DIM
, 0è- 
Ùh”
.mean(BALL_Y_DIM, 0);

716 
posDiff
 = 
	`MAX
ÕosDiff, 
	`sq¹
(
xDiff
*xDifà+ 
yDiff
*yDiff));

718 
h—dšgTh»shŞd
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

719 
Loÿli§tiÚCÚ¡ªtsProvid”
::
MEAN_HEADING_SIMILARITY_THRESHOLD
);

720 
posTh»shŞd
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

721 
Loÿli§tiÚCÚ¡ªtsProvid”
::
MEAN_DIST_SIMILARITY_THRESHOLD
);

723 
boŞ
 
amN—rOwnGßls
 = 
	`çbs
(
	`m—n
(
ROBOT_Y_DIM
, 0)) < 1700.0 &&

724 
	`m—n
(
ROBOT_X_DIM
, 0è< (-
FIELD_LENGTH
 / 2.0 + 1700.0);

725 
boŞ
 
amN—rOµÚ’tGßls
 = 
	`çbs
(
	`m—n
(
ROBOT_Y_DIM
, 0)) < 1700.0 &&

726 
	`m—n
(
ROBOT_X_DIM
, 0è> (
FIELD_LENGTH
 / 2.0 - 1700.0);

728 ià(
amN—rOwnGßls
 || 
amN—rOµÚ’tGßls
) {

729 
h—dšgTh»shŞd
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

730 
Loÿli§tiÚCÚ¡ªtsProvid”
::
MEAN_HEADING_SIMILARITY_THRESHOLD_NEAR_GOALS
);

731 
posTh»shŞd
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

732 
Loÿli§tiÚCÚ¡ªtsProvid”
::
MEAN_DIST_SIMILARITY_THRESHOLD_NEAR_GOALS
);

735 ià(
h—dšgDiff
 < 
h—dšgTh»shŞd
 && 
posDiff
 < 
posTh»shŞd
) {

738 
covDi¡
 = 0.0;

739 
row
 = 0;„ow < 3;„ow++) {

740 
cŞ
 = 0; col < 3; col++) {

741 
covDi¡
 +ğ
	`çbs
(
	`cov¬Ÿnû
(
row
, 
cŞ
è- 
Ùh”
.covariance(row, col));

745  
covDi¡
 < 
cÚ¡ªtsProvid”
.
	`g‘
(

746 
Loÿli§tiÚCÚ¡ªtsProvid”
::
COVARIANCE_DIST_SIMILARITY_THRESHOLD
);

754  
çl£
;

755 
	}
}

757 
	gSim¶eGaussŸn
::
	$m”geW™h
(
Sim¶eGaussŸn
 &
Ùh”
) {

758 
sumWeights
 = 
weight
 + 
Ùh”
.weight;

759 ià(
sumWeights
 < 
EPSILON
) {

760 
weight
 = 0.0;

761 
Ùh”
.
weight
 = 0.0;

765 
thisR©io
 = 
weight
 / 
sumWeights
;

766 
Ùh”R©io
 = 
Ùh”
.
weight
 / 
sumWeights
;

769 
row
 = 0;„ow < 
m—n
.
	`rows
();„ow++) {

770 ià(
	`isH—dšgRow
(
row
)) {

771 
toOth”
 = 
	`nÜm®i£Th‘a
(
Ùh”
.
	`m—n
(
row
, 0) - mean(row, 0));

772 
	`m—n
(
row
, 0èğ
	`nÜm®i£Th‘a
(m—nÔow, 0è+ 
Ùh”R©io
 * 
toOth”
);

774 
	`m—n
(
row
, 0èğ
thisR©io
 * m—nÔow, 0è+ 
Ùh”R©io
 * 
Ùh”
.mean(row, 0);

779 
cov¬Ÿnû
 *ğ
thisR©io
;

780 
Ùh”
.
cov¬Ÿnû
 *ğ
Ùh”R©io
;

781 
cov¬Ÿnû
 +ğ
Ùh”
.covariance;

783 
Ùh”
.
weight
 = 0.0;

784 
weight
 = 
sumWeights
;

786 ià(!
haveLa¡VisiÚUpd©e
) {

787 
Ï¡VisiÚUpd©e
 = 
Ùh”
.lastVisionUpdate;

790 
haveLa¡VisiÚUpd©e
 |ğ
Ùh”
.haveLastVisionUpdate;

792 ià(
weight
 >ğ
Ùh”
.weight) {

793 
ob£rvedPo¡sHi¡Üy
 = ob£rvedPo¡sHi¡Üy.
	`m”gedW™h
(
Ùh”
.observedPostsHistory);

795 
ob£rvedPo¡sHi¡Üy
 = 
Ùh”
.ob£rvedPo¡sHi¡Üy.
	`m”gedW™h
(observedPostsHistory);

797 
	}
}

799 
	gSim¶eGaussŸn
::
	$g‘Weight
() const {

800  
weight
;

801 
	}
}

803 
	gSim¶eGaussŸn
::
	$£tWeight
(
weight
) {

804 
	`MY_ASSERT
(
weight
 >= 0.0 && weight <= 1.0, "invalid weight set");

805 
this
->
weight
 = weight;

806 
	}
}

808 
boŞ
 
	gSim¶eGaussŸn
::
	$g‘HaveLa¡VisiÚUpd©e
() const {

809  
haveLa¡VisiÚUpd©e
;

810 
	}
}

812 
StÜedICPUpd©e
 
	gSim¶eGaussŸn
::
	$g‘La¡Aµl›dICPUpd©e
() const {

813  
¡ÜedICPUpd©e
;

814 
	}
}

816 
UniMod®VisiÚUpd©e
 
	gSim¶eGaussŸn
::
	$g‘La¡Aµl›dVisiÚUpd©e
() const {

817  
Ï¡VisiÚUpd©e
;

818 
	}
}

820 
	gEig’
::
M©rixXd
 
Sim¶eGaussŸn
::
	$g‘M—n
() const {

821  
m—n
;

822 
	}
}

824 
	gEig’
::
M©rixXd
 
Sim¶eGaussŸn
::
	$g‘Cov¬Ÿnû
() const {

825  
cov¬Ÿnû
;

826 
	}
}

828 
	g¡d
::
veùÜ
<
Po¡Info
> 
Sim¶eGaussŸn
::
	$g‘ICPQu®™yPo¡s
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
) {

829 
¡d
::
veùÜ
<
Po¡Info
> 
»suÉ
;

831 
i
 = 0; i < 
visiÚBundË
.
po¡s
.
	`size
(); i++) {

832 ià(
visiÚBundË
.
po¡s
[
i
].
Œu¡Di¡ªû
 && visiÚBundË.po¡s[i].
¼
.
	`di¡ªû
() < 2000.0) {

833 
»suÉ
.
	`push_back
(
visiÚBundË
.
po¡s
[
i
]);

838 ià(
»suÉ
.
	`size
(è!ğ
visiÚBundË
.
po¡s
.size()) {

839 
»suÉ
.
	`ş—r
();

842  
»suÉ
;

843 
	}
}

845 
boŞ
 
	gSim¶eGaussŸn
::
	$ÿnU£Po¡Ty³
(
Po¡Ty³
 
ty³
, 
po¡Di¡ªû
) {

848 ià(!
ob£rvedPo¡sHi¡Üy
.
	`ÿnOb£rvePo¡Ty³
(
ty³
)) {

849  
çl£
;

855 
AbsCoÜd
 
po¡Pos
 = 
	`g‘GßÍo¡Pos™iÚ
(
ty³
);

858 
dx
 = 
	`m—n
(
ROBOT_X_DIM
, 0è- 
po¡Pos
.
	`x
();

859 
dy
 = 
	`m—n
(
ROBOT_Y_DIM
, 0è- 
po¡Pos
.
	`y
();

860 
ex³ùedDi¡ªû
 = 
	`sq¹
(
dx
*dx + 
dy
*dy);

863 
po¡CutoffDi¡ªû
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

864 
Loÿli§tiÚCÚ¡ªtsProvid”
::
GOALPOST_MAX_DISTANCE_OBSERVATION
);

867 ià(
ex³ùedDi¡ªû
 < 2000.0 &&

868 
po¡Di¡ªû
 > 
po¡CutoffDi¡ªû
 &&

869 
ex³ùedDi¡ªû
 < 0.5 * 
po¡Di¡ªû
) {

870  
çl£
;

874 ià(
po¡Di¡ªû
 < 2000.0 &&

875 
ex³ùedDi¡ªû
 > 
po¡CutoffDi¡ªû
 &&

876 
po¡Di¡ªû
 < 0.5 * 
ex³ùedDi¡ªû
) {

877  
çl£
;

880  
Œue
;

881 
	}
}

883 
boŞ
 
	gSim¶eGaussŸn
::
	$ÿnU£Po¡Ty³
(
Po¡Ty³
 
ty³0
, 
di¡ªû0
, Po¡Ty³ 
ty³1
, 
di¡ªû1
) {

884  
	`ÿnU£Po¡Ty³
(
ty³0
, 
di¡ªû0
è&& cªU£Po¡Ty³(
ty³1
, 
di¡ªû1
);

885 
	}
}

887 
	gSim¶eGaussŸn
::
	$di¡ªûTo
(cÚ¡ 
AbsCoÜd
 &
coÜd
) {

888 
dx
 = 
	`m—n
(
ROBOT_X_DIM
, 0è- 
coÜd
.
	`x
();

889 
dy
 = 
	`m—n
(
ROBOT_Y_DIM
, 0è- 
coÜd
.
	`y
();

890  
	`sq¹
(
dx
*dx + 
dy
*dy);

891 
	}
}

893 
Sim¶eGaussŸn
* 
	gSim¶eGaussŸn
::
	$ü—‹S¶™GaussŸn
() {

894  
Ãw
 
	`Sim¶eGaussŸn
(
DIM
, 
weight
, 
m—n
, 
cov¬Ÿnû
,

895 
došgB®lLšeUp
, 
isInR—dyMode
, 
ob£rvedPo¡sHi¡Üy
);

896 
	}
}

898 
boŞ
 
	gSim¶eGaussŸn
::
	$isH—dšgRow
(
row
) {

900 ià(
DIM
 =ğ
MAIN_DIM
) {

901  
row
 == 2 ||„ow == 9 ||„ow == 12 ||„ow == 15 ||„ow == 18;

903  
row
 == 2;

905 
	}
}

907 
	gSim¶eGaussŸn
::
	$nÜm®i£Th‘a
(
th‘a
) {

908 
r
 = 
	`fmod
(
th‘a
 - 
M_PI
, 2.0*M_PI);

909 ià(
r
 > 0) {

910  
r
 - 
M_PI
;

912  
r
 + 
M_PI
;

914 
	}
}

916 
	gSim¶eGaussŸn
::
addNoPo¡sOb£rv©iÚMode
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

917 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
outModes
) {

918 
Sim¶eGaussŸn
 *
ÃwMode
 = 
ü—‹S¶™GaussŸn
();

919 
	gÃwMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
));

920 
	goutModes
.
push_back
(
ÃwMode
);

925 
	gSim¶eGaussŸn
::
addOÃPo¡Ob£rv©iÚModes
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

926 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
outModes
) {

927 
MY_ASSERT
(
visiÚBundË
.
po¡s
.
size
() == 1, "unexpected‚umber of…osts");

929 
Sim¶eGaussŸn
 *
	gba£S¶™GaussŸn
 = 
ü—‹S¶™GaussŸn
();

930 ià(
	gvisiÚBundË
.
	gpo¡s
[0].
	gty³
 & 
	gPo¡Info
::
pLeá
) {

932 ià(
ÿnU£Po¡Ty³
(
MY_LEFT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
())) {

933 
Sim¶eGaussŸn
 *
	gmyMode
 = 
ba£S¶™GaussŸn
->
ü—‹S¶™GaussŸn
();

934 
	gmyMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
, 
MY_LEFT
));

935 
	goutModes
.
push_back
(
myMode
);

938 ià(
ÿnU£Po¡Ty³
(
OPPONENT_LEFT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
())) {

939 
Sim¶eGaussŸn
 *
	gawayMode
 = 
ba£S¶™GaussŸn
->
ü—‹S¶™GaussŸn
();

940 
	gawayMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
, 
OPPONENT_LEFT
));

941 
	goutModes
.
push_back
(
awayMode
);

943 } ià(
	gvisiÚBundË
.
	gpo¡s
[0].
	gty³
 & 
	gPo¡Info
::
pRight
) {

945 ià(
ÿnU£Po¡Ty³
(
MY_RIGHT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
())) {

946 
Sim¶eGaussŸn
 *
	gmyMode
 = 
ba£S¶™GaussŸn
->
ü—‹S¶™GaussŸn
();

947 
	gmyMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
, 
MY_RIGHT
));

948 
	goutModes
.
push_back
(
myMode
);

951 ià(
ÿnU£Po¡Ty³
(
OPPONENT_RIGHT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
())) {

952 
Sim¶eGaussŸn
 *
	gawayMode
 = 
ba£S¶™GaussŸn
->
ü—‹S¶™GaussŸn
();

953 
	gawayMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
, 
OPPONENT_RIGHT
));

954 
	goutModes
.
push_back
(
awayMode
);

958 
	gi
 = 0; i < 4; i++) {

959 ià(
ÿnU£Po¡Ty³
(
¡©ic_ÿ¡
<
Po¡Ty³
>(
i
), 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
())) {

960 
	g¡d
::
veùÜ
<
Po¡Ty³
> 
po¡Ty³
;

961 
	gpo¡Ty³
.
push_back
(
¡©ic_ÿ¡
<
Po¡Ty³
>(
i
));

963 
Sim¶eGaussŸn
 *
	gÃwMode
 = 
ba£S¶™GaussŸn
->
ü—‹S¶™GaussŸn
();

964 
	gÃwMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
, 
po¡Ty³
));

965 
	goutModes
.
push_back
(
ÃwMode
);

970 ià(
	goutModes
.
size
() == 0) {

971 
ba£S¶™GaussŸn
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
));

972 
	goutModes
.
push_back
(
ba£S¶™GaussŸn
);

974 
d–‘e
 
	gba£S¶™GaussŸn
;

978 
	gSim¶eGaussŸn
::
addTwoPo¡Ob£rv©iÚModes
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

979 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
outModes
) {

980 
MY_ASSERT
(
visiÚBundË
.
po¡s
.
size
() == 2, "unexpected‚umber of…osts");

982 
Sim¶eGaussŸn
 *
	gba£S¶™GaussŸn
 = 
ü—‹S¶™GaussŸn
();

987 
	g¡d
::
veùÜ
<
Po¡Ty³
> 
po¡Ty³s
;

989 ià((
	gvisiÚBundË
.
	gpo¡s
[0].
	gty³
 & 
	gPo¡Info
::
pLeá
) ||

990 
visiÚBundË
.
po¡s
[0].
¼
.
h—dšg
() > visionBundle.posts[1].rr.heading()) {

991 ià(
ÿnU£Po¡Ty³
(
MY_LEFT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
(),

992 
MY_RIGHT
, 
visiÚBundË
.
po¡s
[1].
¼
.
di¡ªû
())) {

993 
	gpo¡Ty³s
.
push_back
(
MY_LEFT
);

994 
	gpo¡Ty³s
.
push_back
(
MY_RIGHT
);

997 ià(
ÿnU£Po¡Ty³
(
MY_RIGHT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
(),

998 
MY_LEFT
, 
visiÚBundË
.
po¡s
[1].
¼
.
di¡ªû
())) {

999 
	gpo¡Ty³s
.
push_back
(
MY_RIGHT
);

1000 
	gpo¡Ty³s
.
push_back
(
MY_LEFT
);

1004 ià(
	gpo¡Ty³s
.
size
() == 2) {

1005 
Sim¶eGaussŸn
 *
homeMode
 = 
ba£S¶™GaussŸn
->
ü—‹S¶™GaussŸn
();

1006 
	ghomeMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
, 
po¡Ty³s
));

1007 
	goutModes
.
push_back
(
homeMode
);

1012 
	gpo¡Ty³s
.
ş—r
();

1014 ià((
	gvisiÚBundË
.
	gpo¡s
[0].
	gty³
 & 
	gPo¡Info
::
pLeá
) ||

1015 
visiÚBundË
.
po¡s
[0].
¼
.
h—dšg
() > visionBundle.posts[1].rr.heading()) {

1016 ià(
ÿnU£Po¡Ty³
(
OPPONENT_LEFT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
(),

1017 
OPPONENT_RIGHT
, 
visiÚBundË
.
po¡s
[1].
¼
.
di¡ªû
())) {

1018 
	gpo¡Ty³s
.
push_back
(
OPPONENT_LEFT
);

1019 
	gpo¡Ty³s
.
push_back
(
OPPONENT_RIGHT
);

1022 ià(
ÿnU£Po¡Ty³
(
OPPONENT_RIGHT
, 
visiÚBundË
.
po¡s
[0].
¼
.
di¡ªû
(),

1023 
OPPONENT_LEFT
, 
visiÚBundË
.
po¡s
[1].
¼
.
di¡ªû
())) {

1024 
	gpo¡Ty³s
.
push_back
(
OPPONENT_RIGHT
);

1025 
	gpo¡Ty³s
.
push_back
(
OPPONENT_LEFT
);

1029 ià(
	gpo¡Ty³s
.
size
() == 2) {

1030 
Sim¶eGaussŸn
 *
awayMode
 = 
ba£S¶™GaussŸn
->
ü—‹S¶™GaussŸn
();

1031 
	gawayMode
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
, 
po¡Ty³s
));

1032 
	goutModes
.
push_back
(
awayMode
);

1035 ià(
	goutModes
.
size
() == 0) {

1036 
ba£S¶™GaussŸn
->
uniMod®VisiÚUpd©e
(
UniMod®VisiÚUpd©e
(
visiÚBundË
));

1037 
	goutModes
.
push_back
(
ba£S¶™GaussŸn
);

1039 
d–‘e
 
	gba£S¶™GaussŸn
;

1043 
	gSim¶eGaussŸn
::
	$³rfÜmK®mªUpd©e
(

1044 cÚ¡ 
ob£rv©iÚDim
,

1045 cÚ¡ 
Eig’
::
M©rixXd
 &
šnov©iÚ
,

1046 cÚ¡ 
Eig’
::
M©rixXd
 &
jacobŸn
,

1047 cÚ¡ 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬Ÿnû
,

1048 cÚ¡ 
boŞ
 
upd©eWeight
) {

1049 
	`MY_ASSERT
(
ob£rv©iÚDim
 <ğ
MAX_MEASUREMENT_DIM
, "observation dim greaterhan max measurement dim");

1050 
	`MY_ASSERT
(
ob£rv©iÚDim
 > 0, "observation dim is 0");

1052 
Eig’
::
M©rixXd
 
ŒimmedIÂov©iÚ
 = 
šnov©iÚ
.
	`block
(0, 0, 
ob£rv©iÚDim
, 1);

1053 
Eig’
::
M©rixXd
 
ŒimmedJacobŸn
 = 
jacobŸn
.
	`block
(0, 0, 
ob£rv©iÚDim
, 
DIM
);

1054 
Eig’
::
M©rixXd
 
ŒimmedOb£rv©iÚV¬Ÿnû
 =

1055 
ob£rv©iÚV¬Ÿnû
.
	`block
(0, 0, 
ob£rv©iÚDim
, observationDim);

1057  
	`³rfÜmTrimmedK®mªUpd©e
(
ŒimmedIÂov©iÚ
, 
ŒimmedJacobŸn
, 
ŒimmedOb£rv©iÚV¬Ÿnû
, 
çl£
, 
upd©eWeight
);

1058 
	}
}

1060 
	gSim¶eGaussŸn
::
	$³rfÜmTrimmedK®mªUpd©e
(

1061 cÚ¡ 
Eig’
::
M©rixXd
 &
šnov©iÚ
,

1062 cÚ¡ 
Eig’
::
M©rixXd
 &
jacobŸn
,

1063 cÚ¡ 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬Ÿnû
,

1064 cÚ¡ 
boŞ
 
isSh¬edUpd©e
,

1065 cÚ¡ 
boŞ
 
upd©eWeight
) {

1067 cÚ¡ 
Eig’
::
M©rixXd
 
jacobŸnT
 = 
jacobŸn
.
	`Œª¥o£
();

1068 
	`MY_ASSERT
(
jacobŸnT
.
	`rows
(è=ğ(è
DIM
, "jacobianT„ows unexpected");

1070 
Eig’
::
M©rixXd
 
cjt
;

1071 ià(
isSh¬edUpd©e
) {

1072 
cjt
 = 
cov¬Ÿnû
 * 
jacobŸnT
;

1074 
cjt
 = 
	`¥¬£MuÉliÿtiÚ
(
cov¬Ÿnû
, 
jacobŸnT
, 0, 0, 5, jacobŸnT.
	`cŞs
());

1077 
Eig’
::
M©rixXd
 
combšedCov¬Ÿnû
;

1078 ià(
isSh¬edUpd©e
) {

1079 
combšedCov¬Ÿnû
 = ((
jacobŸn
 * 
cjt
è+ 
ob£rv©iÚV¬Ÿnû
);

1081 
Eig’
::
M©rixXd
 
jcjt
 = 
	`¥¬£MuÉliÿtiÚ
(
jacobŸn
, 0, 0, jacobŸn.
	`rows
(), 5, 
cjt
);

1082 
combšedCov¬Ÿnû
 = 
jcjt
 + 
ob£rv©iÚV¬Ÿnû
;

1085 cÚ¡ 
Eig’
::
M©rixXd
 
combšedCov¬ŸnûInv
 = 
combšedCov¬Ÿnû
.
	`šv”£
();

1087 cÚ¡ 
Eig’
::
M©rixXd
 
k®mª
 = 
cjt
 * 
combšedCov¬ŸnûInv
;

1088 
	`MY_ASSERT
(
k®mª
.
	`rows
(è=ğ(è
DIM
, "kalman„ows unexpected");

1090 
m—n
 = m—À+ 
k®mª
 * 
šnov©iÚ
;

1092 
	`şToF›ld
(
m—n
);

1093 
	`şB®lOutOfRobÙ
(
m—n
);

1095 
row
 = 0;„ow < 
m—n
.
	`rows
();„ow++) {

1096 ià(
	`isH—dšgRow
(
row
)) {

1097 
	`m—n
(
row
, 0èğ
	`nÜm®i£Th‘a
(mean(row, 0));

1101 
Eig’
::
M©rixXd
 
kj
;

1102 ià(
isSh¬edUpd©e
) {

1103 
kj
 = 
k®mª
 * 
jacobŸn
;

1105 
kj
 = 
	`¥¬£MuÉliÿtiÚ
(
k®mª
, 
jacobŸn
, 0, 0, jacobŸn.
	`rows
(), 5);

1108 
cov¬Ÿnû
 = (
id’t™y
 - 
kj
) * covariance;

1110 
weightAdju¡m’t
 = 1.0;

1112 cÚ¡ 
Eig’
::
M©rixXd
 
weightUpd©eM©rix
 =

1113 
šnov©iÚ
.
	`Œª¥o£
(è* 
combšedCov¬ŸnûInv
 * innovation;

1114 
	`MY_ASSERT
(
weightUpd©eM©rix
.
	`rows
(è=ğ1 && weightUpd©eM©rix.
	`cŞs
() == 1, "weighted matrix update unexpected");

1116 
weightAdju¡m’t
 = 
	`exp
(-0.5 * 
	`weightUpd©eM©rix
(0, 0));

1117 ià(
weightAdju¡m’t
 !ğweightAdju¡m’ˆ|| weightAdju¡m’ˆ< 
EPSILON
 || 
	`i¢ª
(weightAdjustment)) {

1118 
weightAdju¡m’t
 = 
EPSILON
;

1119 } ià(
weightAdju¡m’t
 > 1.0) {

1120 
weightAdju¡m’t
 = 1.0;

1123 ià(
upd©eWeight
) {

1124 
weight
 *ğ
weightAdju¡m’t
;

1127 
	`§n™yCheck
();

1128  
weightAdju¡m’t
;

1129 
	}
}

1131 
	gSim¶eGaussŸn
::
	$addGßlPo¡M—su»m’t
(

1132 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

1133 cÚ¡ 
RRCoÜd
 &
ob£rvedPo¡CoÜds
,

1134 cÚ¡ 
AbsCoÜd
 &
po¡WÜldCoÜds
,

1135 cÚ¡ 
boŞ
 
u£Di¡ªû
,

1136 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

1137 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

1138 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

1139 cÚ¡ 
cu¼’tM—su»m’t
) {

1140 
	`MY_ASSERT
(
cu¼’tM—su»m’t
 < 
MAX_MEASUREMENT_DIM
, "add goalpost measurement greaterhan max dim");

1142 cÚ¡ 
dx
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_X_DIM
, 0è- 
po¡WÜldCoÜds
.
	`x
());

1143 cÚ¡ 
dy
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_Y_DIM
, 0è- 
po¡WÜldCoÜds
.
	`y
());

1145 
	`addG’”icM—su»m’t
(
ob£rvedPo¡CoÜds
, 
u£Di¡ªû
, 
šnov©iÚOut
, 
jacobŸnOut
,

1146 
cu¼’tM—su»m’t
, 
dx
, 
dy
);

1148 
	`addOb£rv©iÚV¬Ÿnû
(
visiÚBundË
, 
V¬ŸnûProvid”
::
GOALPOST
, 
ob£rvedPo¡CoÜds
,

1149 
u£Di¡ªû
, 
ob£rv©iÚV¬ŸnûOut
, 
cu¼’tM—su»m’t
);

1151  
cu¼’tM—su»m’t
 + (
u£Di¡ªû
 ? 2 : 1);

1152 
	}
}

1154 
	gSim¶eGaussŸn
::
	$addF›ldF—tu»M—su»m’t
(

1155 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

1156 cÚ¡ 
AbsCoÜd
 &
f›ldF—tu»Pos™iÚ
,

1157 cÚ¡ 
RRCoÜd
 &
ob£rvedF›ldF—tu»CoÜds
,

1158 cÚ¡ 
boŞ
 
u£Di¡ªû
,

1159 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

1160 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

1161 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

1162 cÚ¡ 
cu¼’tM—su»m’t
) {

1164 
	`MY_ASSERT
(
cu¼’tM—su»m’t
 < 
MAX_MEASUREMENT_DIM
, "add field feature measurement greaterhan max dim");

1166 cÚ¡ 
dx
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_X_DIM
, 0è- 
f›ldF—tu»Pos™iÚ
.
	`x
());

1167 cÚ¡ 
dy
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_Y_DIM
, 0è- 
f›ldF—tu»Pos™iÚ
.
	`y
());

1169 
	`addG’”icM—su»m’t
(
ob£rvedF›ldF—tu»CoÜds
, 
u£Di¡ªû
, 
šnov©iÚOut
, 
jacobŸnOut
,

1170 
cu¼’tM—su»m’t
, 
dx
, 
dy
);

1172 
	`addOb£rv©iÚV¬Ÿnû
(
visiÚBundË
, 
V¬ŸnûProvid”
::
CENTRE_CIRCLE
, 
ob£rvedF›ldF—tu»CoÜds
,

1173 
u£Di¡ªû
, 
ob£rv©iÚV¬ŸnûOut
, 
cu¼’tM—su»m’t
);

1175  
cu¼’tM—su»m’t
 + (
u£Di¡ªû
 ? 2 : 1);

1176 
	}
}

1178 
	gSim¶eGaussŸn
::
	$addB®lM—su»m’t
(

1179 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

1180 cÚ¡ 
RRCoÜd
 &
ob£rvedB®lCoÜds
,

1181 cÚ¡ 
boŞ
 
u£Di¡ªû
,

1182 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

1183 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

1184 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

1185 cÚ¡ 
cu¼’tM—su»m’t
) {

1187 
	`MY_ASSERT
(
cu¼’tM—su»m’t
 < 
MAX_MEASUREMENT_DIM
, "add ball measurement greaterhan max dim");

1189 cÚ¡ 
dx
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_X_DIM
, 0è- m—n(
BALL_X_DIM
, 0));

1190 cÚ¡ 
dy
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_Y_DIM
, 0è- m—n(
BALL_Y_DIM
, 0));

1192 cÚ¡ 
dx_2
 = 
	`g‘NÚZ”o
(
dx
 * dx);

1193 cÚ¡ 
dy_2
 = 
	`g‘NÚZ”o
(
dy
 * dy);

1195 cÚ¡ 
ex³ùedDi¡ªû
 = 
	`sq¹
(
dx_2
 + 
dy_2
);

1197 
	`addG’”icM—su»m’t
(
ob£rvedB®lCoÜds
, 
u£Di¡ªû
, 
šnov©iÚOut
, 
jacobŸnOut
,

1198 
cu¼’tM—su»m’t
, 
dx
, 
dy
);

1200 
	`jacobŸnOut
(
cu¼’tM—su»m’t
, 
BALL_X_DIM
èğ
dy
 / (
dx_2
 + 
dy_2
);

1201 
	`jacobŸnOut
(
cu¼’tM—su»m’t
, 
BALL_Y_DIM
èğ-
dx
 / (
dx_2
 + 
dy_2
);

1203 ià(
u£Di¡ªû
) {

1204 
	`jacobŸnOut
(
cu¼’tM—su»m’t
+1, 
BALL_X_DIM
èğ-
dx
 / 
ex³ùedDi¡ªû
;

1205 
	`jacobŸnOut
(
cu¼’tM—su»m’t
+1, 
BALL_Y_DIM
èğ-
dy
 / 
ex³ùedDi¡ªû
;

1208 
	`addOb£rv©iÚV¬Ÿnû
(
visiÚBundË
, 
V¬ŸnûProvid”
::
BALL
, 
ob£rvedB®lCoÜds
,

1209 
u£Di¡ªû
, 
ob£rv©iÚV¬ŸnûOut
, 
cu¼’tM—su»m’t
);

1211  
cu¼’tM—su»m’t
 + (
u£Di¡ªû
 ? 2 : 1);

1212 
	}
}

1214 
	gSim¶eGaussŸn
::
	$addT—mm©eM—su»m’t
(

1215 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

1216 cÚ¡ 
RRCoÜd
 &
ob£rvedRobÙCoÜds
,

1217 cÚ¡ 
AbsCoÜd
 &
‹amm©ePos™iÚ
,

1218 cÚ¡ 
boŞ
 
u£Di¡ªû
,

1219 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

1220 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

1221 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

1222 cÚ¡ 
cu¼’tM—su»m’t
) {

1224 
	`MY_ASSERT
(
cu¼’tM—su»m’t
 < 
MAX_MEASUREMENT_DIM
, "addeammate measurement greaterhan max dim");

1226 cÚ¡ 
dx
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_X_DIM
, 0è- 
‹amm©ePos™iÚ
.
	`x
());

1227 cÚ¡ 
dy
 = 
	`g‘NÚZ”o
(
	`m—n
(
ROBOT_Y_DIM
, 0è- 
‹amm©ePos™iÚ
.
	`y
());

1229 
	`addG’”icM—su»m’t
(
ob£rvedRobÙCoÜds
, 
u£Di¡ªû
, 
šnov©iÚOut
, 
jacobŸnOut
,

1230 
cu¼’tM—su»m’t
, 
dx
, 
dy
);

1232 
	`addOb£rv©iÚV¬Ÿnû
(
visiÚBundË
, 
V¬ŸnûProvid”
::
TEAMMATE_ROBOT
, 
ob£rvedRobÙCoÜds
,

1233 
u£Di¡ªû
, 
ob£rv©iÚV¬ŸnûOut
, 
cu¼’tM—su»m’t
);

1235  
cu¼’tM—su»m’t
 + (
u£Di¡ªû
 ? 2 : 1);

1236 
	}
}

1238 
	gSim¶eGaussŸn
::
	$addG’”icM—su»m’t
(

1239 cÚ¡ 
RRCoÜd
 &
ob£rvedObjeùCoÜds
,

1240 cÚ¡ 
boŞ
 
u£Di¡ªû
,

1241 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

1242 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

1243 cÚ¡ 
cu¼’tM—su»m’t
,

1244 cÚ¡ 
dx
, cÚ¡ 
dy
) {

1246 cÚ¡ 
dx_2
 = 
	`g‘NÚZ”o
(
dx
 * dx);

1247 cÚ¡ 
dy_2
 = 
	`g‘NÚZ”o
(
dy
 * dy);

1249 cÚ¡ 
ex³ùedDi¡ªû
 = 
	`sq¹
(
dx_2
 + 
dy_2
);

1250 cÚ¡ 
ex³ùedH—dšg
 = 
	`nÜm®i£Th‘a
(
	`©ª2
(-
dy
, -
dx
è- 
	`m—n
(
ROBOT_H_DIM
, 0));

1252 
	`šnov©iÚOut
(
cu¼’tM—su»m’t
, 0) =

1253 
	`nÜm®i£Th‘a
(
ob£rvedObjeùCoÜds
.
	`h—dšg
(è- 
ex³ùedH—dšg
);

1255 ià(
u£Di¡ªû
) {

1256 
	`šnov©iÚOut
(
cu¼’tM—su»m’t
+1, 0) =

1257 
ob£rvedObjeùCoÜds
.
	`di¡ªû
(è- 
ex³ùedDi¡ªû
;

1260 
	`jacobŸnOut
(
cu¼’tM—su»m’t
, 
ROBOT_X_DIM
èğ-
dy
 / (
dx_2
 + 
dy_2
);

1261 
	`jacobŸnOut
(
cu¼’tM—su»m’t
, 
ROBOT_Y_DIM
èğ
dx
 / (
dx_2
 + 
dy_2
);

1262 
	`jacobŸnOut
(
cu¼’tM—su»m’t
, 
ROBOT_H_DIM
) = -1.0;

1264 ià(
u£Di¡ªû
) {

1265 
	`jacobŸnOut
(
cu¼’tM—su»m’t
+1, 
ROBOT_X_DIM
èğ
dx
 / 
ex³ùedDi¡ªû
;

1266 
	`jacobŸnOut
(
cu¼’tM—su»m’t
+1, 
ROBOT_Y_DIM
èğ
dy
 / 
ex³ùedDi¡ªû
;

1267 
	`jacobŸnOut
(
cu¼’tM—su»m’t
+1, 
ROBOT_H_DIM
) = 0.0;

1269 
	}
}

1271 
	gSim¶eGaussŸn
::
	$addOb£rv©iÚV¬Ÿnû
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

1272 
V¬ŸnûProvid”
::
Ob£rv©iÚTy³
 
ty³
,

1273 cÚ¡ 
RRCoÜd
 &
ob£rvedObjeù
, 
boŞ
 
u£Di¡ªû
,

1274 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

1275 cÚ¡ 
cu¼’tM—su»m’t
) {

1277 
V¬ŸnûProvid”
 
v¬ŸnûProvid”
 = V¬ŸnûProvid”::
	`š¡ªû
();

1278 
V¬ŸnûProvid”
::
Ob£rv©iÚ
 
	`ob£rv©iÚ
(

1279 
ob£rvedObjeù
.
	`di¡ªû
(), ob£rvedObjeù.
	`h—dšg
());

1281 
uÄ–ŸbËDi¡ªûSÿË
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

1282 
Loÿli§tiÚCÚ¡ªtsProvid”
::
UNRELIABLE_DISTANCE_VARIANCE_SCALE
);

1283 
uÄ–ŸbËH—dšgSÿË
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

1284 
Loÿli§tiÚCÚ¡ªtsProvid”
::
UNRELIABLE_HEADING_VARIANCE_SCALE
);

1286 
	`ob£rv©iÚV¬ŸnûOut
(
cu¼’tM—su»m’t
, currentMeasurement) =

1287 
v¬ŸnûProvid”
.
	`g‘H—dšgOb£rv©iÚV¬Ÿnû
(
ty³
, 
ob£rv©iÚ
);

1288 ià(!
visiÚBundË
.
isH—dšgR–ŸbË
 || !visiÚBundË.
isDi¡ªûR–ŸbË
) {

1289 
	`ob£rv©iÚV¬ŸnûOut
(
cu¼’tM—su»m’t
, cu¼’tM—su»m’tè*ğ
uÄ–ŸbËH—dšgSÿË
;

1292 ià(
u£Di¡ªû
) {

1293 
	`ob£rv©iÚV¬ŸnûOut
(
cu¼’tM—su»m’t
+1, currentMeasurement+1) =

1294 
v¬ŸnûProvid”
.
	`g‘Di¡ªûOb£rv©iÚV¬Ÿnû
(
ty³
, 
ob£rv©iÚ
);

1295 ià(!
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

1296 
	`ob£rv©iÚV¬ŸnûOut
(
cu¼’tM—su»m’t
+1, cu¼’tM—su»m’t+1è*ğ
uÄ–ŸbËDi¡ªûSÿË
;

1299 
	}
}

1301 
	gSim¶eGaussŸn
::
	$³rfÜmICPUpd©e
(

1302 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

1303 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

1304 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

1305 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

1306 cÚ¡ 
cu¼’tM—su»m’t
,

1307 cÚ¡ 
boŞ
 
haveKeyICPF—tu»s
) {

1309 
AbsCoÜd
 
b®lRRC
 = 
	`g‘B®lPos™iÚ
().
	`cÚv”tToRobÙR–©iveC¬‹sŸn
(
	`g‘RobÙPo£
());

1312 cÚ¡ 
MAX_FEATURE_DIST
 = 4000.0;

1313 cÚ¡ 
UNRELIABLE_DIST_SCALE
 = 0.66;

1314 cÚ¡ 
NO_KEY_FEATURES_SCALE
 = 0.66;

1316 
FEATURE_DIST_CUTOFF
 = 
MAX_FEATURE_DIST
;

1317 ià(!
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

1318 
FEATURE_DIST_CUTOFF
 *ğ
UNRELIABLE_DIST_SCALE
;

1320 ià(!
haveKeyICPF—tu»s
) {

1321 
FEATURE_DIST_CUTOFF
 *ğ
NO_KEY_FEATURES_SCALE
;

1324 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
f‹»dF—tu»s
;

1325 
i
 = 0; i < 
visiÚBundË
.
f›ldF—tu»s
.
	`size
(); i++) {

1326 ià(
visiÚBundË
.
f›ldF—tu»s
[
i
].
	`di¡ªû
(è< 
FEATURE_DIST_CUTOFF
) {

1327 
f‹»dF—tu»s
.
	`push_back
(
visiÚBundË
.
f›ldF—tu»s
[
i
]);

1331 ià(
f‹»dF—tu»s
.
	`size
() == 0) {

1332  
cu¼’tM—su»m’t
;

1335 
¡d
::
veùÜ
<
Po¡Info
> 
¡ubPo¡s
;

1336 ià(
f‹»dF—tu»s
.
	`size
() > 0) {

1337 
¡ubPo¡s
 = 
	`g‘ICPQu®™yPo¡s
(
visiÚBundË
);

1340 
iıResuÉ
 = 
ICP
::
	`loÿli£
(
	`g‘RobÙPo£
(), 
f‹»dF—tu»s
,

1341 
¡ubPo¡s
, 
visiÚBundË
.
awayGßlProb
, visiÚBundË.
h—dYaw
,

1342 
visiÚBundË
.
f›ldBound¬›s
, 
b®lRRC
, 
çl£
);

1344 ià(
iıResuÉ
 <= 0) {

1345  
cu¼’tM—su»m’t
;

1348 
AbsCoÜd
 
iıUpd©e
 = 
ICP
::
	`g‘CombšedObs
();

1350 
dx
 = 
iıUpd©e
.
	`x
(è- 
	`m—n
(
ROBOT_X_DIM
, 0);

1351 
dy
 = 
iıUpd©e
.
	`y
(è- 
	`m—n
(
ROBOT_Y_DIM
, 0);

1352 
dh
 = 
	`nÜm®i£Th‘a
(
iıUpd©e
.
	`th‘a
(è- 
	`m—n
(
ROBOT_H_DIM
, 0));

1357 ià(!
haveKeyICPF—tu»s
) {

1358 ià(
iıUpd©e
.
	`v¬
(0, 0è> 0.0 && 
	`çbs
(
dx
) > 400.0) {

1362 ià(
iıUpd©e
.
	`v¬
(1, 1è> 0.0 && 
	`çbs
(
dy
) > 400.0) {

1366 ià(
iıUpd©e
.
	`v¬
(2, 2è> 0.0 && 
	`çbs
(
dh
è> 
	`DEG2RAD
(15.0)) {

1371 
ã©u»Di¡ªû
 = 0.0;

1372 
numF—tu»s
 = 
f‹»dF—tu»s
.
	`size
();

1373 
i
 = 0; i < 
f‹»dF—tu»s
.
	`size
(); i++) {

1374 
ã©u»Di¡ªû
 +ğ
f‹»dF—tu»s
[
i
].
	`di¡ªû
();

1377 
numF—tu»s
 +ğ
¡ubPo¡s
.
	`size
();

1378 
i
 = 0; i < 
¡ubPo¡s
.
	`size
(); i++) {

1379 
ã©u»Di¡ªû
 +ğ
¡ubPo¡s
[
i
].
¼
.
	`di¡ªû
();

1382 ià(
numF—tu»s
 == 0) {

1383 
ã©u»Di¡ªû
 = 0.0;

1385 
ã©u»Di¡ªû
 /ğ
numF—tu»s
;

1388 
V¬ŸnûProvid”
 
v¬ŸnûProvid”
 = V¬ŸnûProvid”::
	`š¡ªû
();

1389 
V¬ŸnûProvid”
::
Ob£rv©iÚ
 
	`ob£rv©iÚ
(
ã©u»Di¡ªû
, 0.0);

1392 
iıDi¡ªûV¬Ÿnû
 =

1393 
v¬ŸnûProvid”
.
	`g‘Di¡ªûOb£rv©iÚV¬Ÿnû
(
V¬ŸnûProvid”
::
GOALPOST
, 
ob£rv©iÚ
) *

1394 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(Loÿli§tiÚCÚ¡ªtsProvid”::
ICP_DISTANCE_VARIANCE_SCALE
);

1395 
iıH—dšgV¬Ÿnû
 =

1396 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(Loÿli§tiÚCÚ¡ªtsProvid”::
ICP_HEADING_VARIANCE
);

1398 
numM—su»m’ts
 = 0;

1400 
uÄ–ŸbËDi¡ªûSÿË
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

1401 
Loÿli§tiÚCÚ¡ªtsProvid”
::
UNRELIABLE_DISTANCE_VARIANCE_SCALE
);

1402 
uÄ–ŸbËH—dšgSÿË
 = 
Loÿli§tiÚCÚ¡ªtsProvid”
::
	`š¡ªû
().
	`g‘
(

1403 
Loÿli§tiÚCÚ¡ªtsProvid”
::
UNRELIABLE_HEADING_VARIANCE_SCALE
);

1405 ià(
iıUpd©e
.
	`v¬
(0, 0) > 0.0) {

1406 
m—su»m’t
 = 
cu¼’tM—su»m’t
 + 
numM—su»m’ts
;

1407 
	`šnov©iÚOut
(
m—su»m’t
, 0èğ
dx
;

1408 
	`jacobŸnOut
(
m—su»m’t
, 
ROBOT_X_DIM
) = 1.0;

1409 
	`ob£rv©iÚV¬ŸnûOut
(
m—su»m’t
, m—su»m’tèğ
iıDi¡ªûV¬Ÿnû
;

1410 ià(!
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

1411 
	`ob£rv©iÚV¬ŸnûOut
(
m—su»m’t
, m—su»m’tè*ğ
uÄ–ŸbËDi¡ªûSÿË
;

1413 
numM—su»m’ts
++;

1416 ià(
iıUpd©e
.
	`v¬
(1, 1) > 0.0) {

1417 
m—su»m’t
 = 
cu¼’tM—su»m’t
 + 
numM—su»m’ts
;

1418 
	`šnov©iÚOut
(
m—su»m’t
, 0èğ
dy
;

1419 
	`jacobŸnOut
(
m—su»m’t
, 
ROBOT_Y_DIM
) = 1.0;

1420 
	`ob£rv©iÚV¬ŸnûOut
(
m—su»m’t
, m—su»m’tèğ
iıDi¡ªûV¬Ÿnû
;

1421 ià(!
visiÚBundË
.
isDi¡ªûR–ŸbË
) {

1422 
	`ob£rv©iÚV¬ŸnûOut
(
m—su»m’t
, m—su»m’tè*ğ
uÄ–ŸbËDi¡ªûSÿË
;

1424 
numM—su»m’ts
++;

1427 ià(
iıUpd©e
.
	`v¬
(2, 2) > 0.0) {

1428 
m—su»m’t
 = 
cu¼’tM—su»m’t
 + 
numM—su»m’ts
;

1429 
	`šnov©iÚOut
(
m—su»m’t
, 0èğ
dh
;

1430 
	`jacobŸnOut
(
m—su»m’t
, 
ROBOT_H_DIM
) = 1.0;

1431 
	`ob£rv©iÚV¬ŸnûOut
(
m—su»m’t
, m—su»m’tèğ
iıH—dšgV¬Ÿnû
;

1432 ià(!
visiÚBundË
.
isH—dšgR–ŸbË
) {

1433 
	`ob£rv©iÚV¬ŸnûOut
(
m—su»m’t
, m—su»m’tè*ğ
uÄ–ŸbËH—dšgSÿË
;

1435 
numM—su»m’ts
++;

1438  
cu¼’tM—su»m’t
 + 
numM—su»m’ts
;

1439 
	}
}

1441 
	gSim¶eGaussŸn
::
	$upd©eM—nVeùÜW™hOdom‘ry
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

1442 
Odom‘ryUpd©eResuÉ
 &
outOdom‘ryUpd©eResuÉ
) {

1445 
dx
 = 
odom‘ry
.
fÜw¬d
*
	`cos
(
	`m—n
(
ROBOT_H_DIM
, 0)è- odom‘ry.
Ëá
*
	`sš
(mean(ROBOT_H_DIM, 0));

1446 
dy
 = 
odom‘ry
.
fÜw¬d
*
	`sš
(
	`m—n
(
ROBOT_H_DIM
, 0)è+ odom‘ry.
Ëá
*
	`cos
(mean(ROBOT_H_DIM, 0));

1449 
	`m—n
(
ROBOT_H_DIM
, 0èğ
	`nÜm®i£Th‘a
(m—n(ROBOT_H_DIM, 0è+ 
odom‘ry
.
tuº
);

1451 
	`m—n
(
ROBOT_X_DIM
, 0è+ğ
dx
;

1452 
	`m—n
(
ROBOT_Y_DIM
, 0è+ğ
dy
;

1455 ià(!
došgB®lLšeUp
) {

1456 
	`m—n
(
BALL_X_DIM
, 0è+ğm—n(
BALL_DX_DIM
, 0è* 
dTimeSecÚds
;

1457 
	`m—n
(
BALL_Y_DIM
, 0è+ğm—n(
BALL_DY_DIM
, 0è* 
dTimeSecÚds
;

1461 cÚ¡ 
äiùiÚModuÏtiÚ
 = 
	`pow
(
cÚ¡ªtsProvid”
.
	`g‘
(

1462 
Loÿli§tiÚCÚ¡ªtsProvid”
::
BALL_FRICTION
), 
dTimeSecÚds
);

1463 
	`m—n
(
BALL_DX_DIM
, 0è*ğ
äiùiÚModuÏtiÚ
;

1464 
	`m—n
(
BALL_DY_DIM
, 0è*ğ
äiùiÚModuÏtiÚ
;

1466 
outOdom‘ryUpd©eResuÉ
.
dx
 = dx;

1467 
outOdom‘ryUpd©eResuÉ
.
dy
 = dy;

1468 
outOdom‘ryUpd©eResuÉ
.
dh
 = 
odom‘ry
.
tuº
;

1470 
	`§n™yCheck
();

1471 
	}
}

1473 
	gSim¶eGaussŸn
::
	$upd©eCov¬ŸnûW™hOdom‘ry
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

1474 cÚ¡ 
boŞ
 
ÿnS“B®l
, 
Odom‘ryUpd©eResuÉ
 &
outOdom‘ryUpd©eResuÉ
) {

1475 
	`´oûssUpd©eCov¬ŸnûM©rix
(
odom‘ry
, 
dTimeSecÚds
);

1478 
	`add™iveProûssNoi£Upd©eCov¬ŸnûM©rix
(
odom‘ry
, 
dTimeSecÚds
, 
ÿnS“B®l
, 
outOdom‘ryUpd©eResuÉ
);

1479 
	}
}

1481 
	gSim¶eGaussŸn
::
	$upd©eM—nVeùÜW™hRemÙeOdom‘ry
(

1482 cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
, 
‹amm©eIndex
) {

1483 cÚ¡ 
po£XIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_X_DIM
);

1484 cÚ¡ 
po£YIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_Y_DIM
);

1485 cÚ¡ 
po£HIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_H_DIM
);

1487 
	`m—n
(
po£XIndex
, 0è+ğ
upd©eBundË
.
sh¬edDx
;

1488 
	`m—n
(
po£YIndex
, 0è+ğ
upd©eBundË
.
sh¬edDy
;

1489 
	`m—n
(
po£HIndex
, 0è+ğ
upd©eBundË
.
sh¬edDh
;

1490 
	}
}

1492 
	gSim¶eGaussŸn
::
	$upd©eCov¬ŸnûW™hRemÙeOdom‘ry
(

1493 cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
, 
‹amm©eIndex
) {

1494 
	`MY_ASSERT
(
DIM
 =ğ
MAIN_DIM
, "update covariance with odometry unexpected dim");

1496 cÚ¡ 
po£XIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_X_DIM
);

1497 cÚ¡ 
po£YIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_Y_DIM
);

1498 cÚ¡ 
po£HIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_H_DIM
);

1500 cÚ¡ 
unû¹aštySÿË
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1501 
Loÿli§tiÚCÚ¡ªtsProvid”
::
TEAMMATE_ODOMETRY_UNCERTAINTY_SCALE
);

1503 
	`cov¬Ÿnû
(
po£XIndex
,…o£XIndexè+ğ
upd©eBundË
.
sh¬edCov¬ŸnûDx
 * 
unû¹aštySÿË
;

1504 
	`cov¬Ÿnû
(
po£YIndex
,…o£YIndexè+ğ
upd©eBundË
.
sh¬edCov¬ŸnûDy
 * 
unû¹aštySÿË
;

1505 
	`cov¬Ÿnû
(
po£HIndex
,…o£HIndexè+ğ
upd©eBundË
.
sh¬edCov¬ŸnûDh
 * 
unû¹aštySÿË
;

1506 
	}
}

1509 
	gSim¶eGaussŸn
::
	$´oûssUpd©eCov¬ŸnûM©rix
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
) {

1510 cÚ¡ 
äiùiÚModuÏtiÚ
 = 
	`pow
(
cÚ¡ªtsProvid”
.
	`g‘
(

1511 
Loÿli§tiÚCÚ¡ªtsProvid”
::
BALL_FRICTION
), 
dTimeSecÚds
);

1513 
u£B®lV–oc™y
 = 
došgB®lLšeUp
 ? 0.0 : 1.0;

1514 
cŞ
 = 0; cŞ < 
DIM
; col++) {

1515 
	`cov¬Ÿnû
(
cŞ
, 
BALL_X_DIM
è+ğcov¬Ÿnû(cŞ, 
BALL_DX_DIM
è* 
dTimeSecÚds
 * 
u£B®lV–oc™y
;

1516 
	`cov¬Ÿnû
(
cŞ
, 
BALL_Y_DIM
è+ğcov¬Ÿnû(cŞ, 
BALL_DY_DIM
è* 
dTimeSecÚds
 * 
u£B®lV–oc™y
;

1517 
	`cov¬Ÿnû
(
cŞ
, 
BALL_DX_DIM
è*ğ
äiùiÚModuÏtiÚ
;

1518 
	`cov¬Ÿnû
(
cŞ
, 
BALL_DY_DIM
è*ğ
äiùiÚModuÏtiÚ
;

1521 
row
 = 0;„ow < 
DIM
;„ow++) {

1522 
	`cov¬Ÿnû
(
BALL_X_DIM
, 
row
è+ğcov¬Ÿnû(
BALL_DX_DIM
,„owè* 
dTimeSecÚds
 * 
u£B®lV–oc™y
;

1523 
	`cov¬Ÿnû
(
BALL_Y_DIM
, 
row
è+ğcov¬Ÿnû(
BALL_DY_DIM
,„owè* 
dTimeSecÚds
 * 
u£B®lV–oc™y
;

1524 
	`cov¬Ÿnû
(
BALL_DX_DIM
, 
row
è*ğ
äiùiÚModuÏtiÚ
;

1525 
	`cov¬Ÿnû
(
BALL_DY_DIM
, 
row
è*ğ
äiùiÚModuÏtiÚ
;

1527 
	}
}

1529 
	gSim¶eGaussŸn
::
	$add™iveProûssNoi£Upd©eCov¬ŸnûM©rix
(

1530 cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
, cÚ¡ 
boŞ
 
ÿnS“B®l
,

1531 
Odom‘ryUpd©eResuÉ
 &
outOdom‘ryUpd©eResuÉ
) {

1532 
dx
 = 
odom‘ry
.
fÜw¬d
*
	`cos
(
	`m—n
(
ROBOT_H_DIM
, 0)è- odom‘ry.
Ëá
*
	`sš
(mean(ROBOT_H_DIM, 0));

1533 
dy
 = 
odom‘ry
.
fÜw¬d
*
	`sš
(
	`m—n
(
ROBOT_H_DIM
, 0)è+ odom‘ry.
Ëá
*
	`cos
(mean(ROBOT_H_DIM, 0));

1534 
dh
 = 
	`çbs
(
odom‘ry
.
tuº
);

1537 
rPosA
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1538 
Loÿli§tiÚCÚ¡ªtsProvid”
::
ROBOT_POS_MOTION_UPDATE_COVARIANCE_A
);

1539 
rPosC
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1540 
Loÿli§tiÚCÚ¡ªtsProvid”
::
ROBOT_POS_MOTION_UPDATE_COVARIANCE_C
);

1541 
outOdom‘ryUpd©eResuÉ
.
covDx
 = 
rPosA
*
dx
*dx;

1542 
outOdom‘ryUpd©eResuÉ
.
covDy
 = 
rPosA
*
dy
*dy;

1543 
	`cov¬Ÿnû
(
ROBOT_X_DIM
, ROBOT_X_DIMè+ğ
outOdom‘ryUpd©eResuÉ
.
covDx
 + 
rPosC
*
dTimeSecÚds
;

1544 
	`cov¬Ÿnû
(
ROBOT_Y_DIM
, ROBOT_Y_DIMè+ğ
outOdom‘ryUpd©eResuÉ
.
covDy
 + 
rPosC
*
dTimeSecÚds
;

1547 
rH—dšgA
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1548 
Loÿli§tiÚCÚ¡ªtsProvid”
::
ROBOT_HEADING_MOTION_UPDATE_COVARIANCE_A
);

1549 
rH—dšgC
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1550 
Loÿli§tiÚCÚ¡ªtsProvid”
::
ROBOT_HEADING_MOTION_UPDATE_COVARIANCE_C
);

1551 
outOdom‘ryUpd©eResuÉ
.
covDh
 = 
rH—dšgA
*
dh
*dh;

1552 
	`cov¬Ÿnû
(
ROBOT_H_DIM
, ROBOT_H_DIMè+ğ
outOdom‘ryUpd©eResuÉ
.
covDh
 + 
rH—dšgC
*
dTimeSecÚds
;

1555 ià(
DIM
 =ğ
MAIN_DIM
) {

1556 cÚ¡ 
unû¹aštySÿË
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1557 
Loÿli§tiÚCÚ¡ªtsProvid”
::
TEAMMATE_ODOMETRY_UNCERTAINTY_SCALE
);

1559 
‹amm©eIndex
 = 0;—mm©eIndex < 
NUM_TEAMMATES
;eammateIndex++) {

1560 cÚ¡ 
po£XIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_X_DIM
);

1561 cÚ¡ 
po£YIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_Y_DIM
);

1562 cÚ¡ 
po£HIndex
 = 
	`g‘T—mm©eIndex
(
‹amm©eIndex
, 
ROBOT_H_DIM
);

1564 
	`cov¬Ÿnû
(
po£XIndex
,…o£XIndexè+ğ
unû¹aštySÿË
*
rPosC
*
dTimeSecÚds
;

1565 
	`cov¬Ÿnû
(
po£YIndex
,…o£YIndexè+ğ
unû¹aštySÿË
*
rPosC
*
dTimeSecÚds
;

1566 
	`cov¬Ÿnû
(
po£HIndex
,…o£HIndexè+ğ
unû¹aštySÿË
*
rH—dšgC
*
dTimeSecÚds
;

1572 
boŞ
 
b®lOffF›ld
 =

1573 
	`m—n
(
BALL_X_DIM
, 0è< -
FIELD_X_CLIP
 ||

1574 
	`m—n
(
BALL_Y_DIM
, 0è< -
FIELD_Y_CLIP
 ||

1575 
	`m—n
(
BALL_X_DIM
, 0è> 
FIELD_X_CLIP
 ||

1576 
	`m—n
(
BALL_Y_DIM
, 0è> 
FIELD_Y_CLIP
;

1579 
bPosC
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1580 
Loÿli§tiÚCÚ¡ªtsProvid”
::
BALL_POS_MOTION_UPDATE_COVARIANCE_C
);

1581 
bV–C
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1582 
Loÿli§tiÚCÚ¡ªtsProvid”
::
BALL_VEL_MOTION_UPDATE_COVARIANCE_C
);

1584 ià(!
ÿnS“B®l
 || 
b®lOffF›ld
) {

1585 
bPosC
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1586 
Loÿli§tiÚCÚ¡ªtsProvid”
::
BALL_UNSEEN_POS_MOTION_UPDATE_COVARIANCE_C
);

1587 } ià(
došgB®lLšeUp
) {

1588 
bPosC
 = 
cÚ¡ªtsProvid”
.
	`g‘
(

1589 
Loÿli§tiÚCÚ¡ªtsProvid”
::
BALL_POS_MOTION_UPDATE_LINE_UP_COVARIANCE_C
);

1592 
	`cov¬Ÿnû
(
BALL_X_DIM
, BALL_X_DIMè+ğ
bPosC
 * 
dTimeSecÚds
;

1593 
	`cov¬Ÿnû
(
BALL_Y_DIM
, BALL_Y_DIMè+ğ
bPosC
 * 
dTimeSecÚds
;

1596 
	`cov¬Ÿnû
(
BALL_DX_DIM
, BALL_DX_DIMè+ğ
bV–C
 * 
dTimeSecÚds
;

1597 
	`cov¬Ÿnû
(
BALL_DY_DIM
, BALL_DY_DIMè+ğ
bV–C
 * 
dTimeSecÚds
;

1598 
	}
}

1600 
boŞ
 
	gSim¶eGaussŸn
::
	$gßl›Upd©eDi§g»es
(cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
) const {

1601 
symm‘ricYDi¡ªû
 =

1602 
	`çbs
(
upd©eBundË
.
	`sh¬edUpd©eM—n
(
BALL_Y_DIM
, 0è+ 
	`m—n
(BALL_Y_DIM, 0));

1604  
upd©eBundË
.
b®lS“nF¿ùiÚ
 >= 0.75f &&

1605 
	`m—n
(
BALL_X_DIM
, 0) > 1500.0 &&

1606 
upd©eBundË
.
	`sh¬edUpd©eM—n
(
BALL_X_DIM
, 0) < -1500.0 &&

1607 
symm‘ricYDi¡ªû
 < 1000.0;

1608 
	}
}

1610 
boŞ
 
	gSim¶eGaussŸn
::
	$isB®lTooClo£FÜRemÙeUpd©e
() const {

1611 
dx
 = 
	`m—n
(
BALL_X_DIM
, 0è- m—n(
ROBOT_X_DIM
, 0);

1612 
dy
 = 
	`m—n
(
BALL_Y_DIM
, 0è- m—n(
ROBOT_Y_DIM
, 0);

1614  
	`sq¹
(
dx
*dx + 
dy
*dy) < 500.0;

1615 
	}
}

1617 
	gSim¶eGaussŸn
::
	$şToF›ld
(
Eig’
::
M©rixXd
 &
po£
) {

1618 
	`po£
(
ROBOT_X_DIM
, 0èğ
üİ
<>Õo£(ROBOT_X_DIM, 0), -
FIELD_X_CLIP
, FIELD_X_CLIP);

1619 
	`po£
(
ROBOT_Y_DIM
, 0èğ
üİ
<>Õo£(ROBOT_Y_DIM, 0), -
FIELD_Y_CLIP
, FIELD_Y_CLIP);

1621 
	`po£
(
BALL_X_DIM
, 0èğ
üİ
<>Õo£(BALL_X_DIM, 0), -
FIELD_X_CLIP
, FIELD_X_CLIP);

1622 
	`po£
(
BALL_Y_DIM
, 0èğ
üİ
<>Õo£(BALL_Y_DIM, 0), -
FIELD_Y_CLIP
, FIELD_Y_CLIP);

1624 
	`po£
(
BALL_DX_DIM
, 0èğ
üİ
<>Õo£(BALL_DX_DIM, 0), -
MAX_BALL_VELOCITY
, MAX_BALL_VELOCITY);

1625 
	`po£
(
BALL_DY_DIM
, 0èğ
üİ
<>Õo£(BALL_DY_DIM, 0), -
MAX_BALL_VELOCITY
, MAX_BALL_VELOCITY);

1626 
	}
}

1628 
	gSim¶eGaussŸn
::
	$şB®lOutOfRobÙ
(
Eig’
::
M©rixXd
 &
po£
) {

1629 cÚ¡ 
MIN_BALL_ROBOT_DIST
 = 10.0;

1631 
toB®lX
 = 
	`po£
(
BALL_X_DIM
, 0è-…o£(
ROBOT_X_DIM
, 0);

1632 
toB®lY
 = 
	`po£
(
BALL_Y_DIM
, 0è-…o£(
ROBOT_Y_DIM
, 0);

1633 
toB®lL’gth
 = 
	`sq¹
(
toB®lX
*toB®lX + 
toB®lY
*toBallY);

1636 ià(
toB®lL’gth
 < 
MIN_BALL_ROBOT_DIST
) {

1637 ià(
toB®lL’gth
 < 
EPSILON
) {

1638 
toB®lX
 = 1.0;

1639 
toB®lY
 = 0.0;

1640 
toB®lL’gth
 = 1.0;

1643 
	`po£
(
BALL_X_DIM
, 0èğpo£(
ROBOT_X_DIM
, 0è+ 
MIN_BALL_ROBOT_DIST
 * 
toB®lX
 / 
toB®lL’gth
;

1644 
	`po£
(
BALL_Y_DIM
, 0èğpo£(
ROBOT_Y_DIM
, 0è+ 
MIN_BALL_ROBOT_DIST
 * 
toB®lY
 / 
toB®lL’gth
;

1646 
	`po£
(
BALL_DX_DIM
, 0) = 0.0;

1647 
	`po£
(
BALL_DY_DIM
, 0) = 0.0;

1649 
	}
}

1651 
boŞ
 
	gSim¶eGaussŸn
::
	$isS‹V®id
() const {

1652 ià(
weight
 < 0.0 || weighˆ> 1.0 || weighˆ!ğweighˆ|| !
¡d
::
	`isfš™e
(weight)) {

1653 
¡d
::
cout
 << "weighˆçed: " << 
weight
 << std::
’dl
;

1654  
çl£
;

1657 
i
 = 0; i < 
m—n
.
	`rows
(); i++) {

1658 ià(
	`m—n
(
i
, 0è!ğm—n(i, 0è|| !
¡d
::
	`isfš™e
(mean(i, 0))) {

1659 
¡d
::
cout
 << "m—Àçed: " << 
m—n
 << std::
’dl
;

1660  
çl£
;

1664 
i
 = 0; i < 
cov¬Ÿnû
.
	`rows
(); i++) {

1665 
j
 = 0; j < 
cov¬Ÿnû
.
	`cŞs
(); j++) {

1666 ià(
	`cov¬Ÿnû
(
i
, 
j
è!ğcov¬Ÿnû(i, jè|| !
¡d
::
	`isfš™e
(covariance(i, j))) {

1667 
¡d
::
cout
 << "cov¬Ÿnû faed: " << 
	`cov¬Ÿnû
(
i
, 
j
è<< std::
’dl
;

1668  
çl£
;

1673  
Œue
;

1674 
	}
}

1676 
AbsCoÜd
 
	gSim¶eGaussŸn
::
	$g‘P’®tySpÙPos™iÚ
() {

1677 ià(
	`m—n
(
ROBOT_X_DIM
, 0è> 
FIELD_LENGTH
 / 5) {

1678  
	`AbsCoÜd
(
MARKER_CENTER_X
, 0.0, 0.0);

1680  
	`AbsCoÜd
(-
MARKER_CENTER_X
, 0.0, 0.0);

1682 
	}
}

1684 
boŞ
 
	gSim¶eGaussŸn
::
	$ÿnOb£rveP’®tySpÙ
() {

1685  (
	`m—n
(
ROBOT_X_DIM
, 0è> 
FIELD_LENGTH
/5.0) || (mean(ROBOT_X_DIM, 0) < -FIELD_LENGTH/5.0);

1686 
	}
}

1688 
	gSim¶eGaussŸn
::
	$g‘NÚZ”o
(
v®
) {

1689 ià(
v®
 >ğ0.0 && v® < 
EPSILON
) {

1690  
EPSILON
;

1691 } ià(
v®
 <ğ0.0 && v® > -
EPSILON
) {

1692  -
EPSILON
;

1694  
v®
;

1696 
	}
}

1698 
AbsCoÜd
 
	gSim¶eGaussŸn
::
	$g‘GßÍo¡Pos™iÚ
(
Po¡Ty³
 
ty³
) {

1699 
ty³
) {

1700 
MY_LEFT
:

1701  
	`AbsCoÜd
(-
GOAL_POST_ABS_X
, -
GOAL_POST_ABS_Y
, 0.0);

1702 
MY_RIGHT
:

1703  
	`AbsCoÜd
(-
GOAL_POST_ABS_X
, 
GOAL_POST_ABS_Y
, 0.0);

1704 
OPPONENT_LEFT
:

1705  
	`AbsCoÜd
(
GOAL_POST_ABS_X
, 
GOAL_POST_ABS_Y
, 0.0);

1706 
OPPONENT_RIGHT
:

1707  
	`AbsCoÜd
(
GOAL_POST_ABS_X
, -
GOAL_POST_ABS_Y
, 0.0);

1709 
	}
}

	@robot/perception/localisation/SimpleGaussian.hpp

32 #´agm¨
Úû


34 
	~"GaussŸnUpd©eDebugD©a.hµ
"

35 
	~"Po¡Ty³.hµ
"

36 
	~"Ob£rvedPo¡sHi¡Üy.hµ
"

37 
	~"Sh¬edLoÿli§tiÚUpd©eBundË.hµ
"

38 
	~"VisiÚUpd©eBundË.hµ
"

39 
	~"V¬ŸnûProvid”.hµ
"

40 
	~"ICP.hµ
"

41 
	~"Loÿli§tiÚDefs.hµ
"

42 
	~"ty³s/AbsCoÜd.hµ
"

43 
	~"ty³s/Odom‘ry.hµ
"

45 
	~<ÿs£¹
>

46 
	~<Eig’/Eig’
>

56 
	sUniMod®VisiÚUpd©e
 {

57 
UniMod®VisiÚUpd©e
() {}

59 
UniMod®VisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
);

61 
UniMod®VisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

62 cÚ¡ 
Po¡Ty³
 &
po¡Ty³
);

64 
UniMod®VisiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

65 cÚ¡ 
¡d
::
veùÜ
<
Po¡Ty³
> &
po¡Ty³s
);

67 
VisiÚUpd©eBundË
 
	mvisiÚBundË
;

68 
	m¡d
::
veùÜ
<
Po¡Ty³
> 
po¡Ty³s
;

72 
	sUniMod®T—mm©eUpd©e
 {

73 
UniMod®T—mm©eUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

74 cÚ¡ 
¡d
::
veùÜ
<
RobÙInfo
> &
‹amm©eRobÙs
, cÚ¡ 
AbsCoÜd
 &
‹amm©ePos™iÚ
);

76 
UniMod®T—mm©eUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

77 cÚ¡ 
¡d
::
veùÜ
<
RobÙInfo
> &
‹amm©eRobÙs
, cÚ¡ std::veùÜ<
AbsCoÜd
> &
‹amm©ePos™iÚs
);

79 
VisiÚUpd©eBundË
 
	mvisiÚBundË
;

80 
	m¡d
::
veùÜ
<
RobÙInfo
> 
‹amm©eRobÙs
;

81 
	m¡d
::
veùÜ
<
AbsCoÜd
> 
‹amm©ePos™iÚs
;

85 
	sStÜedICPUpd©e
 {

86 
StÜedICPUpd©e
(è: 
upd©eDim’siÚ
(0) {}

88 
StÜedICPUpd©e
(
upd©eDim’siÚ
, cÚ¡ 
Eig’
::
M©rixXd
 &
šnov©iÚ
,

89 cÚ¡ 
Eig’
::
M©rixXd
 &
jacobŸn
, cÚ¡ Eig’::M©rixXd &
ob£rv©iÚV¬Ÿnû
) :

90 
upd©eDim’siÚ
(upd©eDim’siÚ), 
šnov©iÚ
(innovation),

91 
jacobŸn
(jacobŸn), 
ob£rv©iÚV¬Ÿnû
(observationVariance) {}

93 
	mupd©eDim’siÚ
;

94 
	mEig’
::
M©rixXd
 
šnov©iÚ
;

95 
	mEig’
::
M©rixXd
 
jacobŸn
;

96 
	mEig’
::
M©rixXd
 
ob£rv©iÚV¬Ÿnû
;

100 
	sOdom‘ryUpd©eResuÉ
 {

101 
	mdx
, 
	mdy
, 
	mdh
;

102 
	mcovDx
, 
	mcovDy
, 
	mcovDh
;

111 şas 
	cSim¶eGaussŸn
 {

112 
	mpublic
:

118 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
ü—‹Ba£lšeGaussŸns
();

119 
Sim¶eGaussŸn
* 
ü—‹Ba£lšeSh¬edGaussŸn
();

124 
»£tM—n
(cÚ¡ 
Eig’
::
M©rixXd
 &
¤c
);

129 
»£tCov¬Ÿnû
(cÚ¡ 
Eig’
::
M©rixXd
 &
¤c
);

137 
£tLšeUpMode
(
boŞ
 
’abËd
);

143 
£tR—dyMode
(
boŞ
 
’abËd
);

148 
Odom‘ryUpd©eResuÉ
 
´oûssUpd©e
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

149 cÚ¡ 
boŞ
 
ÿnS“B®l
);

155 
	m¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
visiÚUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
);

156 
	m¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
visiÚT—mm©eRobÙsUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
);

158 
doICPUpd©e
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
, cÚ¡ 
boŞ
 
upd©eWeight
);

160 
uniMod®VisiÚUpd©e
(cÚ¡ 
UniMod®VisiÚUpd©e
 &
vu
);

161 
uniMod®T—mm©eRobÙVisiÚUpd©e
(cÚ¡ 
UniMod®T—mm©eUpd©e
 &
vu
);

163 
	m¡d
::
veùÜ
<
Sim¶eGaussŸn
*> 
­¶yRemÙeUpd©e
(cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
,

164 
‹amm©eIndex
, 
boŞ
 
amGßl›
);

166 
­¶yOb£rv©iÚ
(
obsDim’siÚ
, cÚ¡ 
Eig’
::
M©rixXd
 &
šnov©iÚ
,

167 cÚ¡ 
Eig’
::
M©rixXd
 &
jacobŸn
, cÚ¡ Eig’::M©rixXd &
ob£rv©iÚV¬Ÿnû
,

168 cÚ¡ 
boŞ
 
upd©eWeight
);

173 
AbsCoÜd
 
	$g‘RobÙPo£
() const;

178 
AbsCoÜd
 
	$g‘B®lPos™iÚ
() const;

183 
AbsCoÜd
 
	$g‘B®lV–oc™y
() const;

189 
	$g‘RobÙPosUnû¹ašty
() const;

194 
	$g‘RobÙH—dšgUnû¹ašty
() const;

200 
	$g‘B®lPosUnû¹ašty
() const;

206 
	$g‘B®lV–oc™yUnû¹ašty
() const;

212 
boŞ
 
	$isSim¬To
(cÚ¡ 
Sim¶eGaussŸn
 &
Ùh”
) const;

217 
	`m”geW™h
(
Sim¶eGaussŸn
 &
Ùh”
);

219 
	$g‘Weight
() const;

220 
	`£tWeight
(
weight
);

222 
boŞ
 
	$g‘HaveLa¡VisiÚUpd©e
() const;

224 
StÜedICPUpd©e
 
	$g‘La¡Aµl›dICPUpd©e
() const;

225 
UniMod®VisiÚUpd©e
 
	$g‘La¡Aµl›dVisiÚUpd©e
() const;

227 
Eig’
::
M©rixXd
 
	$g‘M—n
() const;

228 
Eig’
::
M©rixXd
 
	$g‘Cov¬Ÿnû
() const;

230 
	$§n™yCheck
() const;

235 
Sim¶eGaussŸn
* 
	`ü—‹Symm‘ricGaussŸn
();

241 
	`Sim¶eGaussŸn
(

242 cÚ¡ 
dim
,

243 cÚ¡ 
weight
,

244 cÚ¡ 
Eig’
::
M©rixXd
 &
m—n
,

245 cÚ¡ 
Eig’
::
M©rixXd
 &
dŸgÚ®V¬Ÿnû
);

250 
Sim¶eGaussŸn
* 
	`ü—‹S¶™GaussŸn
();

252 
´iv©e
:

258 cÚ¡ 
DIM
;

259 cÚ¡ 
Eig’
::
M©rixXd
 
id’t™y
;

261 
weight
;

262 
Eig’
::
M©rixXd
 
m—n
;

263 
Eig’
::
M©rixXd
 
cov¬Ÿnû
;

265 
boŞ
 
došgB®lLšeUp
;

266 
boŞ
 
isInR—dyMode
;

267 
boŞ
 
haveLa¡VisiÚUpd©e
;

268 
UniMod®VisiÚUpd©e
 
Ï¡VisiÚUpd©e
;

269 
StÜedICPUpd©e
 
¡ÜedICPUpd©e
;

270 
Ob£rvedPo¡sHi¡Üy
 
ob£rvedPo¡sHi¡Üy
;

274 
	`Sim¶eGaussŸn
(

275 cÚ¡ 
dim
,

276 cÚ¡ 
weight
,

277 cÚ¡ 
Eig’
::
M©rixXd
 &
m—n
,

278 cÚ¡ 
Eig’
::
M©rixXd
 &
cov¬Ÿnû
,

279 
boŞ
 
došgB®lLšeUp
,

280 
boŞ
 
isInR—dyMode
,

281 cÚ¡ 
Ob£rvedPo¡sHi¡Üy
 &
ob£rvedPo¡sHi¡Üy
);

283 
¡d
::
veùÜ
<
Po¡Info
> 
	`g‘ICPQu®™yPo¡s
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
);

285 
boŞ
 
	`ÿnU£Po¡Ty³
(
Po¡Ty³
 
ty³
, 
di¡ªû
);

286 
boŞ
 
	`ÿnU£Po¡Ty³
(
Po¡Ty³
 
ty³0
, 
di¡ªû0
, Po¡Ty³ 
ty³1
, 
di¡ªû1
);

287 
	`di¡ªûTo
(cÚ¡ 
AbsCoÜd
 &
coÜd
);

292 
boŞ
 
	`isH—dšgRow
(
row
);

298 
	`nÜm®i£Th‘a
(
th‘a
);

300 
	`addNoPo¡sOb£rv©iÚMode
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

301 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
outModes
);

302 
	`addOÃPo¡Ob£rv©iÚModes
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

303 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
outModes
);

304 
	`addTwoPo¡Ob£rv©iÚModes
(cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

305 
¡d
::
veùÜ
<
Sim¶eGaussŸn
*> &
outModes
);

307 
	`³rfÜmK®mªUpd©e
(

308 cÚ¡ 
ob£rv©iÚDim
,

309 cÚ¡ 
Eig’
::
M©rixXd
 &
šnov©iÚ
,

310 cÚ¡ 
Eig’
::
M©rixXd
 &
jacobŸn
,

311 cÚ¡ 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬Ÿnû
,

312 cÚ¡ 
boŞ
 
upd©eWeight
);

314 
	`³rfÜmTrimmedK®mªUpd©e
(

315 cÚ¡ 
Eig’
::
M©rixXd
 &
šnov©iÚ
,

316 cÚ¡ 
Eig’
::
M©rixXd
 &
jacobŸn
,

317 cÚ¡ 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬Ÿnû
,

318 cÚ¡ 
boŞ
 
isSh¬edUpd©e
,

319 cÚ¡ 
boŞ
 
upd©eWeight
);

321 
	`addGßlPo¡M—su»m’t
(

322 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

323 cÚ¡ 
RRCoÜd
 &
ob£rvedPo¡CoÜds
,

324 cÚ¡ 
AbsCoÜd
 &
po¡WÜldCoÜds
,

325 cÚ¡ 
boŞ
 
u£Di¡ªû
,

326 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

327 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

328 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

329 cÚ¡ 
cu¼’tM—su»m’t
);

331 
	`addF›ldF—tu»M—su»m’t
(

332 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

333 cÚ¡ 
AbsCoÜd
 &
f›ldF—tu»Pos™iÚ
,

334 cÚ¡ 
RRCoÜd
 &
ob£rvedC’ŒeCœşeCoÜds
,

335 cÚ¡ 
boŞ
 
u£Di¡ªû
,

336 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

337 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

338 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

339 cÚ¡ 
cu¼’tM—su»m’t
);

341 
	`addB®lM—su»m’t
(

342 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

343 cÚ¡ 
RRCoÜd
 &
ob£rvedB®lCoÜds
,

344 cÚ¡ 
boŞ
 
u£Di¡ªû
,

345 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

346 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

347 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

348 cÚ¡ 
cu¼’tM—su»m’t
);

350 
	`addT—mm©eM—su»m’t
(

351 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

352 cÚ¡ 
RRCoÜd
 &
ob£rvedRobÙCoÜds
,

353 cÚ¡ 
AbsCoÜd
 &
‹amm©ePos™iÚ
,

354 cÚ¡ 
boŞ
 
u£Di¡ªû
,

355 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

356 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

357 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

358 cÚ¡ 
cu¼’tM—su»m’t
);

360 
	`addG’”icM—su»m’t
(

361 cÚ¡ 
RRCoÜd
 &
ob£rvedObjeùCoÜds
,

362 cÚ¡ 
boŞ
 
u£Di¡ªû
,

363 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

364 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

365 cÚ¡ 
cu¼’tM—su»m’t
,

366 cÚ¡ 
dx
, cÚ¡ 
dy
);

368 
	`addOb£rv©iÚV¬Ÿnû
(

369 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

370 
V¬ŸnûProvid”
::
Ob£rv©iÚTy³
 
ty³
,

371 cÚ¡ 
RRCoÜd
 &
ob£rvedObjeù
,

372 
boŞ
 
u£Di¡ªû
,

373 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

374 cÚ¡ 
cu¼’tM—su»m’t
);

376 
	`³rfÜmICPUpd©e
(

377 cÚ¡ 
VisiÚUpd©eBundË
 &
visiÚBundË
,

378 
Eig’
::
M©rixXd
 &
šnov©iÚOut
,

379 
Eig’
::
M©rixXd
 &
jacobŸnOut
,

380 
Eig’
::
M©rixXd
 &
ob£rv©iÚV¬ŸnûOut
,

381 cÚ¡ 
cu¼’tM—su»m’t
,

382 cÚ¡ 
boŞ
 
haveKeyICPF—tu»s
);

384 
	`upd©eM—nVeùÜW™hOdom‘ry
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

385 
Odom‘ryUpd©eResuÉ
 &
outOdom‘ryUpd©eResuÉ
);

386 
	`upd©eCov¬ŸnûW™hOdom‘ry
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

387 cÚ¡ 
boŞ
 
ÿnS“B®l
, 
Odom‘ryUpd©eResuÉ
 &
outOdom‘ryUpd©eResuÉ
);

389 
	`upd©eM—nVeùÜW™hRemÙeOdom‘ry
(cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
, 
‹amm©eIndex
);

390 
	`upd©eCov¬ŸnûW™hRemÙeOdom‘ry
(cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
, 
‹amm©eIndex
);

392 
	`´oûssUpd©eCov¬ŸnûM©rix
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
);

393 
	`add™iveProûssNoi£Upd©eCov¬ŸnûM©rix
(cÚ¡ 
Odom‘ry
 &
odom‘ry
, cÚ¡ 
dTimeSecÚds
,

394 cÚ¡ 
boŞ
 
ÿnS“B®l
, 
Odom‘ryUpd©eResuÉ
 &
outOdom‘ryUpd©eResuÉ
);

396 
	`şToF›ld
(
Eig’
::
M©rixXd
 &
po£
);

397 
	`şB®lOutOfRobÙ
(
Eig’
::
M©rixXd
 &
po£
);

399 
boŞ
 
	$isS‹V®id
() const;

401 
boŞ
 
	$gßl›Upd©eDi§g»es
(cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
upd©eBundË
) const;

402 
boŞ
 
	$isB®lTooClo£FÜRemÙeUpd©e
() const;

404 
AbsCoÜd
 
	`g‘P’®tySpÙPos™iÚ
();

405 
boŞ
 
	`ÿnOb£rveP’®tySpÙ
();

411 
	`g‘NÚZ”o
(
v®
);

413 
AbsCoÜd
 
	`g‘GßÍo¡Pos™iÚ
(
Po¡Ty³
 
ty³
);

	@robot/perception/localisation/TeamBallTracker.cpp

8 
	~"T—mB®lT¿ck”.hµ
"

9 
	~<cm©h
>

11 cÚ¡ 
	gBALL_CERTAINTY_DAMPING
 = 0.5;

12 cÚ¡ 
	gMIN_CERTAINTY_TO_FLIP
 = 0.75;

13 cÚ¡ 
	gMAX_BALL_DISTANCE_MATCH
 = 1000.0;

14 cÚ¡ 
	gMIN_BALL_CENTRE_DISTANCE
 = 1500.0;

16 
	gT—mm©eB®lS‹
::
	$T—mm©eB®lS‹
() {

17 
b®lC”šty
 = 0.0;

18 
b®lPos™iÚ
 = 
	`AbsCoÜd
(0.0, 0.0, 0.0);

19 
Ï¡Upd©eAge
 = 0;

20 
	}
}

22 
	gT—mB®lT¿ck”
::
	$T—mB®lT¿ck”
(
p
è: 
	$¶ay”Numb”
(
p
) {

24 
	}
}

26 
T—mB®lT¿ck”
::
	$deÿy
() {

27 
i
 = 0; i < 
NUM_PLAYERS_ON_TEAM
; i++) {

28 
‹amm©eB®lS‹
[
i
].
Ï¡Upd©eAge
++;

30 
	}
}

32 
	gT—mB®lT¿ck”
::
	$addT—mm©eOb£rv©iÚ
(cÚ¡ 
Brßdÿ¡D©a
 &
brßdÿ¡D©a
) {

33 
šdex
 = 
brßdÿ¡D©a
.
¶ay”Num
 - 1;

34 ià(
brßdÿ¡D©a
.
¶ay”Num
 > 
¶ay”Numb”
è
šdex
--;

35 
b®lS“nF¿ùiÚ
 = 
brßdÿ¡D©a
.
sh¬edLoÿli§tiÚBundË
.ballSeenFraction;

37 
‹amm©eB®lS‹
[
šdex
].
b®lC”šty
 =

38 
BALL_CERTAINTY_DAMPING
 * 
‹amm©eB®lS‹
[
šdex
].
b®lC”šty
 +

39 (1.0 - 
BALL_CERTAINTY_DAMPING
è* 
b®lS“nF¿ùiÚ
;

41 
‹amm©eB®lS‹
[
šdex
].
b®lPos™iÚ
 = 
brßdÿ¡D©a
.
b®lPosAbs
;

42 
‹amm©eB®lS‹
[
šdex
].
Ï¡Upd©eAge
 = 0;

43 
	}
}

45 
boŞ
 
	gT—mB®lT¿ck”
::
	$isModeFl³d
(cÚ¡ 
Sim¶eGaussŸn
 &
mode
) {

46 
numRobÙsWªtToFl
 = 0;

47 
numRobÙsAg»e
 = 0;

49 
AbsCoÜd
 
myB®lPos
 = 
mode
.
	`g‘B®lPos™iÚ
();

50 
AbsCoÜd
 
	`æ³dB®lPos
(-
myB®lPos
.
	`x
(), -myB®lPos.
	`y
(), 0.0);

53 ià(
	`di¡ªûB‘w“n
(
myB®lPos
, 
	`AbsCoÜd
(0.0, 0.0, 0.0)è< 
MIN_BALL_CENTRE_DISTANCE
) {

54  
çl£
;

57 
i
 = 0; i < 
NUM_PLAYERS_ON_TEAM
; i++) {

58 ià(
‹amm©eB®lS‹
[
i
].
b®lC”šty
 > 
MIN_CERTAINTY_TO_FLIP
 &&

59 
‹amm©eB®lS‹
[
i
].
Ï¡Upd©eAge
 < 60) {

61 ià(
	`di¡ªûB‘w“n
(
‹amm©eB®lS‹
[
i
].
b®lPos™iÚ
, 
myB®lPos
è< 
MAX_BALL_DISTANCE_MATCH
) {

62 
numRobÙsAg»e
 +ğ(
i
 == 0) ? 3 : 1;

63 } ià(
	`di¡ªûB‘w“n
(
‹amm©eB®lS‹
[
i
].
b®lPos™iÚ
, 
æ³dB®lPos
è< 
MAX_BALL_DISTANCE_MATCH
) {

64 
numRobÙsWªtToFl
 +ğ(
i
 == 0) ? 3 : 1;

70  
numRobÙsWªtToFl
 >ğ2 &&‚umRobÙsWªtToFl >ğ(2 * 
numRobÙsAg»e
);

71 
	}
}

73 
	gT—mB®lT¿ck”
::
	$di¡ªûB‘w“n
(cÚ¡ 
AbsCoÜd
 &
coÜd0
, cÚ¡ AbsCoÜd &
coÜd1
) {

74 
dx
 = 
coÜd0
.
	`x
(è- 
coÜd1
.x();

75 
dy
 = 
coÜd0
.
	`y
(è- 
coÜd1
.y();

76  
	`sq¹
(
dx
*dx + 
dy
*dy);

77 
	}
}

	@robot/perception/localisation/TeamBallTracker.hpp

8 #´agm¨
Úû


10 
	~"ty³s/Brßdÿ¡D©a.hµ
"

11 
	~"ty³s/AbsCoÜd.hµ
"

12 
	~"Sim¶eGaussŸn.hµ
"

14 
	#NUM_PLAYERS_ON_TEAM
 4

	)

16 
	sT—mm©eB®lS‹
 {

17 
T—mm©eB®lS‹
();

19 
	mb®lC”šty
;

20 
AbsCoÜd
 
	mb®lPos™iÚ
;

21 
	mÏ¡Upd©eAge
;

29 şas 
	cT—mB®lT¿ck”
 {

30 
	mpublic
:

31 
T—mB®lT¿ck”
(
¶ay”Numb”
);

33 
deÿy
();

34 
addT—mm©eOb£rv©iÚ
(cÚ¡ 
Brßdÿ¡D©a
 &
brßdÿ¡D©a
);

35 
boŞ
 
isModeFl³d
(cÚ¡ 
Sim¶eGaussŸn
 &
mode
);

37 
	m´iv©e
:

39 
T—mm©eB®lS‹
 
‹amm©eB®lS‹
[
NUM_PLAYERS_ON_TEAM
];

40 
	m¶ay”Numb”
;

42 
di¡ªûB‘w“n
(cÚ¡ 
AbsCoÜd
 &
coÜd0
, cÚ¡ AbsCoÜd &
coÜd1
);

	@robot/perception/localisation/VarianceProvider.cpp

8 
	~"V¬ŸnûProvid”.hµ
"

9 
	~"Loÿli§tiÚCÚ¡ªtsProvid”.hµ
"

10 
	~"uts/ªgËs.hµ
"

11 
	~"uts/basic_m©hs.hµ
"

12 
	~<cm©h
>

14 
	#LARGE_VARIANCE
 
	`SQUARE
(10000.0)

	)

16 cÚ¡ 
	gLoÿli§tiÚCÚ¡ªtsProvid”
& 
cÚ¡ªtsProvid”
(

17 
Loÿli§tiÚCÚ¡ªtsProvid”
::
š¡ªû
());

19 cÚ¡ 
	gV¬ŸnûProvid”
& V¬ŸnûProvid”::
	$š¡ªû
() {

20 cÚ¡ 
V¬ŸnûProvid”
 
´ovid”
;

21  
´ovid”
;

22 
	}
}

24 
	gV¬ŸnûProvid”
::
	$V¬ŸnûProvid”
(è{
	}
}

26 
V¬ŸnûProvid”
::
	$g‘Di¡ªûOb£rv©iÚV¬Ÿnû
(

27 
Ob£rv©iÚTy³
 
ty³
, cÚ¡ 
Ob£rv©iÚ
 &
ob£rv©iÚ
) const {

28 
ty³
) {

29 
GOALPOST
:

30  
	`g‘GßÍo¡Di¡ªûV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

31 
BALL
:

32  
	`g‘B®lDi¡ªûV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

33 
CENTRE_CIRCLE
:

34  
	`g‘C’ŒeCœşeDi¡ªûV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

35 
TEAMMATE_ROBOT
:

36  
	`g‘T—mm©eRobÙDi¡ªûV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

38  
LARGE_VARIANCE
;

40 
	}
}

42 
	gV¬ŸnûProvid”
::
	$g‘H—dšgOb£rv©iÚV¬Ÿnû
(

43 
Ob£rv©iÚTy³
 
ty³
, cÚ¡ 
Ob£rv©iÚ
 &
ob£rv©iÚ
) const {

44 
ty³
) {

45 
GOALPOST
:

46  
	`g‘GßÍo¡H—dšgV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

47 
BALL
:

48  
	`g‘B®lH—dšgV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

49 
CENTRE_CIRCLE
:

50  
	`g‘C’ŒeCœşeH—dšgV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

51 
TEAMMATE_ROBOT
:

52  
	`g‘T—mm©eRobÙH—dšgV¬Ÿnû
(
ob£rv©iÚ
.
di¡ªû
);

54  
LARGE_VARIANCE
;

56 
	}
}

58 
	gV¬ŸnûProvid”
::
	$g‘B®lDi¡ªûV¬Ÿnû
(
di¡ªû
) const {

60 
b
 = 
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
DISTANCE_VARIANCE_B
);

61 
c
 = 
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
DISTANCE_VARIANCE_C
);

62 
»suÉ
 = 
	`exp
(
b
 * 
di¡ªû
 + 
c
);

63 ià(
»suÉ
 > 10000.0 * 10000.0) {

66  
»suÉ
;

68 
	}
}

70 
	gV¬ŸnûProvid”
::
	$g‘B®lH—dšgV¬Ÿnû
(
di¡ªû
) const {

71  
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
HEADING_VARIANCE
);

72 
	}
}

74 
	gV¬ŸnûProvid”
::
	$g‘GßÍo¡Di¡ªûV¬Ÿnû
(
di¡ªû
) const {

75  
	`g‘B®lDi¡ªûV¬Ÿnû
(
di¡ªû
);

76 
	}
}

78 
	gV¬ŸnûProvid”
::
	$g‘GßÍo¡H—dšgV¬Ÿnû
(
di¡ªû
) const {

79  
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
HEADING_VARIANCE
);

80 
	}
}

82 
	gV¬ŸnûProvid”
::
	$g‘C’ŒeCœşeDi¡ªûV¬Ÿnû
(
di¡ªû
) const {

83  
	`g‘B®lDi¡ªûV¬Ÿnû
(
di¡ªû
);

84 
	}
}

86 
	gV¬ŸnûProvid”
::
	$g‘C’ŒeCœşeH—dšgV¬Ÿnû
(
di¡ªû
) const {

87  
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
HEADING_VARIANCE
);

88 
	}
}

90 
	gV¬ŸnûProvid”
::
	$g‘T—mm©eRobÙDi¡ªûV¬Ÿnû
(
di¡ªû
) const {

91  
	`g‘B®lDi¡ªûV¬Ÿnû
(
di¡ªû
) *

92 
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
TEAMMATE_ROBOT_DISTANCE_VARIANCE_SCALE
);

93 
	}
}

95 
	gV¬ŸnûProvid”
::
	$g‘T—mm©eRobÙH—dšgV¬Ÿnû
(
di¡ªû
) const {

96  
cÚ¡ªtsProvid”
.
	`g‘
(
Loÿli§tiÚCÚ¡ªtsProvid”
::
TEAMMATE_ROBOT_HEADING_VARIANCE
);

97 
	}
}

	@robot/perception/localisation/VarianceProvider.hpp

8 #´agm¨
Úû


14 şas 
	cV¬ŸnûProvid”
 {

15 
	mpublic
:

17 
	eOb£rv©iÚTy³
 {

18 
GOALPOST
,

19 
	mBALL
,

20 
	mCENTRE_CIRCLE
,

21 
	mTEAMMATE_ROBOT
,

24 
	sOb£rv©iÚ
 {

25 cÚ¡ 
	gdi¡ªû
;

26 cÚ¡ 
	gh—dšg
;

28 
Ob£rv©iÚ
(
di¡ªû
, 
h—dšg
) :

29 
di¡ªû
(di¡ªû), 
h—dšg
(heading) {}

36 cÚ¡ 
	gV¬ŸnûProvid”
& 
š¡ªû
();

42 
	$g‘Di¡ªûOb£rv©iÚV¬Ÿnû
(

43 
Ob£rv©iÚTy³
 
ty³
, cÚ¡ 
Ob£rv©iÚ
 &
ob£rv©iÚ
) const;

49 
	$g‘H—dšgOb£rv©iÚV¬Ÿnû
(

50 
Ob£rv©iÚTy³
 
ty³
, cÚ¡ 
Ob£rv©iÚ
 &
ob£rv©iÚ
) const;

52 
´iv©e
:

53 
	`V¬ŸnûProvid”
();

55 
	$g‘B®lDi¡ªûV¬Ÿnû
(
di¡ªû
) const;

56 
	$g‘B®lH—dšgV¬Ÿnû
(
di¡ªû
) const;

58 
	$g‘GßÍo¡Di¡ªûV¬Ÿnû
(
di¡ªû
) const;

59 
	$g‘GßÍo¡H—dšgV¬Ÿnû
(
di¡ªû
) const;

61 
	$g‘C’ŒeCœşeDi¡ªûV¬Ÿnû
(
di¡ªû
) const;

62 
	$g‘C’ŒeCœşeH—dšgV¬Ÿnû
(
di¡ªû
) const;

64 
	$g‘T—mm©eRobÙDi¡ªûV¬Ÿnû
(
di¡ªû
) const;

65 
	$g‘T—mm©eRobÙH—dšgV¬Ÿnû
(
di¡ªû
) const;

66 
	}
};

	@robot/perception/localisation/VisionUpdateBundle.hpp

31 #´agm¨
Úû


33 
	~"ty³s/AùiÚCommªd.hµ
"

34 
	~"ty³s/B®lInfo.hµ
"

35 
	~"ty³s/F›ldBound¬yInfo.hµ
"

36 
	~"ty³s/F›ldF—tu»Info.hµ
"

37 
	~"ty³s/Po¡Info.hµ
"

38 
	~"ty³s/RobÙInfo.hµ
"

39 
	~"ty³s/AbsCoÜd.hµ
"

41 
	~<veùÜ
>

46 
	sVisiÚUpd©eBundË
 {

48 
VisiÚUpd©eBundË
() :

49 
amIOnRedT—m
(
çl£
),

50 
awayGßlProb
(0.0f),

51 
h—dYaw
(0.0f),

52 
isH—dšgR–ŸbË
(
çl£
),

53 
isDi¡ªûR–ŸbË
(
çl£
) {}

55 
VisiÚUpd©eBundË
(

56 cÚ¡ 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> &
f›ldBound¬›s
,

57 cÚ¡ 
¡d
::
veùÜ
<
F›ldF—tu»Info
> &
f›ldF—tu»s
,

58 cÚ¡ 
¡d
::
veùÜ
<
Po¡Info
> &
po¡s
,

59 cÚ¡ 
¡d
::
veùÜ
<
RobÙInfo
> &
robÙs
,

60 cÚ¡ 
¡d
::
veùÜ
<
AbsCoÜd
> &
‹amm©ePos™iÚs
,

61 cÚ¡ 
boŞ
 
amIOnRedT—m
,

62 cÚ¡ 
awayGßlProb
,

63 cÚ¡ 
h—dYaw
,

64 cÚ¡ 
¡d
::
veùÜ
<
B®lInfo
> &
visibËB®ls
,

65 cÚ¡ 
boŞ
 
isH—dšgR–ŸbË
,

66 cÚ¡ 
boŞ
 
isDi¡ªûR–ŸbË
) :

67 
f›ldBound¬›s
(fieldBoundaries),

68 
f›ldF—tu»s
(fieldFeatures),

69 
po¡s
(posts),

70 
robÙs
(robots),

71 
‹amm©ePos™iÚs
(teammatePositions),

72 
amIOnRedT—m
(amIOnRedTeam),

73 
awayGßlProb
(awayGoalProb),

74 
h—dYaw
(headYaw),

75 
visibËB®ls
(visibleBalls),

76 
isH—dšgR–ŸbË
(isHeadingReliable),

77 
isDi¡ªûR–ŸbË
(isDistanceReliable) {}

80 
	m¡d
::
veùÜ
<
F›ldBound¬yInfo
> 
f›ldBound¬›s
;

83 
	m¡d
::
veùÜ
<
F›ldF—tu»Info
> 
f›ldF—tu»s
;

86 
	m¡d
::
veùÜ
<
Po¡Info
> 
po¡s
;

89 
	m¡d
::
veùÜ
<
RobÙInfo
> 
robÙs
;

93 
	m¡d
::
veùÜ
<
AbsCoÜd
> 
‹amm©ePos™iÚs
;

95 
boŞ
 
	mamIOnRedT—m
;

98 
	mawayGßlProb
;

100 
	mh—dYaw
;

103 
	m¡d
::
veùÜ
<
B®lInfo
> 
visibËB®ls
;

106 
boŞ
 
	misH—dšgR–ŸbË
;

107 
boŞ
 
	misDi¡ªûR–ŸbË
;

110 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gVisiÚUpd©eBundË
& 
	gbundË
) {

111 
	gnumF›ldBound¬›s
 = 
bundË
.
f›ldBound¬›s
.
size
();

112 
	gos
.
wr™e
((*è&
numF›ldBound¬›s
, ());

113 
	gi
 = 0; i < 
	gbundË
.
	gf›ldBound¬›s
.
size
(); i++) {

114 
	gos
 << 
	gbundË
.
	gf›ldBound¬›s
[
i
];

117 
	gnumF›ldF—tu»s
 = 
bundË
.
f›ldF—tu»s
.
size
();

118 
	gos
.
wr™e
((*è&
numF›ldF—tu»s
, ());

119 
	gi
 = 0; i < 
	gbundË
.
	gf›ldF—tu»s
.
size
(); i++) {

120 
	gos
 << 
	gbundË
.
	gf›ldF—tu»s
[
i
];

123 
	gnumPo¡s
 = 
bundË
.
po¡s
.
size
();

124 
	gos
.
wr™e
((*è&
numPo¡s
, ());

125 
	gi
 = 0; i < 
	gbundË
.
	gpo¡s
.
size
(); i++) {

126 
	gos
 << 
	gbundË
.
	gpo¡s
[
i
];

129 
	gos
.
wr™e
((*è&(
bundË
.
awayGßlProb
), ());

130 
	gos
.
wr™e
((*è&(
bundË
.
h—dYaw
), ());

131 
	gos
.
wr™e
((*è&(
bundË
.
isH—dšgR–ŸbË
), (
boŞ
));

132 
	gos
.
wr™e
((*è&(
bundË
.
isDi¡ªûR–ŸbË
), (
boŞ
));

134 
	gnumVisibËB®ls
 = 
bundË
.
visibËB®ls
.
size
();

135 
	gos
.
wr™e
((*è&
numVisibËB®ls
, ());

136 
	gi
 = 0; i < 
	gbundË
.
	gvisibËB®ls
.
size
(); i++) {

137 
	gos
 << 
	gbundË
.
	gvisibËB®ls
[
i
];

140  
	gos
;

143 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gVisiÚUpd©eBundË
& 
	gbundË
) {

144 
	gnumF›ldBound¬›s
;

145 
	gis
.
»ad
((*è&
numF›ldBound¬›s
, ());

146 
	gbundË
.
	gf›ldBound¬›s
.
ş—r
();

147 
	gi
 = 0; i < 
	gnumF›ldBound¬›s
; i++) {

148 
F›ldBound¬yInfo
 
	gÃwF›ldBound¬y
;

149 
	gis
 >> 
	gÃwF›ldBound¬y
;

150 
	gbundË
.
	gf›ldBound¬›s
.
push_back
(
ÃwF›ldBound¬y
);

153 
	gnumF›ldF—tu»s
;

154 
	gis
.
»ad
((*è&
numF›ldF—tu»s
, ());

155 
	gbundË
.
	gf›ldF—tu»s
.
ş—r
();

156 
	gi
 = 0; i < 
	gnumF›ldF—tu»s
; i++) {

157 
F›ldF—tu»Info
 
	gÃwF›ldF—tu»
;

158 
	gis
 >> 
	gÃwF›ldF—tu»
;

159 
	gbundË
.
	gf›ldF—tu»s
.
push_back
(
ÃwF›ldF—tu»
);

162 
	gnumPo¡s
;

163 
	gis
.
»ad
((*è&
numPo¡s
, ());

164 
	gbundË
.
	gpo¡s
.
ş—r
();

165 
	gi
 = 0; i < 
	gnumPo¡s
; i++) {

166 
Po¡Info
 
	gÃwPo¡
;

167 
	gis
 >> 
	gÃwPo¡
;

168 
	gbundË
.
	gpo¡s
.
push_back
(
ÃwPo¡
);

171 
	gis
.
»ad
((*è&(
bundË
.
awayGßlProb
), ());

172 
	gis
.
»ad
((*è&(
bundË
.
h—dYaw
), ());

173 
	gis
.
»ad
((*è&(
bundË
.
isH—dšgR–ŸbË
), (
boŞ
));

174 
	gis
.
»ad
((*è&(
bundË
.
isDi¡ªûR–ŸbË
), (
boŞ
));

176 
	gnumVisibËB®ls
;

177 
	gis
.
»ad
((*è&
numVisibËB®ls
, ());

178 
	gbundË
.
	gvisibËB®ls
.
ş—r
();

179 
	gi
 = 0; i < 
	gnumVisibËB®ls
; i++) {

180 
B®lInfo
 
	gÃwB®l
;

181 
	gis
 >> 
	gÃwB®l
;

182 
	gbundË
.
	gvisibËB®ls
.
push_back
(
ÃwB®l
);

185  
	gis
;

	@robot/perception/localisation/robotfilter/RobotFilter.cpp

32 
	~"RobÙF‹r.hµ
"

34 
	~<¡ršg
>

35 
	~<s¡»am
>

37 cÚ¡ 
	gNO_CLOSE_OBSERVATION
 = -1;

40 
	#FOR_EACH
(
šdex
, 
veùÜ
èšdex = 0; index < veùÜ.
	`size
(); ++šdex)

	)

42 
	g¡d
::
veùÜ
<
RobÙOb¡aşe
> 
RobÙF‹r
::
	$upd©e
(cÚ¡ 
RobÙF‹rUpd©e
 &
upd©e
) {

45 ià(!
upd©e
.
isInÿ·c™©ed
) {

47 
¡d
::
veùÜ
<
Grou³dRobÙs
>::
™”©Ü
 
™
 = 
grou³dRobÙs
.
	`begš
();

49 
™
 !ğ
grou³dRobÙs
.
	`’d
()) {

50 
Grou³dRobÙs
 &
group
 = (*
™
);

51 
group
.
	`tick
(
upd©e
.
odom‘ryDiff
, upd©e.
h—dYaw
, upd©e.
robÙPos
);

52 ià(
group
.
	`isEm±y
()) {

53 
™
 = 
grou³dRobÙs
.
	`”a£
(it);

55 ++
™
;

65 
¡d
::
veùÜ
<
boŞ
> 
	`ob£rv©iÚM”ged
(
upd©e
.
visu®RobÙs
.
	`size
(), 
çl£
);

66 
	`FOR_EACH
(
groupIndex
, 
grou³dRobÙs
) {

67 
Grou³dRobÙs
 &
group
 = 
grou³dRobÙs
[
groupIndex
];

69 
sm®Ë¡Index
 = 
NO_CLOSE_OBSERVATION
;

70 
sm®Ë¡Di¡ªû
 = 0;

71 
	`FOR_EACH
(
visu®Index
, 
upd©e
.
visu®RobÙs
) {

73 ià(!
ob£rv©iÚM”ged
[
visu®Index
]) {

75 cÚ¡ 
RobÙInfo
 &
visu®RobÙ
 = 
upd©e
.
visu®RobÙs
[
visu®Index
];

76 ià(
group
.
	`ÿnM”geRobÙ
(
visu®RobÙ
)) {

78 
di¡ªû
 = 
group
.
	`di¡ªûToRobÙ
(
visu®RobÙ
);

79 ià(
sm®Ë¡Index
 =ğ-1 || 
sm®Ë¡Di¡ªû
 > 
di¡ªû
) {

80 
sm®Ë¡Index
 = 
visu®Index
;

81 
sm®Ë¡Di¡ªû
 = 
di¡ªû
;

87 ià(
sm®Ë¡Index
 != -1) {

88 cÚ¡ 
RobÙInfo
 &
ob£rv©iÚ
 = 
upd©e
.
visu®RobÙs
[
sm®Ë¡Index
];

89 
group
.
	`m”geRobÙ
(
ob£rv©iÚ
);

90 
ob£rv©iÚM”ged
[
sm®Ë¡Index
] = 
Œue
;

94 
	`FOR_EACH
(
visu®Index
, 
upd©e
.
visu®RobÙs
) {

95 ià(!
ob£rv©iÚM”ged
[
visu®Index
]) {

96 
Grou³dRobÙs
 
	`group
(
upd©e
.
visu®RobÙs
[
visu®Index
]);

97 
grou³dRobÙs
.
	`push_back
(
group
);

102 
f‹»dRobÙs
 = 
	`g’”©eRobÙOb¡aşes
();

104  
f‹»dRobÙs
;

105 
	}
}

107 
	g¡d
::
veùÜ
<
RobÙOb¡aşe
> 
RobÙF‹r
::
	$g’”©eRobÙOb¡aşes
() const {

108 
¡d
::
veùÜ
<
RobÙOb¡aşe
> 
ob¡aşes
;

110 
	`FOR_EACH
(
grou³dIndex
, 
grou³dRobÙs
) {

111 cÚ¡ 
Grou³dRobÙs
 &
group
 = 
grou³dRobÙs
[
grou³dIndex
];

112 ià(
group
.
	`isOnF›ld
(è&& group.
	`isImpÜÁOb¡aşe
()) {

113 
¡d
::
¡ršg
 
ty³
;

114 ià(
group
.
	`g‘Ty³
(è=ğ
RobÙInfo
::
rUnknown
) {

115 
ty³
 = "unknown";

116 } ià(
group
.
	`g‘Ty³
(è=ğ
RobÙInfo
::
rBlue
) {

117 
ty³
 = "blue";

119 
ty³
 = "red";

121 
ob¡aşes
.
	`push_back
(
group
.
	`g’”©eRobÙOb¡aşe
());

125  
ob¡aşes
;

126 
	}
}

	@robot/perception/localisation/robotfilter/RobotFilter.hpp

32 #´agm¨
Úû


34 
	~<veùÜ
>

35 
	~<Eig’/Eig’
>

36 
	~"ty³s/AbsCoÜd.hµ
"

37 
	~"ty³s/RRCoÜd.hµ
"

38 
	~"ty³s/Odom‘ry.hµ
"

39 
	~"ty³s/RobÙInfo.hµ
"

40 
	~"ty³s/Grou³dRobÙs.hµ
"

41 
	~"ty³s/RobÙF‹rUpd©e.hµ
"

42 
	~"³rû±iÚ/loÿli§tiÚ/Loÿli§tiÚDefs.hµ
"

48 şas 
	cRobÙF‹r
 {

49 
	mpublic
:

50 
¡d
::
veùÜ
<
RobÙOb¡aşe
> 
upd©e
(cÚ¡ 
RobÙF‹rUpd©e
 &update);

51 
	m¡d
::
veùÜ
<
RobÙOb¡aşe
> 
f‹»dRobÙs
;

53 
	m´iv©e
:

54 
¡d
::
veùÜ
<
RobÙOb¡aşe
> 
	$g’”©eRobÙOb¡aşes
() const;

55 
¡d
::
veùÜ
<
Grou³dRobÙs
> 
grou³dRobÙs
;

	@robot/perception/localisation/robotfilter/types/GroupedRobots.cpp

32 
	~"Grou³dRobÙs.hµ
"

33 
	~"ty³s/RRCoÜd.hµ
"

34 
	~"ty³s/AbsCoÜd.hµ
"

36 
	~"uts/ªgËs.hµ
"

37 
	~<¡ršg
>

38 
	~<s¡»am
>

40 
	#CMs
(
x
è(x * 10)

	)

42 cÚ¡ 
	gROBOT_WIDTH
 = 450;

44 cÚ¡ 
	gGrou³dRobÙs
::
IMPORTANT_MIN_OBSEVATIONS
 = 3;

46 cÚ¡ 
	gGrou³dRobÙs
::
MIN_MERGE_SCALE
 = 1;

47 cÚ¡ 
	gGrou³dRobÙs
::
MAX_MERGE_SCALE
 = 2;

48 cÚ¡ 
	gGrou³dRobÙs
::
ELLIPSE_VERTICAL
 = 
CMs
(80);

49 cÚ¡ 
	gGrou³dRobÙs
::
ELLIPSE_HORIZONTAL
 = 
CMs
(40);

50 cÚ¡ 
	gGrou³dRobÙs
::
ELLIPSE_VER_HOR_RATIO
 = 
ELLIPSE_VERTICAL
 / 
ELLIPSE_HORIZONTAL
;

52 cÚ¡ 
	gLEFT
 = 0;

53 cÚ¡ 
	gRIGHT
 = 1;

54 cÚ¡ 
	gNUM_SIDES
 = 2;

56 
	$poštDi¡ªû
(
Pošt
 
a
, Pošˆ
b
) {

57 
xDiff
 = 
a
[0] - 
b
[0];

58 
yDiff
 = 
a
[1] - 
b
[1];

60  
	`sq¹
(()(
xDiff
 * xDifà+ 
yDiff
 * yDiff));

61 
	}
}

63 
	gGrou³dRobÙs
::
	$Grou³dRobÙs
() {

65 
	}
}

67 
Grou³dRobÙs
::
	$Grou³dRobÙs
(cÚ¡ 
RobÙInfo
 &
visu®RobÙ
){

68 
	`m”geRobÙ
(
visu®RobÙ
);

69 
	}
}

71 
RRCoÜd
 
	gGrou³dRobÙs
::
	$g‘RRCoÜdš©es
() const {

72  
_¼
;

73 
	}
}

75 
Pošt
 
	gGrou³dRobÙs
::
	$g‘C¬‹sŸnCoÜdš©es
() const {

76  
_¼c
;

77 
	}
}

79 
AbsCoÜd
 
	gGrou³dRobÙs
::
	$g‘AbsCoÜd
() const {

80  
_pos
;

81 
	}
}

84 
boŞ
 
	gGrou³dRobÙs
::
	$isImpÜÁOb¡aşe
() const {

85 ià(
ob£rv©iÚs
.
	`size
(è>ğ
IMPORTANT_MIN_OBSEVATIONS
) {

86  
Œue
;

89  
çl£
;

90 
	}
}

92 
Pošt
 
	gGrou³dRobÙs
::
	$g‘RobÙR–©iveC¬‹sŸnToGroup
(
RRCoÜd
 
robÙRR
) const {

93 
RRCoÜd
 
groupRR
 = 
	`g‘RRCoÜdš©es
();

95 
robÙRR
.
	`h—dšg
(è-ğ
groupRR
.heading();

96 
groupRR
.
	`h—dšg
() = 0;

98 
Pošt
 
robÙAngËdCoÜdš©es
 = 
robÙRR
.
	`toC¬‹sŸn
();

99 
Pošt
 
groupAngËdCoÜdš©es
 = 
groupRR
.
	`toC¬‹sŸn
();

102 
Pošt
 
robÙR–©iveCoÜdš©es
 = 
robÙAngËdCoÜdš©es
 - 
groupAngËdCoÜdš©es
;

104  
robÙR–©iveCoÜdš©es
;

105 
	}
}

107 
Pošt
 
	gGrou³dRobÙs
::
	$g‘SÿËdRobÙR–©iveC¬‹sŸnToGroup
(
RRCoÜd
 
robÙRR
, 
sÿËFaùÜ
) const {

108 
Pošt
 
robÙR–©iveCoÜdš©es
 = 
	`g‘RobÙR–©iveC¬‹sŸnToGroup
(
robÙRR
);

111 
robÙR–©iveCoÜdš©es
[1] *ğ
ELLIPSE_VER_HOR_RATIO
;

112  
robÙR–©iveCoÜdš©es
;

113 
	}
}

115 
	gGrou³dRobÙs
::
	$di¡ªûToRobÙ
(cÚ¡ 
RobÙInfo
 &
robÙ
) const {

116 
Pošt
 
¼c
 = 
	`g‘RobÙR–©iveC¬‹sŸnToGroup
(
robÙ
.
¼
);

118  
	`poštDi¡ªû
(
	`Pošt
(0, 0), 
¼c
);

119 
	}
}

122 
boŞ
 
	gGrou³dRobÙs
::
	$ÿnM”geRobÙ
(cÚ¡ 
RobÙInfo
 &
robÙ
) const {

123 
sÿËFaùÜ
 = 
	`g‘SÿËFaùÜ
(
	`g‘L¬ge¡Weight
());

124 
Pošt
 
robÙR–©iveCoÜdš©es
 = 
	`g‘SÿËdRobÙR–©iveC¬‹sŸnToGroup
(
robÙ
.
¼
, 
sÿËFaùÜ
);

126 cÚ¡ 
di¡ªû
 = 
	`poštDi¡ªû
(
	`Pošt
(0, 0), 
robÙR–©iveCoÜdš©es
);

128 ià(
di¡ªû
 < ()
ELLIPSE_VERTICAL
 * 
sÿËFaùÜ
) {

129  
Œue
;

131  
çl£
;

133 
	}
}

136 
	gGrou³dRobÙs
::
	$g‘SÿËFaùÜ
(
weight
) const {

137 cÚ¡ 
MIN_MERGE_SCALE
 = 1;

140 
weight
 = weighˆ- 
RobÙOb£rv©iÚ
::
	`g‘MšWeight
();

141 
maxWeight
 = 
RobÙOb£rv©iÚ
::
	`g‘MaxWeight
(è- RobÙOb£rv©iÚ::
	`g‘MšWeight
();

143 
šv”£Weight
 = 
maxWeight
 - 
weight
;

144 
weightR©io
 = ()
šv”£Weight
 / ()
maxWeight
;

146 cÚ¡ 
SCALE_RANGE
 = 
MAX_MERGE_SCALE
 - 
MIN_MERGE_SCALE
;

148 cÚ¡ 
sÿËFaùÜ
 =

149 
MIN_MERGE_SCALE
 + ()
SCALE_RANGE
 * 
weightR©io
;

151  
sÿËFaùÜ
;

152 
	}
}

155 
	gRobÙInfo
::
Ty³
 
Grou³dRobÙs
::
	$g‘Ty³
() const {

156 
tÙ®Red
 = 0;

157 
tÙ®Blue
 = 0;

159 
¡d
::
veùÜ
<
RobÙOb£rv©iÚ
>::
cÚ¡_™”©Ü
 
™
;

160 
™
 = 
ob£rv©iÚs
.
	`begš
(); iˆ!ğob£rv©iÚs.
	`’d
(); ++it) {

161 cÚ¡ 
RobÙOb£rv©iÚ
 &
ob£rv©iÚ
 = (*
™
);

162 ià(
ob£rv©iÚ
.
ty³
 =ğ
RobÙInfo
::
rBlue
) {

163 ++
tÙ®Blue
;

164 } ià(
ob£rv©iÚ
.
ty³
 =ğ
RobÙInfo
::
rRed
) {

165 ++
tÙ®Red
;

169 ià(
tÙ®Blue
 =ğ0 && 
tÙ®Red
 == 0) {

170  
RobÙInfo
::
rUnknown
;

171 } ià(
tÙ®Blue
 * 2 < 
tÙ®Red
) {

172  
RobÙInfo
::
rRed
;

173 } ià(
tÙ®Red
 * 2 < 
tÙ®Blue
) {

174  
RobÙInfo
::
rBlue
;

176  
RobÙInfo
::
rUnknown
;

178 
	}
}

180 
boŞ
 
	gGrou³dRobÙs
::
	$isOnF›ld
() const {

181 
AbsCoÜd
 
absCoÜd
 = 
	`g‘AbsCoÜd
();

183 ià(
absCoÜd
.
	`x
()* 2 > 
FIELD_LENGTH
 ||‡bsCoord.x() * 2 < -FIELD_LENGTH) {

184  
çl£
;

187 ià(
absCoÜd
.
	`y
(è* 2 > 
FIELD_WIDTH
 ||‡bsCoord.y() * 2 < -FIELD_WIDTH) {

188  
çl£
;

191  
Œue
;

192 
	}
}

194 
	gGrou³dRobÙs
::
	$m”geRobÙ
(cÚ¡ 
RobÙInfo
 &
robÙ
) {

195 
ob£rv©iÚs
.
	`push_back
(
	`RobÙOb£rv©iÚ
(
robÙ
));

196 
	`ÿlcuÏ‹CoÜdš©es
();

197 
	}
}

199 
boŞ
 
	gGrou³dRobÙs
::
	$isEm±y
() const {

200  
ob£rv©iÚs
.
	`em±y
();

201 
	}
}

203 
	gGrou³dRobÙs
::
	$tick
(
Odom‘ry
 
odom‘ryDiff
, 
h—dYaw
, cÚ¡ 
AbsCoÜd
 &
robÙPos
) {

205 
	`ÿlcuÏ‹CoÜdš©es
();

206 
this
->
robÙPos
 =„obotPos;

207 
¡d
::
veùÜ
<
RobÙOb£rv©iÚ
>::
™”©Ü
 
™
 = 
ob£rv©iÚs
.
	`begš
();

208 
™
 !ğ
ob£rv©iÚs
.
	`’d
()) {

209 
RobÙOb£rv©iÚ
 &
ob£rv©iÚ
 = (*
™
);

213 
di¡ªû
 = 
	`poštDi¡ªû
(
	`Pošt
(0, 0),

214 
	`g‘SÿËdRobÙR–©iveC¬‹sŸnToGroup
(
ob£rv©iÚ
.
¼
, 
MAX_MERGE_SCALE
));

215 
³rûÁage
 = 
di¡ªû
 / ()
ELLIPSE_VERTICAL
;

217 
ob£rv©iÚ
.
	`tick
(
odom‘ryDiff
, 
h—dYaw
, 
³rûÁage
);

219 ià(
ob£rv©iÚ
.
	`isSË
()) {

220 
™
 = 
ob£rv©iÚs
.
	`”a£
(it);

222 ++
™
;

225 
	`ÿlcuÏ‹CoÜdš©es
();

226 
	}
}

229 
	gGrou³dRobÙs
::
	$g‘L¬ge¡Weight
() const {

230 
Ïrge¡Weight
 = -1;

231 
i
 = 0; i < 
ob£rv©iÚs
.
	`size
(); ++i) {

232 cÚ¡ 
RobÙOb£rv©iÚ
 &
ob£rv©iÚ
 = 
ob£rv©iÚs
[
i
];

234 
weight
 = 
ob£rv©iÚ
.
	`g‘Weight
();

235 ià(
weight
 > 
Ïrge¡Weight
) {

236 
Ïrge¡Weight
 = 
weight
;

239  
Ïrge¡Weight
;

240 
	}
}

242 
	g¡d
::
veùÜ
<> 
Grou³dRobÙs
::
	$ÿlcuÏ‹Tªg’tH—dšgs
() const {

243 
¡d
::
veùÜ
<> 
	`ob¡ruùiÚOutsideH—dšgs
(
NUM_SIDES
);

245 
h—dšgOff£t
;

246 ià(
_¼
.
	`di¡ªû
(è< 
ROBOT_WIDTH
) {

247 
h—dšgOff£t
 = 
	`DEG2RAD
(90);

249 
h—dšgOff£t
 = 
	`ABS
(
	`©ª
(
ROBOT_WIDTH
 / 
_¼
.
	`di¡ªû
()));

252 
ob¡ruùiÚOutsideH—dšgs
[
LEFT
] = 
_¼
.
	`h—dšg
(è+ 
h—dšgOff£t
;

253 
ob¡ruùiÚOutsideH—dšgs
[
RIGHT
] = 
_¼
.
	`h—dšg
(è- 
h—dšgOff£t
;

255  
ob¡ruùiÚOutsideH—dšgs
;

256 
	}
}

258 
	g¡d
::
veùÜ
<
RRCoÜd
> 
Grou³dRobÙs
::
	$ÿlcuÏ‹EvadeVeùÜs
() const {

259 cÚ¡ 
RRCoÜd
 
DEFAULT_EVADE
 = 
_¼
;

260 
¡d
::
veùÜ
<
RRCoÜd
> 
	`evadeVeùÜs
(
NUM_SIDES
, 
DEFAULT_EVADE
);

263 cÚ¡ 
mšimumEvadeDi¡ªû
 = 
ROBOT_WIDTH
;

264 cÚ¡ 
r
 = 
mšimumEvadeDi¡ªû
;

265 cÚ¡ 
d
 = 
_¼
.
	`di¡ªû
();

267 ià(
d
 < 
r
) {

269 
evadeVeùÜs
[
LEFT
] = 
	`RRCoÜd
(
mšimumEvadeDi¡ªû
, 
	`DEG2RAD
(90));

270 
evadeVeùÜs
[
RIGHT
] = 
	`RRCoÜd
(
mšimumEvadeDi¡ªû
, -
	`DEG2RAD
(90));

273 
r2
 = 
r
 *„;

274 
r4
 = 
r2
 *„2;

275 
d2
 = 
d
 * d;

277 
x
 = 
d
 - 
r2
 / d;

278 
y
 = 
	`sq¹
(
r2
 - 
r4
 / 
d2
);

281 
di¡ªû
 = 
	`ABS
(
	`sq¹
(
d2
 - 
r2
));

282 ià(
di¡ªû
 < 
ROBOT_WIDTH
) {

283 
di¡ªû
 = 
ROBOT_WIDTH
;

285 
evadeAngË
 = 
	`©ª2
(
x
, 
y
);

286 
ËáH—dšg
 = 
	`NORMALISE
(
_¼
.
	`h—dšg
(è+ (
	`DEG2RAD
(90è- 
evadeAngË
));

287 
rightH—dšg
 = 
	`NORMALISE
(
_¼
.
	`h—dšg
(è-(
	`DEG2RAD
(90è- 
evadeAngË
));

289 
evadeVeùÜs
[
LEFT
] = 
	`RRCoÜd
(
di¡ªû
, 
ËáH—dšg
);

290 
evadeVeùÜs
[
RIGHT
] = 
	`RRCoÜd
(
di¡ªû
, 
rightH—dšg
);

293  
evadeVeùÜs
;

294 
	}
}

297 
RobÙOb¡aşe
 
	gGrou³dRobÙs
::
	$g’”©eRobÙOb¡aşe
() const {

299 
RobÙOb¡aşe
 
ob¡aşe
;

300 
ob¡aşe
.
¼
 = 
	`g‘RRCoÜdš©es
();

301 
ob¡aşe
.
ty³
 = 
	`g‘Ty³
();

302 
Pošt
 
ÿ¹esŸn
 = 
	`g‘C¬‹sŸnCoÜdš©es
();

303 
ob¡aşe
.
¼c
 = 
	`AbsCoÜd
(
ÿ¹esŸn
[0], cartesian[1], 0);

304 
ob¡aşe
.
pos
 = 
	`g‘AbsCoÜd
();

306 
¡d
::
veùÜ
<> 
ng’tH—dšgs
 = 
	`ÿlcuÏ‹Tªg’tH—dšgs
();

307 
ob¡aşe
.
ng’tH—dšgLeá
 = 
ng’tH—dšgs
[
LEFT
];

308 
ob¡aşe
.
ng’tH—dšgRight
 = 
ng’tH—dšgs
[
RIGHT
];

310 
¡d
::
veùÜ
<
RRCoÜd
> 
evadeVeùÜs
 = 
	`ÿlcuÏ‹EvadeVeùÜs
();

311 
ob¡aşe
.
evadeVeùÜLeá
 = 
evadeVeùÜs
[
LEFT
];

312 
ob¡aşe
.
evadeVeùÜRight
 = 
evadeVeùÜs
[
RIGHT
];

314  
ob¡aşe
;

315 
	}
}

317 
	gGrou³dRobÙs
::
	$ÿlcuÏ‹CoÜdš©es
() {

318 
	`ÿlcuÏ‹C¬‹sŸn
();

319 
	`ÿlcuÏ‹RRCoÜd
();

320 
	`ÿlcuÏ‹AbsCoÜd
();

321 
	}
}

323 
	gGrou³dRobÙs
::
	$ÿlcuÏ‹RRCoÜd
() {

324 
AbsCoÜd
 
	`abs
(
_¼c
[0], _rrc[1], 0);

325 
_¼
 = 
abs
.
	`cÚv”tToRobÙR–©ive
();

326 
	}
}

328 
	gGrou³dRobÙs
::
	$ÿlcuÏ‹C¬‹sŸn
() {

329 ià(
	`isEm±y
()) {

330 
_¼c
 = 
	`Pošt
(0, 0);

333 
groupX
 = 0;

334 
groupY
 = 0;

335 
tÙ®Weight
 = 0;

337 
¡d
::
veùÜ
<
RobÙOb£rv©iÚ
>::
cÚ¡_™”©Ü
 
™
;

338 
™
 = 
ob£rv©iÚs
.
	`begš
(); iˆ!ğob£rv©iÚs.
	`’d
(); ++it) {

339 cÚ¡ 
RobÙOb£rv©iÚ
 &
ob£rv©iÚ
 = (*
™
);

340 
weight
 = 
ob£rv©iÚ
.
	`g‘Weight
();

342 
Pošt
 
coÜdš©es
 = 
ob£rv©iÚ
.
	`g‘C¬‹sŸnCoÜdš©es
();

343 
groupX
 +ğ(
weight
 * 
coÜdš©es
[0]);

344 
groupY
 +ğ(
weight
 * 
coÜdš©es
[1]);

346 
tÙ®Weight
 +ğ
weight
;

349 ià(
tÙ®Weight
 != 0) {

350 
groupX
 /ğ
tÙ®Weight
;

351 
groupY
 /ğ
tÙ®Weight
;

354 
_¼c
 = 
	`Pošt
(()
groupX
, ()
groupY
);

355 
	}
}

357 
	gGrou³dRobÙs
::
	$ÿlcuÏ‹AbsCoÜd
() {

358 
RRCoÜd
 
robÙCoÜds
 = 
	`g‘RRCoÜdš©es
();

359 
robÙCoÜds
.
	`h—dšg
(è+ğ
robÙPos
.
	`th‘a
();

361 
Pošt
 
robÙC¬‹sŸn
 = 
robÙCoÜds
.
	`toC¬‹sŸn
();

362 
x
 = 
robÙPos
.
	`x
(è+ 
robÙC¬‹sŸn
[0];

363 
y
 = 
robÙPos
.
	`y
(è+ 
robÙC¬‹sŸn
[1];

365 
_pos
 = 
	`AbsCoÜd
(
x
, 
y
, 0);

366 
	}
}

	@robot/perception/localisation/robotfilter/types/GroupedRobots.hpp

32 #´agm¨
Úû


34 
	~<veùÜ
>

36 
	~"ty³s/RobÙInfo.hµ
"

37 
	~"ty³s/RobÙOb¡aşe.hµ
"

38 
	~"RobÙOb£rv©iÚ.hµ
"

39 
	~"ty³s/Odom‘ry.hµ
"

40 
	~"ty³s/AbsCoÜd.hµ
"

41 
	~"ty³s/RRCoÜd.hµ
"

48 şas 
	cGrou³dRobÙs
 {

49 
	mpublic
:

50 
Grou³dRobÙs
();

51 
Grou³dRobÙs
(cÚ¡ 
RobÙInfo
 &
visu®RobÙ
);

56 
boŞ
 
	$ÿnM”geRobÙ
(cÚ¡ 
RobÙInfo
 &
robÙ
) const;

61 
	`m”geRobÙ
(cÚ¡ 
RobÙInfo
 &
robÙ
);

67 
	`tick
(
Odom‘ry
 
odom‘ryDiff
, 
h—dYaw
, cÚ¡ 
AbsCoÜd
 &
robÙPos
);

72 
boŞ
 
	$isEm±y
() const;

77 
boŞ
 
	$isImpÜÁOb¡aşe
() const;

82 
Pošt
 
	$g‘C¬‹sŸnCoÜdš©es
() const;

87 
RRCoÜd
 
	$g‘RRCoÜdš©es
() const;

92 
AbsCoÜd
 
	$g‘AbsCoÜd
() const;

97 
	$di¡ªûToRobÙ
(cÚ¡ 
RobÙInfo
 &
robÙ
) const;

102 
boŞ
 
	$isOnF›ld
() const;

107 
RobÙInfo
::
Ty³
 
	$g‘Ty³
() const;

112 
RobÙOb¡aşe
 
	$g’”©eRobÙOb¡aşe
() const;

114 cÚ¡ 
IMPORTANT_MIN_OBSEVATIONS
;

116 cÚ¡ 
MIN_MERGE_SCALE
;

117 cÚ¡ 
MAX_MERGE_SCALE
;

118 cÚ¡ 
ELLIPSE_VERTICAL
;

119 cÚ¡ 
ELLIPSE_HORIZONTAL
;

120 cÚ¡ 
ELLIPSE_VER_HOR_RATIO
;

123 
´iv©e
:

124 
¡d
::
veùÜ
<
RobÙOb£rv©iÚ
> 
ob£rv©iÚs
;

130 
	$g‘SÿËFaùÜ
(
weight
) const;

136 
Pošt
 
	$g‘RobÙR–©iveC¬‹sŸnToGroup
(
RRCoÜd
 
robÙ
) const;

138 
Pošt
 
	$g‘SÿËdRobÙR–©iveC¬‹sŸnToGroup
(
RRCoÜd
 
robÙRR
, 
sÿËFaùÜ
) const;

143 
	$g‘L¬ge¡Weight
() const;

148 
	`ÿlcuÏ‹CoÜdš©es
();

153 
	`ÿlcuÏ‹C¬‹sŸn
();

158 
	`ÿlcuÏ‹RRCoÜd
();

163 
	`ÿlcuÏ‹AbsCoÜd
();

168 
¡d
::
veùÜ
<
RRCoÜd
> 
	$ÿlcuÏ‹EvadeVeùÜs
() const;

173 
¡d
::
veùÜ
<> 
	$ÿlcuÏ‹Tªg’tH—dšgs
() const;

179 
RRCoÜd
 
_¼
;

180 
Pošt
 
_¼c
;

181 
AbsCoÜd
 
_pos
;

183 
AbsCoÜd
 
robÙPos
;

	@robot/perception/localisation/robotfilter/types/RobotFilterUpdate.hpp

32 #´agm¨
Úû


34 
	sRobÙF‹rUpd©e
 {

35 
	m¡d
::
veùÜ
<
RobÙInfo
> 
visu®RobÙs
;

36 
AbsCoÜd
 
	mrobÙPos
;

37 
	mh—dYaw
;

38 
Odom‘ry
 
	modom‘ryDiff
;

39 
boŞ
 
	misInÿ·c™©ed
;

	@robot/perception/localisation/robotfilter/types/RobotObservation.cpp

32 
	~"RobÙOb£rv©iÚ.hµ
"

34 
	~<Eig’/Eig’
>

35 
	~"ty³s/AbsCoÜd.hµ
"

36 
	~"uts/ªgËs.hµ
"

37 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

39 
usšg
 
Çme¥aû
 
	gEig’
;

41 cÚ¡ 
	gRobÙOb£rv©iÚ
::
ESTIMATED_FRAMES_PER_SECOND
 = 20;

44 cÚ¡ 
	gRobÙOb£rv©iÚ
::
MIN_WEIGHT
 = 1;

45 cÚ¡ 
	gRobÙOb£rv©iÚ
::
WEIGHT_RANGE
 = 20;

47 cÚ¡ 
	gRobÙOb£rv©iÚ
::
SECONDS_ALIVE_ON_FOV
 = 1;

48 cÚ¡ 
	gRobÙOb£rv©iÚ
::
SECONDS_ALIVE_OFF_FOV
 = 10;

50 cÚ¡ 
	gRobÙOb£rv©iÚ
::
MAX_LIFE_SCORE
 =

51 
RobÙOb£rv©iÚ
::
SECONDS_ALIVE_OFF_FOV
 * 
ESTIMATED_FRAMES_PER_SECOND
;

53 cÚ¡ 
	gSECONDS_ALIVE_RATIO
 =

54 
RobÙOb£rv©iÚ
::
SECONDS_ALIVE_OFF_FOV
 / RobÙOb£rv©iÚ::
SECONDS_ALIVE_ON_FOV
;

56 cÚ¡ 
	gRobÙOb£rv©iÚ
::
OFF_SCREEN_SCORE_REDUCER
 = 1;

57 cÚ¡ 
	gRobÙOb£rv©iÚ
::
ON_SCREEN_SCORE_REDUCER
 = 
SECONDS_ALIVE_RATIO
 * 
OFF_SCREEN_SCORE_REDUCER
;

58 cÚ¡ 
	gRobÙOb£rv©iÚ
::
DISTANCE_SCORE_REDUCER
 = 4;

61 
	gRobÙOb£rv©iÚ
::
	$RobÙOb£rv©iÚ
(cÚ¡ 
RobÙInfo
 &
visu®RobÙ
) :

62 
	$liãScÜe
(
MAX_LIFE_SCORE
) {

64 
¼
 = 
visu®RobÙ
.rr;

65 
ty³
 = 
visu®RobÙ
.type;

66 
	}
}

69 
	gRobÙOb£rv©iÚ
::
	$tick
(
Odom‘ry
 
odom‘ryDiff
, 
h—dYaw
, 
di¡ªûOb£rv©iÚToGroupP”ûÁageOfMax
) {

70 
Pošt
 
ÿ¹esŸnCoÜds
 = 
¼
.
	`toC¬‹sŸn
();

71 
ÿ¹esŸnCoÜds
[0] -ğ
odom‘ryDiff
.
fÜw¬d
;

72 
ÿ¹esŸnCoÜds
[1] -ğ
odom‘ryDiff
.
Ëá
;

74 
¼
 = 
	`AbsCoÜd
(
ÿ¹esŸnCoÜds
[0], c¬‹sŸnCoÜds[1], 0).
	`cÚv”tToRobÙR–©ive
();

75 
¼
.
	`h—dšg
(è-ğ
odom‘ryDiff
.
tuº
;

77 
liãScÜe
 -ğ(
di¡ªûOb£rv©iÚToGroupP”ûÁageOfMax
 * 
DISTANCE_SCORE_REDUCER
);

78 
boŞ
 
ÚSü“n
 = 
	`šV›w
(
h—dYaw
);

79 ià(
ÚSü“n
) {

80 
liãScÜe
 -ğ
ON_SCREEN_SCORE_REDUCER
;

82 
liãScÜe
 -ğ
OFF_SCREEN_SCORE_REDUCER
;

84 
	}
}

90 
	gRobÙOb£rv©iÚ
::
	$g‘Weight
() const {

91 
liãScÜeSqu¬ed
 = 
liãScÜe
 *†ifeScore;

92 
maxScÜeSqu¬ed
 = 
MAX_LIFE_SCORE
 * MAX_LIFE_SCORE;

94  (
liãScÜeSqu¬ed
 / 
maxScÜeSqu¬ed
è* 
WEIGHT_RANGE
 + 
MIN_WEIGHT
;

95 
	}
}

97 
boŞ
 
	gRobÙOb£rv©iÚ
::
	$šV›w
(
h—dYaw
) const {

98 
visibËLo
 = 
h—dYaw
 - 0.5à* 
IMAGE_HFOV
;

99 
visibËHi
 = 
h—dYaw
 + 0.5à* 
IMAGE_HFOV
;

101  (
visibËLo
 <ğ
¼
.
	`h—dšg
(è&&„r.h—dšg(è<ğ
visibËHi
);

102 
	}
}

104 
	gRobÙOb£rv©iÚ
::
	$g‘MšWeight
() {

105  
MIN_WEIGHT
;

106 
	}
}

108 
	gRobÙOb£rv©iÚ
::
	$g‘MaxWeight
() {

109  
MIN_WEIGHT
 + 
WEIGHT_RANGE
;

110 
	}
}

112 
	gRobÙOb£rv©iÚ
::
	$numb”OnSü“nF¿mesToBeSË
() {

113  
ESTIMATED_FRAMES_PER_SECOND
 * 
SECONDS_ALIVE_ON_FOV
;

114 
	}
}

116 
	gRobÙOb£rv©iÚ
::
	$numb”OffSü“nF¿mesToBeSË
() {

117  
ESTIMATED_FRAMES_PER_SECOND
 * 
SECONDS_ALIVE_OFF_FOV
;

118 
	}
}

120 
boŞ
 
	gRobÙOb£rv©iÚ
::
	$isSË
() const {

121  
liãScÜe
 <= 0;

122 
	}
}

124 
Pošt
 
	gRobÙOb£rv©iÚ
::
	$g‘C¬‹sŸnCoÜdš©es
() const {

125  
	`g‘RRCoÜdš©es
().
	`toC¬‹sŸn
();

126 
	}
}

128 
RRCoÜd
 
	gRobÙOb£rv©iÚ
::
	$g‘RRCoÜdš©es
() const {

129  
¼
;

130 
	}
}

	@robot/perception/localisation/robotfilter/types/RobotObservation.hpp

32 #´agm¨
Úû


34 
	~"ty³s/RobÙInfo.hµ
"

35 
	~"ty³s/Odom‘ry.hµ
"

36 
	~"ty³s/RRCoÜd.hµ
"

38 şas 
	cRobÙOb£rv©iÚ
 {

39 
	mpublic
:

44 
RobÙOb£rv©iÚ
(cÚ¡ 
RobÙInfo
 &
visu®RobÙ
);

50 
tick
(
Odom‘ry
 
odom‘ryDiff
, 
h—dYaw
, 
di¡ªûOb£rv©iÚToGroupP”ûÁageOfMax
);

55 
boŞ
 
	$isSË
() const;

60 
Pošt
 
	$g‘C¬‹sŸnCoÜdš©es
() const;

65 
RRCoÜd
 
	$g‘RRCoÜdš©es
() const;

71 
	$g‘Weight
() const;

77 
boŞ
 
	$šV›w
(
h—dYaw
) const;

82 
	`g‘MšWeight
();

87 
	`g‘MaxWeight
();

93 
	`numb”OnSü“nF¿mesToBeSË
();

99 
	`numb”OffSü“nF¿mesToBeSË
();

101 cÚ¡ 
MIN_WEIGHT
;

102 cÚ¡ 
WEIGHT_RANGE
;

104 cÚ¡ 
ESTIMATED_FRAMES_PER_SECOND
;

105 cÚ¡ 
MAX_LIFE_SCORE
;

107 cÚ¡ 
SECONDS_ALIVE_ON_FOV
;

108 cÚ¡ 
SECONDS_ALIVE_OFF_FOV
;

110 cÚ¡ 
OFF_SCREEN_SCORE_REDUCER
;

111 cÚ¡ 
ON_SCREEN_SCORE_REDUCER
;

112 cÚ¡ 
DISTANCE_SCORE_REDUCER
;

115 
RRCoÜd
 
¼
;

116 
RobÙInfo
::
Ty³
 
ty³
;

118 
´iv©e
:

120 
liãScÜe
;

	@robot/perception/vision/Fovea.cpp

1 
	~<io¡»am
>

3 
	~"³rû±iÚ/visiÚ/Fov—.hµ
"

10 
	gFov—
::~
	$Fov—
()

12 
d–‘e
[] 
_cŞour
;

13 
d–‘e
[] 
_g»y
;

14 
d–‘e
[] 
_edge
;

15 
	}
}

21 cÚ¡ 
CŞour
* 
	gFov—
::
	$g‘CŞourA¼ay
()

23  
_cŞour
;

24 
	}
}

29 cÚ¡ 
ušt8_t
* 
	gFov—
::
	$g‘RawPix–A¼ay
()

31  
_¿wImage
;

32 
	}
}

38 
	gFov—
::
	$g’”©e
(cÚ¡ 
CombšedF¿me
& 
combšed_äame
, 
CŞourCÏssif›r
&

39 
cŞour_şassif›r
)

41 #ifdeà
FOVEA_TIMINGS


42 
cŞourTime
 = 0;

43 
blurTime
 = 0;

44 
edgeTime
 = 0;

45 
äameCouÁ
 = 0;

47 if(
bb
.
	`width
(è=ğ
TOP_SALIENCY_COLS
)

48 ++
äameCouÁ
;

50 
Tim”
 
tim”
;

51 
tim”
.
	`»¡¬t
();

55 if(
tİ
)

56 
_¿wImage
 = 
combšed_äame
.
tİ_äame_
;

58 
_¿wImage
 = 
combšed_äame
.
bÙ_äame_
;

61 if(
hasCŞour
)

63 if(
tİ
)

64 
	`makeCŞourTİ
(
cŞour_şassif›r
);

66 
	`makeCŞourBÙ
(
cŞour_şassif›r
);

69 #ifdeà
FOVEA_TIMINGS


70 if(
bb
.
	`width
(è=ğ
TOP_SALIENCY_COLS
)

71 
cŞourTime
 +ğ
tim”
.
	`–­£d_us
();

72 
tim”
.
	`»¡¬t
();

76 if(
hasG»y
)

77 
	`blurG»y
();

79 #ifdeà
FOVEA_TIMINGS


80 if(
bb
.
	`width
(è=ğ
TOP_SALIENCY_COLS
)

81 
blurTime
 +ğ
tim”
.
	`–­£d_us
();

82 
tim”
.
	`»¡¬t
();

86 if(
hasEdge
)

87 
	`makeEdge
();

89 #ifdeà
FOVEA_TIMINGS


90 if(
bb
.
	`width
(è=ğ
TOP_SALIENCY_COLS
)

91 
edgeTime
 +ğ
tim”
.
	`–­£d_us
();

94 #ifdeà
FOVEA_TIMINGS


95 if(
äameCouÁ
 == 900)

97 
¡d
::
cout
 << "1000 f¿mav”age" << std::
’dl
 << "Width: " << 
bb
.
	`width
(è<< " Height: " << bb.
	`height
() << std::endl;

98 
¡d
::
cout
 << "CŞou¸şassifiÿtiÚ: " << 
cŞourTime
/
äameCouÁ
 << std::
’dl
;

99 
¡d
::
cout
 << "G»y blur: " << 
blurTime
/
äameCouÁ
 << std::
’dl
;

100 
¡d
::
cout
 << "Edgd‘eùiÚ: " << 
edgeTime
/
äameCouÁ
 << std::
’dl
 << std::endl;

101 
cŞourTime
 = 0;

102 
blurTime
 = 0;

103 
edgeTime
 = 0;

104 
äameCouÁ
 = 0;

107 
	}
}

112 
	gFov—
::
	$makeCŞourTİ
(
CŞourCÏssif›r
& 
cŞour_şassif›r
)

115 cÚ¡ 
ušt16_t
 
COLS
 = 
TOP_IMAGE_COLS
;

116 cÚ¡ 
ušt16_t
 
DOUBLE_COLS
 = 
COLS
*2;

119 cÚ¡ 
BBox
 
	`BB
(
bb
.
a
 * 
d’s™y
, bb.
b
 * density);

122 cÚ¡ 
ušt8_t
 *
cu¼’tF¿mePix–
;

123 
cu¼’tF¿mePix–
 = 
_¿wImage
 + 2 *(
BB
.
a
.
	`y
()*
COLS
 + BB.a.
	`x
());

124 
CŞour
 *
§l›ncyPix–
 = 
_cŞour
;

127 cÚ¡ 
ušt16_t
 
width
 = 
bb
.
	`width
();

128 cÚ¡ 
doubËD’s™y
 = 
d’s™y
*2;

131 cÚ¡ 
CŞour
 *cÚ¡ 
§l›ncyEnd
 = 
_cŞour
 + 
bb
.
	`height
(è* bb.
	`width
();

134 
§l›ncyPix–
 < 
§l›ncyEnd
)

136 cÚ¡ 
CŞour
 *cÚ¡ 
§l›ncyRowEnd
 = 
§l›ncyPix–
 + 
width
;

139 ; 
§l›ncyPix–
 < 
§l›ncyRowEnd
; ++saliencyPixel)

141 *
§l›ncyPix–
 = 
cŞour_şassif›r
.
	`şassify
(
cu¼’tF¿mePix–
);

142 
cu¼’tF¿mePix–
 +ğ
doubËD’s™y
;

146 
cu¼’tF¿mePix–
 +ğ
DOUBLE_COLS
*
d’s™y
 - 
width
 * 
doubËD’s™y
;

148 
	}
}

153 
	gFov—
::
	$makeCŞourBÙ
(
CŞourCÏssif›r
& 
cŞour_şassif›r
)

156 cÚ¡ 
ušt16_t
 
COLS
 = 
BOT_IMAGE_COLS
;

157 cÚ¡ 
ušt16_t
 
DOUBLE_COLS
 = 
COLS
*2;

160 cÚ¡ 
BBox
 
	`BB
(
bb
.
a
 * 
d’s™y
, bb.
b
 * density);

163 cÚ¡ 
ušt8_t
 *
cu¼’tF¿mePix–
;

164 
cu¼’tF¿mePix–
 = 
_¿wImage
 + 2 *(
BB
.
a
.
	`y
()*
COLS
 + BB.a.
	`x
());

165 
CŞour
 *
§l›ncyPix–
 = 
_cŞour
;

168 cÚ¡ 
ušt16_t
 
width
 = 
bb
.
	`width
();

169 cÚ¡ 
doubËD’s™y
 = 
d’s™y
*2;

172 cÚ¡ 
CŞour
 *cÚ¡ 
§l›ncyEnd
 = 
_cŞour
 + 
bb
.
	`height
(è* bb.
	`width
();

175 
§l›ncyPix–
 < 
§l›ncyEnd
)

177 cÚ¡ 
CŞour
 *cÚ¡ 
§l›ncyRowEnd
 = 
§l›ncyPix–
 + 
width
;

180 ; 
§l›ncyPix–
 < 
§l›ncyRowEnd
; ++saliencyPixel)

182 *
§l›ncyPix–
 = 
cŞour_şassif›r
.
	`şassify
(
cu¼’tF¿mePix–
);

183 
cu¼’tF¿mePix–
 +ğ
doubËD’s™y
;

187 
cu¼’tF¿mePix–
 +ğ
DOUBLE_COLS
*
d’s™y
 - 
width
 * 
doubËD’s™y
;

189 
	}
}

194 
	gFov—
::
	$blurG»y
()

196 
g»y_tmp
[
bb
.
	`width
()][bb.
	`height
()];

197 
x
, 
y
;

205 
y
 = 0; y < 
bb
.
	`height
(); ++ y) {

206 
x
 = 0;

207 
g»y_tmp
[
x
][
y
] = 3 * 
	`g‘RawG»y
(x+0, y) +

208 1 * 
	`g‘RawG»y
(
x
+1, 
y
);

210 
x
 = 
bb
.
	`width
() - 1;

211 
g»y_tmp
[
x
][
y
] = 3 * 
	`g‘RawG»y
(x-0, y) +

212 1 * 
	`g‘RawG»y
(
x
-1, 
y
);

216 
y
 = 0; y < 
bb
.
	`height
(); ++ y) {

217 
x
 = 1; x < 
bb
.
	`width
() - 1; ++ x) {

218 
g»y_tmp
[
x
][
y
] = 1 * 
	`g‘RawG»y
(x-1, y) +

219 2 * 
	`g‘RawG»y
(
x
+0, 
y
) +

220 1 * 
	`g‘RawG»y
(
x
+1, 
y
);

224 
x
 = 0; x < 
bb
.
	`width
(); ++ x) {

225 
y
 = 0;

226 
_g»y
[
x
 + 
y
*
width
] = 3 * 
g»y_tmp
[x][y] + grey_tmp[x][y+1];

228 
y
 = 
bb
.
	`height
() - 1;

229 
_g»y
[
x
 + 
y
*
width
] = 3 * 
g»y_tmp
[x][y] + grey_tmp[x][y-1];

232 
y
 = 1; y < 
bb
.
	`height
() - 1; ++ y) {

233 
x
 = 0; x < 
bb
.
	`width
(); ++ x) {

234 
_g»y
[
x
 + 
y
*
width
] = 1 * 
g»y_tmp
[x][y-1] +

235 2 * 
g»y_tmp
[
x
][
y
+0] +

236 1 * 
g»y_tmp
[
x
][
y
+1];

239 
	}
}

245 
	gFov—
::
	$makeEdge
()

247 
x
, 
y
;

248 
a
, 
b
;

249 
dx
, 
dy
;

266 
y
 = 0; y < 
bb
.
	`height
() - 1; ++ y) {

267 
x
 = 0; x < 
bb
.
	`width
() - 1; ++ x) {

268 
a
 = 
	`g‘Fov—G»y
(
x
 , 
y
 );

269 
a
 -ğ
	`g‘Fov—G»y
(
x
+1, 
y
+1);

271 
b
 = 
	`g‘Fov—G»y
(
x
 , 
y
+1);

272 
b
 -ğ
	`g‘Fov—G»y
(
x
+1, 
y
 );

274 
dx
 = (724 * (
a
 + 
b
)) / 1024;

275 
dy
 = (724 * (
a
 - 
b
)) / 1024;

277 
_edge
[
x
 + 
y
*
width
][0] = 
dx
;

278 
_edge
[
x
 + 
y
*
width
][1] = 
dy
;

280 
_edge
[
x
 + 
y
*
width
][0] = 0;

281 
_edge
[
x
 + 
y
*
width
][1] = 0;

284 
x
 = 0; x < 
bb
.
	`width
(); ++ x) {

285 
_edge
[
x
 + 
y
*
width
][0] = 0;

286 
_edge
[
x
 + 
y
*
width
][1] = 0;

288 
	}
}

	@robot/perception/vision/Fovea.hpp

1 #iâdeà
PERCEPTION_VISION_FOVEA_H_


2 
	#PERCEPTION_VISION_FOVEA_H_


	)

4 
	~"³rû±iÚ/visiÚ/cŞour/CŞourCÏssif›rIÁ”çû.hµ
"

5 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

6 
	~"ty³s/CombšedF¿me.hµ
"

7 
	~"ty³s/Pošt.hµ
"

8 
	~"ty³s/BBox.hµ
"

11 şas 
	cFov—
 {

13 
	mpublic
:

23 
	$Fov—
(
BBox
 
bb
, 
d’s™y
, 
boŞ
 
tİ
, boŞ 
cŞour
, boŞ 
g»y
, boŞ 
edge
) :

24 
	`bb
(
bb
), 
	`d’s™y
(
d’s™y
), 
	`tİ
(
tİ
), 
	`hasCŞour
(
cŞour
),

25 
	`hasG»y
(
g»y
 || 
edge
), 
	`hasEdge
(edge),

26 
	`_cŞour
(
cŞour
 ? 
Ãw
 
CŞour
[
bb
.
	`width
(è* bb.
	`height
()] : 
NULL
),

27 
	`_g»y
 (
hasG»y
 ? 
Ãw
 [
bb
.
	`width
(è* bb.
	`height
()] : 
NULL
),

28 
	`_edge
 (
hasEdge
 ? 
Ãw
 
Pošt
 [
bb
.
	`width
(è* bb.
	`height
()] : 
NULL
),

29 
	`width
(
bb
.
b
[0]-bb.
a
[0]) {}

34 ~
	`Fov—
();

40 
	`g’”©e
(cÚ¡ 
CombšedF¿me
& 
combšed_äame
, 
CŞourCÏssif›r
&

41 
cŞour_şassif›r
);

43 
Fov—
& 
İ”©Ü
=(cÚ¡ Fov—& 
f
è{  *
this
; 
	}
}

44 cÚ¡ 
	gFov—
& 
	gİ”©Ü
=(cÚ¡ 
Fov—
& 
f
ècÚ¡ {  *
this
; }

52 
šlše
 cÚ¡ 
ušt8_t
* 
	$g‘RawYUV
(
x
, 
y
) const

54 (
_¿wImage
+(
bb
.
a
[1]+
y
)*
width
*
d’s™y
*2 + (bb.a[0]+
x
)*density*2);

55 
	}
}

63 
šlše
 cÚ¡ 
ušt8_t
* 
	$g‘RawYUV
(
lš—rPos
) const

65 (
_¿wImage
+
lš—rPos
);

66 
	}
}

72 
šlše
 cÚ¡ 
CŞour
 
	$g‘Fov—CŞour
(
x
, 
y
) const

74 (
_cŞour
[
x
 + 
y
*
width
]);

75 
	}
}

81 
šlše
 cÚ¡ 
CŞour
 
	$g‘Fov—CŞour
(
lš—rPos
) const

83 (
_cŞour
[
lš—rPos
]);

84 
	}
}

90 
šlše
 cÚ¡ 
	$g‘Fov—G»y
(
x
, 
y
) const

92 (
_g»y
[
x
 + 
y
*
width
]);

93 
	}
}

99 
šlše
 cÚ¡ 
	$g‘Fov—G»y
(
lš—rPos
) const

101 (
_g»y
[
lš—rPos
]);

102 
	}
}

110 
šlše
 cÚ¡ 
	gPošt
& 
	$g‘Fov—Edge
(
x
, 
y
) const

112 (
_edge
[
x
 + 
y
*
width
]);

113 
	}
}

122 
šlše
 cÚ¡ 
	gPošt
& 
	$g‘Fov—Edge
(
lš—rPos
) const

124 (
_edge
[
lš—rPos
]);

125 
	}
}

131 
šlše
 cÚ¡ 
	$g‘Fov—Magn™ude
(
x
, 
y
) const

133 
pos
 = 
x
 + 
y
 * 
bb
.
	`width
();

134 ((
_edge
[
pos
].
	`x
()*_edge[pos].x())+(_edge[pos].
	`y
()*_edge[pos].y()));

135 
	}
}

142 
šlše
 cÚ¡ 
	$g‘Fov—Magn™ude
(
lš—rPos
) const

144 ((
_edge
[
lš—rPos
].
	`x
()*_edge[linearPos].x()) +

145 (
_edge
[
lš—rPos
].
	`y
()*_edge[linearPos].y()));

146 
	}
}

152 
šlše
 
Pošt
 
	$m­ImageToFov—
(
Pošt
 
p
) const

154 ià(!
tİ
è
p
.
	`y
(è-ğ
TOP_IMAGE_ROWS
;

155  (
p
 / 
d’s™y
è- 
bb
.
a
;

156 
	}
}

162 
šlše
 
Pošt
 
	$m­Fov—ToImage
(
Pošt
 
p
) const

164 ià(!
tİ
) {

165 
Pošt
 
‹mp
 = (
p
 + 
bb
.
a
è* 
d’s™y
;

166 
‹mp
.
	`y
(è+ğ
TOP_IMAGE_ROWS
;

167  
‹mp
;

169  (
p
 + 
bb
.
a
è* 
d’s™y
;

170 
	}
}

175 cÚ¡ 
CŞour
* 
	$g‘IÁ”ÇlCŞour
()const {

176  
_cŞour
;

177 
	}
}

180 
	g´Ùeùed
:

185 cÚ¡ 
CŞour
* 
g‘CŞourA¼ay
();

191 cÚ¡ 
ušt8_t
* 
g‘RawPix–A¼ay
();

193 
	g´iv©e
:

196 cÚ¡ 
BBox
 
bb
;

200 cÚ¡ 
	gd’s™y
;

203 cÚ¡ 
boŞ
 
	gtİ
;

206 cÚ¡ 
boŞ
 
	ghasCŞour
;

209 cÚ¡ 
boŞ
 
	ghasG»y
;

212 cÚ¡ 
boŞ
 
	ghasEdge
;

215 
CŞour
 *cÚ¡ 
	g_cŞour
;

218 *cÚ¡ 
	g_g»y
;

222 
Pošt
 *cÚ¡ 
	g_edge
;

225 cÚ¡ 
	gwidth
;

228 cÚ¡ 
ušt8_t
 * 
	g_¿wImage
;

233 
makeCŞourTİ
(
CŞourCÏssif›r
& 
cŞour_şassif›r
);

238 
makeCŞourBÙ
(
CŞourCÏssif›r
& 
cŞour_şassif›r
);

243 
blurG»y
();

249 
makeEdge
();

255 
šlše
 cÚ¡ 
	gušt8_t
& 
	$g‘RawG»y
(
x
, 
y
) const

257 
imageCŞs
 = 
tİ
? 
TOP_IMAGE_COLS
 : 
BOT_IMAGE_COLS
;

258 (
_¿wImage
[
x
*
d’s™y
*2 + 
y
*
imageCŞs
*density*2]);

259 
	}
}

	@robot/perception/vision/Region.cpp

1 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

11 
	gRegiÚI
::
	$RegiÚI
(
BBox
& 
boundšg_box
, 
boŞ
 
is_tİ_ÿm”a
, 
Fov—
& 
fov—
, 
d’s™y
)

12 : 
	`is_tİ_ÿm”a_
(
is_tİ_ÿm”a
),

13 
	`boundšg_box_
(
boundšg_box
),

14 
	`this_fov—_
(&
fov—
),

15 
	`n_¿w_cŞs_š_»giÚ_
(
boundšg_box
.
	`width
(è+ 
d’s™y
),

16 
	`n_¿w_rows_š_»giÚ_
(
boundšg_box
.
	`height
(è+ 
d’s™y
),

17 
	`d’s™y_to_¿w_
(
d’s™y
),

18 
	`y_off£t_¿w_
(
boundšg_box
.
a
.
	`y
()),

19 
	`x_off£t_¿w_
(
boundšg_box
.
a
.
	$x
())

21 ià(
is_tİ_ÿm”a
) {

22 
¿w_tÙ®_width_
 = 
TOP_IMAGE_COLS
;

23 
¿w_to_fov—_d’s™y_
 = 
TOP_SALIENCY_DENSITY
;

25 
¿w_tÙ®_width_
 = 
BOT_IMAGE_COLS
;

26 
¿w_to_fov—_d’s™y_
 = 
BOT_SALIENCY_DENSITY
;

28 
	}
}

40 
	gRegiÚI
::
	$RegiÚI
(cÚ¡ 
RegiÚI
& 
»giÚ
, 
BBox
& 
box
, 
»l_d’s™y
 = 1,

41 
»l_d’s™y_muÉl›r
 = 
DENSITY_MAINTAIN
)

42 : 
	`is_tİ_ÿm”a_
(
»giÚ
.
is_tİ_ÿm”a_
),

43 
	`boundšg_box_
(
box
),

44 
	$this_fov—_
(
»giÚ
.
this_fov—_
)

47 
x_off£t_¿w_
 = 
box
.
a
.
	`x
(è* 
»giÚ
.
d’s™y_to_¿w_
 +„egion.x_offset_raw_;

48 
y_off£t_¿w_
 = 
box
.
a
.
	`y
(è* 
»giÚ
.
d’s™y_to_¿w_
 +„egion.y_offset_raw_;

50 ià(
»l_d’s™y_muÉl›r
 =ğ
DENSITY_INCREASE
) {

51 
d’s™y_to_¿w_
 = 
»giÚ
.d’s™y_to_¿w_ * 
»l_d’s™y
;

52 } ià(
»l_d’s™y_muÉl›r
 =ğ
DENSITY_DECREASE
) {

53 
d’s™y_to_¿w_
 = 
»giÚ
.d’s™y_to_¿w_ / 
»l_d’s™y
;

55 
n_¿w_cŞs_š_»giÚ_
 = 
box
.
	`width
(è* 
»giÚ
.
d’s™y_to_¿w_
 + density_to_raw_;

56 
n_¿w_rows_š_»giÚ_
 = 
box
.
	`height
(è* 
»giÚ
.
d’s™y_to_¿w_
 + density_to_raw_;

57 
	}
}

62 
	gRegiÚI
& RegiÚI::
İ”©Ü
=(cÚ¡ 
RegiÚI
& 
»giÚ
) {

63 
boundšg_box_
 = 
»giÚ
.bounding_box_;

64 
	gis_tİ_ÿm”a_
 = 
»giÚ
.
is_tİ_ÿm”a_
;

65 
	gthis_fov—_
 = 
»giÚ
.
this_fov—_
;

66 
	gn_¿w_cŞs_š_»giÚ_
 = 
»giÚ
.
n_¿w_cŞs_š_»giÚ_
;

67 
	gn_¿w_rows_š_»giÚ_
 = 
»giÚ
.
n_¿w_rows_š_»giÚ_
;

68 
	gd’s™y_to_¿w_
 = 
»giÚ
.
d’s™y_to_¿w_
;

69 
	gy_off£t_¿w_
 = 
»giÚ
.
y_off£t_¿w_
;

70 
	gx_off£t_¿w_
 = 
»giÚ
.
x_off£t_¿w_
;

71  *
	gthis
;

78 
	gRegiÚI
::
™”©Ü_¿w
 
RegiÚI
::
	$begš_¿w
() const {

79  
	`™”©Ü_¿w
(

80 
this
,

81 
	`g‘Lš—rPosFromXYRaw_
(0,0),

82 
x_off£t_¿w_
,

83 
d’s™y_to_¿w_
,

84 
d’s™y_to_¿w_
,

85 
¿w_tÙ®_width_
,

86 
n_¿w_cŞs_š_»giÚ_


88 
	}
}

89 
	gRegiÚI
::
™”©Ü_fov—
 
RegiÚI
::
	$begš_fov—
() const {

90 
s
 = 
¿w_to_fov—_d’s™y_
;

91  
	`™”©Ü_fov—
(

92 
this
,

93 
	`g‘Lš—rPosFromXYFov—_
(0,0),

94 (
x_off£t_¿w_
/
s
),

95 (
d’s™y_to_¿w_
/
s
),

96 (
d’s™y_to_¿w_
/
s
),

97 (
¿w_tÙ®_width_
/
s
),

98 (
n_¿w_cŞs_š_»giÚ_
/
s
)

100 
	}
}

106 
	gRegiÚI
::
™”©Ü_¿w
 
RegiÚI
::
	$’d_¿w
() const {

107  
	`™”©Ü_¿w
(

108 
this
,

109 
	`g‘Lš—rPosFromXYRaw_
(0, 
n_¿w_rows_š_»giÚ_
),

112 
	}
}

113 
	gRegiÚI
::
™”©Ü_fov—
 
RegiÚI
::
	$’d_fov—
() const {

114  
	`™”©Ü_fov—
(

115 
this
,

116 
	`g‘Lš—rPosFromXYFov—_
(0, 
n_¿w_rows_š_»giÚ_
),

119 
	}
}

122 
	gRegiÚI
::
™”©Ü
::
	$™”©e_
() {

123 
pos_
 +ğ
x_d’s™y_
;

124 ià(
pos_
 % 
x_tÙ®_width_
 >ğ
x_off£t_
 + 
x_»giÚ_width_
) {

125 
pos_
 +ğ(
x_tÙ®_width_
 - 
x_»giÚ_width_
è+ x_tÙ®_width_*(
y_d’s™y_
 - 1);

127 
	}
}

132 
	gRegiÚI
::
™”©Ü
::
£lf_ty³
 
RegiÚI
::™”©Ü::
İ”©Ü
++() {

133 
£lf_ty³
 
i
 = *
this
;

134 
™”©e_
();

135  
	gi
;

142 
	gRegiÚI
::
™”©Ü
::
£lf_ty³
& 
RegiÚI
::™”©Ü::
İ”©Ü
++(
junk
) {

143 
™”©e_
();

144  *
	gthis
;

150 
boŞ
 
	gRegiÚI
::
™”©Ü
::
İ”©Ü
==(cÚ¡ 
£lf_ty³
& 
rhs
) {

151  
pos_
 =ğ
rhs
.pos_;

	@robot/perception/vision/Region.hpp

1 #iâdeà
PERCEPTION_VISION_REGION_H_


2 
	#PERCEPTION_VISION_REGION_H_


	)

4 
	~<li¡
>

5 
	~<m­
>

7 
	~"ty³s/BBox.hµ
"

8 
	~"ty³s/CombšedFov—.hµ
"

10 
	#DENSITY_MAINTAIN
 0

	)

11 
	#DENSITY_INCREASE
 1

	)

12 
	#DENSITY_DECREASE
 2

	)

18 
	eRegiÚITy³
 {

19 
	mBALL
,

20 
	mGOAL
,

21 
	mROBOT
,

22 
	mN_TYPES


35 şas 
	cRegiÚI
 {

37 
	mpublic
:

39 şas 
	c™”©Ü
 {

40 
public
:

42 
™”©Ü
 
	t£lf_ty³
;

43 
	m¡d
::
	tfÜw¬d_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

44 
	tdifã»Á_ty³
;

52 
™”©Ü
(cÚ¡ 
RegiÚI
* cÚ¡ 
»giÚ
, 
pos
, 
x_off£t
, 
x_d’s™y
, 
y_d’s™y
,

53 
x_tÙ®_width
, 
x_»giÚ_width
)

54 : 
»giÚ_
(
»giÚ
),

55 
pos_
(
pos
),

56 
x_off£t_
(
x_off£t
),

57 
x_d’s™y_
(
x_d’s™y
),

58 
y_d’s™y_
(
y_d’s™y
),

59 
x_tÙ®_width_
(
x_tÙ®_width
),

60 
x_»giÚ_width_
(
x_»giÚ_width
)

67 
£lf_ty³
 
	mİ”©Ü
++();

73 
	m£lf_ty³
& 
	mİ”©Ü
++();

79 cÚ¡ 
x
(è{  (
	mpos_
 % 
	mx_tÙ®_width_
); }

85 cÚ¡ 
y
(è{  (
æoÜ
(
pos_
 / 
x_tÙ®_width_
)); }

90 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
£lf_ty³
& 
rhs
);

95 
boŞ
 
	mİ”©Ü
!=(cÚ¡ 
£lf_ty³
& 
rhs
è{  !
İ”©Ü
==(rhs); }

97 
	m´Ùeùed
:

99 
šlše
 cÚ¡ 
g‘Lš—rPos_
() {

100  
pos_
;

103 
šlše
 cÚ¡ 
RegiÚI
* cÚ¡ 
g‘RegiÚ_
() {

104  
	m»giÚ_
;

107 
	m´iv©e
:

109 
™”©e_
();

114 cÚ¡ 
RegiÚI
* cÚ¡ 
	m»giÚ_
;

115 
	mpos_
;

116 
	mx_off£t_
;

117 
	mx_d’s™y_
;

118 
	my_d’s™y_
;

119 
	mx_tÙ®_width_
;

120 
	mx_»giÚ_width_
;

123 şas 
	c™”©Ü_¿w
 : 
public
 
™”©Ü
 {

124 
public
:

126 
™”©Ü_¿w
(cÚ¡ 
RegiÚI
* cÚ¡ 
»giÚ
, 
pos
, 
x_off£t
, 
x_d’s™y
, 
y_d’s™y
,

127 
x_tÙ®_width
, 
x_»giÚ_width
) :

128 
™”©Ü
(
»giÚ
, 
pos
, 
x_off£t
, 
x_d’s™y
, 
y_d’s™y
,

129 
x_tÙ®_width
, 
x_»giÚ_width
) {}

135 cÚ¡ 
ušt8_t
* 
¿w
(è{  
g‘RegiÚ_
()->
g‘Pix–Raw_
(
g‘Lš—rPos_
()); }

139 şas 
	c™”©Ü_fov—
 : 
public
 
™”©Ü
 {

140 
public
:

142 
™”©Ü_fov—
(cÚ¡ 
RegiÚI
* cÚ¡ 
»giÚ
, 
pos
, 
x_off£t
, 
x_d’s™y
, 
y_d’s™y
,

143 
x_tÙ®_width
, 
x_»giÚ_width
) :

144 
™”©Ü
(
»giÚ
, 
pos
, 
x_off£t
, 
x_d’s™y
, 
y_d’s™y
,

145 
x_tÙ®_width
, 
x_»giÚ_width
) {}

151 cÚ¡ 
CŞour
 
cŞour
(è{  
g‘RegiÚ_
()->
g‘Pix–CŞour_
(
g‘Lš—rPos_
()); }

157 cÚ¡ 
g»y
(è{  
g‘RegiÚ_
()->
g‘Pix–G»y_
(
g‘Lš—rPos_
()); }

163 cÚ¡ 
	gPošt
& 
edge
(è{  
g‘RegiÚ_
()->
g‘Pix–Edge_
(
g‘Lš—rPos_
()); }

169 cÚ¡ 
edgeMagn™ude
(è{  
g‘RegiÚ_
()->
g‘Pix–EdgeMagn™ude_
(
g‘Lš—rPos_
()); }

180 
RegiÚI
(
BBox
& 
boundšg_box
, 
boŞ
 
is_tİ_ÿm”a
, 
Fov—
& 
fov—
, 
d’s™y
);

192 
RegiÚI
(cÚ¡ RegiÚI& 
»giÚ
, 
BBox
& 
box
, 
»l_d’s™y
, 
»l_d’s™y_muÉl›r
);

197 
	gRegiÚI
& 
	gİ”©Ü
=(cÚ¡ 
RegiÚI
&);

206 
šlše
 cÚ¡ 
ušt8_t
* 
	$g‘Pix–Raw
(
x
, 
y
) const {

207  
	`g‘Pix–Raw_
(
	`g‘Lš—rPosFromXYRaw_
(
x
, 
y
));

208 
	}
}

217 
šlše
 cÚ¡ 
CŞour
 
	$g‘Pix–CŞour
(
x
, 
y
) const {

218  
	`g‘Pix–CŞour_
(
	`g‘Lš—rPosFromXYFov—_
(
x
, 
y
));

219 
	}
}

228 
šlše
 cÚ¡ 
	$g‘Pix–G»y
(
x
, 
y
) const {

229  
	`g‘Pix–G»y_
(
	`g‘Lš—rPosFromXYFov—_
(
x
, 
y
));

230 
	}
}

239 
šlše
 cÚ¡ 
	gPošt
& 
	$g‘Pix–Edge
(
x
, 
y
) const {

240  
	`g‘Pix–Edge_
(
	`g‘Lš—rPosFromXYFov—_
(
x
, 
y
));

241 
	}
}

250 
šlše
 cÚ¡ 
	$g‘Pix–EdgeMagn™ude
(
x
, 
y
) const {

251  
	`g‘Pix–EdgeMagn™ude_
(
	`g‘Lš—rPosFromXYFov—_
(
x
, 
y
));

252 
	}
}

259 
šlše
 cÚ¡ 
boŞ
 
	$isTİCam”a
(ècÚ¡ {  
is_tİ_ÿm”a_
; 
	}
}

265 
šlše
 cÚ¡ 
	$g‘CŞs
(ècÚ¡ {  (
n_¿w_cŞs_š_»giÚ_
 / 
d’s™y_to_¿w_
); 
	}
}

271 
šlše
 cÚ¡ 
	$g‘Rows
(ècÚ¡ {  (
n_¿w_rows_š_»giÚ_
 / 
d’s™y_to_¿w_
); 
	}
}

277 
šlše
 cÚ¡ 
	$g‘D’s™y
(ècÚ¡ {  
d’s™y_to_¿w_
; 
	}
}

284 
šlše
 
BBox
 
	$g‘BoundšgBox
(ècÚ¡ {  
boundšg_box_
; 
	}
}

290 
™”©Ü_¿w
 
	$begš_¿w
() const;

296 
™”©Ü_fov—
 
	$begš_fov—
() const;

302 
™”©Ü_¿w
 
	$’d_¿w
() const;

308 
™”©Ü_fov—
 
	$’d_fov—
() const;

312 
šlše
 cÚ¡ 
Fov—
* 
	$g‘IÁ”ÇlFov—
() const {

313  
this_fov—_
;

314 
	}
}

316 
	g´iv©e
:

325 
šlše
 cÚ¡ 
ušt8_t
* 
	$g‘Pix–Raw_
(
lš—r_pos
) const {

326  
this_fov—_
->
	`g‘RawYUV
(
lš—r_pos
);

327 
	}
}

336 
šlše
 cÚ¡ 
CŞour
 
	$g‘Pix–CŞour_
(
lš—r_pos
) const {

337  
this_fov—_
->
	`g‘Fov—CŞour
(
lš—r_pos
);

338 
	}
}

347 
šlše
 cÚ¡ 
	$g‘Pix–G»y_
(
lš—r_pos
) const {

348  
this_fov—_
->
	`g‘Fov—G»y
(
lš—r_pos
);

349 
	}
}

358 
šlše
 cÚ¡ 
	gPošt
& 
	$g‘Pix–Edge_
(
lš—r_pos
) const {

359  
this_fov—_
->
	`g‘Fov—Edge
(
lš—r_pos
);

360 
	}
}

369 
šlše
 cÚ¡ 
	$g‘Pix–EdgeMagn™ude_
(
lš—r_pos
) const {

370  
this_fov—_
->
	`g‘Fov—Magn™ude
(
lš—r_pos
);

371 
	}
}

374 
šlše
 cÚ¡ 
	$g‘Lš—rPosFromXYRaw_
(
x
, 
y
) const {

375  (
x_off£t_¿w_
 + 
x
*
d’s™y_to_¿w_
è+ 
¿w_tÙ®_width_
 * (
y_off£t_¿w_
 + 
y
*density_to_raw_);

376 
	}
}

379 
šlše
 cÚ¡ 
	$g‘Lš—rPosFromXYFov—_
(
x
, 
y
) const {

380 
s
 = 
¿w_to_fov—_d’s™y_
;

381  (
x_off£t_¿w_
 + 
x
*
d’s™y_to_¿w_
)/
s
 + 
¿w_tÙ®_width_
/ * (
y_off£t_¿w_
 + 
y
*density_to_raw_)/s;

382 
	}
}

384 
boŞ
 
	gis_tİ_ÿm”a_
;

385 
	gBBox
& 
	gboundšg_box_
;

386 cÚ¡ 
Fov—
* 
	gthis_fov—_
;

389 
	gn_¿w_cŞs_š_»giÚ_
;

390 
	gn_¿w_rows_š_»giÚ_
;

393 
	gd’s™y_to_¿w_
;

396 
	gy_off£t_¿w_
;

397 
	gx_off£t_¿w_
;

400 
	g¿w_tÙ®_width_
;

401 
	g¿w_to_fov—_d’s™y_
;

	@robot/perception/vision/Vision.cpp

1 
	~<li¡
>

3 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

4 
	~"³rû±iÚ/visiÚ/cŞour/DyÇmicCŞourCÏssif›r.hµ
"

5 
	~"³rû±iÚ/visiÚ/d‘eùÜ/B®lD‘eùÜ2016.hµ
"

6 
	~"³rû±iÚ/visiÚ/fuÎfšd”/F›ldF—tu»Fšd”.hµ
"

7 
	~"³rû±iÚ/visiÚ/fuÎfšd”/F›ldBound¬yFšd”.hµ
"

8 
	~"ty³s/F¿meInfo.hµ
"

9 
	~"ty³s/CombšedFov—.hµ
"

10 
	~"ty³s/CombšedF¿me.hµ
"

11 
	~"uts/Logg”.hµ
"

12 
	~"³rû±iÚ/visiÚ/Fov—.hµ
"

15 
	gVisiÚ
::
	$pİuÏ‹FuÎFšd”s_
() {

16 
	`addFuÎFšd”
(
Ãw
 
	`F›ldBound¬yFšd”
());

17 
	`addFuÎFšd”
(
Ãw
 
	`F›ldF—tu»Fšd”
());

18 
	}
}

20 
	gVisiÚ
::
	$pİuÏ‹RegiÚFšd”s_
() {

22 
	}
}

24 
VisiÚ
::
	$pİuÏ‹D‘eùÜs_
() {

26 
	}
}

29 
VisiÚ
::
	$VisiÚ
(è: 
	`n_»giÚ_fšd”s_
(0), 
	`n_d‘eùÜs_
(0), 
	`images_§m¶ed
(0),

30 
	`bbox_tİ_
(
	`BBox
(
	`Pošt
(0,0), Pošt(
TOP_SALIENCY_COLS
, 
TOP_SALIENCY_ROWS
))),

31 
	`bbox_bÙ_
(
	`BBox
(
	`Pošt
(0,0), Pošt(
BOT_SALIENCY_COLS
, 
BOT_SALIENCY_ROWS
))),

32 
	`combšed_fov—_
(
	`CombšedFov—
(

33 
Ãw
 
	`Fov—
(
bbox_tİ_
, 
TOP_SALIENCY_DENSITY
, 
Œue
,rue,rue,rue),

34 
Ãw
 
	`Fov—
(
bbox_bÙ_
, 
BOT_SALIENCY_DENSITY
, 
Œue
,rue,rue,rue)

36 
	`fuÎ_»giÚ_tİ_
(
	`RegiÚI
(
bbox_tİ_
, 
Œue
, *
combšed_fov—_
.
tİ_
, 
TOP_SALIENCY_DENSITY
)),

37 
	`fuÎ_»giÚ_bÙ_
(
	$RegiÚI
(
bbox_bÙ_
, 
çl£
, *
combšed_fov—_
.
bÙ_
, 
BOT_SALIENCY_DENSITY
))

40 
	`Îog
(
INFO
è<< "VisiÚ C»©ed" << 
¡d
::
’dl
;

42 
»giÚ_fšd”s_
 = 
Ãw
 
RegiÚFšd”
*[
MAX_VISION_REGION_FINDERS
];

43 
d‘eùÜs_
 = 
Ãw
 
D‘eùÜ
*[
MAX_VISION_DETECTORS
];

44 
fuÎ_fšd”s_
 = 
Ãw
 
FuÎFšd”
*[
MAX_VISION_FULL_FINDERS
];

46 
	`pİuÏ‹FuÎFšd”s_
();

47 
	`pİuÏ‹RegiÚFšd”s_
();

48 
	`pİuÏ‹D‘eùÜs_
();

53 
cŞour_şassif›r_
 = 
Ãw
 
	`DyÇmicCŞourCÏssif›r
();

54 
	}
}

56 
	gVisiÚ
::~
	$VisiÚ
() {

57 
d–‘e
 
»giÚ_fšd”s_
;

58 
d–‘e
 
d‘eùÜs_
;

59 
d–‘e
 
cŞour_şassif›r_
;

60 
size_t
 
i
 = 0; i < 
n_d‘eùÜs_
; ++i) {

61 
d–‘e
 
d‘eùÜs_
[
i
];

63 
size_t
 
i
 = 0; i < 
n_»giÚ_fšd”s_
; ++i) {

64 
d–‘e
 
»giÚ_fšd”s_
[
i
];

67 
	`Îog
(
INFO
è<< "VisiÚ De¡royed" << 
¡d
::
’dl
;

68 
	}
}

70 
	gVisiÚ
::
	$addRegiÚFšd”
(
RegiÚFšd”
* 
»giÚ_fšd”
) {

71 ià(
n_»giÚ_fšd”s_
 >ğ
MAX_VISION_REGION_FINDERS
) {

74 
»giÚ_fšd”s_
[
n_»giÚ_fšd”s_
] = 
»giÚ_fšd”
;

75 ++
n_»giÚ_fšd”s_
;

76 
	}
}

78 
RegiÚFšd”
* 
	gVisiÚ
::
	$g‘RegiÚFšd”
(
ušt32_t
 
šdex
) {

79 ià(
šdex
 < 0 || index >ğ
n_»giÚ_fšd”s_
) {

82  
»giÚ_fšd”s_
[
šdex
];

83 
	}
}

85 
	gVisiÚ
::
	$addD‘eùÜ
(
D‘eùÜ
* 
d‘eùÜ
) {

86 ià(
n_d‘eùÜs_
 >ğ
MAX_VISION_DETECTORS
) {

89 
d‘eùÜs_
[
n_d‘eùÜs_
] = 
d‘eùÜ
;

90 ++
n_d‘eùÜs_
;

91 
	}
}

93 
D‘eùÜ
* 
	gVisiÚ
::
	$g‘D‘eùÜ
(
ušt32_t
 
šdex
) {

94 ià(
šdex
 < 0 || index >ğ
n_d‘eùÜs_
) {

97  
d‘eùÜs_
[
šdex
];

98 
	}
}

100 
	gVisiÚ
::
	$addFuÎFšd”
(
FuÎFšd”
* 
fuÎ_fšd”
) {

101 ià(
n_fuÎ_fšd”s_
 >ğ
MAX_VISION_FULL_FINDERS
) {

104 
fuÎ_fšd”s_
[
n_fuÎ_fšd”s_
] = 
fuÎ_fšd”
;

105 ++
n_fuÎ_fšd”s_
;

106 
	}
}

108 
FuÎFšd”
* 
	gVisiÚ
::
	$g‘FuÎFšd”
(
ušt32_t
 
šdex
) {

109 ià(
šdex
 < 0 || index >ğ
n_fuÎ_fšd”s_
) {

112  
fuÎ_fšd”s_
[
šdex
];

113 
	}
}

120 cÚ¡ 
ušt8_t
 
	gVisiÚ
::
	$g‘CŞourCÏssifiÿtiÚCÚ‹xt
() {

121 
ušt8_t
 
cc_cÚ‹xt
 = 
CC_CONTEXT_OFFFIELD
;

122 ià(
images_§m¶ed
 <= 5) {

123 
cc_cÚ‹xt
 = 
CC_CONTEXT_HALF_START_READY
;

124 ++
images_§m¶ed
;

126  
cc_cÚ‹xt
;

127 
	}
}

129 
F¿meInfo
 
	gVisiÚ
::
	$´oûssF¿me
(cÚ¡ 
CombšedF¿me
& 
this_äame
, cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
) {

131 
F¿meInfo
 
äame_šfo
;

138 cÚ¡ 
ušt8_t
 
cc_cÚ‹xt
 = 
	`g‘CŞourCÏssifiÿtiÚCÚ‹xt
();

141 
cŞour_şassif›r_
->
	`§m¶e
(
this_äame
, 
cc_cÚ‹xt
);

146 
combšed_fov—_
.
	`g’”©e
(
this_äame
, *
cŞour_şassif›r_
);

149 
fuÎ_»giÚ_tİ_
 = 
	`RegiÚI
(
bbox_tİ_
, 
Œue
, *
combšed_fov—_
.
tİ_
, 
TOP_SALIENCY_DENSITY
);

150 
fuÎ_»giÚ_bÙ_
 = 
	`RegiÚI
(
bbox_bÙ_
, 
çl£
, *
combšed_fov—_
.
bÙ_
, 
BOT_SALIENCY_DENSITY
);

157 
size_t
 
i
 = 0; i < 
n_fuÎ_fšd”s_
; ++i) {

158 
fuÎ_fšd”s_
[
i
]->
	`fšd
(
bb_šfo
, 
fuÎ_»giÚ_tİ_
, 
äame_šfo
);

159 
fuÎ_fšd”s_
[
i
]->
	`fšd
(
bb_šfo
, 
fuÎ_»giÚ_bÙ_
, 
äame_šfo
);

162 
¡d
::
veùÜ
<
RegiÚI
> 
»giÚs
;

165 
size_t
 
i
 = 0; i < 
n_»giÚ_fšd”s_
; ++i) {

166 
¡d
::
veùÜ
<
RegiÚI
> 
»giÚs_found
;

169 
»giÚs_found
 = 
»giÚ_fšd”s_
[
i
]->
	`fšd
(
bb_šfo
, 
fuÎ_»giÚ_tİ_
);

170 
»giÚs
.
	`š£¹
ÔegiÚs.
	`’d
(), 
»giÚs_found
.
	`begš
(),„egions_found.end());

173 
»giÚs_found
 = 
»giÚ_fšd”s_
[
i
]->
	`fšd
(
bb_šfo
, 
fuÎ_»giÚ_bÙ_
);

174 
»giÚs
.
	`š£¹
ÔegiÚs.
	`’d
(), 
»giÚs_found
.
	`begš
(),„egions_found.end());

178 
size_t
 
i
 = 0; i < 
n_d‘eùÜs_
; ++i) {

179 
¡d
::
veùÜ
<
RegiÚI
> 
f‹»d_»giÚs
 = 
»giÚs
;

180 
d‘eùÜs_
[
i
]->
	`d‘eù
(
bb_šfo
, 
f‹»d_»giÚs
);

183  
äame_šfo
;

184 
	}
}

	@robot/perception/vision/Vision.hpp

1 #iâdeà
PERCEPTION_VISION_VISION_H_


2 
	#PERCEPTION_VISION_VISION_H_


	)

4 
	~<li¡
>

6 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

7 
	~"³rû±iÚ/visiÚ/cŞour/CŞourCÏssif›rIÁ”çû.hµ
"

8 
	~"³rû±iÚ/visiÚ/d‘eùÜ/D‘eùÜIÁ”çû.hµ
"

9 
	~"³rû±iÚ/visiÚ/fuÎfšd”/FuÎFšd”IÁ”çû.hµ
"

10 
	~"³rû±iÚ/visiÚ/»giÚfšd”/RegiÚFšd”IÁ”çû.hµ
"

11 
	~"ty³s/F¿meInfo.hµ
"

12 
	~"ty³s/CombšedFov—.hµ
"

13 
	~"ty³s/CombšedF¿me.hµ
"

14 
	~"uts/Tim”.hµ
"

16 şas 
	cVisiÚ
 {

18 
	mpublic
:

23 
VisiÚ
();

28 ~
VisiÚ
();

34 
F¿meInfo
 
´oûssF¿me
(cÚ¡ 
CombšedF¿me
& 
pix–_d©a
, cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
);

36 
šlše
 cÚ¡ 
	mRegiÚI
& 
	$g‘FuÎRegiÚTİ
(è{  
fuÎ_»giÚ_tİ_
; }

37 
šlše
 cÚ¡ 
RegiÚI
& 
	$g‘FuÎRegiÚBÙ
(è{  
fuÎ_»giÚ_bÙ_
; 
	}
}

39 
	g´iv©e
:

41 
pİuÏ‹FuÎFšd”s_
();

42 
pİuÏ‹RegiÚFšd”s_
();

43 
pİuÏ‹D‘eùÜs_
();

45 cÚ¡ 
ušt8_t
 
g‘CŞourCÏssifiÿtiÚCÚ‹xt
();

47 
addRegiÚFšd”
(
RegiÚFšd”
* 
»giÚ_fšd”
);

48 
RegiÚFšd”
* 
g‘RegiÚFšd”
(
ušt32_t
 
šdex
);

50 
addD‘eùÜ
(
D‘eùÜ
* 
d‘eùÜ
);

51 
D‘eùÜ
* 
g‘D‘eùÜ
(
ušt32_t
 
šdex
);

53 
addFuÎFšd”
(
FuÎFšd”
* 
fuÎ_fšd”
);

54 
FuÎFšd”
* 
g‘FuÎFšd”
(
ušt32_t
 
šdex
);

59 
	g¡d
::
li¡
<
CombšedFov—
> 
fuÎ_fov—e_
;

61 
CŞourCÏssif›r
* 
	gcŞour_şassif›r_
;

63 
RegiÚFšd”
** 
	g»giÚ_fšd”s_
;

64 
size_t
 
	gn_»giÚ_fšd”s_
;

66 
D‘eùÜ
** 
	gd‘eùÜs_
;

67 
size_t
 
	gn_d‘eùÜs_
;

69 
FuÎFšd”
** 
	gfuÎ_fšd”s_
;

70 
size_t
 
	gn_fuÎ_fšd”s_
;

73 
	gimages_§m¶ed
;

76 
BBox
 
	gbbox_tİ_
;

77 
BBox
 
	gbbox_bÙ_
;

79 
CombšedFov—
 
	gcombšed_fov—_
;

82 
RegiÚI
 
	gfuÎ_»giÚ_tİ_
;

83 
RegiÚI
 
	gfuÎ_»giÚ_bÙ_
;

	@robot/perception/vision/VisionAdapter.cpp

1 
	~"³rû±iÚ/visiÚ/VisiÚAd­‹r.hµ
"

3 
	~"³rû±iÚ/visiÚ/Ùh”/V¬ŸnûC®cuÏtÜ.hµ
"

5 
	~<boo¡/®gÜ™hm/¡ršg/şassifiÿtiÚ.hµ
>

6 
	~<boo¡/®gÜ™hm/¡ršg/¥l™.hµ
>

8 
	~<±h»ad.h
>

9 
	~<veùÜ
>

11 
	~"bÏckbßrd/BÏckbßrd.hµ
"

12 
	~"uts/Logg”.hµ
"

13 
	~"uts/Tim”.hµ
"

14 
	~"ty³s/CombšedCam”aS‘tšgs.hµ
"

15 
	~"ty³s/CombšedF¿me.hµ
"

17 
usšg
 
Çme¥aû
 
	g¡d
;

18 
usšg
 
Çme¥aû
 
	gboo¡
::
®gÜ™hm
;

21 
	gVisiÚAd­‹r
::
	$VisiÚAd­‹r
(
BÏckbßrd
 *
bb
)

22 : 
	$Ad­‹r
(
bb
)

24 
combšed_ÿm”a_
 = 
Ãw
 
	`CombšedCam”a
(

25 (
bÏckbßrd
->
cÚfig
)["visiÚ.dumpäames"].
as
<
boŞ
>(),

26 (
bÏckbßrd
->
cÚfig
)["visiÚ.dum´©e"].
as
<>(),

27 (
bÏckbßrd
->
cÚfig
)["visiÚ.dumpfe"].
as
<
¡ršg
>()

30 
combšed_äame_
 = 
boo¡
::
sh¬ed_±r
<
CombšedF¿me
>();

32 
RegiÚI
 
tİRegiÚ
 = 
visiÚ_
.
	`g‘FuÎRegiÚTİ
();

33 
RegiÚI
 
bÙRegiÚ
 = 
visiÚ_
.
	`g‘FuÎRegiÚBÙ
();

34 cÚ¡ 
Fov—
 *
fov—Tİ
 = 
tİRegiÚ
.
	`g‘IÁ”ÇlFov—
();

35 cÚ¡ 
Fov—
 *
fov—BÙ
 = 
bÙRegiÚ
.
	`g‘IÁ”ÇlFov—
();

37 
	`wr™eTo
(
visiÚ
, 
tİS®›ncy
, (
CŞour
*)
fov—Tİ
->
	`g‘IÁ”ÇlCŞour
());

38 
	`wr™eTo
(
visiÚ
, 
bÙS®›ncy
, (
CŞour
*)
fov—BÙ
->
	`g‘IÁ”ÇlCŞour
());

39 
	}
}

41 
	gVisiÚAd­‹r
::
	$tick
() {

43 
Tim”
 
t
;

44 
ušt32_t
 
time
;

49 
	`Îog_İ’
(
VERBOSE
è<< "VisiÚ Cam”¨Tick" << 
’dl
;

50 
t
.
	`»¡¬t
();

51 
	`tickCam”a
();

52 
time
 = 
t
.
	`–­£d_us
();

53 ià(
time
 > 30000) {

54 
	`Îog_şo£
(
VERBOSE
è<< "VisiÚ Cam”¨Tick: OK " << 
time
 << " us" << 
’dl
;

56 
	`Îog_şo£
(
ERROR
è<< "VisiÚ Cam”¨Tick: TOO LONG " << 
time
 << " us" << 
’dl
;

62 
	`Îog_İ’
(
VERBOSE
è<< "VisiÚ Proûs Tick" << 
’dl
;

63 
t
.
	`»¡¬t
();

64 
	`tickProûss
();

65 
time
 = 
t
.
	`–­£d_us
();

66 ià(
time
 > 30000) {

67 
	`Îog_şo£
(
VERBOSE
è<< "VisiÚ Proûs Tick: OK " << 
time
 << " us" << 
’dl
;

69 
	`Îog_şo£
(
ERROR
è<< "VisiÚ Proûs Tick: TOO LONG " << 
time
 << " us" << 
’dl
;

72 
	}
}

74 
	gVisiÚAd­‹r
::
	$tickCam”a
() {

75 ià(
combšed_ÿm”a_
 =ğ
NULL
) {

76 
	`Îog_middË
(
WARNING
è<< "NØCam”¨´ovidedØthVisiÚAd­‹r" << 
’dl
;

79 
cÚv_¼_
.
po£
 = 
	`»adFrom
(
mÙiÚ
,…ose);

81 
	`wr™eTo
(
visiÚ
, 
tİF¿me
, 
combšed_ÿm”a_
->
	`g‘F¿meTİ
());

82 
	`wr™eTo
(
visiÚ
, 
bÙF¿me
, 
combšed_ÿm”a_
->
	`g‘F¿meBÙtom
());

86 
CombšedCam”aS‘tšgs
 
£‰šgs
 = 
combšed_ÿm”a_
->
	`g‘Cam”aS‘tšgs
();

87 
	`wr™eTo
(
visiÚ
, 
tİCam”aS‘tšgs
, 
£‰šgs
.
tİ_ÿm”a_£‰šgs
);

88 
	`wr™eTo
(
visiÚ
, 
bÙCam”aS‘tšgs
, 
£‰šgs
.
bÙ_ÿm”a_£‰šgs
);

90 
	}
}

92 
	gVisiÚAd­‹r
::
	$tickProûss
() {

93 
Tim”
 
t
;

94 
VisiÚBÏckbßrdInfo
 
bb_šfo
;

103 
	`acquœeLock
(
£rŸliz©iÚ
);

104 
	`Îog_middË
(
VERBOSE
è<< "VisiÚickProûs acquœeLock(£rŸliz©iÚètook " << 
t
.
	`–­£d_us
()

105 << " us" << 
’dl
;

106 
t
.
	`»¡¬t
();

114 
bb_šfo
.
tİ_ÿm”a_£‰šgs
 = 
	`»adFrom
(
visiÚ
, 
tİCam”aS‘tšgs
);

115 
bb_šfo
.
bÙ_ÿm”a_£‰šgs
 = 
	`»adFrom
(
visiÚ
, 
bÙCam”aS‘tšgs
);

117 
boo¡
::
sh¬ed_±r
<
CombšedF¿me
> 
combšed_äame_
;

118 
combšed_äame_
 = 
boo¡
::
sh¬ed_±r
<
CombšedF¿me
>(
Ãw
 
	`CombšedF¿me
(

119 
	`»adFrom
(
visiÚ
, 
tİF¿me
),

120 
	`»adFrom
(
visiÚ
, 
bÙF¿me
),

121 
cÚv_¼_
,

122 
combšed_äame_


124 
	`Îog_middË
(
VERBOSE
è<< "VisiÚ„—dšg image äom bÏckbßrdook " << 
t
.
	`–­£d_us
()

125 << " us" << 
’dl
;

126 
t
.
	`»¡¬t
();

131 
	`Îog
(
VERBOSE
è<< "VisiÚ„—dšg„emaššg d©¨äom bÏckbßrdook " << 
t
.
	`–­£d_us
(è<< " us" << 
’dl
;

132 
t
.
	`»¡¬t
();

134 
	`±h»ad_y›ld
();

135 
	`u¦“p
(1);

137 
F¿meInfo
 
äame_šfo
 = 
visiÚ_
.
	`´oûssF¿me
(*(
combšed_äame_
.
	`g‘
()), 
bb_šfo
);

139 
	`Îog
(
VERBOSE
è<< "VisiÚ…roûssF¿me(ètook " << 
t
.
	`–­£d_us
(è<< " us" << 
’dl
;

140 
t
.
	`»¡¬t
();

150 
V¬ŸnûC®cuÏtÜ
::
	`£tV¬Ÿnû
(
äame_šfo
.
b®ls
);

151 
V¬ŸnûC®cuÏtÜ
::
	`£tV¬Ÿnû
(
äame_šfo
.
po¡s
);

152 
V¬ŸnûC®cuÏtÜ
::
	`£tV¬Ÿnû
(
äame_šfo
.
ã©u»s
);

154 
	`wr™eTo
 (
visiÚ
, 
b®ls
, 
äame_šfo
.balls );

155 
	`wr™eTo
 (
visiÚ
, 
po¡s
, 
äame_šfo
.posts );

156 
	`wr™eTo
 (
visiÚ
, 
f›ldF—tu»s
, 
äame_šfo
.
ã©u»s
);

158 
	`»Ëa£Lock
(
£rŸliz©iÚ
);

159 
	`Îog
(
VERBOSE
è<< "VisiÚ wr™šg backØbÏckbßrdook " << 
t
.
	`–­£d_us
(è<< " us" << 
’dl
;

160 
	}
}

	@robot/perception/vision/VisionAdapter.hpp

1 #iâdeà
PERCEPTION_VISION_VISIONADAPTER_H_


2 
	#PERCEPTION_VISION_VISIONADAPTER_H_


	)

4 
	~"³rû±iÚ/visiÚ/ÿm”a/CombšedCam”a.hµ
"

5 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aToRR.hµ
"

6 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

8 
	~"uts/Tim”.hµ
"

9 
	~"bÏckbßrd/Ad­‹r.hµ
"

11 şas 
	cVisiÚAd­‹r
 : 
Ad­‹r
 {

12 
public
:

17 
VisiÚAd­‹r
(
BÏckbßrd
 *
bb
);

22 ~
	$VisiÚAd­‹r
() {}

27 
	`tick
();

29 
	`tickCam”a
();

31 
	`tickProûss
();

34 
CombšedCam”a
 *
combšed_ÿm”a_
;

35 
´iv©e
:

37 
boo¡
::
sh¬ed_±r
<
CombšedF¿me
> 
combšed_äame_
;

38 
Cam”aToRR
 
cÚv_¼_
;

39 
VisiÚ
 
visiÚ_
;

40 
	}
};

	@robot/perception/vision/VisionDefinitions.hpp

1 #iâdeà
PERCEPTION_VISION_VISIONDEFINITIONS_H_


2 
	#PERCEPTION_VISION_VISIONDEFINITIONS_H_


	)

6 
	mcGREEN
 = 0,

7 
	mcWHITE
 = 1,

8 
	mcBLACK
 = 2,

9 
	mcBACKGROUND
 = 3,

10 
	mcNUM_COLOURS
 = 4

11 } 
	tCŞour
;

13 
	eã©u»_ty³


15 
	mfNONE
 = -1,

16 
	mfBALL
 = 0,

17 
	mfGOAL_POST_BLUE
,

18 
	mfGOAL_BAR_BLUE
,

19 
	mfGOAL_POST_YELLOW
,

20 
	mfGOAL_BAR_YELLOW
,

21 
	mfROBOT_BLUE
,

22 
	mfROBOT_RED
,

23 
	mfFIELD_LINE
,

24 
	mfFIELD_LINE_THIN
,

25 
	mfFIELD_CORNER
,

26 
	mfFIELD_T_JUNCTION
,

27 
	mfFIELD_PENALTY_SPOT
,

28 
	mfFIELD_CENTRE_CIRCLE
,

29 
	mfFIELD_BOUNDARY
,

30 
	mfNUM_FEATURES


33 
	#TOP_IMAGE_ROWS
 960

34 
	#TOP_IMAGE_COLS
 1280

35 
	#BOT_IMAGE_ROWS
 480

	)

36 
	#BOT_IMAGE_COLS
 640

	)

37 
	#IMAGE_ROWS
 960

38 
	#IMAGE_COLS
 1280

39 

	)

40 
	#MAX_FEET
 10

	)

41 
	#MAX_POSTS
 2

	)

42 
	#MAX_BALLS
 2

	)

43 
	#MAX_FIELD_BOUNDARIES
 2

	)

44 
	#MAX_ROBOTS
 9

	)

45 
	#MAX_LANDMARKS
 100

	)

46 
	#MAX_FIELD_FEATURES
 100

	)

48 
	#IMAGE_HFOV
 
	`DEG2RAD
(60.9)

49 
	#IMAGE_VFOV
 
	`DEG2RAD
(47.64)

	)

52 
	#MAX_VISION_REGION_FINDERS
 10

	)

53 
	#MAX_VISION_DETECTORS
 10

	)

54 
	#MAX_VISION_FULL_FINDERS
 10

	)

61 
	#HIST_AVE_WINDOW_SIZE
 3

	)

62 
	#MAX_FIELD_LINE_POINTS
 250

	)

63 
	#TOP_SALIENCY_DENSITY
 8

	)

64 
	#BOT_SALIENCY_DENSITY
 8

	)

65 
	#TOP_SALIENCY_ROWS
 (
TOP_IMAGE_ROWS
 / 
TOP_SALIENCY_DENSITY
)

	)

66 
	#TOP_SALIENCY_COLS
 (
TOP_IMAGE_COLS
 / 
TOP_SALIENCY_DENSITY
)

	)

67 
	#BOT_SALIENCY_ROWS
 (
BOT_IMAGE_ROWS
 / 
BOT_SALIENCY_DENSITY
)

	)

68 
	#BOT_SALIENCY_COLS
 (
BOT_IMAGE_COLS
 / 
BOT_SALIENCY_DENSITY
)

	)

80 
	#MIN_GREEN_THRESHOLD
 (100 * 
IMAGE_WIDTH
 / 640 / 
BOT_SALIENCY_DENSITY
)

	)

90 
	#Y_HIST_MAX_LIMIT
 3

91 
	#X_HIST_MAX_LIMIT
 10

	)

96 
	#HIST_MIN_LIMIT
 3

	)

100 
	#LARGEST_GAP_VERTICAL
 7

	)

101 
	#LARGEST_GAP_HORIZONTAL
 3

	)

105 
	#MINIMUM_GOAL_WIDTH
 3

	)

106 
	#MINIMUM_GOAL_HEIGHT
 20

	)

111 
	#MINIMUM_GOAL_RATIO
 3

	)

116 
	#HIST_GOAL_END_THRESH
 1

	)

123 
	#HIST_GOAL_SEP_THRESH
 7

	)

129 
	#HIST_SKIP_ALLOWANCE
 3

	)

134 
	#MAX_DIST_FOR_GOAL_POST_WIDTH
 4500

	)

144 
	#MINIMUM_TOTAL_GOAL_HEIGHT
 50

	)

149 
	#MINIMUM_GOAL_PARTIAL_RATIO
 1.5

	)

158 
	#MAX_NUM_REGIONS
 200

	)

162 
	#MAX_NUM_SCAN_POINTS
 200

	)

167 
	#BALL_CLASS_THRESH
 1

	)

171 
	#REGION_CLASS_THRESH
 1

	)

176 
	#MINIMUM_SCAN_LENGTH
 0

	)

184 
	#REGION_JOIN_GAP
 5

	)

190 
	#REGION_JOIN_GAP_ON_FIELD_EDGE
 12

	)

195 
	#AVERAGE_SCAN_LENGTH_THRESH
 2

	)

199 
	#MAX_NUM_ROBOT_REGIONS
 20

	)

217 
	#MAX_BALL_EDGE_POINTS
 1000

	)

223 
	#NUM_CENTRE_REPEATS
 40

	)

229 
	#FINE_SCAN_THRESHOLD
 15

	)

235 
	#LARGE_SCAN_THRESHOLD
 150

	)

240 
	#MAXIMUM_BALL_RADIUS
 82

	)

245 
	#MINIMUM_BALL_RADIUS
 2

	)

251 
	#MINIMUM_BALL_WIDTH
 3

	)

257 
	#MINIMUM_NUM_EDGE_POINTS
 3

	)

263 
	#BALL_DISTANCE_TOLERANCE
 3

	)

270 
	#EXCLUDE_BALL_PIXELS
 10

	)

281 
	#NUM_ROBOT_COLOURS_REQUIRED_ABOVE
 3

	)

282 
	#NUM_ROBOT_COLOURS_REQUIRED_BELOW
 15

	)

287 
	#NUM_ROWS_ABOVE
 15

	)

291 
	#MIN_ROBOT_REGION_WIDTH
 4

	)

296 
	#MIN_NUM_WHITE_IN_ROBOT
 5

	)

305 
	#FOOT_RADIUS
 72

	)

314 
	#SURF_SUBSAMPLE
 8

	)

319 
	#SURF_HORIZON_WIDTH
 60

	)

324 
	#SURF_DESCRIPTOR_SAMPLES
 5

	)

329 
	#SURF_DESCRIPTOR_LENGTH
 6

	)

334 
	#MATCH_ITERATIONS
 20

	)

340 
	#PIXEL_ERROR_MARGIN
 5.0f

	)

345 
	#OCTAVES
 4

	)

350 
	#THRESH
 325.125f

	)

355 
	#INIT_SAMPLE
 1

	)

360 
	#VALID_MATCH
 125.f

	)

	@robot/perception/vision/camera/Camera.cpp

32 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”a.hµ
"

33 
	~"uts/Tim”.hµ
"

34 
	~"uts/Logg”.hµ
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
__u32
 
	gcÚŒŞIds
[
NUM_CONTROLS
] =

39 {
V4L2_CID_HFLIP
, 
V4L2_CID_VFLIP
,

40 
V4L2_CID_EXPOSURE_AUTO
,

41 
V4L2_CID_BRIGHTNESS
, 
V4L2_CID_CONTRAST
,

42 
V4L2_CID_SATURATION
, 
V4L2_CID_HUE
,

43 
V4L2_CID_SHARPNESS
,

44 
V4L2_CID_AUTO_WHITE_BALANCE
,

45 
V4L2_CID_BACKLIGHT_COMPENSATION
,

46 
V4L2_CID_EXPOSURE_AUTO
,

47 
V4L2_CID_EXPOSURE
, 
V4L2_CID_GAIN
,

48 
V4L2_CID_DO_WHITE_BALANCE
};

50 cÚ¡ 
	gNUM_CAMERAS
 = 2;

51 
__s32
 
	gcÚŒŞV®ues_lights
[
NUM_CAMERAS
][
NUM_CONTROLS
] =

72 
__s32
 (*
cÚŒŞV®ues
)[
NUM_CONTROLS
] = 
cÚŒŞV®ues_lights
;

74 
	gCam”a
::
	$Cam”a
(è: 
	$dumpFe
(0) {

76 
	}
}

78 
boŞ
 
Cam”a
::
	$¡¬tRecÜdšg
(cÚ¡ *
f’ame
, 
ušt32_t
 
äequ’cy_ms
) {

79 
this
->
äequ’cy_ms
 = frequency_ms;

80 ià(
dumpFe
 !ğ
NULL
) {

81 
	`fşo£
(
dumpFe
);

83 
dumpFe
 = 
	`fİ’
(
f’ame
, "w");

84 
	`Îog
(
INFO
è<< "S¹šg cam”¨dum°tØfe: " << 
f’ame
 << 
’dl
;

85  
dumpFe
 !ğ
NULL
;

86 
	}
}

88 
	gCam”a
::
	$¡İRecÜdšg
() {

89 ià(
dumpFe
 !ğ
NULL
) {

90 
	`fşo£
(
dumpFe
);

91 
dumpFe
 = 
NULL
;

93 
	`Îog
(
INFO
è<< "Fšishšg cam”¨dum°tØfe" << 
’dl
;

94 
	}
}

96 
	gCam”a
::
	$wr™eF¿me
(cÚ¡ 
ušt8_t
*& 
imageTİ
,cÚ¡ ušt8_t*& 
imageBÙ
) {

97 
Tim”
 
t
;

98 
tİSize
 = 1280*960;

99 
bÙSize
 = 640*480;

100 ià(
dumpFe
 !ğ
NULL
 && 
imageTİ
 !ğNULL && 
imageBÙ
 != NULL) {

101 ià(
t
.
	`–­£d_ms
(è>ğ
äequ’cy_ms
) {

102 
t
.
	`»¡¬t
();

103 
	`Îog
(
DEBUG3
è<< "Wr™šg f¿mtØdumpFe" << 
’dl
;

104 
wr™‹n
 = 
	`fwr™e
(
imageTİ
, 
tİSize
*2, 1, 
dumpFe
);

105 
	`Îog
(
DEBUG3
è<< "wrÙ" << 
wr™‹n
 << "İ f¿mes" << 
’dl
;

106 
	`fæush
(
dumpFe
);

107 
wr™‹n
 = 
	`fwr™e
(
imageBÙ
, 
bÙSize
*2, 1, 
dumpFe
);

108 
	`Îog
(
DEBUG3
è<< "wrÙ" << 
wr™‹n
 << " bÙ f¿mes" << 
’dl
;

109 
	`fæush
(
dumpFe
);

112 
	}
}

	@robot/perception/vision/camera/Camera.hpp

1 #iâdeà
PERCEPTION_VISION_CAMERA_CAMERA_H_


2 
	#PERCEPTION_VISION_CAMERA_CAMERA_H_


	)

4 
	~<fú.h
>

5 
	~<¡dšt.h
>

6 
	~<¡dio.h
>

7 
	~<sys/ioùl.h
>

8 
	~<sys/¡©.h
>

9 
	~<sys/ty³s.h
>

10 
	~<uni¡d.h
>

11 
	~<®visiÚ/®visiÚdefš™iÚs.h
>

12 
	~<lšux/videodev2.h
>

14 
	#IMAGE_WIDTH
 640

	)

15 
	#IMAGE_HEIGHT
 480

	)

16 
	#TOP_IMAGE_WIDTH
 1280

	)

17 
	#TOP_IMAGE_HEIGHT
 960

	)

21 
	#NUM_CONTROLS
 14

	)

26 
__u32
 
cÚŒŞIds
[
NUM_CONTROLS
];

31 
__s32
 (*
cÚŒŞV®ues
)[
NUM_CONTROLS
];

33 şas 
	cCam”a
 {

34 
	mpublic
:

35 
Cam”a
();

36 
	mvœtu®
 ~
	$Cam”a
() {}

45 
vœtu®
 cÚ¡ 
ušt8_t
 *
	`g‘
(cÚ¡ 
cŞourS·û
 = 
AL
::
kYUVCŞÜS·û
) =

56 
boŞ
 
	`¡¬tRecÜdšg
(cÚ¡ *
f’ame
, 
ušt32_t
 
äequ’cy_ms
);

61 
	`¡İRecÜdšg
();

70 
vœtu®
 
boŞ
 
	`£tCÚŒŞ
(cÚ¡ 
ušt32_t
 
id
, cÚ¡ 
št32_t
 
v®ue
) = 0;

73 
	`wr™eF¿me
(cÚ¡ 
ušt8_t
*& 
imageTİ
,cÚ¡ ušt8_t*& 
imageBÙ
);

75 
´Ùeùed
:

77 
FILE
 *
dumpFe
;

79 
imageSize
;

82 
ušt32_t
 
äequ’cy_ms
;

83 
	}
};

	@robot/perception/vision/camera/CameraDefinitions.hpp

1 #iâdeà
PERCEPTION_VISION_CAMERA_CAMERADEFINITIONS_H_


2 
	#PERCEPTION_VISION_CAMERA_CAMERADEFINITIONS_H_


	)

5 
	mWHICH_CAMERA_ERROR
 = -1,

6 
	mTOP_CAMERA
 = 0,

7 
	mBOTTOM_CAMERA
 = 1,

8 
	mNUM_CAMERAS
 = 2

9 } 
	tWhichCam”a
;

14 
	#FOCAL_LENGTH
 1

	)

20 
	#CAMERA_FOV_W
 1.06290551

	)

21 
	#TOP_PIXEL_SIZE
 (
	`n
(
CAMERA_FOV_W
 / 2è/ 640)

	)

22 
	#BOT_PIXEL_SIZE
 (
	`n
(
CAMERA_FOV_W
 / 2è/ 320)

	)

29 
	#NECK_TO_TOP_CAMERA
 86.5847

	)

30 
	#NECK_TO_BOTTOM_CAMERA
 53.7234

	)

34 
	#ANGLE_OFFSET_TOP_CAMERA
 -0.82567

	)

35 
	#ANGLE_OFFSET_BOTTOM_CAMERA
 -0.33652

	)

37 
	#ANGLE_BOTTOM_CAMERA
 0.69813

	)

	@robot/perception/vision/camera/CameraToRR.cpp

1 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aToRR.hµ
"

3 
	~"uts/SPLDefs.hµ
"

4 
	~"uts/body.hµ
"

5 
	~"uts/Logg”.hµ
"

6 
	~"uts/basic_m©hs.hµ
"

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	gCam”aToRR
::
	$Cam”aToRR
()

12 
i
 = 0; i < 
IMAGE_COLS
; i++) {

13 
tİEndSÿnCoÜds
[
i
] = 
IMAGE_ROWS
;

14 
bÙEndSÿnCoÜds
[
i
] = 
IMAGE_ROWS
*2;

16 
	}
}

18 
	gCam”aToRR
::~
	$Cam”aToRR
()

20 
	}
}

22 
Cam”aToRR
::
	$upd©eAngËs
(
S’sÜV®ues
 
v®
)

24 
v®ues
 = 
v®
;

25 
	}
}

27 
RRCoÜd
 
	gCam”aToRR
::
	$cÚv”tToRR
(cÚ¡ 
Pošt
 &
p
, 
boŞ
 
isB®l
) const

29  
	`cÚv”tToRR
(
p
.
	`x
 (),….
	`y
 (), 
isB®l
);

30 
	}
}

32 
RRCoÜd
 
	gCam”aToRR
::
	$cÚv”tToRR
(
št16_t
 
i
, iÁ16_ˆ
j
, 
boŞ
 
isB®l
) const

34 
RRCoÜd
 
myloc
 = 
po£
.
	`imageToRobÙR–©ive
(
i
, 
j
, 
isB®l
 ? 35 : 0);

35  
myloc
;

36 
	}
}

38 
Pošt
 
	gCam”aToRR
::
	$cÚv”tToRRXY
(cÚ¡ 
Pošt
 &
p
) const

40 
Pošt
 
myloc
 = 
po£
.
	`imageToRobÙXY
(
p
, 0);

41  
myloc
;

42 
	}
}

44 
RANSACLše
 
	gCam”aToRR
::
	$cÚv”tToRRLše
(cÚ¡ 
RANSACLše
 &
l
) const

46  
	`RANSACLše
(
	`cÚv”tToRRXY
(
l
.
p1
), cÚv”tToRRXYÖ.
p2
));

47 
	}
}

49 
Pošt
 
	gCam”aToRR
::
	$cÚv”tToImageXY
(cÚ¡ 
Pošt
 &
p
) const

51 
Pošt
 
myloc
 = 
po£
.
	`robÙToImageXY
(
p
, 0);

52  
myloc
;

53 
	}
}

56 
	gCam”aToRR
::
	$pix–S•¬©iÚToDi¡ªû
(
pix–S•¬©iÚ
,

57 
»®S•¬©iÚ
) const

59  (
FOCAL_LENGTH
 * 
»®S•¬©iÚ
) /

60 (
TOP_PIXEL_SIZE
 * 
pix–S•¬©iÚ
);

61 
	}
}

63 
boŞ
 
	gCam”aToRR
::
	$isRobÙMovšg
() const

65  
Œue
;

66 
	}
}

68 
	gCam”aToRR
::
	$fšdEndSÿnV®ues
() {

69 cÚ¡ 
exşusiÚRes
 = 
Po£
::
EXCLUSION_RESOLUTION
;

70 cÚ¡ 
št16_t
 *
tİPošts
 = 
po£
.
	`g‘TİExşusiÚA¼ay
();

71 cÚ¡ 
št16_t
 *
bÙPošts
 = 
po£
.
	`g‘BÙExşusiÚA¼ay
();

72 
i
 = 0; i < 
TOP_IMAGE_COLS
; ++i) {

73 ià(
tİPošts
[(
i
 * 
exşusiÚRes
)/
TOP_IMAGE_COLS
] < 
IMAGE_ROWS
) {

74 
tİEndSÿnCoÜds
[
i
] = 
tİPošts
[(˜* 
exşusiÚRes
)/
TOP_IMAGE_COLS
];

76 
tİEndSÿnCoÜds
[
i
] = 
IMAGE_ROWS
;

79 
i
 = 0; i < 
BOT_IMAGE_COLS
; ++i) {

80 ià(
bÙPošts
[(
i
 * 
exşusiÚRes
)/
BOT_IMAGE_COLS
] < 
IMAGE_ROWS
) {

81 
bÙEndSÿnCoÜds
[
i
] = 
bÙPošts
[(˜* 
exşusiÚRes
)/
BOT_IMAGE_COLS
];

83 
bÙEndSÿnCoÜds
[
i
] = 
IMAGE_ROWS
*2;

86 
	}
}

	@robot/perception/vision/camera/CameraToRR.hpp

1 #iâdeà
PERCEPTION_VISION_CAMERA_CAMERATORR_H_


2 
	#PERCEPTION_VISION_CAMERA_CAMERATORR_H_


	)

4 
	~<¡dšt.h
>

5 
	~<m©h.h
>

7 
	~"ty³s/RRCoÜd.hµ
"

8 
	~"ty³s/S’sÜV®ues.hµ
"

9 
	~"ty³s/RRCoÜd.hµ
"

10 
	~"ty³s/S’sÜV®ues.hµ
"

11 
	~"ty³s/Pošt.hµ
"

12 
	~"ty³s/Rª§cTy³s.hµ
"

14 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”a.hµ
"

15 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

16 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aDefš™iÚs.hµ
"

17 
	~"³rû±iÚ/kšem©ics/Po£.hµ
"

28 şas 
	cCam”aToRR
 {

29 
	mpublic
:

30 
Cam”aToRR
();

31 ~
Cam”aToRR
();

34 
upd©eAngËs
(
S’sÜV®ues
 
v®ues
);

35 
S’sÜV®ues
 
	mv®ues
;

37 
RRCoÜd
 
	$cÚv”tToRR
(
št16_t
 
i
, iÁ16_ˆ
j
, 
boŞ
 
isB®l
) const;

38 
RRCoÜd
 
	$cÚv”tToRR
(cÚ¡ 
Pošt
 &
p
, 
boŞ
 
isB®l
) const;

39 
Pošt
 
	$cÚv”tToRRXY
(cÚ¡ 
Pošt
 &
p
) const;

40 
RANSACLše
 
	$cÚv”tToRRLše
(cÚ¡ 
RANSACLše
 &
l
) const;

41 
Pošt
 
	$cÚv”tToImageXY
(cÚ¡ 
Pošt
 &
p
) const;

43 
Po£
 
po£
;

44 
	$pix–S•¬©iÚToDi¡ªû
(
pix–S•¬©iÚ
, 
»®S•¬©iÚ
) const;

45 
boŞ
 
	$isRobÙMovšg
() const;

52 
	`fšdEndSÿnV®ues
();

54 
tİEndSÿnCoÜds
[
IMAGE_COLS
];

55 
bÙEndSÿnCoÜds
[
IMAGE_COLS
];

	@robot/perception/vision/camera/CombinedCamera.cpp

1 
	~"³rû±iÚ/visiÚ/ÿm”a/CombšedCam”a.hµ
"

2 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”a.hµ
"

4 
Cam”a
 *
	gCombšedCam”a
::
tİ_ÿm”a_
 = 
NULL
;

5 
Cam”a
 *
	gCombšedCam”a
::
bÙ_ÿm”a_
 = 
NULL
;

7 
	gCombšedCam”a
::
	$CombšedCam”a
(

8 
boŞ
 
dumpäames
,

9 
dum´©e
,

10 
¡ršg
 
dumpfe


12 ià(
dumpäames
) {

14 
tİ_ÿm”a_
->
	`¡¬tRecÜdšg
(
dumpfe
.
	`c_¡r
(), 
dum´©e
);

16 
	}
}

18 
Cam”a
* 
	gCombšedCam”a
::
	$g‘Cam”a
() {

19  
tİ_ÿm”a_
;

20 
	}
}

22 
	gCombšedCam”a
::~
	$CombšedCam”a
(){

24 
tİ_ÿm”a_
->
	`¡İRecÜdšg
();

25 
	}
}

27 cÚ¡ 
ušt8_t
* 
	gCombšedCam”a
::
	$g‘F¿meTİ
() {

28  
tİ_ÿm”a_
->
	`g‘
();

29 
	}
}

31 cÚ¡ 
ušt8_t
* 
	gCombšedCam”a
::
	$g‘F¿meBÙtom
() {

32  
bÙ_ÿm”a_
->
	`g‘
();

33 
	}
}

35 
Cam”a
* 
	gCombšedCam”a
::
	$g‘Cam”aTİ
() {

36  
tİ_ÿm”a_
;

37 
	}
}

38 
Cam”a
* 
	gCombšedCam”a
::
	$g‘Cam”aBÙ
() {

39  
bÙ_ÿm”a_
;

40 
	}
}

41 
	gCombšedCam”a
::
	$£tCam”aTİ
(
Cam”a
* 
ÿm”a
) {

42 
tİ_ÿm”a_
 = 
ÿm”a
;

43 
	}
}

44 
	gCombšedCam”a
::
	$£tCam”aBÙ
(
Cam”a
* 
ÿm”a
) {

45 
bÙ_ÿm”a_
 = 
ÿm”a
;

46 
	}
}

48 
CombšedCam”aS‘tšgs
 
	gCombšedCam”a
::
	$g‘Cam”aS‘tšgs
(){

49 
NaoCam”a
* 
tİ
 = (NaoCam”a*)(
tİ_ÿm”a_
);

50 
NaoCam”a
* 
bÙ
 = (NaoCam”a*)(
bÙ_ÿm”a_
);

52 
CombšedCam”aS‘tšgs
 
£‰šgs
;

53 
£‰šgs
.
tİ_ÿm”a_£‰šgs
 = 
tİ
->
tİCam”aS‘tšgs
;

54 
£‰šgs
.
bÙ_ÿm”a_£‰šgs
 = 
bÙ
->
bÙCam”aS‘tšgs
;

55  
£‰šgs
;

56 
	}
}

	@robot/perception/vision/camera/CombinedCamera.hpp

1 #iâdeà
PERCEPTION_VISION_CAMERA_COMBINEDCAMERA_H_


2 
	#PERCEPTION_VISION_CAMERA_COMBINEDCAMERA_H_


	)

4 
	~<¡ršg
>

6 
	~"Cam”a.hµ
"

7 
	~"ty³s/CombšedF¿me.hµ
"

8 
	~"ty³s/CombšedCam”aS‘tšgs.hµ
"

10 
usšg
 
	g¡d
::
¡ršg
;

23 şas 
	cCombšedCam”a
 {

24 
	mpublic
:

31 
CombšedCam”a
(

32 
boŞ
 
dumpäames
 = 
çl£
,

33 
dum´©e
 = 0,

34 
¡ršg
 
dumpfe
 = ""

36 ~
CombšedCam”a
();

38 
Cam”a
* 
g‘Cam”a
();

46 cÚ¡ 
ušt8_t
 * 
g‘F¿meTİ
();

47 cÚ¡ 
ušt8_t
 * 
g‘F¿meBÙtom
();

48 
Cam”a
* 
g‘Cam”aTİ
();

49 
Cam”a
* 
g‘Cam”aBÙ
();

50 
£tCam”aTİ
(
Cam”a
* 
ÿm”a
);

51 
£tCam”aBÙ
(
Cam”a
* 
ÿm”a
);

59 
CombšedCam”aS‘tšgs
 
g‘Cam”aS‘tšgs
();

61 
	m´iv©e
:

62 
Cam”a
 *
tİ_ÿm”a_
;

63 
Cam”a
 *
	mbÙ_ÿm”a_
;

	@robot/perception/vision/camera/NaoCamera.cpp

32 
	~<m®loc.h
>

33 
	~<lim™s.h
>

34 
	~<¡dio.h
>

35 
	~<sys/mmª.h
>

36 
	~<sys/¡©.h
>

37 
	~<sys/ty³s.h
>

38 
	~<uni¡d.h
>

39 
	~<ÿs£¹
>

40 
	~<û¼no
>

41 
	~<c¡ršg
>

42 
	~<ùime
>

43 
	~<io¡»am
>

44 
	~<¡dexû±
>

45 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”a.hµ
"

46 
	~"uts/Logg”.hµ
"

47 
	~"uts/¥“ch.hµ
"

48 
	~"uts/Tim”.hµ
"

50 
usšg
 
Çme¥aû
 
	g¡d
;

56 
šlše
 
	$”ºo_throw
(cÚ¡ *
s
) {

57 
	`Îog
(
ERROR
è<< 
s
 << "ƒ¼Ü "<< 
”ºo
 << ", " << 
	`¡»¼Ü
Ó¼noè<< 
’dl
;

58 
throw
 
	`ruÁime_”rÜ
(
	`¡»¼Ü
(
”ºo
));

59 
	}
}

65 
	#CLEAR
(
x
è
	`mem£t
(&(x), 0, (x))

	)

67 
boŞ
 
	gNaoCam”a
::
	$£tCÚŒŞ
(cÚ¡ 
ušt32_t
 
cÚŒŞId
,

68 cÚ¡ 
št32_t
 
cÚŒŞV®ue
) {

69 ià(
v4lDeviûP
) {

70 
v4l2_cÚŒŞ
 
cÚŒŞ
;

71 
	`CLEAR
(
cÚŒŞ
);

72 ià(
cÚŒŞId
 < 
V4L2_CID_BASE
)

73 
cÚŒŞ
.
id
 = 
V4L2_CID_BASE
 + 
cÚŒŞId
;

75 
cÚŒŞ
.
id
 = 
cÚŒŞId
;

76 
cÚŒŞ
.
v®ue
 = 
cÚŒŞV®ue
;

78 
v4l2_cÚŒŞ
 
cu¼’t
;

79 
	`CLEAR
(
cu¼’t
);

80 
cu¼’t
.
id
 = 
cÚŒŞ
.id;

81 
	`ioùl
 (
fd
, 
VIDIOC_G_CTRL
, &
cu¼’t
);

82 
¡d
::
cout
 << 
fd
 << " - S‘ id " << 
cÚŒŞId
 <<

83 " \033[36m" << 
CAMERA_CONTROL_VALUE_MAP
[
cÚŒŞId
] <<

84 ": " << 
cÚŒŞV®ue
 << "\033[0m " << 
¡d
::
’dl
;

85 
cu¼’t
.
v®ue
 !ğ
cÚŒŞV®ue
) {

88 
	`ioùl
(
fd
, 
VIDIOC_S_CTRL
, &
cÚŒŞ
);

89 
	`ioùl
 (
fd
, 
VIDIOC_G_CTRL
, &
cu¼’t
);

100  
Œue
;

102 
	`Îog
(
WARNING
) << "triedo change settings on‡ file,‚ot‡ v4l device";

103  
çl£
;

105 
	}
}

107 
	#CAMERA_FRAMERATE
 30

	)

109 
usšg
 
Çme¥aû
 
	gAL
;

114 
	gNaoCam”a
::
	$NaoCam”a
(
BÏckbßrd
 *
bÏckbßrd
, cÚ¡ *
f’ame
, cÚ¡ 
IOM‘hod
 
m‘hod
,

115 cÚ¡ 
fÜm©
):

116 
	`f’ame
(
f’ame
), 
	`io
(
m‘hod
), 
	$fÜm©
(
fÜm©
) {

118 
	`»adCam”aS‘tšgs
(
bÏckbßrd
);

120 
	`İ’_deviû
();

122 
¡©
 
buf
;

123 ià(
	`f¡©
(
fd
, &
buf
) < 0) {

124 
	`Îog
(
ERROR
è<< "çedØ¡© " << 
f’ame
 << 
’dl
;

125 
throw
 
	`ruÁime_”rÜ
("inside NaoCamera.cpp, failedo stat camera");

127 
v4lDeviûP
 = 
	`S_ISCHR
(
buf
.
¡_mode
);

130 
	`£tCÚŒŞ
(
V4L2_CID_CAM_INIT
, 0);

133 
	`şo£_deviû
();

134 
	`İ’_deviû
();

136 
	`š™_bufãrs
();

139 ià(!
	`š™_ÿm”a
()) {

140 
	`Îog
(
FATAL
) << "Error initializing camera!\n";

141 
throw
 
	`ruÁime_”rÜ
("Error initializing camera");

145 
	`¡¬t_ÿ±uršg
();

149 
	`¡İ_ÿ±uršg
();

151 ià(!
	`š™_ÿm”a
()) {

152 
	`Îog
(
FATAL
) << "Error initializing second camera!\n";

153 
throw
 
	`ruÁime_”rÜ
("Error initializing second camera");

155 
	`¡¬t_ÿ±uršg
();

156 
dumpFe
 = 
NULL
;

157 
	}
}

163 
	gNaoCam”a
::
	$NaoCam”a
(
BÏckbßrd
 *
bÏckbßrd
, cÚ¡ *
f’ame
, cÚ¡ 
IOM‘hod
 
m‘hod
,

164 cÚ¡ 
fÜm©
,

165 
dummy
, cÚ¡ 
¡d
::
¡ršg
 
ÿm”aChoiû
):

166 
	`f’ame
(
f’ame
), 
	`io
(
m‘hod
), 
	`fÜm©
(
fÜm©
),

167 
	$ÿm”aChoiû
(
ÿm”aChoiû
)

169 
	`»adCam”aS‘tšgs
(
bÏckbßrd
);

170 
	}
}

173 
	gNaoCam”a
::
	$»adCam”aS‘tšgs
(
BÏckbßrd
 *
bÏckbßrd
) {

174 
	`»adCam”aS‘tšgs
(
bÏckbßrd
, 
tİCam”aS‘tšgs
, 
¡d
::
	`¡ršg
("camera.top"));

175 
	`»adCam”aS‘tšgs
(
bÏckbßrd
, 
bÙCam”aS‘tšgs
, 
¡d
::
	`¡ršg
("camera.bot"));

176 
	}
}

178 
	gNaoCam”a
::
	$»adCam”aS‘tšgs
(
BÏckbßrd
 *
bÏckbßrd
,

179 
Cam”aS‘tšgs
 &
£‰šgs
, 
¡d
::
¡ršg
 
ÿm”aName
) {

180 
£‰šgs
.
hæ
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".hæ").
	`c_¡r
()].
as
<>();

181 
£‰šgs
.
væ
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".væ").
	`c_¡r
()].
as
<>();

182 
£‰šgs
.
brighŠess
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".brighŠess").
	`c_¡r
()].
as
<>();

183 
£‰šgs
.
cÚŒa¡
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".cÚŒa¡").
	`c_¡r
()].
as
<>();

184 
£‰šgs
.
§tu¿tiÚ
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".§tu¿tiÚ").
	`c_¡r
()].
as
<>();

185 
£‰šgs
.
hue
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".hue").
	`c_¡r
()].
as
<>();

186 
£‰šgs
.
sh¬²ess
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".sh¬²ess").
	`c_¡r
()].
as
<>();

187 
£‰šgs
.
backlightCom³n§tiÚ
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".backlightcom³n§tiÚ").
	`c_¡r
()].
as
<>();

188 
£‰šgs
.
exposu»
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".exposu»").
	`c_¡r
()].
as
<>();

189 
£‰šgs
.
gaš
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".gaš").
	`c_¡r
()].
as
<>();

190 
£‰šgs
.
wh™eB®ªû
 = 
bÏckbßrd
->
cÚfig
[(
ÿm”aName
 + ".wh™eb®ªû").
	`c_¡r
()].
as
<>();

191 
	}
}

193 
	gNaoCam”a
::
	$£tCam”aS‘tšgs
(cÚ¡ 
Cam”aS‘tšgs
 
£‰šgs
) {

194 
	`£tCÚŒŞ
(
V4L2_CID_HFLIP
, 
£‰šgs
.
hæ
);

195 
	`£tCÚŒŞ
(
V4L2_CID_VFLIP
, 
£‰šgs
.
væ
);

196 
	`£tCÚŒŞ
(
V4L2_CID_AUTO_WHITE_BALANCE
, 1);

197 
	`£tCÚŒŞ
(
V4L2_CID_EXPOSURE_AUTO
, 1);

198 
	`£tCÚŒŞ
(
V4L2_CID_BRIGHTNESS
, 
£‰šgs
.
brighŠess
);

199 
	`£tCÚŒŞ
(
V4L2_CID_CONTRAST
, 
£‰šgs
.
cÚŒa¡
);

200 
	`£tCÚŒŞ
(
V4L2_CID_SATURATION
, 
£‰šgs
.
§tu¿tiÚ
);

201 
	`£tCÚŒŞ
(
V4L2_CID_HUE
, 
£‰šgs
.
hue
);

202 
	`£tCÚŒŞ
(
V4L2_CID_SHARPNESS
, 
£‰šgs
.
sh¬²ess
);

204 
	`£tCÚŒŞ
(
V4L2_CID_BACKLIGHT_COMPENSATION
, 
£‰šgs
.
backlightCom³n§tiÚ
);

215 
	`£tCÚŒŞ
(
V4L2_CID_EXPOSURE_ALGORITHM
, 3);

218 
	}
}

220 
	gNaoCam”a
::~
	$NaoCam”a
() {

221 
	`¡İ_ÿ±uršg
();

222 
	`unš™_bufãrs
();

223 
	`şo£_deviû
();

224 
	}
}

226 
boŞ
 
	gNaoCam”a
::
	$imgDim’siÚs
(*cÚ¡ 
width
, *cÚ¡ 
height
) {

227 
fÜm©
) {

228 
k960p
:

229 *
width
 = 1280;

230 *
height
 = 960;

232 
kVGA
:

233 *
width
 = 640;

234 *
height
 = 480;

236 
kQVGA
:

237 *
width
 = 320;

238 *
height
 = 240;

240 
kQQVGA
:

241 *
width
 = 160;

242 *
height
 = 120;

245  
çl£
;

247  
Œue
;

248 
	}
}

250 cÚ¡ 
ušt8_t
 *
	gNaoCam”a
::
	$»ad_äame
() {

251 
i
;

252 cÚ¡ 
ušt8_t
 *
image
 = 
NULL
;

253 
io
) {

255 
IO_METHOD_READ
:

256 ià(-1 =ğ
	`»ad
(
fd
, 
bufãrs
[0].
¡¬t
, bufãrs[0].
Ëngth
)) {

257 
”ºo
) {

258 
EAGAIN
:

259  
çl£
;

261 
EIO
:

267 
	`”ºo_throw
("read");

271 
image
 = 
bufãrs
[0].
¡¬t
;

275 
IO_METHOD_MMAP
:

276 ià(
Ï¡Dequeued
.
šdex
 !ğ
UINT_MAX
) {

277 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_QBUF
, &
Ï¡Dequeued
)) {

278 
	`”ºo_throw
("VIDEOC_BUF");

282 
	`CLEAR
(
Ï¡Dequeued
);

284 
Ï¡Dequeued
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

285 
Ï¡Dequeued
.
memÜy
 = 
V4L2_MEMORY_MMAP
;

287 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_DQBUF
, &
Ï¡Dequeued
)) {

288 
”ºo
) {

289 
EAGAIN
:

290  
çl£
;

292 
EIO
:

294 
¡d
::
cout
 << "eio" << std::
’dl
;

297 
EFAULT
:

298 
¡d
::
cout
 << "eçuÉ" << std::
’dl
;

300 
EINVAL
:

301 
¡d
::
cout
 << "ešv®" << std::
’dl
;

304 
¡d
::
cout
 << "lŞ mm­" << std::
’dl
;

305 
	`”ºo_throw
("VIDIOC_DQBUF");

309 
	`as£¹
(
Ï¡Dequeued
.
šdex
 < 
n_bufãrs
);

311 
image
 = 
bufãrs
[
Ï¡Dequeued
.
šdex
].
¡¬t
;

315 
IO_METHOD_USERPTR
:

317 ià(
Ï¡Dequeued
.
šdex
 !ğ
UINT_MAX
) {

318 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_QBUF
, &
Ï¡Dequeued
)) {

319 
	`”ºo_throw
("VIDEOC_BUF");

323 
	`CLEAR
(
Ï¡Dequeued
);

325 
Ï¡Dequeued
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

326 
Ï¡Dequeued
.
memÜy
 = 
V4L2_MEMORY_USERPTR
;

328 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_DQBUF
, &
Ï¡Dequeued
)) {

329 
”ºo
) {

330 
EAGAIN
:

331  
çl£
;

333 
EIO
:

339 
¡d
::
cout
 << "lŞ u£r?" << std::
’dl
;

340 
	`”ºo_throw
("VIDIOC_DQBUF");

344 
i
 = 0; i < 
n_bufãrs
; ++i)

345 ià(
Ï¡Dequeued
.
m
.
u£½Œ
 =ğ(
ušt32_t
è
bufãrs
[
i
].
¡¬t


346 && 
Ï¡Dequeued
.
Ëngth
 =ğ
bufãrs
[
i
].length)

349 
	`as£¹
(
i
 < 
n_bufãrs
);

351 
image
 =(cÚ¡ 
ušt8_t
*è
Ï¡Dequeued
.
m
.
u£½Œ
;

356 
throw
 
	`ruÁime_”rÜ
("what kind of IO method ishat?!?!?");

359  
image
;

360 
	}
}

362 cÚ¡ 
ušt8_t
 *
	gNaoCam”a
::
	$g‘
(cÚ¡ 
cŞourS·û
) {

363 ià(
cŞourS·û
 !ğ
kYUVCŞÜS·û
)

364 
throw
 
	`ruÁime_”rÜ
("only yuv422 is supported!");

365 
fd_£t
 
fds
;

366 
timev®
 
tv
;

367 
r
;

368 
	`FD_ZERO
(&
fds
);

369 
	`FD_SET
(
fd
, &
fds
);

372 
tv
.
tv_£c
 = 0;

373 
tv
.
tv_u£c
 = 100000;

375 ià(
io
 =ğ
IO_METHOD_MMAP
) {

376 
£Ëù
:

377 
r
 = 
	`£Ëù
(
fd
 + 1, &
fds
, 
NULL
, NULL, &
tv
);

379 ià(-1 =ğ
r
) {

380 ià(
EINTR
 =ğ
”ºo
)

381 
£Ëù
;

383 
	`”ºo_throw
("select");

386 ià(0 =ğ
r
)

387 
	`Îog
(
ERROR
) << "selectimeout\n";

390 cÚ¡ 
ušt8_t
 *
image
 = 
	`»ad_äame
();

392 
	`Îog
(
DEBUG2
è<< "imag»tuºšg from NaoCam”a: " << (*)
image
 << 
’dl
;

393  
image
;

394 
	}
}

396 
boŞ
 
	gNaoCam”a
::
	$š™_ÿm”a
() {

397 ià(
v4lDeviûP
) {

399 
v4l2_¡d_id
 
esid0
;

400 
	`CLEAR
 (
esid0
);

401 
‹¡
;

402 
‹¡
 = 
	`ioùl
(
fd
, 
VIDIOC_G_STD
, &
esid0
);

403 ià(
‹¡
 != 0) {

404 
	`³¼Ü
("ioctl 1");

405 
	`Îog
(
ERROR
è<< "çed ioùÈw™hƒ¼Ü cod" << 
‹¡
 << 
’dl
;

406 
throw
 
	`ruÁime_”rÜ
("inside NaoCamera.cpp, failed ioctl");

410 
fÜm©
) {

417 
k960p
:

418 
esid0
 =(
v4l2_¡d_id
)0x08000000;

420 
kVGA
:

421 
esid0
 =(
v4l2_¡d_id
)0x08000000;

423 
kQVGA
:

424 
esid0
 =(
v4l2_¡d_id
)0x04000000;

427 
throw
 
	`ruÁime_”rÜ
("inside NaoCamera.cpp, unknown format");

429 
‹¡
 = 
	`ioùl
(
fd
, 
VIDIOC_S_STD
, &
esid0
);

430 ià(
‹¡
 != 0) {

431 
	`³¼Ü
("ioctl 2");

432 
	`Îog
(
ERROR
è<< "çed ioùÈ2ƒ¼Ü " << 
‹¡
 << 
’dl
;

435 
v4l2_fÜm©
 
fmt0
;

436 
	`mem£t
(&
fmt0
, 0, (fmt0));

437 
fmt0
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

438 
fmt0
.
fmt
.
pix
.
f›ld
 = 
V4L2_FIELD_NONE
;

440 
fÜm©
) {

441 
k960p
:

442 
fmt0
.
fmt
.
pix
.
width
 = 1280;

443 
fmt0
.
fmt
.
pix
.
height
 = 960;

445 
kVGA
:

446 
fmt0
.
fmt
.
pix
.
width
 = 640;

447 
fmt0
.
fmt
.
pix
.
height
 = 480;

449 
kQVGA
:

450 
fmt0
.
fmt
.
pix
.
width
 = 320;

451 
fmt0
.
fmt
.
pix
.
height
 = 240;

454 
throw
 
	`ruÁime_”rÜ
("inside NaoCamera.cpp, unknown format");

459 
fmt0
.
fmt
.
pix
.
pix–fÜm©
 = 
V4L2_PIX_FMT_YUYV
;

460 
‹¡
 = 
	`ioùl
(
fd
, 
VIDIOC_S_FMT
, &
fmt0
);

461 ià(
‹¡
 != 0) {

462 
	`³¼Ü
("ioctl 3");

463 
	`Îog
(
ERROR
è<< "çed ioùÈ3ƒ¼Ü" << 
‹¡
 << 
’dl
;

464 
throw
 
	`ruÁime_”rÜ
("NaoCamera.cpp, failed ioctl 3");

468 
v4l2_¡»am·rm
 
·rm
;

469 
	`CLEAR
(
·rm
);

471 
·rm
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

472 
‹¡
 = 
	`ioùl
(
fd
, 
VIDIOC_G_PARM
, &
·rm
);

473 ià(
‹¡
 != 0) {

474 
	`³¼Ü
("ioctl 4");

475 
	`Îog
(
ERROR
è<< "çed ioùÈ4" << 
’dl
;

476 
throw
 
	`ruÁime_”rÜ
("NaoCamera.cpp, failed ioctl 4");

478 
·rm
.·rm.
ÿ±u»
.
tim•”äame
.
num”©Ü
 = 1;

479 
·rm
.·rm.
ÿ±u»
.
tim•”äame
.
d’omš©Ü
 = 
CAMERA_FRAMERATE
;

480 
·rm
.·rm.
ÿ±u»
.
ÿ·b™y
 = 
V4L2_CAP_TIMEPERFRAME
;

481 
	`ioùl
(
fd
, 
VIDIOC_S_PARM
, &
·rm
);

483 
imageSize
 = 
fmt0
.
fmt
.
pix
.
sizeimage
;

485 ià(
ÿm”aChoiû
 == "camera.top") {

486 
	`£tCam”aS‘tšgs
(
tİCam”aS‘tšgs
);

488 ià(
ÿm”aChoiû
 == "camera.bot") {

489 
	`£tCam”aS‘tšgs
(
bÙCam”aS‘tšgs
);

492 
	`Îog
(
ERROR
è<< "çedØ£ˆÿm”¨£‰šg fÜ cam”aChoiû: " << 
ÿm”aChoiû
 << 
’dl
;

493 
throw
 
	`ruÁime_”rÜ
("NaoCam”a.ıp, unknowÀÿm”aChoiû: "+ 
ÿm”aChoiû
);

497  
Œue
;

498 
	}
}

500 
	gNaoCam”a
::
	$¡İ_ÿ±uršg
() {

501 
v4l2_buf_ty³
 
ty³
;

503 
io
) {

504 
IO_METHOD_READ
:

508 
IO_METHOD_MMAP
:

509 
IO_METHOD_USERPTR
:

510 
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

512 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_STREAMOFF
, &
ty³
))

513 
	`”ºo_throw
("VIDIOC_STREAMOFF");

517 
throw
 
	`ruÁime_”rÜ
("unknown io method");

520 
	}
}

522 
	gNaoCam”a
::
	$unš™_bufãrs
() {

523 
i
;

525 
io
) {

526 
IO_METHOD_READ
:

527 
	`ä“
(
bufãrs
[0].
¡¬t
);

530 
IO_METHOD_MMAP
:

531 
i
 = 0; i < 
n_bufãrs
; ++i)

532 ià(-1 =ğ
	`munm­
(
bufãrs
[
i
].
¡¬t
, bufãrs[i].
Ëngth
))

533 
	`”ºo_throw
("munmap");

536 
IO_METHOD_USERPTR
:

537 
i
 = 0; i < 
n_bufãrs
; ++i)

538 
	`ä“
(
bufãrs
[
i
].
¡¬t
);

541 
throw
 
	`ruÁime_”rÜ
("unknown io method");

544 
	}
}

546 
	gNaoCam”a
::
	$İ’_deviû
() {

547 
fd
 = 
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_CLOEXEC
 | 
O_RDWR
);

549 ià(
fd
 < 0) {

550 
	`Îog
(
ERROR
è<< "çedØİ’ " << 
f’ame
 << 
’dl
;

551 
	`¦“p
(5);

552 
	`SAY
(
	`¡ršg
("dev videØ"è+ 
	`¡»¼Ü
(
”ºo
), 
Œue
);

553 
throw
 
	`ruÁime_”rÜ
("inside NaoCamera.cpp, failedo open camera");

555 
	}
}

557 
	gNaoCam”a
::
	$şo£_deviû
() {

558 ià(-1 =ğ
	`şo£
(
fd
))

559 
	`”ºo_throw
("close");

561 
fd
 = -1;

562 
	}
}

564 
	gNaoCam”a
::
	$š™_mm­
() {

565 
v4l2_»que¡bufãrs
 
»q
;

567 
	`CLEAR
(
»q
);

569 
»q
.
couÁ
 = 
NUM_FRAME_BUFFERS
;

570 
»q
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

571 
»q
.
memÜy
 = 
V4L2_MEMORY_MMAP
;

573 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_REQBUFS
, &
»q
)) {

574 ià(
EINVAL
 =ğ
”ºo
) {

575 
	`Îog
(
ERROR
è<< "memÜy m­pšg‚Ù suµÜ‹d oÀthi deviû!" << 
’dl
;

576 
	`ex™
(
EXIT_FAILURE
);

578 
	`”ºo_throw
("VIDIOC_REQBUFS");

582 ià(
»q
.
couÁ
 < 1) {

583 
	`Îog
(
ERROR
è<< "Insuffic›Á bufã¸memÜy" << 
’dl
;

584 
throw
 
	`ruÁime_”rÜ
("Insufficient buffer memory");

587 
	`CLEAR
(
bufãrs
);

589 ià(!
bufãrs
) {

590 
	`Îog
(
ERROR
) << "Out of memory\n";

591 
	`ex™
(
EXIT_FAILURE
);

594 
n_bufãrs
 = 0;‚_bufãr < 
»q
.
couÁ
; ++n_buffers) {

595 
v4l2_bufãr
 
buf
;

597 
	`CLEAR
(
buf
);

599 
buf
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

600 
buf
.
memÜy
 = 
V4L2_MEMORY_MMAP
;

601 
buf
.
šdex
 = 
n_bufãrs
;

603 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_QUERYBUF
, &
buf
))

604 
	`”ºo_throw
("VIDIOC_QUERYBUF");

606 
bufãrs
[
n_bufãrs
].
Ëngth
 = 
buf
.length;

607 
bufãrs
[
n_bufãrs
].
¡¬t
 = 
»š‹½»t_ÿ¡
<
ušt8_t
*>

608 (
	`mm­
(
NULL
 ,

609 
buf
.
Ëngth
,

610 
PROT_READ
 | 
PROT_WRITE
 ,

611 
MAP_SHARED
 ,

612 
fd
, 
buf
.
m
.
off£t
));

614 ià(
MAP_FAILED
 =ğ
bufãrs
[
n_bufãrs
].
¡¬t
)

615 
	`”ºo_throw
("mmap");

617 
	}
}

619 
	gNaoCam”a
::
	$š™_bufãrs
() {

620 ià(
v4lDeviûP
) {

621 
v4l2_ÿ·b™y
 
ÿp
;

622 
v4l2_üİÿp
 
üİÿp
;

623 
v4l2_üİ
 
üİ
;

624 
v4l2_fÜm©
 
fmt
;

625 
v4l2_¡d_id
 
esid0
;

626 
mš
;

628 
	`CLEAR
(
ÿp
);

629 
	`CLEAR
(
üİÿp
);

630 
	`CLEAR
(
üİ
);

631 
	`CLEAR
(
fmt
);

632 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_QUERYCAP
, &
ÿp
)) {

633 ià(
EINVAL
 =ğ
”ºo
) {

634 
	`Îog
(
ERROR
è<< "nÙ‡ÀV4L2 deviû" << 
’dl
;

635 
throw
 
	`ruÁime_”rÜ
("not‡ v4l2 device");

637 
	`”ºo_throw
("VIDIOC_QUERYCAP");

641 ià(!(
ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_VIDEO_CAPTURE
)) {

642 
	`Îog
(
ERROR
è<< "nÙ‡ videØÿ±u» deviû" << 
’dl
;

643 
throw
 
	`ruÁime_”rÜ
("not‡ video capture device");

646 
io
) {

647 
IO_METHOD_READ
:

648 ià(!(
ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_READWRITE
)) {

649 
	`Îog
(
ERROR
è<< "dÛ nÙ suµÜˆ»ad i/o" << 
’dl
;

650 
throw
 
	`ruÁime_”rÜ
("does‚ot support„ead i/o");

655 
IO_METHOD_MMAP
:

656 
IO_METHOD_USERPTR
:

657 ià(!(
ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_STREAMING
)) {

658 
	`Îog
(
ERROR
è<< "dÛ nÙ suµÜˆ¡»amšg i/o" << 
’dl
;

659 
throw
 
	`ruÁime_”rÜ
("does‚ot support streaming i/o");

665 
throw
 
	`ruÁime_”rÜ
("what kind of IO method ishat?!?!?");

672 
	`CLEAR
(
üİÿp
);

674 
üİÿp
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

676 ià(0 =ğ
	`ioùl
(
fd
, 
VIDIOC_CROPCAP
, &
üİÿp
)) {

677 
üİ
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

678 
üİ
.
c
 = 
üİÿp
.
deäeù
;

680 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_S_CROP
, &
üİ
)) {

681 
”ºo
) {

682 
EINVAL
:

694 
fÜm©
) {

701 
k960p
:

702 
esid0
 = 0x08000000UL;

704 
kVGA
:

705 
esid0
 = 0x08000000UL;

707 
kQVGA
:

708 
esid0
 = 0x04000000UL;

711 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_S_STD
, &
esid0
))

712 
	`”ºo_throw
("VIDIOC_S_STD");

714 
	`CLEAR
(
fmt
);

716 
fmt
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

717 
fÜm©
) {

718 
k960p
:

719 
fmt
.fmt.
pix
.
width
 = 1280;

720 
fmt
.fmt.
pix
.
height
 = 960;

722 
kVGA
:

723 
fmt
.fmt.
pix
.
width
 = 640;

724 
fmt
.fmt.
pix
.
height
 = 480;

726 
kQVGA
:

727 
fmt
.fmt.
pix
.
width
 = 320;

728 
fmt
.fmt.
pix
.
height
 = 240;

731 
fmt
.fmt.
pix
.
pix–fÜm©
 = 
V4L2_PIX_FMT_YUYV
;

732 
fmt
.fmt.
pix
.
f›ld
 = 
V4L2_FIELD_NONE
;

734 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_G_FMT
, &
fmt
))

735 
	`”ºo_throw
("VIDIOC_G_FMT");

737 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_S_FMT
, &
fmt
))

738 
	`”ºo_throw
("VIDIOC_S_FMT");

743 
mš
 = 
fmt
.fmt.
pix
.
width
 * 2;

744 ià(
fmt
.fmt.
pix
.
by‹¥”lše
 < 
mš
)

745 
fmt
.fmt.
pix
.
by‹¥”lše
 = 
mš
;

746 
mš
 = 
fmt
.fmt.
pix
.
by‹¥”lše
 * fmt.fmt.pix.
height
;

747 ià(
fmt
.fmt.
pix
.
sizeimage
 < 
mš
)

748 
fmt
.fmt.
pix
.
sizeimage
 = 
mš
;

750 
imageSize
 = 
fmt
.fmt.
pix
.
sizeimage
;

752 
	`Îog
(
INFO
è<< "nØÃedØš™ bufãr fÜ fes" << 
’dl
;

755 
io
) {

756 
IO_METHOD_READ
:

757 
	`š™_»ad
();

760 
IO_METHOD_MMAP
:

761 
	`š™_mm­
();

764 
IO_METHOD_USERPTR
:

765 
	`š™_u£½
();

769 
throw
 
	`ruÁime_”rÜ
("what kind of IO method ishat?!?!?");

771 
	}
}

773 
	gNaoCam”a
::
	$š™_u£½
() {

774 
v4l2_»que¡bufãrs
 
»q
;

775 
·ge_size
;

777 
·ge_size
 = 
	`g‘·gesize
();

778 
imageSize
 =(imageSiz+ 
·ge_size
 - 1) & ~(page_size - 1);

780 
	`CLEAR
(
»q
);

782 
»q
.
couÁ
 = 
NUM_FRAME_BUFFERS
;

783 
»q
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

784 
»q
.
memÜy
 = 
V4L2_MEMORY_USERPTR
;

786 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_REQBUFS
, &
»q
)) {

787 ià(
EINVAL
 =ğ
”ºo
) {

788 
	`Îog
(
ERROR
è<< "dÛ nÙ suµÜˆu£¸poš‹¸i/o" << 
’dl
;

789 
throw
 
	`ruÁime_”rÜ
("does‚ot support user…ointer i/o");

791 
	`”ºo_throw
("VIDIOC_REQBUFS");

795 
	`CLEAR
(
bufãrs
);

797 ià(!
bufãrs
) {

798 
	`Îog
(
ERROR
) << "Out of memory\n";

799 
	`ex™
(
EXIT_FAILURE
);

802 
n_bufãrs
 = 0;‚_bufãr < 
NUM_FRAME_BUFFERS
; ++n_buffers) {

803 
bufãrs
[
n_bufãrs
].
Ëngth
 = 
imageSize
;

804 
bufãrs
[
n_bufãrs
].
¡¬t
 =

805 
»š‹½»t_ÿ¡
<
ušt8_t
*>(
	`mem®ign
Ğ
·ge_size
,

806 
imageSize
));

808 ià(!
bufãrs
[
n_bufãrs
].
¡¬t
) {

809 
	`Îog
(
ERROR
) << "Out of memory\n";

810 
	`ex™
(
EXIT_FAILURE
);

813 
	}
}

815 
	gNaoCam”a
::
	$¡¬t_ÿ±uršg
() {

818 
Ï¡Dequeued
.
šdex
 = 
UINT_MAX
;

820 
i
;

821 
v4l2_buf_ty³
 
ty³
;

823 
io
) {

824 
IO_METHOD_READ
:

828 
IO_METHOD_MMAP
:

829 
i
 = 0; i < 
n_bufãrs
; ++i) {

830 
v4l2_bufãr
 
buf
;

832 
	`CLEAR
(
buf
);

834 
buf
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

835 
buf
.
memÜy
 = 
V4L2_MEMORY_MMAP
;

836 
buf
.
šdex
 = 
i
;

838 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_QBUF
, &
buf
))

839 
	`”ºo_throw
("VIDIOC_QBUF");

842 
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

844 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_STREAMON
, &
ty³
))

845 
	`”ºo_throw
("VIDIOC_STREAMON");

849 
IO_METHOD_USERPTR
:

850 
i
 = 0; i < 
n_bufãrs
; ++i) {

851 
v4l2_bufãr
 
buf
;

853 
	`CLEAR
(
buf
);

855 
buf
.
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

856 
buf
.
memÜy
 = 
V4L2_MEMORY_USERPTR
;

857 
buf
.
šdex
 = 
i
;

858 
buf
.
m
.
u£½Œ
 = (
ušt32_t
è
bufãrs
[
i
].
¡¬t
;

859 
buf
.
Ëngth
 = 
bufãrs
[
i
].length;

861 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_QBUF
, &
buf
))

862 
	`”ºo_throw
("VIDIOC_QBUF");

865 
ty³
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

867 ià(-1 =ğ
	`ioùl
(
fd
, 
VIDIOC_STREAMON
, &
ty³
))

868 
	`”ºo_throw
("VIDIOC_STREAMON");

873 
throw
 
	`ruÁime_”rÜ
("what kind of IO method ishat?!?!?");

875 
	}
}

877 
	gNaoCam”a
::
	$š™_»ad
() {

878 
	`CLEAR
(
bufãrs
);

880 ià(!
bufãrs
) {

881 
	`Îog
(
ERROR
) << "Out of memory\n";

882 
	`ex™
(
EXIT_FAILURE
);

885 
bufãrs
[0].
Ëngth
 = 
imageSize
;

886 
bufãrs
[0].
¡¬t
 = 
»š‹½»t_ÿ¡
<
ušt8_t
*>(
	`m®loc
(
imageSize
));

888 ià(!
bufãrs
[0].
¡¬t
) {

889 
	`Îog
(
ERROR
) << "Out of memory\n";

890 
	`ex™
(
EXIT_FAILURE
);

892 
	}
}

	@robot/perception/vision/camera/NaoCamera.hpp

1 #iâdeà
PERCEPTION_VISION_CAMERA_NAOCAMERA_H_


2 
	#PERCEPTION_VISION_CAMERA_NAOCAMERA_H_


	)

4 
	~<¡ršg
>

6 
	~"bÏckbßrd/BÏckbßrd.hµ
"

8 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”a.hµ
"

9 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aDefš™iÚs.hµ
"

10 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”aDefš™iÚs.hµ
"

11 
	~"ty³s/Cam”aS‘tšgs.hµ
"

14 
	mIO_METHOD_READ
,

15 
	mIO_METHOD_MMAP
,

16 
	mIO_METHOD_USERPTR
,

17 
	mNUM_IO_METHODS


18 } 
	tIOM‘hod
;

21 
	#NUM_FRAME_BUFFERS
 4

	)

26 şas 
	cNaoCam”a
 : 
public
 
Cam”a
 {

27 
public
:

38 
NaoCam”a
(
BÏckbßrd
 *
bÏckbßrd
,

39 cÚ¡ *
f’ame
 = "/dev/video0",

40 cÚ¡ 
IOM‘hod
 
m‘hod
 = 
IO_METHOD_MMAP
,

41 cÚ¡ 
fÜm©
 = 
AL
::
kVGA
);

47 
	mvœtu®
 ~
NaoCam”a
();

56 
boŞ
 
imgDim’siÚs
(*cÚ¡ 
width
, *cÚ¡ 
height
);

57 cÚ¡ 
ušt8_t
 *
g‘
(cÚ¡ 
cŞourS·û
);

58 
boŞ
 
£tCÚŒŞ
(cÚ¡ 
ušt32_t
 
id
, cÚ¡ 
št32_t
 
v®ue
);

61 
Cam”aS‘tšgs
 
	mtİCam”aS‘tšgs
;

62 
Cam”aS‘tšgs
 
	mbÙCam”aS‘tšgs
;

64 
	m´Ùeùed
:

68 
NaoCam”a
(
BÏckbßrd
 *
bÏckbßrd
, cÚ¡ *
f’ame
, cÚ¡ 
IOM‘hod
 
m‘hod
,

69 cÚ¡ 
fÜm©
,

70 
dummy
, cÚ¡ 
¡d
::
¡ršg
 
ÿm”aChoiû
);

78 cÚ¡ 
ušt8_t
 *
»ad_äame
();

85 
£tCam”aS‘tšgs
(cÚ¡ 
Cam”aS‘tšgs
 
£‰šgs
);

90 
boŞ
 
š™_ÿm”a
();

95 
š™_bufãrs
();

100 
š™_mm­
();

105 
š™_u£½
();

110 
š™_»ad
();

115 
¡¬t_ÿ±uršg
();

120 
¡İ_ÿ±uršg
();

125 
unš™_bufãrs
();

130 
İ’_deviû
();

135 
şo£_deviû
();

140 
	m¡d
::
¡ršg
 
f’ame
;

145 
	mfd
;

151 
boŞ
 
	mv4lDeviûP
;

156 
	sBufãr
 {

160 
ušt8_t
 *
	m¡¬t
;

165 
size_t
 
	mËngth
;

171 
Bufãr
 
	gbufãrs
[
NUM_FRAME_BUFFERS
];

176 
	gn_bufãrs
;

181 
IOM‘hod
 
	gio
;

183 
	gfÜm©
;

185 
v4l2_qu”yù¾
 
	gqu”yù¾
;

186 
v4l2_qu”ym’u
 
	gqu”ym’u
;

198 
v4l2_bufãr
 
	gÏ¡Dequeued
;

201 
	g¡d
::
¡ršg
 
ÿm”aChoiû
;

203 
	g´iv©e
:

204 
»adCam”aS‘tšgs
(
BÏckbßrd
 *
bÏckbßrd
);

205 
»adCam”aS‘tšgs
(
BÏckbßrd
 *
bÏckbßrd
,

206 
Cam”aS‘tšgs
 &
£‰šgs
, 
¡d
::
¡ršg
 
ÿm”aName
) ;

	@robot/perception/vision/camera/NaoCameraDefinitions.cpp

1 
	~<™”©Ü
>

2 
	~<m­
>

3 
	~<¡ršg
>

5 
	~<lšux/videodev2.h
>

14 
	g¡d
::
m­
<
¡d
::
¡ršg
, > 
	$ü—‹_ÿm”a_cÚŒŞ_Çme_m­
() {

15 
¡d
::
m­
<¡d::
¡ršg
, > 
m
;

23 
m
["V4L2_CID_EXPOSURE_AUTO"] = 
V4L2_CID_EXPOSURE_AUTO
;

24 
m
["V4L2_CID_BRIGHTNESS"] = 
V4L2_CID_BRIGHTNESS
;

25 
m
["V4L2_CID_EXPOSURE"] = 
V4L2_CID_EXPOSURE
;

26 
m
["V4L2_CID_GAIN"] = 
V4L2_CID_GAIN
;

28 
m
["V4L2_CID_AUTO_WHITE_BALANCE"] = 
V4L2_CID_AUTO_WHITE_BALANCE
;

29 
m
["V4L2_CID_DO_WHITE_BALANCE"] = 
V4L2_CID_DO_WHITE_BALANCE
;

32 
m
["V4L2_CID_HFLIP"] = 
V4L2_CID_HFLIP
;

33 
m
["V4L2_CID_VFLIP"] = 
V4L2_CID_VFLIP
;

35 
m
["V4L2_CID_CONTRAST"] = 
V4L2_CID_CONTRAST
;

36 
m
["V4L2_CID_SATURATION"] = 
V4L2_CID_SATURATION
;

37 
m
["V4L2_CID_HUE"] = 
V4L2_CID_HUE
;

38 
m
["V4L2_CID_RED_BALANCE"] = 
V4L2_CID_RED_BALANCE
;

39 
m
["V4L2_CID_GAMMA"] = 
V4L2_CID_GAMMA
;

40 
m
["V4L2_CID_SHARPNESS"] = 
V4L2_CID_SHARPNESS
;

41 
m
["V4L2_CID_BACKLIGHT_COMPENSATION"] = 
V4L2_CID_BACKLIGHT_COMPENSATION
;

44 
m
["V4L2_CID_AUTOEXPOSURE"] = 
V4L2_CID_AUTOEXPOSURE
;

45 
m
["V4L2_CID_CAM_INIT"] = 
V4L2_CID_CAM_INIT
;

46 
m
["V4L2_CID_EXPOSURE_CORRECTION"] = 
V4L2_CID_EXPOSURE_CORRECTION
;

47 
m
["V4L2_CID_AEC_ALGORITHM"] = 
V4L2_CID_AEC_ALGORITHM
;

48  
m
;

49 
	}
}

50 
	g¡d
::
m­
<
¡d
::
¡ršg
, > 
	gCAMERA_CONTROL_NAME_MAP
 = 
ü—‹_ÿm”a_cÚŒŞ_Çme_m­
();

53 
	g¡d
::
m­
<, std::
¡ršg
> 
	$ü—‹_ÿm”a_cÚŒŞ_v®ue_m­
() {

54 
¡d
::
m­
<, std::
¡ršg
> 
m
;

56 
¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, >::
	t™”©Ü
 
	t™_ty³
;

57 
™_ty³
 
™”©Ü
 = 
CAMERA_CONTROL_NAME_MAP
.
	`begš
(); i‹¿tÜ !ğCAMERA_CONTROL_NAME_MAP.
	`’d
(); iterator++) {

60 
m
[
™”©Ü
->
£cÚd
] = i‹¿tÜ->
fœ¡
;

62  
m
;

63 
	}
}

64 
	g¡d
::
m­
<, std::
¡ršg
> 
CAMERA_CONTROL_VALUE_MAP
 = 
ü—‹_ÿm”a_cÚŒŞ_v®ue_m­
();

	@robot/perception/vision/camera/NaoCameraDefinitions.hpp

1 #´agm¨
Úû


3 
	~<m­
>

4 
	~<¡ršg
>

7 
¡d
::
m­
<¡d::
¡ršg
, > 
ü—‹_ÿm”a_cÚŒŞ_Çme_m­
;

8 
¡d
::
m­
<¡d::
¡ršg
, > 
CAMERA_CONTROL_NAME_MAP
;

11 
¡d
::
m­
<, std::
¡ršg
> 
ü—‹_ÿm”a_cÚŒŞ_v®ue_m­
;

12 
¡d
::
m­
<, std::
¡ršg
> 
CAMERA_CONTROL_VALUE_MAP
;

	@robot/perception/vision/camera/NaoCameraV4.cpp

32 
	~<m®loc.h
>

33 
	~<lim™s.h
>

34 
	~<¡dio.h
>

35 
	~<sys/mmª.h
>

36 
	~<sys/¡©.h
>

37 
	~<sys/ty³s.h
>

38 
	~<uni¡d.h
>

39 
	~<ÿs£¹
>

40 
	~<û¼no
>

41 
	~<c¡ršg
>

42 
	~<ùime
>

43 
	~<io¡»am
>

44 
	~<¡dexû±
>

45 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”aV4.hµ
"

46 
	~"uts/Logg”.hµ
"

47 
	~"uts/¥“ch.hµ
"

48 
	~"uts/Tim”.hµ
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

57 
šlše
 
	$”ºo_throw
(cÚ¡ *
s
) {

58 
	`Îog
(
ERROR
è<< 
s
 << "ƒ¼Ü "<< 
”ºo
 << ", " << 
	`¡»¼Ü
Ó¼noè<< 
’dl
;

59 
throw
 
	`ruÁime_”rÜ
(
	`¡»¼Ü
(
”ºo
));

60 
	}
}

66 
	#CLEAR
(
x
è
	`mem£t
(&(x), 0, (x))

	)

71 
	gNaoCam”aV4
::
	$NaoCam”aV4
(
BÏckbßrd
 *
bÏckbßrd
,

72 cÚ¡ *
f’ame
,

73 cÚ¡ 
¡d
::
¡ršg
 
ÿm”aChoiû
,

74 cÚ¡ 
IOM‘hod
 
m‘hod
,

75 cÚ¡ 
fÜm©
)

78 
	$NaoCam”a
(
bÏckbßrd
, 
f’ame
, 
m‘hod
, 
fÜm©
, 0, 
ÿm”aChoiû
)

81 
	`İ’_deviû
();

83 
¡©
 
buf
;

84 ià(
	`f¡©
(
fd
, &
buf
) < 0) {

85 
	`Îog
(
ERROR
è<< "çedØ¡© " << 
f’ame
 << 
’dl
;

86 
throw
 
	`ruÁime_”rÜ
("inside NaoCamera.cpp, failedo stat camera");

88 
v4lDeviûP
 = 
	`S_ISCHR
(
buf
.
¡_mode
);

91 
	`£tCÚŒŞ
(
V4L2_CID_CAM_INIT
, 0);

94 
	`şo£_deviû
();

95 
	`İ’_deviû
();

97 
	`š™_bufãrs
();

99 ià(!
	`š™_ÿm”a
()) {

100 
	`Îog
(
FATAL
) << "Error initializing camera!\n";

101 
throw
 
	`ruÁime_”rÜ
("Error initializing camera");

104 
	`¡¬t_ÿ±uršg
();

122 
dumpFe
 = 
NULL
;

123 
	}
}

125 
	gNaoCam”aV4
::~
	$NaoCam”aV4
()

127 
	}
}

	@robot/perception/vision/camera/NaoCameraV4.hpp

32 #´agm¨
Úû


34 
	~<¡ršg
>

36 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”a.hµ
"

42 şas 
	cNaoCam”aV4
 : 
public
 
NaoCam”a
 {

43 
public
:

55 
NaoCam”aV4
(
BÏckbßrd
 *
bÏckbßrd
,

56 cÚ¡ *
f’ame
,

57 cÚ¡ 
¡d
::
¡ršg
 
ÿm”aChoiû
,

58 cÚ¡ 
IOM‘hod
 
m‘hod
 = 
IO_METHOD_MMAP
,

59 cÚ¡ 
fÜm©
 = 
AL
::
k960p
);

65 
	mvœtu®
 ~
NaoCam”aV4
();

	@robot/perception/vision/colour/ColourClassifierInterface.hpp

1 #iâdeà
PERCEPTION_VISION_COLOUR_COLOURCLASSIFIERINTERFACE_H_


2 
	#PERCEPTION_VISION_COLOUR_COLOURCLASSIFIERINTERFACE_H_


	)

4 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

5 
	~"ty³s/CombšedF¿me.hµ
"

7 
	#CC_CONTEXT_OFFFIELD
 0

	)

8 
	#CC_CONTEXT_HALF_START_READY
 1

	)

10 
ušt8_t
 
	tCCCÚ‹xt
;

12 şas 
	cCŞourCÏssif›r
 {

13 
	mpublic
:

18 
vœtu®
 
§m¶e
(cÚ¡ 
CombšedF¿me
& 
combšed_äame
, cÚ¡ 
CCCÚ‹xt
 
cÚ‹xt
) = 0;

24 
vœtu®
 
CŞour
 
şassify
(cÚ¡ 
ušt8_t
 *
pix–
) = 0;

	@robot/perception/vision/colour/DynamicColourClassifier.cpp

1 
	~"³rû±iÚ/visiÚ/cŞour/DyÇmicCŞourCÏssif›r.hµ
"

6 
	gDyÇmicCŞourCÏssif›r
::
	$§m¶e
(cÚ¡ 
CombšedF¿me
& 
combšed_äame
, cÚ¡ 
CCCÚ‹xt
 
cÚ‹xt
) {

8 
	}
}

13 
CŞour
 
	gDyÇmicCŞourCÏssif›r
::
	$şassify
(cÚ¡ 
ušt8_t
 *
pix–
) {

14  
cWHITE
;

15 
	}
}

	@robot/perception/vision/colour/DynamicColourClassifier.hpp

1 #iâdeà
PERCEPTION_VISION_COLOUR_DYNAMICCOLOURCLASSIFIER_H_


2 
	#PERCEPTION_VISION_COLOUR_DYNAMICCOLOURCLASSIFIER_H_


	)

4 
	~"³rû±iÚ/visiÚ/cŞour/CŞourCÏssif›rIÁ”çû.hµ
"

6 şas 
	cDyÇmicCŞourCÏssif›r
 : 
public
 
CŞourCÏssif›r
 {

7 
public
:

12 
§m¶e
(cÚ¡ 
CombšedF¿me
& 
combšed_äame
, cÚ¡ 
CCCÚ‹xt
 
cÚ‹xt
);

17 
CŞour
 
şassify
(cÚ¡ 
ušt8_t
 *
pix–
);

	@robot/perception/vision/detector/BallDetector2016.cpp

1 
	~"³rû±iÚ/visiÚ/d‘eùÜ/B®lD‘eùÜ2016.hµ
"

2 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

3 
	~"ty³s/F¿meInfo.hµ
"

5 
	gB®lD‘eùÜDave
::
	$d‘eù
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, 
F¿meInfo
& 
äame_šfo
, cÚ¡ 
RegiÚI
& 
»giÚ
) {

6 
	`Îog
(
INFO
è<< "ruÂšg Dave' b®Èd‘eùÜ" 
¡d
::
’dl
;

9 
	}
}

	@robot/perception/vision/detector/BallDetector2016.hpp

1 #iâdeà
PERCEPTION_VISION_DETECTOR_BALLDETECTOR2016_H_


2 
	#PERCEPTION_VISION_DETECTOR_BALLDETECTOR2016_H_


	)

4 
	~"³rû±iÚ/visiÚ/d‘eùÜ/D‘eùÜIÁ”çû.hµ
"

5 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

6 
	~"ty³s/F¿meInfo.hµ
"

8 şas 
	cB®lD‘eùÜDave
: 
public
 
D‘eùÜ
 {

9 
public
:

13 
vœtu®
 
d‘eù
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, 
F¿meInfo
& 
äame_šfo
, cÚ¡ 
RegiÚI
& 
»giÚ
);

	@robot/perception/vision/detector/DetectorInterface.hpp

1 #iâdeà
PERCEPTION_VISION_DETECTOR_DETECTORINTERFACE_H_


2 
	#PERCEPTION_VISION_DETECTOR_DETECTORINTERFACE_H_


	)

4 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

5 
	~"ty³s/F¿meInfo.hµ
"

6 
	~"ty³s/VisiÚBÏckbßrdInfo.hµ
"

8 şas 
	cD‘eùÜ
 {

9 
	mpublic
:

13 
vœtu®
 
d‘eù
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, cÚ¡ 
¡d
::
veùÜ
<
RegiÚI
>& 
»giÚ
) = 0;

	@robot/perception/vision/fullfinder/FieldBoundaryFinder.cpp

1 
	~"³rû±iÚ/visiÚ/fuÎfšd”/F›ldBound¬yFšd”.hµ
"

3 
	gF›ldBound¬yFšd”
::
	$fšd
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, cÚ¡ 
RegiÚI
& 
»giÚ
, 
F¿meInfo
& 
äame_šfo
) {

5 
	}
}

	@robot/perception/vision/fullfinder/FieldBoundaryFinder.hpp

1 #iâdeà
PERCEPTION_VISION_FULLFINDER_FIELDBOUNDARYFINDERINTERFACE_H_


2 
	#PERCEPTION_VISION_FULLFINDER_FIELDBOUNDARYFINDERINTERFACE_H_


	)

4 
	~"ty³s/F¿meInfo.hµ
"

5 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

6 
	~"³rû±iÚ/visiÚ/fuÎfšd”/FuÎFšd”IÁ”çû.hµ
"

7 
	~"ty³s/VisiÚBÏckbßrdInfo.hµ
"

9 şas 
	cF›ldBound¬yFšd”
 : 
public
 
FuÎFšd”
 {

10 
public
:

14 
fšd
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, cÚ¡ 
RegiÚI
& 
»giÚ
, 
F¿meInfo
& 
äame_šfo
);

	@robot/perception/vision/fullfinder/FieldFeatureFinder.cpp

1 
	~"³rû±iÚ/visiÚ/fuÎfšd”/F›ldF—tu»Fšd”.hµ
"

3 
	gF›ldF—tu»Fšd”
::
	$fšd
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, cÚ¡ 
RegiÚI
& 
»giÚ
, 
F¿meInfo
& 
äame_šfo
) {

5 
	}
}

	@robot/perception/vision/fullfinder/FieldFeatureFinder.hpp

1 #iâdeà
PERCEPTION_VISION_FULLFINDER_FIELDFEATUREFINDERINTERFACE_H_


2 
	#PERCEPTION_VISION_FULLFINDER_FIELDFEATUREFINDERINTERFACE_H_


	)

4 
	~"ty³s/F¿meInfo.hµ
"

5 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

6 
	~"³rû±iÚ/visiÚ/fuÎfšd”/FuÎFšd”IÁ”çû.hµ
"

7 
	~"ty³s/VisiÚBÏckbßrdInfo.hµ
"

9 şas 
	cF›ldF—tu»Fšd”
 : 
public
 
FuÎFšd”
 {

10 
public
:

14 
fšd
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, cÚ¡ 
RegiÚI
& 
»giÚ
, 
F¿meInfo
& 
äame_šfo
);

	@robot/perception/vision/fullfinder/FullFinderInterface.hpp

1 #iâdeà
PERCEPTION_VISION_FULLFINDER_FULLFINDERINTERFACE_H_


2 
	#PERCEPTION_VISION_FULLFINDER_FULLFINDERINTERFACE_H_


	)

4 
	~<veùÜ
>

5 
	~"ty³s/F¿meInfo.hµ
"

6 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

7 
	~"ty³s/VisiÚBÏckbßrdInfo.hµ
"

9 şas 
	cFuÎFšd”
 {

10 
	mpublic
:

14 
vœtu®
 
fšd
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, cÚ¡ 
RegiÚI
& 
»giÚ
, 
F¿meInfo
& 
äame_šfo
) = 0;

	@robot/perception/vision/other/ImageRegion.hpp

1 #iâdeà
PERCEPTION_VISION_IMAGEREGION_H_


2 
	#PERCEPTION_VISION_IMAGEREGION_H_


	)

4 
	~<¡dšt.h
>

5 
	~<ut™y
>

6 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

9 
	mrBALL
 = 0,

10 
	mrROBOT
 = 1,

11 
	mrMAYBE_ROBOT
 = 2,

12 
	mrFIELD_LINE
 = 3,

13 
	mrCONNECTED_ROBOT
 = 4,

14 
	mrDELETED
 = 5

16 
	t__©Œibu‹__
((
	t·cked
)è
	tRegiÚTy³
;

18 şas 
	cImageRegiÚ
 {

19 
	mpublic
:

21 
ušt16_t
 
numPix–s
;

23 
ušt16_t
 
	mnumRobÙRed
;

24 
ušt16_t
 
	mnumRobÙBlue
;

25 
ušt16_t
 
	mnumWh™e
;

26 
ušt16_t
 
	mnumO¿nge
;

28 
ušt16_t
 
	mnumTİ
;

30 
ušt16_t
 
	mËáMo¡
;

31 
ušt16_t
 
	mrightMo¡
;

32 
	m¡d
::
·œ
<
ušt16_t
, 
	mušt16_t
> 
	mtİMo¡
;

33 
	m¡d
::
·œ
<
ušt16_t
, 
	mušt16_t
> 
	mbÙtomMo¡
;

35 
ušt16_t
 
	mbÙtomMo¡RobÙ
;

36 
ušt16_t
 
	mtİMo¡RobÙ
;

37 
ušt16_t
 
	mËáMo¡RobÙ
;

38 
ušt16_t
 
	mrightMo¡RobÙ
;

40 
	m¡d
::
·œ
<
ušt16_t
, 
	mušt16_t
> 
	m¡¬tSÿns
[
MAX_NUM_SCAN_POINTS
];

41 
	m¡d
::
·œ
<
ušt16_t
, 
	mušt16_t
> 
	m’dSÿns
[
MAX_NUM_SCAN_POINTS
];

42 
ušt16_t
 
	mnumSÿnPošts
;

44 
ušt16_t
 
	m´evS¹
;

45 
ušt16_t
 
	m´evEnd
;

47 
ušt16_t
 
	mav”ageSÿnL’gth
;

48 
ušt16_t
 
	mÏ¡NÙAÎWh™e
;

49 
boŞ
 
	md–‘ed
;

50 
boŞ
 
	misRobÙ
;

51 
RegiÚTy³
 
	mşassifiÿtiÚ
;

53 
	$ş—r
() {

54 
numPix–s
 = 0;

55 
numRobÙRed
 = 0;

56 
numRobÙBlue
 = 0;

57 
numWh™e
 = 0;

58 
numO¿nge
 = 0;

59 
numTİ
 = 0;

60 
ËáMo¡
 = 
IMAGE_COLS
;

61 
rightMo¡
 = 0;

62 
tİMo¡
.
£cÚd
 = 
IMAGE_ROWS
;

63 
bÙtomMo¡
.
£cÚd
 = 0;

64 
bÙtomMo¡
.
fœ¡
 = 0;

65 
bÙtomMo¡RobÙ
 = 0;

66 
tİMo¡RobÙ
 = 
IMAGE_ROWS
;

67 
ËáMo¡RobÙ
 = 
IMAGE_COLS
;

68 
rightMo¡RobÙ
 = 0;

69 
d–‘ed
 = 
çl£
;

70 
isRobÙ
 = 
çl£
;

71 
Ï¡NÙAÎWh™e
 = 0;

72 
av”ageSÿnL’gth
 = 0;

73 
numSÿnPošts
 = 0;

75 
	}
};

	@robot/perception/vision/other/RobotRegion.hpp

1 #iâdeà
PERCEPTION_VISION_ROBOTREGION_H_


2 
	#PERCEPTION_VISION_ROBOTREGION_H_


	)

4 
	~<¡dšt.h
>

5 
	~<ut™y
>

7 
	~"³rû±iÚ/visiÚ/Ùh”/ImageRegiÚ.hµ
"

21 
	~"ty³s/RobÙInfo.hµ
"

23 şas 
	cRobÙRegiÚ
 {

24 
	mpublic
:

25 
ušt16_t
 
ËáMo¡
;

26 
ušt16_t
 
	mrightMo¡
;

27 
ušt16_t
 
	mbÙtomMo¡
;

28 
ušt16_t
 
	mtİMo¡
;

29 
ušt16_t
 
	mnumTİ
;

31 
ImageRegiÚ
 *
	m»giÚs
[
MAX_NUM_ROBOT_REGIONS
];

32 
ušt16_t
 
	mnumRegiÚs
;

34 
ušt16_t
 
	mnumRobÙRed
;

35 
ušt16_t
 
	mnumRobÙBlue
;

36 
ušt16_t
 
	mnumWh™e
;

38 
ušt16_t
 
	mËáMo¡RobÙ
;

39 
ušt16_t
 
	mrightMo¡RobÙ
;

40 
ušt16_t
 
	mbÙtomMo¡RobÙ
;

41 
ušt16_t
 
	mtİMo¡RobÙ
;

43 
boŞ
 
	md–‘ed
;

45 
	mRobÙInfo
::
Ty³
 
ty³
;

	@robot/perception/vision/other/VarianceCalculator.cpp

1 
	~<cm©h
>

3 
	~"³rû±iÚ/visiÚ/Ùh”/V¬ŸnûC®cuÏtÜ.hµ
"

5 
	~"uts/basic_m©hs.hµ
"

6 
	~"uts/ªgËs.hµ
"

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	gV¬ŸnûC®cuÏtÜ
::
£tV¬Ÿnû
(
veùÜ
<
B®lInfo
> &
b®ls
) {

11 
veùÜ
<
B®lInfo
>::
™”©Ü
 
b®l
 = 
b®ls
.
begš
(); 
	gb®l
 !ğb®ls.
’d
(); ++ball) {

12 
£tDi¡ªûH—dšgV¬Ÿnû
(
b®l
->
¼
);

16 
	gV¬ŸnûC®cuÏtÜ
::
£tV¬Ÿnû
(
veùÜ
<
Po¡Info
> &
po¡s
) {

17 
veùÜ
<
Po¡Info
>::
™”©Ü
 
po¡
 = 
po¡s
.
begš
(); 
	gpo¡
 !ğpo¡s.
’d
(); ++post) {

18 
£tDi¡ªûH—dšgV¬Ÿnû
(
po¡
->
¼
);

22 
	gV¬ŸnûC®cuÏtÜ
::
£tV¬Ÿnû
(
veùÜ
<
F›ldF—tu»Info
> &
ã©u»s
) {

23 
veùÜ
<
F›ldF—tu»Info
>::
™”©Ü
 
ã©u»
 = 
ã©u»s
.
begš
(); 
	gã©u»
 !ğã©u»s.
’d
(); ++feature) {

24 
£tDi¡ªûH—dšgOr›Á©iÚV¬Ÿnû
(
ã©u»
->
¼
);

27 
	gV¬ŸnûC®cuÏtÜ
::
	$£tDi¡ªûH—dšgV¬Ÿnû
(
RRCoÜd
 &
¼
) {

28 
ÿm”a_height
 = 500;

29 
phi
 = 
	`©ª
(
¼
.
	`di¡ªû
(è/ 
ÿm”a_height
);

30 
¼
.
v¬
.
	`£tZ”o
();

31 
¼
.
	`v¬
(0,0èğ
	`SQUARE
(500 + 
ÿm”a_height
*(
	`n
(
phi
 + 
	`DEG2RAD
(3)) -an(phi)));

32 
¼
.
	`v¬
(1,1èğ
	`SQUARE
(
	`DEG2RAD
(10));

33 
	}
}

35 
	gV¬ŸnûC®cuÏtÜ
::
	$£tDi¡ªûH—dšgOr›Á©iÚV¬Ÿnû
(
RRCoÜd
 &
¼
) {

36 
	`£tDi¡ªûH—dšgV¬Ÿnû
(
¼
);

37 
¼
.
	`v¬
(2,2èğ
	`SQUARE
(
	`DEG2RAD
(4));

38 
	}
}

	@robot/perception/vision/other/VarianceCalculator.hpp

1 #iâdeà
PERCEPTION_VISION_VARIANCECALCULATOR_H_


2 
	#PERCEPTION_VISION_VARIANCECALCULATOR_H_


	)

4 
	~<veùÜ
>

7 
	~"ty³s/B®lInfo.hµ
"

8 
	~"ty³s/Po¡Info.hµ
"

9 
	~"ty³s/RobÙInfo.hµ
"

10 
	~"ty³s/F›ldBound¬yInfo.hµ
"

11 
	~"ty³s/F›ldF—tu»Info.hµ
"

13 şas 
	cV¬ŸnûC®cuÏtÜ
 {

14 
	mpublic
:

16 
£tV¬Ÿnû
(
¡d
::
veùÜ
<
B®lInfo
> &
b®ls
);

17 
£tV¬Ÿnû
(
¡d
::
veùÜ
<
Po¡Info
> &
po¡s
);

18 
£tV¬Ÿnû
(
¡d
::
veùÜ
<
RobÙInfo
> &
robÙs
);

19 
£tV¬Ÿnû
(
¡d
::
veùÜ
<
F›ldBound¬yInfo
> &
f›ldBound¬›s
);

20 
£tV¬Ÿnû
(
¡d
::
veùÜ
<
F›ldF—tu»Info
> &
f›ldF—tu»s
);

22 
	m´iv©e
:

23 
£tDi¡ªûH—dšgV¬Ÿnû
(
RRCoÜd
 &
¼
);

24 
£tDi¡ªûH—dšgOr›Á©iÚV¬Ÿnû
(
RRCoÜd
 &
¼
);

	@robot/perception/vision/other/YUV.cpp

1 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

3 
ušt8_t
* 
	$g‘pix–·œ
(cÚ¡ 
ušt8_t
* 
yuv
, 
row
, 
cŞ
, 
num_cŞs
) {

4  
cÚ¡_ÿ¡
<
ušt8_t
 *>(
yuv
)

5 + (
row
 * 
num_cŞs
 + 
cŞ
 / 2 * 2) * 2;

6 
	}
}

8 
ušt8_t
 
	$g‘y
(cÚ¡ 
ušt8_t
* 
yuv
, 
row
, 
cŞ
, 
num_cŞs
) {

9  
	`g‘pix–·œ
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
)[2 * (col & 1)];

10 
	}
}

12 
ušt8_t
 
	$g‘u
(cÚ¡ 
ušt8_t
* 
yuv
, 
row
, 
cŞ
, 
num_cŞs
) {

13  
	`g‘pix–·œ
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
)[1];

14 
	}
}

16 
ušt8_t
 
	$g‘v
(cÚ¡ 
ušt8_t
* 
yuv
, 
row
, 
cŞ
, 
num_cŞs
) {

17  
	`g‘pix–·œ
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
)[3];

18 
	}
}

	@robot/perception/vision/other/YUV.hpp

1 #iâdeà
PERCEPTION_VISION_YUV_H_


2 
	#PERCEPTION_VISION_YUV_H_


	)

4 
	~<¡dšt.h
>

5 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

7 
ušt8_t
* 
g‘pix–·œ
(cÚ¡ ušt8_t* 
yuv
, 
row
, 
cŞ
,

8 
num_cŞs
 = 
TOP_IMAGE_COLS
);

10 
ušt8_t
 
g‘y
(cÚ¡ ušt8_t* 
yuv
, 
row
, 
cŞ
,

11 
num_cŞs
 = 
TOP_IMAGE_COLS
);

13 
ušt8_t
 
g‘u
(cÚ¡ ušt8_t* 
yuv
, 
row
, 
cŞ
,

14 
num_cŞs
 = 
TOP_IMAGE_COLS
);

16 
ušt8_t
 
g‘v
(cÚ¡ ušt8_t* 
yuv
, 
row
, 
cŞ
,

17 
num_cŞs
 = 
TOP_IMAGE_COLS
);

	@robot/perception/vision/regionfinder/RegionFinderInterface.hpp

1 #iâdeà
PERCEPTION_VISION_REGIONFINDERINTERFACE_H_


2 
	#PERCEPTION_VISION_REGIONFINDERINTERFACE_H_


	)

4 
	~<veùÜ
>

5 
	~"ty³s/F¿meInfo.hµ
"

6 
	~"³rû±iÚ/visiÚ/RegiÚ.hµ
"

7 
	~"ty³s/VisiÚBÏckbßrdInfo.hµ
"

9 şas 
	cRegiÚFšd”
 {

10 
	mpublic
:

14 
vœtu®
 
¡d
::
veùÜ
<
RegiÚI
> 
fšd
(cÚ¡ 
VisiÚBÏckbßrdInfo
& 
bb_šfo
, cÚ¡ RegiÚI& 
»giÚ
) = 0;

	@robot/receiver/Nao.cpp

32 
	~"Nao.hµ
"

34 
usšg
 
Çme¥aû
 
	gboo¡
::
asio
;

35 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	gNaoReûiv”
::~
	$NaoReûiv”
() {

38 
£rviû
.
	`¡İ
();

39 
t
->
	`još
();

40 
d–‘e
 
t
;

41 ià(
sock‘
.
	`is_İ’
()) {

42 
sock‘
.
	`şo£
();

44 
	}
}

	@robot/receiver/Nao.hpp

32 #´agm¨
Úû


34 
	~<boo¡/sy¡em/”rÜ_code.hµ
>

35 
	~<boo¡/asio/io_£rviû.hµ
>

36 
	~<boo¡/asio//udp.hµ
>

37 
	~<boo¡/th»ad.hµ
>

39 şas 
	cNaoReûiv”
 {

40 
	m´Ùeùed
:

44 
‹m¶©e
 <
şass
 
SubCÏss
, 
ty³Çme
 
	mR—dHªdËr
>

45 
NaoReûiv”
(
SubCÏss
 *
sùhis
, 
R—dHªdËr
 
hªdËr
, 
pÜt
);

50 
	mvœtu®
 ~
NaoReûiv”
();

52 
	m‹m¶©e
 <
şass
 
	mSubCÏss
, 
ty³Çme
 
	mR—dHªdËr
>

53 
¡¬tReûive
(
SubCÏss
 *
sùhis
, 
R—dHªdËr
 
hªdËr
);

54 
	m»cvBufãr
[1500];

56 
	m´iv©e
:

57 
boo¡
::
asio
::
io_£rviû
 
£rviû
;

58 
	mboo¡
::
asio
::

::
udp
::
sock‘
 socket;

59 
	mboo¡
::
asio
::

::
udp
::
’dpošt
 
»mÙeEndpošt
;

60 
	mboo¡
::
th»ad
 *
t
;

63 
	~"Nao.tcc
"

	@robot/receiver/Nao.tcc

1 
	~"uts/Logg”.hµ
"

2 
	~<boo¡/asio/¶aûhŞd”s.hµ
>

4 
	g‹m¶©e
 <
şass
 
	gSubCÏss
, 
ty³Çme
 
	gR—dHªdËr
>

5 
	gNaoReûiv”
::
	$NaoReûiv”
(
SubCÏss
 *
sùhis
, 
R—dHªdËr
 
hªdËr
, 
pÜt
)

6 : 
	`£rviû
(), 
	`sock‘
(
£rviû
,

7 
boo¡
::
asio
::

::
udp
::
	`’dpošt
(boo¡::asio::::udp::
	`v4
(),

8 
pÜt
)) {

9 
	`Îog
(
INFO
è<< "NaØReûiv” cÚ¡ruùed" << 
¡d
::
’dl
;

10 
	`¡¬tReûive
(
sùhis
, 
hªdËr
);

11 
t
 = 
Ãw
 
boo¡
::
	`th»ad
(boo¡::
	`bšd
(&boo¡::
asio
::
io_£rviû
::
run
, &
£rviû
));

12 
	`Îog
(
INFO
è<< "Li¡’šg fÜ d©¨Ú…Üˆ" << 
pÜt
 << 
¡d
::
’dl
;

13 
	}
}

15 
	g‹m¶©e
 <
şass
 
	gSubCÏss
, 
ty³Çme
 
	gR—dHªdËr
>

16 
	gNaoReûiv”
::
	$¡¬tReûive
(
SubCÏss
 *
sùhis
, 
R—dHªdËr
 
hªdËr
) {

17 
sock‘
.
	`async_»ûive_äom
(

18 
boo¡
::
asio
::
	`bufãr
((boo¡::asio::
	`mubË_bufãr
((*)&
»cvBufãr
,

19 (
»cvBufãr
)))), 
»mÙeEndpošt
,

20 
boo¡
::
	`bšd
(
hªdËr
, 
sùhis
,

21 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
,

22 
boo¡
::
asio
::
¶aûhŞd”s
::
by‹s_Œªsã¼ed
));

23 
	}
}

	@robot/receiver/RemoteControl.cpp

1 
	~<ùime
>

2 
	~"»ûiv”/RemÙeCÚŒŞ.hµ
"

3 
	~"uts/Logg”.hµ
"

4 
	~"th»ad/Th»ad.hµ
"

6 
usšg
 
Çme¥aû
 
	g¡d
;

14 
	gRemÙeCÚŒŞReûiv”
::
RemÙeCÚŒŞReûiv”
(
BÏckbßrd
 *
bb
, (RemÙeCÚŒŞReûiv”::*
hªdËr
)

15 (cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 & 
”rÜ
, 
¡d
::
size_t
))

16 : 
	`Ad­‹r
(
bb
), 
	$NaoReûiv”
(
this
, 
hªdËr
, 4000) {

17 
	`Îog
(
INFO
è<< "S¹ed„emÙe-cÚŒŞ„eûiv”." << 
¡d
::
’dl
;

18 
	}
}

20 
	gRemÙeCÚŒŞReûiv”
::
»ûiveHªdËr


21 (cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
,

22 
	g¡d
::
size_t
 
size
) {

23 ià(
Th»ad
::
Çme
 =ğ
NULL
) {

24 
Th»ad
::
Çme
 = "RemoteControlBoostThread";

27 
Îog
(
INFO
è<< "RemÙCÚŒŞ: incomšg mes§goàsiz" << 
	gsize
 << 
	g¡d
::
’dl
;

29 ià(
	gsize
 =ğ(
BehaviourReque¡
))

31 
BehaviourReque¡
* 
br
 = 
»š‹½»t_ÿ¡
<BehaviourReque¡*>(
»cvBufãr
);

32 
wr™eTo
(
»mÙeCÚŒŞ
, 
»que¡
, *
br
);

33 
wr™eTo
(
»mÙeCÚŒŞ
, 
time_»ûived
, 
time
(
NULL
));

34 
Îog
(
INFO
è<< "RemÙCÚŒŞ: mes§gwr™‹ÀtØbÏckbßrd." << 
	g¡d
::
’dl
;

38 
wr™eTo
(
»mÙeCÚŒŞ
, 
time_»ûived
, (
time_t
)0);

41 
¡¬tReûive
(
this
, &
RemÙeCÚŒŞReûiv”
::
»ûiveHªdËr
);

44 
	gRemÙeCÚŒŞReûiv”
::
	$tick
() {

45 
	}
}

	@robot/receiver/RemoteControl.hpp

1 #´agm¨
Úû


3 
	~"Nao.hµ
"

4 
	~<¡ršg
>

5 
	~"ty³s/BehaviourReque¡.hµ
"

6 
	~"bÏckbßrd/BÏckbßrd.hµ
"

7 
	~"bÏckbßrd/Ad­‹r.hµ
"

9 
şass
 
	gRemÙeCÚŒŞReûiv”
 : 
Ad­‹r
, 
	gNaoReûiv”
 {

10 
	gpublic
:

14 
RemÙeCÚŒŞReûiv”
(
BÏckbßrd
 *
bb
, (RemÙeCÚŒŞReûiv”::*
hªdËr
)

15 (cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 & 
”rÜ
, 
¡d
::
size_t
èğ&
RemÙeCÚŒŞReûiv”
::
»ûiveHªdËr
);

20 
tick
();

22 
	g´iv©e
:

23 
»ûiveHªdËr
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
, 
¡d
::
size_t
 
size
);

	@robot/receiver/Team.cpp

32 
	~<ùime
>

33 
	~<io¡»am
>

34 
	~"T—m.hµ
"

35 
	~"ty³s/SPLSnd¬dMes§ge.hµ
"

36 
	~"uts/šÿ·c™©ed.hµ
"

37 
	~"th»ad/Th»ad.hµ
"

38 
	~"³rû±iÚ/behaviour/R—dySklPos™iÚAÎoÿtiÚ.hµ
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
	gT—mReûiv”
::
T—mReûiv”
(
BÏckbßrd
 *
bb
, (T—mReûiv”::*
hªdËr
)

43 (cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 & 
”rÜ
, 
¡d
::
size_t
))

44 : 
	`Ad­‹r
(
bb
), 
	`NaoReûiv”
(
this
,

45 
hªdËr
,

46 (
bb
->
cÚfig
)["Œªsm™‹r.ba£_pÜt"].
as
<>()

47 + (
bb
->
cÚfig
)["¶ay”.‹am"].
as
<>()è{
	}
}

49 
	gT—mReûiv”
::
	$ÇoHªdËr
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
,

50 
¡d
::
size_t
 
size
) {

51 ià(
Th»ad
::
Çme
 =ğ
NULL
) {

52 
Th»ad
::
Çme
 = "TeamReceiverBoostThread";

55 
SPLSnd¬dMes§ge
* 
m
 = 
»š‹½»t_ÿ¡
<SPLSnd¬dMes§ge*>(
»cvBufãr
);

56 
Brßdÿ¡D©a
* 
bd
 = (Brßdÿ¡D©a*)
m
->
d©a
;

57 ià(
size
 =ğ(
SPLSnd¬dMes§ge
)) {

58 ià(
m
->
¶ay”Num
 >ğ1 && m->¶ay”Num <ğ
ROBOTS_PER_TEAM
 &&

59 
m
->
‹amNum
 =ğ
	`»adFrom
(
gameCÚŒŞËr
, 
our_‹am
).
‹amNumb”
 &&

60 
m
->
numOfD©aBy‹s
 =ğ(
Brßdÿ¡D©a
) &&

61 
bd
->
‹am
 =ğ
	`»adFrom
(
»ûiv”
,eam)) {

63 
¡d
::
veùÜ
<
boŞ
> 
³ndšgIncomšgUpd©es
 = 
	`»adFrom
(
loÿli§tiÚ
, 
haveP’dšgIncomšgSh¬edBundË
);

64 
³ndšgIncomšgUpd©es
[
bd
->
¶ay”Num
 - 1] = 
Œue
;

65 
	`wr™eTo
(
loÿli§tiÚ
, 
haveP’dšgIncomšgSh¬edBundË
, 
³ndšgIncomšgUpd©es
);

67 
	`wr™eTo
(
»ûiv”
, 
mes§ge
[
bd
->
¶ay”Num
 - 1], *
m
);

68 
	`wr™eTo
(
»ûiv”
, 
d©a
[
bd
->
¶ay”Num
 - 1], *bd);

69 
	`wr™eTo
(
»ûiv”
, 
Ï¡Reûived
[
bd
->
¶ay”Num
 - 1], 
	`time
(
NULL
));

72 
boŞ
 
šÿ·c™©ed
 = 
çl£
;

73 ià(
	`»adFrom
(
gameCÚŒŞËr
, 
our_‹am
).
¶ay”s
[
bd
->
¶ay”Num
 - 1].
³ÇÉy


74 !ğ
PENALTY_NONE
) {

75 
šÿ·c™©ed
 = 
Œue
;

78 cÚ¡ 
AùiÚCommªd
::
Body
::
AùiÚTy³
 &
acB
 =

79 
	`»adFrom
(
»ûiv”
, 
d©a
)[
bd
->
¶ay”Num
 - 1].
acB
;

80 
šÿ·c™©ed
 |ğ
	`isInÿ·c™©ed
(
acB
);

82 
	`wr™eTo
(
»ûiv”
, 
šÿ·c™©ed
[
bd
->
¶ay”Num
 - 1], incapacitated);

85 
R—dySklPos™iÚAÎoÿtiÚ
 
cu¼’tPos™iÚAÎoÿtiÚ
 =

86 
	`»adFrom
(
behaviour
, 
behaviourSh¬edD©a
).
»adyPos™iÚAÎoÿtiÚ
;

87 ià(
bd
->
behaviourSh¬edD©a
.
»adyPos™iÚAÎoÿtiÚ
.
	`ÿnOv”ride
(
cu¼’tPos™iÚAÎoÿtiÚ
)) {

88 
	`wr™eTo
(
behaviour
, 
behaviourSh¬edD©a
.
»adyPos™iÚAÎoÿtiÚ
, 
bd
->behaviourSharedData.readyPositionAllocation);

92 
	`Îog
(
WARNING
è<< "Reûived…ack‘ oà" << 
size
 << " bytes, butƒxpected "

93 "·ck‘ oà" << (
Brßdÿ¡D©a
è<< " by‹s." << 
’dl
;

95 
	`¡¬tReûive
(
this
, &
T—mReûiv”
::
ÇoHªdËr
);

96 
	}
}

98 
	gT—mReûiv”
::
	$¡doutHªdËr
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
,

99 
¡d
::
size_t
 
size
) {

100 
SPLSnd¬dMes§ge
* 
m
 = (SPLSnd¬dMes§ge*)
»cvBufãr
;

101 
Brßdÿ¡D©a
* 
bd
 = (Brßdÿ¡D©a*)
m
->
d©a
;

102 
cout
 << "Reûived d©¨äom…Ïy” " << 
bd
->
¶ay”Num
 << 
’dl
;

103 
	`¡¬tReûive
(
this
, &
T—mReûiv”
::
¡doutHªdËr
);

104 
	}
}

106 
	gT—mReûiv”
::
	$tick
() {

107 
robÙ
 = 0;„obÙ < 
ROBOTS_PER_TEAM
; ++robot) {

108 ià(
	`time
(
NULL
è- 
	`»adFrom
(
»ûiv”
, 
Ï¡Reûived
)[
robÙ
] > 
SECS_TILL_INCAPACITATED
) {

109 
boŞ
 
šÿ·c™©ed
 = 
Œue
;

110 
	`wr™eTo
(
»ûiv”
, 
šÿ·c™©ed
[
robÙ
], incapacitated);

113 
	}
}

	@robot/receiver/Team.hpp

32 #´agm¨
Úû


34 
	~"Nao.hµ
"

35 
	~<¡ršg
>

36 
	~"ty³s/Brßdÿ¡D©a.hµ
"

37 
	~"bÏckbßrd/BÏckbßrd.hµ
"

38 
	~"bÏckbßrd/Ad­‹r.hµ
"

40 
şass
 
	gT—mReûiv”
 : 
Ad­‹r
, 
	gNaoReûiv”
 {

41 
	gpublic
:

45 
T—mReûiv”
(
BÏckbßrd
 *
bb
, (T—mReûiv”::*
hªdËr
)

46 (cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 & 
”rÜ
, 
¡d
::
size_t
) =

47 &
T—mReûiv”
::
ÇoHªdËr
);

52 
tick
();

54 
	g´iv©e
:

55 
ÇoHªdËr
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
, 
¡d
::
size_t
 
size
);

56 
¡doutHªdËr
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
, 
¡d
::
size_t
 
size
);

	@robot/soccer.cpp

34 
boŞ
 
	goffNao
 = 
çl£
;

35 
boŞ
 
	g©‹m±šgShutdown
 = 
çl£
;

	@robot/soccer.hpp

32 #´agm¨
Úû


34 
boŞ
 
offNao
;

35 
boŞ
 
©‹m±šgShutdown
;

	@robot/tests/TestBresenhamPtr.cpp

1 
	#BOOST_TEST_DYN_LINK


	)

2 
	~<io¡»am
>

3 
	~<boo¡/‹¡/un™_‹¡.hµ
>

5 
	~"uts/B»£nhamPŒ.hµ
"

7 
	$BOOST_AUTO_TEST_SUITE
(
b»£nham_±r
)

9 
	$BOOST_AUTO_TEST_CASE
(
hÜizÚl_Ëá
)

11 
buf
[20][40] = {{0}};

13 
x
, 
y
, 
i
;

14 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(2, 10), Point(18, 10), 40);

15 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

17 
i
 = 0, 
x
 = 2, 
y
 = 10; x < 18; ++ x, ++ i) {

18 
buf
[
x
][
y
] = 
i
;

19 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

20 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

22 ++ 
p
;

24 
	}
}

26 
	$BOOST_AUTO_TEST_CASE
(
hÜizÚl_right
)

28 
buf
[20][40] = {{0}};

30 
x
, 
y
, 
i
;

31 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(18, 10), Point(2, 10), 40);

32 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

34 
i
 = 0, 
x
 = 18, 
y
 = 10; x > 2; -- x, ++ i) {

35 
buf
[
x
][
y
] = 
i
;

36 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

37 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

39 ++ 
p
;

41 
	}
}

43 
	$BOOST_AUTO_TEST_CASE
(
v”tiÿl_down
)

45 
buf
[20][40] = {{0}};

47 
x
, 
y
, 
i
;

48 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(10, 2), Point(10, 18), 40);

49 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

51 
i
 = 0, 
x
 = 10, 
y
 = 2; y < 18; ++ y, ++ i) {

52 
buf
[
x
][
y
] = 
i
;

53 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

54 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

56 ++ 
p
;

58 
	}
}

60 
	$BOOST_AUTO_TEST_CASE
(
v”tiÿl_up
)

62 
buf
[20][40] = {{0}};

64 
x
, 
y
, 
i
;

65 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(10, 18), Point(10, 2), 40);

66 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

68 
i
 = 0, 
x
 = 10, 
y
 = 18; y > 2; -- y, ++ i) {

69 
buf
[
x
][
y
] = 
i
;

70 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

71 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

73 ++ 
p
;

75 
	}
}

77 
	$BOOST_AUTO_TEST_CASE
(
dŸg_µ
)

79 
buf
[20][40] = {{0}};

81 
x
, 
y
, 
i
;

82 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(2, 2), Point(18, 18), 40);

83 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

85 
i
 = 0, 
x
 = 2, 
y
 = 2; y < 18; ++ x, ++ y, ++ i) {

86 
buf
[
x
][
y
] = 
i
;

87 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

88 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

90 ++ 
p
;

92 
	}
}

94 
	$BOOST_AUTO_TEST_CASE
(
dŸg_²
)

96 
buf
[20][40] = {{0}};

98 
x
, 
y
, 
i
;

99 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(2, 18), Point(18, 2), 40);

100 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

102 
i
 = 0, 
x
 = 2, 
y
 = 18; x < 18; ++ x, -- y, ++ i) {

103 
buf
[
x
][
y
] = 
i
;

104 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

105 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

107 ++ 
p
;

109 
	}
}

111 
	$BOOST_AUTO_TEST_CASE
(
dŸg_Å
)

113 
buf
[20][40] = {{0}};

115 
x
, 
y
, 
i
;

116 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(18, 2), Point(2, 18), 40);

117 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

119 
i
 = 0, 
x
 = 18, 
y
 = 2; y < 18; -- x, ++ y, ++ i) {

120 
buf
[
x
][
y
] = 
i
;

121 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

122 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

124 ++ 
p
;

126 
	}
}

128 
	$BOOST_AUTO_TEST_CASE
(
dŸg_Â
)

130 
buf
[20][40] = {{0}};

132 
x
, 
y
, 
i
;

133 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(18, 18), Point(2, 2), 40);

134 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

136 
i
 = 0, 
x
 = 18, 
y
 = 18; y > 2; -- x, -- y, ++ i) {

137 
buf
[
x
][
y
] = 
i
;

138 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

139 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

141 ++ 
p
;

143 
	}
}

145 
	$BOOST_AUTO_TEST_CASE
(
dŸg_12
)

147 
buf
[20][40] = {{0}};

149 
x
, 
y
, 
i
;

150 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(2, 2), Point(18, 36), 40);

151 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

153 
i
 = 0, 
x
 = 2, 
y
 = 2; x < 10; ++ x, ++ y, ++ i) {

154 
buf
[
x
][
y
] = 
i
;

155 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

156 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

157 ++ 
p
;

159 ++ 
y
; ++ 
i
;

161 
buf
[
x
][
y
] = 
i
;

162 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

163 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

164 ++ 
p
;

166 
	}
}

168 
	$BOOST_AUTO_TEST_CASE
(
dŸg_21
)

170 
buf
[20][40] = {{0}};

172 
x
, 
y
, 
i
;

173 
B»£nhamPŒ
<> 
	`lše
(&
buf
[0][0], 
	`Pošt
(2, 2), Point(36, 18), 40);

174 
B»£nhamPŒ
<>::
™”©Ü
 
p
 = 
lše
.
	`begš
();

176 
i
 = 0, 
x
 = 2, 
y
 = 2; y < 10; ++ x, ++ y, ++ i) {

177 
buf
[
x
][
y
] = 
i
;

178 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

179 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

180 ++ 
p
;

182 ++ 
x
; ++ 
i
;

184 
buf
[
x
][
y
] = 
i
;

185 
	`BOOST_CHECK_EQUAL
(*
p
, 
i
);

186 
	`BOOST_CHECK_EQUAL
(
p
.
	`pošt
(), 
	`Pošt
(
x
, 
y
));

187 ++ 
p
;

189 
	}
}

192 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/TestFovea.cpp

1 
	~<¡ršg.h
>

3 
	~<io¡»am
>

5 
	~<boo¡/‹¡/un™_‹¡.hµ
>

7 
	~"Te¡Fov—D©a.hµ
"

8 
	~"³rû±iÚ/visiÚ/Fov—.hµ
"

10 
	$BOOST_AUTO_TEST_SUITE
(
visiÚ_fov—
)

12 
	$BOOST_AUTO_TEST_CASE
(
g»y
)

14 
Fov—T
<
hGßls
, 
eG»y
> 
	`fov—
(
	`BBox
(
	`Pošt
(0,0), Point(20, 30)), 1);

15 
	`memıy
(
fov—
.
_g»y
, 
¿ndom_š
, (random_in));

17 
fov—
.
	`blurG»y
();

18 
	`BOOST_CHECK
(
	`memcmp
(
fov—
.
_g»y
, 
g»y_out
, (grey_out)) == 0);

19 
	}
}

21 
	$BOOST_AUTO_TEST_CASE
(
edge
)

23 
Fov—T
<
hGßls
, 
eG»y
> 
	`fov—
(
	`BBox
(
	`Pošt
(0,0), Point(20, 30)), 1);

24 
	`memıy
(
fov—
.
_g»y
, 
¿ndom_š
, (random_in));

26 
fov—
.
	`blurG»y
();

27 
fov—
.
	`makeEdge
();

28 
	`BOOST_CHECK
(
	`memcmp
(
fov—
.
_edge
, 
edge_out
, (edge_out)) == 0);

29 
	}
}

31 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/TestHistogram.cpp

1 
	#BOOST_TEST_DYN_LINK


	)

2 
	#BOOST_TEST_MODULE
 
Su™es


	)

3 
	~<io¡»am
>

4 
	~<boo¡/‹¡/un™_‹¡.hµ
>

6 
	~"uts/Hi¡og¿m.hµ
"

8 
	$BOOST_AUTO_TEST_SUITE
(
visiÚ_hi¡og¿m
)

10 
	#DATA_SIZE
 8

	)

11 
d©a1
 [
DATA_SIZE
] = { 1, 2, 6, 3, 0, 1, 2, 3
	}
};

13 
	gexp11wš
 [
DATA_SIZE
] = { 1, 2, 6, 3, 0, 1, 2, 3};

14 
	gexp11³ak
 [
DATA_SIZE
] = { 2, -1, 0, 0, 0, 0, 0, 0};

15 
	gexp11wšc
 [
DATA_SIZE
] = { 1, 2, 6, 3, 0, 1, 2, 3};

16 
	gexp11³akc
[
DATA_SIZE
] = { 2, 7, -1, 0, 0, 0, 0, 0};

18 
	gexp12wš
 [
DATA_SIZE
] = { 0, 3, 8, 9, 3, 1, 3, 5};

19 
	gexp12³ak
 [
DATA_SIZE
] = { 3, -1, 0, 0, 0, 0, 0, 0};

20 
	gexp12wšc
 [
DATA_SIZE
] = { 4, 3, 8, 9, 3, 1, 3, 5};

21 
	gexp12³akc
[
DATA_SIZE
] = { 3, 7, -1, 0, 0, 0, 0, 0};

23 
	gexp13wš
 [
DATA_SIZE
] = { 0, 9, 11, 9, 4, 3, 6, 0};

24 
	gexp13³ak
 [
DATA_SIZE
] = { 2, -1, 0, 0, 0, 0, 0, 0};

25 
	gexp13wšc
 [
DATA_SIZE
] = { 6, 9, 11, 9, 4, 3, 6, 6};

26 
	gexp13³akc
[
DATA_SIZE
] = { 2, -1, 0, 0, 0, 0, 0, 0};

28 
	gexp14wš
 [
DATA_SIZE
] = { 0, 0, 12, 11, 10, 6, 6, 0};

29 
	gexp14³ak
 [
DATA_SIZE
] = {-1, 0, 0, 0, 0, 0, 0, 0};

30 
	gexp14wšc
 [
DATA_SIZE
] = { 8, 12, 12, 11, 10, 6, 6, 7};

31 
	gexp14³akc
[
DATA_SIZE
] = { 2, -1, 0, 0, 0, 0, 0, 0};

33 
	gd©a2
 [
DATA_SIZE
] = { 2, 1, 0, 0, 0, 0, 0, 1};

35 
	gexp23wš
 [
DATA_SIZE
] = { 0, 3, 1, 0, 0, 0, 1, 0};

36 
	gexp23³ak
 [
DATA_SIZE
] = {-1, 0, 0, 0, 0, 0, 0, 0};

37 
	gexp23wšc
 [
DATA_SIZE
] = { 4, 3, 1, 0, 0, 0, 1, 3};

38 
	gexp23³akc
[
DATA_SIZE
] = { 0, -1, 0, 0, 0, 0, 0, 0};

41 
	gd©a3
 [
DATA_SIZE
] = { 1, 0, 0, 0, 1, 0, 0, 0};

42 
	gd©a4
 [
DATA_SIZE
] = { 0, 0, 0, 1, 0, 0, 0, 1};

44 
	gexp33wš
 [
DATA_SIZE
] = { 0, 1, 0, 1, 1, 1, 0, 0};

45 
	gexp33³ak
 [
DATA_SIZE
] = { 4, -1, 0, 0, 0, 0, 0, 0};

46 
	gexp33wšc
 [
DATA_SIZE
] = { 1, 1, 0, 1, 1, 1, 0, 1};

47 
	gexp33³akc
[
DATA_SIZE
] = { 0, 4, -1, 0, 0, 0, 0, 0};

49 
	gexp43wš
 [
DATA_SIZE
] = { 0, 0, 1, 1, 1, 0, 1, 0};

50 
	gexp43³ak
 [
DATA_SIZE
] = { 3, -1, 0, 0, 0, 0, 0, 0};

51 
	gexp43wšc
 [
DATA_SIZE
] = { 1, 0, 1, 1, 1, 0, 1, 1};

52 
	gexp43³akc
[
DATA_SIZE
] = { 3, 7, -1, 0, 0, 0, 0, 0};

54 
boŞ
 
	$¬¿y_cmp
(
a
[
DATA_SIZE
][1], 
b
[DATA_SIZE])

56 ià(
	`memcmp
(
a
, 
b
, 
DATA_SIZE
 * (*a)) == 0) {

57  
Œue
;

59 
i
;

60 
¡d
::
û¼
 << "[";

61 
i
 = 0; i < 
DATA_SIZE
 - 1; ++ i) {

62 
¡d
::
û¼
 << 
a
[
i
][0] << ",";

64 
¡d
::
û¼
 << 
a
[
i
][0] << "] != [";

65 
i
 = 0; i < 
DATA_SIZE
 - 1; ++ i) {

66 
¡d
::
û¼
 << 
b
[
i
] << ",";

68 
¡d
::
û¼
 << 
b
[
i
] << "]" << std::
’dl
;

69  
çl£
;

71 
	}
}

73 
	$BOOST_AUTO_TEST_CASE
(
_wšdow_f‹r
)

75 
Hi¡og¿m
<, 1> 
	`hi¡
(
DATA_SIZE
);

76 
	`memıy
(
hi¡
.
_couÁs
, 
d©a1
, (data1));

78 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

79 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

80 
hi¡
.
	`­¶yWšdowF‹r
(1, 1);

81 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp11wš
));

82 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp11³ak
));

84 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

85 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

86 
hi¡
.
	`­¶yWšdowF‹r
(2, 1);

87 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp12wš
));

88 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp12³ak
));

90 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

91 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

92 
hi¡
.
	`­¶yWšdowF‹r
(3, 1);

93 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp13wš
));

94 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp13³ak
));

96 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

97 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

98 
hi¡
.
	`­¶yWšdowF‹r
(4, 1);

99 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp14wš
));

100 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp14³ak
));

102 
	`memıy
(
hi¡
.
_couÁs
, 
d©a2
, (data2));

103 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

104 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

105 
hi¡
.
	`­¶yWšdowF‹r
(3, 1);

106 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp23wš
));

107 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp23³ak
));

109 
	}
}

111 
	$BOOST_AUTO_TEST_CASE
(
_wšdow_f‹r_loİ
)

113 
Hi¡og¿m
<, 1> 
	`hi¡
(
DATA_SIZE
);

114 
	`memıy
(
hi¡
.
_couÁs
, 
d©a1
, (data1));

116 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

117 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

118 
hi¡
.
	`­¶yWšdowF‹rLoİ
(1, 1);

119 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp11wšc
));

120 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp11³akc
));

122 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

123 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

124 
hi¡
.
	`­¶yWšdowF‹rLoİ
(2, 1);

125 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp12wšc
));

126 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp12³akc
));

128 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

129 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

130 
hi¡
.
	`­¶yWšdowF‹rLoİ
(3, 1);

131 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp13wšc
));

132 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp13³akc
));

134 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

135 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

136 
hi¡
.
	`­¶yWšdowF‹rLoİ
(4, 1);

137 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp14wšc
));

138 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp14³akc
));

140 
	`memıy
(
hi¡
.
_couÁs
, 
d©a2
, (data2));

141 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

142 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

143 
hi¡
.
	`­¶yWšdowF‹rLoİ
(3, 1);

144 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp23wšc
));

145 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp23³akc
));

147 
	}
}

149 
	$BOOST_AUTO_TEST_CASE
(
_wšdow_f‹r_unifÜm
)

151 
Hi¡og¿m
<, 1> 
	`hi¡
(
DATA_SIZE
);

152 
	`memıy
(
hi¡
.
_couÁs
, 
d©a3
, (data3));

154 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

155 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

156 
hi¡
.
	`­¶yWšdowF‹r
(3, 1);

157 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp33wš
));

158 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp33³ak
));

160 
	`memıy
(
hi¡
.
_couÁs
, 
d©a4
, (data4));

162 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

163 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

164 
hi¡
.
	`­¶yWšdowF‹r
(3, 1);

165 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp43wš
));

166 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp43³ak
));

167 
	}
}

169 
	$BOOST_AUTO_TEST_CASE
(
_wšdow_f‹r_loİ_unifÜm
)

171 
Hi¡og¿m
<, 1> 
	`hi¡
(
DATA_SIZE
);

172 
	`memıy
(
hi¡
.
_couÁs
, 
d©a3
, (data3));

174 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

175 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

176 
hi¡
.
	`­¶yWšdowF‹rLoİ
(3, 1);

177 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp33wšc
));

178 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp33³akc
));

180 
	`memıy
(
hi¡
.
_couÁs
, 
d©a4
, (data4));

182 
	`mem£t
(
hi¡
.
_wšdow
, 0, (*hi¡._wšdowè* hi¡.
size
);

183 
	`mem£t
(
hi¡
.
_³aks
 , 0, (*hi¡._³ak è* hi¡.
size
);

184 
hi¡
.
	`­¶yWšdowF‹rLoİ
(3, 1);

185 
	`BOOST_CHECK
(
	`¬¿y_cmp
(
hi¡
.
_wšdow
, 
exp43wšc
));

186 
	`BOOST_CHECK
(
	`¬¿y_cmp
(((*)[1])
hi¡
.
_³aks
, 
exp43³akc
));

187 
	}
}

189 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/TestIKinematics.cpp

1 
	~<mÙiÚ/IKšem©ics.hµ
>

2 
	~<Eig’/Eig’
>

4 
usšg
 
Çme¥aû
 
	gIKšem©ics
;

5 
usšg
 
Çme¥aû
 
	gEig’
;

7 
NaoFoÙT¬g‘
 
	$fKšem©ics
(cÚ¡ 
NaoLegChaš
 &
chaš
)

9 
a
;

11 
a
 = 
chaš
.
h
;

12 
AngËAxis
<> 
Rh
 = AngËAxis<>(
a
, 
	`VeùÜ3d
(0, 1, 1).
	`nÜm®ized
());

14 
a
 = 
chaš
.
thighRŞl
;

15 
AngËAxis
<> 
RŒ
 = AngËAxis<>(
a
, 
	`VeùÜ3d
(1, 0, 0));

17 
a
 = 
chaš
.
thighP™ch
;

18 
AngËAxis
<> 
R
 = AngËAxis<>(
a
, 
	`VeùÜ3d
(0, 1, 0));

20 
a
 = 
chaš
.
kÃeP™ch
;

21 
AngËAxis
<> 
Rkp
 = AngËAxis<>(
a
, 
	`VeùÜ3d
(0, 1, 0));

23 
a
 = 
chaš
.
ªkËRŞl
;

24 
AngËAxis
<> 
R¬
 = AngËAxis<>(
a
, 
	`VeùÜ3d
(1, 0, 0));

26 
a
 = 
chaš
.
ªkËP™ch
;

27 
AngËAxis
<> 
R­
 = AngËAxis<>(
a
, 
	`VeùÜ3d
(0, 1, 0));

29 
T¿n¦©iÚ3d
 
	`Tt
(0, 0, -0.10000);

30 
T¿n¦©iÚ3d
 
	`Ts
(0, 0, -0.10290);

31 
T¿n¦©iÚ3d
 
	`Tf
(0, 0, -0.04519);

33 
M©rix4d
 
m
 = (
Rh
 * 
RŒ
 * 
R
 * 
Tt
 * 
Rkp
 * 
Ts
 * 
R­
 * 
R¬
 * 
Tf
).
	`m©rix
();

35 
NaoFoÙT¬g‘
 
r
;

36 
r
.
x
 = 
	`m
(0,3);

37 
r
.
y
 = 
	`m
(1,3);

38 
r
.
z
 = 
	`m
(2,3);

40 
r
.
rŞl
 = 
chaš
.
thighRŞl
 + chaš.
ªkËRŞl
;

41 
r
.
p™ch
 = -(
chaš
.
thighP™ch
 + chaš.
kÃeP™ch
 + chaš.
ªkËP™ch
);

42 
r
.
yaw
 = 
chaš
.
h
;

44  
r
;

46 
	}
}

48 
	$maš
(
¬gc
, **
¬gv
)

50 
NaoFoÙT¬g‘
 
rg‘
;

52 
rg‘
.
rŞl
 =¬g‘.
p™ch
 =¬g‘.
yaw
 = 0.f;

54 
rg‘
.
rŞl
 = 0.0;

55 
rg‘
.
p™ch
 = 0.0;

56 
rg‘
.
yaw
 = 0.0;

58 cÚ¡ 
m
 = 0.038;

60 
”rÜs
 = 0;

61 
runs
 = 0;

63 
rg‘
.
yaw
 = -0.2;¬g‘.yaw < 
M_PI_2
 / 1.5;arget.yaw += 0.1) {

64 
rg‘
.
x
 = -0.2;arget.x < 0.2;arget.x += 0.01) {

65 
rg‘
.
y
 = -0.2;arget.y < 0.2;arget.y += 0.01) {

66 
rg‘
.
z
 = -0.22;arget.z < -.10;arget.z += 0.1) {

67 ià(
rg‘
.
x
*rg‘.x +¬g‘.
y
*rg‘.y +¬g‘.
z
*rg‘.z > 
m
) {

70 ++ 
runs
;

72 
NaoLegChaš
 
chaš
 = 
	`NaoSŞve
(
rg‘
);

73 
NaoFoÙT¬g‘
 
fÜw¬d
 = 
	`fKšem©ics
(
chaš
);

75 ià((
	`çbsf
(
fÜw¬d
.
x
 - 
rg‘
.x ) < 0.02) &&

76 (
	`çbsf
(
fÜw¬d
.
y
 - 
rg‘
.y ) < 0.02) &&

77 (
	`çbsf
(
fÜw¬d
.
z
 - 
rg‘
.z ) < 0.02) &&

78 (
	`çbsf
(
fÜw¬d
.
p™ch
 - 
rg‘
.pitch) < 0.02) &&

79 (
	`çbsf
(
fÜw¬d
.
yaw
 - 
rg‘
.yaw ) < 0.02) &&

80 (
	`çbsf
(
fÜw¬d
.
rŞl
 - 
rg‘
.roll ) < 0.02))

85 
¡d
::
cout
 << "==ğERROR ===" << std::
’dl
;

86 
¡d
::
cout
 << 
chaš
;

87 
¡d
::
cout
 << 
rg‘
;

88 
¡d
::
cout
 << 
	`fKšem©ics
(
chaš
);

90 ++ 
”rÜs
;

96 
¡d
::
cout
 << 
”rÜs
 << "ƒ¼Ü äom " << 
runs
 << "„uns." << std::
’dl
;

97 
	}
}

	@robot/tests/TestProjections.cpp

1 
	~<io¡»am
>

2 
	~<boo¡/‹¡/un™_‹¡.hµ
>

4 
	~"³rû±iÚ/kšem©ics/Po£.hµ
"

6 
usšg
 
Çme¥aû
 
	gboo¡
::
num”ic
::
ubÏs
;

9 
	$BOOST_AUTO_TEST_SUITE
(
kšem©ics_po£
)

11 
	$BOOST_AUTO_TEST_CASE
(
fÜw¬d_backw¬ds
)

13 
m©rix
<> 
	`t
(4, 4);

14 
	`t
(0,0) = -0.190343;(1,0) = -0.980772;(2,0) = 0.043068;(3,0) = 0.0,

15 
	`t
(0,1) = -0.291743;(1,1) = 0.014622;(2,1) = -0.956385;(3,1) = 0.0,

16 
	`t
(0,2) = 0.937366;(1,2) = -0.194606;(2,2) = -0.288916;(3,2) = 0.0,

17 
	`t
(0,3) = 49.128441;(1,3) = -5.226813;(2,3) = 493.6120;(3,3) = 1.0;

19 
Po£
 
	`po£
(
t
, 
¡d
::
·œ
<, >(0, 0));

21 
i
;

22 
i
 = 0; i < 1000; ++ i) {

23 
Pošt
 
‹¡
 = 
	`Pošt
(
	`¿nd
(è% 
IMAGE_COLS
,„ªd(è% 
IMAGE_ROWS
);

25 
h
 = 
	`¿nd
() % 100;

26 
Pošt
 
robÙ
 = 
po£
.
	`imageToRobÙXY
(
‹¡
 , 
h
);

27 
Pošt
 
image
 = 
po£
.
	`robÙToImageXY
(
robÙ
, 
h
);

29 ià(
robÙ
.
	`x
() < 0) {

39 
	`BOOST_CHECK_LT
(
	`abs
(
‹¡
.
	`x
(è- 
image
.x()), 3);

40 
	`BOOST_CHECK_LT
(
	`abs
(
‹¡
.
	`y
(è- 
image
.y()), 3);

43 
	}
}

45 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/TestRANSACTypes.cpp

1 
	#BOOST_TEST_DYN_LINK


	)

2 
	~<¡dlib.h
>

3 
	~<m©h.h
>

5 
	~<®gÜ™hm
>

7 
	~<boo¡/‹¡/un™_‹¡.hµ
>

9 
	~"ty³s/Rª§cTy³s.hµ
"

11 
	$BOOST_AUTO_TEST_SUITE
(
¿n§c_ty³s
)

13 
	$BOOST_AUTO_TEST_CASE
(
cœşe_2p
)

15 
	`¤ªdom
(2);

17 
PoštF
 
c
;

18 
Pošt
 
p1
, 
p2
;

19 
¿d
;

21 
i
;

22 
i
 = 0; i < 1000; ++ i) {

23 
¿d
 = 
	`¿ndom
() % 900 + 100;

25 
c
.
	`x
(èğ
	`¿ndom
() % 2000 - 1000;

26 
c
.
	`y
(èğ
	`¿ndom
() % 2000 - 1000;

28 
p1
.
	`x
(èğ
c
.x(è+ 
	`¿ndom
(è% (
¿d
 * 2 + 1) -„ad;

29 
p1
.
	`y
(èğ
c
.y(è+ 
	`sq¹
(
¿d
*¿d - ((c.
	`x
() -…1.x())*(c.x() -…1.x())));

32 
p2
.
	`x
(èğ
c
.x(è+ 
	`¿ndom
(è% (
¿d
 * 2 + 1) -„ad;

33 
p2
.
	`y
(èğ
c
.y(è+ 
	`sq¹
(
¿d
*¿d - ((c.
	`x
() -…2.x())*(c.x() -…2.x())));

34 } 
p1
 =ğ
p2
);

36 
RANSACCœşe
 
	`rc
(
p1
, 
p2
, 
¿d
);

38 ià(! 
	`i¢ª
(
rc
.
¿dius
)) {

39 
	`BOOST_CHECK_CLOSE
((
c
 - 
p1
.
ÿ¡
<>()).
	`nÜm
(), ()
¿d
, 1);

40 
	`BOOST_CHECK_CLOSE
((
c
 - 
p2
.
ÿ¡
<>()).
	`nÜm
(), ()
¿d
, 1);

43 
	}
}

45 
	$BOOST_AUTO_TEST_CASE
(
cœşe_3p
)

47 
	`¤ªdom
(2);

49 
PoštF
 
c
;

50 
Pošt
 
p
[3];

51 
¿d
;

53 
i
, 
k
;

54 
ªgË
;

55 
i
 = 0; i < 1000; ++ i) {

56 
¿d
 = 
	`¿ndom
() % 900 + 100;

58 
c
.
	`x
(èğ
	`¿ndom
() % 2000 - 1000;

59 
c
.
	`y
(èğ
	`¿ndom
() % 2000 - 1000;

62 
k
 = 0; k < 3; ++ k) {

63 
ªgË
 = ((
	`¿ndom
(è% 32è/ 32è* 2 * 
M_PI
;

64 
p
[
k
].
	`x
(èğ
¿d
 * 
	`cos
(
ªgË
);

65 
p
[
k
].
	`y
(èğ
¿d
 * 
	`sš
(
ªgË
);

68 
RANSACCœşe
 
	`rc
(
p
[0],…[1],…[2]);

70 ià(! 
	`i¢ª
(
rc
.
¿dius
)) {

71 
	`BOOST_CHECK_CLOSE
(
rc
.
ûÁ»
.
	`x
(), 
c
.x(), 1);

72 
	`BOOST_CHECK_CLOSE
(
rc
.
ûÁ»
.
	`y
(), 
c
.y(), 1);

75 
	}
}

77 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/TestRansac.cpp

1 
	#BOOST_TEST_DYN_LINK


	)

2 
	~<¡dlib.h
>

3 
	~<m©h.h
>

5 
	~<®gÜ™hm
>

6 
	~<veùÜ
>

8 
	~<boo¡/¿ndom/m”£Âe_twi¡”.hµ
>

9 
	~<boo¡/¿ndom/nÜm®_di¡ributiÚ.hµ
>

10 
	~<boo¡/¿ndom/v¬Ÿ‹_g’”©Ü.hµ
>

12 
	~<boo¡/‹¡/un™_‹¡.hµ
>

14 
	~"³rû±iÚ/visiÚ/Rª§c.hµ
"

15 
	~"ty³s/Rª§cTy³s.hµ
"

17 
	#N_POINTS
 16

	)

20 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wuninitialized"

22 
	$BOOST_AUTO_TEST_SUITE
(
¿n§c
)

24 
	$BOOST_AUTO_TEST_CASE
(
cœşe_exaù
)

26 
¡d
::
veùÜ
<
Pošt
> 
	`±s
(
N_POINTS
);

28 
¡d
::
veùÜ
<
boŞ
> 
cÚs_buf
[2];

29 
cÚs_buf
[0].
	`š£¹
(cÚs_buf[0].
	`’d
(), 
N_POINTS
, 
çl£
);

30 
cÚs_buf
[1].
	`š£¹
(cÚs_buf[1].
	`’d
(), 
N_POINTS
, 
çl£
);

32 
¡d
::
veùÜ
<
boŞ
> *
cÚs
;

34 
RANSACCœşe
 
»suÉ
;

36 
£ed
 = 0;

38 
PoštF
 
c
;

40 
i
;

41 
i
 = 0; i < 1000; ++ i) {

42 
c
.
	`x
(èğ
	`¿ndom
() % 2000 - 1000;

43 
c
.
	`y
(èğ
	`¿ndom
() % 2000 - 1000;

45 
¿dius
 = 
	`¿ndom
() % 900 + 100;

47 
j
;

48 
j
 = 0; j < 
N_POINTS
; ++ j) {

49 
±s
[
j
] = (
c
 + 
	`PoštF
(
	`cos
(j * 2 * 
M_PI
 / 
N_POINTS
),

50 
	`sš
(
j
 * 2 * 
M_PI
 / 
N_POINTS
))

51 * 
¿dius
).
ÿ¡
<>();

54 
RANSAC
::
	`fšdCœşeOfRadius
(
±s
, 
¿dius
, &
cÚs
, 
»suÉ
, 32, 10,

55 
N_POINTS
 / 2, 
cÚs_buf
, &
£ed
);

57 
	`BOOST_CHECK_LT
(
»suÉ
.
ûÁ»
.
	`x
(è- 
c
.x(), 10);

58 
	`BOOST_CHECK_LT
(
»suÉ
.
ûÁ»
.
	`y
(è- 
c
.y(), 10);

60 
	}
}

62 
	$BOOST_AUTO_TEST_CASE
(
cœşe_noi£
)

64 
boo¡
::
mt19937
 
g’
;

66 
¡d
::
veùÜ
<
Pošt
> 
	`±s
(
N_POINTS
 * 3);

68 
¡d
::
veùÜ
<
boŞ
> 
cÚs_buf
[2];

69 
cÚs_buf
[0].
	`š£¹
(cÚs_buf[0].
	`’d
(), 
N_POINTS
, 
çl£
);

70 
cÚs_buf
[1].
	`š£¹
(cÚs_buf[1].
	`’d
(), 
N_POINTS
, 
çl£
);

72 
¡d
::
veùÜ
<
boŞ
> *
cÚs
;

74 
RANSACCœşe
 
»suÉ
;

76 
£ed
 = 0;

78 
PoštF
 
c
;

80 
i
, 
j
, 
k
;

81 
i
 = 0; i < 1000; ++ i) {

82 
c
.
	`x
(èğ
	`¿ndom
() % 2000 - 1000;

83 
c
.
	`y
(èğ
	`¿ndom
() % 2000 - 1000;

85 
¿dius
 = 
	`¿ndom
() % 900 + 100;

87 
boo¡
::
nÜm®_di¡ributiÚ
<> 
	`di¡
(0, 0.01);

88 
boo¡
::
v¬Ÿ‹_g’”©Ü
<boo¡::
mt19937
&, boo¡::
nÜm®_di¡ributiÚ
<> >

89 
	`noi£
(
g’
, 
di¡
);

91 
j
 = 0; j < 
N_POINTS
; ++ j) {

92 
k
 = 0; k < 3; ++ k) {

93 
±s
[
j
*3 + 
k
] = (
c
 + 
	`PoštF
(
	`cos
(j * 2 * 
M_PI
 / 
N_POINTS
),

94 
	`sš
(
j
 * 2 * 
M_PI
 / 
N_POINTS
))

95 * 
¿dius
 * (1 + 
	`noi£
())).
ÿ¡
<>();

99 
RANSAC
::
	`fšdCœşeOfRadius
(
±s
, 
¿dius
, &
cÚs
, 
»suÉ
, 100, 10,

100 
N_POINTS
 / 2, 
cÚs_buf
, &
£ed
);

102 
	`BOOST_CHECK_LT
(
»suÉ
.
ûÁ»
.
	`x
(è- 
c
.x(), 100);

103 
	`BOOST_CHECK_LT
(
»suÉ
.
ûÁ»
.
	`y
(è- 
c
.y(), 100);

105 
	}
}

107 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/perception/localisation/robotfilter/TestRobotFilter.cpp

1 
	~<m©h.h
>

3 
	~<veùÜ
>

5 
	~<boo¡/‹¡/un™_‹¡.hµ
>

7 
	~"ty³s/Odom‘ry.hµ
"

8 
	~"ty³s/AbsCoÜd.hµ
"

9 
	~"ty³s/RRCoÜd.hµ
"

10 
	~"ty³s/RobÙInfo.hµ
"

11 
	~"ty³s/RobÙOb¡aşe.hµ
"

12 
	~"³rû±iÚ/loÿli§tiÚ/robÙf‹r/ty³s/RobÙF‹rUpd©e.hµ
"

13 
	~"³rû±iÚ/loÿli§tiÚ/robÙf‹r/RobÙF‹r.hµ
"

15 
	~"uts/ªgËs.hµ
"

17 
	#CMs
(
x
è(x * 10)

	)

19 cÚ¡ 
Odom‘ry
 
	gEMPTY_ODOMETRY
;

20 cÚ¡ 
AbsCoÜd
 
	gCENTER_FIELD
;

22 
	$BOOST_AUTO_TEST_SUITE
(
robÙ_f‹r
)

24 
RobÙF‹rUpd©e
 
	`ü—‹Upd©e
(
¡d
::
veùÜ
<
RobÙInfo
> 
visu®RobÙs
,

25 
AbsCoÜd
 
robÙPos
,

26 
h—dYaw
,

27 
Odom‘ry
 
odom‘ryDiff
,

28 
boŞ
 
isInÿ·c™©ed
) {

30 
RobÙF‹rUpd©e
 
upd©e
;

31 
upd©e
.
visu®RobÙs
 = visualRobots;

32 
upd©e
.
robÙPos
 =„obotPos;

33 
upd©e
.
h—dYaw
 = headYaw;

34 
upd©e
.
odom‘ryDiff
 = odometryDiff;

35 
upd©e
.
isInÿ·c™©ed
 = isIncapacitated;

36  
upd©e
;

37 
	}
}

41 
	$BOOST_AUTO_TEST_CASE
(
ÿ¹esŸn_sšgË_robÙ_group
) {

42 
RobÙF‹r
 
robÙF‹r
;

44 
RobÙInfo
 
robÙA
, 
robÙB
;

45 
robÙA
.
¼
 = 
	`RRCoÜd
(
	`CMs
(20), 
	`DEG2RAD
(-45));

46 
robÙB
.
¼
 = 
	`RRCoÜd
(
	`CMs
(20), 
	`DEG2RAD
(45));

48 
¡d
::
veùÜ
<
RobÙInfo
> 
visu®RobÙs
;

49 
visu®RobÙs
.
	`push_back
(
robÙA
);

50 
visu®RobÙs
.
	`push_back
(
robÙB
);

52 
robÙF‹r
.
	`upd©e
(
	`ü—‹Upd©e
(
visu®RobÙs
, 
CENTER_FIELD
, 0, 
EMPTY_ODOMETRY
, 
çl£
));

56 
RobÙInfo
 
robÙC
, 
robÙD
, 
robÙE
;

57 
robÙC
.
¼
 = 
	`RRCoÜd
(
	`CMs
(15), 
	`DEG2RAD
(-25));

58 
robÙD
.
¼
 = 
	`RRCoÜd
(
	`CMs
(15), 
	`DEG2RAD
(25));

59 
robÙE
.
¼
 = 
	`RRCoÜd
(
	`CMs
(20), 0);

61 
visu®RobÙs
.
	`ş—r
();

62 
visu®RobÙs
.
	`push_back
(
robÙC
);

63 
visu®RobÙs
.
	`push_back
(
robÙD
);

64 
visu®RobÙs
.
	`push_back
(
robÙE
);

65 
robÙF‹r
.
	`upd©e
(
	`ü—‹Upd©e
(
visu®RobÙs
, 
CENTER_FIELD
, 0, 
EMPTY_ODOMETRY
, 
çl£
));

66 
¡d
::
veùÜ
<
RobÙOb¡aşe
> 
ob¡aşes
 = 
robÙF‹r
.
	`upd©e
(
	`ü—‹Upd©e
(
visu®RobÙs
, 
CENTER_FIELD
, 0, 
EMPTY_ODOMETRY
, 
çl£
));

67 
	`BOOST_CHECK_EQUAL
(
ob¡aşes
.
	`size
(), ()2);

69 
ob¡aşes
 = 
robÙF‹r
.
	`upd©e
(
	`ü—‹Upd©e
(
visu®RobÙs
, 
CENTER_FIELD
, 0, 
EMPTY_ODOMETRY
, 
çl£
));

70 
	`BOOST_CHECK_EQUAL
(
ob¡aşes
.
	`size
(), ()3);

71 
	}
}

73 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/perception/localisation/robotfilter/types/TestGroupedRobots.cpp

1 
	~<¡ršg.h
>

3 
	~<io¡»am
>

5 
	~<m©h.h
>

7 
	~<boo¡/‹¡/un™_‹¡.hµ
>

9 
	~"ty³s/RobÙInfo.hµ
"

10 
	~"ty³s/RRCoÜd.hµ
"

11 
	~"ty³s/AbsCoÜd.hµ
"

12 
	~"ty³s/Odom‘ry.hµ
"

13 
	~"³rû±iÚ/loÿli§tiÚ/robÙf‹r/ty³s/RobÙOb£rv©iÚ.hµ
"

14 
	~"³rû±iÚ/loÿli§tiÚ/robÙf‹r/ty³s/Grou³dRobÙs.hµ
"

16 
	~"uts/ªgËs.hµ
"

18 
	#NINETY_DEGREES
 
M_PI_2


	)

19 
	#RADIAN_ERROR
 0.001

	)

20 
	#CMs
(
x
è(x * 10)

	)

22 cÚ¡ 
	gDEFAULT_HEAD_YAW
 = 0.0f;

24 cÚ¡ 
AbsCoÜd
 
	gCENTER_FIELD
;

26 cÚ¡ 
Odom‘ry
 
	gEMPTY_ODOMETRY
;

28 
	$BOOST_AUTO_TEST_SUITE
(
grou³d_robÙs
)

32 
	$BOOST_AUTO_TEST_CASE
(
ÿ¹esŸn_sšgË_robÙ_group
)

34 
RRCoÜd
 
	`robÙRR
(
	`CMs
(100), 0);

35 
Pošt
 
robÙC¬‹sŸn
 = 
robÙRR
.
	`toC¬‹sŸn
();

36 
RobÙInfo
 
robÙ
;

37 
robÙ
.
¼
 = 
robÙRR
;

39 
Grou³dRobÙs
 
	`group
(
robÙ
);

41 
i
 = 0; i < 3; ++i) {

42 
RRCoÜd
 
groupCoÜdš©es
 = 
group
.
	`g‘RRCoÜdš©es
();

43 
	`BOOST_CHECK_EQUAL
(
robÙRR
.
	`di¡ªû
(), 
groupCoÜdš©es
.distance());

44 
	`BOOST_CHECK_EQUAL
(
robÙRR
.
	`h—dšg
(), 
groupCoÜdš©es
.heading());

46 
Pošt
 
groupC¬‹sŸn
 = 
group
.
	`g‘C¬‹sŸnCoÜdš©es
();

47 
	`BOOST_CHECK_EQUAL
(
robÙC¬‹sŸn
[0], 
groupC¬‹sŸn
[0]);

48 
	`BOOST_CHECK_EQUAL
(
robÙC¬‹sŸn
[1], 
groupC¬‹sŸn
[1]);

50 
Odom‘ry
 
EMPTY_ODOMETRY
;

51 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
CENTER_FIELD
);

53 
	}
}

56 
	$BOOST_AUTO_TEST_CASE
(
‹¡_¡®e_group
)

58 
RRCoÜd
 
	`robÙRR
(
	`CMs
(100), 0);

59 
Pošt
 
robÙC¬‹sŸn
 = 
robÙRR
.
	`toC¬‹sŸn
();

60 
RobÙInfo
 
robÙ
;

61 
robÙ
.
¼
 = 
robÙRR
;

63 
Grou³dRobÙs
 
	`group
(
robÙ
);

65 
i
 = 0; i < 
RobÙOb£rv©iÚ
::
	`numb”OnSü“nF¿mesToBeSË
(); ++i) {

66 
Odom‘ry
 
EMPTY_ODOMETRY
;

67 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
CENTER_FIELD
);

69 
	`BOOST_CHECK
(
group
.
	`isEm±y
());

70 
	}
}

73 
	$BOOST_AUTO_TEST_CASE
(
odom‘ry_group
)

75 cÚ¡ 
MOVE_DISTANCE
 = 
	`CMs
(50);

76 
RRCoÜd
 
	`robÙRR
(0, 0);

77 
Pošt
 
robÙC¬‹sŸn
 = 
robÙRR
.
	`toC¬‹sŸn
();

78 
RobÙInfo
 
robÙ
;

79 
robÙ
.
¼
 = 
robÙRR
;

81 
Grou³dRobÙs
 
	`group
(
robÙ
);

82 
Odom‘ry
 
odom‘ry
;

83 
odom‘ry
.
fÜw¬d
 = -
	`CMs
(50);

84 cÚ¡ 
NUMBER_TICKS
 = 5;

85 
i
 = 0; i < 
NUMBER_TICKS
; ++i) {

86 
group
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
CENTER_FIELD
);

89 
	`BOOST_CHECK_EQUAL
(
MOVE_DISTANCE
 * 
NUMBER_TICKS
, 
group
.
	`g‘RRCoÜdš©es
().
	`di¡ªû
());

90 
	}
}

92 
	$BOOST_AUTO_TEST_CASE
(
m”ge_robÙ_hÜizÚÎy_şo£
)

94 
xDi¡ªû
 = 
	`CMs
(100);

95 
AbsCoÜd
 
	`robÙA
(
xDi¡ªû
, 0, 0);

96 
RRCoÜd
 
robÙARR
 = 
robÙA
.
	`cÚv”tToRobÙR–©ive
();

97 
RobÙInfo
 
š™ŸlRobÙ
;

98 
š™ŸlRobÙ
.
¼
 = 
robÙARR
;

99 
Grou³dRobÙs
 
	`group
(
š™ŸlRobÙ
);

101 
AbsCoÜd
 
	`robÙB
(
xDi¡ªû
, 
Grou³dRobÙs
::
ELLIPSE_HORIZONTAL
 - 
	`CMs
(10), 0);

102 
RRCoÜd
 
robÙBRR
 = 
robÙB
.
	`cÚv”tToRobÙR–©ive
();

103 
RobÙInfo
 
m”g—bËRobÙ
;

104 
m”g—bËRobÙ
.
¼
 = 
robÙBRR
;

106 
AbsCoÜd
 
	`robÙC
(
xDi¡ªû
, 
Grou³dRobÙs
::
ELLIPSE_HORIZONTAL
 + 
	`CMs
(10), 0);

107 
RRCoÜd
 
robÙCRR
 = 
robÙC
.
	`cÚv”tToRobÙR–©ive
();

108 
RobÙInfo
 
unm”g—bËRobÙ
;

109 
unm”g—bËRobÙ
.
¼
 = 
robÙCRR
;

111 
	`BOOST_CHECK
(
group
.
	`ÿnM”geRobÙ
(
m”g—bËRobÙ
));

112 
	`BOOST_CHECK
(!
group
.
	`ÿnM”geRobÙ
(
unm”g—bËRobÙ
));

113 
	}
}

115 
	$BOOST_AUTO_TEST_CASE
(
m”ge_robÙ_v”tiÿÎy_şo£
)

117 
xDi¡ªû
 = 
	`CMs
(100);

118 
AbsCoÜd
 
	`robÙA
(
xDi¡ªû
, 0, 0);

119 
RRCoÜd
 
robÙARR
 = 
robÙA
.
	`cÚv”tToRobÙR–©ive
();

120 
RobÙInfo
 
š™ŸlRobÙ
;

121 
š™ŸlRobÙ
.
¼
 = 
robÙARR
;

122 
Grou³dRobÙs
 
	`group
(
š™ŸlRobÙ
);

124 
AbsCoÜd
 
	`robÙB
(
xDi¡ªû
 + 
Grou³dRobÙs
::
ELLIPSE_VERTICAL
 - 
	`CMs
(10), 0, 0);

125 
RRCoÜd
 
robÙBRR
 = 
robÙB
.
	`cÚv”tToRobÙR–©ive
();

126 
RobÙInfo
 
m”g—bËRobÙ
;

127 
m”g—bËRobÙ
.
¼
 = 
robÙBRR
;

129 
AbsCoÜd
 
	`robÙC
(
xDi¡ªû
 + 
Grou³dRobÙs
::
ELLIPSE_VERTICAL
 + 
	`CMs
(10), 0, 0);

130 
RRCoÜd
 
robÙCRR
 = 
robÙC
.
	`cÚv”tToRobÙR–©ive
();

131 
RobÙInfo
 
unm”g—bËRobÙ
;

132 
unm”g—bËRobÙ
.
¼
 = 
robÙCRR
;

134 
	`BOOST_CHECK
(
group
.
	`ÿnM”geRobÙ
(
m”g—bËRobÙ
));

135 
	`BOOST_CHECK
(!
group
.
	`ÿnM”geRobÙ
(
unm”g—bËRobÙ
));

136 
	}
}

142 
	$BOOST_AUTO_TEST_CASE
(
m”ge_robÙ_v”tiÿÎy_max_time
)

144 
¡¬tDi¡ªû
 = 
	`CMs
(100);

145 
AbsCoÜd
 
	`robÙA
(
¡¬tDi¡ªû
, 0, 0);

146 
RRCoÜd
 
robÙARR
 = 
robÙA
.
	`cÚv”tToRobÙR–©ive
();

147 
RobÙInfo
 
š™ŸlRobÙ
;

148 
š™ŸlRobÙ
.
¼
 = 
robÙARR
;

149 
Grou³dRobÙs
 
	`group
(
š™ŸlRobÙ
);

150 
Odom‘ry
 
EMPTY_ODOMETRY
;

152 
i
 = 0; i < 
RobÙOb£rv©iÚ
::
	`numb”OnSü“nF¿mesToBeSË
() - 1; ++i) {

153 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
CENTER_FIELD
);

156 
maxM”ge
 = 
Grou³dRobÙs
::
MAX_MERGE_SCALE
 * Grou³dRobÙs::
ELLIPSE_VERTICAL
;

158 
AbsCoÜd
 
	`robÙB
(
¡¬tDi¡ªû
 + 
maxM”ge
 - 
	`CMs
(1), 0, 0);

159 
RRCoÜd
 
robÙBRR
 = 
robÙB
.
	`cÚv”tToRobÙR–©ive
();

160 
RobÙInfo
 
m”g—bËRobÙ
;

161 
m”g—bËRobÙ
.
¼
 = 
robÙBRR
;

163 
AbsCoÜd
 
	`robÙC
(
¡¬tDi¡ªû
 + 
maxM”ge
 + 
	`CMs
(1), 0, 0);

164 
RRCoÜd
 
robÙCRR
 = 
robÙC
.
	`cÚv”tToRobÙR–©ive
();

165 
RobÙInfo
 
unm”g—bËRobÙ
;

166 
unm”g—bËRobÙ
.
¼
 = 
robÙCRR
;

168 
	`BOOST_CHECK
(
group
.
	`ÿnM”geRobÙ
(
m”g—bËRobÙ
));

169 
	`BOOST_CHECK
(!
group
.
	`ÿnM”geRobÙ
(
unm”g—bËRobÙ
));

170 
	}
}

172 
	$BOOST_AUTO_TEST_CASE
(
m”ge_robÙ_hÜizÚÎy_max_time
)

174 
¡¬tDi¡ªû
 = 
	`CMs
(100);

175 
AbsCoÜd
 
	`robÙA
(
¡¬tDi¡ªû
, 0, 0);

176 
RRCoÜd
 
robÙARR
 = 
robÙA
.
	`cÚv”tToRobÙR–©ive
();

177 
RobÙInfo
 
š™ŸlRobÙ
;

178 
š™ŸlRobÙ
.
¼
 = 
robÙARR
;

179 
Grou³dRobÙs
 
	`group
(
š™ŸlRobÙ
);

180 
Odom‘ry
 
EMPTY_ODOMETRY
;

182 
i
 = 0; i < 
RobÙOb£rv©iÚ
::
	`numb”OnSü“nF¿mesToBeSË
() - 1; ++i) {

183 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
CENTER_FIELD
);

186 
maxM”ge
 = 
Grou³dRobÙs
::
MAX_MERGE_SCALE
 * Grou³dRobÙs::
ELLIPSE_HORIZONTAL
;

188 
AbsCoÜd
 
	`robÙB
(
¡¬tDi¡ªû
, 
maxM”ge
 - 
	`CMs
(1), 0);

189 
RRCoÜd
 
robÙBRR
 = 
robÙB
.
	`cÚv”tToRobÙR–©ive
();

190 
RobÙInfo
 
m”g—bËRobÙ
;

191 
m”g—bËRobÙ
.
¼
 = 
robÙBRR
;

193 
AbsCoÜd
 
	`robÙC
(
¡¬tDi¡ªû
, 
maxM”ge
 + 
	`CMs
(1), 0);

194 
RRCoÜd
 
robÙCRR
 = 
robÙC
.
	`cÚv”tToRobÙR–©ive
();

195 
RobÙInfo
 
unm”g—bËRobÙ
;

196 
unm”g—bËRobÙ
.
¼
 = 
robÙCRR
;

198 
	`BOOST_CHECK
(
group
.
	`ÿnM”geRobÙ
(
m”g—bËRobÙ
));

199 
	`BOOST_CHECK
(!
group
.
	`ÿnM”geRobÙ
(
unm”g—bËRobÙ
));

200 
	}
}

204 
	$BOOST_AUTO_TEST_CASE
(
robÙ_too_çr_fÜw¬d
) {

206 
RobÙInfo
 
robÙ
;

207 
robÙ
.
¼
 = 
	`RRCoÜd
(
	`CMs
(300), 0);

209 
Grou³dRobÙs
 
group
;

210 
group
.
	`m”geRobÙ
(
robÙ
);

211 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
CENTER_FIELD
);

213 
	`BOOST_CHECK_EQUAL
(
group
.
	`isOnF›ld
(), 
Œue
);

214 
AbsCoÜd
 
	`robÙPos
(
	`CMs
(100), 0, 0);

215 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
robÙPos
);

218 
	`BOOST_CHECK_EQUAL
(
group
.
	`isOnF›ld
(), 
Œue
);

220 
robÙPos
 = 
	`AbsCoÜd
(
	`CMs
(200), 0, 0);

221 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
robÙPos
);

222 
	`BOOST_CHECK_EQUAL
(
group
.
	`isOnF›ld
(), 
çl£
);

223 
	}
}

225 
	$BOOST_AUTO_TEST_CASE
(
robÙ_too_çr_right
) {

227 
RobÙInfo
 
robÙ
;

228 
robÙ
.
¼
 = 
	`RRCoÜd
(
	`CMs
(100), 
	`DEG2RAD
(45));

230 
Grou³dRobÙs
 
group
;

231 
group
.
	`m”geRobÙ
(
robÙ
);

232 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
CENTER_FIELD
);

234 
	`BOOST_CHECK_EQUAL
(
group
.
	`isOnF›ld
(), 
Œue
);

235 
AbsCoÜd
 
	`robÙPos
(0, 
	`CMs
(150), 0);

236 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
robÙPos
);

237 
	`BOOST_CHECK_EQUAL
(
group
.
	`isOnF›ld
(), 
Œue
);

238 
robÙPos
 = 
	`AbsCoÜd
(0, 
	`CMs
(250), 0);

239 
group
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 
robÙPos
);

240 
	`BOOST_CHECK_EQUAL
(
group
.
	`isOnF›ld
(), 
çl£
);

241 
	}
}

244 
	$BOOST_AUTO_TEST_CASE
(
robÙ_ng’ts
) {

245 
RobÙInfo
 
robÙ
;

246 
robÙ
.
¼
 = 
	`RRCoÜd
(
	`CMs
(45), 0);

248 
Grou³dRobÙs
 
group
;

249 
group
.
	`m”geRobÙ
(
robÙ
);

250 
group
.
	`m”geRobÙ
(
robÙ
);

252 
RobÙOb¡aşe
 
ob¡aşe
 = 
group
.
	`g’”©eRobÙOb¡aşe
();

254 
	`BOOST_CHECK_CLOSE
(
ob¡aşe
.
ng’tH—dšgLeá
, 
	`DEG2RAD
(45), 0.0001);

255 
	`BOOST_CHECK_CLOSE
(
ob¡aşe
.
ng’tH—dšgRight
, -
	`DEG2RAD
(45), 0.0001);

256 
	}
}

258 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/tests/perception/localisation/robotfilter/types/TestRobotObservation.cpp

1 
	~<¡ršg.h
>

3 
	~<io¡»am
>

5 
	~<m©h.h
>

7 
	~<boo¡/‹¡/un™_‹¡.hµ
>

9 
	~"ty³s/RobÙInfo.hµ
"

10 
	~"ty³s/RRCoÜd.hµ
"

11 
	~"ty³s/Odom‘ry.hµ
"

12 
	~"³rû±iÚ/loÿli§tiÚ/robÙf‹r/ty³s/RobÙOb£rv©iÚ.hµ
"

13 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

15 
	~"uts/ªgËs.hµ
"

17 
	#NINETY_DEGREES
 
M_PI_2


	)

18 
	#RADIAN_ERROR
 0.001

	)

19 
	#CMs
(
x
è(x * 10)

	)

21 cÚ¡ 
	gDEFAULT_HEAD_YAW
 = 0.0f;

23 cÚ¡ 
	gMAX_VISION_HEADING
 = 0.5à* 
IMAGE_HFOV
;

24 cÚ¡ 
	gMIN_VISION_HEADING
 = -
MAX_VISION_HEADING
;

26 cÚ¡ 
	gDEFAULT_DISTANCE_TO_GROUP
 = 0.0;

28 cÚ¡ 
Odom‘ry
 
	gEMPTY_ODOMETRY
;

30 
	$BOOST_AUTO_TEST_SUITE
(
ob£rv©iÚ_‹¡
)

32 
	$BOOST_AUTO_TEST_CASE
(
‹¡_odom‘ry_fÜw¬d
)

34 cÚ¡ 
FORWARD_MOVEMENT
 = 
	`CMs
(5);

35 
di¡ªû
 = 
	`CMs
(10);

36 
RobÙInfo
 
visu®RobÙ
;

37 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
di¡ªû
, 0);

39 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

41 
Odom‘ry
 
odom‘ry
;

43 
odom‘ry
.
fÜw¬d
 = 
FORWARD_MOVEMENT
;

44 
odom‘ry
.
Ëá
 = 0;

45 
odom‘ry
.
tuº
 = 0;

47 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

49 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
().
	`di¡ªû
(), 
di¡ªû
 - 
FORWARD_MOVEMENT
);

50 
	}
}

52 
	$BOOST_AUTO_TEST_CASE
(
‹¡_odom‘ry_back
)

54 cÚ¡ 
BACK_MOVEMENT
 = 
	`CMs
(5);

55 
di¡ªû
 = 
	`CMs
(10);

56 
RobÙInfo
 
visu®RobÙ
;

57 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
di¡ªû
, 0);

59 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

61 
Odom‘ry
 
odom‘ry
;

63 
odom‘ry
.
fÜw¬d
 = -
BACK_MOVEMENT
;

64 
odom‘ry
.
Ëá
 = 0;

65 
odom‘ry
.
tuº
 = 0;

67 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

69 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
().
	`di¡ªû
(), 
di¡ªû
 + 
BACK_MOVEMENT
);

70 
	}
}

73 
	$BOOST_AUTO_TEST_CASE
(
‹¡_odom‘ry_Ëá
)

75 cÚ¡ 
LEFT_MOVEMENT
 = 
	`CMs
(4);

76 
di¡ªû
 = 
	`CMs
(3);

77 
RobÙInfo
 
visu®RobÙ
;

78 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
di¡ªû
, 0);

80 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

82 
Odom‘ry
 
odom‘ry
;

84 
odom‘ry
.
fÜw¬d
 = 0;

85 
odom‘ry
.
Ëá
 = 
LEFT_MOVEMENT
;

86 
odom‘ry
.
tuº
 = 0;

88 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

90 
RRCoÜd
 
ÃwCoÜdš©es
 = 
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
();

91 
	`BOOST_CHECK_EQUAL
(
ÃwCoÜdš©es
.
	`di¡ªû
(), 
	`CMs
(5));

92 
	`BOOST_CHECK_CLOSE
(
ÃwCoÜdš©es
.
	`h—dšg
(), -0.92729, 
RADIAN_ERROR
);

93 
	}
}

95 
	$BOOST_AUTO_TEST_CASE
(
‹¡_odom‘ry_right
)

97 cÚ¡ 
LEFT_MOVEMENT
 = -
	`CMs
(4);

98 
di¡ªû
 = 
	`CMs
(3);

99 
RobÙInfo
 
visu®RobÙ
;

100 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
di¡ªû
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

102 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

104 
Odom‘ry
 
odom‘ry
;

106 
odom‘ry
.
fÜw¬d
 = 0;

107 
odom‘ry
.
Ëá
 = 
LEFT_MOVEMENT
;

108 
odom‘ry
.
tuº
 = 0;

110 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

112 
RRCoÜd
 
ÃwCoÜdš©es
 = 
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
();

113 
	`BOOST_CHECK_EQUAL
(
ÃwCoÜdš©es
.
	`di¡ªû
(), 
	`CMs
(5));

114 
	`BOOST_CHECK_CLOSE
(
ÃwCoÜdš©es
.
	`h—dšg
(), 0.92729, 
RADIAN_ERROR
);

115 
	}
}

118 
	$BOOST_AUTO_TEST_CASE
(
‹¡_odom‘ry_tuº_Ëá
)

120 
RobÙInfo
 
visu®RobÙ
;

121 
DISTANCE
 = 
	`CMs
(3);

122 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
DISTANCE
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

124 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

126 
Odom‘ry
 
odom‘ry
;

128 
odom‘ry
.
fÜw¬d
 = 0;

129 
odom‘ry
.
Ëá
 = 0;

130 
odom‘ry
.
tuº
 = 
NINETY_DEGREES
;

132 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

134 
RRCoÜd
 
ÃwCoÜdš©es
 = 
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
();

135 
	`BOOST_CHECK_EQUAL
(
ÃwCoÜdš©es
.
	`di¡ªû
(), 
DISTANCE
);

136 
	`BOOST_CHECK_CLOSE
(
ÃwCoÜdš©es
.
	`h—dšg
(), -
NINETY_DEGREES
, 
RADIAN_ERROR
);

138 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

139 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

140 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

142 
ÃwCoÜdš©es
 = 
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
();

143 
	`BOOST_CHECK_CLOSE
(
ÃwCoÜdš©es
.
	`h—dšg
(), 0, 
RADIAN_ERROR
);

144 
	}
}

147 
	$BOOST_AUTO_TEST_CASE
(
‹¡_odom‘ry_tuº_right
)

149 
RobÙInfo
 
visu®RobÙ
;

150 
DISTANCE
 = 
	`CMs
(3);

151 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
DISTANCE
, 0);

153 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

155 
Odom‘ry
 
odom‘ry
;

157 
odom‘ry
.
fÜw¬d
 = 0;

158 
odom‘ry
.
Ëá
 = 0;

159 
odom‘ry
.
tuº
 = -
NINETY_DEGREES
;

161 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

163 
RRCoÜd
 
ÃwCoÜdš©es
 = 
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
();

164 
	`BOOST_CHECK_EQUAL
(
ÃwCoÜdš©es
.
	`di¡ªû
(), 
DISTANCE
);

165 
	`BOOST_CHECK_CLOSE
(
ÃwCoÜdš©es
.
	`h—dšg
(), 
NINETY_DEGREES
, 
RADIAN_ERROR
);

167 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

168 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

169 
ob£rv©iÚ
.
	`tick
(
odom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

171 
ÃwCoÜdš©es
 = 
ob£rv©iÚ
.
	`g‘RRCoÜdš©es
();

172 
	`BOOST_CHECK_CLOSE
(
ÃwCoÜdš©es
.
	`h—dšg
(), 0, 
RADIAN_ERROR
);

173 
	}
}

176 
	$BOOST_AUTO_TEST_CASE
(
‹¡_Úsü“n_¡®e
)

178 
RobÙInfo
 
visu®RobÙ
;

179 
DISTANCE
 = 
	`CMs
(3);

180 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
DISTANCE
, 0);

182 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

184 
Odom‘ry
 
em±yOdom‘ry
;

186 
i
 = 0; i < 
RobÙOb£rv©iÚ
::
	`numb”OnSü“nF¿mesToBeSË
(); ++i) {

187 
	`BOOST_CHECK
(!
ob£rv©iÚ
.
	`isSË
());

188 
ob£rv©iÚ
.
	`tick
(
em±yOdom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

190 
	`BOOST_CHECK
(
ob£rv©iÚ
.
	`isSË
());

191 
	}
}

193 
	$BOOST_AUTO_TEST_CASE
(
‹¡_šV›w
)

196 
RobÙInfo
 
visu®RobÙ
;

197 
DISTANCE
 = 
	`CMs
(100);

198 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
DISTANCE
, 0);

200 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

202 
Odom‘ry
 
em±yOdom‘ry
;

204 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
DEFAULT_HEAD_YAW
), 
Œue
);

205 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
MIN_VISION_HEADING
), 
Œue
);

206 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
MAX_VISION_HEADING
), 
Œue
);

207 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
MIN_VISION_HEADING
 - 
	`DEG2RAD
(10)), 
çl£
);

208 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
MAX_VISION_HEADING
 + 
	`DEG2RAD
(10)), 
çl£
);

209 
	}
}

211 
	$BOOST_AUTO_TEST_CASE
(
‹¡_offsü“n_¡®e
)

213 
RobÙInfo
 
visu®RobÙ
;

214 
DISTANCE
 = 
	`CMs
(3);

215 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
DISTANCE
, 0);

217 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

218 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚTwo
(
visu®RobÙ
);

220 
Odom‘ry
 
ËáOdom‘ry
, 
rightOdom‘ry
, 
em±yOdom‘ry
;

221 
ËáOdom‘ry
.
tuº
 = 
MIN_VISION_HEADING
 - 
	`DEG2RAD
(10);

222 
rightOdom‘ry
.
tuº
 = 
MAX_VISION_HEADING
 + 
	`DEG2RAD
(10);

224 
ob£rv©iÚ
.
	`tick
(
ËáOdom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

225 
ob£rv©iÚTwo
.
	`tick
(
rightOdom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

227 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
DEFAULT_HEAD_YAW
), 
çl£
);

228 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚTwo
.
	`šV›w
(
DEFAULT_HEAD_YAW
), 
çl£
);

230 
i
 = 0; i < 
RobÙOb£rv©iÚ
::
	`numb”OffSü“nF¿mesToBeSË
() - 1; ++i) {

231 
	`BOOST_CHECK
(!
ob£rv©iÚ
.
	`isSË
());

232 
ob£rv©iÚ
.
	`tick
(
em±yOdom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

234 
	`BOOST_CHECK
(
ob£rv©iÚ
.
	`isSË
());

235 
	}
}

237 
	$BOOST_AUTO_TEST_CASE
(
‹¡_h—d_yaw_bršgs_što_v›w
)

239 
RobÙInfo
 
visu®RobÙ
;

240 
DISTANCE
 = 
	`CMs
(100);

241 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
DISTANCE
, 0);

242 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

244 
Odom‘ry
 
ËáOdom‘ry
, 
em±yOdom‘ry
;

245 
ËáOdom‘ry
.
tuº
 = 
MIN_VISION_HEADING
 - 
	`DEG2RAD
(10);

246 
ob£rv©iÚ
.
	`tick
(
ËáOdom‘ry
, 
DEFAULT_HEAD_YAW
, 
DEFAULT_DISTANCE_TO_GROUP
);

249 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
DEFAULT_HEAD_YAW
), 
çl£
);

251 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
	`DEG2RAD
(9)), 
çl£
);

253 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`šV›w
(
	`DEG2RAD
(10)), 
Œue
);

254 
	}
}

256 
	$BOOST_AUTO_TEST_CASE
(
‹¡_Ú_sü“n_çr_äom_group
)

258 
RobÙInfo
 
visu®RobÙ
;

259 
DISTANCE
 = 
	`CMs
(100);

260 
visu®RobÙ
.
¼
 = 
	`RRCoÜd
(
DISTANCE
, 0);

261 
RobÙOb£rv©iÚ
 
	`ob£rv©iÚ
(
visu®RobÙ
);

263 
FRAMES_FOR_FAR_AWAY
 = 
	`û
(()
RobÙOb£rv©iÚ
::
MAX_LIFE_SCORE
 /

264 ()(
RobÙOb£rv©iÚ
::
ON_SCREEN_SCORE_REDUCER
 + RobÙOb£rv©iÚ::
DISTANCE_SCORE_REDUCER
));

266 
i
 = 0; i < 
FRAMES_FOR_FAR_AWAY
; ++i) {

267 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`isSË
(), 
çl£
);

268 
ob£rv©iÚ
.
	`tick
(
EMPTY_ODOMETRY
, 
DEFAULT_HEAD_YAW
, 1);

270 
	`BOOST_CHECK_EQUAL
(
ob£rv©iÚ
.
	`isSË
(), 
Œue
);

271 
	}
}

274 
BOOST_AUTO_TEST_SUITE_END
()

	@robot/thread/Thread.cpp

1 
	~"th»ad/Th»ad.hµ
"

2 
	~<c¡dlib
>

3 cÚ¡ 
__th»ad
 * 
	gTh»ad
::
Çme
 = 
NULL
;

	@robot/thread/Thread.hpp

1 #´agm¨
Úû


3 şas 
	cTh»ad
 {

4 
	mpublic
:

5 cÚ¡ 
__th»ad
 * 
Çme
;

	@robot/thread/ThreadManager.cpp

1 
	~"Th»adMªag”.hµ
"

3 
şass
 
	gBÏckbßrd
;

4 
şass
 
	gTh»adMªag”
;

6 
	gCÚcu¼’tM­
<
	g±h»ad_t
, 
	gjmp_buf
*> 
	gjumpPošts
;

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	gTh»adMªag”
::
	$Th»adMªag”
(
¡d
::
¡ršg
 
Çme
, 
cyşeTime
) {

11 
this
->
Çme
 =‚ame;

12 
this
->
cyşeTime
 = cycleTime;

13 
ruÂšg
 = 
çl£
;

16 
	}
}

18 
	gTh»adMªag”
::
	$još
() {

19 ià(
ruÂšg
) {

20 
	`±h»ad_još
(
±h»ad
, 
NULL
);

22 
ruÂšg
 = 
çl£
;

23 
	}
}

25 
	gTh»adMªag”
::~
	$Th»adMªag”
() {

26 
	`još
();

27 
	}
}

30 
	$ov”timeAË¹
() {

31 
	`SAY
(
¡d
::
	`¡ršg
(
Th»ad
::
Çme
) + "hread has frozen");

32 
	`sigÇl
(
SIGALRM
, 
ov”timeAË¹
);

33 
™im”v®
 
™v®5
;

34 
™v®5
.
™_v®ue
.
tv_£c
 = 5;

35 
™v®5
.
™_v®ue
.
tv_u£c
 = 0;

36 
™v®5
.
™_š‹rv®
.
tv_£c
 = 0;

37 
™v®5
.
™_š‹rv®
.
tv_u£c
 = 0;

38 
	`£t™im”
(
ITIMER_REAL
, &
™v®5
, 
NULL
);

39 
	}
}

48 
	$hªdËSigÇls
(
sigNumb”
, 
sigšfo_t
* 
šfo
, *) {

50 ià(
sigNumb”
 =ğ
SIGINT
) {

51 
û¼
 << 
’dl
;

52 
û¼
 << "###########################" << 
’dl
;

53 
û¼
 << "## SIGINT RECEIVED ##" << 
’dl
;

54 
û¼
 << "## ATTEMPTING SHUTDOWN ##" << 
’dl
;

55 
û¼
 << "###########################" << 
’dl
;

56 
©‹m±šgShutdown
 = 
Œue
;

57 } ià(
sigNumb”
 =ğ
SIGTERM
) {

58 
û¼
 << 
’dl
;

59 
û¼
 << "###########################" << 
’dl
;

60 
û¼
 << "## SIGTERM RECEIVED ##" << 
’dl
;

61 
û¼
 << "## ATTEMPTING SHUTDOWN ##" << 
’dl
;

62 
û¼
 << "###########################" << 
’dl
;

63 
©‹m±šgShutdown
 = 
Œue
;

66 
	`SAY
("crash detected");

67 
	`»gi¡”SigÇlHªdËrs
(
sigNumb”
);

68 
±h»ad_t
 
th»ad
 = 
	`±h»ad_£lf
();

70 
û¼
 << 
	`¡ršg
(
Th»ad
::
Çme
è<< " w™h id " << 
th»ad
 <<

71 "„eûived sigÇÈ" << 
sigNumb”
 << "‡nd i »¡¬tšg" << 
’dl
;

72 
	`Îog
(
ERROR
è<< 
	`¡ršg
(
Th»ad
::
Çme
) << " with id "

73 << 
th»ad
 << "„eceived signal "

74 << 
sigNumb”
 << "‡nd i »¡¬tšg" << 
’dl
;

76 
	`lÚgjmp
(*
jumpPošts
[
th»ad
], 1);

79 
	}
}

85 
	$»gi¡”SigÇlHªdËrs
(
sigÇl
) {

87 
sigaùiÚ
 
aù
;

88 
aù
.
§_sigaùiÚ
 = 
hªdËSigÇls
;

89 
	`sigem±y£t
(&
aù
.
§_mask
);

90 
aù
.
§_æags
 = 
SA_SIGINFO
 | 
SA_RESETHAND
;

93 ià(
sigÇl
 =ğ
SIGINT
 || sigÇÈ=ğ
ALL_SIGNALS
)

94 
	`sigaùiÚ
(
SIGINT
, &
aù
, 
NULL
);

95 ià(
sigÇl
 =ğ
SIGTERM
 || sigÇÈ=ğ
ALL_SIGNALS
)

96 
	`sigaùiÚ
(
SIGTERM
, &
aù
, 
NULL
);

97 ià(
sigÇl
 =ğ
SIGSEGV
 || sigÇÈ=ğ
ALL_SIGNALS
)

98 
	`sigaùiÚ
(
SIGSEGV
, &
aù
, 
NULL
);

99 ià(
sigÇl
 =ğ
SIGFPE
 || sigÇÈ=ğ
ALL_SIGNALS
)

100 
	`sigaùiÚ
(
SIGFPE
, &
aù
, 
NULL
);

101 ià(
sigÇl
 =ğ
SIGSTKFLT
 || sigÇÈ=ğ
ALL_SIGNALS
)

102 
	`sigaùiÚ
(
SIGSTKFLT
, &
aù
, 
NULL
);

103 ià(
sigÇl
 =ğ
SIGHUP
 || sigÇÈ=ğ
ALL_SIGNALS
)

104 
	`sigaùiÚ
(
SIGHUP
, &
aù
, 
NULL
);

105 
	}
}

	@robot/thread/ThreadManager.hpp

1 #´agm¨
Úû


3 
	~<±h»ad.h
>

4 
	~<sigÇl.h
>

5 
	~<£tjmp.h
>

6 
	~<sys/time.h
>

7 
	~<¡ršg
>

8 
	~<th»ad/Th»ad.hµ
>

9 
	~<uts/¥“ch.hµ
>

10 
	~<uts/CÚcu¼’tM­.hµ
>

11 
	~<uts/Tim”.hµ
>

12 
	~<bÏckbßrd/BÏckbßrd.hµ
>

14 
	#ALL_SIGNALS
 -1

16 

	)

18 
şass
 
	gTh»adMªag”
;

20 
boŞ
 
©‹m±šgShutdown
;

21 
CÚcu¼’tM­
<
±h»ad_t
, 
jmp_buf
*> 
jumpPošts
;

23 
	sSaãlyRunArgs
 {

24 
Th»adMªag”
 *
	mth»adMªag”
;

25 
BÏckbßrd
 *
	mbÏckbßrd
;

28 
	g‹m¶©e
<
şass
 
	gT
, (
T
::*
mem_â
è(
BÏckbßrd
 *)> * 
	`thunk
(* 
¬gs
);

30 
	`ov”timeAË¹
();

31 
	`hªdËSigÇls
(
sigNumb”
, 
sigšfo_t
* 
šfo
, *);

32 
	`»gi¡”SigÇlHªdËrs
(
sigÇl
 = 
ALL_SIGNALS
);

34 şas 
	cTh»adMªag”
 {

35 
public
:

36 
¡d
::
¡ršg
 
Çme
;

37 
cyşeTime
;

38 
±h»ad_t
 
±h»ad
;

39 
boŞ
 
ruÂšg
;

41 
	`Th»adMªag”
(
¡d
::
¡ršg
 
Çme
, 
cyşeTime
);

43 
‹m¶©e
 <
şass
 
T
> 
	`run
(
BÏckbßrd
 *
bb
);

45 
	`još
();

47 ~
	`Th»adMªag”
();

49 
´iv©e
:

51 
‹m¶©e
 <
şass
 
T
>

52 
	`§ãlyRun
(
BÏckbßrd
 *
bb
);

53 
SaãlyRunArgs
 
¬gs
;

56 
	~"Th»adMªag”.tcc
"

	@robot/thread/ThreadManager.tcc

1 
	g‹m¶©e
<
şass
 
	gT
, (
T
::*
mem_â
è(
BÏckbßrd
 *)> * 
	$thunk
(* 
¬gs
) {

2 *
p
 = ((
SaãlyRunArgs
*)
¬gs
)->
th»adMªag”
;

3 
BÏckbßrd
 *
b
 = ((
SaãlyRunArgs
*)
¬gs
)->
bÏckbßrd
;

4 (
¡©ic_ÿ¡
<
T
*>(
p
)->*
mem_â
)(
b
);

6 
	}
}

8 
	g‹m¶©e
 <
şass
 
	gT
> 
	gTh»adMªag”
::
	$run
(
BÏckbßrd
 *
bb
) {

10 
bb
->
th»ad
.
cÚfigC®lbacks
[
Çme
];

11 
¬gs
.
bÏckbßrd
 = 
bb
;

12 
¬gs
.
th»adMªag”
 = 
this
;

13 
	`Îog
(
INFO
è<< "RuÂšg Th»adMªag” fÜ " << 
Çme
 << 
¡d
::
’dl
;

14 ià(
Çme
 == "Motion") {

16 
sched_·¿m
 
·¿m
;

17 
pŞicy
;

18 
±h»ad_©Œ_t
 
©Œ
;

19 
	`±h»ad_©Œ_š™
(&
©Œ
);

20 
	`±h»ad_©Œ_£tšh”™sched
(&
©Œ
, 
PTHREAD_EXPLICIT_SCHED
);

21 
	`±h»ad_©Œ_£tschedpŞicy
(&
©Œ
, 
SCHED_FIFO
);

22 
·¿m
.
sched_´iÜ™y
 = 65;

23 
	`±h»ad_©Œ_£tsched·¿m
(&
©Œ
, &
·¿m
);

24 
	`±h»ad_ü—‹
(&
±h»ad
, &
©Œ
, &
thunk
<
Th»adMªag”
, &Th»adMªag”::
§ãlyRun
<
T
> >, &
¬gs
);

25 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

26 
	`±h»ad_g‘sched·¿m
(
±h»ad
, &
pŞicy
, &
·¿m
);

27 
	`Îog
(
INFO
è<< "MÙiÚ g¿Áed…riÜ™y: " << 
·¿m
.
sched_´iÜ™y
 << 
¡d
::
’dl
;

29 
	`±h»ad_ü—‹
(&
±h»ad
, 
NULL
, &
thunk
<
Th»adMªag”
, &Th»adMªag”::
§ãlyRun
<
T
> >, &
¬gs
);

31 
ruÂšg
 = 
Œue
;

33 
	}
}

35 
	g‹m¶©e
 <
şass
 
	gT
>

36 
	gTh»adMªag”
::
	$§ãlyRun
(
BÏckbßrd
 *
bb
) {

37 
Th»ad
::
Çme
 =‚ame.
	`c_¡r
();

38 
±h»ad_t
 
th»adID
 = 
	`±h»ad_£lf
();

39 
	`Îog
(
INFO
è<< "Regi¡”šgh»ad‚am'" << 
Çme


40 << "' w™h ID " << 
th»adID
 << 
¡d
::
’dl
;

42 ià(
Çme
 == "Perception") {

43 
	`sigÇl
(
SIGALRM
, 
ov”timeAË¹
);

45 !
©‹m±šgShutdown
) {

46 
Œy
 {

49 
jumpPošts
[
th»adID
] =

50 
»š‹½»t_ÿ¡
<
jmp_buf
*>(
	`m®loc
((jmp_buf)));

51 ià(!
jumpPošts
[
th»adID
])

52 
	`Îog
(
FATAL
è<< "m®loøçed fÜ" << 
Çme
 << "\n";

54 
	`Îog
(
INFO
è<< "Th»ad '" << 
Çme
 << "' started\n";

57 ià(!
	`£tjmp
(*
jumpPošts
[
th»adID
])) {

58 
T
 
	`t
(
bb
);

59 
Tim”
 
tim”
;

60 
št32_t
 
–­£d
 = 0.0;

61 !
©‹m±šgShutdown
) {

62 
tim”
.
	`»¡¬t
();

64 ià(
cyşeTime
 != -1) {

66 ià(
Çme
 == "Perception") {

67 
™im”v®
 
™v®5
;

68 
™v®5
.
™_v®ue
.
tv_£c
 = 5;

69 
™v®5
.
™_v®ue
.
tv_u£c
 = 0;

70 
™v®5
.
™_š‹rv®
.
tv_£c
 = 0;

71 
™v®5
.
™_š‹rv®
.
tv_u£c
 = 0;

72 
	`£t™im”
(
ITIMER_REAL
, &
™v®5
, 
NULL
);

76 
t
.
	`tick
();

79 ià(
Çme
 == "Perception") {

80 
™im”v®
 
™v®0
;

81 
™v®0
.
™_v®ue
.
tv_£c
 = 0;

82 
™v®0
.
™_v®ue
.
tv_u£c
 = 0;

83 
™v®0
.
™_š‹rv®
.
tv_£c
 = 0;

84 
™v®0
.
™_š‹rv®
.
tv_u£c
 = 0;

85 
	`£t™im”
(
ITIMER_REAL
, &
™v®0
, 
NULL
);

88 
–­£d
 = 
tim”
.
	`–­£d_us
();

89 
	`Îog
(
INFO
è<< "Th»ad '" << 
Çme
 << "'ook "

90 << 
–­£d
 << " us." << 
¡d
::
’dl
;

91 ià(
–­£d
 < 
cyşeTime
) {

92 
	`u¦“p
(
cyşeTime
 - 
–­£d
);

93 } ià(((
Çme
 !ğ"MÙiÚ"è&& (Çm!ğ"P”û±iÚ")è|| (Òam=ğ"P”û±iÚ"è&& (
–­£d
 >= 50000))){

94 
	`Îog
(
ERROR
è<< "WARNING: Th»ad " + 
Çme
 +

95 "„ª ov”time" << ": " << 
–­£d
 / 1000 << "ms!" <<

96 
¡d
::
’dl
;

97 ià(
–­£d
 >ğ1000000 && 
Çme
 == "perception")

98 
	`SAY
("perception overtime");

101 
	`¦“p
(10);

105 
	`Îog
(
INFO
è<< "Th»ad '" << 
Çme


106 << "' di§bËd." << 
¡d
::
’dl
;

107 } 
	`ÿtch
(cÚ¡ 
¡d
::
exû±iÚ
 & 
e
) {

109 
	`SAY
("exception caught");

110 
	`ä“
(
jumpPošts
[
th»adID
]);

111 
	`u¦“p
(500000);

112 
	`Îog
(
ERROR
) << "exception derivative was caught withƒrror msg: "

113 << 
e
.
	`wh©
(è<< 
¡d
::
’dl
;

114 
	`Îog
(
ERROR
è<< "š " << 
Çme


115 << " w™h id " << 
th»adID
 << 
¡d
::
’dl
;

116 } 
	`ÿtch
(...) {

117 
	`SAY
("exception caught");

118 
	`ä“
(
jumpPošts
[
th»adID
]);

119 
	`u¦“p
(500000);

120 
	`Îog
(
ERROR
) << "Something washrown from "

121 << 
Çme


122 << " w™h id " << 
th»adID
 << 
¡d
::
’dl
;

125 
	}
}

	@robot/transmitter/Nao.cpp

32 
	~"Nao.hµ
"

33 
	~"bÏckbßrd/BÏckbßrd.hµ
"

34 
	~"uts/Logg”.hµ
"

35 
	~"uts/¥“ch.hµ
"

37 
usšg
 
Çme¥aû
 
	gboo¡
::
asio
;

38 
usšg
 
Çme¥aû
 
	g¡d
;

40 
	gNaoT¿nsm™‹r
::
	$NaoT¿nsm™‹r
(
pÜt
, 
¡ršg
 
add»ss
)

41 : 
	`£rviû
(),

42 
	`sock‘
(
£rviû
, 

::
udp
::
	`v4
()),

43 
	`brßdÿ¡_’dpošt
(

::
add»ss
::
	`äom_¡ršg
×dd»ss), 
pÜt
) {

44 
sock‘_ba£
::
brßdÿ¡
 
	`İtiÚ
(
Œue
);

45 
sock‘
.
	`£t_İtiÚ
(
İtiÚ
);

46 
boo¡
::
sy¡em
::
”rÜ_code
 
ec
;

47 
sock‘
.
	`cÚÃù
(
brßdÿ¡_’dpošt
, 
ec
);

48 ià(
ec
) {

49 
	`Îog
(
ERROR
è<< "could‚Ù cÚÃù: " << 
ec
.
	`mes§ge
();

50 
	`¦“p
(5);

51 
	`SAY
("nÙ oÀthÃtwÜk", 
Œue
);

52 
throw
 
ec
;

54 
	`Îog
(
INFO
è<< "NaØT¿nsm™‹¸cÚ¡ruùed" << 
’dl
;

55 
	}
}

57 
	gNaoT¿nsm™‹r
::~
	$NaoT¿nsm™‹r
() {

58 
sock‘
.
	`şo£
();

59 
	}
}

61 
	gNaoT¿nsm™‹r
::
	$tick
(cÚ¡ 
boo¡
::
asio
::
mubË_bufãrs_1
 &
b
) {

62 
boo¡
::
sy¡em
::
”rÜ_code
 
ec
 = boo¡::sy¡em::
	`”rÜ_code
();

63 
sock‘
.
	`£nd
(
b
, 0, 
ec
);

65 ià(
ec
) {

66 
	`Îog
(
ERROR
è<< "could‚Ù s’d: " << 
ec
.
	`mes§ge
();

67 
time_t
 
Ï¡§id
 = 0;

68 
time_t
 
now
 = 
	`time
(
NULL
);

69 ià(
now
 >ğ
Ï¡§id
 + 5) {

70 
	`SAY
("ÇØŒªsm™‹¸" + 
ec
.
	`mes§ge
());

71 
Ï¡§id
 = 
now
;

74 
	}
}

	@robot/transmitter/Nao.hpp

32 #´agm¨
Úû


34 
	~<boo¡/asio/bufãr.hµ
>

35 
	~<boo¡/asio/io_£rviû.hµ
>

36 
	~<boo¡/asio//udp.hµ
>

37 
	~<¡ršg
>

39 şas 
	cNaoT¿nsm™‹r
 {

40 
	m´Ùeùed
:

47 
NaoT¿nsm™‹r
(
pÜt
, 
¡d
::
¡ršg
 
add»ss
);

52 
	mvœtu®
 ~
NaoT¿nsm™‹r
();

59 
tick
(cÚ¡ 
boo¡
::
asio
::
mubË_bufãrs_1
 &
b
);

61 
	m´iv©e
:

62 
boo¡
::
asio
::
io_£rviû
 
£rviû
;

63 
	mboo¡
::
asio
::

::
udp
::
sock‘
 socket;

64 
	mboo¡
::
asio
::

::
udp
::
’dpošt
 
brßdÿ¡_’dpošt
;

	@robot/transmitter/NaturalLandmarks.cpp

32 
	~"N©u¿lLªdm¬ks.hµ
"

33 
	~"bÏckbßrd/BÏckbßrd.hµ
"

35 
usšg
 
Çme¥aû
 
	gboo¡
::
asio
;

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
	gN©u¿lLªdm¬ksT¿nsm™‹r
::
	$N©u¿lLªdm¬ksT¿nsm™‹r
(
BÏckbßrd
 *
bb
) :

39 
	`Ad­‹r
(
bb
),

43 
	`NaoT¿nsm™‹r
((
bb
->
cÚfig
)["Œªsm™‹r.ÆpÜt"].
as
<>(), (bb->cÚfig)["Œªsm™‹r.add»ss"].as<
¡ršg
>()è{
	}
}

45 
	gN©u¿lLªdm¬ksT¿nsm™‹r
::
	$tick
(è{
	}
}

	@robot/transmitter/NaturalLandmarks.hpp

32 #´agm¨
Úû


34 
	~"Nao.hµ
"

35 
	~<¡ršg
>

36 
	~"bÏckbßrd/Ad­‹r.hµ
"

38 
şass
 
	gN©u¿lLªdm¬ksT¿nsm™‹r
 : 
Ad­‹r
, 
	gNaoT¿nsm™‹r
 {

39 
	gpublic
:

43 
N©u¿lLªdm¬ksT¿nsm™‹r
(
BÏckbßrd
 *
bÏckbßrd
);

48 
tick
();

	@robot/transmitter/OffNao.cpp

32 
	~"OffNao.hµ
"

33 
	~<zlib.h
>

34 
	~<boo¡/®gÜ™hm/¡ršg/şassifiÿtiÚ.hµ
>

35 
	~<boo¡/®gÜ™hm/¡ršg/¥l™.hµ
>

36 
	~<boo¡/sh¬ed_±r.hµ
>

37 
	~<boo¡/tok’iz”.hµ
>

38 
	~<m­
>

39 
	~<veùÜ
>

41 
	~"uts/Logg”.hµ
"

42 
	~"uts/İtiÚs.hµ
"

43 
	~"ty³s/AbsCoÜd.hµ
"

44 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

45 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aDefš™iÚs.hµ
"

46 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”a.hµ
"

47 
	~"³rû±iÚ/visiÚ/ÿm”a/CombšedCam”a.hµ
"

49 
usšg
 
Çme¥aû
 
	g¡d
;

50 
usšg
 
	gboo¡
::
asio
::

::
tı
;

51 
usšg
 
Çme¥aû
 
	gboo¡
;

52 
usšg
 
Çme¥aû
 
	gboo¡
::
®gÜ™hm
;

53 
Çme¥aû
 
	gpo
 = 
boo¡
::
´og¿m_İtiÚs
;

55 
	gOffNaoT¿nsm™‹r
::
	$OffNaoT¿nsm™‹r
(
BÏckbßrd
 *
bb
è: 
	$Ad­‹r
(
bb
) {

56 
	`¡¬t_acû±
();

57 
	}
}

58 
__u32
 
cÚŒŞIds
[
NUM_CONTROLS
];

59 cÚ¡ * 
	gCÚŒŞNames
[
NUM_CONTROLS
] = {

75 cÚ¡ 
	gcNUM_CAM_CONTROLS
 = (
CÚŒŞNames
)/(*);

77 
	gOffNaoT¿nsm™‹r
::
	$¡¬t_acû±
(){

78 
Œy
 {

79 
tı
::
’dpošt
 
	`’dpošt
Ñı::
	`v4
(), 10125);

80 
acû±Ü_
 = 
Ãw
 
tı
::
	`acû±Ü
(
io_£rviû_
, 
’dpošt
);

81 
ofâao_£ssiÚ_±r
 
	`Ãw_£ssiÚ
(
Ãw
 
	`ofâao_£ssiÚ
(&
io_£rviû_
, &
room_
));

83 
acû±Ü_
->
	`async_acû±
(
Ãw_£ssiÚ
->
	`sock‘
(),

84 
boo¡
::
	`bšd
(&
OffNaoT¿nsm™‹r
::
hªdË_acû±
,

85 
this
, 
Ãw_£ssiÚ
,

86 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
));

87 } 
	`ÿtch
 (cÚ¡ 
¡d
::
exû±iÚ
& 
e
) {

88 
û¼
 << "Exû±iÚ: " << 
e
.
	`wh©
() << "\n";

91 
	}
}

93 
	gOffNaoT¿nsm™‹r
::
	$tick
() {

94 
	`Îog
(
VERBOSE
è<< "tickšg‡way" << 
’dl
;

95 
io_£rviû_
.
	`pŞl
();

96 
room_
.
	`d–iv”
(
bÏckbßrd
);

97 
io_£rviû_
.
	`pŞl
();

98 
	}
}

100 
	gOffNaoT¿nsm™‹r
::~
	$OffNaoT¿nsm™‹r
() {

101 
d–‘e
 
acû±Ü_
;

102 
	}
}

104 
	gOffNaoT¿nsm™‹r
::
	$hªdË_acû±
(
ofâao_£ssiÚ_±r
 
£ssiÚ
,

105 cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
”rÜ
) {

106 ià(!
”rÜ
) {

107 
ofâao_£ssiÚ_±r
 
	`Ãw_£ssiÚ
(
Ãw
 
	`ofâao_£ssiÚ
(&
io_£rviû_
, &
room_
));

108 
acû±Ü_
->
	`async_acû±
(
Ãw_£ssiÚ
->
	`sock‘
(),

109 
boo¡
::
	`bšd
(&
OffNaoT¿nsm™‹r
::
hªdË_acû±
,

110 
this
, 
Ãw_£ssiÚ
,

111 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
));

112 
£ssiÚ
->
	`¡¬t
(
bÏckbßrd
);

113 
boo¡
::
asio
::
sock‘_ba£
::
£nd_bufãr_size
 
	`İtiÚ
(2048);

114 
£ssiÚ
->
	`sock‘
().
	`£t_İtiÚ
(
İtiÚ
);

115 
boo¡
::
asio
::
sock‘_ba£
::
nÚ_blockšg_io
 
	`commªd
(
çl£
);

116 
£ssiÚ
->
	`sock‘
().
	`io_cÚŒŞ
(
commªd
);

117 
	`Îog
(
DEBUG1
è<< "C»©ed wœ–es lšk." << 
’dl
;

119 
	`Îog
(
ERROR
è<< 
”rÜ
.
	`mes§ge
(è<< 
’dl
;

120 
	`¡¬t_acû±
();

122 
	}
}

124 
	gOffNaoT¿nsm™‹r
::
ofâao_£ssiÚ
::

125 
	$ofâao_£ssiÚ
(
boo¡
::
asio
::
io_£rviû
* io_£rviû, 
ofâao_room
 *
room
)

126 : 
	`cÚÃùiÚ_
(
io_£rviû
), 
	`room_
(*
room
), 
	$£ndšgMask
(
INITIAL_MASK
è{
	}
}

128 
	gtı
::
sock‘
& 
OffNaoT¿nsm™‹r
::
ofâao_£ssiÚ
::
	$sock‘
() {

129  
cÚÃùiÚ_
.
	`sock‘
();

130 
	}
}

132 
	gOffNaoT¿nsm™‹r
::
ofâao_£ssiÚ
::
	$¡¬t
(
BÏckbßrd
 *
bÏckbßrd
) {

133 
room_
.
	`još
(
	`sh¬ed_äom_this
());

134 
boo¡
::
asio
::
	`async_»ad
(
cÚÃùiÚ_
.
	`sock‘
(),

137 
boo¡
::
asio
::
	`bufãr
(&
»ûivedMask
, (receivedMask)),

138 
boo¡
::
	`bšd
(&
ofâao_£ssiÚ
::
hªdË_»ad
,

139 
	`sh¬ed_äom_this
(),

140 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
, 
bÏckbßrd
));

141 
	}
}

143 
	gOffNaoT¿nsm™‹r
::
ofâao_£ssiÚ
::
	$d–iv”
(
BÏckbßrd
 *
bÏckbßrd
) {

146 
bÏckbßrd
->
	`wr™e
(&(bÏckbßrd->
mask
), 
£ndšgMask
);

153 
boo¡
::
sy¡em
::
”rÜ_code
 
e
 = 
cÚÃùiÚ_
.
	`sync_wr™e
(*
bÏckbßrd
);

154 ià(
e
)

155 
	`Îog
(
ERROR
è<< "FaedØwr™e: " << 
e
 << 
’dl
;

156 
	}
}

158 
	gOffNaoT¿nsm™‹r
::
ofâao_room
::
	$još
(
ofâao_·¹icªt_±r
 
·¹icªt
) {

159 
·¹icªts_
.
	`š£¹
(
·¹icªt
);

160 
	}
}

162 
	gOffNaoT¿nsm™‹r
::
ofâao_room
::

163 
	$Ëave
(
ofâao_·¹icªt_±r
 
·¹icªt
) {

164 
·¹icªts_
.
	`”a£
(
·¹icªt
);

165 
	}
}

167 
	gOffNaoT¿nsm™‹r
::
ofâao_room
::
	$d–iv”
(
BÏckbßrd
 *
bÏckbßrd
) {

168 
	`fÜ_—ch
(
·¹icªts_
.
	`begš
(),…¬ticªts_.
	`’d
(),

169 
boo¡
::
	`bšd
(&
ofâao_·¹icªt
::
d–iv”
, 
_1
, boo¡::
	`»f
(
bÏckbßrd
)));

170 
	}
}

172 
	gOffNaoT¿nsm™‹r
::
ofâao_£ssiÚ
::

173 
	$hªdË_wr™e
(
boo¡
::
sy¡em
::
”rÜ_code
 cÚ¡& 
”rÜ
) {

174 ià(
”rÜ
)

175 
room_
.
	`Ëave
(
	`sh¬ed_äom_this
());

176 
	}
}

178 
	gOffNaoT¿nsm™‹r
::
ofâao_£ssiÚ
::

179 
	$hªdË_»ad
(
boo¡
::
sy¡em
::
”rÜ_code
 cÚ¡& 
”rÜ
, 
BÏckbßrd
 *
bÏckbßrd
) {

180 ià(!
”rÜ
) {

181 
	`Îog
(
DEBUG1
è<< "Reûived Mask = " << 
»ûivedMask
 << 
’dl
;

182 ià(
»ûivedMask
 & 
TO_NAO_MASKS
) {

183 ià(
»ûivedMask
 & 
COMMAND_MASK
) {

184 
¡ršg
 
commªd
;

185 
cÚÃùiÚ_
.
	`sync_»ad
(
commªd
);

186 
	`Îog
(
INFO
è<< "Reûived commªd " << 
commªd
 << 
’dl
;

188 
veùÜ
<
¡ršg
> 
commªd_¬gv
;

189 
	`¥l™
(
commªd_¬gv
, 
commªd
, 
	`is_¥aû
());

199 
po
::
v¬ŸbËs_m­
 
vm
;

200 
Œy
 {

206 
NaoCam”a
 *
tİ
 = (NaoCam”a*)(
CombšedCam”a
::
	`g‘Cam”aTİ
());

207 
NaoCam”a
 *
bÙ
 = (NaoCam”a*)(
CombšedCam”a
::
	`g‘Cam”aBÙ
());

208 
veùÜ
<
¡ršg
> 
commªds
;

209 
	`¥l™
(
commªds
,
commªd
,
boo¡
::
	`is_ªy_of
(" .-="),boo¡::
tok’_com´ess_Ú
);

211 
boŞ
 
isTİ
 = !
commªds
[2].
	`com·»
("top");

212 
i
 = 0;˜< 
cNUM_CAM_CONTROLS
; i++) {

213 if(
commªds
[3].
	`com·»
(
CÚŒŞNames
[
i
]) == 0){

214 if(
isTİ
){

215 
tİ
->
	`£tCÚŒŞ
(
cÚŒŞIds
[
i
],
	`©oi
(
commªds
[4].
	`c_¡r
()));

218 
bÙ
->
	`£tCÚŒŞ
(
cÚŒŞIds
[
i
],
	`©oi
(
commªds
[4].
	`c_¡r
()));

225 
po
::
İtiÚs_desütiÚ
 
cmdlše_İtiÚs
 = 
	`¡Üe_ªd_nÙify
(
commªd_¬gv
, 
vm
);

237 
m­
<
¡ršg
, 
funùiÚ
<(cÚ¡ 
po
::
v¬ŸbËs_m­
 &)> >::
cÚ¡_™”©Ü
 
ci
 = 
	`»adFrom
(
th»ad
, 
cÚfigC®lbacks
).
	`begš
();

238 
ci
 !ğ
	`»adFrom
(
th»ad
, 
cÚfigC®lbacks
).
	`’d
(); ++ci)

239 ià(!
ci
->
£cÚd
.
	`em±y
()) {

240 
ci
->
	`£cÚd
(
vm
);

242 } 
	`ÿtch
 (
´og¿m_İtiÚs
::
”rÜ
& 
e
) {

243 
	`Îog
(
WARNING
) << "Error when…arsing command†ine‡rguments: " <<

244 
e
.
	`wh©
(è<< 
’dl
;

248 
£ndšgMask
 = 
»ûivedMask
;

250 
boo¡
::
asio
::
	`async_»ad
(
cÚÃùiÚ_
.
	`sock‘
(),

251 
boo¡
::
asio
::
	`bufãr
(&
»ûivedMask
,

252 (
»ûivedMask
)),

253 
boo¡
::
	`bšd
(&
ofâao_£ssiÚ
::
hªdË_»ad
,

254 
	`sh¬ed_äom_this
(),

255 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
, 
bÏckbßrd
));

257 
	`Îog
(
DEBUG1
è<< "Reûived d©¨w™hƒ¼Ü!!!" << 
¡d
::
’dl
;

258 
room_
.
	`Ëave
(
	`sh¬ed_äom_this
());

260 
	}
}

	@robot/transmitter/OffNao.hpp

32 #´agm¨
Úû


34 
	~<boo¡/asio.hµ
>

35 
	~<boo¡/’abË_sh¬ed_äom_this.hµ
>

36 
	~<boo¡/sh¬ed_±r.hµ
>

37 
	~<£t
>

38 
	~<¡ršg
>

39 
	~"uts/CÚÃùiÚ.hµ
"

40 
	~"bÏckbßrd/BÏckbßrd.hµ
"

41 
	~"bÏckbßrd/Ad­‹r.hµ
"

42 
	~"Œªsm™‹r/T¿nsm™‹rDefs.hµ
"

50 şas 
	cOffNaoT¿nsm™‹r
 : 
Ad­‹r
 {

51 
public
:

55 
OffNaoT¿nsm™‹r
(
BÏckbßrd
 *
bb
);

59 ~
OffNaoT¿nsm™‹r
();

63 
tick
();

65 
	m´iv©e
:

69 
boo¡
::
asio
::
io_£rviû
 
io_£rviû_
;

74 şas 
	cofâao_·¹icªt
 {

75 
	mpublic
:

77 
vœtu®
 ~
ofâao_·¹icªt
() {}

78 
vœtu®
 
d–iv”
(
BÏckbßrd
 *
bÏckbßrd
) = 0;

81 
	gboo¡
::
	tsh¬ed_±r
<
	tofâao_·¹icªt
> 
	tofâao_·¹icªt_±r
;

86 şas 
	cofâao_room
 {

87 
	gpublic
:

93 
još
(
ofâao_·¹icªt_±r
 
·¹icªt
);

100 
Ëave
(
ofâao_·¹icªt_±r
 
·¹icªt
);

107 
d–iv”
(
BÏckbßrd
 *
bÏckbßrd
);

109 
	g´iv©e
:

110 
¡d
::
£t
<
ofâao_·¹icªt_±r
> 
·¹icªts_
;

116 
şass
 
	gofâao_£ssiÚ
 :

117 
public
 
ofâao_·¹icªt
,

118 
public
 
	gboo¡
::
’abË_sh¬ed_äom_this
<
ofâao_£ssiÚ
> {

119 
public
:

126 
ofâao_£ssiÚ
(
boo¡
::
asio
::
io_£rviû
* io_service,

127 
ofâao_room
* 
room
);

132 
	gboo¡
::
asio
::

::
tı
::
sock‘
& socket();

137 
¡¬t
(
BÏckbßrd
 *
bÏckbßrd
);

144 
d–iv”
(
BÏckbßrd
 *
bÏckbßrd
);

152 
hªdË_»ad
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
”rÜ
, 
BÏckbßrd
 *
bÏckbßrd
);

160 
hªdË_wr™e
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
”rÜ
);

162 
	g´iv©e
:

163 
CÚÃùiÚ
 
cÚÃùiÚ_
;

164 
	gofâao_room
& 
	groom_
;

168 
OffNaoMask_t
 
	g»ûivedMask
;

172 
OffNaoMask_t
 
	g£ndšgMask
;

175 
	gboo¡
::
	tsh¬ed_±r
<
	tofâao_£ssiÚ
> 
	tofâao_£ssiÚ_±r
;

180 
hªdË_acû±
(
ofâao_£ssiÚ_±r
 
£ssiÚ
,

181 cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
”rÜ
);

183 
¡¬t_acû±
();

185 
ofâao_room
 
	groom_
;

190 
	gboo¡
::
asio
::

::
tı
::
acû±Ü
* 
acû±Ü_
;

	@robot/transmitter/Team.cpp

32 
	~"T—m.hµ
"

33 
	~"bÏckbßrd/BÏckbßrd.hµ
"

34 
	~"ty³s/SPLSnd¬dMes§ge.hµ
"

35 
	~"uts/šÿ·c™©ed.hµ
"

38 
	~<io¡»am
>

40 
usšg
 
Çme¥aû
 
	gboo¡
::
asio
;

41 
usšg
 
Çme¥aû
 
	g¡d
;

43 
	gT—mT¿nsm™‹r
::
	$T—mT¿nsm™‹r
(
BÏckbßrd
 *
bb
) :

44 
	`Ad­‹r
(
bb
),

45 
	`NaoT¿nsm™‹r
((
bb
->
cÚfig
)["Œªsm™‹r.ba£_pÜt"].
as
<>()

46 + (
bb
->
cÚfig
)["¶ay”.‹am"].
as
<>(),

47 (
bb
->
cÚfig
)["Œªsm™‹r.add»ss"].
as
<
¡ršg
>()),

48 
	`£rviû
(),

49 
	`sock‘
(
£rviû
, 

::
udp
::
	`v4
()),

50 
	$d–ay
(0)

51 {
	}
}

53 
	gT—mT¿nsm™‹r
::
	$tick
() {

54 
Brßdÿ¡D©a
 
	`bd
((
bÏckbßrd
->
cÚfig
)["¶ay”.numb”"].
as
<>(),

55 (
bÏckbßrd
->
cÚfig
)["¶ay”.‹am"].
as
<>(),

56 
	`»adFrom
(
loÿli§tiÚ
, 
robÙPos
),

57 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPos
),

58 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPosRR
),

59 
	`»adFrom
(
loÿli§tiÚ
, 
b®lLo¡CouÁ
),

60 
	`»adFrom
(
loÿli§tiÚ
, 
sh¬edLoÿli§tiÚBundË
),

61 
	`»adFrom
(
behaviour
, 
behaviourSh¬edD©a
),

62 
	`»adFrom
(
mÙiÚ
, 
aùive
).
body
.
aùiÚTy³
,

63 
	`»adFrom
(
mÙiÚ
, 
u±ime
),

64 
	`»adFrom
(
gameCÚŒŞËr
, 
gameS‹
));

68 
¶ay”Num
 = (
bÏckbßrd
->
cÚfig
)["¶ay”.numb”"].
as
<>();

69 
boŞ
 
šÿ·c™©ed
 = 
çl£
;

70 ià(
	`»adFrom
(
gameCÚŒŞËr
, 
our_‹am
).
¶ay”s
[
¶ay”Num
 - 1].
³ÇÉy


71 !ğ
PENALTY_NONE
) {

72 
šÿ·c™©ed
 = 
Œue
;

75 cÚ¡ 
AùiÚCommªd
::
Body
::
AùiÚTy³
 &
acB
 =

76 
	`»adFrom
(
mÙiÚ
, 
aùive
).
body
.
aùiÚTy³
;

77 
šÿ·c™©ed
 |ğ
	`isInÿ·c™©ed
(
acB
);

79 cÚ¡ 
AbsCoÜd
 &
robÙPos
 = 
	`»adFrom
(
loÿli§tiÚ
,„obotPos);

80 cÚ¡ 
AbsCoÜd
 &
w®kšgTo
 = 
	`»adFrom
(
behaviour
, walkingTo);

81 cÚ¡ 
AbsCoÜd
 &
shoÙšgTo
 = 
	`»adFrom
(
behaviour
, shootingTo);

84 
behaviourR—dBuf
 = 
	`»adFrom
(
behaviour
, 
»adBuf
);

85 
rŞe
 = 
	`»adFrom
(
behaviour
, 
»que¡
[
behaviourR—dBuf
]).
cu¼’tRŞe
;

86 
š‹ÁiÚ
 = 0;

87 ià(
rŞe
 =ğ1è
š‹ÁiÚ
 = 1;

88 ià(
rŞe
 =ğ2è
š‹ÁiÚ
 = 3;

89 ià(
rŞe
 =ğ3è
š‹ÁiÚ
 = 2;

92 
SPLSnd¬dMes§ge
 
	`m
 (
¶ay”Num
,

93 
	`»adFrom
(
gameCÚŒŞËr
, 
our_‹am
).
‹amNumb”
,

94 
šÿ·c™©ed
,

95 
robÙPos
,

96 
w®kšgTo
,

97 
shoÙšgTo
,

98 
	`»adFrom
(
loÿli§tiÚ
, 
b®lLo¡CouÁ
),

99 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPos
),

100 
	`»adFrom
(
loÿli§tiÚ
, 
b®lV–RRC
),

101 
š‹ÁiÚ
,

102 
bd
);

106 
	`wr™eTo
(
loÿli§tiÚ
, 
haveP’dšgOutgošgSh¬edBundË
, 
çl£
);

107 
NaoT¿nsm™‹r
::
	`tick
(
boo¡
::
asio
::
	`bufãr
(&
m
, (
SPLSnd¬dMes§ge
)));

110 ++
d–ay
;

111 ià(
d–ay
 > 5) {

112 
	`£ndToGameCÚŒŞËr
();

113 
d–ay
 = 0;

116 
	}
}

118 
	gT—mT¿nsm™‹r
::~
	$T—mT¿nsm™‹r
() {

119 
sock‘
.
	`şo£
();

120 
	}
}

122 
	gT—mT¿nsm™‹r
::
	$£ndToGameCÚŒŞËr
() {

123 * 
£ndToIP
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
Ï¡GameCÚŒŞËrIPAdd»ss
);

124 ià(
£ndToIP
 =ğ
NULL
) {

129 
gameCÚŒŞËrEndpošt
.
	`add»ss
(

::
add»ss
::
	`äom_¡ršg
(
£ndToIP
));

130 
gameCÚŒŞËrEndpošt
.
	`pÜt
(
GAMECONTROLLER_RETURN_PORT
);

131 
boo¡
::
sy¡em
::
”rÜ_code
 
ec
 = boo¡::sy¡em::
	`”rÜ_code
();

132 
sock‘
.
	`cÚÃù
(
gameCÚŒŞËrEndpošt
, 
ec
);

134 
RoboCupGameCÚŒŞR‘uºD©a
 
d
 = 
	`RoboCupGameCÚŒŞR‘uºD©a
();

135 
d
.
‹am
 = (
bÏckbßrd
->
cÚfig
)["¶ay”.‹am"].
as
<>();

136 
d
.
¶ay”
 = (
bÏckbßrd
->
cÚfig
)["¶ay”.numb”"].
as
<>();

137 
d
.
mes§ge
 = 
GAMECONTROLLER_RETURN_MSG_ALIVE
;

142 
sock‘
.
	`£nd
(
boo¡
::
asio
::
	`bufãr
(&
d
, (
RoboCupGameCÚŒŞR‘uºD©a
)), 0, 
ec
);

143 
	}
}

	@robot/transmitter/Team.hpp

32 #´agm¨
Úû


34 
	~"Nao.hµ
"

35 
	~<¡ršg
>

36 
	~"bÏckbßrd/Ad­‹r.hµ
"

38 
şass
 
	gT—mT¿nsm™‹r
 : 
Ad­‹r
, 
	gNaoT¿nsm™‹r
 {

39 
	gpublic
:

43 
T—mT¿nsm™‹r
(
BÏckbßrd
 *
bb
);

44 ~
T—mT¿nsm™‹r
();

49 
tick
();

51 
	g´iv©e
:

52 
£ndToGameCÚŒŞËr
();

54 
	gboo¡
::
asio
::
io_£rviû
 
£rviû
;

55 
	gboo¡
::
asio
::

::
udp
::
sock‘
 socket;

56 
	gboo¡
::
asio
::

::
udp
::
’dpošt
 
gameCÚŒŞËrEndpošt
;

58 
	gd–ay
;

	@robot/transmitter/TransmitterDefs.hpp

32 #´agm¨
Úû


40 
ušt64_t
 
	tOffNaoMask_t
;

43 
	mBLACKBOARD_MASK
 = 0x0000000000000001ull,

44 
	mSALIENCY_MASK
 = 0x0000000000000002ull,

45 
	mRAW_IMAGE_MASK
 = 0x0000000000000004ull,

46 
	mPARTICLE_FILTER_MASK
 = 0x0000000000000008ull,

47 
	mROBOT_FILTER_MASK
 = 0x0000000000000010ull,

48 
	mINITIAL_MASK
 = 0x0000000000000003ull,

49 
	mALL_MASKS
 = 0x000000000000003Full,

50 
	mLANDMARKS_MASK
 = 0x0000000000000020ull,

52 
	mCOMMAND_MASK
 = 0x8000000000000000ull,

53 
	mTO_NAO_MASKS
 = 0x8000000000000000ull

	@robot/types/AbsCoord.hpp

32 #´agm¨
Úû


34 
	~"uts/ªgËs.hµ
"

35 
	~"ty³s/Pošt.hµ
"

36 
	~"ty³s/RRCoÜd.hµ
"

37 
	~"uts/basic_m©hs.hµ
"

38 
	~"uts/SPLDefs.hµ
"

39 
	~"ty³s/boo¡S”Ÿliz©iÚEig’Ty³s.hµ
"

40 
	~<Eig’/Eig’
>

41 
	~<cm©h
>

43 
	sAbsCoÜd
 {

44 
AbsCoÜd
(
x
, 
y
, 
th‘a
è: 
vec
(x, y,heta) {

45 
	mv¬
.
£tZ”o
();

46 
v¬
(0, 0èğ
SQUARE
(
FULL_FIELD_LENGTH
);

47 
v¬
(1, 1èğ
SQUARE
(
FULL_FIELD_WIDTH
);

48 
v¬
(2, 2èğ
SQUARE
(
M_PI
);

49 
	mweight
 = 1.0;

52 
AbsCoÜd
(è: 
vec
(0, 0, 0) {

53 
	mv¬
.
£tZ”o
();

54 
v¬
(0, 0èğ
SQUARE
(
FULL_FIELD_LENGTH
);

55 
v¬
(1, 1èğ
SQUARE
(
FULL_FIELD_WIDTH
);

56 
v¬
(2, 2èğ
SQUARE
(
M_PI
);

57 
	mweight
 = 1.0;

60 
	mEig’
::
VeùÜ3f
 
vec
;

61 
	mEig’
::
M©rix
<, 3, 3> 
	mv¬
;

62 
	mweight
;

64 cÚ¡ 
x
() const {

65  
	mvec
[0];

68 &
x
() {

69  
	mvec
[0];

72 cÚ¡ 
y
() const {

73  
	mvec
[1];

76 &
y
() {

77  
	mvec
[1];

80 cÚ¡ 
th‘a
() const {

81  
	mvec
[2];

84 &
th‘a
() {

85  
	mvec
[2];

88 
g‘V¬
(
m
, 
n
) const {

89  
v¬
(
m
,
n
);

92 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
AbsCoÜd
 &
Ùh”
) const {

93  
vec
 =ğ
Ùh”
.vec;

96 
	m‹m¶©e
<
şass
 
	mArchive
>

97 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

98 
	m¬
 & 
	mvec
;

99 
	m¬
 & 
	mv¬
;

106 
RRCoÜd
 
cÚv”tToRobÙR–©ive
() const {

107  
RRCoÜd
(
sq¹f
(
vec
.
x
()*vec.x(è+ vec.
y
()*vec.y()), 
©ª2f
(vec.y(), vec.x()), 0.0f);

110 
RRCoÜd
 
cÚv”tToRobÙR–©ive
(cÚ¡ 
AbsCoÜd
 &
robÙPo£
) const {

111 
	mxdiff
 = 
x
(è- 
robÙPo£
.x();

112 
	mydiff
 = 
y
(è- 
robÙPo£
.y();

113 
	mdi¡ªû
 = 
sq¹f
(
xdiff
*xdifà+ 
ydiff
*ydiff);

115 
	mªgË
 = 
©ª2
(
ydiff
, 
xdiff
);

116 
	m¼H—dšg
 = 
nÜm®i£Th‘a
(
ªgË
 - 
robÙPo£
.
th‘a
());

118  
RRCoÜd
(
di¡ªû
, 
¼H—dšg
, 0.0f);

121 
AbsCoÜd
 
cÚv”tToRobÙR–©iveC¬‹sŸn
(cÚ¡ AbsCoÜd &
robÙPo£
) const {

122 
RRCoÜd
 
	m¼CoÜd
 = 
cÚv”tToRobÙR–©ive
(
robÙPo£
);

123  
AbsCoÜd
(

124 
¼CoÜd
.
di¡ªû
(è* 
cos
ÔrCoÜd.
h—dšg
()),

125 
¼CoÜd
.
di¡ªû
(è* 
sš
ÔrCoÜd.
h—dšg
()),

130 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gAbsCoÜd
& 
	gcoÜd
) {

131 
	gi
 = 0; i < 3; i++) {

132 
	ga
 = 
coÜd
.
vec
[
i
];

133 
	gos
.
wr™e
((*è&
a
, ());

136 
	gi
 = 0; i < 9; i++) {

137 
	ga
 = 
coÜd
.
v¬
[
i
];

138 
	gos
.
wr™e
((*è&
a
, ());

141 
	gos
.
wr™e
((*è&(
coÜd
.
weight
), ());

142  
	gos
;

145 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gAbsCoÜd
& 
	gcoÜd
) {

146 
	gi
 = 0; i < 3; i++) {

147 
	ga
;

148 
	gis
.
»ad
((*è&
a
, ());

149 
	gcoÜd
.
	gvec
[
i
] = 
a
;

152 
	gi
 = 0; i < 9; i++) {

153 
	ga
;

154 
	gis
.
»ad
((*è&
a
, ());

155 
	gcoÜd
.
	gv¬
[
i
] = 
a
;

158 
	gis
.
»ad
((*è&(
coÜd
.
weight
), ());

159  
	gis
;

	@robot/types/ActionCommand.hpp

43 #´agm¨
Úû


45 
	~<¡dšt.h
>

47 
	~<io¡»am
>

49 
	~"uts/body.hµ
"

53 
Çme¥aû
 
	gAùiÚCommªd
 {

59 
	sBody
 {

61 
	eAùiÚTy³
 {

62 
	gNONE
 = 0,

65 
	gSTAND
,

68 
	gWALK
,

69 
	gDRIBBLE
,

72 
	gGETUP_FRONT
, 
	gGETUP_BACK
,

73 
	gKICK
,

74 
	gINITIAL
,

75 
	gDEAD
, 
	gREF_PICKUP
,

76 
	gOPEN_FEET
,

77 
	gTHROW_IN
,

78 
	gGOALIE_SIT
,

79 
	gGOALIE_DIVE_RIGHT
,

80 
	gGOALIE_DIVE_LEFT
,

81 
	gGOALIE_CENTRE
,

82 
	gGOALIE_UNCENTRE
,

83 
	gGOALIE_STAND
,

84 
	gGOALIE_INITIAL
,

85 
	gGOALIE_AFTERSIT_INITIAL
,

86 
	gDEFENDER_CENTRE
,

87 
	gGOALIE_FAST_SIT
,

88 
	gGOALIE_PICK_UP
,

89 
	gMOTION_CALIBRATE
,

90 
	gSTAND_STRAIGHT
,

91 
	gLINE_UP
,

92 
	gNUM_ACTION_TYPES


94 
AùiÚTy³
 
	gaùiÚTy³
;

97 
	gfÜw¬d
;

98 
	gËá
;

99 
	gtuº
;

100 
	gpow”
;

101 
	gb’d
;

104 
	g¥“d
;

105 
	gkickDœeùiÚ
;

107 
	eFoÙ
 {

108 
	gLEFT
 = 0,

109 
	gRIGHT


111 
FoÙ
 
	gfoÙ
;

112 
boŞ
 
	gisFa¡
;

116 
boŞ
 
	gmi§ligÃdKick
;

132 
Body
(
AùiÚTy³
 
©
, 
f
 = 0, 
l
 = 0, 
t
 = 0.0, 
p
 = 1.0,

133 
b’d
 = 15.0, 
s
 = 1.0, 
k
 = 0.0, 
FoÙ
 
á
 = 
LEFT
, 
boŞ
 
ç¡
=
çl£
,

134 
boŞ
 
mi§ligÃdKick
=
çl£
)

135 : 
aùiÚTy³
(
©
),

136 
fÜw¬d
(
f
),

137 
Ëá
(
l
),

138 
tuº
(
t
),

139 
pow”
(
p
),

140 
b’d
(bend),

141 
¥“d
(
s
),

142 
kickDœeùiÚ
(
k
),

143 
foÙ
(
á
),

144 
isFa¡
(
ç¡
),

145 
mi§ligÃdKick
(misalignedKick) {}

150 
Body
()

151 : 
aùiÚTy³
(
NONE
),

152 
fÜw¬d
(0),

153 
Ëá
(0),

154 
tuº
(0),

155 
pow”
(0),

156 
b’d
(0),

157 
¥“d
(0),

158 
kickDœeùiÚ
(0),

159 
foÙ
(
LEFT
),

160 
isFa¡
(
çl£
),

161 
mi§ligÃdKick
(
çl£
) {}

163 
	g‹m¶©e
<
şass
 
	gArchive
>

164 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

165 
	g¬
 & 
	gaùiÚTy³
;

166 
	g¬
 & 
	gfÜw¬d
;

167 
	g¬
 & 
	gËá
;

168 
	g¬
 & 
	gtuº
;

169 
	g¬
 & 
	gpow”
;

173 cÚ¡ 
ušt8_t
 
	g´iÜ™›s
[
Body
::
NUM_ACTION_TYPES
] = {

205 
	sH—d
 {

206 
	gyaw
;

207 
	gp™ch
;

208 
boŞ
 
	gisR–©ive
;

209 
	gyawS³ed
;

210 
	gp™chS³ed
;

220 
H—d
(
y
, 
p
 = 0.0, 
boŞ
 
r
 = 
Œue
,

221 
ys
 = 1.0, 
ps
 = 1.0è: 
yaw
(
y
),

222 
p™ch
(
p
),

223 
isR–©ive
(
r
),

224 
yawS³ed
(
ys
),

225 
p™chS³ed
(
ps
) {}

227 
H—d
()

228 : 
yaw
(0.0),

229 
p™ch
(0.0),

230 
isR–©ive
(
Œue
),

231 
yawS³ed
(1.0),

232 
p™chS³ed
(1.0) {}

234 
	g‹m¶©e
<
şass
 
	gArchive
>

235 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

236 
	g¬
 & 
	gyaw
;

237 
	g¬
 & 
	gp™ch
;

238 
	g¬
 & 
	gisR–©ive
;

239 
	g¬
 & 
	gyawS³ed
;

240 
	g¬
 & 
	gp™chS³ed
;

244 
	srgb
 {

245 
boŞ
 
	g»d
;

246 
boŞ
 
	gg»’
;

247 
boŞ
 
	gblue
;

249 
rgb
(
boŞ
 
r
 = 
çl£
, boŞ 
g
 = f®£, boŞ 
b
 = f®£è: 
»d
(r),

250 
g»’
(
g
),

251 
blue
(
b
) {}

253 
	g‹m¶©e
<
şass
 
	gArchive
>

254 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

255 
	g¬
 & 
	g»d
;

256 
	g¬
 & 
	gg»’
;

257 
	g¬
 & 
	gblue
;

261 
	sLED
 {

263 
ušt16_t
 
	gËáE¬
;

264 
ušt16_t
 
	grightE¬
;

265 
rgb
 
	gËáEye
;

266 
rgb
 
	grightEye
;

267 
rgb
 
	gche¡Bu‰Ú
;

268 
rgb
 
	gËáFoÙ
;

269 
rgb
 
	grightFoÙ
;

271 
LED
(
rgb
 
Ëye
,„gb 
»ye
 =„gb(
Œue
,rue,rue),„gb 
cb
 =„gb(true,rue,rue),

272 
rgb
 
lf
 =„gb(),„gb 
rf
 =„gb()è: 
ËáE¬
(0x3FF),

273 
rightE¬
(0x3FF),

274 
ËáEye
(
Ëye
),

275 
rightEye
(
»ye
),

276 
che¡Bu‰Ú
(
cb
),

277 
ËáFoÙ
(
lf
),

278 
rightFoÙ
(
rf
) {}

280 
LED
()

281 : 
ËáE¬
(0x3FF),

282 
rightE¬
(0x3FF),

283 
ËáEye
(
rgb
(
Œue
,rue,rue)),

284 
rightEye
(
rgb
(
Œue
,rue,rue)),

285 
che¡Bu‰Ú
(
rgb
(
Œue
,rue,rue)),

286 
ËáFoÙ
(
rgb
()),

287 
rightFoÙ
(
rgb
()) {}

289 
	g‹m¶©e
<
şass
 
	gArchive
>

290 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

291 
	g¬
 & 
	gËáE¬
;

292 
	g¬
 & 
	grightE¬
;

293 
	g¬
 & 
	gËáEye
;

294 
	g¬
 & 
	grightEye
;

295 
	g¬
 & 
	gche¡Bu‰Ú
;

296 
	g¬
 & 
	gËáFoÙ
;

297 
	g¬
 & 
	grightFoÙ
;

304 
	sAÎ
 {

305 
H—d
 
	gh—d
;

306 
Body
 
	gbody
;

307 
LED
 
	gËds
;

308 
	gsÚ¬
;

310 
AÎ
(è: 
h—d
(), 
body
(
Body
::
NONE
), 
Ëds
(),

311 
sÚ¬
(
SÚ¬
::
Mode
::
NO_PING
) {}

313 
AÎ
(
H—d
 
h
, 
Body
 
b
, 
LED
 
l
, 
s
) {

314 
	gh—d
 = 
h
;

315 
	gbody
 = 
b
;

316 
	gËds
 = 
l
;

317 
	gsÚ¬
 = 
s
;

320 
	g‹m¶©e
<
şass
 
	gArchive
>

321 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

322 
	g¬
 & 
	gh—d
;

323 
	g¬
 & 
	gbody
;

324 
	g¬
 & 
	gËds
;

325 
	g¬
 & 
	gsÚ¬
;

330 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
rgb
 &
a
, cÚ¡ 
	grgb
 &
	gb
) {

331  (
	ga
.
	g»d
 =ğ
b
.
»d
è&& (
a
.
g»’
 =ğb.g»’è&& (a.
blue
 == b.blue);

334 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
rgb
 &
a
, cÚ¡ 
	grgb
 &
	gb
) {

335  !(
	ga
 =ğ
b
);

338 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
<<(
¡d
::o¡»am &
out
, cÚ¡ 
	grgb
 &
	ga
) {

339 
	gout
 << '{' << 
	ga
.
	g»d
 << ", " <<‡.
	gg»’
 << ", " <<‡.
	gblue
 << '}';

340  
	gout
;

343 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
<<(
¡d
::o¡»am &
out
, cÚ¡ 
	gH—d
 &
	ga
) {

344 
	gout
 << '[' << 
	ga
.
	gyaw
 << ", " <<‡.
	gp™ch
 << ", " <<‡.
	gisR–©ive
 << ']';

345  
	gout
;

348 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
<<(
¡d
::o¡»am &
out
, cÚ¡ 
	gBody
 &
	ga
) {

349 
	gout
 << '[' << 
	ga
.
	gaùiÚTy³
 << ", " <<‡.
	gfÜw¬d
 << ", " <<‡.
	gËá


350 << ", " << 
	ga
.
	gtuº
 << "," <<‡.
	gpow”
 << ']';

351  
	gout
;

354 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
<<(
¡d
::o¡»am &
out
, cÚ¡ 
	gLED
 &
	ga
) {

355 
	gout
 << '[' << 
	ga
.
	gËáE¬
 << ", " <<‡.
	grightE¬
 << ", " <<‡.
	gËáEye
 << ", "

356 << 
	ga
.
	grightEye
 << "," <<‡.
	gche¡Bu‰Ú
 << ","

357 << 
	ga
.
	gËáFoÙ
 << "," <<‡.
	grightFoÙ
 << ']';

358  
	gout
;

	@robot/types/BBox.hpp

1 #´agm¨
Úû


3 
	~"ty³s/Pošt.hµ
"

4 
	~<io¡»am
>

6 
	sBBox


8 
BBox
 () {}

9 
BBox
 (
Pošt
 
a
, Pošˆ
b
) :‡(a), b(b) {};

10 
	mvœtu®
 ~
BBox
 () {}

12 
width
() const

14  
	mb
.
x
(è- 
	ma
.x();

17 
height
() const

19  
	mb
.
y
(è- 
	ma
.y();

22 
boŞ
 
w™hš
(cÚ¡ 
Pošt
 
p
) const

24  (
	ma
.
x
(è<ğ
p
.x(è&&….x(è<ğ
b
.x())

25 && (
a
.
y
(è<ğ
p
.y(è&&….y(è<ğ
b
.y());

28 
boŞ
 
v®idIndex
(cÚ¡ 
Pošt
 
p
) const

30  (0 <ğ
p
.
x
(è&&….x(è<ğ
width
())

31 && (0 <ğ
p
.
y
(è&&….y(è<ğ
height
());

34 
Pošt
 
	ma
, 
	mb
;

36 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
BBox
 &
Ùh”
) const

38  
a
 =ğ
Ùh”
.¨&& 
b
 == other.b;

41 
boŞ
 
	mİ”©Ü
!ğ(cÚ¡ 
BBox
 &
Ùh”
) const

43  (
a
 !ğ
Ùh”
.¨|| 
b
 != other.b);

46 
	m‹m¶©e
<
şass
 
	mArchive
>

47 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

48 
	m¬
 & 
	ma
;

49 
	m¬
 & 
	mb
;

53 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gBBox
& 
	gbbox
) {

54 
	gos
 << 
	gbbox
.
	ga
;

55 
	gos
 << 
	gbbox
.
	gb
;

56  
	gos
;

59 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gBBox
& 
	gbbox
) {

60 
	gis
 >> 
	gbbox
.
	ga
;

61 
	gis
 >> 
	gbbox
.
	gb
;

62  
	gis
;

	@robot/types/BallInfo.cpp

1 
	~"B®lInfo.hµ
"

4 cÚ¡ *cÚ¡ 
	gB®lHšt
::
Ty³Name
[] =

	@robot/types/BallInfo.hpp

1 #iâdeà
BALL_INFO_HPP


2 
	#BALL_INFO_HPP


	)

4 
	~"ty³s/Pošt.hµ
"

5 
	~"ty³s/RRCoÜd.hµ
"

6 
	~"ty³s/XYZ_CoÜd.hµ
"

8 
	~<io¡»am
>

9 
	~<cm©h
>

12 
	sB®lInfo
 {

13 
B®lInfo
 (è: 
visiÚV¬
(-1) {}

14 
B®lInfo
 (
RRCoÜd
 
¼
, 
¿dius
, 
Pošt
 
imageCoÜds
, 
XYZ_CoÜd
 
ÃckR–©ive
) :

15 
¼
(rr),

16 
¿dius
(radius),

17 
imageCoÜds
(imageCoords),

18 
ÃckR–©ive
(neckRelative),

19 
visiÚV¬
(0.0f),

20 
d¬ke¡Pošt
(0),

21 
ªgËV¬
(0.0f),

22 
ccdR©šg
(0),

23 
Ï¡S“n
(0),

24 
liãtime
(0){}

26 
	mvœtu®
 ~
B®lInfo
 () {}

28 
RRCoÜd
 
	m¼
;

29 
	m¿dius
;

30 
Pošt
 
	mimageCoÜds
;

31 
XYZ_CoÜd
 
	mÃckR–©ive
;

32 
boŞ
 
	mtİCam”a
;

35 
	mvisiÚV¬
;

39 
	md¬ke¡Pošt
;

42 
	mªgËV¬
;

45 
	mccdR©šg
;

48 
	mÏ¡S“n
;

51 
	mliãtime
;

53 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
B®lInfo
 &
Ùh”
) const

55  
¼
 =ğ
Ùh”
.rr

56 && 
¿dius
 =ğ
Ùh”
.radius

57 && 
imageCoÜds
 =ğ
Ùh”
.imageCoords

58 && 
visiÚV¬
 =ğ
Ùh”
.visionVar

59 && 
ÃckR–©ive
 =ğ
Ùh”
.neckRelative

60 && 
tİCam”a
 =ğ
Ùh”
.topCamera

61 && 
Ï¡S“n
 =ğ
Ùh”
.lastSeen

62 && 
liãtime
 =ğ
Ùh”
.lifetime;

65 
	m‹m¶©e
<
şass
 
	mArchive
>

66 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

68 
	m¬
 & 
	m¼
;

69 
	m¬
 & 
	m¿dius
;

70 
	m¬
 & 
	mimageCoÜds
;

71 
	m¬
 & 
	mÃckR–©ive
;

72 
	m¬
 & 
	mtİCam”a
;

74 ià(
	mfe_v”siÚ
 >= 1) {

75 
¬
 & 
visiÚV¬
;

77 
	mvisiÚV¬
 = 0.0;

80 
	m¬
 & 
	mÏ¡S“n
;

81 
	m¬
 & 
	mliãtime
;

85 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gB®lInfo
& 
	gb®lInfo
) {

86 
	gos
 << 
	gb®lInfo
.
	g¼
;

87 
	gos
 << 
	gb®lInfo
.
	gimageCoÜds
;

88 
	gos
.
wr™e
((*è&(
b®lInfo
.
¿dius
), ());

89 
	gos
.
wr™e
((*è&(
b®lInfo
.
ÃckR–©ive
), (
XYZ_CoÜd
));

90 
	gos
.
wr™e
((*è&(
b®lInfo
.
visiÚV¬
), ());

91 
	gos
.
wr™e
((*è&(
b®lInfo
.
Ï¡S“n
), ());

92 
	gos
.
wr™e
((*è&(
b®lInfo
.
liãtime
), ());

93  
	gos
;

96 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gB®lInfo
& 
	gb®lInfo
) {

97 
	gis
 >> 
	gb®lInfo
.
	g¼
;

98 
	gis
 >> 
	gb®lInfo
.
	gimageCoÜds
;

99 
	gis
.
»ad
((*è&(
b®lInfo
.
¿dius
), ());

100 
	gis
.
»ad
((*è&(
b®lInfo
.
ÃckR–©ive
), (
XYZ_CoÜd
));

101 
	gis
.
»ad
((*è&(
b®lInfo
.
visiÚV¬
), ());

102 
	gis
.
»ad
((*è&(
b®lInfo
.
Ï¡S“n
), ());

103 
	gis
.
»ad
((*è&(
b®lInfo
.
liãtime
), ());

104  
	gis
;

107 
	sB®lHšt


110 
	eTy³


112 
	mbLeá
 = 0x00,

113 
	mbRight
 = 0x01,

114 
	mbHidd’
 = 0x02,

115 
	mbNÚe
 = 0x03

119 cÚ¡ *cÚ¡ 
	mTy³Name
[];

121 
B®lHšt
 () :

122 
ty³
(
bNÚe
) {

125 
B®lHšt
 (
Ty³
 
ty³
) :

126 
ty³
(type) {

129 
vœtu®
 ~
B®lHšt
 () {

132 
Ty³
 
ty³
;

134 
	m‹m¶©e
<
şass
 
	mArchive
>

135 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

136 
	m¬
 & 
	mty³
;

141 #iâdeà
SWIG


142 
BOOST_CLASS_VERSION
(
B®lInfo
, 1);

	@robot/types/BehaviourRequest.hpp

1 #´agm¨
Úû


3 
	~"ty³s/AùiÚCommªd.hµ
"

4 
	~"ty³s/AbsCoÜd.hµ
"

5 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aDefš™iÚs.hµ
"

7 şas 
	cBehaviourReque¡
 {

8 
	mpublic
:

9 
WhichCam”a
 
whichCam”a
;

10 
	mAùiÚCommªd
::
AÎ
 
aùiÚs
;

11 
boŞ
 
	mgßl›A‰ackšg
;

14 
boŞ
 
	mdošgB®lLšeUp
;

17 
boŞ
 
	misInR—dyMode
;

21 
	mtimeToR—chB®l
;

24 
	mtimeToR—chDeãnd”
;

25 
	mtimeToR—chMidf›ld”
;

26 
	mtimeToR—chUpf›ld”
;

29 
	mcu¼’tRŞe
;

33 
	mw®kšgToX
;

34 
	mw®kšgToY
;

35 
	mshoÙšgToX
;

36 
	mshoÙšgToY
;

43 
	m»adyPos™iÚAÎoÿtiÚ0
;

44 
	m»adyPos™iÚAÎoÿtiÚ1
;

45 
	m»adyPos™iÚAÎoÿtiÚ2
;

46 
	m»adyPos™iÚAÎoÿtiÚ3
;

47 
	m»adyPos™iÚAÎoÿtiÚ4
;

49 
	$BehaviourReque¡
() {

50 
whichCam”a
 = 
TOP_CAMERA
;

51 
gßl›A‰ackšg
 = 
çl£
;

52 
došgB®lLšeUp
 = 
çl£
;

53 
isInR—dyMode
 = 
çl£
;

54 
timeToR—chB®l
 = 10000.0f;

55 
cu¼’tRŞe
 = 0;

56 
w®kšgToX
 = 0;

57 
w®kšgToY
 = 0;

58 
shoÙšgToX
 = 0;

59 
shoÙšgToY
 = 0;

61 
»adyPos™iÚAÎoÿtiÚ0
 = -1;

62 
»adyPos™iÚAÎoÿtiÚ1
 = -1;

63 
»adyPos™iÚAÎoÿtiÚ2
 = -1;

64 
»adyPos™iÚAÎoÿtiÚ3
 = -1;

65 
»adyPos™iÚAÎoÿtiÚ4
 = -1;

68 
‹m¶©e
<
şass
 
Archive
>

69 
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

70 
¬
 & 
whichCam”a
;

71 
¬
 & 
aùiÚs
;

72 
¬
 & 
gßl›A‰ackšg
;

73 
¬
 & 
došgB®lLšeUp
;

74 
¬
 & 
isInR—dyMode
;

75 
¬
 & 
timeToR—chB®l
;

76 
¬
 & 
timeToR—chDeãnd”
;

77 
¬
 & 
timeToR—chMidf›ld”
;

78 
¬
 & 
timeToR—chUpf›ld”
;

79 
¬
 & 
cu¼’tRŞe
;

81 
¬
 & 
»adyPos™iÚAÎoÿtiÚ0
;

82 
¬
 & 
»adyPos™iÚAÎoÿtiÚ1
;

83 
¬
 & 
»adyPos™iÚAÎoÿtiÚ2
;

84 
¬
 & 
»adyPos™iÚAÎoÿtiÚ3
;

85 
¬
 & 
»adyPos™iÚAÎoÿtiÚ4
;

86 
	}
}

	@robot/types/BehaviourSharedData.hpp

8 #´agm¨
Úû


10 
	~"ty³s/boo¡S”Ÿliz©iÚEig’Ty³s.hµ
"

11 
	~"³rû±iÚ/behaviour/R—dySklPos™iÚAÎoÿtiÚ.hµ
"

13 şas 
	cBehaviourSh¬edD©a
 {

14 
	mpublic
:

16 
	$BehaviourSh¬edD©a
() :

17 
	`gßl›A‰ackšg
(
çl£
),

18 
	`timeToR—chB®l
(10000.0f),

19 
	`timeToR—chUpf›ld”
(10000.0f),

20 
	`timeToR—chMidf›ld”
(10000.0f),

21 
	`timeToR—chDeãnd”
(10000.0f),

22 
	`cu¼’tRŞe
(0),

23 
	`došgB®lLšeUp
(
çl£
),

24 
	$isInR—dyMode
(
çl£
) {}

26 
boŞ
 
gßl›A‰ackšg
;

30 
timeToR—chB®l
;

33 
timeToR—chUpf›ld”
;

34 
timeToR—chMidf›ld”
;

35 
timeToR—chDeãnd”
;

38 
cu¼’tRŞe
;

41 
boŞ
 
došgB®lLšeUp
;

43 
boŞ
 
isInR—dyMode
;

46 
R—dySklPos™iÚAÎoÿtiÚ
 
»adyPos™iÚAÎoÿtiÚ
;

49 
‹m¶©e
<
şass
 
Archive
>

50 
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

51 
¬
 & 
gßl›A‰ackšg
;

52 
¬
 & 
timeToR—chB®l
;

53 
¬
 & 
timeToR—chUpf›ld”
;

54 
¬
 & 
timeToR—chMidf›ld”
;

55 
¬
 & 
timeToR—chDeãnd”
;

56 
¬
 & 
cu¼’tRŞe
;

57 
¬
 & 
došgB®lLšeUp
;

58 
¬
 & 
isInR—dyMode
;

59 
¬
 & 
»adyPos™iÚAÎoÿtiÚ
;

60 
	}
}

	@robot/types/BroadcastData.hpp

32 #´agm¨
Úû


34 
	~"ty³s/AbsCoÜd.hµ
"

35 
	~"ty³s/RRCoÜd.hµ
"

36 
	~"ty³s/AùiÚCommªd.hµ
"

37 
	~"ty³s/BehaviourSh¬edD©a.hµ
"

38 
	~"³rû±iÚ/loÿli§tiÚ/Sh¬edLoÿli§tiÚUpd©eBundË.hµ
"

39 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

41 şas 
	cBrßdÿ¡D©a
 {

42 
	mpublic
:

43 
	$Brßdÿ¡D©a
()

44 : 
	`¶ay”Num
(0), 
	`‹am
(0), 
	`robÙPos
(0.0, 0.0, 0.0),

45 
	`b®lPosAbs
(), 
	`b®lPosRR
(), 
	`lo¡CouÁ
(0),

46 
	`sh¬edLoÿli§tiÚBundË
(), 
	`behaviourSh¬edD©a
(),

47 
	`acB
(
AùiÚCommªd
::
Body
::
DEAD
), 
	`u±ime
(0.0), 
	$gameS‹
(
STATE_INITIAL
) {}

49 
	$Brßdÿ¡D©a
(cÚ¡ 
Brßdÿ¡D©a
& 
bd
)

50 : 
	`¶ay”Num
(
bd
.
¶ay”Num
),

51 
	`‹am
(
bd
.
‹am
),

52 
	`robÙPos
(
bd
.
robÙPos
),

53 
	`b®lPosAbs
(
bd
.
b®lPosAbs
),

54 
	`b®lPosRR
(
bd
.
b®lPosRR
),

55 
	`lo¡CouÁ
(
bd
.
lo¡CouÁ
),

56 
	`sh¬edLoÿli§tiÚBundË
(
bd
.
sh¬edLoÿli§tiÚBundË
),

57 
	`behaviourSh¬edD©a
(
bd
.
behaviourSh¬edD©a
),

58 
	`acB
(
bd
.
acB
),

59 
	`u±ime
(
bd
.
u±ime
),

60 
	$gameS‹
(
bd
.
gameS‹
è{
	}
}

62 
	$Brßdÿ¡D©a
(cÚ¡ &
¶ay”Num
, cÚ¡ &
‹am
,

63 cÚ¡ 
AbsCoÜd
 &
robÙPos
,

64 cÚ¡ 
AbsCoÜd
 &
b®lPosAbs
,

65 cÚ¡ 
RRCoÜd
 &
b®lPosRR
,

66 cÚ¡ 
ušt32_t
 &
lo¡CouÁ
,

67 cÚ¡ 
Sh¬edLoÿli§tiÚUpd©eBundË
 &
sh¬edLoÿli§tiÚBundË
,

68 cÚ¡ 
BehaviourSh¬edD©a
 &
behaviourSh¬edD©a
,

69 cÚ¡ 
AùiÚCommªd
::
Body
::
AùiÚTy³
 &
acB
,

70 cÚ¡ &
u±ime
,

71 cÚ¡ 
ušt8_t
 &
gameS‹
)

72 : 
	`¶ay”Num
(
¶ay”Num
),

73 
	`‹am
(
‹am
),

74 
	`robÙPos
(
robÙPos
),

75 
	`b®lPosAbs
(
b®lPosAbs
),

76 
	`b®lPosRR
(
b®lPosRR
),

77 
	`lo¡CouÁ
(
lo¡CouÁ
),

78 
	`sh¬edLoÿli§tiÚBundË
(
sh¬edLoÿli§tiÚBundË
),

79 
	`behaviourSh¬edD©a
(
behaviourSh¬edD©a
),

80 
	`acB
(
acB
),

81 
	`u±ime
(
u±ime
),

82 
	$gameS‹
(
gameS‹
è{
	}
}

84 
	g¶ay”Num
;

85 
	g‹am
;

87 
AbsCoÜd
 
	grobÙPos
;

88 
AbsCoÜd
 
	gb®lPosAbs
;

89 
RRCoÜd
 
	gb®lPosRR
;

90 
ušt32_t
 
	glo¡CouÁ
;

92 
Sh¬edLoÿli§tiÚUpd©eBundË
 
	gsh¬edLoÿli§tiÚBundË
;

95 
BehaviourSh¬edD©a
 
	gbehaviourSh¬edD©a
;

97 
	gAùiÚCommªd
::
Body
::
AùiÚTy³
 
acB
;

98 
	gu±ime
;

99 
ušt8_t
 
	ggameS‹
;

101 
	g‹m¶©e
<
şass
 
	gArchive
>

102 
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

103 
¬
 & 
¶ay”Num
;

104 
¬
 & 
‹am
;

105 
¬
 & 
robÙPos
;

106 
¬
 & 
b®lPosAbs
;

107 
¬
 & 
b®lPosRR
;

108 
¬
 & 
lo¡CouÁ
;

109 
¬
 & 
sh¬edLoÿli§tiÚBundË
;

110 
¬
 & 
behaviourSh¬edD©a
;

111 
¬
 & 
acB
;

112 
¬
 & 
u±ime
;

113 
¬
 & 
gameS‹
;

114 
	}
}

	@robot/types/ButtonPresses.hpp

32 #´agm¨
Úû


34 
	~<¡dšt.h
>

36 şas 
	cBu‰ÚP»s£s
 {

37 
	mpublic
:

38 
	$Bu‰ÚP»s£s
(è: 
	$mask
(0) {}

39 
boŞ
 
	$pİ
(
n
) {

40 
boŞ
 
»t
 = 
	`³ek
(
n
);

41 
mask
 &ğ~(1 << (
n
 - 1));

42  
»t
;

43 
	}
}

45 
boŞ
 
	$³ek
(
n
) {

46  
mask
 & (1 << (
n
 - 1));

47 
	}
}

49 
	$push
(
n
) {

50 
mask
 |ğ1 << (
n
 - 1);

51 
	}
}

53 
	gİ”©Ü
|=(cÚ¡ 
Bu‰ÚP»s£s
& 
b
) {

54 
mask
 |ğ
b
.mask;

57 
	$ş—r
() {

58 
mask
 = 0;

59 
	}
}

61 
	g´iv©e
:

62 
ušt8_t
 
mask
;

	@robot/types/CameraSettings.hpp

1 #´agm¨
Úû


3 
	sCam”aS‘tšgs
 {

4 
	mhæ
;

5 
	mvæ
;

6 
	mbrighŠess
;

7 
	mcÚŒa¡
;

8 
	m§tu¿tiÚ
;

9 
	mhue
;

10 
	msh¬²ess
;

11 
	mbacklightCom³n§tiÚ
;

12 
	mexposu»
;

13 
	mgaš
;

14 
	mwh™eB®ªû
;

16 
	m‹m¶©e
<
şass
 
	mArchive
>

17 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

18 
	m¬
 & 
	mhæ
;

19 
	m¬
 & 
	mvæ
;

20 
	m¬
 & 
	mbrighŠess
;

21 
	m¬
 & 
	mcÚŒa¡
;

22 
	m¬
 & 
	m§tu¿tiÚ
;

23 
	m¬
 & 
	mhue
;

24 
	m¬
 & 
	msh¬²ess
;

25 
	m¬
 & 
	mbacklightCom³n§tiÚ
;

26 
	m¬
 & 
	mexposu»
;

27 
	m¬
 & 
	mgaš
;

28 
	m¬
 & 
	mwh™eB®ªû
;

	@robot/types/Cluster.hpp

1 #´agm¨
Úû


3 
	~"ty³s/Pošt.hµ
"

4 
	~"uts/basic_m©hs.hµ
"

5 
	~<io¡»am
>

7 
	sClu¡”


9 
Clu¡”
 (è{
	mûÁ»
 = 
Pošt
(0,0); 
	msize
 = 0; 
	mid
 = 0; 
	m
 = Pošt(-1,-1); 
	mbr
 = Point(-1,-1);}

10 
Clu¡”
 (
Pošt
 
p
è: 
ûÁ»
Õ), 
size
(1), 
id
(0), 

Õ), 
br
(p) {};

11 
	mvœtu®
 ~
Clu¡”
 () {}

13 
addPošt
(cÚ¡ 
Pošt
 
p
)

16 ià(
	m
.
x
(è=ğ-1 || 
p
.x(è< 

.x()) {

17 

.
x
(èğ
p
.x();

19 ià(
	mbr
.
x
(è=ğ-1 || 
p
.x(è> 
br
.x()) {

20 
br
.
x
(èğ
p
.x();

23 ià(
	m
.
y
(è=ğ-1 || 
p
.y(è< 

.y()) {

24 

.
y
(èğ
p
.y();

26 ià(
	mbr
.
y
(è=ğ-1 || 
p
.y(è> 
br
.y()) {

27 
br
.
y
(èğ
p
.y();

31 ià(
	msize
 == 0) {

32 
ûÁ»
 = 
p
;

33 
	msize
 ++;

36 
	mûÁ»
 *ğ
size
;

37 
	mûÁ»
 +ğ
p
;

38 
	msize
 ++;

39 
	mûÁ»
 /ğ
size
;

58 
Pošt
 
	mûÁ»
;

59 
	msize
;

60 
	mid
;

63 
Pošt
 
	m
;

64 
Pošt
 
	mbr
;

66 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
Clu¡”
 &
Ùh”
) const

68  
ûÁ»
 =ğ
Ùh”
.ûÁ» && 
size
 == other.size;

71 
boŞ
 
	mİ”©Ü
!ğ(cÚ¡ 
Clu¡”
 &
Ùh”
) const

73  (
ûÁ»
 !ğ
Ùh”
.ûÁ» || 
size
 != other.size);

	@robot/types/CombinedCameraSettings.hpp

1 #´agm¨
Úû


2 
	~"Cam”aS‘tšgs.hµ
"

4 
	sCombšedCam”aS‘tšgs
 {

5 
Cam”aS‘tšgs
 
	mtİ_ÿm”a_£‰šgs
;

6 
Cam”aS‘tšgs
 
	mbÙ_ÿm”a_£‰šgs
;

	@robot/types/CombinedFovea.hpp

1 #iâdeà
COMBINED_FOVEA_HPP


2 
	#COMBINED_FOVEA_HPP


	)

4 
	~"³rû±iÚ/visiÚ/Fov—.hµ
"

6 
	sCombšedFov—
 {

8 
	mpublic
:

9 
CombšedFov—
(
Fov—
* 
tİ
, Fov—* 
bÙ
è: 
tİ_
Ñİ), 
bÙ_
(bot) {}

10 ~
CombšedFov—
(è{ 
ä“
(
tİ_
); f»e(
bÙ_
); }

11 
g’”©e
(cÚ¡ 
CombšedF¿me
& 
this_äame
, 
CŞourCÏssif›r
& 
cŞour_şassif›r
) {

12 
	mtİ_
->
g’”©e
(
this_äame
, 
cŞour_şassif›r
);

13 
	mbÙ_
->
g’”©e
(
this_äame
, 
cŞour_şassif›r
);

15 
Fov—
* 
	mtİ_
;

16 
Fov—
* 
	mbÙ_
;

	@robot/types/CombinedFrame.hpp

1 #iâdeà
COMBINED_FRAME_HPP


2 
	#COMBINED_FRAME_HPP


	)

6 
	~<boo¡/sh¬ed_±r.hµ
>

8 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aToRR.hµ
"

9 
	~"³rû±iÚ/visiÚ/ÿm”a/Cam”aDefš™iÚs.hµ
"

11 
	sCombšedF¿me
 {

12 cÚ¡ 
ušt8_t
 *
	mtİ_äame_
;

13 cÚ¡ 
ušt8_t
 *
	mbÙ_äame_
;

14 cÚ¡ 
	mCam”aToRR
 &
	mÿm”a_to_¼_
;

15 
	mboo¡
::
sh¬ed_±r
<
CombšedF¿me
> 
Ï¡_
;

17 
CombšedF¿me
(cÚ¡ 
ušt8_t
 *
tİ_image
, cÚ¡ ušt8_ˆ*
bÙ_image
,

18 cÚ¡ 
Cam”aToRR
 &
ÿm”a_to_¼
,

19 
boo¡
::
sh¬ed_±r
<
CombšedF¿me
> 
Ï¡
) :

20 
tİ_äame_
(
tİ_image
), 
bÙ_äame_
(
bÙ_image
),

21 
ÿm”a_to_¼_
(
ÿm”a_to_¼
), 
Ï¡_
(
Ï¡
) {}

23 
CombšedF¿me
(cÚ¡ 
ušt8_t
 *
tİ_image
, cÚ¡ ušt8_ˆ*
bÙ_image
) :

24 
tİ_äame_
(
tİ_image
), 
bÙ_äame_
(
bÙ_image
),

25 
ÿm”a_to_¼_
(
Cam”aToRR
()),

26 
Ï¡_
(
boo¡
::
sh¬ed_±r
<
CombšedF¿me
>()) {}

	@robot/types/FieldBoundaryInfo.hpp

1 #´agm¨
Úû


3 
	~"ty³s/Rª§cTy³s.hµ
"

9 
	sF›ldBound¬yInfo


11 
F›ldBound¬yInfo
 () {}

12 
F›ldBound¬yInfo
 (
RANSACLše
 
¼Bound¬y
, RANSACLš
imageBound¬y
) :

13 
¼Bound¬y
 (rrBoundary),

14 
imageBound¬y
 (imageBoundary) {}

16 
	mvœtu®
 ~
F›ldBound¬yInfo
 () {}

18 
RANSACLše
 
	m¼Bound¬y
;

19 
RANSACLše
 
	mimageBound¬y
;

21 
	m‹m¶©e
<
şass
 
	mArchive
>

22 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

23 
	m¬
 & 
	m¼Bound¬y
;

24 
	m¬
 & 
	mimageBound¬y
;

28 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gF›ldBound¬yInfo
& 
	gf›ldBound¬y
) {

29 
	gos
 << 
	gf›ldBound¬y
.
	g¼Bound¬y
;

30 
	gos
 << 
	gf›ldBound¬y
.
	gimageBound¬y
;

31  
	gos
;

34 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gF›ldBound¬yInfo
& 
	gf›ldBound¬y
) {

35 
	gis
 >> 
	gf›ldBound¬y
.
	g¼Bound¬y
;

36 
	gis
 >> 
	gf›ldBound¬y
.
	gimageBound¬y
;

37  
	gis
;

	@robot/types/FieldFeatureInfo.cpp

1 
	~"F›ldF—tu»Info.hµ
"

4 cÚ¡ *cÚ¡ 
	gF›ldF—tu»Info
::
Ty³Name
[] =

	@robot/types/FieldFeatureInfo.hpp

1 #iâdeà
FIELD_FEATURE_INFO_HPP


2 
	#FIELD_FEATURE_INFO_HPP


	)

4 
	~<boo¡/£rŸliz©iÚ/v”siÚ.hµ
>

5 
	~<boo¡/£rŸliz©iÚ/¥l™_memb”.hµ
>

7 
	~"ty³s/Pošt.hµ
"

8 
	~"ty³s/RRCoÜd.hµ
"

9 
	~"ty³s/BBox.hµ
"

10 
	~"uts/basic_m©hs.hµ
"

12 
	sF›ldLšePoštInfo
 {

13 
Pošt
 
	mp
, 
	m¼p
;

15 
F›ldLšePoštInfo
 () {

17 
F›ldLšePoštInfo
 (
Pošt
 
p
, Pošˆ
¼p
)

18 : 
p
 (p), 
¼p
 (rrp) {

22 
	m‹m¶©e
<
şass
 
	mArchive
>

23 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

25 ià(
	mfe_v”siÚ
 >= 4) {

26 
¬
 & 
p
 & 
¼p
;

31 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gF›ldLšePoštInfo
& 
	gf›ldLšePoštInfo
) {

32 
	gos
 << 
	gf›ldLšePoštInfo
.
	gp
;

33 
	gos
 << 
	gf›ldLšePoštInfo
.
	g¼p
;

34  
	gos
;

37 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gF›ldLšePoštInfo
& 
	gf›ldLšePoštInfo
) {

38 
	gis
 >> 
	gf›ldLšePoštInfo
.
	gp
;

39 
	gis
 >> 
	gf›ldLšePoštInfo
.
	g¼p
;

40  
	gis
;

43 #iâdeà
SWIG


44 
BOOST_CLASS_VERSION
(
F›ldLšePoštInfo
, 4);

51 
	sLšeInfo
 {

52 
Pošt
 
	mp1
, 
	mp2
;

53 
	mt1
, 
	mt2
, 
	mt3
;

54 
RRCoÜd
 
	m¼
;

56 
LšeInfo
 () {

57 
	mp1
 = 
Pošt
(0,0);

58 
	mp2
 = 
Pošt
(0,0);

59 
	mt1
 = 0;

60 
	mt2
 = 0;

61 
	mt3
 = 0;

62 
	m¼
 = 
RRCoÜd
();

64 
LšeInfo
 (
Pošt
 
p1
, Pošˆ
p2
, 
RRCoÜd
 
¼
 = RRCoord(0,0))

65 : 
p1
Õ1), 
p2
Õ2), 
¼
(rr) {

66 
	mt1
 = 
p2
.
y
(è- 
p1
.y();

67 
	mt2
 = 
p1
.
x
(è- 
p2
.x();

68 
	mt3
 = 
p1
.
y
(è* (
p2
.
x
() -…1.x()) -…1.x() * (p2.y() -…1.y());

72 
	m‹m¶©e
<
şass
 
	mArchive
>

73 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

75 
	m¬
 & 
	mp1
 & 
	mp2
;

76 ià(
	mfe_v”siÚ
 >= 1) {

77 
¬
 & 
t1
 & 
t2
 & 
t3
;

79 ià(
	mfe_v”siÚ
 >= 4) {

80 
¬
 & 
¼
;

85 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gLšeInfo
& 
	glšeInfo
) {

86 
	gos
 << 
	glšeInfo
.
	gp1
;

87 
	gos
 << 
	glšeInfo
.
	gp2
;

88 
	gos
.
wr™e
((*è&(
lšeInfo
.
t1
), ());

89 
	gos
.
wr™e
((*è&(
lšeInfo
.
t2
), ());

90 
	gos
.
wr™e
((*è&(
lšeInfo
.
t3
), ());

91 
	gos
 << 
	glšeInfo
.
	g¼
;

92  
	gos
;

95 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gLšeInfo
& 
	glšeInfo
) {

96 
	gis
 >> 
	glšeInfo
.
	gp1
;

97 
	gis
 >> 
	glšeInfo
.
	gp2
;

98 
	gis
.
»ad
((*è&(
lšeInfo
.
t1
), ());

99 
	gis
.
»ad
((*è&(
lšeInfo
.
t2
), ());

100 
	gis
.
»ad
((*è&(
lšeInfo
.
t3
), ());

101 
	gis
 >> 
	glšeInfo
.
	g¼
;

102  
	gis
;

105 #iâdeà
SWIG


106 
BOOST_CLASS_VERSION
(
LšeInfo
, 4);

109 
	sCÜÃrInfo


111 
Pošt
 
	mp
;

113 
CÜÃrInfo
 () {}

114 
CÜÃrInfo
 (
Pošt
 
p
) :… (p) {}

116 
‹m¶©e
<
şass
 
Archive
>

117 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

119 
	m¬
 & 
	mp
;

123 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gCÜÃrInfo
& 
	gcÜÃrInfo
) {

124 
	gos
 << 
	gcÜÃrInfo
.
	gp
;

125  
	gos
;

128 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gCÜÃrInfo
& 
	gcÜÃrInfo
) {

129 
	gis
 >> 
	gcÜÃrInfo
.
	gp
;

130  
	gis
;

133 
	sTJunùiÚInfo


135 
Pošt
 
	mp
;

137 
TJunùiÚInfo
() {}

138 
TJunùiÚInfo
(
Pošt
 
p
) :… (p) {}

140 
‹m¶©e
<
şass
 
Archive
>

141 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

143 ià(
	mfe_v”siÚ
 >= 3) {

144 
¬
 & 
p
;

149 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gTJunùiÚInfo
& 
	gtJunùiÚInfo
) {

150 
	gos
 << 
	gtJunùiÚInfo
.
	gp
;

151  
	gos
;

154 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gTJunùiÚInfo
& 
	gtJunùiÚInfo
) {

155 
	gis
 >> 
	gtJunùiÚInfo
.
	gp
;

156  
	gis
;

159 #iâdeà
SWIG


160 
BOOST_CLASS_VERSION
(
TJunùiÚInfo
, 3);

163 
	sP’®tySpÙInfo


165 
Pošt
 
	mp
;

166 
	mw
, 
	mh
;

168 
P’®tySpÙInfo
() {}

169 
P’®tySpÙInfo
(
Pošt
 
p
) :… (p) {}

170 
P’®tySpÙInfo
(
Pošt
 
p
, 
w_
, 
h_
è:… (p), 
w
(w_), 
h
(h_) {}

172 
	m‹m¶©e
<
şass
 
	mArchive
>

173 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

175 ià(
	mfe_v”siÚ
 >= 3) {

176 
¬
 & 
p
;

181 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gP’®tySpÙInfo
& 
	g³ÇÉySpÙInfo
) {

182 
	gos
 << 
	g³ÇÉySpÙInfo
.
	gp
;

183  
	gos
;

186 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gP’®tySpÙInfo
& 
	g³ÇÉySpÙInfo
) {

187 
	gis
 >> 
	g³ÇÉySpÙInfo
.
	gp
;

188  
	gis
;

191 #iâdeà
SWIG


192 
BOOST_CLASS_VERSION
(
P’®tySpÙInfo
, 3);

195 
	sXJunùiÚInfo


197 
Pošt
 
	mp
;

199 
XJunùiÚInfo
() {}

200 
XJunùiÚInfo
(
Pošt
 
p
) :… (p) {}

202 
‹m¶©e
<
şass
 
Archive
>

203 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

205 ià(
	mfe_v”siÚ
 >= 3) {

206 
¬
 & 
p
;

211 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gXJunùiÚInfo
& 
	gxJunùiÚInfo
) {

212 
	gos
 << 
	gxJunùiÚInfo
.
	gp
;

213  
	gos
;

216 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gXJunùiÚInfo
& 
	gxJunùiÚInfo
) {

217 
	gis
 >> 
	gxJunùiÚInfo
.
	gp
;

218  
	gis
;

221 #iâdeà
SWIG


222 
BOOST_CLASS_VERSION
(
XJunùiÚInfo
, 3);

224 
	sC’ŒeCœşeInfo


226 
	m‹m¶©e
<
şass
 
	mArchive
>

227 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

232 
	sP¬®ËlLšesInfo


234 
LšeInfo
 
	ml1
, 
	ml2
;

236 
P¬®ËlLšesInfo
() {}

237 
P¬®ËlLšesInfo
(
LšeInfo
 
l1
, LšeInfØ
l2
) :†1 (l1),†2 (l2) {}

239 
	m‹m¶©e
<
şass
 
	mArchive
>

240 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

242 ià(
	mfe_v”siÚ
 >= 3) {

243 
¬
 & 
l1
 & 
l2
;

247 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gP¬®ËlLšesInfo
& 
	g·¿Î–LšesInfo
) {

248 
	gos
 << 
	g·¿Î–LšesInfo
.
	gl1
;

249 
	gos
 << 
	g·¿Î–LšesInfo
.
	gl2
;

250  
	gos
;

253 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gP¬®ËlLšesInfo
& 
	g·¿Î–LšesInfo
) {

254 
	gis
 >> 
	g·¿Î–LšesInfo
.
	gl1
;

255 
	gis
 >> 
	g·¿Î–LšesInfo
.
	gl2
;

256  
	gis
;

260 #iâdeà
SWIG


261 
BOOST_CLASS_VERSION
(
P¬®ËlLšesInfo
, 3);

265 
	sF›ldF—tu»Info
 {

267 
	eTy³


269 
	mfNÚe
 = 0x00,

270 
	mfLše
 = 0x01,

271 
	mfCÜÃr
 = 0x02,

272 
	mfTJunùiÚ
 = 0x03,

273 
	mfP’®tySpÙ
 = 0x04,

274 
	mfC’ŒeCœşe
 = 0x05,

275 
	mfF›ldLšePošt
 = 0x06,

276 
	mfXJunùiÚ
 = 0x07,

277 
	mfP¬®ËlLšes
 = 0x08

281 cÚ¡ *cÚ¡ 
	mTy³Name
[];

283 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
Ty³
 
ty³
) :

284 
¼
(rr),

285 
ty³
(type) {

288 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
LšeInfo
 
lše
) :

289 
¼
 (rr),

290 
ty³
 (
fLše
),

291 
lšeU£d
 (
çl£
),

292 
lše
 (line)

296 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
CÜÃrInfo
 
cÜÃr
) :

297 
¼
 (rr),

298 
ty³
 (
fCÜÃr
),

299 
cÜÃr
 (corner)

303 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
TJunùiÚInfo
 
tjunùiÚ
) :

304 
¼
 (rr),

305 
ty³
 (
fTJunùiÚ
),

306 
tjunùiÚ
 (tjunction)

310 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
P’®tySpÙInfo
 
³ÇÉy¥Ù
) :

311 
¼
 (rr),

312 
ty³
 (
fP’®tySpÙ
),

313 
³ÇÉy¥Ù
 (penaltyspot)

317 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
XJunùiÚInfo
 
xjunùiÚ
) :

318 
¼
 (rr),

319 
ty³
 (
fXJunùiÚ
),

320 
xjunùiÚ
 (xjunction)

324 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
C’ŒeCœşeInfo
 
ûÁ»cœşe
) :

325 
¼
 (rr),

326 
ty³
 (
fC’ŒeCœşe
),

327 
ûÁ»cœşe
 (centrecircle)

331 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
¡d
::
veùÜ
<
F›ldLšePoštInfo
> 
f›ldlš•ošts
) :

332 
¼
 (rr),

333 
ty³
 (
fF›ldLšePošt
),

334 
f›ldlš•ošts
 (fieldlinepoints)

338 
F›ldF—tu»Info
 (
RRCoÜd
 
¼
, 
P¬®ËlLšesInfo
 
·¿Î–lšes
) :

339 
¼
 (rr),

340 
ty³
 (
fP¬®ËlLšes
),

341 
·¿Î–lšes
 (parallellines)

345 
F›ldF—tu»Info
 () {

348 
F›ldF—tu»Info
(cÚ¡ F›ldF—tu»InfØ&
Ùh”
) {

349 
	mthis
->
	m¼
 = 
Ùh”
.
¼
;

350 
	mthis
->
	mty³
 = 
Ùh”
.
ty³
;

352 ià(
	mty³
 =ğ
fLše
) {

353 
this
->
lšeU£d
 = 
Ùh”
.lineUsed;

354 
	mthis
->
	mlše
 = 
Ùh”
.
lše
;

355 } ià(
	mty³
 =ğ
fCÜÃr
) {

356 
this
->
cÜÃr
 = 
Ùh”
.corner;

357 } ià(
	mty³
 =ğ
fTJunùiÚ
) {

358 
this
->
tjunùiÚ
 = 
Ùh”
.tjunction;

359 } ià(
	mty³
 =ğ
fP’®tySpÙ
) {

360 
this
->
³ÇÉy¥Ù
 = 
Ùh”
.penaltyspot;

361 } ià(
	mty³
 =ğ
fC’ŒeCœşe
) {

362 
this
->
ûÁ»cœşe
 = 
Ùh”
.centrecircle;

363 } ià(
	mty³
 =ğ
fF›ldLšePošt
) {

364 
this
->
f›ldlš•ošts
 = 
Ùh”
.fieldlinepoints;

365 } ià(
	mty³
 =ğ
fXJunùiÚ
) {

366 
this
->
xjunùiÚ
 = 
Ùh”
.xjunction;

367 } ià(
	mty³
 =ğ
fP¬®ËlLšes
) {

368 
this
->
·¿Î–lšes
 = 
Ùh”
.parallellines;

372 
	mvœtu®
 ~
F›ldF—tu»Info
 () {

375 
RRCoÜd
 
	m¼
;

376 
Ty³
 
	mty³
;

377 
boŞ
 
	mlšeU£d
;

379 
LšeInfo
 
	mlše
;

380 
CÜÃrInfo
 
	mcÜÃr
;

381 
TJunùiÚInfo
 
	mtjunùiÚ
;

382 
P’®tySpÙInfo
 
	m³ÇÉy¥Ù
;

383 
XJunùiÚInfo
 
	mxjunùiÚ
;

384 
C’ŒeCœşeInfo
 
	mûÁ»cœşe
;

385 
	m¡d
::
veùÜ
<
F›ldLšePoštInfo
> 
f›ldlš•ošts
;

386 
P¬®ËlLšesInfo
 
	m·¿Î–lšes
;

388 
di¡ªû
() const {

389 ià(
	mty³
 =ğ
fLše
) {

390  
poštSegm’tDi¡
(
Pošt
(0, 0), 
lše
.
p1
,†še.
p2
);

391 } ià(
	mty³
 =ğ
fCÜÃr
) {

392  
¼
.
di¡ªû
();

393 } ià(
	mty³
 =ğ
fTJunùiÚ
) {

394  
¼
.
di¡ªû
();

395 } ià(
	mty³
 =ğ
fP’®tySpÙ
) {

396  
¼
.
di¡ªû
();

397 } ià(
	mty³
 =ğ
fC’ŒeCœşe
) {

398  
¼
.
di¡ªû
();

399 } ià(
	mty³
 =ğ
fF›ldLšePošt
) {

400 
di¡ªûSum
 = 0.0;

401 
	mi
 = 0; i < 
	mf›ldlš•ošts
.
size
(); i++) {

402 
	mdi¡ªû
 = 
sq¹
(
f›ldlš•ošts
[
i
].
¼p
.
x
()*fieldlinepoints[i].rrp.x() +

403 
f›ldlš•ošts
[
i
].
¼p
.
y
()*fieldlinepoints[i].rrp.y());

404 
	mdi¡ªûSum
 +ğ
di¡ªû
;

406  
	mf›ldlš•ošts
.
size
(è=ğ0 ? 0.0 : 
di¡ªûSum
/
f›ldlš•ošts
.size();

407 } ià(
	mty³
 =ğ
fXJunùiÚ
) {

408  
¼
.
di¡ªû
();

409 } ià(
	mty³
 =ğ
fP¬®ËlLšes
) {

410 
d1
 = 
poštSegm’tDi¡
(
Pošt
(0, 0), 
·¿Î–lšes
.
l1
.
p1
,…¬®ËÎšes.l1.
p2
);

411 
	md2
 = 
poštSegm’tDi¡
(
Pošt
(0, 0), 
·¿Î–lšes
.
l2
.
p1
,…¬®ËÎšes.l2.
p2
);

412 
	m»suÉ
 = (
d1
+
d2
)/2.0;

413  
	m»suÉ
;

419 
	m‹m¶©e
<
şass
 
	mArchive
>

420 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

421 
	m¬
 & 
	m¼
;

422 
	m¬
 & 
	mty³
;

424 ià(
	mty³
 =ğ
fLše
) {

425 
¬
 & 
lše
;

426 
	m¬
 & 
	mlšeU£d
;

427 } ià(
	mty³
 =ğ
fCÜÃr
) {

428 
¬
 & 
cÜÃr
;

429 } ià(
	mty³
 =ğ
fTJunùiÚ
) {

430 
¬
 & 
tjunùiÚ
;

431 } ià(
	mty³
 =ğ
fP’®tySpÙ
) {

432 
¬
 & 
³ÇÉy¥Ù
;

433 } ià(
	mty³
 =ğ
fC’ŒeCœşe
) {

434 
¬
 & 
ûÁ»cœşe
;

435 } ià(
	mty³
 =ğ
fF›ldLšePošt
) {

436 
¬
 & 
f›ldlš•ošts
;

437 } ià(
	mty³
 =ğ
fXJunùiÚ
) {

438 
¬
 & 
xjunùiÚ
;

439 } ià(
	mty³
 =ğ
fP¬®ËlLšes
) {

440 
¬
 & 
·¿Î–lšes
;

444 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gF›ldF—tu»Info
& 
	gf›ldF—tu»Info
) {

445 
	gos
 << 
	gf›ldF—tu»Info
.
	g¼
;

446 
	gos
.
wr™e
((*è&(
f›ldF—tu»Info
.
ty³
), (
F›ldF—tu»Info
::
Ty³
));

447 
	gos
.
wr™e
((*è&(
f›ldF—tu»Info
.
lšeU£d
), (
boŞ
));

449 
	gos
 << 
	gf›ldF—tu»Info
.
	glše
;

450 
	gos
 << 
	gf›ldF—tu»Info
.
	gcÜÃr
;

451 
	gos
 << 
	gf›ldF—tu»Info
.
	gtjunùiÚ
;

452 
	gos
 << 
	gf›ldF—tu»Info
.
	g³ÇÉy¥Ù
;

453 
	gos
 << 
	gf›ldF—tu»Info
.
	gxjunùiÚ
;

454 
	gos
 << 
	gf›ldF—tu»Info
.
	g·¿Î–lšes
;

456 
	gnumF›ldlš•ošts
 = 
f›ldF—tu»Info
.
f›ldlš•ošts
.
size
();

457 
	gos
.
wr™e
((*è&
numF›ldlš•ošts
, ());

458 
	gi
 = 0; i < 
	gnumF›ldlš•ošts
; i++) {

459 
	gos
 << 
	gf›ldF—tu»Info
.
	gf›ldlš•ošts
[
i
];

462  
	gos
;

465 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gF›ldF—tu»Info
& 
	gf›ldF—tu»Info
) {

466 
	gis
 >> 
	gf›ldF—tu»Info
.
	g¼
;

467 
	gis
.
»ad
((*è&(
f›ldF—tu»Info
.
ty³
), (
F›ldF—tu»Info
::
Ty³
));

468 
	gis
.
»ad
((*è&(
f›ldF—tu»Info
.
lšeU£d
), (
boŞ
));

470 
	gis
 >> 
	gf›ldF—tu»Info
.
	glše
;

471 
	gis
 >> 
	gf›ldF—tu»Info
.
	gcÜÃr
;

472 
	gis
 >> 
	gf›ldF—tu»Info
.
	gtjunùiÚ
;

473 
	gis
 >> 
	gf›ldF—tu»Info
.
	g³ÇÉy¥Ù
;

474 
	gis
 >> 
	gf›ldF—tu»Info
.
	gxjunùiÚ
;

475 
	gis
 >> 
	gf›ldF—tu»Info
.
	g·¿Î–lšes
;

477 
	gnumF›ldlš•ošts
;

478 
	gis
.
»ad
((*è&
numF›ldlš•ošts
, ());

479 
	gi
 = 0; i < 
	gnumF›ldlš•ošts
; i++) {

480 
F›ldLšePoštInfo
 
	gf›ldLšePoštInfo
;

481 
	gis
 >> 
	gf›ldLšePoštInfo
;

482 
	gf›ldF—tu»Info
.
	gf›ldlš•ošts
.
push_back
(
f›ldLšePoštInfo
);

485  
	gis
;

	@robot/types/FootInfo.hpp

1 #´agm¨
Úû


3 
	~"ty³s/Pošt.hµ
"

4 
	~"ty³s/BBox.hµ
"

5 
	~<io¡»am
>

7 
	sFoÙInfo


9 
FoÙInfo
 (){}

10 
FoÙInfo
 (
BBox
& 
_a
, BBox& 
_b
, 
_age
):
robÙBounds
(_a), 
imageBounds
(_b), 
age
(_age){}

11 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
FoÙInfo
 &
Ùh”
) const{

12  
imageBounds
 =ğ
Ùh”
.imageBounds

13 && 
robÙBounds
 =ğ
Ùh”
.robotBounds

14 && 
age
 =ğ
Ùh”
.age;

16 
BBox
 
	mrobÙBounds
, 
	mimageBounds
;

17 
	mage
;

19 
	m‹m¶©e
 <
şass
 
	mArchive
>

20 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
){

21 
	m¬
 & 
	mrobÙBounds
;

22 
	m¬
 & 
	mimageBounds
;

23 
	m¬
 & 
	mage
;

27 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gFoÙInfo
& 
	gf
) {

28 
	gos
 << "Age: " << 
	gf
.
	gage
 << " RobÙBB [ " << f.
	grobÙBounds
 << " ] ImageBB [ " << f.
	gimageBounds
 << " ]";

29  
	gos
;

	@robot/types/FrameInfo.hpp

1 #iâdeà
FRAME_INFO_HPP


2 
	#FRAME_INFO_HPP


	)

4 
	~<veùÜ
>

6 
	~"ty³s/B®lInfo.hµ
"

7 
	~"ty³s/F›ldBound¬yInfo.hµ
"

8 
	~"ty³s/F›ldF—tu»Info.hµ
"

9 
	~"ty³s/Po¡Info.hµ
"

10 
	~"ty³s/RobÙInfo.hµ
"

12 
	sF¿meInfo
 {

13 
	m¡d
::
veùÜ
<
B®lInfo
> 
b®ls
;

14 
	m¡d
::
veùÜ
<
F›ldBound¬yInfo
> 
bound¬›s
;

15 
	m¡d
::
veùÜ
<
F›ldF—tu»Info
> 
ã©u»s
;

16 
	m¡d
::
veùÜ
<
Po¡Info
> 
po¡s
;

17 
	m¡d
::
veùÜ
<
RobÙInfo
> 
robÙs
;

	@robot/types/Ipoint.hpp

3 #´agm¨
Úû


5 
	~<veùÜ
>

6 
	~<m©h.h
>

7 
	~<lim™s
>

9 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

14 
	sIpošt
 {

17 
Ipošt
() { };

20 
	mvœtu®
 ~
Ipošt
() {};

23 
	mİ”©Ü
-(cÚ¡ 
	mIpošt
 &
	mrhs
)

25 if(
	mthis
->
	mÏ¶acŸn
-
	mrhs
.Ï¶acŸÀ!=0è 
¡d
::
num”ic_lim™s
<>::
max
();

26 
	msum
=0.f;

27 
	mi
=0; i < 
	mSURF_DESCRIPTOR_LENGTH
; ++i){

28 
	msum
 +ğ(
this
->
desütÜ
[
i
] - 
rhs
.descriptor[i])*(this->descriptor[i] -„hs.descriptor[i]);

30  
sq¹
(
sum
);

34 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mIpošt
 &
	mrhs
) const

36 ià(
	mthis
->
	mx
 < 
	mrhs
.xè 
	mŒue
;

37  
	mçl£
;

41 
	mx
,
	my
;

44 
	msÿË
;

47 
	mÏ¶acŸn
;

50 
	misRobÙ
;

53 
	mdesütÜ
[
SURF_DESCRIPTOR_LENGTH
];

55 
	m‹m¶©e
<
şass
 
	mArchive
>

56 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

58 
	m¬
 & 
	mx
 & 
	my
 & 
	msÿË
;

59 
	m¬
 & 
	mÏ¶acŸn
 & 
	misRobÙ
;

60 
	m¬
 & 
	mdesütÜ
;

	@robot/types/JointValues.hpp

32 #´agm¨
Úû


34 
	~"uts/body.hµ
"

39 
	sJoštV®ues
 {

40 
JoštV®ues
() {

41 
	mi
 = 0; i < 
	mJošts
::
NUMBER_OF_JOINTS
; ++i) {

42 
	mªgËs
[
i
] = 
NAN
;

43 
	m¡ifâes£s
[
i
] = 
NAN
;

44 
	m‹m³¿tu»s
[
i
] = 
NAN
;

45 
	mcu¼’ts
[
i
] = 
NAN
;

48 
JoštV®ues
(
boŞ
 
z”o
) {

49 
	mi
 = 0; i < 
	mJošts
::
NUMBER_OF_JOINTS
; ++i) {

50 
	mªgËs
[
i
] = 0;

51 
	m¡ifâes£s
[
i
] = 0;

52 
	m‹m³¿tu»s
[
i
] = 0;

53 
	mcu¼’ts
[
i
] = 0;

57 
	mªgËs
[
Jošts
::
NUMBER_OF_JOINTS
];

59 
	m¡ifâes£s
[
Jošts
::
NUMBER_OF_JOINTS
];

61 
	m‹m³¿tu»s
[
Jošts
::
NUMBER_OF_JOINTS
];

62 
	mcu¼’ts
[
Jošts
::
NUMBER_OF_JOINTS
];

64 
	m‹m¶©e
<
şass
 
	mArchive
>

65 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

66 
	m¬
 & 
	mªgËs
;

67 
	m¬
 & 
	m¡ifâes£s
;

68 
	m¬
 & 
	m‹m³¿tu»s
;

69 
	m¬
 & 
	mcu¼’ts
;

	@robot/types/Line.hpp

1 #´agm¨
Úû


3 
	~<Eig’/Eig’
>

4 
	~"ty³s/Pošt.hµ
"

14 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

15 
	s__Lše_G’”ic


17 
	mEig’
::
M©rix
<
T
, 2, 1> 
	mp
, 
	mv
;

19 
__Lše_G’”ic
(
Eig’
::
M©rix
<
T
, 2, 1> 
p
, Eig’::M©rix<T, 2, 1> 
v
);

21 
boŞ
 
š‹r£ù
(cÚ¡ 
__Lše_G’”ic
<
T
> &
l
,

22 
Eig’
::
M©rix
<
T
, 2, 1> &
š‹r£ùiÚ
) const;

24 
T
 
di¡ToPošt
(
Eig’
::
M©rix
<T, 2, 1> 
p
) const;

26 
	m‹m¶©e
 <
ty³Çme
 
	mÿ¡_T
>

27 
	m__Lše_G’”ic
<
	mÿ¡_T
> 
ÿ¡
() const;

29 
	m‹m¶©e
<
şass
 
	mArchive
>

30 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
);

33 
	g__Lše_G’”ic
<> 
	tLše
;

34 
	g__Lše_G’”ic
<> 
	tLšeF
;

36 
	~"ty³s/Lše.tcc
"

	@robot/types/Line.tcc

1 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

2 
	g__Lše_G’”ic
<
	gT
>::
__Lše_G’”ic
(
Eig’
::
M©rix
<
T
, 2, 1> 
p
,

3 
Eig’
::
M©rix
<
T
, 2, 1> 
v
)

4 : 
p
Õ), 
	$v
(
v
)

6 
	}
}

8 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

9 
boŞ
 
	g__Lše_G’”ic
<
	gT
>::
š‹r£ù
(cÚ¡ 
__Lše_G’”ic
 &
l
,

10 
Eig’
::
M©rix
<
T
, 2, 1> &
š‹r£ùiÚ
)

14 
	gEig’
::
M©rix2f
 
A
;

15 
	gEig’
::
VeùÜ2f
 
b
, 
	gx
;

17 
	gA
 << 
	gv
.
x
(), -
	gl
.v.x(),

18 
	gv
.
y
(), -
	gl
.v.y();

20 
	gb
 << 
	gl
.
	gp
.
x
() -….x(),

21 
	gl
.
	gp
.
y
() -….y();

23 ià(! 
	gA
.
lu
().
sŞve
(
b
, &
x
)) {

24  
	gçl£
;

26 
	gš‹r£ùiÚ
 = (
p
 + 
x
[0] * 
v
).
ÿ¡
<
T
>();

27  
	gŒue
;

31 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

32 
T
 
	g__Lše_G’”ic
<
	gT
>::
di¡ToPošt
(
Eig’
::
M©rix
<T, 2, 1> 
p
) const

34 
	g__Lše_G’”ic
<
	gT
> 
³½
(
p
, 
Eig’
::
M©rix
<
T
, 2, 1>(
v
.
y
(), -v.
x
()));

35 
	gEig’
::
M©rix
<
T
, 2, 1> 
	gš‹r£ùiÚ
 = 
Eig’
::Matrix<T,2,1>(0,0);

36 
š‹r£ù
(
³½
, 
š‹r£ùiÚ
);

37  (
	gp
 - 
	gš‹r£ùiÚ
).
	gÿ¡
<>().
nÜm
();

40 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

41 
	g‹m¶©e
 <
ty³Çme
 
	gÿ¡_T
>

42 
	g__Lše_G’”ic
<
	gÿ¡_T
> __Lše_G’”ic<
	gT
>::
	$ÿ¡
() const

44  
__Lše_G’”ic
<
ÿ¡_T
>(
p
.
ÿ¡
<ÿ¡_T>(), 
v
.cast<cast_T>);

45 
	}
}

47 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

48 
	g‹m¶©e
<
şass
 
	gArchive
>

49 
	g__Lše_G’”ic
<
	gT
>::
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
)

51 
¬
 & 
p
 & 
v
;

52 
	}
}

	@robot/types/MapEntry.hpp

3 #´agm¨
Úû


5 
	~<veùÜ
>

6 
	~"Ipošt.hµ
"

7 
	~"AbsCoÜd.hµ
"

8 
	~"RRCoÜd.hµ
"

9 
	~"Rª§cTy³s.hµ
"

12 
	sM­EÁry
 {

14 
M­EÁry
(){

15 
	mscÜe
 = 0.f;

18 
M­EÁry
(
AbsCoÜd
 
_pos™iÚ
){

19 
	mpos™iÚ
 = 
_pos™iÚ
;

20 
	mscÜe
 = 0.f;

23 
M­EÁry
(
RRCoÜd
 
_objeù
){

24 
	mobjeù
 = 
_objeù
;

25 
	mscÜe
 = 0.f;

28 
M­EÁry
(
¡d
::
veùÜ
<
Ipošt
> 
_ošts
, 
AbsCoÜd
 
_pos™iÚ
){

29 
	mošts
 = 
_ošts
;

30 
	mpos™iÚ
 = 
_pos™iÚ
;

31 
	mscÜe
 = 0.f;

34 
M­EÁry
(
¡d
::
veùÜ
<
Ipošt
> 
_ošts
, 
RRCoÜd
 
_objeù
){

35 
	mošts
 = 
_ošts
;

36 
	mobjeù
 = 
_objeù
;

37 
	mscÜe
 = 0.f;

41 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mM­EÁry
 &
	mrhs
) const

43 ià(
	mthis
->
	mscÜe
 < 
	mrhs
.scÜeè 
	mŒue
;

44  
	mçl£
;

49 
AbsCoÜd
 
	mpos™iÚ
;

52 
RRCoÜd
 
	mobjeù
;

55 
	m¡d
::
veùÜ
<
Ipošt
> 
ošts
;

58 
	mscÜe
;

61 
RANSACLše
 
	m¿n§cLše
;

64 
	m‹m¶©e
<
şass
 
	mArchive
>

65 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

67 
	m¬
 & 
	mpos™iÚ
;

68 
	m¬
 & 
	mošts
;

69 
	m¬
 & 
	mscÜe
;

70 
	m¬
 & 
	mobjeù
;

71 
	m¬
 & 
	m¿n§cLše
;

	@robot/types/Odometry.hpp

32 #´agm¨
Úû


34 
	~<io¡»am
>

36 
	sOdom‘ry
 {

37 
	mfÜw¬d
;

38 
	mËá
;

39 
	mtuº
;

41 
Odom‘ry
(
f
 = 0.0f, 
l
 = 0.0f, 
t
 = 0.0f)

42 : 
fÜw¬d
(
f
), 
Ëá
(
l
), 
tuº
(
t
) {}

44 
šlše
 
ş—r
() {

45 
	mfÜw¬d
 = 
Ëá
 = 
tuº
 = 0.0f;

48 
	m‹m¶©e
<
şass
 
	mArchive
>

49 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

51 
	m¬
 & 
	mfÜw¬d
 & 
	mËá
 & 
	mtuº
;

55 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gOdom‘ry
& 
	godom‘ry
) {

56 
	gos
.
wr™e
((*è&(
odom‘ry
.
fÜw¬d
), ());

57 
	gos
.
wr™e
((*è&(
odom‘ry
.
Ëá
), ());

58 
	gos
.
wr™e
((*è&(
odom‘ry
.
tuº
), ());

60  
	gos
;

63 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gOdom‘ry
& 
	godom‘ry
) {

64 
	gis
.
»ad
((*è&(
odom‘ry
.
fÜw¬d
), ());

65 
	gis
.
»ad
((*è&(
odom‘ry
.
Ëá
), ());

66 
	gis
.
»ad
((*è&(
odom‘ry
.
tuº
), ());

68  
	gis
;

71 #iâdeà
SWIG


72 
šlše
 
Odom‘ry
 
	gİ”©Ü
+(cÚ¡ 
	gOdom‘ry
& 
	ga
, cÚ¡ Odom‘ry& 
	gb
) {

73 
Odom‘ry
 
	gc
;

74 
	gc
.
	gfÜw¬d
 = 
a
.
fÜw¬d
 + 
b
.forward;

75 
	gc
.
	gËá
 = 
a
.
Ëá
 + 
b
.left;

76 
	gc
.
	gtuº
 = 
a
.
tuº
 + 
b
.turn;

77  
	gc
;

80 
šlše
 
Odom‘ry
 
	gİ”©Ü
-(cÚ¡ 
	gOdom‘ry
& 
	ga
, cÚ¡ Odom‘ry& 
	gb
) {

81 
Odom‘ry
 
	gc
;

82 
	gc
.
	gfÜw¬d
 = 
a
.
fÜw¬d
 - 
b
.forward;

83 
	gc
.
	gËá
 = 
a
.
Ëá
 - 
b
.left;

84 
	gc
.
	gtuº
 = 
a
.
tuº
 - 
b
.turn;

85  
	gc
;

	@robot/types/Point.hpp

1 #´agm¨
Úû


3 
	~<Eig’/Eig’
>

4 
	~<io¡»am
>

6 
	gEig’
::
	tVeùÜ2i
 
	tPošt
;

7 
	gEig’
::
	tVeùÜ2f
 
	tPoštF
;

9 
Çme¥aû
 
	gboo¡
 {

10 
Çme¥aû
 
	g£rŸliz©iÚ
 {

12 
	g‹m¶©e
 <
şass
 
	gArchive
>

13 
£rŸlize
(
Archive
 & 
¬
, 
Pošt
& 
p
, cÚ¡ 
v”siÚ
)

15 
	g¬
 & 
	gp
[0];

16 
	g¬
 & 
	gp
[1];

19 
	g‹m¶©e
 <
şass
 
	gArchive
>

20 
£rŸlize
(
Archive
 & 
¬
, 
PoštF
& 
p
, cÚ¡ 
v”siÚ
)

22 
	g¬
 & 
	gp
[0];

23 
	g¬
 & 
	gp
[1];

29 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gPošt
& 
	gpošt
) {

30 
	gx
 = 
pošt
[0];

31 
	gy
 = 
pošt
[1];

33 
	gos
.
wr™e
((*è&
x
, ());

34 
	gos
.
wr™e
((*è&
y
, ());

35  
	gos
;

38 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gPošt
& 
	gpošt
) {

39 
	gx
, 
	gy
;

41 
	gis
.
»ad
((*è&
x
, ());

42 
	gis
.
»ad
((*è&
y
, ());

44 
	gpošt
[0] = 
x
;

45 
	gpošt
[1] = 
y
;

47  
	gis
;

	@robot/types/PostInfo.cpp

1 
	~"Po¡Info.hµ
"

4 cÚ¡ *cÚ¡ 
	gPo¡Info
::
Ty³Name
[] =

19 cÚ¡ *cÚ¡ 
	gPo¡Info
::
DœName
[] =

	@robot/types/PostInfo.hpp

1 #iâdeà
POST_INFO_HPP


2 
	#POST_INFO_HPP


	)

4 
	~"ty³s/Pošt.hµ
"

5 
	~"ty³s/RRCoÜd.hµ
"

6 
	~"ty³s/BBox.hµ
"

8 
	~<io¡»am
>

10 
	sPo¡Info
 {

12 
	eTy³


14 
	mpNÚe
 = 0x00,

15 
	mpLeá
 = 0x01,

16 
	mpRight
 = 0x02,

17 
	mpHome
 = 0x04,

18 
	mpAway
 = 0x08,

19 
	mpHomeLeá
 = 
pLeá
 | 
pHome
,

20 
	mpHomeRight
 = 
pRight
 | 
pHome
,

21 
	mpAwayLeá
 = 
pLeá
 | 
pAway
,

22 
	mpAwayRight
 = 
pRight
 | 
pAway
,

27 
	eDœeùiÚ


29 
	mpToLeáOf
,

30 
	mpToRightOf
,

31 
	mpUnknown


35 cÚ¡ *cÚ¡ 
	mTy³Name
[];

36 cÚ¡ *cÚ¡ 
	mDœName
[];

38 
Po¡Info
 () {}

39 
Po¡Info
 (
RRCoÜd
 
¼
, 
Ty³
 
ty³
, 
BBox
 
imageCoÜds
,

40 
wDi¡ªû
, 
kDi¡ªû
, 
boŞ
 
Œu¡Di¡ªû
,

41 
DœeùiÚ
 
dœ
) :

42 
¼
(rr),

43 
ty³
(type),

44 
imageCoÜds
(imageCoords),

45 
wDi¡ªû
(wDistance),

46 
kDi¡ªû
(kDistance),

47 
Œu¡Di¡ªû
(trustDistance),

48 
dœ
(dir) {}

50 
	mvœtu®
 ~
Po¡Info
 () {}

52 
RRCoÜd
 
	m¼
;

53 
Ty³
 
	mty³
;

54 
BBox
 
	mimageCoÜds
;

55 
	mwDi¡ªû
;

56 
	mkDi¡ªû
;

57 
boŞ
 
	mŒu¡Di¡ªû
;

58 
DœeùiÚ
 
	mdœ
;

60 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
Po¡Info
 &
Ùh”
) const

62  
¼
 =ğ
Ùh”
.rr

63 && 
ty³
 =ğ
Ùh”
.type

64 && 
imageCoÜds
 =ğ
Ùh”
.imageCoords

65 && 
wDi¡ªû
 =ğ
Ùh”
.wDistance

66 && 
kDi¡ªû
 =ğ
Ùh”
.kDistance

67 && 
Œu¡Di¡ªû
 =ğ
Ùh”
.trustDistance

68 && 
dœ
 =ğ
Ùh”
.dir;

72 
	m‹m¶©e
<
şass
 
	mArchive
>

73 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

74 
	m¬
 & 
	m¼
;

75 
	m¬
 & 
	mty³
;

76 
	m¬
 & 
	mimageCoÜds
;

77 
	m¬
 & 
	mwDi¡ªû
;

78 
	m¬
 & 
	mkDi¡ªû
;

79 
	m¬
 & 
	mŒu¡Di¡ªû
;

80 
	m¬
 & 
	mdœ
;

84 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gPo¡Info
& 
	gpo¡Info
) {

85 
	gos
 << 
	gpo¡Info
.
	g¼
;

86 
	gos
 << 
	gpo¡Info
.
	gimageCoÜds
;

87 
	gos
.
wr™e
((*è&(
po¡Info
.
ty³
), (
Po¡Info
::
Ty³
));

88 
	gos
.
wr™e
((*è&(
po¡Info
.
Œu¡Di¡ªû
), (
boŞ
));

90  
	gos
;

93 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gPo¡Info
& 
	gpo¡Info
) {

94 
	gis
 >> 
	gpo¡Info
.
	g¼
;

95 
	gis
 >> 
	gpo¡Info
.
	gimageCoÜds
;

96 
	gis
.
»ad
((*è&(
po¡Info
.
ty³
), (
Po¡Info
::
Ty³
));

97 
	gis
.
»ad
((*è&(
po¡Info
.
Œu¡Di¡ªû
), (
boŞ
));

99  
	gis
;

	@robot/types/RRCoord.hpp

32 #´agm¨
Úû


34 
	~<m©h.h
>

35 
	~<¡ršg.h
>

36 
	~<Eig’/Eig’
>

37 
	~<boo¡/£rŸliz©iÚ/v”siÚ.hµ
>

38 
	~"ty³s/Pošt.hµ
"

40 
	sRRCoÜd
 {

51 
RRCoÜd
(
di¡ªû
, 
h—dšg
 = 
NAN
, 
Ü›Á©iÚ
 = NAN)

52 : 
vec
(
di¡ªû
, 
h—dšg
, 
Ü›Á©iÚ
)

54 
	mv¬
.
£tZ”o
();

57 
Pošt
 
toC¬‹sŸn
() const {

58  
Pošt
(
di¡ªû
()*
cosf
(
h—dšg
()), di¡ªû()*
sšf
(heading()));

61 
RRCoÜd
() {

62 
	mvec
.
£tZ”o
();

63 
	mv¬
.
£tZ”o
();

66 
RRCoÜd
(cÚ¡ RRCoÜd &
Ùh”
) {

67 
	mthis
->
	mvec
 = 
Ùh”
.
vec
;

68 
	mthis
->
	mv¬
 = 
Ùh”
.
v¬
;

71 
	mRRCoÜd
& 
	mİ”©Ü
=(cÚ¡ 
RRCoÜd
 &
Ùh”
) {

72 
i
 = 0; 
	mi
 < 3; i++) {

73 
	mthis
->
vec
(
i
, 0èğ
Ùh”
.vec(i, 0);

75 
	mi
 = 0; i < 9; i++) {

76 
	mthis
->
	mv¬
[
i
] = 
Ùh”
.
v¬
[i];

79  *
	mthis
;

82 
	mEig’
::
VeùÜ3f
 
vec
;

83 
	mEig’
::
M©rix
<, 3, 3> 
	mv¬
;

86 cÚ¡ 
di¡ªû
() const {

87  
	mvec
[0];

90 &
di¡ªû
() {

91  
	mvec
[0];

95 cÚ¡ 
h—dšg
() const {

96  
	mvec
[1];

99 &
h—dšg
() {

100  
	mvec
[1];

104 cÚ¡ 
Ü›Á©iÚ
() const {

105  
	mvec
[2];

108 &
Ü›Á©iÚ
() {

109  
	mvec
[2];

112 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
RRCoÜd
 &
Ùh”
) const {

113  
vec
 =ğ
Ùh”
.vec;

116 
	m‹m¶©e
<
şass
 
	mArchive
>

117 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
);

120 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gRRCoÜd
& 
	gcoÜd
) {

121 
	gi
 = 0; i < 3; i++) {

122 
	ga
 = 
coÜd
.
vec
[
i
];

123 
	gos
.
wr™e
((*è&
a
, ());

126 
	gi
 = 0; i < 9; i++) {

127 
	ga
 = 
coÜd
.
v¬
[
i
];

128 
	gos
.
wr™e
((*è&
a
, ());

130  
	gos
;

133 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gRRCoÜd
& 
	gcoÜd
) {

134 
	gi
 = 0; i < 3; i++) {

135 
	ga
;

136 
	gis
.
»ad
((*è&
a
, ());

137 
	gcoÜd
.
	gvec
[
i
] = 
a
;

140 
	gi
 = 0; i < 9; i++) {

141 
	ga
;

142 
	gis
.
»ad
((*è&
a
, ());

143 
	gcoÜd
.
	gv¬
[
i
] = 
a
;

145  
	gis
;

149 
	mDIST
,

150 
	mHEADING
,

151 
	mORIENTATION
,

152 } 
	tRRCoÜdEnum
;

154 
	~"ty³s/RRCoÜd.tcc
"

	@robot/types/RRCoord.tcc

1 
	g‹m¶©e
<
şass
 
	gArchive
>

2 
	gRRCoÜd
::
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

3 
¬
 & 
vec
;

4 
¬
 & 
v¬
;

5 
	}
}

7 
	~"ty³s/boo¡S”Ÿliz©iÚEig’Ty³s.hµ
"

	@robot/types/RansacTypes.hpp

1 #´agm¨
Úû


3 
	~<m©h.h
>

4 
	~<boo¡/£rŸliz©iÚ/v”siÚ.hµ
>

5 
	~"ty³s/Pošt.hµ
"

7 
	sRANSACLše


9 
Pošt
 
	mp1
, 
	mp2
;

14 
	mt1
, 
	mt2
, 
	mt3
;

15 
	mv¬
;

17 
RANSACLše
(
Pošt
 
p1
, Pošˆ
p2
, 
v¬
 = 0) :…1(p1),…2(p2), var(var)

19 
	mt1
 = 
p2
.
y
(è- 
p1
.y();

20 
	mt2
 = 
p1
.
x
(è- 
p2
.x();

21 
	mt3
 = 
p1
.
y
(è* (
p2
.
x
() -…1.x()) -…1.x() * (p2.y() -…1.y());

24 
RANSACLše
() {};

26 
RANSACLše
(cÚ¡ RANSACLš&
Ùh”
) {

27 
	mthis
->
	mt1
 = 
Ùh”
.
t1
;

28 
	mthis
->
	mt2
 = 
Ùh”
.
t2
;

29 
	mthis
->
	mt3
 = 
Ùh”
.
t3
;

30 
	mthis
->
	mv¬
 = 
Ùh”
.
v¬
;

32 
	mthis
->
p1
(0, 0èğ
Ùh”
.p1(0, 0);

33 
	mthis
->
p1
(1, 0èğ
Ùh”
.p1(1, 0);

34 
	mthis
->
p2
(0, 0èğ
Ùh”
.p2(0, 0);

35 
	mthis
->
p2
(1, 0èğ
Ùh”
.p2(1, 0);

38 
	m‹m¶©e
<
şass
 
	mArchive
>

39 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

41 
	m¬
 & 
	mt1
 & 
	mt2
 & 
	mt3
;

42 
	m¬
 & 
	mv¬
;

43 ià(
	mfe_v”siÚ
 >= 1) {

44 
¬
 & 
p1
 & 
p2
;

46 
	mp1
 = 
Pošt
 (0, 0);

47 
	mp2
 = 
Pošt
 (0, 0);

52 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gRANSACLše
& 
	glše
) {

53 
	gos
 << 
	glše
.
	gp1
;

54 
	gos
 << 
	glše
.
	gp2
;

55 
	gos
.
wr™e
((*è&(
lše
.
t1
), ());

56 
	gos
.
wr™e
((*è&(
lše
.
t2
), ());

57 
	gos
.
wr™e
((*è&(
lše
.
t3
), ());

58 
	gos
.
wr™e
((*è&(
lše
.
v¬
), ());

60  
	gos
;

63 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gRANSACLše
& 
	glše
) {

64 
	gis
 >> 
	glše
.
	gp1
;

65 
	gis
 >> 
	glše
.
	gp2
;

66 
	gis
.
»ad
((*è&(
lše
.
t1
), ());

67 
	gis
.
»ad
((*è&(
lše
.
t2
), ());

68 
	gis
.
»ad
((*è&(
lše
.
t3
), ());

69 
	gis
.
»ad
((*è&(
lše
.
v¬
), ());

71  
	gis
;

74 
BOOST_CLASS_VERSION
(
RANSACLše
, 1);

76 
	sRANSACCœşe


78 
PoštF
 
	mûÁ»
;

79 
	m¿dius
;

80 
	mv¬
;

82 
RANSACCœşe
(
PoštF
 
ûÁ»
, 
¿dius
, 
v¬
 = 0)

83 : 
ûÁ»
(ûÁ»), 
¿dius
Ôadius), 
v¬
(var)

87 
RANSACCœşe
(cÚ¡ 
Pošt
 
p1
, cÚ¡ Pošˆ
p2
, cÚ¡ Pošˆ
p3
, 
v¬
 = 0)

88 : 
v¬
(var)

90 
bx
 = 
p1
.
x
(); 
	mby
 =…1.
y
();

91 
	mcx
 = 
p2
.
x
(); 
	mcy
 =…2.
y
();

92 
	mdx
 = 
p3
.
x
(); 
	mdy
 =…3.
y
();

94 
	m‹mp
 = 
cx
*cx+
cy
*cy;

95 
	mbc
 = (
bx
*bx + 
by
*by - 
‹mp
)/2.0;

96 
	mcd
 = (
‹mp
 - 
dx
*dx - 
dy
*dy)/2.0;

97 
	md‘
 = (
bx
-
cx
)*(
cy
-
dy
)-(cx-
dx
)*(
by
-cy);

99 
	mûÁ»
 = 
PoštF
();

100 
	m¿dius
 = 0;

102 ià(
çbs
(
d‘
) < 1.0e-6) {

103 
	mthis
->
	m¿dius
 = 
¡d
::
num”ic_lim™s
<>::
qu›t_NaN
();

107 
	md‘
 = 1 / 
d‘
;

108 
	mûÁ»
.
x
(èğ(
bc
*(
cy
-
dy
)-
cd
*(
by
-cy))*
d‘
;

109 
	mûÁ»
.
y
(èğ((
bx
-
cx
)*
cd
-(cx-
dx
)*
bc
)*
d‘
;

110 
	mcx
 = 
ûÁ»
.
x
(); 
	mcy
 = c’Œe.
y
();

111 
	m¿dius
 = 
sq¹
((
cx
-
bx
)*(cx-bx)+(
cy
-
by
)*(cy-by));

114 
RANSACCœşe
(cÚ¡ 
Pošt
 
p1
, cÚ¡ Pošˆ
p2
, 
¿dius
, 
v¬
 = 0)

115 : 
¿dius
Ôadius), 
v¬
(var)

129 
	mûÁ»
 = 
PoštF
();

130 ià(
	mp1
 =ğ
p2
) {

131 
this
->
¿dius
 = 
¡d
::
num”ic_lim™s
<>::
qu›t_NaN
();

135 cÚ¡ 
	mx1
 = 
p1
.
x
(), 
	mx2
 = 
p2
.x(), 
	my1
 =…1.
y
(), 
	my2
 =…2.y();

136 ià(
	my1
 !ğ
y2
) {

137 cÚ¡ 
k1
 = (
x2
 - 
x1
è/ (
y1
 - 
y2
);

138 cÚ¡ 
	mk2
 = (
x1
*x1 + 
y1
*y1 - 
x2
*x2 - 
y2
*y2) / (2*(y1 - y2));

140 cÚ¡ 
	ma
 = 1 + 
k1
*k1;

141 cÚ¡ 
	mb
 = -2*
x1
 + 2*(
k1
*(
k2
 - 
y1
));

142 cÚ¡ 
	mc
 = 
x1
*x1 + (
k2
 - 
y1
)*(k2 - y1è- 
¿dius
*radius;

143 cÚ¡ 
	md
 = 
b
*b - 4*
a
*
c
;

145 ià(
	md
 < 0) {

146 
	mthis
->
	m¿dius
 = 
¡d
::
num”ic_lim™s
<>::
qu›t_NaN
();

150 cÚ¡ 
	mx
 = (-
b
 + (
y1
 > 
y2
 ? 
sq¹f
(
d
è: -sq¹f(d))è/ (2*
a
);

151 cÚ¡ 
	my
 = 
k1
*
x
 + 
k2
;

152 
	mûÁ»
.
x
() = x;

153 
	mûÁ»
.
y
() = y;

156 cÚ¡ 
	mk1
 = (
y2
 - 
y1
è/ (
x1
 - 
x2
);

157 cÚ¡ 
	mk2
 = (
y1
*y1 + 
x1
*x1 - 
y2
*y2 - 
x2
*x2) / (2*(x1 - x2));

159 cÚ¡ 
	ma
 = 1 + 
k1
*k1;

160 cÚ¡ 
	mb
 = -2*
y1
 + 2*(
k1
*(
k2
 - 
x1
));

161 cÚ¡ 
	mc
 = 
y1
*y1 + (
k2
 - 
x1
)*(k2 - x1è- 
¿dius
*radius;

162 cÚ¡ 
	md
 = 
b
*b - 4*
a
*
c
;

164 ià(
	md
 < 0) {

165 
	mthis
->
	m¿dius
 = 
¡d
::
num”ic_lim™s
<>::
qu›t_NaN
();

169 cÚ¡ 
	mx
 = (-
b
 + (
x1
 > 
x2
 ? 
sq¹f
(
d
è: -sq¹f(d))è/ (2*
a
);

170 cÚ¡ 
	my
 = 
k1
*
x
 + 
k2
;

171 
	mûÁ»
.
x
() = x;

172 
	mûÁ»
.
y
() = y;

176 
RANSACCœşe
() {};

178 
	m‹m¶©e
<
şass
 
	mArchive
>

179 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
)

181 
	m¬
 & 
	mûÁ»
;

182 
	m¬
 & 
	m¿dius
;

183 
	m¬
 & 
	mv¬
;

188 
BOOST_CLASS_VERSION
(
RANSACCœşe
, 0);

	@robot/types/RobotInfo.cpp

1 
	~"RobÙInfo.hµ
"

4 cÚ¡ *cÚ¡ 
	gRobÙInfo
::
Ty³Name
[] =

	@robot/types/RobotInfo.hpp

1 #iâdeà
ROBOT_INFO_HPP


2 
	#ROBOT_INFO_HPP


	)

4 
	~"ty³s/Pošt.hµ
"

5 
	~"ty³s/RRCoÜd.hµ
"

6 
	~"ty³s/BBox.hµ
"

8 
	sRobÙInfo
 {

10 
	eTy³


12 
	mrUnknown
 = 0x00,

13 
	mrBlue
 = 0x01,

14 
	mrRed
 = 0x02,

17 
	eCam”as


19 
	mTOP_CAMERA
,

20 
	mBOT_CAMERA
,

21 
	mBOTH_CAMERAS
,

22 
	mOLD_DETECTION


26 cÚ¡ *cÚ¡ 
	mTy³Name
[];

28 
RobÙInfo
 () :

29 
¼
(),

30 
ty³
(
rUnknown
),

31 
ÿm”as
(
BOTH_CAMERAS
),

32 
tİImageCoÜds
(),

33 
bÙImageCoÜds
()

36 
RobÙInfo
 (
RRCoÜd
 
¼
, 
Ty³
 
ty³
, 
BBox
 
imageCoÜds
) :

37 
¼
(rr),

38 
ty³
(type),

39 
ÿm”as
(
OLD_DETECTION
),

40 
imageCoÜds
(imageCoords),

41 
tİImageCoÜds
(),

42 
bÙImageCoÜds
() {}

44 
RobÙInfo
 (
RRCoÜd
 
¼
, 
Ty³
 
ty³
, 
BBox
 
tİImageCoÜds
, BBox 
bÙImageCoÜds
) :

45 
¼
(rr),

46 
ty³
(type),

47 
ÿm”as
(
BOTH_CAMERAS
),

48 
tİImageCoÜds
(topImageCoords),

49 
bÙImageCoÜds
(botImageCoords){}

51 
RobÙInfo
 (
RRCoÜd
 
¼
, 
Ty³
 
ty³
, 
BBox
 
imageCoÜds
, 
Cam”as
 
ÿm”as
) :

52 
¼
(rr),

53 
ty³
(type),

54 
ÿm”as
(cameras),

55 
tİImageCoÜds
(),

56 
bÙImageCoÜds
() {

57 ià(
	mÿm”as
 =ğ
TOP_CAMERA
) {

58 
tİImageCoÜds
 = 
imageCoÜds
;

59 } ià(
	mÿm”as
 =ğ
BOT_CAMERA
) {

60 
bÙImageCoÜds
 = 
imageCoÜds
;

61 } ià(
	mÿm”as
 =ğ
BOTH_CAMERAS
) {

67 
	mvœtu®
 ~
RobÙInfo
 () {}

69 
RRCoÜd
 
	m¼
;

70 
Ty³
 
	mty³
;

71 
Cam”as
 
	mÿm”as
;

73 
BBox
 
	mimageCoÜds
;

75 
BBox
 
	mtİImageCoÜds
;

76 
BBox
 
	mbÙImageCoÜds
;

79 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
RobÙInfo
 &
Ùh”
) const {

80  
¼
 =ğ
Ùh”
.rr;

83 
	m‹m¶©e
<
şass
 
	mArchive
>

84 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

85 
	m¬
 & 
	m¼
;

86 
	m¬
 & 
	mty³
;

87 
	m¬
 & 
	mÿm”as
;

88 
	m¬
 & 
	mimageCoÜds
;

89 
	m¬
 & 
	mtİImageCoÜds
;

90 
	m¬
 & 
	mbÙImageCoÜds
;

	@robot/types/RobotObstacle.hpp

8 #´agm¨
Úû


10 
	~"RobÙInfo.hµ
"

11 
	~"AbsCoÜd.hµ
"

12 
	~"RRCoÜd.hµ
"

14 
	sRobÙOb¡aşe
 {

15 
RRCoÜd
 
	m¼
;

16 
	mRobÙInfo
::
Ty³
 
ty³
;

17 
AbsCoÜd
 
	m¼c
;

18 
AbsCoÜd
 
	mpos
;

20 
	mng’tH—dšgLeá
;

21 
	mng’tH—dšgRight
;

24 
RRCoÜd
 
	mevadeVeùÜLeá
;

25 
RRCoÜd
 
	mevadeVeùÜRight
;

27 
	mvœtu®
 ~
RobÙOb¡aşe
 () {}

29 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
RobÙOb¡aşe
 &
Ùh”
) const {

30  
¼
 =ğ
Ùh”
.rr;

33 
	m‹m¶©e
<
şass
 
	mArchive
>

34 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

35 
	m¬
 & 
	m¼
;

36 
	m¬
 & 
	mty³
;

37 
	m¬
 & 
	m¼c
;

38 
	m¬
 & 
	mpos
;

39 
	m¬
 & 
	mng’tH—dšgLeá
;

40 
	m¬
 & 
	mng’tH—dšgRight
;

41 
	m¬
 & 
	mevadeVeùÜLeá
;

42 
	m¬
 & 
	mevadeVeùÜRight
;

	@robot/types/SPLStandardMessage.hpp

1 #iâdeà
SPLSTANDARDMESSAGE_H


2 
	#SPLSTANDARDMESSAGE_H


	)

4 
	~<¡dšt.h
>

5 
	~"ty³s/Brßdÿ¡D©a.hµ
"

7 
	#SPL_STANDARD_MESSAGE_STRUCT_HEADER
 "SPL "

	)

8 
	#SPL_STANDARD_MESSAGE_STRUCT_VERSION
 6

	)

9 
	#SPL_STANDARD_MESSAGE_DATA_SIZE
 780

	)

10 
	#SPL_STANDARD_MESSAGE_MAX_NUM_OF_PLAYERS
 5

	)

25 
	sSPLSnd¬dMes§ge


27 
	mh—d”
[4];

28 
ušt8_t
 
	mv”siÚ
;

29 
št8_t
 
	m¶ay”Num
;

30 
št8_t
 
	m‹amNum
;

31 
št8_t
 
	mçÎ’
;

40 
	mpo£
[3];

46 
	mw®kšgTo
[2];

52 
	mshoÙšgTo
[2];

55 
	mb®lAge
;

62 
	mb®l
[2];

66 
	mb®lV–
[2];

78 
št8_t
 
	msugge¡iÚ
[
SPL_STANDARD_MESSAGE_MAX_NUM_OF_PLAYERS
];

87 
št8_t
 
	mš‹ÁiÚ
;

94 
št16_t
 
	mav”ageW®kS³ed
;

101 
št16_t
 
	mmaxKickDi¡ªû
;

107 
št8_t
 
	mcu¼’tPos™iÚCÚfid’û
;

113 
št8_t
 
	mcu¼’tSideCÚfid’û
;

116 
ušt16_t
 
	mnumOfD©aBy‹s
;

119 
ušt8_t
 
	md©a
[
SPL_STANDARD_MESSAGE_DATA_SIZE
];

121 #ifdeà
__ılu¥lus


123 
SPLSnd¬dMes§ge
() :

124 
v”siÚ
(
SPL_STANDARD_MESSAGE_STRUCT_VERSION
),

125 
¶ay”Num
(-1),

126 
‹amNum
(-1),

127 
çÎ’
(-1),

128 
b®lAge
(-1.f),

129 
š‹ÁiÚ
(-1),

130 
av”ageW®kS³ed
(-1),

131 
maxKickDi¡ªû
(-1),

132 
cu¼’tPos™iÚCÚfid’û
(-1),

133 
cu¼’tSideCÚfid’û
(-1),

134 
numOfD©aBy‹s
(0)

136 cÚ¡ * 
	mš™
 = 
SPL_STANDARD_MESSAGE_STRUCT_HEADER
;

137 
	mi
 = 0; i < (
	mh—d”
); ++i)

138 
	mh—d”
[
i
] = 
š™
[i];

139 
	mpo£
[0] = 0.f;

140 
	mpo£
[1] = 0.f;

141 
	mpo£
[2] = 0.f;

142 
	mw®kšgTo
[0] = 0.f;

143 
	mw®kšgTo
[1] = 0.f;

144 
	mshoÙšgTo
[0] = 0.f;

145 
	mshoÙšgTo
[1] = 0.f;

146 
	mb®l
[0] = 0.f;

147 
	mb®l
[1] = 0.f;

148 
	mb®lV–
[0] = 0.f;

149 
	mb®lV–
[1] = 0.f;

150 
	mi
 = 0; i < 
	mSPL_STANDARD_MESSAGE_MAX_NUM_OF_PLAYERS
; ++i)

151 
	msugge¡iÚ
[
i
] = 0;

154 
SPLSnd¬dMes§ge
(cÚ¡ &
¶ay”Num
,

155 cÚ¡ &
‹amNum
,

156 cÚ¡ &
çÎ’
,

157 cÚ¡ 
AbsCoÜd
 &
robÙPos
,

158 cÚ¡ 
AbsCoÜd
 &
w®kšg
,

159 cÚ¡ 
AbsCoÜd
 &
shoÙšg
,

160 cÚ¡ &
b®lAge
,

161 cÚ¡ 
AbsCoÜd
 &
b®lPos™iÚ
,

162 cÚ¡ 
AbsCoÜd
 &
b®lV–oc™y
,

163 cÚ¡ 
št8_t
 
š‹ÁiÚ
,

164 cÚ¡ 
Brßdÿ¡D©a
 &
brßdÿ¡
)

165 : 
¶ay”Num
(playerNum),

166 
‹amNum
(teamNum),

167 
çÎ’
(fallen),

168 
b®lAge
(ballAge),

169 
š‹ÁiÚ
(intention),

170 
av”ageW®kS³ed
(200),

171 
maxKickDi¡ªû
(8000),

172 
cu¼’tPos™iÚCÚfid’û
(50),

173 
cu¼’tSideCÚfid’û
(50) {

175 cÚ¡ * 
	mš™
 = 
SPL_STANDARD_MESSAGE_STRUCT_HEADER
;

176 
	mi
 = 0; i < (
	mh—d”
); ++i)

177 
	mh—d”
[
i
] = 
š™
[i];

178 
	mv”siÚ
 = 
SPL_STANDARD_MESSAGE_STRUCT_VERSION
;

180 
	mpo£
[0] = 
robÙPos
.
x
();

181 
	mpo£
[1] = 
robÙPos
.
y
();

182 
	mpo£
[2] = 
robÙPos
.
th‘a
();

184 
	mw®kšgTo
[0] = 
w®kšg
.
x
();

185 
	mw®kšgTo
[1] = 
w®kšg
.
y
();

187 
	mshoÙšgTo
[0] = 
shoÙšg
.
x
();

188 
	mshoÙšgTo
[1] = 
shoÙšg
.
y
();

190 
AbsCoÜd
 
	mb®lPosRR
 = 
b®lPos™iÚ
.
cÚv”tToRobÙR–©iveC¬‹sŸn
(
robÙPos
);

191 
	mb®l
[0] = 
b®lPosRR
.
x
();

192 
	mb®l
[1] = 
b®lPosRR
.
y
();

193 
	mb®lV–
[0] = 
b®lV–oc™y
.
x
();

194 
	mb®lV–
[1] = 
b®lV–oc™y
.
y
();

196 
	mi
 = 0; i < 
	mSPL_STANDARD_MESSAGE_MAX_NUM_OF_PLAYERS
; ++i)

197 
	msugge¡iÚ
[
i
] = 0;

200 
	mnumOfD©aBy‹s
 = (
brßdÿ¡
);

201 
as£¹
(
numOfD©aBy‹s
 <ğ
SPL_STANDARD_MESSAGE_DATA_SIZE
);

202 ià(
	mnumOfD©aBy‹s
 > 
	mSPL_STANDARD_MESSAGE_DATA_SIZE
)

204 
	m¡d
::
cout
 << "Brßdÿ¡D©¨i toØbig! SPL Snd¬d Mes§gd©¨sizi " << 
SPL_STANDARD_MESSAGE_DATA_SIZE
 << "‡nd Brßdÿ¡D©¨i " << 
numOfD©aBy‹s
 << 
¡d
::
’dl
;

206 
memıy
(
d©a
, &
brßdÿ¡
, 
numOfD©aBy‹s
);

209 
	m‹m¶©e
<
şass
 
	mArchive
>

210 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

211 
	m¬
 & 
	mh—d”
;

212 
	m¬
 & 
	mv”siÚ
;

213 
	m¬
 & 
	m¶ay”Num
;

214 
	m¬
 & 
	m‹amNum
;

215 
	m¬
 & 
	mçÎ’
;

216 
	m¬
 & 
	mpo£
;

217 
	m¬
 & 
	mw®kšgTo
;

218 
	m¬
 & 
	mshoÙšgTo
;

219 
	m¬
 & 
	mb®lAge
;

220 
	m¬
 & 
	mb®l
;

221 
	m¬
 & 
	mb®lV–
;

222 
	m¬
 & 
	msugge¡iÚ
;

223 
	m¬
 & 
	mš‹ÁiÚ
;

224 
	m¬
 & 
	mav”ageW®kS³ed
;

225 
	m¬
 & 
	mmaxKickDi¡ªû
;

226 
	m¬
 & 
	mcu¼’tPos™iÚCÚfid’û
;

227 
	m¬
 & 
	mcu¼’tSideCÚfid’û
;

228 
	m¬
 & 
	mnumOfD©aBy‹s
;

229 
	m¬
 & 
	md©a
;

	@robot/types/SensorValues.hpp

32 #´agm¨
Úû


34 
	~"uts/body.hµ
"

35 
	~"ty³s/JoštV®ues.hµ
"

41 
	sS’sÜV®ues
 {

42 
S’sÜV®ues
() {

43 
	mi
 = 0; i < 
	mS’sÜs
::
NUMBER_OF_SENSORS
; ++i) {

44 
	m£nsÜs
[
i
] = 
NAN
;

46 
	mi
 = 0; i < 
	mSÚ¬
::
NUMBER_OF_READINGS
; ++i) {

47 
	msÚ¬
[
i
] = 
NAN
;

51 
S’sÜV®ues
(
boŞ
 
z”o
) {

52 
	mjošts
 = 
JoštV®ues
(
Œue
);

53 
	mi
 = 0; i < 
	mS’sÜs
::
NUMBER_OF_SENSORS
; ++i) {

54 
	m£nsÜs
[
i
] = 0;

56 
	mi
 = 0; i < 
	mSÚ¬
::
NUMBER_OF_READINGS
; ++i) {

57 
	msÚ¬
[
i
] = 0;

61 
JoštV®ues
 
	mjošts
;

62 
	m£nsÜs
[
S’sÜs
::
NUMBER_OF_SENSORS
];

63 
	msÚ¬
[
SÚ¬
::
NUMBER_OF_READINGS
];

65 
	m‹m¶©e
<
şass
 
	mArchive
>

66 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

67 
	m¬
 & 
	mjošts
;

68 
	m¬
 & 
	m£nsÜs
;

69 
	m¬
 & 
	msÚ¬
;

	@robot/types/TeamBallInfo.cpp

1 
	~"T—mB®lInfo.hµ
"

4 cÚ¡ *cÚ¡ 
	gT—mB®lInfo
::
StusName
[] =

	@robot/types/TeamBallInfo.hpp

32 #´agm¨
Úû


34 
	~"ty³s/AbsCoÜd.hµ
"

36 
	sT—mB®lInfo


38 
	eStus


40 
	mtNeuŒ®
,

41 
	mtAg»e
,

42 
	mtDi§g»e


46 cÚ¡ *cÚ¡ 
	mStusName
[];

48 
T—mB®lInfo
 (è: 
pos
(
NAN
, NAN, NAN), 
¡©us
(
tNeuŒ®
), 
cÚŒibutÜs
(0) {}

49 
T—mB®lInfo
 (
AbsCoÜd
 
pos
, 
Stus
 
¡©us
, 
cÚŒibutÜs
) :

50 
pos
(pos),

51 
¡©us
(status),

52 
cÚŒibutÜs
(contributors) {}

54 
	mvœtu®
 ~
T—mB®lInfo
 () {}

56 
AbsCoÜd
 
	mpos
;

57 
Stus
 
	m¡©us
;

58 
	mcÚŒibutÜs
;

60 
	m‹m¶©e
<
şass
 
	mArchive
>

61 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

62 
	m¬
 & 
	mpos
;

63 
	m¬
 & 
	m¡©us
;

64 
	m¬
 & 
	mcÚŒibutÜs
;

	@robot/types/VisionBlackboardInfo.hpp

1 #iâdeà
VISION_BLACKBOARD_INFO_HPP


2 
	#VISION_BLACKBOARD_INFO_HPP


	)

4 
	~"ty³s/Cam”aS‘tšgs.hµ
"

6 
	sVisiÚBÏckbßrdInfo
 {

7 
ušt8_t
 cÚ¡* 
	mtİ_äame
;

8 
ušt8_t
 cÚ¡* 
	mbÙ_äame
;

9 
Cam”aS‘tšgs
 
	mtİ_ÿm”a_£‰šgs
;

10 
Cam”aS‘tšgs
 
	mbÙ_ÿm”a_£‰šgs
;

	@robot/types/XYZ_Coord.hpp

32 #´agm¨
Úû


34 
	~<cm©h
>

35 
	~<io¡»am
>

37 şas 
	cXYZ_CoÜd
 {

38 
	mpublic
:

39 
x
, 
	my
, 
	mz
;

41 
	$XYZ_CoÜd
() {

42 
x
 = 0;

43 
y
 = 0;

44 
z
 = 0;

47 
	$XYZ_CoÜd
(
nx
, 
ny
, 
nz
) {

48 
x
 = 
nx
;

49 
y
 = 
ny
;

50 
z
 = 
nz
;

51 
	}
}

53 
šlše
 
	$rÙ©eXY
(
th‘a
) {

54 cÚ¡ 
lx
 = 
x
;

55 cÚ¡ 
ly
 = 
y
;

57 cÚ¡ 
sšt
 = 
	`sš
(
th‘a
);

58 cÚ¡ 
co¡
 = 
	`cos
(
th‘a
);

60 
y
 = 
ly
 * 
co¡
 - 
lx
 * 
sšt
;

61 
x
 = 
ly
 * 
sšt
 + 
lx
 * 
co¡
;

62 
	}
}

64 
šlše
 
	$rÙ©eYZ
(
th‘a
) {

65 cÚ¡ 
ly
 = 
y
;

66 cÚ¡ 
lz
 = 
z
;

68 cÚ¡ 
sšt
 = 
	`sš
(
th‘a
);

69 cÚ¡ 
co¡
 = 
	`cos
(
th‘a
);

71 
y
 = 
ly
 * 
co¡
 - 
lz
 * 
sšt
;

72 
z
 = 
ly
 * 
sšt
 + 
lz
 * 
co¡
;

73 
	}
}

75 
šlše
 
	$rÙ©eXZ
(
th‘a
) {

76 cÚ¡ 
lx
 = 
x
;

77 cÚ¡ 
lz
 = 
z
;

79 cÚ¡ 
sšt
 = 
	`sš
(
th‘a
);

80 cÚ¡ 
co¡
 = 
	`cos
(
th‘a
);

82 
x
 = 
lx
 * 
co¡
 - 
lz
 * 
sšt
;

83 
z
 = 
lx
 * 
sšt
 + 
lz
 * 
co¡
;

84 
	}
}

86 
šlše
 
	$add
(cÚ¡ 
XYZ_CoÜd
 &
İt
) {

87 
x
 +ğ
İt
.x;

88 
y
 +ğ
İt
.y;

89 
z
 +ğ
İt
.z;

90 
	}
}

92 
šlše
 
	$sub
(cÚ¡ 
XYZ_CoÜd
 &
İt
) {

93 
x
 -ğ
İt
.x;

94 
y
 -ğ
İt
.y;

95 
z
 -ğ
İt
.z;

96 
	}
}

98 
šlše
 
	$addMuÉ
(cÚ¡ 
XYZ_CoÜd
 &
İt
, 
muÉ
) {

99 
x
 +ğ
İt
.x * 
muÉ
;

100 
y
 +ğ
İt
.y * 
muÉ
;

101 
z
 +ğ
İt
.z * 
muÉ
;

102 
	}
}

104 
šlše
 
	$nÜm®ize
() {

105 
di¡
 = 
	`sq¹
(
x
 * x + 
y
 * y + 
z
 * z);

107 ià(
di¡
 != 0) {

108 
x
 = x / 
di¡
;

109 
y
 = y / 
di¡
;

110 
z
 = z / 
di¡
;

112 
	}
}

114 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
XYZ_CoÜd
 &
Ùh”
) const {

115  
x
 =ğ
Ùh”
.x && 
y
 =ğÙh”.y && 
z
 == other.z;

118 
	g‹m¶©e
<
şass
 
	gArchive
>

119 
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

120 
¬
 & 
x
;

121 
¬
 & 
y
;

122 
¬
 & 
z
;

123 
	}
}

126 
šlše
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gXYZ_CoÜd
& 
	gcoÜd
) {

127 
	gos
 << 
	gcoÜd
.
	gx
 << " " << coÜd.
	gy
 << " " << coÜd.
	gz
 << 
	g¡d
::
’dl
;

128  
	gos
;

131 
šlše
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
is
, 
	gXYZ_CoÜd
& 
	gcoÜd
) {

132 
	gis
 >> 
	gcoÜd
.
	gx
;

133 
	gis
 >> 
	gcoÜd
.
	gy
;

134 
	gis
 >> 
	gcoÜd
.
	gz
;

136  
	gis
;

139 
šlše
 
XYZ_CoÜd
 
	$rÙ©eCİyXY
(cÚ¡ 
XYZ_CoÜd
 &
xyz
, 
th‘a
) {

140 
XYZ_CoÜd
 
»suÉ
 = 
xyz
;

141 
»suÉ
.
	`rÙ©eXY
(
th‘a
);

142  
»suÉ
;

143 
	}
}

145 
šlše
 
XYZ_CoÜd
 
	$addCİy
(cÚ¡ 
XYZ_CoÜd
 &
A
, cÚ¡ XYZ_CoÜd &
B
) {

146 
XYZ_CoÜd
 
»suÉ
 = 
A
;

147 
»suÉ
.
	`add
(
B
);

148  
»suÉ
;

149 
	}
}

151 
šlše
 
XYZ_CoÜd
 
	$subCİy
(cÚ¡ 
XYZ_CoÜd
 &
A
, cÚ¡ XYZ_CoÜd &
B
) {

152 
XYZ_CoÜd
 
»suÉ
 = 
A
;

153 
»suÉ
.
	`sub
(
B
);

154  
»suÉ
;

155 
	}
}

	@robot/types/boostSerializationEigenTypes.hpp

1 #´agm¨
Úû


3 
	~<Eig’/Eig’
>

5 
Çme¥aû
 
	gboo¡
 {

6 
Çme¥aû
 
	g£rŸliz©iÚ
 {

7 
	g‹m¶©e
<
şass
 
	gArchive
>

8 
£rŸlize
(
Archive
 &
¬
, 
Eig’
::
VeùÜ3f
 &
vec
, cÚ¡ 
v”siÚ
) {

9 
	g¬
 & 
	gvec
[0];

10 
	g¬
 & 
	gvec
[1];

11 
	g¬
 & 
	gvec
[2];

14 
	g‹m¶©e
<
şass
 
	gArchive
>

15 
£rŸlize
(
Archive
 &
¬
, 
Eig’
::
M©rix
<, 3, 3> &
v¬
, cÚ¡ 
v”siÚ
) {

16 
	g¬
 & 
v¬
(0, 0);‡r & var(0, 1);‡r & var(0, 2);

17 
	g¬
 & 
v¬
(1, 0);‡r & var(1, 1);‡r & var(1, 2);

18 
	g¬
 & 
v¬
(2, 0);‡r & var(2, 1);‡r & var(2, 2);

21 
	g‹m¶©e
<
şass
 
	gArchive
>

22 
£rŸlize
(
Archive
 &
¬
, 
Eig’
::
M©rix
<, 7, 1> &
vec
, cÚ¡ 
v”siÚ
) {

23 
	gi
 = 0; i < 7; i++) {

24 
	g¬
 & 
	gvec
[
i
];

28 
	g‹m¶©e
<
şass
 
	gArchive
>

29 
£rŸlize
(
Archive
 &
¬
, 
Eig’
::
M©rix
<, 7, 7> &
v¬
, cÚ¡ 
v”siÚ
) {

30 
	grow
 = 0;„ow < 7;„ow++) {

31 
	gcŞ
 = 0; col < 7; col++) {

32 
	g¬
 & 
v¬
(
row
, 
cŞ
);

	@robot/utils/BresenhamPtr.hpp

6 
	~"ty³s/Pošt.hµ
"

7 
	~<m©h.h
>

9 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

10 şas 
	cB»£nhamPŒ


12 
	mpublic
:

27 
	$B»£nhamPŒ
(
T
 *
d©a
, 
Pošt
 
¡¬t
, Pošˆ
’d
, 
size_t
 
¡•
è: 
	$¡¬t
(
¡¬t
)

30 
x
, 
y
;

33 
y
 = 
’d
.
	`x
(è- 
¡¬t
.x();

34 
x
 = 
’d
.
	`y
(è- 
¡¬t
.y();

36 ià(
x
 > 0) {

37 
dx
 = 
x
;

38 
šcx
 = 1;

40 
dx
 = -
x
;

41 
šcx
 = -1;

44 ià(
y
 > 0) {

45 
dy
 = 
y
;

46 
šcy
 = 
¡•
;

48 
dy
 = -
y
;

49 
šcy
 = -
¡•
;

52 ià(
dx
 >ğ
dy
) {

53 
dy
 <<= 1;

54 
b®ªû
 = 
dy
 - 
dx
;

55 
dx
 <<= 1;

57 
dx
 <<= 1;

58 
b®ªû
 = 
dx
 - 
dy
;

59 
dy
 <<= 1;

62 
¡¬t_±r
 = 
d©a
 + 
¡¬t
.
	`x
(è* 
¡•
 + s¹.
	`y
();

63 
’d_±r
 = 
d©a
 + 
’d
.
	`x
(è* 
¡•
 +ƒnd.
	`y
();

66 şas 
	c™”©Ü


68 
public
:

69 
™”©Ü
 &
İ”©Ü
 ++()

71 ià(
dx
 >ğ
dy
) {

72 ià(
b®ªû
 >= 0) {

73 
±r
 +ğ
šcy
;

74 
b®ªû
 -ğ
dx
;

75 ià(
šcy
 >= 0) {

76 ++ 
p
.
	`x
();

78 -- 
p
.
	`x
();

81 
±r
 +ğ
šcx
;

82 
b®ªû
 +ğ
dy
;

83 ià(
šcx
 >= 0) {

84 ++ 
p
.
	`y
();

86 -- 
p
.
	`y
();

89 ià(
b®ªû
 >= 0) {

90 
±r
 +ğ
šcx
;

91 
b®ªû
 -ğ
dy
;

92 ià(
šcx
 >= 0) {

93 ++ 
p
.
	`y
();

95 -- 
p
.
	`y
();

98 
±r
 +ğ
šcy
;

99 
b®ªû
 +ğ
dx
;

100 ià(
šcy
 >= 0) {

101 ++ 
p
.
	`x
();

103 -- 
p
.
	`x
();

106  *
this
;

109 
boŞ
 
İ”©Ü
 ==(cÚ¡ 
™”©Ü
 &
o
)

111  
±r
 =ğ
o
.ptr;

114 
boŞ
 
İ”©Ü
 ==(
T
 *
İŒ
)

116  
±r
 =ğ
İŒ
;

119 
boŞ
 
İ”©Ü
 !=(cÚ¡ 
™”©Ü
 &
o
)

121  ! (
±r
 =ğ
o
.ptr);

124 
boŞ
 
İ”©Ü
 !=(
T
 *
İŒ
)

126  ! (
±r
 =ğ
İŒ
);

130 
T
 
İ”©Ü
 *()

132  *
±r
;

135 
T
* 
İ”©Ü
 ->()

137  
	`g‘
();

140 
T
* 
	`g‘
()

142  
±r
;

145 
Pošt
 
	`pošt
() const

147  
p
;

150 
	`™”©Ü
() {}

152 
´iv©e
:

153 
	`™”©Ü
(
T
 *
±r
, 
Pošt
 
p
, 
dx
, 
dy
, 
šcx
, 
šcy
, 
b®ªû
)

154 : 
	`±r
(
±r
), 
	`s
ÕŒ), 
	`p
(
p
), 
	`dx
(
dx
), 
	`dy
(
dy
),

155 
	`šcx
(
šcx
), 
	`šcy
(
šcy
), 
	`b®ªû
(
b®ªû
)

158 
T
 *
±r
, *
s
;

159 
Pošt
 
p
;

160 
dx
, 
dy
;

161 
šcx
, 
šcy
;

162 
b®ªû
;

164 
ä›nd
 
şass
 
B»£nhamPŒ
;

165 
	}
};

167 
™”©Ü
 
	$begš
()

169  
	`™”©Ü
(
¡¬t_±r
, 
¡¬t
, 
dx
, 
dy
, 
šcx
, 
šcy
, 
b®ªû
);

170 
	}
}

177 
T
 *
	$’d
()

179  
’d_±r
;

180 
	}
}

182 
	g´iv©e
:

183 
T
 *
¡¬t_±r
, *
	g’d_±r
;

184 
Pošt
 
	g¡¬t
;

185 
	gdx
, 
	gdy
;

186 
	gšcx
, 
	gšcy
;

187 
	gb®ªû
;

	@robot/utils/Cluster.cpp

4 
	~"Clu¡”.hµ
"

7 
Çme¥aû
 
	gClu¡”šg
{

13 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gPoštND
& 
	gp
){

15 
BOOST_FOREACH
(
PoštND
::
v®ue_ty³
 
d
, 
p
){ 
	gos
 << 
	gd
 << " "; }

16  
	gos
;

22 
Di¡ªû
 
di¡ªû
(cÚ¡ 
PoštND
& 
x
, cÚ¡ PoštND& 
y
)

24 
Di¡ªû
 
	gtÙ®
 = 0.0;

25 
Di¡ªû
 
	gdiff
;

27 
	gPoštND
::
cÚ¡_™”©Ü
 
ıx
=
x
.
begš
();

28 
	gPoštND
::
cÚ¡_™”©Ü
 
ıy
=
y
.
begš
();

29 
	gPoštND
::
cÚ¡_™”©Ü
 
ıx_’d
=
x
.
’d
();

30 ;
	gıx
!=
ıx_’d
;++ıx,++
	gıy
){

31 
	gdiff
 = *
ıx
 - *
ıy
;

32 
	gtÙ®
 +ğ(
diff
 * diff);

34  
	gtÙ®
;

40 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gPošts
& 
	gıs
){

41 
BOOST_FOREACH
(
Pošts
::
v®ue_ty³
 
p
, 
ıs
){ 
	gos
<<
	gp
 <<
	g¡d
::
’dl
;}

42  
	gos
;

48 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gS‘Pošts
 & 
	g¥
){

50 
BOOST_FOREACH
(
S‘Pošts
::
v®ue_ty³
 
pid
, 
¥
){

51 
	gos
 << "pid=" << 
	gpid
 << " " ;

53  
	gos
;

59 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gClu¡”sToPošts
 & 
	gı
){

60 
Clu¡”Id
 
	gcid
 = 0;

61 
BOOST_FOREACH
(
Clu¡”sToPošts
::
v®ue_ty³
 
£t
, 
ı
){

62 
	gos
 << "şu¡”id[" << 
	gcid
 << "]" << "=(" << 
	g£t
 << ")" << 
	g¡d
::
’dl
;

63 
	gcid
++;

65  
	gos
;

71 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gPoštsToClu¡”s
 & 
	gpc
){

72 
PoštId
 
	gpid
 = 0;

73 
BOOST_FOREACH
(
PoštsToClu¡”s
::
v®ue_ty³
 
cid
, 
pc
){

75 
	g¡d
::
cout
 << "pid[" << 
pid
 << "]=" << 
cid
 << 
¡d
::
’dl
;

76 
	gpid
 ++;

78  
	gos
;

85 
	gPoštsS·û
::
š™_pošts
() {

87 
PoštId
 
i
=0; 
	gi
 < 
	gnum_pošts__
; i++){

88 
PoštND
 
	gp
;

89 
¤ªd
 ( 
time
(
NULL
) );

90 
Dim’siÚs
 
	gd
=0 ; d < 
	gnum_dim’siÚs__
; d++)

91 { 
	gp
.
push_back
Ğ
¿nd
() % 100 ); }

92 
	gpošts__
.
push_back
(
p
);

99 
	gClu¡”s
::
z”o_ûÁroids
() {

101 
BOOST_FOREACH
(
C’Œoids
::
v®ue_ty³
& 
ûÁroid
, 
ûÁroids__
){

102 
BOOST_FOREACH
(
PoštND
::
v®ue_ty³
& 
d
, 
ûÁroid
){

103 
	gd
 = 0.0;

111 
boŞ
 
	gClu¡”s
::
compu‹_ûÁroids
() {

113 
Dim’siÚs
 
i
;

114 
Clu¡”Id
 
	gcid
 = 0;

115 
PoštId
 
	gnum_pošts_š_şu¡”
;

116 
z”o_ûÁroids
();

119 
BOOST_FOREACH
(
C’Œoids
::
v®ue_ty³
& 
ûÁroid
, 
ûÁroids__
){

121 
	gnum_pošts_š_şu¡”
 = 0;

124 
BOOST_FOREACH
(
S‘Pošts
::
v®ue_ty³
 
pid
, 
şu¡”s_to_pošts__
[
cid
]){

126 
PoštND
 
	gp
 = 
ps__
.
g‘Pošt
(
pid
);

127 
	gi
=0; i<
	gnum_dim’siÚs__
; i++è
	gûÁroid
[
i
] +ğ
p
[i];

128 
	gnum_pošts_š_şu¡”
++;

135 if(
	gnum_pošts_š_şu¡”
 =ğ0è 
çl£
;

136 
	gi
=0; i<
	gnum_dim’siÚs__
; i++è
	gûÁroid
[
i
] /ğ
num_pošts_š_şu¡”
;

137 
	gcid
++;

139  
	gŒue
;

145 
	gClu¡”s
::
š™Ÿl_·¹™iÚ_pošts
(){

147 
Clu¡”Id
 
cid
;

149 
PoštId
 
	gpid
 = 0;…id < 
	gps__
.
g‘NumPošts
();…id++){

151 
	gcid
 = 
pid
 % 
num_şu¡”s__
;

153 
	gpošts_to_şu¡”s__
[
pid
] = 
cid
;

154 
	gşu¡”s_to_pošts__
[
cid
].
š£¹
(
pid
);

162 
	gClu¡”s
::
SFF_·¹™iÚ_pošts
(){

165 
Clu¡”Id
 
sub£t_size
 = (Clu¡”Idè(
log
(()
num_şu¡”s__
)*2.0*num_clusters__);

166 
	gsub£t_size
 = 
¡d
::
mš
(
sub£t_size
, 
num_pošts__
);

169 
Pošts
 
	gsub£t
;

170 
¤ªd
 ( 
time
(
NULL
) );

171 
	gsub£t
.
size
(è< 
	gsub£t_size
){

172 
PoštND
 
	gpošt
 = 
ps__
.
g‘Pošt
Ğ
¿nd
(è%…s__.
g‘NumPošts
());

173 
	gsub£t
.
push_back
(
pošt
);

177 
PoštId
 
	gpid
;

178 
Clu¡”Id
 
	gcid
, 
	gto_şu¡”
 = 0;

179 
Di¡ªû
 
	gd
, 
	gmš
;

182 
	gûÁroids__
.
ş—r
();

183 
	gûÁroids__
.
push_back
Ğ
sub£t
.
back
() );

184 
	gsub£t
.
pİ_back
();

186 
	gûÁroids__
.
size
(è< 
	gnum_şu¡”s__
){

188 
Di¡ªû
 
	gfu¹he¡
 = 0.0;

189 
	gbe¡
 = 0;

191 
	gk
=0; k< 
	gsub£t
.
size
(); k++){

193 
PoštND
 
	gp
 = 
sub£t
.
©
(
k
);

194 
	gmš
 = 
¡d
::
num”ic_lim™s
<>::
max
( );

196 
BOOST_FOREACH
(
C’Œoids
::
v®ue_ty³
 
ûÁroid
, 
ûÁroids__
){

198 
	gd
 = 
Clu¡”šg
::
di¡ªû
(
ûÁroid
, 
p
);

199 if(
	gd
 < 
	gmš
èmš = 
d
;

202 if(
	gmš
 > 
	gfu¹he¡
){

203 
	gfu¹he¡
 = 
mš
;

204 
	gbe¡
 = 
k
;

207 
	gûÁroids__
.
push_back
(
sub£t
.
©
(
be¡
));

208 
	gsub£t
.
”a£
(
sub£t
.
begš
()+
be¡
);

213 
	gpid
=0;…id<
	gnum_pošts__
;…id++){

215 
	gmš
 = 
¡d
::
num”ic_lim™s
<>::
max
( );

216 
	gcid
 = 0;

217 
BOOST_FOREACH
(
C’Œoids
::
v®ue_ty³
 
c
, 
ûÁroids__
){

218 
	gd
 = 
Clu¡”šg
::
di¡ªû
(
c
, 
ps__
.
g‘Pošt
(
pid
));

219 ià(
	gd
 < 
	gmš
){

220 
	gmš
 = 
d
;

221 
	gto_şu¡”
 = 
cid
;

223 
	gcid
++;

225 
	gpošts_to_şu¡”s__
[
pid
] = 
to_şu¡”
;

226 
	gşu¡”s_to_pošts__
[
to_şu¡”
].
š£¹
(
pid
);

234 
	gClu¡”s
::
k_m—ns
(){

236 
boŞ
 
move
;

237 
boŞ
 
	gsome_pošt_is_movšg
 = 
Œue
;

238 
	gnum_™”©iÚs
 = 0;

239 
PoštId
 
	gpid
;

240 
Clu¡”Id
 
	gcid
, 
	gto_şu¡”
 =0;

241 
Di¡ªû
 
	gd
, 
	gmš
;

243 
SFF_·¹™iÚ_pošts
();

247 
	gsome_pošt_is_movšg
){

249 
	gsome_pošt_is_movšg
 = 
çl£
;

251 !
compu‹_ûÁroids
()){

254 
SFF_·¹™iÚ_pošts
();

263 
	gpid
=0;…id<
	gnum_pošts__
;…id++){

266 
	gmš
 = 
Clu¡”šg
::
di¡ªû
(
ûÁroids__
[
pošts_to_şu¡”s__
[
pid
]], 
ps__
.
g‘Pošt
(pid));

269 
	gcid
 = 0;

270 
	gmove
 = 
çl£
;

271 
BOOST_FOREACH
(
C’Œoids
::
v®ue_ty³
 
c
, 
ûÁroids__
){

272 
	gd
 = 
Clu¡”šg
::
di¡ªû
(
c
, 
ps__
.
g‘Pošt
(
pid
));

273 ià(
	gd
 < 
	gmš
){

276 
	gmš
 = 
d
;

277 
	gmove
 = 
Œue
;

278 
	gto_şu¡”
 = 
cid
;

281 
	gşu¡”s_to_pošts__
[
pošts_to_şu¡”s__
[
pid
]].
”a£
(pid);

282 
	gsome_pošt_is_movšg
 = 
Œue
;

284 
	gcid
++;

288 ià(
	gmove
){

290 
	gpošts_to_şu¡”s__
[
pid
] = 
to_şu¡”
;

291 
	gşu¡”s_to_pošts__
[
to_şu¡”
].
š£¹
(
pid
);

297 
	gnum_™”©iÚs
++;

	@robot/utils/Cluster.hpp

3 #´agm¨
Úû


5 
	~<£t
>

6 
	~<veùÜ
>

7 
	~<io¡»am
>

9 
	~<boo¡/unÜd”ed_m­.hµ
>

10 
	~<boo¡/fÜ—ch.hµ
>

15 
Çme¥aû
 
	gClu¡”šg
{

17 
	tCoÜd
;

18 
	tDi¡ªû
;

19 
	tDim’siÚs
;

20 
	tPoštId
;

21 
	tClu¡”Id
;

23 
	g¡d
::
	tveùÜ
<
	tCoÜd
> 
	tPoštND
;

24 
	g¡d
::
	tveùÜ
<
	tPoštND
> 
	tPošts
;

26 
	g¡d
::
	t£t
<
	tPoštId
> 
	tS‘Pošts
;

29 
	g¡d
::
	tveùÜ
<
	tS‘Pošts
> 
	tClu¡”sToPošts
;

31 
	g¡d
::
	tveùÜ
<
	tClu¡”Id
> 
	tPoštsToClu¡”s
;

33 
	g¡d
::
	tveùÜ
<
	tPoštND
> 
	tC’Œoids
;

38 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gPoštND
& 
	gp
);

43 
Di¡ªû
 
di¡ªû
(cÚ¡ 
PoštND
 & 
x
, cÚ¡ PoštND & 
y
);

48 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gPošts
& 
	gıs
);

53 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gS‘Pošts
 & 
	g¥
);

58 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gC’Œoids
 & 
	gı
);

63 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gClu¡”sToPošts
 & 
	gı
);

68 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gPoštsToClu¡”s
 & 
	gpc
);

74 şas 
	cPoštsS·û
{

79 
ä›nd
 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gPoštsS·û
 & 
	gps
){

80 
PoštId
 
	gi
 = 0;

81 
BOOST_FOREACH
(
Pošts
::
v®ue_ty³
 
p
, 
ps
.
pošts__
){

82 
	gos
 << "pošt["<<
	gi
++<<"]=" << 
	gp
 << 
	g¡d
::
’dl
;

84  
	gos
;

87 
	gpublic
:

89 
PoštsS·û
(
PoštId
 
num_pošts
, 
Dim’siÚs
 
num_dim’siÚs
)

90 : 
num_pošts__
(
num_pošts
), 
num_dim’siÚs__
(
num_dim’siÚs
)

91 {
š™_pošts
();};

93 
PoštsS·û
(
Pošts
 
pošts
){

94 
	gnum_pošts__
 = 
pošts
.
size
();

95 if(
	gnum_pošts__
 > 0è
	gnum_dim’siÚs__
 = 
pošts
[0].
size
();

96 
	gpošts__
 = 
pošts
;

99 
šlše
 cÚ¡ 
PoštId
 
g‘NumPošts
(ècÚ¡ { 
	gnum_pošts__
;}

100 
šlše
 cÚ¡ 
PoštId
 
g‘NumDim’siÚs
(ècÚ¡ { 
	gnum_dim’siÚs__
;}

101 
šlše
 cÚ¡ 
	gPoštND
& 
g‘Pošt
(
PoštId
 
pid
ècÚ¡ {  
	gpošts__
[pid];}

103 
	g´iv©e
:

107 
š™_pošts
();

109 
PoštId
 
	gnum_pošts__
;

110 
Dim’siÚs
 
	gnum_dim’siÚs__
;

111 
Pošts
 
	gpošts__
;

118 şas 
	cClu¡”s
 {

120 
	g´iv©e
:

122 
Clu¡”Id
 
num_şu¡”s__
;

123 
	gPoštsS·û
& 
	gps__
;

124 
Dim’siÚs
 
	gnum_dim’siÚs__
;

125 
PoštId
 
	gnum_pošts__
;

126 
Clu¡”sToPošts
 
	gşu¡”s_to_pošts__
;

127 
PoštsToClu¡”s
 
	gpošts_to_şu¡”s__
;

128 
C’Œoids
 
	gûÁroids__
;

133 
z”o_ûÁroids
();

139 
boŞ
 
compu‹_ûÁroids
();

143 
š™Ÿl_·¹™iÚ_pošts
();

148 
SFF_·¹™iÚ_pošts
();

150 
	gpublic
:

152 
C’Œoids
 
g‘C’Œoids
(){

153  
ûÁroids__
;

159 
ä›nd
 
	g¡d
::
o¡»am
& 
İ”©Ü
 << (
¡d
::o¡»am& 
os
, 
	gClu¡”s
 & 
	gş
){

172 
	gos
 << 
	gş
.
	gûÁroids__
 << 
	g¡d
::
’dl
;

173  
	gos
;

177 
Clu¡”s
(
Clu¡”Id
 
num_şu¡”s
, 
PoštsS·û
 & 
ps
) :

178 
num_şu¡”s__
(
num_şu¡”s
), 
ps__
(
ps
),

179 
num_dim’siÚs__
(
ps
.
g‘NumDim’siÚs
()),

180 
num_pošts__
(
ps
.
g‘NumPošts
()),

181 
pošts_to_şu¡”s__
(
num_pošts__
, 0) {

183 
Clu¡”Id
 
	gi
 = 0;

184 
Dim’siÚs
 
	gdim
;

185  ; 
	gi
 < 
	gnum_şu¡”s
; i++){

186 
PoštND
 
	gpošt
;

187 
	gdim
=0; dim<
	gnum_dim’siÚs__
; dim++è
	gpošt
.
push_back
(0.0);

188 
S‘Pošts
 
	g£t_of_pošts
;

191 
	gûÁroids__
.
push_back
(
pošt
);

194 
	gşu¡”s_to_pošts__
.
push_back
(
£t_of_pošts
);

202 
k_m—ns
 ();

	@robot/utils/ConcurrentMap.hpp

32 #´agm¨
Úû


34 
	~<boo¡/th»ad/mu‹x.hµ
>

35 
	~<m­
>

36 
	~<veùÜ
>

40 
	g‹m¶©e
 <
şass
 
	gKey
, cÏs 
	gD©a
>

41 şas 
	cCÚcu¼’tM­
 {

42 
	mpublic
:

46 
D©a
 & 
İ”©Ü
[](cÚ¡ 
Key
& 
key
);

50 
	$couÁ
(cÚ¡ 
Key
& 
key
) const;

53 
¡d
::
veùÜ
<
Key
> 
	$keys
() const;

54 
´iv©e
:

56 
¡d
::
m­
<
Key
, 
D©a
> 
theM­
;

58 
mubË
 
boo¡
::
mu‹x
 
theLock
;

61 
	~"uts/CÚcu¼’tM­.tcc
"

	@robot/utils/ConcurrentMap.tcc

1 
	g‹m¶©e
 <
şass
 
	gKey
, cÏs 
	gD©a
>

2 
	gD©a
 & 
	gCÚcu¼’tM­
<
	gKey
, D©a>::
İ”©Ü
[] (cÚ¡ 
Key
 &
key
){

3 
boo¡
::
mu‹x
::
scİed_lock
 
lock
(
theLock
);

4  
	gtheM­
[
key
];

7 
	g‹m¶©e
 <
şass
 
	gKey
, cÏs 
	gD©a
>

8 
	gCÚcu¼’tM­
<
	gKey
, 
	gD©a
>::
	$couÁ
(cÚ¡ 
Key
& 
key
) const {

9 
boo¡
::
mu‹x
::
scİed_lock
 
	`lock
(
theLock
);

10  
theM­
.
	`couÁ
(
key
);

11 
	}
}

13 
	g‹m¶©e
 <
şass
 
	gKey
, cÏs 
	gD©a
>

14 
	g¡d
::
veùÜ
<
Key
> 
CÚcu¼’tM­
<Key, 
	gD©a
>::
	$keys
() const {

15 
¡d
::
veùÜ
<
Key
> 
keyVec
;

16 
boo¡
::
mu‹x
::
scİed_lock
 
	`lock
(
theLock
);

18 
ty³Çme
 
¡d
::
m­
<
Key
, 
D©a
>::
cÚ¡_™”©Ü
 
™
;

20 
™
 = 
theM­
.
	`begš
(); iˆ!ğtheM­.
	`’d
(); ++it) {

21 
keyVec
.
	`push_back
(
™
->
fœ¡
);

23  
keyVec
;

24 
	}
}

	@robot/utils/Connection.cpp

32 
	~"uts/CÚÃùiÚ.hµ
"

34 
	gCÚÃùiÚ
::
	$CÚÃùiÚ
(
boo¡
::
asio
::
io_£rviû
* io_service) :

35 
	`sock‘_
(*
io_£rviû
), 
	`šbound_com´es£d_d©a_
(), 
	$šbound_d©a_
(è{
	}
}

37 
	gboo¡
::
asio
::

::
tı
::
sock‘
& 
CÚÃùiÚ
::
	$sock‘
() {

38  
sock‘_
;

39 
	}
}

	@robot/utils/Connection.hpp

12 #´agm¨
Úû


14 
	~<boo¡/asio.hµ
>

15 
	~<boo¡/bšd.hµ
>

16 
	~<boo¡/sh¬ed_±r.hµ
>

17 
	~<boo¡/tu¶e/tu¶e.hµ
>

18 
	~<iomª
>

19 
	~<¡ršg
>

20 
	~<s¡»am
>

21 
	~<veùÜ
>

24 
	#kH—d”L’gth
 8

	)

33 şas 
	cCÚÃùiÚ
 {

34 
	mpublic
:

36 
ex¶ic™
 
CÚÃùiÚ
(
boo¡
::
asio
::
io_£rviû
* io_service);

40 
	mboo¡
::
asio
::

::
tı
::
sock‘
& socket();

43 
	m‹m¶©e
 <
ty³Çme
 
	mT
,y³Çm
	mHªdËr
>

44 
async_wr™e
(cÚ¡ 
T
& 
t
, 
HªdËr
 
hªdËr
);

47 
	m‹m¶©e
 <
ty³Çme
 
	mT
,y³Çm
	mHªdËr
>

48 
async_»ad
(
T
& 
t
, 
HªdËr
 
hªdËr
);

51 
	m‹m¶©e
 <
ty³Çme
 
	mT
> 
	mboo¡
::
sy¡em
::
”rÜ_code
 
sync_wr™e
(cÚ¡ 
T
& 
t
);

54 
	m‹m¶©e
 <
ty³Çme
 
	mT
> 
	mboo¡
::
sy¡em
::
”rÜ_code
 
sync_»ad
(
T
& 
t
);

59 
	m‹m¶©e
 <
ty³Çme
 
	mT
,y³Çm
	mHªdËr
>

60 
hªdË_»ad_h—d”
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
,

61 
T
& 
t
, 
boo¡
::
tu¶e
<
HªdËr
> 
hªdËr
);

64 
	m‹m¶©e
 <
ty³Çme
 
	mT
,y³Çm
	mHªdËr
>

65 
hªdË_»ad_d©a
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
,

66 
T
& 
t
, 
boo¡
::
tu¶e
<
HªdËr
> 
hªdËr
);

68 
	m´iv©e
:

70 
boo¡
::
asio
::

::
tı
::
sock‘
 
sock‘_
;

73 
	m¡d
::
¡ršg
 
outbound_h—d”_
;

76 
	m¡d
::
¡ršg
 
outbound_d©a_
;

79 
	mšbound_h—d”_
[
kH—d”L’gth
 * 2];

82 
	m¡d
::
veùÜ
<> 
šbound_com´es£d_d©a_
;

85 
	m¡d
::
veùÜ
<> 
šbound_d©a_
;

88 
	gboo¡
::
	tsh¬ed_±r
<
	tCÚÃùiÚ
> 
	tCÚÃùiÚ_±r
;

90 
	~"CÚÃùiÚ.tcc
"

	@robot/utils/Connection.tcc

1 
	~<boo¡/¬chive/bš¬y_Ÿrchive.hµ
>

2 
	~<boo¡/¬chive/bš¬y_ßrchive.hµ
>

3 
	~<io¡»am
>

4 
	~"uts/Logg”.hµ
"

5 
	~"uts/¢­py/¢­py.h
"

7 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gHªdËr
>

8 
	gCÚÃùiÚ
::
	$async_wr™e
(cÚ¡ 
T
& 
t
, 
HªdËr
 
hªdËr
) {

10 
¡d
::
o¡ršg¡»am
 
¬chive_¡»am
;

11 
boo¡
::
¬chive
::
bš¬y_ßrchive
 
	`¬chive
(
¬chive_¡»am
);

12 
¬chive
 << 
	`BOOST_SERIALIZATION_NVP
(
t
);

13 
outbound_d©a_
 = 
¬chive_¡»am
.
	`¡r
();

14 
	`Îog
(
DEBUG1
è<< 
outbound_d©a_
.
	`size
();

17 
size_t
 
com´es£dSize
;

18 * 
com´es£dBufãr
 = 
Ãw
 [
¢­py
::
	`MaxCom´es£dL’gth
(
outbound_d©a_
.
	`size
())];

19 
¢­py
::
	`RawCom´ess
(

20 
outbound_d©a_
.
	`c_¡r
(), outbound_d©a_.
	`size
(),

21 
com´es£dBufãr
, &
com´es£dSize


25 
¡d
::
o¡ršg¡»am
 
h—d”_¡»am
;

26 
h—d”_¡»am
 << 
¡d
::
	`£tw
(
kH—d”L’gth
è<< std::
hex
 << 
com´es£dSize
 <<

27 
¡d
::
	`£tw
(
kH—d”L’gth
è<< 
outbound_d©a_
.
	`size
();

28 ià(!
h—d”_¡»am
 || h—d”_¡»am.
	`¡r
().
	`size
(è!ğ
kH—d”L’gth
 * 2) {

30 
boo¡
::
sy¡em
::
”rÜ_code
 
	`”rÜ
(boo¡::
asio
::
”rÜ
::
šv®id_¬gum’t
);

31 
sock‘_
.
	`g‘_io_£rviû
().
	`po¡
(
boo¡
::
	`bšd
(
hªdËr
, 
”rÜ
));

34 
outbound_h—d”_
 = 
h—d”_¡»am
.
	`¡r
();

38 
¡d
::
veùÜ
<
boo¡
::
asio
::
cÚ¡_bufãr
> 
bufãrs
;

39 
bufãrs
.
	`push_back
(
boo¡
::
asio
::
	`bufãr
(
outbound_h—d”_
));

40 ià(
com´es£dSize
)

41 
bufãrs
.
	`push_back
(
boo¡
::
asio
::
	`bufãr
(
com´es£dBufãr
, 
com´es£dSize
));

43 
bufãrs
.
	`push_back
(
boo¡
::
asio
::
	`bufãr
(
outbound_d©a_
));

44 
	`Îog
(
DEBUG1
è<< 
outbound_h—d”_
 << 
¡d
::
’dl
;

45 
boo¡
::
asio
::
	`async_wr™e
(
sock‘_
, 
bufãrs
, 
hªdËr
);

49 
	}
}

51 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gHªdËr
>

52 
	gCÚÃùiÚ
::
	$async_»ad
(
T
& 
t
, 
HªdËr
 
hªdËr
) {

54 (
CÚÃùiÚ
::*
f
)(

55 cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &,

56 
T
 &, 
boo¡
::
tu¶e
<
HªdËr
>)

57 ğ&
CÚÃùiÚ
::
hªdË_»ad_h—d”
<
T
, 
HªdËr
>;

58 
boo¡
::
asio
::
	`async_»ad
(
sock‘_
, boo¡::asio::
	`bufãr
(
šbound_h—d”_
),

59 
boo¡
::
	`bšd
(
f
,

60 
this
, 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
, boo¡::
	`»f
(
t
),

61 
boo¡
::
	`make_tu¶e
(
hªdËr
)));

62 
	}
}

64 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

65 
	gboo¡
::
sy¡em
::
”rÜ_code
 
CÚÃùiÚ
::
	$sync_wr™e
(cÚ¡ 
T
& 
t
) {

67 
¡d
::
o¡ršg¡»am
 
¬chive_¡»am
;

68 
boo¡
::
¬chive
::
bš¬y_ßrchive
 
	`¬chive
(
¬chive_¡»am
);

69 
¬chive
 << 
	`BOOST_SERIALIZATION_NVP
(
t
);

70 
outbound_d©a_
 = 
¬chive_¡»am
.
	`¡r
();

71 
	`Îog
(
DEBUG1
è<< 
outbound_d©a_
.
	`size
();

74 
size_t
 
com´es£dSize
;

75 * 
com´es£dBufãr
 = 
Ãw
 [
¢­py
::
	`MaxCom´es£dL’gth
(
outbound_d©a_
.
	`size
())];

76 
¢­py
::
	`RawCom´ess
(

77 
outbound_d©a_
.
	`c_¡r
(), outbound_d©a_.
	`size
(),

78 
com´es£dBufãr
, &
com´es£dSize


82 
¡d
::
o¡ršg¡»am
 
h—d”_¡»am
;

83 
h—d”_¡»am
 << 
¡d
::
	`£tw
(
kH—d”L’gth
è<< std::
hex
 << 
com´es£dSize
 <<

84 
¡d
::
	`£tw
(
kH—d”L’gth
è<< 
outbound_d©a_
.
	`size
();

85 ià(!
h—d”_¡»am
 || h—d”_¡»am.
	`¡r
().
	`size
(è!ğ
kH—d”L’gth
 * 2) {

87 
	`Îog
(
ERROR
è<< "H—d” oÆy cÚš \"" << 
h—d”_¡»am
 << "\"" <<

88 
¡d
::
’dl
;

89 
boo¡
::
sy¡em
::
”rÜ_code
 
	`”rÜ
(boo¡::
asio
::
”rÜ
::
šv®id_¬gum’t
);

90  
”rÜ
;

92 
outbound_h—d”_
 = 
h—d”_¡»am
.
	`¡r
();

96 
¡d
::
veùÜ
<
boo¡
::
asio
::
cÚ¡_bufãr
> 
bufãrs
;

97 
bufãrs
.
	`push_back
(
boo¡
::
asio
::
	`bufãr
(
outbound_h—d”_
));

98 ià(
com´es£dSize
)

99 
bufãrs
.
	`push_back
(
boo¡
::
asio
::
	`bufãr
(
com´es£dBufãr
, 
com´es£dSize
));

101 
bufãrs
.
	`push_back
(
boo¡
::
asio
::
	`bufãr
(
outbound_d©a_
));

102 
	`Îog
(
DEBUG1
è<< 
outbound_h—d”_
 << 
¡d
::
’dl
;

103 
Œy
 {

104 
boo¡
::
asio
::
	`wr™e
(
sock‘_
, 
bufãrs
);

105 
d–‘e
 [] 
com´es£dBufãr
;

106 } 
	`ÿtch
(cÚ¡ 
¡d
::
exû±iÚ
 & 
e
) {

107 ià(
	`¡rcmp
(
e
.
	`wh©
(), "write: Broken…ipe") == 0) {

108 
¡d
::
cout
 << "[You can safely ignorehis,‡ client disconnected "

111 << 
e
.
	`wh©
(è<< "]" << 
¡d
::
’dl
;

112  
boo¡
::
sy¡em
::
”rc
::
	`make_”rÜ_code
(

113 
boo¡
::
sy¡em
::
”rc
::
brok’_pe


116 
throw
;

118  
boo¡
::
sy¡em
::
”rc
::
	`make_”rÜ_code
(boo¡::sy¡em::”rc::
sucûss
);

119 
	}
}

121 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

122 
	gboo¡
::
sy¡em
::
”rÜ_code
 
CÚÃùiÚ
::
	$sync_»ad
(
T
& 
t
) {

125 
boo¡
::
asio
::
	`»ad
(
sock‘_
, boo¡::asio::
	`bufãr
(
šbound_h—d”_
));

127 
¡d
::
i¡ršg¡»am
 
	`is
(¡d::
	`¡ršg
(
šbound_h—d”_
, 
kH—d”L’gth
 * 2));

128 
¡d
::
size_t
 
šbound_com´es£d_size
 = 0;

129 
¡d
::
size_t
 
šbound_d©a_size
 = 0;

130 ià(!(
is
 >> 
¡d
::
hex
 >> 
šbound_com´es£d_size
 >> 
šbound_d©a_size
)) {

132 
boo¡
::
sy¡em
::
”rÜ_code
 
	`”rÜ
(boo¡::
asio
::
”rÜ
::
šv®id_¬gum’t
);

133  
”rÜ
;

135 
	`Îog
(
DEBUG1
è<< 
šbound_com´es£d_size
 << 
šbound_d©a_size
 << 
¡d
::
’dl
;

138 
šbound_d©a_
.
	`»size
(
šbound_d©a_size
);

139 ià(
šbound_com´es£d_size
 == 0) {

141 
boo¡
::
asio
::
	`»ad
(
sock‘_
, boo¡::asio::
	`bufãr
(
šbound_d©a_
));

143 
šbound_com´es£d_d©a_
.
	`»size
(
šbound_com´es£d_size
);

145 
boo¡
::
asio
::
	`»ad
(
sock‘_
, boo¡::asio::
	`bufãr
(
šbound_com´es£d_d©a_
));

148 
nÙOk
 = 
¢­py
::
	`RawUncom´ess
(

149 &
šbound_com´es£d_d©a_
[0],

150 
šbound_com´es£d_d©a_
.
	`size
(),

151 &
šbound_d©a_
[0]

153 ià(
nÙOk
) {

154 
	`Îog
(
ERROR
è<< "çedØ¢­py decom´ess" << 
¡d
::
’dl
;

159 
Œy
 {

160 
¡d
::
¡ršg
 
	`¬chive_d©a
(&
šbound_d©a_
[0], inbound_d©a_.
	`size
());

161 
	`Îog
(
DEBUG1
è<< 
¡d
::
	`¡ršg
(
šbound_h—d”_
, 
kH—d”L’gth
 * 2) <<

162 
¡d
::
’dl
;

163 
¡d
::
i¡ršg¡»am
 
	`¬chive_¡»am
(
¬chive_d©a
);

164 
boo¡
::
¬chive
::
bš¬y_Ÿrchive
 
	`¬chive
(
¬chive_¡»am
);

165 
¬chive
 >> 
	`BOOST_SERIALIZATION_NVP
(
t
);

166 } 
	`ÿtch
(
¡d
::
exû±iÚ
 & 
e
) {

168 
boo¡
::
sy¡em
::
”rÜ_code
 
	`”rÜ
(boo¡::
asio
::
”rÜ
::
šv®id_¬gum’t
);

169  
”rÜ
;

171  
boo¡
::
sy¡em
::
”rc
::
	`make_”rÜ_code
(boo¡::sy¡em::”rc::
sucûss
);

172 
	}
}

174 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gHªdËr
>

175 
	gCÚÃùiÚ
::
hªdË_»ad_h—d”
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
,

176 
T
& 
t
, 
boo¡
::
tu¶e
<
HªdËr
> 
hªdËr
) {

177 ià(
e
) {

178 
boo¡
::
g‘
<0>(
hªdËr
è(
e
);

181 
	g¡d
::
i¡ršg¡»am
 
is
(
¡d
::
¡ršg
(
šbound_h—d”_
, 
kH—d”L’gth
 * 2));

182 
	g¡d
::
size_t
 
šbound_com´es£d_size
 = 0;

183 
	g¡d
::
size_t
 
šbound_d©a_size
 = 0;

184 ià(!(
	gis
 >> 
	g¡d
::
hex
 >> 
šbound_com´es£d_size
 >> 
šbound_d©a_size
)) {

186 
boo¡
::
sy¡em
::
”rÜ_code
 
”rÜ
(boo¡::
asio
::”rÜ::
šv®id_¬gum’t
);

187 
	gboo¡
::
g‘
<0>(
hªdËr
è(
”rÜ
);

190 
Îog
(
DEBUG1
è<< 
	gšbound_com´es£d_size
 << 
	gšbound_d©a_size
 << 
	g¡d
::
’dl
;

193 
	gšbound_com´es£d_d©a_
.
»size
(
šbound_com´es£d_size
);

194 
	gšbound_d©a_
.
»size
(
šbound_d©a_size
);

195 (
	gCÚÃùiÚ
::*
f
)(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &, 
	gT
 &,

196 
	gboo¡
::
tu¶e
<
HªdËr
>) =

197 &
CÚÃùiÚ
::
hªdË_»ad_d©a
<
T
, 
	gHªdËr
>;

198 ià(
	gšbound_com´es£d_size
)

199 
	gboo¡
::
asio
::
async_»ad
(
sock‘_
,

200 
boo¡
::
asio
::
bufãr
(
šbound_com´es£d_d©a_
),

201 
boo¡
::
bšd
(
f
, 
this
,

202 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
,

203 
boo¡
::
»f
(
t
), 
hªdËr
));

205 
	gboo¡
::
asio
::
async_»ad
(
sock‘_
, 
boo¡
::asio::
bufãr
(
šbound_d©a_
),

206 
boo¡
::
bšd
(
f
, 
this
,

207 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
,

208 
boo¡
::
»f
(
t
), 
hªdËr
));

212 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gHªdËr
>

213 
	gCÚÃùiÚ
::
hªdË_»ad_d©a
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
,

214 
T
& 
t
, 
boo¡
::
tu¶e
<
HªdËr
> 
hªdËr
) {

215 ià(
e
) {

216 
boo¡
::
g‘
<0>(
hªdËr
è(
e
);

218 ià(
	gšbound_com´es£d_d©a_
.
size
()) {

220 
	gnÙOk
 = 
¢­py
::
RawUncom´ess
(

221 &
šbound_com´es£d_d©a_
[0],

222 
šbound_com´es£d_d©a_
.
size
(),

223 &
šbound_d©a_
[0]

225 ià(
	gnÙOk
) {

226 
Îog
(
ERROR
è<< "çedØ¢­py decom´ess" << 
	g¡d
::
’dl
;

231 
	gŒy
 {

232 
	g¡d
::
¡ršg
 
¬chive_d©a
(&
šbound_d©a_
[0], inbound_d©a_.
size
());

233 
Îog
(
DEBUG1
è<< 
	g¡d
::
¡ršg
(
šbound_h—d”_
, 
kH—d”L’gth
 * 2) <<

234 
	g¡d
::
’dl
;

235 
	g¡d
::
i¡ršg¡»am
 
¬chive_¡»am
(
¬chive_d©a
);

236 
	gboo¡
::
¬chive
::
bš¬y_Ÿrchive
‡rchive(
¬chive_¡»am
);

237 
	g¬chive
 >> 
BOOST_SERIALIZATION_NVP
(
t
);

238 } 
ÿtch
(
¡d
::
exû±iÚ
 & 
e
) {

240 
boo¡
::
sy¡em
::
”rÜ_code
 
”rÜ
(boo¡::
asio
::”rÜ::
šv®id_¬gum’t
);

241 
	gboo¡
::
g‘
<0>(
hªdËr
è(
”rÜ
);

246 
	gboo¡
::
g‘
<0>(
hªdËr
è(
e
);

	@robot/utils/Garbage.hpp

1 
	g‹m¶©e
<
	gsize
, 
ty³Çme
 
	gTy³
>

2 
	sG¬bage
 {

3 
Ty³
 
	mg¬bage
[
size
];

6 
Çme¥aû
 
	gboo¡
 {

7 
Çme¥aû
 
	g£rŸliz©iÚ
 {

9 
	g‹m¶©e
<
şass
 
	gArchive
, 
	gsize
, 
ty³Çme
 
	gTy³
>

10 
£rŸlize
(
Archive
 & 
¬
, 
G¬bage
<
size
, 
Ty³
> & 
g
, cÚ¡ 
v”siÚ
)

12 
	g–em’t
 = 0;ƒËm’ˆ< 
	gsize
; ++element)

13 
	g¬
 & 
	gg
.
	gg¬bage
[
–em’t
];

	@robot/utils/Histogram.hpp

1 #´agm¨
Úû


3 
	~<io¡»am
>

5 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

6 
	sHi¡og¿m


8 cÚ¡ 
	msize
;

10 
Hi¡og¿m
(
size
);

11 
	mvœtu®
 ~
Hi¡og¿m
();

16 
šlše
 
couÁs
(
i
, 
chªÃl
 = 0) const

18  
_couÁs
[
i
][
chªÃl
];

24 
šlše
 
wšdow
(
i
, 
chªÃl
 = 0) const

26  
_wšdow
[
i
][
chªÃl
];

32 
šlše
 
³aks
(
i
, 
chªÃl
 = 0) const

34  
_³aks
[
i
][
chªÃl
];

37 
T
 (*
_couÁs
)[
chªÃls
];

38 
T
 (*
_wšdow
)[
chªÃls
];

39 (*
	m_³aks
 )[
chªÃls
];

44 
­¶yWšdowF‹r
(

45 cÚ¡ 
wšdowSize
,

46 
chªÃl_mask
 = 0xFFFFFFF);

52 
­¶yWšdowF‹rLoİ
(

53 cÚ¡ 
wšdowSize
,

54 
chªÃl_mask
 = 0xFFFFFFFF);

59 
maxP—k
(
chªÃl
 = 0) const;

64 
maxCouÁ
(
chªÃl
 = 0) const;

66 
	m‹m¶©e
 <
ty³Çme
 
	m_T
, 
	m_chªÃls
>

67 
ä›nd
 
	m¡d
::
o¡»am
& 
İ”©Ü
 << (

68 
¡d
::
o¡»am
 &
out
,

69 cÚ¡ 
	mHi¡og¿m
<
	m_T
, 
	m_chªÃls
> &
	mh
);

72 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

73 
	g¡d
::
o¡»am
& 
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
> &
	gh
);

75 
	~"Hi¡og¿m.tcc
"

	@robot/utils/Histogram.tcc

1 
	~<m©h.h
>

3 
	~<lim™s
>

4 
	~<iomª
>

5 
	~<ty³šfo
>

7 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

8 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
>::
	$Hi¡og¿m
(
size
)

9 : 
	$size
(
size
)

11 
_couÁs
 = 
Ãw
 
T
 [
size
][
chªÃls
];

12 
_wšdow
 = 
Ãw
 
T
 [
size
][
chªÃls
];

13 
_³aks
 = 
Ãw
 [
size
][
chªÃls
];

15 
c
;

16 
c
 = 0; c < 
chªÃls
; ++ c) {

17 
_³aks
 [0][
c
] = -1;

19 
	}
}

21 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

22 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
>::~
	$Hi¡og¿m
()

24 
d–‘e
[] 
_couÁs
;

25 
d–‘e
[] 
_wšdow
;

26 
d–‘e
[] 
_³aks
;

27 
	}
}

29 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

30 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
>::
	$­¶yWšdowF‹r
(

31 cÚ¡ 
_wšdowSize
,

32 
chªÃl_mask
)

34 ià(
_wšdowSize
 >ğ
size
) {

38 cÚ¡ 
Ïg
 = 
_wšdowSize
 / 2;

39 cÚ¡ 
Ëad
 = 
_wšdowSize
 - 
Ïg
;

41 
i
, 
chªÃl
;

42 
³ak
;

43 
Ï¡_was_³ak
;

44 
boŞ
 
Ï¡_was_h®f_³ak
;

45 
T
 
cumm
, 
cumm_´ev
;

47 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++ channel) {

48 ià(! (
chªÃl_mask
 & 1 << 
chªÃl
)) {

51 
cumm
 = 0;

52 
³ak
 = 0;

53 
Ï¡_was_³ak
 = 0;

61 
Ï¡_was_h®f_³ak
 = 1;

63 
i
 = 0; i < 
_wšdowSize
 - 
Ëad
; ++ i) {

64 
_wšdow
[
i
][
chªÃl
] = 0;

67 
i
 = 0; i < 
_wšdowSize
; ++ i) {

68 
cumm
 +ğ
_couÁs
[
i
][
chªÃl
];

70 
cumm_´ev
 = 
_wšdow
[
i
 - 
Ëad
][
chªÃl
] = 
cumm
;

73 
cumm
 +ğ
_couÁs
[
i
][
chªÃl
];

74 
cumm
 -ğ
_couÁs
[
i
 - 
_wšdowSize
][
chªÃl
];

76 ++ 
i
;

78 
_wšdow
[
i
 - 
Ëad
][
chªÃl
] = 
cumm
;

80 ià(
cumm_´ev
 < 
cumm
) {

81 
_³aks
[
³ak
][
chªÃl
] = 
i
 - 
Ëad
;

82 
Ï¡_was_³ak
 = 1;

83 
Ï¡_was_h®f_³ak
 = 
Œue
;

84 } ià(
cumm_´ev
 =ğ
cumm
) {

85 ià(
Ï¡_was_h®f_³ak
) {

86 
_³aks
[
³ak
][
chªÃl
] = 
i
 - 
Ëad
;

88 
Ï¡_was_h®f_³ak
 = !†ast_was_half_peak;

101 
³ak
 +ğ
Ï¡_was_³ak
;

102 
Ï¡_was_³ak
 = 0;

104 
cumm_´ev
 = 
cumm
;

106 } 
i
 < 
size
);

108 
i
 = 
size
 - 
Ëad
 + 1; i < size; ++ i) {

109 
_wšdow
[
i
][
chªÃl
] = 0;

112 
_³aks
[
³ak
][
chªÃl
] = -1;

114 
	}
}

116 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

117 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
>::
	$­¶yWšdowF‹rLoİ
(

118 cÚ¡ 
_wšdowSize
,

119 
chªÃl_mask
)

121 ià(
_wšdowSize
 >ğ
size
) {

125 cÚ¡ 
Ïg
 = 
_wšdowSize
 / 2;

126 cÚ¡ 
Ëad
 = 
_wšdowSize
 - 
Ïg
;

128 
i
, 
chªÃl
;

129 
³ak
, 
³ak_tmp
;

130 
Ï¡_was_³ak
;

131 
boŞ
 
Ï¡_was_h®f_³ak
;

132 
T
 
cumm
, 
cumm_´ev
;

134 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++ channel) {

135 ià(! (
chªÃl_mask
 & 1 << 
chªÃl
)) {

138 
cumm
 = 0;

139 
³ak
 = 0;

140 
i
 = 
size
 - 
Ïg
; i < size; ++ i) {

141 
cumm
 +ğ
_couÁs
[
i
][
chªÃl
];

143 
i
 = 0; i < 
Ëad
; ++ i) {

144 
cumm
 +ğ
_couÁs
[
i
][
chªÃl
];

146 
_wšdow
[0][
chªÃl
] = 
cumm
;

151 
Ï¡_was_³ak
 = 0;

152 
cumm_´ev
 = 
cumm
;

153 
cumm_´ev
 +ğ
_couÁs
[
size
 - 
Ïg
 - 1][
chªÃl
];

154 
cumm_´ev
 -ğ
_couÁs
[
Ëad
 - 1][
chªÃl
];

156 ià(
cumm_´ev
 < 
cumm
) {

157 
_³aks
[
³ak
][
chªÃl
] = 0;

158 
Ï¡_was_³ak
 = 1;

161 
Ï¡_was_h®f_³ak
 = 
Œue
;

163 
cumm_´ev
 = 
cumm
;

165 
i
 < 
_wšdowSize
) {

166 
cumm
 +ğ
_couÁs
[
i
][
chªÃl
];

167 
cumm
 -ğ
_couÁs
[
i
 + 
size
 - 
_wšdowSize
][
chªÃl
];

169 ++ 
i
;

171 
_wšdow
[
i
 - 
Ëad
][
chªÃl
] = 
cumm
;

173 ià(
cumm_´ev
 < 
cumm
) {

174 
_³aks
[
³ak
][
chªÃl
] = 
i
 - 
Ëad
;

175 
Ï¡_was_³ak
 = 1;

176 
Ï¡_was_h®f_³ak
 = 
Œue
;

177 } ià(
cumm_´ev
 =ğ
cumm
) {

178 ià(
Ï¡_was_h®f_³ak
) {

179 
_³aks
[
³ak
][
chªÃl
] = 
i
 - 
Ëad
;

181 
Ï¡_was_h®f_³ak
 = !†ast_was_half_peak;

183 
³ak
 +ğ
Ï¡_was_³ak
;

184 
Ï¡_was_³ak
 = 0;

187 
cumm_´ev
 = 
cumm
;

190 
i
 < 
size
) {

191 
cumm
 +ğ
_couÁs
[
i
][
chªÃl
];

192 
cumm
 -ğ
_couÁs
[
i
 - 
_wšdowSize
][
chªÃl
];

194 ++ 
i
;

196 
_wšdow
[
i
 - 
Ëad
][
chªÃl
] = 
cumm
;

198 ià(
cumm_´ev
 < 
cumm
) {

199 
_³aks
[
³ak
][
chªÃl
] = 
i
 - 
Ëad
;

200 
Ï¡_was_³ak
 = 1;

201 
Ï¡_was_h®f_³ak
 = 
Œue
;

202 } ià(
cumm_´ev
 =ğ
cumm
) {

203 ià(
Ï¡_was_h®f_³ak
) {

204 
_³aks
[
³ak
][
chªÃl
] = 
i
 - 
Ëad
;

206 
Ï¡_was_h®f_³ak
 = !†ast_was_half_peak;

208 
³ak
 +ğ
Ï¡_was_³ak
;

209 
Ï¡_was_³ak
 = 0;

212 
cumm_´ev
 = 
cumm
;

215 
i
 < 
size
 + 
Ëad
 - 1) {

216 
cumm
 +ğ
_couÁs
[
i
 - 
size
][
chªÃl
];

217 
cumm
 -ğ
_couÁs
[
i
 - 
_wšdowSize
][
chªÃl
];

219 ++ 
i
;

221 
_wšdow
[
i
 - 
Ëad
][
chªÃl
] = 
cumm
;

223 ià(
cumm_´ev
 < 
cumm
) {

224 
_³aks
[
³ak
][
chªÃl
] = 
i
 - 
Ëad
;

225 
Ï¡_was_³ak
 = 1;

226 
Ï¡_was_h®f_³ak
 = 
Œue
;

227 } ià(
cumm_´ev
 =ğ
cumm
) {

228 ià(
Ï¡_was_h®f_³ak
) {

229 ++ 
_³aks
[
³ak
][
chªÃl
];

231 
Ï¡_was_h®f_³ak
 = !†ast_was_half_peak;

233 
³ak
 +ğ
Ï¡_was_³ak
;

234 
Ï¡_was_³ak
 = 0;

237 
cumm_´ev
 = 
cumm
;

241 
cumm
 = 
_wšdow
[
size
 - 1][
chªÃl
];

242 ià(
Ï¡_was_³ak
) {

243 ià(
_wšdow
[0][
chªÃl
] < 
cumm
) {

244 
_³aks
[
³ak
 ++][
chªÃl
] = 
size
 - 1;

245 } ià(
_wšdow
[0][
chªÃl
] =ğ
cumm
) {

247 
i
 = 0;

248 
i
 = 0; 
_wšdow
[i][
chªÃl
] =ğ
cumm
; ++ i) {

249 ià(
Ï¡_was_h®f_³ak
) {

250 ++ 
_³aks
[
³ak
][
chªÃl
];

252 
Ï¡_was_h®f_³ak
 = !†ast_was_half_peak;

255 ià(
cumm
 > 
_wšdow
[
i
][
chªÃl
]) {

259 ià(
_³aks
[
³ak
][
chªÃl
] >ğ
size
) {

260 
³ak_tmp
 = 
_³aks
[
³ak
][
chªÃl
];

261 
i
 = 0; i < 
³ak
; ++ i) {

262 
_³aks
[
i
 + 1][
chªÃl
] = _peaks[i][channel];

264 
_³aks
[0][
chªÃl
] = 
³ak_tmp
 - 
size
;

266 ++ 
³ak
;

270 
_³aks
[
³ak
][
chªÃl
] = -1;

272 
	}
}

274 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

275 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
>::
	$maxP—k
(
chªÃl
) const

277 
»t
 = -1;

278 
T
 
be¡
 = 
¡d
::
num”ic_lim™s
<T>::
	`mš
();

280 
i
;

281 
i
 = 0; 
_³aks
[i][
chªÃl
] != -1 ; ++ i) {

282 
v®
 = 
_wšdow
[
_³aks
[
i
][
chªÃl
]][channel];

283 ià(
be¡
 < 
v®
) {

284 
»t
 = 
_³aks
[
i
][
chªÃl
];

285 
be¡
 = 
v®
;

289  
»t
;

290 
	}
}

292 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

293 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
>::
	$maxCouÁ
(
chªÃl
) const

295 
»t
 = -1;

296 
T
 
be¡
 = 
¡d
::
num”ic_lim™s
<T>::
	`mš
();

298 
i
;

299 
i
 = 0; i < 
size
; ++ i) {

300 ià(
be¡
 < 
_couÁs
[
i
][
chªÃl
]) {

301 
»t
 = 
i
;

302 
be¡
 = 
_couÁs
[
i
][
chªÃl
];

306  
»t
;

307 
	}
}

309 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
	gchªÃls
>

310 
	g¡d
::
o¡»am
& 
İ”©Ü
 <<(
¡d
::o¡»am &
out
, cÚ¡ 
	gHi¡og¿m
<
	gT
, 
	gchªÃls
> &
	gh
)

312 
	g¡d
::
ios_ba£
::
fmtæags
 
§ve_æags
 = 
out
.
æags
();

313 
	g§ve_fl
 = 
out
.
fl
 ();

315 
	gi
, 
	gc
;

316 
	g¥acšg
;

321 ià(
ty³id
(
T
) ==ypeid() ||ypeid(T) ==ypeid()) {

322 
¥acšg
 = 6;

324 
	gglob®max
 = 0;

325 
	gc
 = 0; c < 
	gchªÃls
; ++ c) {

326 
	gi
 = 0; i < 
	gh
.
	gsize
; ++ i) {

327 ià(
	gh
.
	g_couÁs
[
i
][
c
] > 
	gglob®max
) {

328 
	gglob®max
 = 
h
.
_couÁs
[
i
][
c
];

330 ià(
	gh
.
	g_wšdow
[
i
][
c
] > 
	gglob®max
) {

331 
	gglob®max
 = 
h
.
_couÁs
[
i
][
c
];

335 ià(
	gglob®max
 < 2) {

336 
	g¥acšg
 = 3;

338 
	g¥acšg
 = (
log
(
glob®max
) /†og(10)) + 2;

342 
	gc
 = 0; c < 
	gchªÃls
; ++ c) {

343 
boŞ
 
	ghas_v®
 = 
çl£
;

344 
	gi
 = 0; i < 
	gh
.
	gsize
 && ! 
	ghas_v®
; ++ i) {

345 
	ghas_v®
 = 
h
.
_couÁs
[
i
][
c
] != 0;

347 ià(! 
	ghas_v®
) {

352 
	gout
 << "channel ";

353 
	gout
 << 
	gc
 << 
	g¡d
::
£tw
(0è<< ":" << 
¡d
::
’dl
;

356 
	gout
 << "counts:";

358 
	gi
 = 0; i < 
	gh
.
	gsize
; ++ i) {

359 
	gout
 << 
	g¡d
::
£tw
(
¥acšg
è<< 
h
.
_couÁs
[
i
][
c
];

361 
	gout
 << 
	g¡d
::
’dl
;

364 
	gout
 << "window:";

365 
	gi
 = 0; i < 
	gh
.
	gsize
; ++ i) {

366 
	gout
 << 
	g¡d
::
£tw
(
¥acšg
è<< 
h
.
_wšdow
[
i
][
c
];

368 
	gout
 << 
	g¡d
::
’dl
;

371 
	gout
 << "peaks :";

372 
	gi
 = 0; 
	gh
.
	g_³aks
[
i
][
c
] != -1; ++ i) {

373 
	gout
 << 
	g¡d
::
£tw
(
¥acšg
è<< 
h
.
_³aks
[
i
][
c
];

375 
	gout
 << 
	g¡d
::
’dl
;

378 
	gout
.
æags
(
§ve_æags
);

379 
	gout
.
fl
 (
§ve_fl
 );

381  
	gout
;

	@robot/utils/LeastSquaresLine.cpp

1 
	~<m©h.h
>

2 
	~<¡dšt.h
>

3 
	~<lim™s
>

4 
	~"L—¡Squ¬esLše.hµ
"

6 
	gL—¡Squ¬esLše
::
	$L—¡Squ¬esLše
()

8 
sumX2
 = 0;

9 
sumY2
 = 0;

10 
sumXY
 = 0;

11 
sumX
 = 0;

12 
sumY
 = 0;

13 
sum1
 = 0;

14 
	}
}

16 
boŞ
 
	gL—¡Squ¬esLše
::
	$g‘LšeABC
(*
a
, *
b
, *
c
)

27 
št64_t
 
sumX2
 = 
this
->sumX2;

28 
št64_t
 
sumY2
 = 
this
->sumY2;

29 
št64_t
 
sumXY
 = 
this
->sumXY;

30 
št64_t
 
sumX
 = 
this
->sumX;

31 
št64_t
 
sumY
 = 
this
->sumY;

32 
št64_t
 
sum1
 = 
this
->sum1;

34 
št64_t
 
d‘X
 = 
sumX2
 * 
sum1
 - 
sumX
 * sumX;

35 
št64_t
 
d‘Y
 = 
sumY2
 * 
sum1
 - 
sumY
 * sumY;

37 ià(
d‘X
 =ğ0 && 
d‘Y
 == 0) {

38  
çl£
;

49 
št64_t
 
¯
, 
bb
, 
cc
;

50 ià(
d‘X
 > 
d‘Y
) {

51 
¯
 = (
sum1
 * 
sumXY
 - 
sumX
 * 
sumY
 );

52 
bb
 = -
d‘X
;

53 
cc
 = (
sumX2
 * 
sumY
 - 
sumX
 * 
sumXY
);

55 
¯
 = -
d‘Y
;

56 
bb
 = (
sum1
 * 
sumXY
 - 
sumY
 * 
sumX
 );

57 
cc
 = (
sumY2
 * 
sumX
 - 
sumY
 * 
sumXY
);

61 cÚ¡ 
št64_t
 
max_»t
 = 
¡d
::
num”ic_lim™s
<>::
	`max
() / 1024;

63 
št64_t
 
max_ov”æow
 = 
¯
 / 
max_»t
;

64 ià(
max_ov”æow
 < 
bb
 / 
max_»t
) {

65 
max_ov”æow
 = 
bb
 / 
max_»t
;

67 ià(
max_ov”æow
 < 
cc
 / 
max_»t
) {

68 
max_ov”æow
 = 
cc
 / 
max_»t
;

71 ià(
max_ov”æow
 != 0) {

72 
¯
 /ğ
max_ov”æow
;

73 
bb
 /ğ
max_ov”æow
;

74 
cc
 /ğ
max_ov”æow
;

77 *
a
 = 
¯
;

78 *
b
 = 
bb
;

79 *
c
 = 
cc
;

81  
Œue
;

82 
	}
}

	@robot/utils/LeastSquaresLine.hpp

1 #´agm¨
Úû


3 
	~"ty³s/Pošt.hµ
"

5 şas 
	cL—¡Squ¬esLše


7 
	mpublic
:

8 
L—¡Squ¬esLše
 ();

15 
šlše
 
addPošt
(
Pošt
 
p
);

23 
šlše
 
»movePošt
(
Pošt
 
p
);

31 
boŞ
 
g‘LšeABC
(*
a
, *
b
, *
c
);

33 
	m´iv©e
:

34 
sumX2
;

35 
	msumX
;

37 
	msumY2
;

38 
	msumY
;

40 
	msumXY
;

42 
	msum1
;

45 
	~"L—¡Squ¬esLšeIÆše.hµ
"

	@robot/utils/LeastSquaresLineInline.hpp

1 
	gL—¡Squ¬esLše
::
	$addPošt
(
Pošt
 
p
)

3 
sumX2
 +ğ
p
.
	`x
() *….x();

4 
sumY2
 +ğ
p
.
	`y
() *….y();

5 
sumXY
 +ğ
p
.
	`x
(è*….
	`y
();

6 
sumX
 +ğ
p
.
	`x
();

7 
sumY
 +ğ
p
.
	`y
();

8 
sum1
 += 1;

9 
	}
}

11 
	gL—¡Squ¬esLše
::
	$»movePošt
(
Pošt
 
p
)

13 
sumX2
 -ğ
p
.
	`x
() *….x();

14 
sumY2
 -ğ
p
.
	`y
() *….y();

15 
sumXY
 -ğ
p
.
	`x
(è*….
	`y
();

16 
sumX
 -ğ
p
.
	`x
();

17 
sumY
 -ğ
p
.
	`y
();

18 
sum1
 -= 1;

19 
	}
}

	@robot/utils/Logger.cpp

1 
	~"Logg”.hµ
"

3 
	~<¡dexû±
>

4 
	~<¡ršg
>

5 
	~<c¡dlib
>

6 
	~<c¡ršg
>

7 
	~<io¡»am
>

8 
	~<f¡»am
>

9 
	~<o¡»am
>

10 
	~<m­
>

11 
	~"th»ad/Th»ad.hµ
"

12 
	~"uts/basic_ÚuÎ¡»am.hµ
"

14 
	gLogg”
::
	$Logg”
(cÚ¡ *
Çme
) {

15 ià(!
š™Ÿli£d
) {

16 
throw
 
¡d
::
	`ruÁime_”rÜ
("Logging framework‚ot initialized.");

21 ià(
Çme
 =ğ
NULL
) {

22 
logSŒ—m
 = &
¡d
::
û¼
;

23 } ià(!
mÙiÚ
 && (
	`¡rcmp
(
Çme
, "Motion") == 0)) {

24 
logSŒ—m
 = 
Ãw
 
ÚuÎ¡»am
;

26 
logSŒ—m
 = 
Ãw
 
¡d
::
	`of¡»am
((
logP©h
 + std::
	`¡ršg
("/"è+ std::¡ršg(
Çme
)).
	`c_¡r
(), std::
ios_ba£
::
out
);

29 
	}
}

31 
	gLogg”
::~
	$Logg”
() {

32 ià(
logSŒ—m
 !ğ
¡d
::
û¼
) {

33 
d–‘e
 
logSŒ—m
;

35 
logSŒ—m
 = 
NULL
;

36 
	}
}

38 
	gLogg”
::
	$š™
(
¡d
::
¡ršg
 
logLev–_
, 
boŞ
 
mÙiÚ_
) {

39 
¡d
::
m­
<¡d::
¡ršg
, 
LogLev–
> 
logLev–s
;

40 
logLev–s
["NONE"] = 
NONE
;

41 
logLev–s
["SILENT"] = 
SILENT
;

42 
logLev–s
["QUIET"] = 
QUIET
;

43 
logLev–s
["FATAL"] = 
FATAL
;

44 
logLev–s
["ERROR"] = 
ERROR
;

45 
logLev–s
["WARNING"] = 
WARNING
;

46 
logLev–s
["INFO"] = 
INFO
;

47 
logLev–s
["VERBOSE"] = 
VERBOSE
;

49 
logLev–s
["DEBUG1"] = 
DEBUG1
;

50 
logLev–s
["DEBUG2"] = 
DEBUG2
;

51 
logLev–s
["DEBUG3"] = 
DEBUG3
;

52 
logLev–
 = 
logLev–s
[
logLev–_
];

53 
mÙiÚ
 = 
mÙiÚ_
;

54 
	}
}

56 
	gLogg”
::
	$š™
(
¡d
::
¡ršg
 
logP©h_
, std::¡ršg 
logLev–_
, 
boŞ
 
mÙiÚ_
) {

57 
	`š™
(
logLev–_
, 
mÙiÚ_
);

58 
logP©h
 = 
logP©h_
;

59 
	`sy¡em
((
¡d
::
	`¡ršg
("/bš/mkdœ -°"è+ 
logP©h
).
	`c_¡r
());

60 
š™Ÿli£d
 = 
Œue
;

61 
	}
}

63 
	gLogg”
::
	$»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
) {

64 
Logg”
::
	`š™
(
cÚfig
["debug.log"].
as
<
¡d
::
¡ršg
>(),

65 
cÚfig
["debug.log.mÙiÚ"].
as
<
boŞ
>());

66 
	}
}

68 
Logg”
 *
	gLogg”
::
	$š¡ªû
() {

69 ià(
logg”
 =ğ
NULL
) {

70 
logg”
 = 
Ãw
 
	`Logg”
(
Th»ad
::
Çme
);

72  
logg”
;

73 
	}
}

75 
	g¡d
::
o¡»am
 &
Logg”
::
	$»®Llog
(
logLev–_
) {

76 ià(
logLev–
 >ğ
logLev–_
) {

77  *
logSŒ—m
;

79 
ÚuÎ¡»am
 
nuÎSŒ—m
;

80  
nuÎSŒ—m
;

82 
	}
}

84 
	g¡d
::
o¡»am
 &
Logg”
::
	$»®Llog
(
logLev–_
, 
šd’tInc_
) {

85 
šd’tLev–
 = 
¡d
::
	`mš
(0, ind’tLev– + 
šd’tInc_
);

86 
i
 = 0; i < 
šd’tLev–
; ++i) {

87 *
logSŒ—m
 << " ";

89 ià(
šd’tInc_
 > 0è*
logSŒ—m
 << "BEGIN: ";

90 ià(
šd’tInc_
 < 0è*
logSŒ—m
 << "END: ";

91  
Logg”
::
	`»®Llog
(
logLev–_
);

92 
	}
}

94 
__th»ad
 
Logg”
 *
	gLogg”
::
logg”
 = 
NULL
;

95 
boŞ
 
	gLogg”
::
š™Ÿli£d
 = 
çl£
;

96 
boŞ
 
	gLogg”
::
mÙiÚ
;

97 
	gLogg”
::
šd’tLev–
 = 0;

98 
	g¡d
::
¡ršg
 
Logg”
::
logP©h
;

99 
LogLev–
 
	gLogg”
::
logLev–
;

	@robot/utils/Logger.hpp

1 #´agm¨
Úû


3 
	~<¡ršg
>

4 
	~<o¡»am
>

5 
	~<boo¡/´og¿m_İtiÚs/v¬ŸbËs_m­.hµ
>

7 
	#Îog
(
X
è((
Logg”
::
	`š¡ªû
())->
	`»®Llog
(X))

	)

8 
	#Îog_İ’
(
X
è((
Logg”
::
	`š¡ªû
())->
	`»®Llog
(X, 1))

	)

9 
	#Îog_middË
(
X
è((
Logg”
::
	`š¡ªû
())->
	`»®Llog
(X, 0))

	)

10 
	#Îog_şo£
(
X
è((
Logg”
::
	`š¡ªû
())->
	`»®Llog
(X, -1))

	)

26 
	eLogLev–
 {

27 
	mNONE
 = -200,

28 
	mSILENT
 = -100,

29 
	mQUIET
 = -67,

30 
	mFATAL
 = -33,

31 
	mERROR
 = 0,

32 
	mWARNING
 = 10,

33 
	mINFO
 = 20,

34 
	mVERBOSE
 = 40,

35 
	mDEBUG
 = 60,

36 
	mDEBUG1
 = 60,

37 
	mDEBUG2
 = 80,

38 
	mDEBUG3
 = 100

41 şas 
	cLogg”
 {

42 
	mpublic
:

43 
Logg”
(cÚ¡ *
Çme
);

44 
	mvœtu®
 ~
Logg”
();

45 
š™
(
¡d
::
¡ršg
 
logP©h
, std::¡ršg 
logLev–
, 
boŞ
 
mÙiÚ
);

46 
Logg”
 *
š¡ªû
();

47 
	m¡d
::
o¡»am
 &
»®Llog
(
logLev–
);

48 
	m¡d
::
o¡»am
 &
»®Llog
(
logLev–
, 
šd’tInc
);

49 
»adO±iÚs
(cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
cÚfig
);

51 
	m´iv©e
:

52 
šd’tLev–
;

53 
š™
(
¡d
::
¡ršg
 
logLev–
, 
boŞ
 
mÙiÚ
);

54 
__th»ad
 
Logg”
 *
	mlogg”
;

55 
LogLev–
 
	mlogLev–
;

56 
boŞ
 
	mmÙiÚ
;

57 
	m¡d
::
¡ršg
 
logP©h
;

58 
boŞ
 
	mš™Ÿli£d
;

59 
	m¡d
::
o¡»am
 *
logSŒ—m
;

	@robot/utils/NaoVersion.cpp

1 
	~"NaoV”siÚ.hµ
"

3 
	~<sys/¡©.h
>

4 
	~<uni¡d.h
>

6 
	~"uts/Logg”.hµ
"

8 
NaoV”siÚ
 
	gÇoV”siÚ
 = 
Ço_un£t
;

10 
NaoV”siÚ
 
	$d‘”mšeNaoV”siÚ
()

12 
¡©
 
dummy
;

14 
boŞ
 
¡©_video0
 = 
	`¡©
("/dev/video0", &
dummy
);

15 
boŞ
 
¡©_video1
 = 
	`¡©
("/dev/video1", &
dummy
);

17 ià(
¡©_video0
 && 
¡©_video1
) {

18 
ÇoV”siÚ
 = 
Ço_v4
;

19 } ià(
¡©_video0
) {

20 
ÇoV”siÚ
 = 
Ço_v3
;

22 
	`Îog
(
WARNING
) << "DetermineNaoVersion: Could‚ot determine„obot version."

23 << 
¡d
::
’dl


25 << 
Ço_Ï‹¡
 << "." << 
¡d
::
’dl
;

26 
ÇoV”siÚ
 = 
Ço_Ï‹¡
;

28  
ÇoV”siÚ
;

29 
	}
}

	@robot/utils/NaoVersion.hpp

1 #´agm¨
Úû


6 
	eNaoV”siÚ


8 
	mÇo_un£t
 = 0,

10 
	mÇo_v3
 = 3,

11 
	mÇo_v4
 = 4,

13 
	mÇo_Ï‹¡
 = 
Ço_v4
,

20 
NaoV”siÚ
 
ÇoV”siÚ
;

26 
NaoV”siÚ
 
d‘”mšeNaoV”siÚ
();

	@robot/utils/ParameterOptimiser/Common.h

2 #´agm¨
Úû


4 
	~<c¡dlib
>

5 
	~<cm©h
>

7 
šlše
 
	$¿nd_¿nge
(
æoÜ
, 
ûšg
){

8  (()
	`¿nd
()/()
RAND_MAX
è* (
ûšg
-
æoÜ
) + floor;

9 
	}
}

11 
šlše
 
	$ş
(
v¬
, 
mš
, 
max
){

12 if(
v¬
 < 
mš
){ var = min; }

13 if(
v¬
 > 
max
){ var = max; }

14  
v¬
;

15 
	}
}

17 
šlše
 
	$gaussŸn_noi£
(
m—n
, 
sd
){

19 
x
, 
y
, 
r2
;

23 
x
 = -1 + 2 * ()
	`¿nd
()/()
RAND_MAX
;

24 
y
 = -1 + 2 * ()
	`¿nd
()/()
RAND_MAX
;

27 
r2
 = 
x
 * x + 
y
 * y;

28 } 
r2
 > 1.0 ||„2 == 0);

31  
m—n
 + 
sd
 * 
y
 * 
	`sq¹
 (-2.0 * 
	`log
 (
r2
) /„2);

32 
	}
}

	@robot/utils/ParameterOptimiser/NelderMead.cpp

2 
	~"N–d”M—d.h
"

3 
	~"O±imi£r.h
"

4 
	~"CommÚ.h
"

5 
	~<®gÜ™hm
>

6 
	~<veùÜ
>

7 
	~<ÿs£¹
>

8 
	~<io¡»am
>

10 
	g¡d
::
veùÜ
<> 
N–d”M—d
::
	$İtimi£
(
O±imi§bËFunùiÚ
 *
rg‘
, 
num_·¿ms
,

11 
max_ev®s
){

13 
¡d
::
veùÜ
<> 
lowe¡_coÜd
;

14 
lowe¡_v®ue
 = 0.0f;

16 
this
->
num_·¿ms
 =‚um_params;

17 
sim¶ex_v”‹x
 = 
	`ü—‹In™ŸlSim¶ex
(
rg‘
, 
num_·¿ms
);

19 
SVComp
 
comp
;

20 
	`sÜt
(
sim¶ex_v”‹x
.
	`begš
(), sim¶ex_v”‹x.
	`’d
(), 
comp
);

22 
™”
 = 0; i‹¸< 
max_ev®s
; iter++){

24 
¡d
::
veùÜ
<> 
ûÁ»_of_mass
 = 
	`ûÁ»OfMass
(
sim¶ex_v”‹x
, sim¶ex_v”‹x.
	`size
() - 1);

27 
N–d”M—d
::
Sim¶exV”‹x
 
»æeùed_v”‹x
 =

28 
	`»æeùedV”‹x
(
rg‘
, 
sim¶ex_v”‹x
.
	`back
(), 
ûÁ»_of_mass
);

31 if(
»æeùed_v”‹x
.
v®ue
 < 
sim¶ex_v”‹x
.
	`äÚt
().value){

32 
N–d”M—d
::
Sim¶exV”‹x
 
ex‹nded_v”‹x
 =

33 
	`»æeùedV”‹x
(
rg‘
, 
sim¶ex_v”‹x
.
	`back
(), 
ûÁ»_of_mass
, 2.0f);

35 if(
ex‹nded_v”‹x
.
v®ue
 < 
»æeùed_v”‹x
.value){

36 
sim¶ex_v”‹x
.
	`back
(èğ
ex‹nded_v”‹x
;

39 
sim¶ex_v”‹x
.
	`back
(èğ
»æeùed_v”‹x
;

44 if(
»æeùed_v”‹x
.
v®ue
 <ğ
sim¶ex_v”‹x
.
	`©
(sim¶ex_v”‹x.
	`size
() - 2).value){

45 
sim¶ex_v”‹x
.
	`back
(èğ
»æeùed_v”‹x
;

50 if(
»æeùed_v”‹x
.
v®ue
 < 
sim¶ex_v”‹x
.
	`back
().value){

51 
sim¶ex_v”‹x
.
	`back
(èğ
	`cÚŒaùedV”‹x
(
rg‘
, sim¶ex_v”‹x.back(), 
ûÁ»_of_mass
);

57 
i
 = 1; i < 
sim¶ex_v”‹x
.
	`size
(); i++){

58 
sim¶ex_v”‹x
.
	`©
(
i
èğ
	`cÚŒaùedV”‹x
(
rg‘
, simplex_vertex.at(i),

59 
sim¶ex_v”‹x
.
	`äÚt
().
coÜd
);

63 
	`sÜt
(
sim¶ex_v”‹x
.
	`begš
(), sim¶ex_v”‹x.
	`’d
(), 
comp
);

65 if(
sim¶ex_v”‹x
.
	`äÚt
().
v®ue
 < 
lowe¡_v®ue
 || 
™”
 == 0){

66 
lowe¡_coÜd
 = 
sim¶ex_v”‹x
.
	`äÚt
().
coÜd
;

67 
lowe¡_v®ue
 = 
sim¶ex_v”‹x
.
	`äÚt
().
v®ue
;

71  
lowe¡_coÜd
;

72 
	}
}

74 
	g¡d
::
veùÜ
<> 
N–d”M—d
::
ûÁ»OfMass
(cÚ¡ 
¡d
::veùÜ<N–d”M—d::
Sim¶exV”‹x
> &
v”tiûs
,

75 
num_v”tiûs
){

76 
	g¡d
::
veùÜ
<> 
»suÉ
(
num_·¿ms
, 0.0f);

77 
	gv®_sum
 = 0.0f;

79 
	gi
 = 0; i < 
	gnum_v”tiûs
; i++){

80 
as£¹
(
v”tiûs
.
©
(
i
).
coÜd
.
size
(è=ğ
num_·¿ms
);

82 
	gj
 = 0; j < 
	gv”tiûs
.
©
(
i
).
	gcoÜd
.
size
(); j++){

83 
	g»suÉ
.
©
(
j
è+ğ
v”tiûs
.©(
i
).
coÜd
.©(jè* v”tiûs.©(i).
v®ue
;

86 
	gv®_sum
 +ğ
v”tiûs
.
©
(
i
).
v®ue
;

89 
	gi
 = 0; i < 
	g»suÉ
.
size
(); i++){

90 
	g»suÉ
.
©
(
i
è/ğ
v®_sum
;

93  
	g»suÉ
;

97 
	g¡d
::
veùÜ
<
N–d”M—d
::
Sim¶exV”‹x
> N–d”M—d::
	$ü—‹In™ŸlSim¶ex
(

98 
O±imi§bËFunùiÚ
 *
rg‘
, 
dim
){

100 
¡d
::
veùÜ
<
N–d”M—d
::
Sim¶exV”‹x
> 
»suÉ
;

101 
N–d”M—d
::
Sim¶exV”‹x
 
´ime_v”‹x
;

103 
i
 = 0; i < 
dim
; i++){

104 
´ime_v”‹x
.
coÜd
.
	`push_back
(0.5f);

107 
»suÉ
.
	`push_back
(
´ime_v”‹x
);

111 
i
 = 0; i < 
dim
; i++){

112 
N–d”M—d
::
Sim¶exV”‹x
 
Ãw_v”‹x
 = 
´ime_v”‹x
;

113 
Ãw_v”‹x
.
coÜd
.
	`©
(
i
) += 0.01f;

114 
»suÉ
.
	`push_back
(
Ãw_v”‹x
);

118 
i
 = 0; i < 
»suÉ
.
	`size
(); i++){

119 
»suÉ
.
	`©
(
i
).
v®ue
 = 
rg‘
->
	`ev®
ÔesuÉ.©(i).
coÜd
);

122 
	`as£¹
(
»suÉ
.
	`size
(è=ğ
dim
+1);

123  
»suÉ
;

124 
	}
}

126 
	gN–d”M—d
::
Sim¶exV”‹x
 
N–d”M—d
::
»æeùedV”‹x
(
O±imi§bËFunùiÚ
 *
rg‘
,

127 cÚ¡ 
N–d”M—d
::
Sim¶exV”‹x
 &
v”‹x
, cÚ¡ 
¡d
::
veùÜ
<> &
½ošt
,

128 
»æeù_di¡
){

130 
as£¹
(
½ošt
.
size
(è=ğ
v”‹x
.
coÜd
.size());

132 
	gN–d”M—d
::
Sim¶exV”‹x
 
»suÉ
;

133 
	gi
 = 0; i < 
	gv”‹x
.
	gcoÜd
.
size
(); i++){

134 
	g»suÉ
.
	gcoÜd
.
push_back
(
½ošt
.
©
(
i
è+ 
»æeù_di¡
*Ôpošt.©(iè- 
v”‹x
.
coÜd
.at(i)));

137 
as£¹
(
»suÉ
.
coÜd
.
size
(è=ğ
½ošt
.size());

138 
	g»suÉ
.
	gv®ue
 = 
rg‘
->
ev®
(
»suÉ
.
coÜd
);

139  
	g»suÉ
;

142 
	gN–d”M—d
::
Sim¶exV”‹x
 
N–d”M—d
::
cÚŒaùedV”‹x
(
O±imi§bËFunùiÚ
 *
rg‘
,

143 cÚ¡ 
N–d”M—d
::
Sim¶exV”‹x
 &
v”‹x
, cÚ¡ 
¡d
::
veùÜ
<> &
ıošt
,

144 
cÚŒaù_¿tio
){

146 
as£¹
(
ıošt
.
size
(è=ğ
v”‹x
.
coÜd
.size());

148 
	gN–d”M—d
::
Sim¶exV”‹x
 
»suÉ
;

149 
	gi
 = 0; i < 
	gv”‹x
.
	gcoÜd
.
size
(); i++){

150 
	g»suÉ
.
	gcoÜd
.
push_back
(
ıošt
.
©
(
i
è+ 
cÚŒaù_¿tio
*(
v”‹x
.
coÜd
.at(i) - cpoint.at(i)));

153 
as£¹
(
»suÉ
.
coÜd
.
size
(è=ğ
ıošt
.size());

154 
	g»suÉ
.
	gv®ue
 = 
rg‘
->
ev®
(
»suÉ
.
coÜd
);

155  
	g»suÉ
;

	@robot/utils/ParameterOptimiser/NelderMead.h

32 #´agm¨
Úû


34 
	~"O±imi£r.h
"

35 
	~<veùÜ
>

41 şas 
	cN–d”M—d
 : 
public
 
O±imi£r
 {

42 
public
:

43 
¡d
::
veùÜ
<> 
İtimi£
(
O±imi§bËFunùiÚ
 *
rg‘
, 
num_·¿ms
,

44 
max_ev®s
);

46 
	m´iv©e
:

48 
	sSim¶exV”‹x
 {

49 
¡d
::
veùÜ
<> 
coÜd
;

50 
	mv®ue
;

53 
	sSVComp
 {

54 
boŞ
 
İ”©Ü
()(cÚ¡ 
	gSim¶exV”‹x
 &
	gv1
, cÚ¡ Sim¶exV”‹x &
	gv2
){

55  
	gv1
.
	gv®ue
 < 
	gv2
.value;

59 
	gnum_·¿ms
;

60 
	g¡d
::
veùÜ
<
Sim¶exV”‹x
> 
sim¶ex_v”‹x
;

62 
	g¡d
::
veùÜ
<> 
ûÁ»OfMass
(cÚ¡ 
¡d
::veùÜ<
Sim¶exV”‹x
> &
v”tiûs
, 
num_v”tiûs
);

64 
	g¡d
::
veùÜ
<
Sim¶exV”‹x
> 
ü—‹In™ŸlSim¶ex
(
O±imi§bËFunùiÚ
 *
rg‘
, 
dim
);

66 
Sim¶exV”‹x
 
»æeùedV”‹x
(
O±imi§bËFunùiÚ
 *
rg‘
, cÚ¡ Sim¶exV”‹x &
v”‹x
,

67 cÚ¡ 
¡d
::
veùÜ
<> &
½ošt
, 
»æeù_di¡
=1.0f);

69 
Sim¶exV”‹x
 
cÚŒaùedV”‹x
(
O±imi§bËFunùiÚ
 *
rg‘
, cÚ¡ Sim¶exV”‹x &
v”‹x
,

70 cÚ¡ 
¡d
::
veùÜ
<> &
ıošt
, 
cÚŒaù_¿tio
 = 0.5f);

	@robot/utils/ParameterOptimiser/Optimiser.h

2 #´agm¨
Úû


4 
	~<veùÜ
>

6 şas 
	cO±imi§bËFunùiÚ
 {

7 
	mpublic
:

8 
vœtu®
 ~
	$O±imi§bËFunùiÚ
(){}

13 
vœtu®
 
	`ev®
(
¡d
::
veùÜ
<> &
·¿ms
) = 0;

14 
	}
};

19 şas 
	cO±imi£r
 {

20 
	mpublic
:

21 
vœtu®
 ~
	$O±imi£r
(){}

27 
vœtu®
 
¡d
::
veùÜ
<> 
	`İtimi£
(
O±imi§bËFunùiÚ
 *
rg‘
, 
num_·¿ms
,

28 
max_ev®s
) = 0;

29 
	}
};

	@robot/utils/ParameterOptimiser/ParticleSwarm.cpp

2 
	~"P¬tişeSw¬m.h
"

3 
	~"CommÚ.h
"

4 
	~<veùÜ
>

5 
	~<ÿs£¹
>

6 
	~<io¡»am
>

8 
	gP¬tişeSw¬m
::
	$P¬tişeSw¬m
(
num_·¹işes
è: 
	$num_·¹işes
(
num_·¹işes
è{
	}
}

10 
¡d
::
veùÜ
<> 
P¬tişeSw¬m
::
	$İtimi£
(
O±imi§bËFunùiÚ
 *
rg‘
, 
Å
,

11 
max_ev®s
){

13 
num_·¿ms
 = 
Å
;

14 
omega
 = 0.95f;

15 
c1
 = 0.3f;

16 
c2
 = 0.3f;

19 
i
 = 0; i < 
num_·¹işes
; i++){

20 
sw¬m
.
	`push_back
(
	`ü—‹In™ŸlP¬tişe
(
rg‘
));

21 if(
sw¬m
.
	`back
().
be¡_known_v®ue
 < 
be¡_glob®_v®ue
 || 
i
 == 0){

22 
be¡_glob®_v®ue
 = 
sw¬m
.
	`back
().
be¡_known_v®ue
;

23 
be¡_glob®_pos™iÚ
 = 
sw¬m
.
	`back
().
be¡_known_pos™iÚ
;

27 
´ev_be¡
 = 0.0f;

28 
™”
 = 0; i‹¸< 
max_ev®s
; iter++){

29 if(
™”
 =ğ0 || 
be¡_glob®_v®ue
 < 
´ev_be¡
){

30 
´ev_be¡
 = 
be¡_glob®_v®ue
;

32 
	`upd©eP¬tişes
(
rg‘
);

35  
be¡_glob®_pos™iÚ
;

36 
	}
}

38 
	gP¬tişeSw¬m
::
	$upd©eP¬tişes
(
O±imi§bËFunùiÚ
 *
rg‘
){

39 
i
 = 0; i < 
sw¬m
.
	`size
(); i++){

40 
¡d
::
veùÜ
<> 
r1
 = 
	`ü—‹RªdomVeùÜ
(
num_·¿ms
, 0.0f, 1.0f);

41 
¡d
::
veùÜ
<> 
r2
 = 
	`ü—‹RªdomVeùÜ
(
num_·¿ms
, 0.0f, 1.0f);

44 
sw¬m
.
	`©
(
i
).
pos™iÚ
 = 
	`compÚ’tAdd
(sw¬m.©(i).pos™iÚ, sw¬m.©(i).
v–oc™y
);

47 
j
 = 0; j < 
sw¬m
.
	`©
(
i
).
v–oc™y
.
	`size
(); j++){

48 
sw¬m
.
	`©
(
i
).
v–oc™y
.©(
j
èğ
omega
*swarm.at(i).velocity.at(j) +

49 
c1
*
r1
.
	`©
(
j
)*(
sw¬m
.©(
i
).
be¡_known_pos™iÚ
.©(jè- sw¬m.©(i).
pos™iÚ
.at(j)) +

50 
c2
*
r2
.
	`©
(
j
)*(
be¡_glob®_pos™iÚ
.©(jè- 
sw¬m
.©(
i
).
pos™iÚ
.at(j));

53 
cu¼’t_·¹işe_v®ue
 = 
rg‘
->
	`ev®
(
sw¬m
.
	`©
(
i
).
pos™iÚ
);

54 if(
cu¼’t_·¹işe_v®ue
 < 
sw¬m
.
	`©
(
i
).
be¡_known_v®ue
){

55 
sw¬m
.
	`©
(
i
).
be¡_known_v®ue
 = 
cu¼’t_·¹işe_v®ue
;

56 
sw¬m
.
	`©
(
i
).
be¡_known_pos™iÚ
 = sw¬m.©(i).
pos™iÚ
;

58 if(
cu¼’t_·¹işe_v®ue
 < 
be¡_glob®_v®ue
){

59 
be¡_glob®_v®ue
 = 
cu¼’t_·¹işe_v®ue
;

60 
be¡_glob®_pos™iÚ
 = 
sw¬m
.
	`©
(
i
).
pos™iÚ
;

64 
	}
}

66 
	g¡d
::
veùÜ
<> 
P¬tişeSw¬m
::
	$ü—‹RªdomVeùÜ
(
Ëngth
, 
mš
, 
max
){

67 
¡d
::
veùÜ
<> 
»suÉ
;

68 
i
 = 0; i < 
Ëngth
; i++){

69 
»suÉ
.
	`push_back
(
	`¿nd_¿nge
(
mš
, 
max
));

71  
»suÉ
;

72 
	}
}

74 
	g¡d
::
veùÜ
<> 
P¬tişeSw¬m
::
compÚ’tMuÉly
(cÚ¡ 
¡d
::veùÜ<> &
v¬1
,

75 cÚ¡ 
¡d
::
veùÜ
<> &
v¬2
){

76 
as£¹
(
v¬1
.
size
(è=ğ
v¬2
.size());

77 
	g¡d
::
veùÜ
<> 
»suÉ
;

78 
	gi
 = 0; i < 
	gv¬1
.
size
(); i++){

79 
	g»suÉ
.
push_back
(
v¬1
.
©
(
i
è* 
v¬2
.at(i));

81  
	g»suÉ
;

84 
	g¡d
::
veùÜ
<> 
P¬tişeSw¬m
::
sÿÏrMuÉly
(
sÿl
,

85 cÚ¡ 
¡d
::
veùÜ
<> &
v¬
){

86 
¡d
::
veùÜ
<> 
»suÉ
;

87 
	gi
 = 0; i < 
	gv¬
.
size
(); i++){

88 
	g»suÉ
.
push_back
(
sÿl
 * 
v¬
.
©
(
i
));

90  
	g»suÉ
;

93 
	g¡d
::
veùÜ
<> 
P¬tişeSw¬m
::
compÚ’tAdd
(cÚ¡ 
¡d
::veùÜ<> &
v¬1
,

94 cÚ¡ 
¡d
::
veùÜ
<> &
v¬2
){

95 
as£¹
(
v¬1
.
size
(è=ğ
v¬2
.size());

96 
	g¡d
::
veùÜ
<> 
»suÉ
;

97 
	gi
 = 0; i < 
	gv¬1
.
size
(); i++){

98 
	g»suÉ
.
push_back
(
v¬1
.
©
(
i
è+ 
v¬2
.at(i));

100  
	g»suÉ
;

103 
	gP¬tişeSw¬m
::
P¬tişe
 
P¬tişeSw¬m
::
	$ü—‹In™ŸlP¬tişe
(
O±imi§bËFunùiÚ
 *
rg‘
){

104 
P¬tişeSw¬m
::
P¬tişe
 
Å
;

105 
Å
.
pos™iÚ
 = 
	`ü—‹RªdomVeùÜ
(
num_·¿ms
, -1.0f, 1.0f);

106 
Å
.
v–oc™y
 = 
¡d
::
veùÜ
<>(
num_·¿ms
, 0.0f);

108 
Å
.
be¡_known_pos™iÚ
 =‚p.
pos™iÚ
;

109 
Å
.
be¡_known_v®ue
 = 
rg‘
->
	`ev®
Òp.
pos™iÚ
);

111  
Å
;

112 
	}
}

	@robot/utils/ParameterOptimiser/ParticleSwarm.h

2 #´agm¨
Úû


4 
	~"O±imi£r.h
"

5 
	~<veùÜ
>

11 şas 
	cP¬tişeSw¬m
 : 
public
 
O±imi£r
 {

12 
public
:

13 
P¬tişeSw¬m
(
num_·¹işes
);

15 
	m¡d
::
veùÜ
<> 
İtimi£
(
O±imi§bËFunùiÚ
 *
rg‘
, 
num_·¿ms
,

16 
max_ev®s
);

18 
	m´iv©e
:

19 
	sP¬tişe
 {

20 
¡d
::
veùÜ
<> 
pos™iÚ
;

21 
	m¡d
::
veùÜ
<> 
v–oc™y
;

23 
	m¡d
::
veùÜ
<> 
be¡_known_pos™iÚ
;

24 
	mbe¡_known_v®ue
;

27 
	g¡d
::
veùÜ
<> 
be¡_glob®_pos™iÚ
;

28 
	gbe¡_glob®_v®ue
;

30 
	gnum_·¿ms
, 
	gnum_·¹işes
;

32 
	g¡d
::
veùÜ
<
P¬tişe
> 
sw¬m
;

33 
	gomega
, 
	gc1
, 
	gc2
;

35 
upd©eP¬tişes
(
O±imi§bËFunùiÚ
 *
rg‘
);

37 
	g¡d
::
veùÜ
<> 
ü—‹RªdomVeùÜ
(
Ëngth
, 
mš
, 
max
);

39 
	g¡d
::
veùÜ
<> 
compÚ’tMuÉly
(cÚ¡ 
¡d
::veùÜ<> &
v¬1
,

40 cÚ¡ 
¡d
::
veùÜ
<> &
v¬2
);

42 
	g¡d
::
veùÜ
<> 
sÿÏrMuÉly
(
sÿl
, cÚ¡ 
¡d
::veùÜ<> &
v¬
);

44 
	g¡d
::
veùÜ
<> 
compÚ’tAdd
(cÚ¡ 
¡d
::veùÜ<> &
v¬1
,

45 cÚ¡ 
¡d
::
veùÜ
<> &
v¬2
);

47 
P¬tişe
 
ü—‹In™ŸlP¬tişe
(
O±imi§bËFunùiÚ
 *
rg‘
);

	@robot/utils/SPLDefs.hpp

32 #´agm¨
Úû


38 
	#FIELD_LINE_WIDTH
 50

	)

60 #iâdeà
USING_SMALL_FIELD


61 
	#ROBOTS_PER_TEAM
 5

	)

64 
	#FIELD_WIDTH
 6000

	)

65 
	#FIELD_LENGTH
 9000

	)

67 
	#FIELD_LENGTH_OFFSET
 730

	)

68 
	#FIELD_WIDTH_OFFSET
 730

	)

70 
	#OFFNAO_FIELD_WIDTH_OFFSET
 730

	)

71 
	#OFFNAO_FIELD_LENGTH_OFFSET
 730

	)

74 
	#GOAL_BOX_WIDTH
 2200

	)

75 
	#GOAL_BOX_LENGTH
 600

	)

78 
	#MARKER_DIMENSIONS
 100

	)

79 
	#DIST_GOAL_LINE_TO_MARKER
 1300

	)

80 
	#MARKER_CENTER_X
 (
FIELD_LENGTH
 / 2 - 
DIST_GOAL_LINE_TO_MARKER
)

	)

83 
	#CENTER_CIRCLE_DIAMETER
 1500

	)

86 
	#GOAL_POST_DIAMETER
 100

	)

87 
	#GOAL_BAR_DIAMETER
 100

88 
	#GOAL_POST_HEIGHT
 800

89 

	)

90 
	#GOAL_SUPPORT_DIAMETER
 46

	)

91 
	#GOAL_WIDTH
 1600

	)

92 
	#GOAL_DEPTH
 500

	)

99 
	#ROBOTS_PER_TEAM
 5

	)

102 
	#FIELD_WIDTH
 6000

	)

103 
	#FIELD_LENGTH
 9000

	)

105 
	#FIELD_LENGTH_OFFSET
 730

	)

106 
	#FIELD_WIDTH_OFFSET
 730

	)

108 
	#OFFNAO_FIELD_WIDTH_OFFSET
 730

	)

109 
	#OFFNAO_FIELD_LENGTH_OFFSET
 730

	)

112 
	#GOAL_BOX_WIDTH
 2200

	)

113 
	#GOAL_BOX_LENGTH
 600

	)

116 
	#MARKER_DIMENSIONS
 100

	)

117 
	#DIST_GOAL_LINE_TO_MARKER
 1300

	)

118 
	#MARKER_CENTER_X
 (
FIELD_LENGTH
 / 2 - 
DIST_GOAL_LINE_TO_MARKER
)

	)

121 
	#CENTER_CIRCLE_DIAMETER
 1500

	)

124 
	#GOAL_POST_DIAMETER
 100

	)

125 
	#GOAL_BAR_DIAMETER
 100

126 
	#GOAL_POST_HEIGHT
 800

127 

	)

128 
	#GOAL_SUPPORT_DIAMETER
 46

	)

129 
	#GOAL_WIDTH
 1600

	)

130 
	#GOAL_DEPTH
 500

	)

134 
	#FULL_FIELD_WIDTH
 (
FIELD_WIDTH
 + (
FIELD_WIDTH_OFFSET
 * 2))

	)

135 
	#OFFNAO_FULL_FIELD_WIDTH
 (
FIELD_WIDTH
 + (
OFFNAO_FIELD_WIDTH_OFFSET
 * 2))

	)

136 
	#FULL_FIELD_LENGTH
 (
FIELD_LENGTH
 + (
FIELD_LENGTH_OFFSET
 * 2))

	)

137 
	#OFFNAO_FULL_FIELD_LENGTH
 (
FIELD_LENGTH
 + (
OFFNAO_FIELD_LENGTH_OFFSET
 * 2))

	)

149 
	#UNKNOWN_COORD
 10000

	)

150 
	#UNKNOWN_HEADING
 4.0

	)

153 
	#BALL_RADIUS
 50

	)

156 
	#GOAL_POST_ABS_X
 (
FIELD_LENGTH
 / 2)

	)

157 
	#GOAL_POST_ABS_Y
 (
GOAL_WIDTH
 / 2)

	)

	@robot/utils/Timer.hpp

35 #´agm¨
Úû


37 
	~<sys/time.h
>

38 
	~<¡dšt.h
>

39 
	~<time.h
>

55 şas 
	cTim”
 {

56 
	mpublic
:

57 
	$Tim”
() {

59 
	`g‘timeofday
(&
timeSmp
, 
NULL
);

61 
	$»¡¬t
() {

63 
	`g‘timeofday
(&
timeSmp
, 
NULL
);

64 
	}
}

66 
	$£c
(cÚ¡ 
timev®
& 
t
) {

67  
t
.
tv_£c
 +.
tv_u£c
 / 1000000.0;

68 
	}
}

69 
	$m£c
(cÚ¡ 
timev®
& 
t
) {

70  
t
.
tv_£c
 * 1000 +.
tv_u£c
 / 1000.0;

71 
	}
}

73 
	$u£c
(cÚ¡ 
timev®
& 
t
) {

74  
t
.
tv_£c
 * 1000000 +.
tv_u£c
;

75 
	}
}

78 
	$–­£d
() {

79 
timev®
 
tmp
;

80 
	`g‘timeofday
(&
tmp
, 
NULL
);

81  
	`£c
(
tmp
) -

82 
	`£c
(
timeSmp
);

83 
	}
}

85 
ušt32_t
 
	$–­£d_ms
() {

86 
timev®
 
tmp
;

87 
	`g‘timeofday
(&
tmp
, 
NULL
);

88  
	`m£c
(
tmp
è- m£c(
timeSmp
);

89 
	}
}

91 
ušt32_t
 
	$–­£d_us
() {

92 
timev®
 
tmp
;

93 
	`g‘timeofday
(&
tmp
, 
NULL
);

94  
	`u£c
(
tmp
è- u£c(
timeSmp
);

95 
	}
}

98 
	$–­£d_max
() {

102  
	`–­£d
();

103 
	}
}

106 
	$–­£d_mš
() {

107  
	`–­£d
();

108 
	}
}

110 
	g´iv©e
:

111 
timev®
 
timeSmp
;

	@robot/utils/angles.hpp

37 #´agm¨
Úû


39 
	~<cm©h
>

40 
	~"basic_m©hs.hµ
"

42 cÚ¡ 
	gDEG_OVER_RAD
 = 180 / 
M_PI
;

43 cÚ¡ 
	gRAD_OVER_DEG
 = 
M_PI
 / 180;

45 
šlše
 
	$RAD2DEG
(cÚ¡ 
x
) {

46  ((
x
è* 
DEG_OVER_RAD
);

47 
	}
}

49 
šlše
 
	$DEG2RAD
(cÚ¡ 
x
) {

50  ((
x
è* 
RAD_OVER_DEG
);

51 
	}
}

56 
šlše
 
	$RAD2DEG360
(cÚ¡ 
th‘a
) {

57 
deg»e
 = 
th‘a
 * 
DEG_OVER_RAD
;

58 ià(
deg»e
 < 0) {

59 
deg»e
 += 360;

61  
deg»e
;

62 
	}
}

64 
šlše
 
	$DEG360TORAD
(cÚ¡ 
deg»e
) {

65 
tmp
 = 
deg»e
 - 360 * (()(degree / 360));

66 ià(
tmp
 >= 180) {

67 
tmp
 =mp - 360;

69  (
	`DEG2RAD
(
tmp
));

70 
	}
}

74 
šlše
 
	$MIN_ANGLE_360
(cÚ¡ 
ªgËA
, cÚ¡ 
ªgËB
) {

75  ((()(
ªgËA
 + 180 - 
ªgËB
) % 360 - 180));

76 
	}
}

79 
šlše
 
	$MIN_THETA_DIFF
(
th‘aA
, 
th‘aB
) {

80 
th‘aA
 > 
M_PI
)hetaA -= 2.0f*M_PI;

81 
th‘aA
 < -
M_PI
)hetaA += 2.0f*M_PI;

83 
th‘aB
 > 
M_PI
)hetaB -= 2.0f*M_PI;

84 
th‘aB
 < -
M_PI
)hetaB += 2.0f*M_PI;

86  
	`fmš
(
	`çbs
(
th‘aA
 - 
th‘aB
), fabs(çbsÑh‘aA -h‘aBè- 2.0f*
M_PI
));

87 
	}
}

89 
šlše
 
	$NORMALISE
(
t
) {

90 
r
 = 
	`fmod
(
t
 - 
M_PI
, 2 * M_PI);

91  
r
 + (Ô > 0è? -
M_PI
 : M_PI);

92 
	}
}

94 
šlše
 
	$NORMALISE_PI_2
(
t
) {

95 ià(
t
 < -
M_PI_2
) {

96  
t
 + 
M_PI
;

97 } ià(
t
 > 
M_PI_2
) {

98  
t
 - 
M_PI
;

100  
t
;

102 
	}
}

	@robot/utils/basic_maths.hpp

32 #´agm¨
Úû


34 
	~<cm©h
>

35 
	~"ty³s/Pošt.hµ
"

37 #iâdeà
MAX


38 
	g‹m¶©e
 <
şass
 
	gT
>

39 
šlše
 
T
 
	$MAX
(cÚ¡ 
T
 &
x
, cÚ¡ T &
y
) {

40  (
x
 > 
y
 ? x : y);

41 
	}
}

42 
šlše
 
	$MAX
(cÚ¡ 
x
, cÚ¡ 
y
) {

43  (
x
 > 
y
 ? x : y);

44 
	}
}

45 
šlše
 
	$MAX
(cÚ¡ 
x
, cÚ¡ 
y
) {

46  (
x
 > 
y
 ? x : y);

47 
	}
}

50 #iâdeà
MIN


51 
	g‹m¶©e
 <
şass
 
	gT
>

52 
šlše
 
T
 
	$MIN
(cÚ¡ 
T
 &
x
, cÚ¡ T &
y
) {

53  (
x
 > 
y
 ? y : x);

54 
	}
}

55 
šlše
 
	$MIN
(cÚ¡ 
x
, cÚ¡ 
y
) {

56  (
x
 > 
y
 ? y : x);

57 
	}
}

58 
šlše
 
	$MIN
(cÚ¡ 
x
, cÚ¡ 
y
) {

59  (
x
 > 
y
 ? y : x);

60 
	}
}

63 
	g‹m¶©e
 <
şass
 
	gT
>

64 
šlše
 
T
 
	$ABS
(cÚ¡ 
T
 &
x
) {

65  (
x
 > 0 ? x : -x);

66 
	}
}

68 
	g‹m¶©e
 <
şass
 
	gT
>

69 
šlše
 
T
 
	$SQUARE
(cÚ¡ 
T
 &
x
) {

70  
x
 * x;

71 
	}
}

73 
	g‹m¶©e
 <
şass
 
	gT
>

74 
šlše
 
T
 
	$DISTANCE_SQR
(cÚ¡ 
T
 &
xA
,

75 cÚ¡ 
T
 &
yA
,

76 cÚ¡ 
T
 &
xB
,

77 cÚ¡ 
T
 &
yB
) {

78  
	`SQUARE
(
xA
 - 
xB
è+ SQUARE(
yA
 - 
yB
);

79 
	}
}

82 
šlše
 
	$DISTANCE
(cÚ¡ 
xA
,

83 cÚ¡ 
yA
,

84 cÚ¡ 
xB
,

85 cÚ¡ 
yB
) {

86  
	`sq¹
(
	`DISTANCE_SQR
(
xA
, 
yA
, 
xB
, 
yB
));

87 
	}
}

89 
	g‹m¶©e
 <
şass
 
	gT
>

90 
šlše
 
	$SIGN
(cÚ¡ 
T
 &
x
) {

91  (
x
 < 0 ? -1 : (x > 0) ? 1 : 0);

92 
	}
}

94 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

95 
šlše
 
T
 
	$üİ
(cÚ¡ 
T
 &
x
, cÚ¡ T &
mšimum
, cÚ¡ T &
maximum
)

97 ià(
x
 < 
mšimum
) {

98  
mšimum
;

99 } ià(
x
 > 
maximum
) {

100  
maximum
;

102  
x
;

104 
	}
}

106 
šlše
 
	$nÜm®i£Th‘a
(
th‘a
) {

107 
th‘a
 > 
M_PI
)heta -= 2.0f*M_PI;

108 
th‘a
 < -
M_PI
)heta += 2.0f*M_PI;

109  
th‘a
;

110 
	}
}

112 
šlše
 
	$poštSegm’tDi¡
(
Pošt
 
pošt
, Pošˆ
lšeS¹
, Pošˆ
lšeEnd
) {

113 
Pošt
 
v
;

114 
v
.
	`x
(èğ
lšeEnd
.x(è- 
lšeS¹
.x();

115 
v
.
	`y
(èğ
lšeEnd
.y(è- 
lšeS¹
.y();

117 
Pošt
 
w
;

118 
w
.
	`x
(èğ
pošt
.x(è- 
lšeS¹
.x();

119 
w
.
	`y
(èğ
pošt
.y(è- 
lšeS¹
.y();

121 
c1
 = 
w
.
	`x
()*
v
.x(è+ w.
	`y
()*v.y();

122 ià(
c1
 <= 0.0) {

123  
	`sq¹
(
w
.
	`x
()*w.x(è+ w.
	`y
()*w.y());

126 
c2
 = 
v
.
	`x
()*v.x(è+ v.
	`y
()*v.y();

127 ià(
c2
 <ğ
c1
) {

128 
dx
 = 
pošt
.
	`x
(è- 
lšeEnd
.x();

129 
dy
 = 
pošt
.
	`y
(è- 
lšeEnd
.y();

131  
	`sq¹
(
dx
*dx + 
dy
*dy);

134 
b
 = 
c1
 / 
c2
;

135 
Pošt
 
Pb
;

136 
Pb
.
	`x
(èğ
lšeS¹
.x(è+ 
v
.x()*
b
;

137 
Pb
.
	`y
(èğ
lšeS¹
.y(è+ 
v
.y()*
b
;

139 
dx
 = 
pošt
.
	`x
(è- 
Pb
.x();

140 
dy
 = 
pošt
.
	`y
(è- 
Pb
.y();

141  
	`sq¹
(
dx
*dx + 
dy
*dy);

142 
	}
}

	@robot/utils/basic_onullstream.hpp

32 #´agm¨
Úû


34 
	~<¡»ambuf
>

35 
	~<o¡»am
>

36 
	~<¡ršg
>

38 
	g‹m¶©e
 <
şass
 
	gcT
, cÏs 
	gŒa™s
 = 
¡d
::
ch¬_Œa™s
<
cT
> >

39 
şass
 
basic_nuÎbuf
 : 
public
 
¡d
::
basic_¡»ambuf
<
cT
, 
	gŒa™s
> {

40 
ty³Çme
 
	gŒa™s
::
št_ty³
 
ov”æow
Ñy³Çm
Œa™s
::št_ty³ 
c
) {

41  
Œa™s
::
nÙ_eof
(
c
);

45 
	g‹m¶©e
 <
şass
 
	gcT
, cÏs 
	gŒa™s
 = 
¡d
::
ch¬_Œa™s
<
cT
> >

46 
şass
 
basic_ÚuÎ¡»am
 : 
public
 
¡d
::
basic_o¡»am
<
cT
, 
	gŒa™s
> {

47 
	gpublic
:

48 
basic_ÚuÎ¡»am
() :

49 
¡d
::
basic_ios
<
cT
, 
	gŒa™s
>(&
	gm_sbuf
),

50 
	g¡d
::
basic_o¡»am
<
cT
, 
	gŒa™s
>(&
	gm_sbuf
) {

51 
š™
(&
m_sbuf
);

53 
	g´iv©e
:

54 
basic_nuÎbuf
<
cT
, 
	gŒa™s
> 
	gm_sbuf
;

57 
	gbasic_ÚuÎ¡»am
<> 
	tÚuÎ¡»am
;

58 
	gbasic_ÚuÎ¡»am
<
	twch¬_t
> 
	twÚuÎ¡»am
;

	@robot/utils/body.hpp

39 #´agm¨
Úû


41 
	~<io¡»am
>

42 
	~<cm©h
>

43 
	~<¡ršg
>

44 
	~<uts/m©rix_h–³rs.hµ
>

45 
	~"uts/ªgËs.hµ
"

48 
Çme¥aû
 
	gJošts
 {

50 
	eJoštCodesEnum
 {

51 
	gH—dYaw
 = 0,

52 
	gH—dP™ch
,

53 
	gLShould”P™ch
,

54 
	gLShould”RŞl
,

55 
	gLElbowYaw
,

56 
	gLElbowRŞl
,

57 
	gLWri¡Yaw
,

58 
	gLHªd
,

59 
	gLHYawP™ch
,

60 
	gLHRŞl
,

61 
	gLHP™ch
,

62 
	gLKÃeP™ch
,

63 
	gLAnkËP™ch
,

64 
	gLAnkËRŞl
,

65 
	gRHRŞl
,

66 
	gRHP™ch
,

67 
	gRKÃeP™ch
,

68 
	gRAnkËP™ch
,

69 
	gRAnkËRŞl
,

70 
	gRShould”P™ch
,

71 
	gRShould”RŞl
,

72 
	gRElbowYaw
,

73 
	gRElbowRŞl
,

74 
	gRWri¡Yaw
,

75 
	gRHªd
,

76 
	gNUMBER_OF_JOINTS


77 } 
	tJoštCode
;

79 cÚ¡ 
JoštCode
 
	gjoštCodes
[] = {

80 
H—dYaw
,

81 
H—dP™ch
,

82 
LShould”P™ch
,

83 
LShould”RŞl
,

84 
LElbowYaw
,

85 
LElbowRŞl
,

86 
LWri¡Yaw
,

87 
LHªd
,

88 
LHYawP™ch
,

89 
LHRŞl
,

90 
LHP™ch
,

91 
LKÃeP™ch
,

92 
LAnkËP™ch
,

93 
LAnkËRŞl
,

94 
RHRŞl
,

95 
RHP™ch
,

96 
RKÃeP™ch
,

97 
RAnkËP™ch
,

98 
RAnkËRŞl
,

99 
RShould”P™ch
,

100 
RShould”RŞl
,

101 
RElbowYaw
,

102 
RElbowRŞl
,

103 
RWri¡Yaw
,

104 
RHªd
,

108 cÚ¡ 
	g¡d
::
¡ršg
 
joštNames
[] = {

136 cÚ¡ 
	g¡d
::
¡ršg
 
æ™eJoštNames
[] = {

166 cÚ¡ 
	g¡d
::
¡ršg
 
simJoštNames
[] = {

193 
Çme¥aû
 
	gRadŸns
 {

194 cÚ¡ 
	gH—dYaw_Mš
 = 
DEG2RAD
(-119.5);

195 cÚ¡ 
	gH—dYaw_Max
 = 
DEG2RAD
(119.5);

196 cÚ¡ 
	gH—dP™ch_Mš
 = 
DEG2RAD
(-38.5);

197 cÚ¡ 
	gH—dP™ch_Max
 = 
DEG2RAD
(29.5);

198 cÚ¡ 
	gLShould”P™ch_Mš
 = 
DEG2RAD
(-119.5);

199 cÚ¡ 
	gLShould”P™ch_Max
 = 
DEG2RAD
(119.5);

200 cÚ¡ 
	gLShould”RŞl_Max
 = 
DEG2RAD
(76);

201 cÚ¡ 
	gLShould”RŞl_Mš
 = 
DEG2RAD
(-18);

202 cÚ¡ 
	gLElbowYaw_Mš
 = 
DEG2RAD
(-119.5);

203 cÚ¡ 
	gLElbowYaw_Max
 = 
DEG2RAD
(119.5);

204 cÚ¡ 
	gLElbowRŞl_Mš
 = 
DEG2RAD
(-88.5);

205 cÚ¡ 
	gLElbowRŞl_Max
 = 
DEG2RAD
(-2);

206 cÚ¡ 
	gLWri¡Yaw_Mš
 = 
DEG2RAD
(-104.5);

207 cÚ¡ 
	gLWri¡Yaw_Max
 = 
DEG2RAD
(104.5);

208 cÚ¡ 
	gLHªd_Mš
 = 0.0;

209 cÚ¡ 
	gLHªd_Max
 = 1.0;

210 cÚ¡ 
	gLHYawP™ch_Mš
 = 
DEG2RAD
(-65.62);

211 cÚ¡ 
	gLHYawP™ch_Max
 = 
DEG2RAD
(42.44);

212 cÚ¡ 
	gLHP™ch_Mš
 = 
DEG2RAD
(-101.63);

213 cÚ¡ 
	gLHP™ch_Max
 = 
DEG2RAD
(27.73);

214 cÚ¡ 
	gLHRŞl_Mš
 = 
DEG2RAD
(-21.74);

215 cÚ¡ 
	gLHRŞl_Max
 = 
DEG2RAD
(45.29);

216 cÚ¡ 
	gLKÃeP™ch_Mš
 = 
DEG2RAD
(-5.29);

217 cÚ¡ 
	gLKÃeP™ch_Max
 = 
DEG2RAD
(121.04);

218 cÚ¡ 
	gLAnkËP™ch_Mš
 = 
DEG2RAD
(-68.15);

219 cÚ¡ 
	gLAnkËP™ch_Max
 = 
DEG2RAD
(52.86);

220 cÚ¡ 
	gLAnkËRŞl_Mš
 = 
DEG2RAD
(-22.79);

221 cÚ¡ 
	gLAnkËRŞl_Max
 = 
DEG2RAD
(44.06);

222 cÚ¡ 
	gRHP™ch_Mš
 = 
DEG2RAD
(-101.54);

223 cÚ¡ 
	gRHP™ch_Max
 = 
DEG2RAD
(27.82);

224 cÚ¡ 
	gRHRŞl_Mš
 = 
DEG2RAD
(-42.30);

225 cÚ¡ 
	gRHRŞl_Max
 = 
DEG2RAD
(23.76);

226 cÚ¡ 
	gRKÃeP™ch_Mš
 = 
DEG2RAD
(-5.90);

227 cÚ¡ 
	gRKÃeP™ch_Max
 = 
DEG2RAD
(121.47);

228 cÚ¡ 
	gRAnkËP™ch_Mš
 = 
DEG2RAD
(-67.97);

229 cÚ¡ 
	gRAnkËP™ch_Max
 = 
DEG2RAD
(53.40);

230 cÚ¡ 
	gRAnkËRŞl_Mš
 = 
DEG2RAD
(-45.03);

231 cÚ¡ 
	gRAnkËRŞl_Max
 = 
DEG2RAD
(22.27);

232 cÚ¡ 
	gRShould”P™ch_Mš
 = 
DEG2RAD
(-119.5);

233 cÚ¡ 
	gRShould”P™ch_Max
 = 
DEG2RAD
(119.5);

234 cÚ¡ 
	gRShould”RŞl_Mš
 = 
DEG2RAD
(-76);

235 cÚ¡ 
	gRShould”RŞl_Max
 = 
DEG2RAD
(18);

236 cÚ¡ 
	gRElbowYaw_Mš
 = 
DEG2RAD
(-119.5);

237 cÚ¡ 
	gRElbowYaw_Max
 = 
DEG2RAD
(119.5);

238 cÚ¡ 
	gRElbowRŞl_Mš
 = 
DEG2RAD
(2);

239 cÚ¡ 
	gRElbowRŞl_Max
 = 
DEG2RAD
(88.5);

240 cÚ¡ 
	gRWri¡Yaw_Mš
 = 
DEG2RAD
(-104.5);

241 cÚ¡ 
	gRWri¡Yaw_Max
 = 
DEG2RAD
(104.5);

242 cÚ¡ 
	gRHªd_Mš
 = 0.0;

243 cÚ¡ 
	gRHªd_Max
 = 1.0;

246 cÚ¡ 
	gMaxAngË
[] = {

247 
H—dYaw_Max
,

248 
H—dP™ch_Max
,

249 
LShould”P™ch_Max
,

250 
LShould”RŞl_Max
,

251 
LElbowYaw_Max
,

252 
LElbowRŞl_Max
,

253 
LWri¡Yaw_Max
,

254 
LHªd_Max
,

255 
LHYawP™ch_Max
,

256 
LHRŞl_Max
,

257 
LHP™ch_Max
,

258 
LKÃeP™ch_Max
,

259 
LAnkËP™ch_Max
,

260 
LAnkËRŞl_Max
,

261 
RHRŞl_Max
,

262 
RHP™ch_Max
,

263 
RKÃeP™ch_Max
,

264 
RAnkËP™ch_Max
,

265 
RAnkËRŞl_Max
,

266 
RShould”P™ch_Max
,

267 
RShould”RŞl_Max
,

268 
RElbowYaw_Max
,

269 
RElbowRŞl_Max
,

270 
RWri¡Yaw_Max
,

271 
RHªd_Max


274 cÚ¡ 
	gMšAngË
[] = {

275 
H—dYaw_Mš
,

276 
H—dP™ch_Mš
,

277 
LShould”P™ch_Mš
,

278 
LShould”RŞl_Mš
,

279 
LElbowYaw_Mš
,

280 
LElbowRŞl_Mš
,

281 
LWri¡Yaw_Mš
,

282 
LHªd_Mš
,

283 
LHYawP™ch_Mš
,

284 
LHRŞl_Mš
,

285 
LHP™ch_Mš
,

286 
LKÃeP™ch_Mš
,

287 
LAnkËP™ch_Mš
,

288 
LAnkËRŞl_Mš
,

289 
RHRŞl_Mš
,

290 
RHP™ch_Mš
,

291 
RKÃeP™ch_Mš
,

292 
RAnkËP™ch_Mš
,

293 
RAnkËRŞl_Mš
,

294 
RShould”P™ch_Mš
,

295 
RShould”RŞl_Mš
,

296 
RElbowYaw_Mš
,

297 
RElbowRŞl_Mš
,

298 
RWri¡Yaw_Mš
,

299 
RHªd_Mš


320 
Çme¥aû
 
	gRadŸns
 {

322 cÚ¡ 
	gMOTOR1_REDUCTIONA_RAD
 = 
DEG2RAD
(2.23);

323 cÚ¡ 
	gMOTOR1_REDUCTIONB_RAD
 = 
DEG2RAD
(3.43);

324 cÚ¡ 
	gMOTOR2_REDUCTIONA_RAD
 = 
DEG2RAD
(8.96);

325 cÚ¡ 
	gMOTOR2_REDUCTIONB_RAD
 = 
DEG2RAD
(12.52);

326 cÚ¡ 
	gMOTOR3_REDUCTIONA_RAD
 = 
DEG2RAD
(3.85);

327 cÚ¡ 
	gMOTOR3_REDUCTIONB_RAD
 = 
DEG2RAD
(3.34);

329 cÚ¡ 
	gH—dP™chS³ed
 = 
MOTOR3_REDUCTIONB_RAD
;

330 cÚ¡ 
	gH—dYawS³ed
 = 
MOTOR3_REDUCTIONA_RAD
;

331 cÚ¡ 
	gShould”P™chS³ed
 = 
MOTOR3_REDUCTIONA_RAD
;

332 cÚ¡ 
	gShould”RŞlS³ed
 = 
MOTOR3_REDUCTIONB_RAD
;

333 cÚ¡ 
	gElbowYawS³ed
 = 
MOTOR3_REDUCTIONA_RAD
;

334 cÚ¡ 
	gElbowRŞlS³ed
 = 
MOTOR3_REDUCTIONB_RAD
;

335 cÚ¡ 
	gWri¡YawS³ed
 = 
MOTOR2_REDUCTIONA_RAD
;

336 cÚ¡ 
	gHªdS³ed
 = 
MOTOR2_REDUCTIONB_RAD
;

337 cÚ¡ 
	gHYawP™chS³ed
 = 
MOTOR1_REDUCTIONA_RAD
;

338 cÚ¡ 
	gHRŞlS³ed
 = 
MOTOR1_REDUCTIONA_RAD
;

339 cÚ¡ 
	gHP™chS³ed
 = 
MOTOR1_REDUCTIONB_RAD
;

340 cÚ¡ 
	gKÃeP™chS³ed
 = 
MOTOR1_REDUCTIONB_RAD
;

341 cÚ¡ 
	gAnkËP™chS³ed
 = 
MOTOR1_REDUCTIONB_RAD
;

342 cÚ¡ 
	gAnkËRŞlS³ed
 = 
MOTOR1_REDUCTIONA_RAD
;

344 cÚ¡ 
	gMaxS³ed
[] = {

345 
H—dYawS³ed
,

346 
H—dP™chS³ed
,

347 
Should”P™chS³ed
,

348 
Should”RŞlS³ed
,

349 
ElbowYawS³ed
,

350 
ElbowRŞlS³ed
,

351 
Wri¡YawS³ed
,

352 
HªdS³ed
,

353 
HYawP™chS³ed
,

354 
HRŞlS³ed
,

355 
HP™chS³ed
,

356 
KÃeP™chS³ed
,

357 
AnkËP™chS³ed
,

358 
AnkËRŞlS³ed
,

359 
HYawP™chS³ed
,

360 
HRŞlS³ed
,

361 
HP™chS³ed
,

362 
KÃeP™chS³ed
,

363 
AnkËP™chS³ed
,

364 
AnkËRŞlS³ed
,

365 
Should”P™chS³ed
,

366 
Should”RŞlS³ed
,

367 
ElbowYawS³ed
,

368 
ElbowRŞlS³ed
,

369 
Wri¡YawS³ed
,

370 
HªdS³ed


380 
šlše
 
lim™JoštRadŸns
(
JoštCode
 
jošt
, cÚ¡ &
ªgË
) {

381 ià(
	g¡d
::
i¢ª
(
ªgË
))  0.0;

382 ià(
	gªgË
 > 
	gRadŸns
::
MaxAngË
[
jošt
]è 
RadŸns
::MaxAngle[joint];

383 ià(
	gªgË
 < 
	gRadŸns
::
MšAngË
[
jošt
]è 
RadŸns
::MinAngle[joint];

384  
	gªgË
;

393 
Çme¥aû
 
	gLimbs
 {

394 cÚ¡ 
	gNeckOff£tZ
 = 126.50;

395 cÚ¡ 
	gShould”Off£tY
 = 98.00;

396 cÚ¡ 
	gElbowOff£tY
 = 15.00;

397 cÚ¡ 
	gUµ”ArmL’gth
 = 105.00;

398 cÚ¡ 
	gLow”ArmL’gth
 = 55.95;

399 cÚ¡ 
	gShould”Off£tZ
 = 100.00;

400 cÚ¡ 
	gHªdOff£tX
 = 57.75;

401 cÚ¡ 
	gHªdOff£tZ
 = 12.31;

402 cÚ¡ 
	gHOff£tZ
 = 85.00;

403 cÚ¡ 
	gHOff£tY
 = 50.00;

404 cÚ¡ 
	gThighL’gth
 = 100.00;

405 cÚ¡ 
	gTibŸL’gth
 = 102.90;

406 cÚ¡ 
	gFoÙHeight
 = 45.19;

408 cÚ¡ 
	gL’gth
[] = {

409 
NeckOff£tZ
,

410 
Should”Off£tY
,

411 
ElbowOff£tY
,

412 
Uµ”ArmL’gth
,

413 
Low”ArmL’gth
,

414 
Should”Off£tZ
,

415 
HªdOff£tX
,

416 
HªdOff£tZ
,

417 
HOff£tZ
,

418 
HOff£tY
,

419 
ThighL’gth
,

420 
TibŸL’gth
,

421 
FoÙHeight


424 cÚ¡ 
	gTÜsoMass
 = 1.04956;

425 cÚ¡ 
	gNeckMass
 = 0.06442;

426 cÚ¡ 
	gH—dMass
 = 0.60533;

427 cÚ¡ 
	gRightShould”Mass
 = 0.07504;

428 cÚ¡ 
	gRightBiûpMass
 = 0.15794;

429 cÚ¡ 
	gRightElbowMass
 = 0.06483;

430 cÚ¡ 
	gRightFÜ—rmMass
 = 0.07778;

431 cÚ¡ 
	gRightHªdMass
 = 0.18533;

432 cÚ¡ 
	gRightP–visMass
 = 0.07118;

433 cÚ¡ 
	gRightHMass
 = 0.13053;

434 cÚ¡ 
	gRightThighMass
 = 0.38976;

435 cÚ¡ 
	gRightTibŸMass
 = 0.29163;

436 cÚ¡ 
	gRightAnkËMass
 = 0.13415;

437 cÚ¡ 
	gRightFoÙMass
 = 0.16171;

438 cÚ¡ 
	gLeáShould”Mass
 = 0.07504;

439 cÚ¡ 
	gLeáBiûpMass
 = 0.15777;

440 cÚ¡ 
	gLeáElbowMass
 = 0.06483;

441 cÚ¡ 
	gLeáFÜ—rmMass
 = 0.07761;

442 cÚ¡ 
	gLeáHªdMass
 = 0.18533;

443 cÚ¡ 
	gLeáP–visMass
 = 0.06981;

444 cÚ¡ 
	gLeáHMass
 = 0.13053;

445 cÚ¡ 
	gLeáThighMass
 = 0.38968;

446 cÚ¡ 
	gLeáTibŸMass
 = 0.29142;

447 cÚ¡ 
	gLeáAnkËMass
 = 0.13416;

448 cÚ¡ 
	gLeáFoÙMass
 = 0.16184;

450 cÚ¡ 
	gMass
[] = {

451 
TÜsoMass
,

452 
NeckMass
,

453 
H—dMass
,

454 
RightShould”Mass
,

455 
RightBiûpMass
,

456 
RightElbowMass
,

457 
RightFÜ—rmMass
,

458 
RightHªdMass
,

459 
RightP–visMass
,

460 
RightHMass
,

461 
RightThighMass
,

462 
RightTibŸMass
,

463 
RightAnkËMass
,

464 
RightFoÙMass
,

465 
LeáShould”Mass
,

466 
LeáBiûpMass
,

467 
LeáElbowMass
,

468 
LeáFÜ—rmMass
,

469 
LeáHªdMass
,

470 
LeáP–visMass
,

471 
LeáHMass
,

472 
LeáThighMass
,

473 
LeáTibŸMass
,

474 
LeáAnkËMass
,

475 
LeáFoÙMass
,

481 cÚ¡ 
	gTÜsoCoM
[] = {-4.13, 0.09, 43.42, 1};

482 cÚ¡ 
	gNeckCoM
[] = {-0.01, 0.14, -27.42, 1};

483 cÚ¡ 
	gH—dCoM
[] = {-1.12, 0.03, 52.58, 1};

484 cÚ¡ 
	gRightShould”CoM
[] = {-1.65, 26.63, 0.14, 1};

485 cÚ¡ 
	gRightBiûpCoM
[] = {24.29, -9.52, 3.20, 1};

486 cÚ¡ 
	gRightElbowCoM
[] = {-27.44, 0.00, -0.14, 1};

487 cÚ¡ 
	gRightFÜ—rmCoM
[] = {25.52, -2.81, 0.90, 1};

488 cÚ¡ 
	gRightHªdCoM
[] = {34.34, -0.88, 3.08, 1};

489 cÚ¡ 
	gRightP–visCoM
[] = {-7.66, 12.00, 27.16, 1};

490 cÚ¡ 
	gRightHCoM
[] = {-15.49, -0.29, -5.16, 1};

491 cÚ¡ 
	gRightThighCoM
[] = {1.39, -2.25, -53.74, 1};

492 cÚ¡ 
	gRightTibŸCoM
[] = {3.94, -2.21, -49.38, 1};

493 cÚ¡ 
	gRightAnkËCoM
[] = {0.45, -0.30, 6.84, 1};

494 cÚ¡ 
	gRightFoÙCoM
[] = {25.40, -3.32, -32.39, 1};

495 cÚ¡ 
	gLeáShould”CoM
[] = {-1.65, -26.63, 0.14, 1};

496 cÚ¡ 
	gLeáBiûpCoM
[] = {24.55, 5.63, 3.30, 1};

497 cÚ¡ 
	gLeáElbowCoM
[] = {-27.44, 0.00, -0.14, 1};

498 cÚ¡ 
	gLeáFÜ—rmCoM
[] = {25.56, 2.81, 0.76, 1};

499 cÚ¡ 
	gLeáHªdCoM
[] = {34.34, -0.88, 3.08, 1};

500 cÚ¡ 
	gLeáP–visCoM
[] = {-7.81, -11.14, 26.61, 1};

501 cÚ¡ 
	gLeáHCoM
[] = {-15.49, 0.29, -5.15, 1};

502 cÚ¡ 
	gLeáThighCoM
[] = {1.38, 2.21, -53.73, 1};

503 cÚ¡ 
	gLeáTibŸCoM
[] = {4.53, 2.25, -49.36, 1};

504 cÚ¡ 
	gLeáAnkËCoM
[] = {0.45, 0.29, 6.85, 1};

505 cÚ¡ 
	gLeáFoÙCoM
[] = {25.42, 3.30, -32.39, 1};

508 
Çme¥aû
 
	gLEDs
 {

509 
	eLEDCode
 {

510 
	gLeáE¬1
 = 0,

511 
	gLeáE¬2
,

512 
	gLeáE¬3
,

513 
	gLeáE¬4
,

514 
	gLeáE¬5
,

515 
	gLeáE¬6
,

516 
	gLeáE¬7
,

517 
	gLeáE¬8
,

518 
	gLeáE¬9
,

519 
	gLeáE¬10
,

520 
	gRightE¬1
,

521 
	gRightE¬2
,

522 
	gRightE¬3
,

523 
	gRightE¬4
,

524 
	gRightE¬5
,

525 
	gRightE¬6
,

526 
	gRightE¬7
,

527 
	gRightE¬8
,

528 
	gRightE¬9
,

529 
	gRightE¬10
,

530 
	gLeáEyeRed1
,

531 
	gLeáEyeRed2
,

532 
	gLeáEyeRed3
,

533 
	gLeáEyeRed4
,

534 
	gLeáEyeRed5
,

535 
	gLeáEyeRed6
,

536 
	gLeáEyeRed7
,

537 
	gLeáEyeRed8
,

538 
	gLeáEyeG»’1
,

539 
	gLeáEyeG»’2
,

540 
	gLeáEyeG»’3
,

541 
	gLeáEyeG»’4
,

542 
	gLeáEyeG»’5
,

543 
	gLeáEyeG»’6
,

544 
	gLeáEyeG»’7
,

545 
	gLeáEyeG»’8
,

546 
	gLeáEyeBlue1
,

547 
	gLeáEyeBlue2
,

548 
	gLeáEyeBlue3
,

549 
	gLeáEyeBlue4
,

550 
	gLeáEyeBlue5
,

551 
	gLeáEyeBlue6
,

552 
	gLeáEyeBlue7
,

553 
	gLeáEyeBlue8
,

554 
	gRightEyeRed1
,

555 
	gRightEyeRed2
,

556 
	gRightEyeRed3
,

557 
	gRightEyeRed4
,

558 
	gRightEyeRed5
,

559 
	gRightEyeRed6
,

560 
	gRightEyeRed7
,

561 
	gRightEyeRed8
,

562 
	gRightEyeG»’1
,

563 
	gRightEyeG»’2
,

564 
	gRightEyeG»’3
,

565 
	gRightEyeG»’4
,

566 
	gRightEyeG»’5
,

567 
	gRightEyeG»’6
,

568 
	gRightEyeG»’7
,

569 
	gRightEyeG»’8
,

570 
	gRightEyeBlue1
,

571 
	gRightEyeBlue2
,

572 
	gRightEyeBlue3
,

573 
	gRightEyeBlue4
,

574 
	gRightEyeBlue5
,

575 
	gRightEyeBlue6
,

576 
	gRightEyeBlue7
,

577 
	gRightEyeBlue8
,

578 
	gChe¡Red
,

579 
	gChe¡G»’
,

580 
	gChe¡Blue
,

581 
	gLeáFoÙRed
,

582 
	gLeáFoÙG»’
,

583 
	gLeáFoÙBlue
,

584 
	gRightFoÙRed
,

585 
	gRightFoÙG»’
,

586 
	gRightFoÙBlue
,

587 
	gNUMBER_OF_LEDS


590 cÚ¡ 
	g¡d
::
¡ršg
 
ËdNames
[
NUMBER_OF_LEDS
] = {

671 
Çme¥aû
 
	gS’sÜs
 {

678 cÚ¡ 
	gFSR_POS
[2][4][2] = {

685 
	eS’sÜCodesEnum
 {

686 
	gIÃ¹ŸlS’sÜ_AccX
 = 0,

687 
	gIÃ¹ŸlS’sÜ_AccY
,

688 
	gIÃ¹ŸlS’sÜ_AccZ
,

689 
	gIÃ¹ŸlS’sÜ_GyrX
,

690 
	gIÃ¹ŸlS’sÜ_GyrY
,

691 
	gIÃ¹ŸlS’sÜ_GyrRef
,

692 
	gIÃ¹ŸlS’sÜ_AngËX
,

693 
	gIÃ¹ŸlS’sÜ_AngËY
,

695 
	gIÃ¹ŸlS’sÜ_GyroscİeX
,

696 
	gIÃ¹ŸlS’sÜ_GyroscİeY
,

697 
	gIÃ¹ŸlS’sÜ_GyroscİeZ
,

698 
	gIÃ¹ŸlS’sÜ_AcûËrom‘”X
,

699 
	gIÃ¹ŸlS’sÜ_AcûËrom‘”Y
,

700 
	gIÃ¹ŸlS’sÜ_AcûËrom‘”Z
,

702 
	gLFoÙ_FSR_FrÚtLeá
,

703 
	gLFoÙ_FSR_FrÚtRight
,

704 
	gLFoÙ_FSR_R—rLeá
,

705 
	gLFoÙ_FSR_R—rRight
,

706 
	gLFoÙ_FSR_C’‹rOfP»ssu»_X
,

707 
	gLFoÙ_FSR_C’‹rOfP»ssu»_Y
,

709 
	gRFoÙ_FSR_FrÚtLeá
,

710 
	gRFoÙ_FSR_FrÚtRight
,

711 
	gRFoÙ_FSR_R—rLeá
,

712 
	gRFoÙ_FSR_R—rRight
,

713 
	gRFoÙ_FSR_C’‹rOfP»ssu»_X
,

714 
	gRFoÙ_FSR_C’‹rOfP»ssu»_Y
,

716 
	gLFoÙ_Bum³r_Leá
,

717 
	gLFoÙ_Bum³r_Right
,

718 
	gRFoÙ_Bum³r_Leá
,

719 
	gRFoÙ_Bum³r_Right
,

721 
	gChe¡Bßrd_Bu‰Ú
,

723 
	gH—d_Touch_FrÚt
,

724 
	gH—d_Touch_R—r
,

725 
	gH—d_Touch_MiddË
,

727 
	gB©‹ry_Ch¬ge
,

728 
	gB©‹ry_Cu¼’t
,

729 
	gUS
,

731 
	gNUMBER_OF_SENSORS


732 } 
	tS’sÜCode
;

734 cÚ¡ 
S’sÜCode
 
	g£nsÜCodes
[] = {

735 
IÃ¹ŸlS’sÜ_AccX
,

736 
IÃ¹ŸlS’sÜ_AccY
,

737 
IÃ¹ŸlS’sÜ_AccZ
,

738 
IÃ¹ŸlS’sÜ_GyrX
,

739 
IÃ¹ŸlS’sÜ_GyrY
,

740 
IÃ¹ŸlS’sÜ_GyrRef
,

741 
IÃ¹ŸlS’sÜ_AngËX
,

742 
IÃ¹ŸlS’sÜ_AngËY
,

744 
IÃ¹ŸlS’sÜ_GyroscİeX
,

745 
IÃ¹ŸlS’sÜ_GyroscİeY
,

746 
IÃ¹ŸlS’sÜ_GyroscİeZ
,

747 
IÃ¹ŸlS’sÜ_AcûËrom‘”X
,

748 
IÃ¹ŸlS’sÜ_AcûËrom‘”Y
,

749 
IÃ¹ŸlS’sÜ_AcûËrom‘”Z
,

751 
LFoÙ_FSR_FrÚtLeá
,

752 
LFoÙ_FSR_FrÚtRight
,

753 
LFoÙ_FSR_R—rLeá
,

754 
LFoÙ_FSR_R—rRight
,

755 
LFoÙ_FSR_C’‹rOfP»ssu»_X
,

756 
LFoÙ_FSR_C’‹rOfP»ssu»_Y
,

758 
RFoÙ_FSR_FrÚtLeá
,

759 
RFoÙ_FSR_FrÚtRight
,

760 
RFoÙ_FSR_R—rLeá
,

761 
RFoÙ_FSR_R—rRight
,

762 
RFoÙ_FSR_C’‹rOfP»ssu»_X
,

763 
RFoÙ_FSR_C’‹rOfP»ssu»_Y
,

765 
LFoÙ_Bum³r_Leá
,

766 
LFoÙ_Bum³r_Right
,

767 
RFoÙ_Bum³r_Leá
,

768 
RFoÙ_Bum³r_Right
,

770 
Che¡Bßrd_Bu‰Ú
,

772 
H—d_Touch_FrÚt
,

773 
H—d_Touch_R—r
,

774 
H—d_Touch_MiddË
,

776 
B©‹ry_Ch¬ge
,

777 
B©‹ry_Cu¼’t
,

778 
US


781 cÚ¡ 
	g¡d
::
¡ršg
 
£nsÜNames
[] = {

829 
Çme¥aû
 
	gSÚ¬
 {

832 
Çme¥aû
 
	gMode
 {

833 cÚ¡ 
	gNO_PING
 = -1.f;

834 cÚ¡ 
	gTLRL
 = 0.0f;

835 cÚ¡ 
	gTLRR
 = 1.0f;

836 cÚ¡ 
	gTRRL
 = 2.0f;

837 cÚ¡ 
	gTRRR
 = 3.0f;

838 cÚ¡ 
	gRBOTH
 = 4.0f;

839 cÚ¡ 
	gTBOTH
 = 8.0f;

840 cÚ¡ 
	gCONTINUOUS
 = 64.0f;

843 cÚ¡ 
	gMIN
 = 0.25f;

844 cÚ¡ 
	gMAX
 = 2.5f;

845 cÚ¡ 
	gINVALID
 = 2.55f;

846 cÚ¡ 
	gDISCARD
 = 10.f;

848 cÚ¡ 
	gRIGHT_START
 = 
DEG2RAD
(-70.f);

849 cÚ¡ 
	gRIGHT_END
 = 
DEG2RAD
(10.f);

850 cÚ¡ 
	gMIDDLE_START
 = 
DEG2RAD
(-20.f);

851 cÚ¡ 
	gMIDDLE_END
 = 
DEG2RAD
(20.f);

852 cÚ¡ 
	gLEFT_START
 = 
DEG2RAD
(-10.f);

853 cÚ¡ 
	gLEFT_END
 = 
DEG2RAD
(70.f);

855 cÚ¡ 
	gLEFT
 = 0;

856 cÚ¡ 
	gMIDDLE
 = 1;

857 cÚ¡ 
	gRIGHT
 = 2;

858 cÚ¡ 
	gSIZE
 = 3;

860 cÚ¡ 
	g¡d
::
¡ršg
 
aùu©ÜName
 = "US/Actuator/Value";

862 
	eR—dšgCodesEnum
 {

863 
	gLeá0
,

864 
	gLeá1
,

865 
	gLeá2
,

866 
	gLeá3
,

867 
	gLeá4
,

868 
	gLeá5
,

869 
	gLeá6
,

870 
	gLeá7
,

871 
	gLeá8
,

872 
	gLeá9
,

873 
	gRight0
,

874 
	gRight1
,

875 
	gRight2
,

876 
	gRight3
,

877 
	gRight4
,

878 
	gRight5
,

879 
	gRight6
,

880 
	gRight7
,

881 
	gRight8
,

882 
	gRight9
,

883 
	gNUMBER_OF_READINGS


884 } 
	tR—dšgCode
;

886 cÚ¡ 
R—dšgCode
 
	g»adšgCodes
[] = {

887 
Leá0
,

888 
Leá1
,

889 
Leá2
,

890 
Leá3
,

891 
Leá4
,

892 
Leá5
,

893 
Leá6
,

894 
Leá7
,

895 
Leá8
,

896 
Leá9
,

897 
Right0
,

898 
Right1
,

899 
Right2
,

900 
Right3
,

901 
Right4
,

902 
Right5
,

903 
Right6
,

904 
Right7
,

905 
Right8
,

906 
Right9


909 cÚ¡ 
	g¡d
::
¡ršg
 
»adšgNames
[] = {

	@robot/utils/boostSerializationVariablesMap.hpp

1 #´agm¨
Úû


3 
	~<boo¡/´og¿m_İtiÚs/v¬ŸbËs_m­.hµ
>

4 
	~<boo¡/£rŸliz©iÚ/m­.hµ
>

6 
	~<io¡»am
>

8 
Çme¥aû
 
	gboo¡
 {

9 
Çme¥aû
 
	g£rŸliz©iÚ
 {

10 
	g‹m¶©e
<
şass
 
	gArchive
>

11 
šlše
 
§ve_cÚ¡ruù_d©a
(
Archive
 & 
¬
,

12 cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
* 
t
,

13 cÚ¡ 
fe_v”siÚ
) {

14 
	g¡d
::
û¼
 << 
__PRETTY_FUNCTION__
 << 
¡d
::
’dl
;

16 
	g¬
 << 
	gt
->
deçuÉed
();

17 
	g¬
 << 
	gt
->
v®ue
();

20 
	g‹m¶©e
<
şass
 
	gArchive
>

21 
šlše
 
lßd_cÚ¡ruù_d©a
(
Archive
 & 
¬
,

22 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
* 
t
,

23 cÚ¡ 
fe_v”siÚ
) {

24 
	g¡d
::
û¼
 << 
__PRETTY_FUNCTION__
 << 
¡d
::
’dl
;

26 
boŞ
 
	gdeçuÉed
;

27 
	gboo¡
::
ªy
 
v®ue
;

28 
	g¬
 >> 
	gdeçuÉed
;

29 
	g¬
 >> 
	gv®ue
;

30 
	g¡d
::
û¼
 << 
v®ue
.
ty³
().
Çme
();

32 ::
Ãw
 (
t
è
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
(
v®ue
, 
deçuÉed
);

35 
	g‹m¶©e
<
şass
 
	gArchive
>

36 
šlše
 
§ve
(
Archive
 & 
¬
,

37 cÚ¡ 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
 &
t
,

39 
	g¬
 & 
	gt
.
v®ue
();

40 
	g¬
 & 
	gt
.
deçuÉed
();

42 
	g‹m¶©e
<
şass
 
	gArchive
>

43 
šlše
 
lßd
(
Archive
 & 
¬
,

44 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
 &
t
,

46 
	gboo¡
::
ªy
 
v
;

47 
	g¬
 & 
	gv
;

48 
boŞ
 
	gdeçuÉed
;

49 
	g¬
 & 
	gdeçuÉed
;

50 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
 
vv
(
v
, 
deçuÉed
);

51 
memıy
(&
t
, &
vv
, (vv));

53 
	g‹m¶©e
<
şass
 
	gArchive
>

54 
šlše
 
£rŸlize
(
Archive
 & 
¬
,

55 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
 &
t
,

56 cÚ¡ 
fe_v”siÚ
) {

60 
	gboo¡
::
£rŸliz©iÚ
::
¥l™_ä“
(
¬
, 
t
, 
fe_v”siÚ
);

64 
	g‹m¶©e
<
şass
 
	gArchive
>

65 
šlše
 
£rŸlize
(
Archive
 & 
¬
,

66 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
t
,

67 cÚ¡ 
fe_v”siÚ
) {

68 
£rŸlize
(
¬
, (
¡d
::
m­
<¡d::
¡ršg
,

69 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbË_v®ue
> &)
t
,

70 
fe_v”siÚ
);

	@robot/utils/bzip_compress.cpp

15 
	~"bz_com´ess.hµ
"

16 
	~<¡dexû±
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<as£¹.h
>

21 
	~"zlib.h
"

23 #ià
defšed
(
MSDOS
è|| defšed(
OS2
è|| defšed(
WIN32
è|| defšed(
__CYGWIN__
)

24 
	~<fú.h
>

25 
	~<io.h
>

26 
	#SET_BINARY_MODE
(
fe
è
	`£tmode
(
	`f’o
(fe), 
O_BINARY
)

	)

28 
	#SET_BINARY_MODE
(
fe
)

	)

31 
	#CHUNK
 16384

	)

33 
	$bz_deæ©e
(
¡d
::
i¡»am
 &
sourû
, std::
o¡»am
 &
de¡
, 
Ëv–
)

35 
»t
, 
æush
;

36 
have
;

37 
z_¡»am
 
¡rm
;

38 
š
[
CHUNK
];

39 
out
[
CHUNK
];

42 
¡rm
.
z®loc
 = 
Z_NULL
;

43 
¡rm
.
zä“
 = 
Z_NULL
;

44 
¡rm
.
İaque
 = 
Z_NULL
;

45 
»t
 = 
	`deæ©eIn™
(&
¡rm
, 
Ëv–
);

46 ià(
»t
 !ğ
Z_OK
)

47  
»t
;

51 
¡rm
.
ava_š
 = 
sourû
.
	`»ad
((*)
š
, 
CHUNK
).
	`gcouÁ
();

52 ià(
sourû
.
	`ç
()) {

53 ()
	`deæ©eEnd
(&
¡rm
);

54  
Z_ERRNO
;

56 
æush
 = 
sourû
.
	`eof
(è? 
Z_FINISH
 : 
Z_NO_FLUSH
;

57 
¡rm
.
Ãxt_š
 = 
š
;

62 
¡rm
.
ava_out
 = 
CHUNK
;

63 
¡rm
.
Ãxt_out
 = 
out
;

64 
»t
 = 
	`deæ©e
(&
¡rm
, 
æush
);

65 
	`as£¹
(
»t
 !ğ
Z_STREAM_ERROR
);

66 
have
 = 
CHUNK
 - 
¡rm
.
ava_out
;

67 ià(
de¡
.
	`wr™e
((*)
out
, 
have
).
	`ç
()) {

68 ()
	`deæ©eEnd
(&
¡rm
);

69  
Z_ERRNO
;

71 } 
¡rm
.
ava_out
 == 0);

72 
	`as£¹
(
¡rm
.
ava_š
 == 0);

75 } 
æush
 !ğ
Z_FINISH
);

76 
	`as£¹
(
»t
 =ğ
Z_STREAM_END
);

79 ()
	`deæ©eEnd
(&
¡rm
);

80  
Z_OK
;

81 
	}
}

89 
	$bz_šæ©e
(
¡d
::
i¡»am
 &
sourû
, std::
o¡»am
 &
de¡
)

91 
»t
;

92 
have
;

93 
z_¡»am
 
¡rm
;

94 
š
[
CHUNK
];

95 
out
[
CHUNK
];

98 
¡rm
.
z®loc
 = 
Z_NULL
;

99 
¡rm
.
zä“
 = 
Z_NULL
;

100 
¡rm
.
İaque
 = 
Z_NULL
;

101 
¡rm
.
ava_š
 = 0;

102 
¡rm
.
Ãxt_š
 = 
Z_NULL
;

103 
»t
 = 
	`šæ©eIn™
(&
¡rm
);

104 ià(
»t
 !ğ
Z_OK
)

105  
»t
;

109 
¡rm
.
ava_š
 = 
sourû
.
	`»ad
((*)
š
, 
CHUNK
).
	`gcouÁ
();

110 ià(
sourû
.
	`ç
()) {

111 ()
	`šæ©eEnd
(&
¡rm
);

112  
Z_ERRNO
;

114 ià(
¡rm
.
ava_š
 == 0)

116 
¡rm
.
Ãxt_š
 = 
š
;

120 
¡rm
.
ava_out
 = 
CHUNK
;

121 
¡rm
.
Ãxt_out
 = 
out
;

122 
»t
 = 
	`šæ©e
(&
¡rm
, 
Z_NO_FLUSH
);

123 
	`as£¹
(
»t
 !ğ
Z_STREAM_ERROR
);

124 
»t
) {

125 
Z_NEED_DICT
:

126 
»t
 = 
Z_DATA_ERROR
;

127 
Z_DATA_ERROR
:

128 
Z_MEM_ERROR
:

129 ()
	`šæ©eEnd
(&
¡rm
);

130  
»t
;

132 
have
 = 
CHUNK
 - 
¡rm
.
ava_out
;

133 ià(
de¡
.
	`wr™e
((*)
out
, 
have
).
	`ç
()) {

134 ()
	`šæ©eEnd
(&
¡rm
);

135  
Z_ERRNO
;

137 } 
¡rm
.
ava_out
 == 0);

140 } 
»t
 !ğ
Z_STREAM_END
);

143 ()
	`šæ©eEnd
(&
¡rm
);

144  
»t
 =ğ
Z_STREAM_END
 ? 
Z_OK
 : 
Z_DATA_ERROR
;

145 
	}
}

149 
	$z”r
(
»t
)

151 
¡d
::
¡ršg
 
	`”r
("bzip2: ");

152 
»t
) {

153 
Z_ERRNO
:

154 
”r
 += "error„eading from stream\n";

156 
Z_STREAM_ERROR
:

157 
”r
 += "invalid compression†evel\n";

159 
Z_DATA_ERROR
:

160 
”r
 += "invalid or incomplete deflate data\n";

162 
Z_MEM_ERROR
:

163 
”r
 += "out of memory\n";

165 
Z_VERSION_ERROR
:

166 
”r
 += "zlib version mismatch!\n";

169 
	`throw
(
¡d
::
	`ruÁime_”rÜ
(
”r
));

170 
	}
}

	@robot/utils/bzip_compress.hpp

1 
	~<io¡»am
>

3 
bz_deæ©e
(
¡d
::
i¡»am
 &
sourû
, std::
o¡»am
 &
de¡
, 
Ëv–
 = 9);

4 
bz_šæ©e
(
¡d
::
i¡»am
 &
sourû
, std::
o¡»am
 &
de¡
);

	@robot/utils/clip.hpp

32 #´agm¨
Úû


39 
	g‹m¶©e
 <
şass
 
	gT
>

40 
šlše
 
T
 
	$CLIP
(cÚ¡ 
T
& 
x
, cÚ¡ T& 
low”Bound
, cÚ¡ T& 
uµ”Bound
) {

41 ià(
low”Bound
 <ğ
uµ”Bound
) {

43 ià(
x
 < 
low”Bound
)

44  
low”Bound
;

45 ià(
x
 > 
uµ”Bound
)

46  
uµ”Bound
;

48  
x
;

51 ià(
x
 < 
uµ”Bound
)

52  
uµ”Bound
;

53 ià(
x
 > 
low”Bound
)

54  
low”Bound
;

56  
x
;

58 
	}
}

60 
	g‹m¶©e
 <
şass
 
	gT
>

61 
šlše
 
T
 
	$CLIP
(cÚ¡ 
T
 &
x
, cÚ¡ T &
bound
) {

62  
	`CLIP
(
x
, -
bound
, bound);

63 
	}
}

	@robot/utils/compress.cpp

34 
	~"com´ess.hµ
"

35 
	~<boo¡/io¡»ams/cİy.hµ
>

36 
	~<boo¡/io¡»ams/deviû/back_š£¹”.hµ
>

37 
	~<boo¡/io¡»ams/f‹r/bz2.hµ
>

38 
	~<boo¡/io¡»ams/f‹r/zlib.hµ
>

39 
	~<boo¡/io¡»ams/f‹ršg_¡»am.hµ
>

40 
	~<®gÜ™hm
>

42 
	gadd_com´essÜ


43 (
	gboo¡
::
io¡»ams
::
f‹ršg_¡»ambuf
<
boo¡
::io¡»ams::
ouut
>& 
out
,

44 
Com´essiÚScheme
 
	gscheme
) {

45 
	gscheme
) {

46 
	gZLIB_COMPRESSION
:

47 
out
.
push
(
boo¡
::
io¡»ams
::
zlib_com´essÜ
());

49 
	gBZIP2_COMPRESSION
:

50 
out
.
push
(
boo¡
::
io¡»ams
::
bz2_com´essÜ
());

58 
add_decom´essÜ
(

59 
boo¡
::
io¡»ams
::
f‹ršg_¡»ambuf
<boo¡::io¡»ams::
šput
>& 
š
,

60 
Com´essiÚScheme
 
scheme
)

62 
	gscheme
) {

63 
	gZLIB_COMPRESSION
:

64 
š
.
push
(
boo¡
::
io¡»ams
::
zlib_decom´essÜ
());

66 
	gBZIP2_COMPRESSION
:

67 
š
.
push
(
boo¡
::
io¡»ams
::
bz2_decom´essÜ
());

74 
	$com´ess
(cÚ¡ 
¡d
::
¡ršg
& 
d©a
, std::¡ršg& 
bufãr
,

75 
Com´essiÚScheme
 
scheme
) {

76 
bufãr
.
	`ş—r
();

77 
boo¡
::
io¡»ams
::
f‹ršg_¡»ambuf
<boo¡::io¡»ams::
ouut
> 
out
;

78 
	`add_com´essÜ
(
out
, 
scheme
);

79 
out
.
	`push
(
boo¡
::
io¡»ams
::
	`back_š£¹”
(
bufãr
));

80 
boo¡
::
io¡»ams
::
	`cİy
(boo¡::
	`make_™”©Ü_¿nge
(
d©a
), 
out
);

81 
	}
}

84 
	$decom´ess
(cÚ¡ 
¡d
::
¡ršg
& 
bufãr
, std::¡ršg& 
d©a
,

85 
Com´essiÚScheme
 
scheme
) {

86 
boo¡
::
io¡»ams
::
f‹ršg_¡»ambuf
<boo¡::io¡»ams::
šput
> 
š
;

87 
	`add_decom´essÜ
(
š
, 
scheme
);

88 
š
.
	`push
(
boo¡
::
	`make_™”©Ü_¿nge
(
bufãr
));

89 
d©a
.
	`ş—r
();

90 
boo¡
::
io¡»ams
::
	`cİy
(
š
, boo¡::io¡»ams::
	`back_š£¹”
(
d©a
));

91 
	}
}

	@robot/utils/compress.hpp

33 
	~<¡ršg
>

35 
	eCom´essiÚScheme
 {

36 
	mNO_COMPRESSION
,

37 
	mZLIB_COMPRESSION
,

38 
	mBZIP2_COMPRESSION


41 
com´ess
(cÚ¡ 
¡d
::
¡ršg
& 
d©a
, std::¡ršg& 
bufãr
,

42 
Com´essiÚScheme
 
scheme
);

44 
decom´ess
(cÚ¡ 
¡d
::
¡ršg
& 
bufãr
, std::¡ršg& 
d©a
,

45 
Com´essiÚScheme
 
scheme
);

	@robot/utils/i2c-dev.h

25 #iâdeà
LIB_I2CDEV_H


26 
	#LIB_I2CDEV_H


	)

28 
	~<lšux/ty³s.h
>

29 
	~<sys/ioùl.h
>

38 
	si2c_msg
 {

39 
__u16
 
	maddr
;

40 
	mæags
;

41 
	#I2C_M_TEN
 0x10

	)

42 
	#I2C_M_RD
 0x01

	)

43 
	#I2C_M_NOSTART
 0x4000

	)

44 
	#I2C_M_REV_DIR_ADDR
 0x2000

	)

45 
	#I2C_M_IGNORE_NAK
 0x1000

	)

46 
	#I2C_M_NO_RD_ACK
 0x0800

	)

47 
	mËn
;

48 *
	mbuf
;

53 
	#I2C_FUNC_I2C
 0x00000001

	)

54 
	#I2C_FUNC_10BIT_ADDR
 0x00000002

	)

55 
	#I2C_FUNC_PROTOCOL_MANGLING
 0x00000004

	)

56 
	#I2C_FUNC_SMBUS_PEC
 0x00000008

	)

57 
	#I2C_FUNC_SMBUS_BLOCK_PROC_CALL
 0x00008000

	)

58 
	#I2C_FUNC_SMBUS_QUICK
 0x00010000

	)

59 
	#I2C_FUNC_SMBUS_READ_BYTE
 0x00020000

	)

60 
	#I2C_FUNC_SMBUS_WRITE_BYTE
 0x00040000

	)

61 
	#I2C_FUNC_SMBUS_READ_BYTE_DATA
 0x00080000

	)

62 
	#I2C_FUNC_SMBUS_WRITE_BYTE_DATA
 0x00100000

	)

63 
	#I2C_FUNC_SMBUS_READ_WORD_DATA
 0x00200000

	)

64 
	#I2C_FUNC_SMBUS_WRITE_WORD_DATA
 0x00400000

	)

65 
	#I2C_FUNC_SMBUS_PROC_CALL
 0x00800000

	)

66 
	#I2C_FUNC_SMBUS_READ_BLOCK_DATA
 0x01000000

	)

67 
	#I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
 0x02000000

	)

68 
	#I2C_FUNC_SMBUS_READ_I2C_BLOCK
 0x04000000

	)

69 
	#I2C_FUNC_SMBUS_WRITE_I2C_BLOCK
 0x08000000

	)

71 
	#I2C_FUNC_SMBUS_BYTE
 (
I2C_FUNC_SMBUS_READ_BYTE
 | \

72 
I2C_FUNC_SMBUS_WRITE_BYTE
)

	)

73 
	#I2C_FUNC_SMBUS_BYTE_DATA
 (
I2C_FUNC_SMBUS_READ_BYTE_DATA
 | \

74 
I2C_FUNC_SMBUS_WRITE_BYTE_DATA
)

	)

75 
	#I2C_FUNC_SMBUS_WORD_DATA
 (
I2C_FUNC_SMBUS_READ_WORD_DATA
 | \

76 
I2C_FUNC_SMBUS_WRITE_WORD_DATA
)

	)

77 
	#I2C_FUNC_SMBUS_BLOCK_DATA
 (
I2C_FUNC_SMBUS_READ_BLOCK_DATA
 | \

78 
I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
)

	)

79 
	#I2C_FUNC_SMBUS_I2C_BLOCK
 (
I2C_FUNC_SMBUS_READ_I2C_BLOCK
 | \

80 
I2C_FUNC_SMBUS_WRITE_I2C_BLOCK
)

	)

83 
	#I2C_FUNC_SMBUS_HWPEC_CALC
 
I2C_FUNC_SMBUS_PEC


	)

88 
	#I2C_SMBUS_BLOCK_MAX
 32

	)

89 
	#I2C_SMBUS_I2C_BLOCK_MAX
 32

	)

90 
	ui2c_smbus_d©a
 {

91 
__u8
 
	mby‹
;

92 
__u16
 
	mwÜd
;

93 
__u8
 
	mblock
[
I2C_SMBUS_BLOCK_MAX
 + 2];

98 
	#I2C_SMBUS_READ
 1

	)

99 
	#I2C_SMBUS_WRITE
 0

	)

103 
	#I2C_SMBUS_QUICK
 0

	)

104 
	#I2C_SMBUS_BYTE
 1

	)

105 
	#I2C_SMBUS_BYTE_DATA
 2

	)

106 
	#I2C_SMBUS_WORD_DATA
 3

	)

107 
	#I2C_SMBUS_PROC_CALL
 4

	)

108 
	#I2C_SMBUS_BLOCK_DATA
 5

	)

109 
	#I2C_SMBUS_I2C_BLOCK_BROKEN
 6

	)

110 
	#I2C_SMBUS_BLOCK_PROC_CALL
 7

	)

111 
	#I2C_SMBUS_I2C_BLOCK_DATA
 8

	)

120 
	#I2C_RETRIES
 0x0701

	)

123 
	#I2C_TIMEOUT
 0x0702

	)

127 
	#I2C_SLAVE
 0x0703

	)

129 
	#I2C_SLAVE_FORCE
 0x0706

	)

133 
	#I2C_TENBIT
 0x0704

	)

135 
	#I2C_FUNCS
 0x0705

	)

136 
	#I2C_RDWR
 0x0707

	)

137 
	#I2C_PEC
 0x0708

	)

139 
	#I2C_SMBUS
 0x0720

	)

147 
	si2c_smbus_ioùl_d©a
 {

148 
	m»ad_wr™e
;

149 
__u8
 
	mcommªd
;

150 
	msize
;

151 
i2c_smbus_d©a
 *
	md©a
;

155 
	si2c_rdwr_ioùl_d©a
 {

156 
i2c_msg
 *
	mmsgs
;

157 
	mnmsgs
;

161 
šlše
 
__s32
 
	$i2c_smbus_acûss
(
fe
, 
»ad_wr™e
, 
__u8
 
commªd
,

162 
size
, 
i2c_smbus_d©a
 *
d©a
)

164 
i2c_smbus_ioùl_d©a
 
¬gs
;

166 
¬gs
.
»ad_wr™e
 =„ead_write;

167 
¬gs
.
commªd
 = command;

168 
¬gs
.
size
 = size;

169 
¬gs
.
d©a
 = data;

170  
	`ioùl
(
fe
,
I2C_SMBUS
,&
¬gs
);

171 
	}
}

174 
šlše
 
__s32
 
	$i2c_smbus_wr™e_quick
(
fe
, 
__u8
 
v®ue
)

176  
	`i2c_smbus_acûss
(
fe
,
v®ue
,0,
I2C_SMBUS_QUICK
,
NULL
);

177 
	}
}

179 
šlše
 
__s32
 
	$i2c_smbus_»ad_by‹
(
fe
)

181 
i2c_smbus_d©a
 
d©a
;

182 ià(
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_READ
,0,
I2C_SMBUS_BYTE
,&
d©a
))

185  0x0FF & 
d©a
.
by‹
;

186 
	}
}

188 
šlše
 
__s32
 
	$i2c_smbus_wr™e_by‹
(
fe
, 
__u8
 
v®ue
)

190  
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_WRITE
,
v®ue
,

191 
I2C_SMBUS_BYTE
,
NULL
);

192 
	}
}

194 
šlše
 
__s32
 
	$i2c_smbus_»ad_by‹_d©a
(
fe
, 
__u8
 
commªd
)

196 
i2c_smbus_d©a
 
d©a
;

197 ià(
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_READ
,
commªd
,

198 
I2C_SMBUS_BYTE_DATA
,&
d©a
))

201  0x0FF & 
d©a
.
by‹
;

202 
	}
}

204 
šlše
 
__s32
 
	$i2c_smbus_wr™e_by‹_d©a
(
fe
, 
__u8
 
commªd
,

205 
__u8
 
v®ue
)

207 
i2c_smbus_d©a
 
d©a
;

208 
d©a
.
by‹
 = 
v®ue
;

209  
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_WRITE
,
commªd
,

210 
I2C_SMBUS_BYTE_DATA
, &
d©a
);

211 
	}
}

213 
šlše
 
__s32
 
	$i2c_smbus_»ad_wÜd_d©a
(
fe
, 
__u8
 
commªd
)

215 
i2c_smbus_d©a
 
d©a
;

216 ià(
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_READ
,
commªd
,

217 
I2C_SMBUS_WORD_DATA
,&
d©a
))

220  0x0FFFF & 
d©a
.
wÜd
;

221 
	}
}

223 
šlše
 
__s32
 
	$i2c_smbus_wr™e_wÜd_d©a
(
fe
, 
__u8
 
commªd
,

224 
__u16
 
v®ue
)

226 
i2c_smbus_d©a
 
d©a
;

227 
d©a
.
wÜd
 = 
v®ue
;

228  
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_WRITE
,
commªd
,

229 
I2C_SMBUS_WORD_DATA
, &
d©a
);

230 
	}
}

232 
šlše
 
__s32
 
	$i2c_smbus_´oûss_ÿÎ
(
fe
, 
__u8
 
commªd
, 
__u16
 
v®ue
)

234 
i2c_smbus_d©a
 
d©a
;

235 
d©a
.
wÜd
 = 
v®ue
;

236 ià(
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_WRITE
,
commªd
,

237 
I2C_SMBUS_PROC_CALL
,&
d©a
))

240  0x0FFFF & 
d©a
.
wÜd
;

241 
	}
}

245 
šlše
 
__s32
 
	$i2c_smbus_»ad_block_d©a
(
fe
, 
__u8
 
commªd
,

246 
__u8
 *
v®ues
)

248 
i2c_smbus_d©a
 
d©a
;

249 
i
;

250 ià(
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_READ
,
commªd
,

251 
I2C_SMBUS_BLOCK_DATA
,&
d©a
))

254 
i
 = 1; i <ğ
d©a
.
block
[0]; i++)

255 
v®ues
[
i
-1] = 
d©a
.
block
[i];

256  
d©a
.
block
[0];

258 
	}
}

260 
šlše
 
__s32
 
	$i2c_smbus_wr™e_block_d©a
(
fe
, 
__u8
 
commªd
,

261 
__u8
 
Ëngth
, __u8 *
v®ues
)

263 
i2c_smbus_d©a
 
d©a
;

264 
i
;

265 ià(
Ëngth
 > 32)

266 
Ëngth
 = 32;

267 
i
 = 1; i <ğ
Ëngth
; i++)

268 
d©a
.
block
[
i
] = 
v®ues
[i-1];

269 
d©a
.
block
[0] = 
Ëngth
;

270  
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_WRITE
,
commªd
,

271 
I2C_SMBUS_BLOCK_DATA
, &
d©a
);

272 
	}
}

278 
šlše
 
__s32
 
	$i2c_smbus_»ad_i2c_block_d©a
(
fe
, 
__u8
 
commªd
,

279 
__u8
 
Ëngth
, __u8 *
v®ues
)

281 
i2c_smbus_d©a
 
d©a
;

282 
i
;

284 ià(
Ëngth
 > 32)

285 
Ëngth
 = 32;

286 
d©a
.
block
[0] = 
Ëngth
;

287 ià(
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_READ
,
commªd
,

288 
Ëngth
 =ğ32 ? 
I2C_SMBUS_I2C_BLOCK_BROKEN
 :

289 
I2C_SMBUS_I2C_BLOCK_DATA
,&
d©a
))

292 
i
 = 1; i <ğ
d©a
.
block
[0]; i++)

293 
v®ues
[
i
-1] = 
d©a
.
block
[i];

294  
d©a
.
block
[0];

296 
	}
}

298 
šlše
 
__s32
 
	$i2c_smbus_wr™e_i2c_block_d©a
(
fe
, 
__u8
 
commªd
,

299 
__u8
 
Ëngth
, __u8 *
v®ues
)

301 
i2c_smbus_d©a
 
d©a
;

302 
i
;

303 ià(
Ëngth
 > 32)

304 
Ëngth
 = 32;

305 
i
 = 1; i <ğ
Ëngth
; i++)

306 
d©a
.
block
[
i
] = 
v®ues
[i-1];

307 
d©a
.
block
[0] = 
Ëngth
;

308  
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_WRITE
,
commªd
,

309 
I2C_SMBUS_I2C_BLOCK_BROKEN
, &
d©a
);

310 
	}
}

313 
šlše
 
__s32
 
	$i2c_smbus_block_´oûss_ÿÎ
(
fe
, 
__u8
 
commªd
,

314 
__u8
 
Ëngth
, __u8 *
v®ues
)

316 
i2c_smbus_d©a
 
d©a
;

317 
i
;

318 ià(
Ëngth
 > 32)

319 
Ëngth
 = 32;

320 
i
 = 1; i <ğ
Ëngth
; i++)

321 
d©a
.
block
[
i
] = 
v®ues
[i-1];

322 
d©a
.
block
[0] = 
Ëngth
;

323 ià(
	`i2c_smbus_acûss
(
fe
,
I2C_SMBUS_WRITE
,
commªd
,

324 
I2C_SMBUS_BLOCK_PROC_CALL
,&
d©a
))

327 
i
 = 1; i <ğ
d©a
.
block
[0]; i++)

328 
v®ues
[
i
-1] = 
d©a
.
block
[i];

329  
d©a
.
block
[0];

331 
	}
}

	@robot/utils/incapacitated.hpp

32 #´agm¨
Úû


34 
	~"gamecÚŒŞËr/RoboCupGameCÚŒŞD©a.hµ
"

35 
	~"ty³s/AùiÚCommªd.hµ
"

37 
	#SECS_TILL_INCAPACITATED
 3

	)

38 
	#MIN_UPTIME
 20

	)

40 
usšg
 
Çme¥aû
 
	gAùiÚCommªd
;

42 
šlše
 
boŞ
 
	$isInÿ·c™©ed
(cÚ¡ 
AùiÚCommªd
::
Body
::
AùiÚTy³
 &
acB
) {

44 
acB
 =ğ
Body
::
GETUP_BACK
 ||

45 
acB
 =ğ
Body
::
GETUP_FRONT
 ||

46 
acB
 =ğ
Body
::
DEAD
 ||

47 
acB
 =ğ
Body
::
REF_PICKUP
 ||

48 
acB
 =ğ
Body
::
GOALIE_DIVE_RIGHT
 ||

49 
acB
 =ğ
Body
::
GOALIE_DIVE_LEFT
;

50 
	}
}

	@robot/utils/matrix_helpers.hpp

32 #´agm¨
Úû


34 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

35 
	~<boo¡/num”ic/ubÏs/io.hµ
>

36 
	~<boo¡/num”ic/ubÏs/lu.hµ
>

41 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

42 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
rÙ©eZM©rix
(T 
th‘a
);

46 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

47 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
Œª¦©eM©rix
(T 
x
, T 
y
, T 
z
);

51 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

52 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
´ojeùiÚM©rix
(T 
ex
, T 
ey
,

53 
T
 
ez
);

58 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

59 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
ü—‹DHM©rix
(T 
a
, T 
®pha
,

60 
T
 
d
, T 
th‘a
);

64 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

65 
boŞ
 
šv”tM©rix
(cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
>& 
šput
,

66 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
>& 
šv”£
);

69 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

70 
šlše
 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
>

71 
	$vec4
(
T
 
a
, T 
b
, T 
c
, T 
d
) {

72 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	`m
(4, 1);

73 
	`m
(0, 0èğ
a
;

74 
	`m
(1, 0èğ
b
;

75 
	`m
(2, 0èğ
c
;

76 
	`m
(3, 0èğ
d
;

77  
m
;

78 
	}
}

81 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

82 
šlše
 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
>

83 
	$vec4
(cÚ¡ 
T
 
a
[]) {

84 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	`m
(4, 1);

85 
	`m
(0, 0èğ
a
[0];

86 
	`m
(1, 0èğ
a
[1];

87 
	`m
(2, 0èğ
a
[2];

88 
	`m
(3, 0èğ
a
[3];

89  
m
;

90 
	}
}

92 
	~"uts/m©rix_h–³rs.tcc
"

	@robot/utils/matrix_helpers.tcc

2 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

3 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	$Œª¦©eM©rix
(
T
 
x
, T 
y
, T 
z
) {

4 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	`r
(4, 4);

5 
	`r
(0, 0) = 1;

6 
	`r
(0, 1) = 0;

7 
	`r
(0, 2) = 0;

8 
	`r
(0, 3èğ
x
;

10 
	`r
(1, 0) = 0;

11 
	`r
(1, 1) = 1;

12 
	`r
(1, 2) = 0;

13 
	`r
(1, 3èğ
y
;

15 
	`r
(2, 0) = 0;

16 
	`r
(2, 1) = 0;

17 
	`r
(2, 2) = 1;

18 
	`r
(2, 3èğ
z
;

20 
	`r
(3, 0) = 0;

21 
	`r
(3, 1) = 0;

22 
	`r
(3, 2) = 0;

23 
	`r
(3, 3) = 1;

24  
r
;

25 
	}
}

28 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

29 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	$rÙ©eZM©rix
(
T
 
th‘a
) {

30 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	`r
(4, 4);

31 
	`r
(0, 0èğ
	`cos
(
th‘a
);

32 
	`r
(0, 1èğ-
	`sš
(
th‘a
);

33 
	`r
(0, 2) = 0;

34 
	`r
(0, 3) = 0;

36 
	`r
(1, 0èğ
	`sš
(
th‘a
);

37 
	`r
(1, 1èğ
	`cos
(
th‘a
);

38 
	`r
(1, 2) = 0;

39 
	`r
(1, 3) = 0;

41 
	`r
(2, 0) = 0;

42 
	`r
(2, 1) = 0;

43 
	`r
(2, 2) = 1;

44 
	`r
(2, 3) = 0;

46 
	`r
(3, 0) = 0;

47 
	`r
(3, 1) = 0;

48 
	`r
(3, 2) = 0;

49 
	`r
(3, 3) = 1;

50  
r
;

51 
	}
}

52 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

53 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	$ü—‹DHM©rix
(
T
 
a
, T 
®pha
,

54 
T
 
d
, T 
th‘a
) {

55 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	`m
(4, 4);

56 
	`m
(0, 0èğ
	`cos
(
th‘a
);

57 
	`m
(0, 1èğ-
	`sš
(
th‘a
);

58 
	`m
(0, 2) = 0;

59 
	`m
(0, 3èğ
a
;

61 
	`m
(1, 0èğ
	`sš
(
th‘a
è* 
	`cos
(
®pha
);

62 
	`m
(1, 1èğ
	`cos
(
th‘a
è* cos(
®pha
);

63 
	`m
(1, 2èğ-
	`sš
(
®pha
);

64 
	`m
(1, 3èğ-
	`sš
(
®pha
è* 
d
;

66 
	`m
(2, 0èğ
	`sš
(
th‘a
è* sš(
®pha
);

67 
	`m
(2, 1èğ
	`cos
(
th‘a
è* 
	`sš
(
®pha
);

68 
	`m
(2, 2èğ
	`cos
(
®pha
);

69 
	`m
(2, 3èğ
	`cos
(
®pha
è* 
d
;

71 
	`m
(3, 0) = 0;

72 
	`m
(3, 1) = 0;

73 
	`m
(3, 2) = 0;

74 
	`m
(3, 3) = 1;

75  
m
;

76 
	}
}

102 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

103 
boŞ
 
šv”tM©rix
(cÚ¡ 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
>& 
šput
,

104 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
>& 
šv
) {

105 
T
 
d‘
;

106 
T
 
	gm
[16];

107 
	gi
;

109 
	gm
[0] = 
šput
(0, 0);

110 
	gm
[1] = 
šput
(0, 1);

111 
	gm
[2] = 
šput
(0, 2);

112 
	gm
[3] = 
šput
(0, 3);

114 
	gm
[4] = 
šput
(1, 0);

115 
	gm
[5] = 
šput
(1, 1);

116 
	gm
[6] = 
šput
(1, 2);

117 
	gm
[7] = 
šput
(1, 3);

119 
	gm
[8] = 
šput
(2, 0);

120 
	gm
[9] = 
šput
(2, 1);

121 
	gm
[10] = 
šput
(2, 2);

122 
	gm
[11] = 
šput
(2, 3);

124 
	gm
[12] = 
šput
(3, 0);

125 
	gm
[13] = 
šput
(3, 1);

126 
	gm
[14] = 
šput
(3, 2);

127 
	gm
[15] = 
šput
(3, 3);

129 
šv
(0, 0èğ
m
[5] * m[10] * m[15] - m[5] * m[11] * m[14] - m[9] * m[6] * m[15]

130 + 
m
[9] * m[7] * m[14] + m[13] * m[6] * m[11] - m[13] * m[7] * m[10];

131 
šv
(1, 0èğ-
m
[4] * m[10] * m[15] + m[4] * m[11] * m[14] + m[8] * m[6] * m[15]

132 - 
m
[8] * m[7] * m[14] - m[12] * m[6] * m[11] + m[12] * m[7] * m[10];

133 
šv
(2, 0èğ
m
[4] * m[9] * m[15] - m[4] * m[11] * m[13] - m[8] * m[5] * m[15]

134 + 
m
[8] * m[7] * m[13] + m[12] * m[5] * m[11] - m[12] * m[7] * m[9];

135 
šv
(3, 0èğ-
m
[4] * m[9] * m[14] + m[4] * m[10] * m[13] + m[8] * m[5] * m[14]

136 - 
m
[8] * m[6] * m[13] - m[12] * m[5] * m[10] + m[12] * m[6] * m[9];

137 
šv
(0, 1èğ-
m
[1] * m[10] * m[15] + m[1] * m[11] * m[14] + m[9] * m[2] * m[15]

138 - 
m
[9] * m[3] * m[14] - m[13] * m[2] * m[11] + m[13] * m[3] * m[10];

139 
šv
(1, 1èğ
m
[0] * m[10] * m[15] - m[0] * m[11] * m[14] - m[8] * m[2] * m[15]

140 + 
m
[8] * m[3] * m[14] + m[12] * m[2] * m[11] - m[12] * m[3] * m[10];

141 
šv
(2, 1èğ-
m
[0] * m[9] * m[15] + m[0] * m[11] * m[13] + m[8] * m[1] * m[15]

142 - 
m
[8] * m[3] * m[13] - m[12] * m[1] * m[11] + m[12] * m[3] * m[9];

143 
šv
(3, 1èğ
m
[0] * m[9] * m[14] - m[0] * m[10] * m[13] - m[8] * m[1] * m[14]

144 + 
m
[8] * m[2] * m[13] + m[12] * m[1] * m[10] - m[12] * m[2] * m[9];

145 
šv
(0, 2èğ
m
[1] * m[6] * m[15] - m[1] * m[7] * m[14] - m[5] * m[2] * m[15]

146 + 
m
[5] * m[3] * m[14] + m[13] * m[2] * m[7] - m[13] * m[3] * m[6];

147 
šv
(1, 2èğ-
m
[0] * m[6] * m[15] + m[0] * m[7] * m[14] + m[4] * m[2] * m[15]

148 - 
m
[4] * m[3] * m[14] - m[12] * m[2] * m[7] + m[12] * m[3] * m[6];

149 
šv
(2, 2èğ
m
[0] * m[5] * m[15] - m[0] * m[7] * m[13] - m[4] * m[1] * m[15]

150 + 
m
[4] * m[3] * m[13] + m[12] * m[1] * m[7] - m[12] * m[3] * m[5];

151 
šv
(3, 2èğ-
m
[0] * m[5] * m[14] + m[0] * m[6] * m[13] + m[4] * m[1] * m[14]

152 - 
m
[4] * m[2] * m[13] - m[12] * m[1] * m[6] + m[12] * m[2] * m[5];

153 
šv
(0, 3èğ-
m
[1] * m[6] * m[11] + m[1] * m[7] * m[10] + m[5] * m[2] * m[11]

154 - 
m
[5] * m[3] * m[10] - m[9] * m[2] * m[7] + m[9] * m[3] * m[6];

155 
šv
(1, 3èğ
m
[0] * m[6] * m[11] - m[0] * m[7] * m[10] - m[4] * m[2] * m[11]

156 + 
m
[4] * m[3] * m[10] + m[8] * m[2] * m[7] - m[8] * m[3] * m[6];

157 
šv
(2, 3èğ-
m
[0] * m[5] * m[11] + m[0] * m[7] * m[9] + m[4] * m[1] * m[11]

158 - 
m
[4] * m[3] * m[9] - m[8] * m[1] * m[7] + m[8] * m[3] * m[5];

159 
šv
(3, 3èğ
m
[0] * m[5] * m[10] - m[0] * m[6] * m[9] - m[4] * m[1] * m[10]

160 + 
m
[4] * m[2] * m[9] + m[8] * m[1] * m[6] - m[8] * m[2] * m[5];

162 
	gd‘
 = 
m
[0] * 
šv
(0, 0è+ 
	gm
[1] * inv(1, 0) + m[2] * inv(2, 0) + m[3] * inv(3, 0);

163 ià(
	gd‘
 == 0)

164  
çl£
;

166 
	gd‘
 = 1.0 / 
d‘
;

168 
	gi
 = 0; i < 16; i++)

169 
šv
(
i
 / 4, i % 4èğšv(˜/ 4, i % 4è* 
	gd‘
;

171  
	gŒue
;

174 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

175 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	$´ojeùiÚM©rix
(
T
 
ex
, T 
ey
, T 
ez
) {

176 
boo¡
::
num”ic
::
ubÏs
::
m©rix
<
T
> 
	`´ojeùiÚ
(4, 4);

177 
	`´ojeùiÚ
(0, 0) = 1;

178 
	`´ojeùiÚ
(0, 1) = 0;

179 
	`´ojeùiÚ
(0, 2) = 0;

180 
	`´ojeùiÚ
(0, 3èğ-
ex
;

182 
	`´ojeùiÚ
(1, 0) = 0;

183 
	`´ojeùiÚ
(1, 1) = 1;

184 
	`´ojeùiÚ
(1, 2) = 0;

185 
	`´ojeùiÚ
(1, 3èğ-
ey
;

187 
	`´ojeùiÚ
(2, 0) = 0;

188 
	`´ojeùiÚ
(2, 1) = 0;

189 
	`´ojeùiÚ
(2, 2) = 1;

190 
	`´ojeùiÚ
(2, 3) = 0;

192 
	`´ojeùiÚ
(3, 0) = 0;

193 
	`´ojeùiÚ
(3, 1) = 0;

194 
	`´ojeùiÚ
(3, 2èğ1.0 / 
ez
;

195 
	`´ojeùiÚ
(3, 3) = 0;

196  
´ojeùiÚ
;

197 
	}
}

	@robot/utils/options.cpp

32 
	~<boo¡/´og¿m_İtiÚs.hµ
>

33 
	~<ext/¦i¡
>

34 
	~<f¡»am
>

35 
	~<iomª
>

36 
	~<io¡»am
>

37 
	~<m­
>

39 
	~"uts/İtiÚs.hµ
"

40 
	~"Œªsm™‹r/T¿nsm™‹rDefs.hµ
"

42 
Çme¥aû
 
	gpo
 = 
boo¡
::
´og¿m_İtiÚs
;

43 
usšg
 
Çme¥aû
 
	g¡d
;

44 
usšg
 
Çme¥aû
 
	g__gnu_cxx
;

46 
	$pİuÏ‹_İtiÚs
(
po
::
İtiÚs_desütiÚ
 &
cÚfig_fe_İtiÚs
) {

47 
po
::
İtiÚs_desütiÚ
 
	`game_cÚfig
("Game options");

48 
game_cÚfig
.
	`add_İtiÚs
()

49 ("game.ty³,g", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("MATCH"),

52 
po
::
İtiÚs_desütiÚ
 
	`¶ay”_cÚfig
("Player options");

53 
¶ay”_cÚfig
.
	`add_İtiÚs
()

54 ("¶ay”.numb”,n", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(2),

56 ("¶ay”.‹am,T", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(19),

59 
po
::
İtiÚs_desütiÚ
 
	`debug_cÚfig
("Debugging options");

60 
debug_cÚfig
.
	`add_İtiÚs
()

61 ("debug.log,l", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("SILENT"),

63 ("debug.log.mÙiÚ,m", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
çl£
),

66 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("/var/volatile/runswift"),

68 ("debug.shutdowÁime", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

70 ("debug.gamecÚŒŞËr,G", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

72 ("debug.mÙiÚ,M", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

74 ("debug.ofâaÙ¿nsm™‹r,O", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

76 ("debug.³rû±iÚ,P", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

78 ("debug.visiÚ,V", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

80 ("debug.behaviour,B", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

82 ("debug.ÇÙ¿nsm™‹r,C", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

84 ("debug.ÇÜeûiv”,R", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

86 ("debug.»mÙecÚŒŞ", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

88 ("debug.aù_Ú_whi¡Ë", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

90 ("debug.dump,D", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
(""),

92 ("debug.mask", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(
INITIAL_MASK
),

95 
po
::
İtiÚs_desütiÚ
 
	`behaviour_cÚfig
("Behaviour options");

96 
behaviour_cÚfig
.
	`add_İtiÚs
()

98 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("GameController"),

100 ("behaviour.·th", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("/home/nao/data/behaviours/"),

102 ("deçuÉ.body", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("REF_PICKUP"),

104 ("deçuÉ.fÜw¬d", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

106 ("deçuÉ.Ëá", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

108 ("deçuÉ.tuº", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0f),

110 ("deçuÉ.pow”", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(1.0f),

112 ("deçuÉ.¥“d", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(1.0f),

114 ("deçuÉ.b’d", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(15.0f),

116 ("deçuÉ.foÙ", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("LEFT"),

118 ("deçuÉ.kickDœeùiÚ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

120 ("deçuÉ.whichCam”a", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("BEHAVIOUR"),

123 
po
::
İtiÚs_desütiÚ
 
	`mÙiÚ_cÚfig
("Motion options");

124 
mÙiÚ_cÚfig
.
	`add_İtiÚs
()

125 ("mÙiÚ.efãùÜ,e", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("Agent"),

127 ("mÙiÚ.touch,t", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("Agent"),

130 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("/home/nao/data/pos/"),

132 ("mÙiÚ.v4", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
çl£
),

134 ("w®k.f", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.5),

136 ("w®k.¡", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(1.0),

138 ("w®k.cs", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

140 ("w®k.r", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(20.0),

142 ("w®k.s", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(5.0),

144 ("w®k.l", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(20.0),

146 ("w®k.fs", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(5.0),

148 ("w®k.ls", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

150 ("w®k.ts", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

152 ("w®k.b", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(15.0),

154 ("w®k.liáHeight", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(8.0f),

156 ("w®k.cÜÚ®Am¶™ude", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0f),

158 ("w®k.liáF¿c", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.5f),

160 ("w®k.moveF¿c", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.4f),

162 ("w®k.m", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

165 
po
::
İtiÚs_desütiÚ
 
	`visiÚ_cÚfig
("Vision options");

166 
visiÚ_cÚfig
.
	`add_İtiÚs
()

167 ("visiÚ.ÿm”a,c", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("Nao"),

169 ("visiÚ.ÿm”a_cÚŒŞs", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
(""),

172 ("visiÚ.dumpäames,d", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
çl£
),

174 ("visiÚ.dum´©e,r", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(1000),

176 ("visiÚ.dumpfe,f", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("dump.yuv"),

179 
po
::
İtiÚs_desütiÚ
 
	`ÿm”a_cÚfig
("Camera options");

180 
ÿm”a_cÚfig
.
	`add_İtiÚs
()

181 ("ÿm”a.tİ.hæ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(1),

183 ("ÿm”a.tİ.væ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(1),

185 ("ÿm”a.tİ.brighŠess", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(248),

187 ("ÿm”a.tİ.cÚŒa¡", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(60),

189 ("ÿm”a.tİ.§tu¿tiÚ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(130),

191 ("ÿm”a.tİ.hue", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

193 ("ÿm”a.tİ.sh¬²ess", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(2),

195 ("ÿm”a.tİ.backlightcom³n§tiÚ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0x00),

197 ("ÿm”a.tİ.exposu»", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(50),

199 ("ÿm”a.tİ.gaš", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(250),

201 ("ÿm”a.tİ.wh™eb®ªû", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(3000),

205 ("ÿm”a.bÙ.hæ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

207 ("ÿm”a.bÙ.væ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

209 ("ÿm”a.bÙ.brighŠess", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(248),

211 ("ÿm”a.bÙ.cÚŒa¡", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(60),

213 ("ÿm”a.bÙ.§tu¿tiÚ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(180),

215 ("ÿm”a.bÙ.hue", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

217 ("ÿm”a.bÙ.sh¬²ess", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(2),

219 ("ÿm”a.bÙ.backlightcom³n§tiÚ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0x00),

221 ("ÿm”a.bÙ.exposu»", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(140),

223 ("ÿm”a.bÙ.gaš", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(250),

225 ("ÿm”a.bÙ.wh™eb®ªû", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(3000),

229 
po
::
İtiÚs_desütiÚ
 
	`kšem©ics_cÚfig
("Kinematics options");

230 
kšem©ics_cÚfig
.
	`add_İtiÚs
()

231 ("kšem©ics.isC®ib¿tšg", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
çl£
),

233 ("kšem©ics.bodyP™ch", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

235 ("kšem©ics.ÿm”aYawTİ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

237 ("kšem©ics.ÿm”aRŞlTİ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

239 ("kšem©ics.ÿm”aRŞlBÙtom", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

241 ("kšem©ics.ÿm”aP™chTİ", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

243 ("kšem©ics.ÿm”aYawBÙtom", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

245 ("kšem©ics.ÿm”aP™chBÙtom", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

248 
po
::
İtiÚs_desütiÚ
 
	`touch_cÚfig
("Touch options");

249 
touch_cÚfig
.
	`add_İtiÚs
()

250 ("touch.gyrXOff£t", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

252 ("touch.gyrYOff£t", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

254 ("touch.ªgËXOff£t", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

256 ("touch.ªgËYOff£t", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0.0),

259 
po
::
İtiÚs_desütiÚ
 
	`gamecÚŒŞËr_cÚfig
("GameController options");

260 
gamecÚŒŞËr_cÚfig
.
	`add_İtiÚs
()

261 ("gamecÚŒŞËr.cÚÃù", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

263 ("gamecÚŒŞËr.¡©e", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("INITIAL"),

267 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("NORMAL"),

270 ("gamecÚŒŞËr.ourcŞour", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("blue"),

272 ("gamecÚŒŞËr.İpÚ’‰—m", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(1),

274 ("gamecÚŒŞËr.ourscÜe", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

276 ("gamecÚŒŞËr.İpÚ’tscÜe", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(0),

278 ("gamecÚŒŞËr.fœ¡h®f", 
po
::
v®ue
<
boŞ
>()->
	`deçuÉ_v®ue
(
Œue
),

280 ("gamecÚŒŞËr.kickofá—m", 
po
::
v®ue
<
¡ršg
>()->
	`deçuÉ_v®ue
("red"),

282 ("gamecÚŒŞËr.£c¤emaššg", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(600),

285 
po
::
İtiÚs_desütiÚ
 
	`Œªsm™‹r_cÚfig
("Transmitter options");

286 
Œªsm™‹r_cÚfig
.
	`add_İtiÚs
()

287 ("Œªsm™‹r.add»ss", 
po
::
v®ue
<
¡ršg
>()->
deçuÉ_v®ue


289 ("Œªsm™‹r.ba£_pÜt", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(10000),

292 
po
::
İtiÚs_desütiÚ
 
	`ÃtwÜk_cÚfig
("Networking options");

293 
ÃtwÜk_cÚfig
.
	`add_İtiÚs
()

294 ("ÃtwÜk.wœ–ess.iwcÚfig_æags", 
po
::
v®ue
<
¡ršg
>()->
deçuÉ_v®ue


296 ("ÃtwÜk.wœ–ess.¡©ic", 
po
::
v®ue
<
boŞ
>()->
deçuÉ_v®ue


297 (
Œue
), "sethe wirelesso static")

299 
po
::
v®ue
<
¡ršg
>()->
deçuÉ_v®ue


302 ("ÃtwÜk.wœed.¡©ic", 
po
::
v®ue
<
boŞ
>()->
deçuÉ_v®ue


303 (
çl£
), "sethe wiredo static")

304 ("ÃtwÜk.wœed.¡©ic.ifcÚfig_æags", 
po
::
v®ue
<
¡ršg
>()->
deçuÉ_v®ue


307 
po
::
İtiÚs_desütiÚ
 
	`»mÙe_cÚŒŞ_cÚfig
("Remote Control options");

308 
»mÙe_cÚŒŞ_cÚfig
.
	`add_İtiÚs
()

309 ("»mÙecÚŒŞ.pÜt", 
po
::
v®ue
<>()->
	`deçuÉ_v®ue
(4000),

312 
cÚfig_fe_İtiÚs
.
	`add
(
game_cÚfig
).add(
¶ay”_cÚfig
)

313 .
	`add
(
gamecÚŒŞËr_cÚfig
).add(
debug_cÚfig
).add(
behaviour_cÚfig
)

314 .
	`add
(
mÙiÚ_cÚfig
).add(
visiÚ_cÚfig
).add(
ÿm”a_cÚfig
).add(
kšem©ics_cÚfig
)

315 .
	`add
(
Œªsm™‹r_cÚfig
).add(
ÃtwÜk_cÚfig
).add(
touch_cÚfig
);

316 
	}
}

318 
	gpo
::
İtiÚs_desütiÚ
 
	$¡Üe_ªd_nÙify
(
¬gc
, **
¬gv
,

319 
po
::
v¬ŸbËs_m­
 &
vm
,

320 
po
::
İtiÚs_desütiÚ
* 
g’”ic
) {

321 
veùÜ
<
¡ršg
> 
	`vs
(
¬gv
 + 1,‡rgv + 
¬gc
);

324  
	`¡Üe_ªd_nÙify
(
vs
, 
vm
, 
g’”ic
);

325 
	}
}

328 
	gpo
::
İtiÚs_desütiÚ
 
¡Üe_ªd_nÙify
(
veùÜ
<
¡ršg
> 
¬gv
,

329 
po
::
v¬ŸbËs_m­
 &
vm
,

330 
po
::
İtiÚs_desütiÚ
* 
g’”ic
) {

331 
po
::
İtiÚs_desütiÚ
 
cÚfig_fe_İtiÚs
;

332 
pİuÏ‹_İtiÚs
(
cÚfig_fe_İtiÚs
);

334 
	gpo
::
İtiÚs_desütiÚ
 
cmdlše_İtiÚs
;

335 ià(
	gg’”ic
)

336 
	gcmdlše_İtiÚs
.
add
(*
g’”ic
);

337 
	gcmdlše_İtiÚs
.
add
(
cÚfig_fe_İtiÚs
);

346 
¡Üe
(
po
::
commªd_lše_·r£r
(
¬gv
).
İtiÚs
(
cmdlše_İtiÚs
).
run
(), 
vm
);

349 
	g¦i¡
<
	gveùÜ
<
	g¡ršg
> > 
	g¬gvs
;

350 
	g¦i¡
<
	gveùÜ
<
	g¡ršg
> >::
cÚ¡_™”©Ü
 
¬gv_ci
 = 
¬gvs
.
begš
();

351 
	g¬gv_ci
 !ğ
¬gvs
.
’d
(); ++argv_ci)

352 
¡Üe
(
po
::
commªd_lše_·r£r
(*
¬gv_ci
).
İtiÚs
(
cmdlše_İtiÚs
).
run
(),

353 
vm
);

355 
if¡»am
 
	gifs
;

356 
¡ršg
 
	gho¡Çme
;

358 
	gifs
.
İ’
("/etc/hostname");

359 
	gifs
 >> 
	gho¡Çme
;

360 
	gifs
.
şo£
();

362 
	gifs
.
İ’
(
¡ršg
("/home/Ço/d©a/cÚfigs/" + 
ho¡Çme
 + ".cfg").
c_¡r
());

363 
¡Üe
(
·r£_cÚfig_fe
(
ifs
, 
cÚfig_fe_İtiÚs
), 
vm
);

364 
	gifs
.
şo£
();

366 
	gifs
.
İ’
("/home/nao/data/runswift.cfg");

367 
¡Üe
(
·r£_cÚfig_fe
(
ifs
, 
cÚfig_fe_İtiÚs
), 
vm
);

368 
	gifs
.
şo£
();

370 
	gifs
.
İ’
("runswift.cfg");

371 
¡Üe
(
·r£_cÚfig_fe
(
ifs
, 
cÚfig_fe_İtiÚs
), 
vm
);

372 
	gifs
.
şo£
();

376 
	gpo
::
nÙify
(
vm
);

380 
	g¬gvs
.
push_äÚt
(
¬gv
);

382  
	gcmdlše_İtiÚs
;

386 
	sty³_šfo_com·»
 {

387 
boŞ
 
İ”©Ü
()(cÚ¡ 
ty³_šfo
* 
	mlhs
,

388 cÚ¡ 
ty³_šfo
* 
	mrhs
) const {

389  
	mlhs
->
befÜe
(*
rhs
);

394 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

395 
	souut_v®ue
 {

396 
İ”©Ü
()(cÚ¡ 
	mpo
::
v¬ŸbË_v®ue
& 
v
) const {

397 
cout
 << 
v
.
as
< 
T
 >(è<< 
’dl
;

401 
	$İtiÚs_´št
(
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
vm
) {

404 
m­
<cÚ¡ 
ty³_šfo
*,

405 
boo¡
::
funùiÚ
<(cÚ¡ 
po
::
v¬ŸbË_v®ue
&)>,

406 
ty³_šfo_com·»
> 
aùiÚ_m­
;

407 
aùiÚ_m­
[&
	`ty³id
(
¡ršg
)] = 
ouut_v®ue
<string>();

408 
aùiÚ_m­
[&
	`ty³id
()] = 
ouut_v®ue
<>();

409 
aùiÚ_m­
[&
	`ty³id
(
boŞ
)] = 
ouut_v®ue
<bool>();

410 
aùiÚ_m­
[&
	`ty³id
()] = 
ouut_v®ue
<>();

412 
po
::
v¬ŸbËs_m­
::
™”©Ü
 
™
;

413 
cout
 << 
’dl
;

414 
™
 = 
vm
.
	`begš
(); iˆ!ğvm.
	`’d
(); ++it) {

416 cÚ¡ 
po
::
v¬ŸbË_v®ue
& 
v
 = 
™
->
£cÚd
;

417 ià(!
v
.
	`em±y
()) {

418 
cout
 << 
	`£tw
(20è<< 
Ëá
 << 
™
->
fœ¡
 << ": ";

419 
aùiÚ_m­
[&
v
.
	`v®ue
().
	`ty³
()](v);

422 
	}
}

	@robot/utils/options.hpp

32 #´agm¨
Úû


33 
	~<boo¡/´og¿m_İtiÚs.hµ
>

34 
	~<¡ršg
>

35 
	~<veùÜ
>

37 
pİuÏ‹_İtiÚs
(

38 
boo¡
::
´og¿m_İtiÚs
::
İtiÚs_desütiÚ
 &
cÚfig_fe_İtiÚs
);

54 
	gboo¡
::
´og¿m_İtiÚs
::
İtiÚs_desütiÚ


55 
¡Üe_ªd_nÙify
(
¡d
::
veùÜ
<¡d::
¡ršg
> 
¬gv
,

56 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
vm
,

57 
boo¡
::
´og¿m_İtiÚs
::
İtiÚs_desütiÚ
* 
g’”ic
 =

58 
NULL
);

75 
	gboo¡
::
´og¿m_İtiÚs
::
İtiÚs_desütiÚ


76 
¡Üe_ªd_nÙify
(
¬gc
, **
¬gv
,

77 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
vm
,

78 
boo¡
::
´og¿m_İtiÚs
::
İtiÚs_desütiÚ
* 
g’”ic
 =

79 
NULL
);

81 
İtiÚs_´št
(
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 &
vm
);

	@robot/utils/snappy/snappy-c.cc

29 
	~"¢­py.h
"

30 
	~"¢­py-c.h
"

34 
¢­py_¡©us
 
¢­py_com´ess
(cÚ¡ * 
šput
,

35 
size_t
 
šput_Ëngth
,

36 * 
com´es£d
,

37 
size_t
 *
com´es£d_Ëngth
) {

38 ià(*
com´es£d_Ëngth
 < 
¢­py_max_com´es£d_Ëngth
(
šput_Ëngth
)) {

39  
SNAPPY_BUFFER_TOO_SMALL
;

41 
¢­py
::
RawCom´ess
(
šput
, 
šput_Ëngth
, 
com´es£d
, 
com´es£d_Ëngth
);

42  
SNAPPY_OK
;

45 
¢­py_¡©us
 
¢­py_uncom´ess
(cÚ¡ * 
com´es£d
,

46 
size_t
 
com´es£d_Ëngth
,

47 * 
uncom´es£d
,

48 
size_t
* 
uncom´es£d_Ëngth
) {

49 
size_t
 
»®_uncom´es£d_Ëngth
;

50 ià(!
¢­py
::
G‘Uncom´es£dL’gth
(
com´es£d
,

51 
com´es£d_Ëngth
,

52 &
»®_uncom´es£d_Ëngth
)) {

53  
SNAPPY_INVALID_INPUT
;

55 ià(*
uncom´es£d_Ëngth
 < 
»®_uncom´es£d_Ëngth
) {

56  
SNAPPY_BUFFER_TOO_SMALL
;

58 ià(!
¢­py
::
RawUncom´ess
(
com´es£d
, 
com´es£d_Ëngth
, 
uncom´es£d
)) {

59  
SNAPPY_INVALID_INPUT
;

61 *
uncom´es£d_Ëngth
 = 
»®_uncom´es£d_Ëngth
;

62  
SNAPPY_OK
;

65 
size_t
 
¢­py_max_com´es£d_Ëngth
(size_ˆ
sourû_Ëngth
) {

66  
¢­py
::
MaxCom´es£dL’gth
(
sourû_Ëngth
);

69 
¢­py_¡©us
 
¢­py_uncom´es£d_Ëngth
(cÚ¡ *
com´es£d
,

70 
size_t
 
com´es£d_Ëngth
,

71 
size_t
 *
»suÉ
) {

72 ià(
¢­py
::
G‘Uncom´es£dL’gth
(
com´es£d
,

73 
com´es£d_Ëngth
,

74 
»suÉ
)) {

75  
SNAPPY_OK
;

77  
SNAPPY_INVALID_INPUT
;

81 
¢­py_¡©us
 
¢­py_v®id©e_com´es£d_bufãr
(cÚ¡ *
com´es£d
,

82 
size_t
 
com´es£d_Ëngth
) {

83 ià(
¢­py
::
IsV®idCom´es£dBufãr
(
com´es£d
, 
com´es£d_Ëngth
)) {

84  
SNAPPY_OK
;

86  
SNAPPY_INVALID_INPUT
;

	@robot/utils/snappy/snappy-c.h

33 #iâdeà
THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_C_H_


34 
	#THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_C_H_


	)

36 #ifdeà
__ılu¥lus


40 
	~<¡ddef.h
>

47 
SNAPPY_OK
 = 0,

48 
SNAPPY_INVALID_INPUT
 = 1,

49 
SNAPPY_BUFFER_TOO_SMALL
 = 2

50 } 
	t¢­py_¡©us
;

71 
¢­py_¡©us
 
¢­py_com´ess
(cÚ¡ * 
šput
,

72 
size_t
 
šput_Ëngth
,

73 * 
com´es£d
,

74 
size_t
* 
com´es£d_Ëngth
);

103 
¢­py_¡©us
 
¢­py_uncom´ess
(cÚ¡ * 
com´es£d
,

104 
size_t
 
com´es£d_Ëngth
,

105 * 
uncom´es£d
,

106 
size_t
* 
uncom´es£d_Ëngth
);

112 
size_t
 
¢­py_max_com´es£d_Ëngth
(size_ˆ
sourû_Ëngth
);

120 
¢­py_¡©us
 
¢­py_uncom´es£d_Ëngth
(cÚ¡ * 
com´es£d
,

121 
size_t
 
com´es£d_Ëngth
,

122 
size_t
* 
»suÉ
);

131 
¢­py_¡©us
 
¢­py_v®id©e_com´es£d_bufãr
(cÚ¡ * 
com´es£d
,

132 
size_t
 
com´es£d_Ëngth
);

134 #ifdeà
__ılu¥lus


	@robot/utils/snappy/snappy-internal.h

31 #iâdeà
THIRD_PARTY_SNAPPY_SNAPPY_INTERNAL_H_


32 
	#THIRD_PARTY_SNAPPY_SNAPPY_INTERNAL_H_


	)

34 
	~"¢­py-¡ubs-š‹º®.h
"

36 
Çme¥aû
 
	g¢­py
 {

37 
Çme¥aû
 
	gš‹º®
 {

39 şas 
	cWÜkšgMemÜy
 {

40 
	gpublic
:

41 
WÜkšgMemÜy
(è: 
Ïrge_bË_
(
NULL
) { }

42 ~
WÜkšgMemÜy
(è{ 
d–‘e
[] 
Ïrge_bË_
; }

47 
ušt16
* 
G‘HashTabË
(
size_t
 
šput_size
, * 
bË_size
);

49 
	g´iv©e
:

50 
ušt16
 
sm®l_bË_
[1<<10];

51 
ušt16
* 
	gÏrge_bË_
;

53 
DISALLOW_COPY_AND_ASSIGN
(
WÜkšgMemÜy
);

67 * 
Com´essF¿gm’t
(cÚ¡ * 
šput
,

68 
size_t
 
šput_Ëngth
,

69 * 
İ
,

70 
ušt16
* 
bË
,

71 cÚ¡ 
bË_size
);

84 #ià
defšed
(
ARCH_K8
)

85 
šlše
 
FšdM©chL’gth
(cÚ¡ * 
s1
,

86 cÚ¡ * 
s2
,

87 cÚ¡ * 
s2_lim™
) {

88 
as£¹
(
s2_lim™
 >ğ
s2
);

89 
	gm©ched
 = 0;

95 
PREDICT_TRUE
(
s2
 <ğ
s2_lim™
 - 8)) {

96 ià(
UNALIGNED_LOAD64
(
s2
è=ğUNALIGNED_LOAD64(
s1
 + 
m©ched
)) {

97 
s2
 += 8;

98 
	gm©ched
 += 8;

104 
ušt64
 
	gx
 = 
UNALIGNED_LOAD64
(
s2
è^ UNALIGNED_LOAD64(
s1
 + 
m©ched
);

105 
	gm©chšg_b™s
 = 
B™s
::
FšdLSBS‘NÚZ”o64
(
x
);

106 
	gm©ched
 +ğ
m©chšg_b™s
 >> 3;

107  
	gm©ched
;

110 
PREDICT_TRUE
(
s2
 < 
s2_lim™
)) {

111 ià(
	gs1
[
m©ched
] =ğ*
s2
) {

112 ++
s2
;

113 ++
	gm©ched
;

115  
	gm©ched
;

118  
	gm©ched
;

121 
šlše
 
FšdM©chL’gth
(cÚ¡ * 
s1
,

122 cÚ¡ * 
s2
,

123 cÚ¡ * 
s2_lim™
) {

125 
as£¹
(
s2_lim™
 >ğ
s2
);

126 
	gm©ched
 = 0;

128 
	gs2
 <ğ
s2_lim™
 - 4 &&

129 
UNALIGNED_LOAD32
(
s2
è=ğUNALIGNED_LOAD32(
s1
 + 
m©ched
)) {

130 
s2
 += 4;

131 
	gm©ched
 += 4;

133 ià(
	gL™eEndŸn
::
IsL™eEndŸn
(è&& 
s2
 <ğ
s2_lim™
 - 4) {

134 
ušt32
 
x
 = 
UNALIGNED_LOAD32
(
s2
è^ UNALIGNED_LOAD32(
s1
 + 
m©ched
);

135 
	gm©chšg_b™s
 = 
B™s
::
FšdLSBS‘NÚZ”o
(
x
);

136 
	gm©ched
 +ğ
m©chšg_b™s
 >> 3;

138 (
	gs2
 < 
	gs2_lim™
è&& (
	gs1
[
m©ched
] =ğ*
s2
)) {

139 ++
s2
;

140 ++
	gm©ched
;

143  
	gm©ched
;

151 
	gLITERAL
 = 0,

152 
	gCOPY_1_BYTE_OFFSET
 = 1,

153 
	gCOPY_2_BYTE_OFFSET
 = 2,

154 
	gCOPY_4_BYTE_OFFSET
 = 3

156 cÚ¡ 
	gkMaximumTagL’gth
 = 5;

159 cÚ¡ 
ušt32
 
	gwÜdmask
[] = {

174 cÚ¡ 
ušt16
 
	gch¬_bË
[256] = {

	@robot/utils/snappy/snappy-sinksource.cc

29 
	~<¡ršg.h
>

31 
	~"¢­py-sšksourû.h
"

33 
Çme¥aû
 
	g¢­py
 {

35 
	gSourû
::~
Sourû
() { }

37 
Sšk
::~Sink() { }

39 * 
Sšk
::
G‘Aµ’dBufãr
(
size_t
 
Ëngth
, * 
sü©ch
) {

40  
	gsü©ch
;

43 * 
	gSšk
::
G‘Aµ’dBufãrV¬ŸbË
(

44 
size_t
 
mš_size
, size_ˆ
desœed_size_hšt
, * 
sü©ch
,

45 
size_t
 
sü©ch_size
, size_t* 
®loÿ‹d_size
) {

46 *
	g®loÿ‹d_size
 = 
sü©ch_size
;

47  
	gsü©ch
;

50 
	gSšk
::
Aµ’dAndTakeOwÃrsh
(

51 * 
by‹s
, 
size_t
 
n
,

52 (*
d–‘”
)(*, cÚ¡ *, 
size_t
),

53 *
d–‘”_¬g
) {

54 
Aµ’d
(
by‹s
, 
n
);

55 (*
	gd–‘”
)(
	gd–‘”_¬g
, 
	gby‹s
, 
	gn
);

58 
	gBy‹A¼aySourû
::~
By‹A¼aySourû
() { }

60 
size_t
 
By‹A¼aySourû
::
AvaabË
(ècÚ¡ {  
Ëá_
; }

62 cÚ¡ * 
	gBy‹A¼aySourû
::
P“k
(
size_t
* 
Ën
) {

63 *
Ën
 = 
Ëá_
;

64  
	g±r_
;

67 
	gBy‹A¼aySourû
::
Sk
(
size_t
 
n
) {

68 
Ëá_
 -ğ
n
;

69 
	g±r_
 +ğ
n
;

72 
	gUncheckedBy‹A¼aySšk
::~
UncheckedBy‹A¼aySšk
() { }

74 
UncheckedBy‹A¼aySšk
::
Aµ’d
(cÚ¡ * 
d©a
, 
size_t
 
n
) {

76 ià(
	gd©a
 !ğ
de¡_
) {

77 
memıy
(
de¡_
, 
d©a
, 
n
);

79 
	gde¡_
 +ğ
n
;

82 * 
	gUncheckedBy‹A¼aySšk
::
G‘Aµ’dBufãr
(
size_t
 
Ën
, * 
sü©ch
) {

83  
	gde¡_
;

86 
	gUncheckedBy‹A¼aySšk
::
Aµ’dAndTakeOwÃrsh
(

87 * 
d©a
, 
size_t
 
n
,

88 (*
d–‘”
)(*, cÚ¡ *, 
size_t
),

89 *
d–‘”_¬g
) {

90 ià(
	gd©a
 !ğ
de¡_
) {

91 
memıy
(
de¡_
, 
d©a
, 
n
);

92 (*
	gd–‘”
)(
	gd–‘”_¬g
, 
	gd©a
, 
	gn
);

94 
	gde¡_
 +ğ
n
;

97 * 
	gUncheckedBy‹A¼aySšk
::
G‘Aµ’dBufãrV¬ŸbË
(

98 
size_t
 
mš_size
, size_ˆ
desœed_size_hšt
, * 
sü©ch
,

99 
size_t
 
sü©ch_size
, size_t* 
®loÿ‹d_size
) {

100 *
	g®loÿ‹d_size
 = 
desœed_size_hšt
;

101  
	gde¡_
;

	@robot/utils/snappy/snappy-sinksource.h

29 #iâdeà
THIRD_PARTY_SNAPPY_SNAPPY_SINKSOURCE_H_


30 
	#THIRD_PARTY_SNAPPY_SNAPPY_SINKSOURCE_H_


	)

32 
	~<¡ddef.h
>

34 
Çme¥aû
 
	g¢­py
 {

37 şas 
	cSšk
 {

38 
	gpublic
:

39 
Sšk
() { }

40 
vœtu®
 ~
Sšk
();

43 
vœtu®
 
Aµ’d
(cÚ¡ * 
by‹s
, 
size_t
 
n
) = 0;

60 
vœtu®
 * 
G‘Aµ’dBufãr
(
size_t
 
Ëngth
, * 
sü©ch
);

73 
vœtu®
 
Aµ’dAndTakeOwÃrsh
(

74 * 
by‹s
, 
size_t
 
n
, (*
d–‘”
)(*, const *, size_t),

75 *
d–‘”_¬g
);

100 
vœtu®
 * 
G‘Aµ’dBufãrV¬ŸbË
(

101 
size_t
 
mš_size
, size_ˆ
desœed_size_hšt
, * 
sü©ch
,

102 
size_t
 
sü©ch_size
, size_t* 
®loÿ‹d_size
);

104 
	g´iv©e
:

106 
Sšk
(const Sink&);

107 
	gİ”©Ü
=(cÚ¡ 
Sšk
&);

111 şas 
	cSourû
 {

112 
	gpublic
:

113 
Sourû
() { }

114 
vœtu®
 ~
Sourû
();

117 
vœtu®
 
size_t
 
AvaabË
() const = 0;

132 
vœtu®
 cÚ¡ * 
P“k
(
size_t
* 
Ën
) = 0;

137 
vœtu®
 
Sk
(
size_t
 
n
) = 0;

139 
	g´iv©e
:

141 
Sourû
(const Source&);

142 
	gİ”©Ü
=(cÚ¡ 
Sourû
&);

146 şas 
	cBy‹A¼aySourû
 : 
public
 
Sourû
 {

147 
public
:

148 
By‹A¼aySourû
(cÚ¡ * 
p
, 
size_t
 
n
è: 
±r_
Õ), 
Ëá_
(n) { }

149 
	gvœtu®
 ~
By‹A¼aySourû
();

150 
vœtu®
 
size_t
 
AvaabË
() const;

151 
vœtu®
 cÚ¡ * 
P“k
(
size_t
* 
Ën
);

152 
vœtu®
 
Sk
(
size_t
 
n
);

153 
	g´iv©e
:

154 cÚ¡ * 
±r_
;

155 
size_t
 
	gËá_
;

159 şas 
	cUncheckedBy‹A¼aySšk
 : 
public
 
Sšk
 {

160 
public
:

161 
ex¶ic™
 
UncheckedBy‹A¼aySšk
(* 
de¡
è: 
de¡_
(dest) { }

162 
vœtu®
 ~
UncheckedBy‹A¼aySšk
();

163 
vœtu®
 
Aµ’d
(cÚ¡ * 
d©a
, 
size_t
 
n
);

164 
vœtu®
 * 
G‘Aµ’dBufãr
(
size_t
 
Ën
, * 
sü©ch
);

165 
vœtu®
 * 
G‘Aµ’dBufãrV¬ŸbË
(

166 
size_t
 
mš_size
, size_ˆ
desœed_size_hšt
, * 
sü©ch
,

167 
size_t
 
sü©ch_size
, size_t* 
®loÿ‹d_size
);

168 
vœtu®
 
Aµ’dAndTakeOwÃrsh
(

169 * 
by‹s
, 
size_t
 
n
, (*
d–‘”
)(*, const *, size_t),

170 *
d–‘”_¬g
);

175 * 
Cu¼’tDe¡š©iÚ
(ècÚ¡ {  
	gde¡_
; }

176 
	g´iv©e
:

177 * 
de¡_
;

	@robot/utils/snappy/snappy-stubs-internal.cc

29 
	~<®gÜ™hm
>

30 
	~<¡ršg
>

32 
	~"¢­py-¡ubs-š‹º®.h
"

34 
Çme¥aû
 
	g¢­py
 {

36 
	gV¬št
::
Aµ’d32
(
¡ršg
* 
s
, 
ušt32
 
v®ue
) {

37 
	gbuf
[
V¬št
::
kMax32
];

38 cÚ¡ * 
	gp
 = 
V¬št
::
Encode32
(
buf
, 
v®ue
);

39 
	gs
->
­³nd
(
buf
, 
p
 - buf);

	@robot/utils/snappy/snappy-stubs-internal.h

31 #iâdeà
THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_STUBS_INTERNAL_H_


32 
	#THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_STUBS_INTERNAL_H_


	)

34 #ifdeà
HAVE_CONFIG_H


35 
	~"cÚfig.h
"

38 
	~<¡ršg
>

40 
	~<as£¹.h
>

41 
	~<¡dlib.h
>

42 
	~<¡ršg.h
>

44 #ifdeà
HAVE_SYS_MMAN_H


45 
	~<sys/mmª.h
>

48 
	~"¢­py-¡ubs-public.h
"

50 #ià
defšed
(
__x86_64__
)

53 
	#ARCH_K8
 1

	)

58 #iâdeà
MAP_ANONYMOUS


59 
	#MAP_ANONYMOUS
 
MAP_ANON


	)

64 
usšg
 
Çme¥aû
 
	g¡d
;

69 #ifdeà
ARRAYSIZE


70 #undeà
ARRAYSIZE


72 
	#ARRAYSIZE
(
a
è(×è/ (*×)))

	)

75 #ifdeà
HAVE_BUILTIN_EXPECT


76 
	#PREDICT_FALSE
(
x
è(
	`__butš_ex³ù
(x, 0))

	)

77 
	#PREDICT_TRUE
(
x
è(
	`__butš_ex³ù
(!!(x), 1))

	)

79 
	#PREDICT_FALSE
(
x
è
	)
x

80 
	#PREDICT_TRUE
(
x
è
	)
x

87 
	#DEFINE_boŞ
(
æag_Çme
, 
deçuÉ_v®ue
, 
desütiÚ
) \

88 
boŞ
 
FLAGS_
 ## 
æag_Çme
 = 
deçuÉ_v®ue


	)

89 
	#DECLARE_boŞ
(
æag_Çme
) \

90 
boŞ
 
FLAGS_
 ## 
æag_Çme


	)

92 
Çme¥aû
 
¢­py
 {

94 cÚ¡ 
ušt32
 
kušt32max
 = 
¡©ic_ÿ¡
<uint32>(0xFFFFFFFF);

95 cÚ¡ 
št64
 
kšt64max
 = 
¡©ic_ÿ¡
<int64>(0x7FFFFFFFFFFFFFFFLL);

101 #ià
defšed
(
__i386__
è|| defšed(
__x86_64__
è|| defšed(
__pow”pc__
)

103 
	#UNALIGNED_LOAD16
(
_p
è(*
»š‹½»t_ÿ¡
<cÚ¡ 
ušt16
 *>(_p))

	)

104 
	#UNALIGNED_LOAD32
(
_p
è(*
»š‹½»t_ÿ¡
<cÚ¡ 
ušt32
 *>(_p))

	)

105 
	#UNALIGNED_LOAD64
(
_p
è(*
»š‹½»t_ÿ¡
<cÚ¡ 
ušt64
 *>(_p))

	)

107 
	#UNALIGNED_STORE16
(
_p
, 
_v®
è(*
»š‹½»t_ÿ¡
<
ušt16
 *>(_pèğ(_v®))

	)

108 
	#UNALIGNED_STORE32
(
_p
, 
_v®
è(*
»š‹½»t_ÿ¡
<
ušt32
 *>(_pèğ(_v®))

	)

109 
	#UNALIGNED_STORE64
(
_p
, 
_v®
è(*
»š‹½»t_ÿ¡
<
ušt64
 *>(_pèğ(_v®))

	)

129 #–ià
defšed
(
__¬m__
) && \

130 !
defšed
(
__ARM_ARCH_4__
) && \

131 !
defšed
(
__ARM_ARCH_4T__
) && \

132 !
defšed
(
__ARM_ARCH_5__
) && \

133 !
defšed
(
__ARM_ARCH_5T__
) && \

134 !
defšed
(
__ARM_ARCH_5TE__
) && \

135 !
defšed
(
__ARM_ARCH_5TEJ__
) && \

136 !
defšed
(
__ARM_ARCH_6__
) && \

137 !
defšed
(
__ARM_ARCH_6J__
) && \

138 !
defšed
(
__ARM_ARCH_6K__
) && \

139 !
defšed
(
__ARM_ARCH_6Z__
) && \

140 !
defšed
(
__ARM_ARCH_6ZK__
) && \

141 !
defšed
(
__ARM_ARCH_6T2__
)

143 #ià
__GNUC__


144 
	#ATTRIBUTE_PACKED
 
	`__©Œibu‹__
((
__·cked__
))

	)

146 
	#ATTRIBUTE_PACKED


	)

149 
Çme¥aû
 
ba£
 {

150 
Çme¥aû
 
š‹º®
 {

152 
	sUÇligÃd16SŒuù
 {

153 
ušt16
 
v®ue
;

154 
ušt8
 
dummy
;

155 } 
ATTRIBUTE_PACKED
;

157 
	sUÇligÃd32SŒuù
 {

158 
ušt32
 
v®ue
;

159 
ušt8
 
dummy
;

160 } 
ATTRIBUTE_PACKED
;

165 
	#UNALIGNED_LOAD16
(
_p
) \

166 ((
»š‹½»t_ÿ¡
<cÚ¡ ::
¢­py
::
ba£
::
š‹º®
::
UÇligÃd16SŒuù
 *>(
_p
))->
v®ue
)

	)

167 
	#UNALIGNED_LOAD32
(
_p
) \

168 ((
»š‹½»t_ÿ¡
<cÚ¡ ::
¢­py
::
ba£
::
š‹º®
::
UÇligÃd32SŒuù
 *>(
_p
))->
v®ue
)

	)

170 
	#UNALIGNED_STORE16
(
_p
, 
_v®
) \

171 ((
»š‹½»t_ÿ¡
< ::
¢­py
::
ba£
::
š‹º®
::
UÇligÃd16SŒuù
 *>(
_p
))->
v®ue
 = \

172 (
_v®
))

	)

173 
	#UNALIGNED_STORE32
(
_p
, 
_v®
) \

174 ((
»š‹½»t_ÿ¡
< ::
¢­py
::
ba£
::
š‹º®
::
UÇligÃd32SŒuù
 *>(
_p
))->
v®ue
 = \

175 (
_v®
))

	)

181 
šlše
 
ušt64
 
UNALIGNED_LOAD64
(cÚ¡ *
p
) {

182 
ušt64
 
t
;

183 
memıy
(&
t
, 
p
, );

184  
t
;

187 
šlše
 
UNALIGNED_STORE64
(*
p
, 
ušt64
 
v
) {

188 
memıy
(
p
, &
v
,  v);

196 
šlše
 
ušt16
 
UNALIGNED_LOAD16
(cÚ¡ *
p
) {

197 
ušt16
 
t
;

198 
memıy
(&
t
, 
p
, );

199  
t
;

202 
šlše
 
ušt32
 
UNALIGNED_LOAD32
(cÚ¡ *
p
) {

203 
ušt32
 
t
;

204 
memıy
(&
t
, 
p
, );

205  
t
;

208 
šlše
 
ušt64
 
UNALIGNED_LOAD64
(cÚ¡ *
p
) {

209 
ušt64
 
t
;

210 
memıy
(&
t
, 
p
, );

211  
t
;

214 
šlše
 
UNALIGNED_STORE16
(*
p
, 
ušt16
 
v
) {

215 
memıy
(
p
, &
v
,  v);

218 
šlše
 
UNALIGNED_STORE32
(*
p
, 
ušt32
 
v
) {

219 
memıy
(
p
, &
v
,  v);

222 
šlše
 
UNALIGNED_STORE64
(*
p
, 
ušt64
 
v
) {

223 
memıy
(
p
, &
v
,  v);

230 
šlše
 
UÇligÃdCİy64
(cÚ¡ *
¤c
, *
d¡
) {

232 
UNALIGNED_STORE64
(
d¡
, 
UNALIGNED_LOAD64
(
¤c
));

234 cÚ¡ *
¤c_ch¬
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
¤c
);

235 *
d¡_ch¬
 = 
»š‹½»t_ÿ¡
<*>(
d¡
);

237 
UNALIGNED_STORE32
(
d¡_ch¬
, 
UNALIGNED_LOAD32
(
¤c_ch¬
));

238 
UNALIGNED_STORE32
(
d¡_ch¬
 + 4, 
UNALIGNED_LOAD32
(
¤c_ch¬
 + 4));

243 #ifdeà
WORDS_BIGENDIAN


245 #ifdeà
HAVE_SYS_BYTEORDER_H


246 
	~<sys/by‹Üd”.h
>

249 #ifdeà
HAVE_SYS_ENDIAN_H


250 
	~<sys/’dŸn.h
>

253 #ifdeà
_MSC_VER


254 
	~<¡dlib.h
>

255 
	#bsw­_16
(
x
è
	`_by‹sw­_ushÜt
(x)

	)

256 
	#bsw­_32
(
x
è
	`_by‹sw­_ulÚg
(x)

	)

257 
	#bsw­_64
(
x
è
	`_by‹sw­_ušt64
(x)

	)

259 #–ià
defšed
(
__APPLE__
)

261 
	~<libk”n/OSBy‹Ord”.h
>

262 
	#bsw­_16
(
x
è
	`OSSw­IÁ16
(x)

	)

263 
	#bsw­_32
(
x
è
	`OSSw­IÁ32
(x)

	)

264 
	#bsw­_64
(
x
è
	`OSSw­IÁ64
(x)

	)

266 #–ià
defšed
(
HAVE_BYTESWAP_H
)

267 
	~<by‹sw­.h
>

269 #–ià
defšed
(
bsw­32
)

271 
	#bsw­_16
(
x
è
	`bsw­16
(x)

	)

272 
	#bsw­_32
(
x
è
	`bsw­32
(x)

	)

273 
	#bsw­_64
(
x
è
	`bsw­64
(x)

	)

275 #–ià
defšed
(
BSWAP_64
)

277 
	#bsw­_16
(
x
è
	`BSWAP_16
(x)

	)

278 
	#bsw­_32
(
x
è
	`BSWAP_32
(x)

	)

279 
	#bsw­_64
(
x
è
	`BSWAP_64
(x)

	)

283 
šlše
 
ušt16
 
bsw­_16
(ušt16 
x
) {

284  (
x
 << 8) | (x >> 8);

287 
šlše
 
ušt32
 
bsw­_32
(ušt32 
x
) {

288 
x
 = ((x & 0xff00ff00UL) >> 8) | ((x & 0x00ff00ffUL) << 8);

289  (
x
 >> 16) | (x << 16);

292 
šlše
 
ušt64
 
bsw­_64
(ušt64 
x
) {

293 
x
 = ((x & 0xff00ff00ff00ff00ULL) >> 8) | ((x & 0x00ff00ff00ff00ffULL) << 8);

294 
x
 = ((x & 0xffff0000ffff0000ULL) >> 16) | ((x & 0x0000ffff0000ffffULL) << 16);

295  (
x
 >> 32) | (x << 32);

311 şas 
	cL™eEndŸn
 {

312 
public
:

314 #ifdeà
WORDS_BIGENDIAN


316 
ušt16
 
FromHo¡16
(ušt16 
x
è{  
bsw­_16
(x); }

317 
ušt16
 
ToHo¡16
(ušt16 
x
è{  
bsw­_16
(x); }

319 
ušt32
 
FromHo¡32
(ušt32 
x
è{  
bsw­_32
(x); }

320 
ušt32
 
ToHo¡32
(ušt32 
x
è{  
bsw­_32
(x); }

322 
boŞ
 
IsL™eEndŸn
(è{  
çl£
; }

326 
ušt16
 
FromHo¡16
(ušt16 
x
) {  x; }

327 
ušt16
 
ToHo¡16
(ušt16 
x
) {  x; }

329 
ušt32
 
FromHo¡32
(ušt32 
x
) {  x; }

330 
ušt32
 
ToHo¡32
(ušt32 
x
) {  x; }

332 
boŞ
 
IsL™eEndŸn
(è{  
Œue
; }

337 
ušt16
 
Lßd16
(cÚ¡ *
p
) {

338  
ToHo¡16
(
UNALIGNED_LOAD16
(
p
));

341 
StÜe16
(*
p
, 
ušt16
 
v
) {

342 
UNALIGNED_STORE16
(
p
, 
FromHo¡16
(
v
));

345 
ušt32
 
Lßd32
(cÚ¡ *
p
) {

346  
ToHo¡32
(
UNALIGNED_LOAD32
(
p
));

349 
StÜe32
(*
p
, 
ušt32
 
v
) {

350 
UNALIGNED_STORE32
(
p
, 
FromHo¡32
(
v
));

355 şas 
	cB™s
 {

356 
public
:

358 
Log2FloÜ
(
ušt32
 
n
);

363 
FšdLSBS‘NÚZ”o
(
ušt32
 
n
);

364 
FšdLSBS‘NÚZ”o64
(
ušt64
 
n
);

366 
´iv©e
:

367 
DISALLOW_COPY_AND_ASSIGN
(
B™s
);

370 #ifdeà
HAVE_BUILTIN_CTZ


372 
šlše
 
B™s
::
	$Log2FloÜ
(
ušt32
 
n
) {

373  
n
 =ğ0 ? -1 : 31 ^ 
	`__butš_şz
(n);

374 
	}
}

376 
šlše
 
B™s
::
	$FšdLSBS‘NÚZ”o
(
ušt32
 
n
) {

377  
	`__butš_ùz
(
n
);

378 
	}
}

380 
šlše
 
B™s
::
	$FšdLSBS‘NÚZ”o64
(
ušt64
 
n
) {

381  
	`__butš_ùzÎ
(
n
);

382 
	}
}

386 
šlše
 
B™s
::
	$Log2FloÜ
(
ušt32
 
n
) {

387 ià(
n
 == 0)

389 
log
 = 0;

390 
ušt32
 
v®ue
 = 
n
;

391 
i
 = 4; i >= 0; --i) {

392 
shiá
 = (1 << 
i
);

393 
ušt32
 
x
 = 
v®ue
 >> 
shiá
;

394 ià(
x
 != 0) {

395 
v®ue
 = 
x
;

396 
log
 +ğ
shiá
;

399 
	`as£¹
(
v®ue
 == 1);

400  
log
;

401 
	}
}

403 
šlše
 
B™s
::
	$FšdLSBS‘NÚZ”o
(
ušt32
 
n
) {

404 
rc
 = 31;

405 
i
 = 4, 
shiá
 = 1 << 4; i >= 0; --i) {

406 cÚ¡ 
ušt32
 
x
 = 
n
 << 
shiá
;

407 ià(
x
 != 0) {

408 
n
 = 
x
;

409 
rc
 -ğ
shiá
;

411 
shiá
 >>= 1;

413  
rc
;

414 
	}
}

417 
šlše
 
B™s
::
	$FšdLSBS‘NÚZ”o64
(
ušt64
 
n
) {

418 cÚ¡ 
ušt32
 
bÙtomb™s
 = 
¡©ic_ÿ¡
<ušt32>(
n
);

419 ià(
bÙtomb™s
 == 0) {

421  32 + 
	`FšdLSBS‘NÚZ”o
(
¡©ic_ÿ¡
<
ušt32
>(
n
 >> 32));

423  
	`FšdLSBS‘NÚZ”o
(
bÙtomb™s
);

425 
	}
}

430 şas 
	cV¬št
 {

431 
public
:

433 cÚ¡ 
kMax32
 = 5;

440 cÚ¡ * 
P¬£32W™hLim™
(cÚ¡ * 
±r
, cÚ¡ * 
lim™
,

441 
ušt32
* 
OUTPUT
);

446 * 
Encode32
(* 
±r
, 
ušt32
 
v
);

449 
Aµ’d32
(
¡ršg
* 
s
, 
ušt32
 
v®ue
);

452 
šlše
 cÚ¡ * 
V¬št
::
	$P¬£32W™hLim™
(cÚ¡ * 
p
,

453 cÚ¡ * 
l
,

454 
ušt32
* 
OUTPUT
) {

455 cÚ¡ * 
±r
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
);

456 cÚ¡ * 
lim™
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
l
);

457 
ušt32
 
b
, 
»suÉ
;

458 ià(
±r
 >ğ
lim™
è 
NULL
;

459 
b
 = *(
±r
++); 
»suÉ
 = b & 127; ià(b < 128è
dÚe
;

460 ià(
±r
 >ğ
lim™
è 
NULL
;

461 
b
 = *(
±r
++); 
»suÉ
 |ğ(b & 127è<< 7; ià(b < 128è
dÚe
;

462 ià(
±r
 >ğ
lim™
è 
NULL
;

463 
b
 = *(
±r
++); 
»suÉ
 |ğ(b & 127è<< 14; ià(b < 128è
dÚe
;

464 ià(
±r
 >ğ
lim™
è 
NULL
;

465 
b
 = *(
±r
++); 
»suÉ
 |ğ(b & 127è<< 21; ià(b < 128è
dÚe
;

466 ià(
±r
 >ğ
lim™
è 
NULL
;

467 
b
 = *(
±r
++); 
»suÉ
 |ğ(b & 127è<< 28; ià(b < 16è
dÚe
;

468  
NULL
;

469 
dÚe
:

470 *
OUTPUT
 = 
»suÉ
;

471  
»š‹½»t_ÿ¡
<cÚ¡ *>(
±r
);

472 
	}
}

474 
šlše
 * 
V¬št
::
	$Encode32
(* 
¥Œ
, 
ušt32
 
v
) {

476 * 
±r
 = 
»š‹½»t_ÿ¡
<*>(
¥Œ
);

477 cÚ¡ 
B
 = 128;

478 ià(
v
 < (1<<7)) {

479 *(
±r
++èğ
v
;

480 } ià(
v
 < (1<<14)) {

481 *(
±r
++èğ
v
 | 
B
;

482 *(
±r
++èğ
v
>>7;

483 } ià(
v
 < (1<<21)) {

484 *(
±r
++èğ
v
 | 
B
;

485 *(
±r
++èğ(
v
>>7è| 
B
;

486 *(
±r
++èğ
v
>>14;

487 } ià(
v
 < (1<<28)) {

488 *(
±r
++èğ
v
 | 
B
;

489 *(
±r
++èğ(
v
>>7è| 
B
;

490 *(
±r
++èğ(
v
>>14è| 
B
;

491 *(
±r
++èğ
v
>>21;

493 *(
±r
++èğ
v
 | 
B
;

494 *(
±r
++èğ(
v
>>7è| 
B
;

495 *(
±r
++èğ(
v
>>14è| 
B
;

496 *(
±r
++èğ(
v
>>21è| 
B
;

497 *(
±r
++èğ
v
>>28;

499  
»š‹½»t_ÿ¡
<*>(
±r
);

500 
	}
}

506 
šlše
 
	$STLSŒšgResizeUnš™Ÿlized
(
¡ršg
* 
s
, 
size_t
 
Ãw_size
) {

507 
s
->
	`»size
(
Ãw_size
);

508 
	}
}

522 
šlše
 * 
	$¡ršg_as_¬¿y
(
¡ršg
* 
¡r
) {

523  
¡r
->
	`em±y
(è? 
NULL
 : &*¡r->
	`begš
();

524 
	}
}

	@robot/utils/snappy/snappy-stubs-public.h

36 #iâdeà
THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_STUBS_PUBLIC_H_


37 
	#THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_STUBS_PUBLIC_H_


	)

40 
	~<¡dšt.h
>

44 
	~<¡ddef.h
>

48 
	~<sys/uio.h
>

51 
	#SNAPPY_MAJOR
 1

	)

52 
	#SNAPPY_MINOR
 1

	)

53 
	#SNAPPY_PATCHLEVEL
 3

	)

54 
	#SNAPPY_VERSION
 \

55 ((
SNAPPY_MAJOR
 << 16è| (
SNAPPY_MINOR
 << 8è| 
SNAPPY_PATCHLEVEL
)

	)

57 
	~<¡ršg
>

59 
Çme¥aû
 
	g¢­py
 {

62 
št8_t
 
	tšt8
;

63 
ušt8_t
 
	tušt8
;

64 
št16_t
 
	tšt16
;

65 
ušt16_t
 
	tušt16
;

66 
št32_t
 
	tšt32
;

67 
ušt32_t
 
	tušt32
;

68 
št64_t
 
	tšt64
;

69 
ušt64_t
 
	tušt64
;

71 sigÃd 
	tšt8
;

72 
	tušt8
;

73 
	tšt16
;

74 
	tušt16
;

75 
	tšt32
;

76 
	tušt32
;

77 
	tšt64
;

78 
	tušt64
;

81 
	g¡d
::
	t¡ršg
 string;

83 
	#DISALLOW_COPY_AND_ASSIGN
(
Ty³Name
) \

84 
	`Ty³Name
(cÚ¡ 
Ty³Name
&); \

85 
İ”©Ü
=(cÚ¡ 
Ty³Name
&)

	)

90 
	siovec
 {

91 * 
	giov_ba£
;

92 
size_t
 
	giov_Ën
;

	@robot/utils/snappy/snappy.cc

29 
	~"¢­py.h
"

30 
	~"¢­py-š‹º®.h
"

31 
	~"¢­py-sšksourû.h
"

33 
	~<¡dio.h
>

35 
	~<®gÜ™hm
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

40 
Çme¥aû
 
	g¢­py
 {

42 
usšg
 
	gš‹º®
::
COPY_1_BYTE_OFFSET
;

43 
usšg
 
	gš‹º®
::
COPY_2_BYTE_OFFSET
;

44 
usšg
 
	gš‹º®
::
COPY_4_BYTE_OFFSET
;

45 
usšg
 
	gš‹º®
::
LITERAL
;

46 
usšg
 
	gš‹º®
::
ch¬_bË
;

47 
usšg
 
	gš‹º®
::
kMaximumTagL’gth
;

48 
usšg
 
	gš‹º®
::
wÜdmask
;

55 
šlše
 
ušt32
 
HashBy‹s
(ušt32 
by‹s
, 
shiá
) {

56 
ušt32
 
	gkMul
 = 0x1e35a7bd;

57  (
by‹s
 * 
	gkMul
è>> 
	gshiá
;

59 
šlše
 
ušt32
 
Hash
(cÚ¡ * 
p
, 
shiá
) {

60  
HashBy‹s
(
UNALIGNED_LOAD32
(
p
), 
shiá
);

63 
size_t
 
MaxCom´es£dL’gth
(size_ˆ
sourû_Ën
) {

84  32 + 
	gsourû_Ën
 + source_len/6;

98 
šlše
 
Inüem’lCİy
(cÚ¡ * 
¤c
, * 
İ
, 
ssize_t
 
Ën
) {

99 
as£¹
(
Ën
 > 0);

101 *
	gİ
++ = *
¤c
++;

102 } --
	gËn
 > 0);

136 
	gÇme¥aû
 {

138 cÚ¡ 
	gkMaxInüem’tCİyOv”æow
 = 10;

140 
šlše
 
Inüem’lCİyFa¡P©h
(cÚ¡ * 
¤c
, * 
İ
, 
ssize_t
 
Ën
) {

141 
PREDICT_FALSE
(
İ
 - 
¤c
 < 8)) {

142 
UÇligÃdCİy64
(
¤c
, 
İ
);

143 
	gËn
 -ğ
İ
 - 
¤c
;

144 
	gİ
 +ğ
İ
 - 
¤c
;

146 
	gËn
 > 0) {

147 
UÇligÃdCİy64
(
¤c
, 
İ
);

148 
	g¤c
 += 8;

149 
	gİ
 += 8;

150 
	gËn
 -= 8;

156 
šlše
 * 
Em™L™”®
(* 
İ
,

157 cÚ¡ * 
l™”®
,

158 
Ën
,

159 
boŞ
 
®low_ç¡_·th
) {

160 
	gn
 = 
Ën
 - 1;

161 ià(
	gn
 < 60) {

163 *
	gİ
++ = 
LITERAL
 | (
n
 << 2);

175 ià(
	g®low_ç¡_·th
 && 
	gËn
 <= 16) {

176 
UÇligÃdCİy64
(
l™”®
, 
İ
);

177 
UÇligÃdCİy64
(
l™”®
 + 8, 
İ
 + 8);

178  
	gİ
 + 
	gËn
;

182 * 
	gba£
 = 
İ
;

183 
	gcouÁ
 = 0;

184 
	gİ
++;

185 
	gn
 > 0) {

186 *
	gİ
++ = 
n
 & 0xff;

187 
	gn
 >>= 8;

188 
	gcouÁ
++;

190 
as£¹
(
couÁ
 >= 1);

191 
as£¹
(
couÁ
 <= 4);

192 *
	gba£
 = 
LITERAL
 | ((59+
couÁ
) << 2);

194 
memıy
(
İ
, 
l™”®
, 
Ën
);

195  
	gİ
 + 
	gËn
;

198 
šlše
 * 
Em™CİyLessThª64
(* 
İ
, 
size_t
 
off£t
, 
Ën
) {

199 
as£¹
(
Ën
 <= 64);

200 
as£¹
(
Ën
 >= 4);

201 
as£¹
(
off£t
 < 65536);

203 ià((
	gËn
 < 12è&& (
	goff£t
 < 2048)) {

204 
size_t
 
	gËn_mšus_4
 = 
Ën
 - 4;

205 
as£¹
(
Ën_mšus_4
 < 8);

206 *
	gİ
++ = 
COPY_1_BYTE_OFFSET
 + ((
Ën_mšus_4
è<< 2è+ ((
off£t
 >> 8) << 5);

207 *
	gİ
++ = 
off£t
 & 0xff;

209 *
	gİ
++ = 
COPY_2_BYTE_OFFSET
 + ((
Ën
-1) << 2);

210 
	gL™eEndŸn
::
StÜe16
(
İ
, 
off£t
);

211 
	gİ
 += 2;

213  
	gİ
;

216 
šlše
 * 
Em™Cİy
(* 
İ
, 
size_t
 
off£t
, 
Ën
) {

218 
PREDICT_FALSE
(
Ën
 >= 68)) {

219 
İ
 = 
Em™CİyLessThª64
(İ, 
off£t
, 64);

220 
	gËn
 -= 64;

224 ià(
	gËn
 > 64) {

225 
	gİ
 = 
Em™CİyLessThª64
(
İ
, 
off£t
, 60);

226 
	gËn
 -= 60;

230 
	gİ
 = 
Em™CİyLessThª64
(
İ
, 
off£t
, 
Ën
);

231  
	gİ
;

235 
boŞ
 
G‘Uncom´es£dL’gth
(cÚ¡ * 
¡¬t
, 
size_t
 
n
, size_t* 
»suÉ
) {

236 
ušt32
 
	gv
 = 0;

237 cÚ¡ * 
	glim™
 = 
¡¬t
 + 
n
;

238 ià(
	gV¬št
::
P¬£32W™hLim™
(
¡¬t
, 
lim™
, &
v
è!ğ
NULL
) {

239 *
»suÉ
 = 
v
;

240  
	gŒue
;

242  
	gçl£
;

246 
Çme¥aû
 
	gš‹º®
 {

247 
ušt16
* 
	gWÜkšgMemÜy
::
G‘HashTabË
(
size_t
 
šput_size
, * 
bË_size
) {

252 
as£¹
(
kMaxHashTabËSize
 >= 256);

253 
size_t
 
	ghtsize
 = 256;

254 
	ghtsize
 < 
	gkMaxHashTabËSize
 && htsiz< 
	gšput_size
) {

255 
	ghtsize
 <<= 1;

258 
ušt16
* 
	gbË
;

259 ià(
	ghtsize
 <ğ
ARRAYSIZE
(
sm®l_bË_
)) {

260 
bË
 = 
sm®l_bË_
;

262 ià(
	gÏrge_bË_
 =ğ
NULL
) {

263 
Ïrge_bË_
 = 
Ãw
 
ušt16
[
kMaxHashTabËSize
];

265 
	gbË
 = 
Ïrge_bË_
;

268 *
	gbË_size
 = 
htsize
;

269 
mem£t
(
bË
, 0, 
htsize
 * (*table));

270  
	gbË
;

287 #ifdeà
ARCH_K8


289 
ušt64
 
	tEightBy‹sReã»nû
;

291 
šlše
 
EightBy‹sReã»nû
 
G‘EightBy‹sAt
(cÚ¡ * 
±r
) {

292  
UNALIGNED_LOAD64
(
±r
);

295 
šlše
 
ušt32
 
G‘Ušt32AtOff£t
(
ušt64
 
v
, 
off£t
) {

296 
as£¹
(
off£t
 >= 0);

297 
as£¹
(
off£t
 <= 4);

298  
	gv
 >> (
	gL™eEndŸn
::
IsL™eEndŸn
(è? 8 * 
off£t
 : 32 - 8 * offset);

303 cÚ¡ * 
	tEightBy‹sReã»nû
;

305 
šlše
 
EightBy‹sReã»nû
 
G‘EightBy‹sAt
(cÚ¡ * 
±r
) {

306  
	g±r
;

309 
šlše
 
ušt32
 
G‘Ušt32AtOff£t
(cÚ¡ * 
v
, 
off£t
) {

310 
as£¹
(
off£t
 >= 0);

311 
as£¹
(
off£t
 <= 4);

312  
UNALIGNED_LOAD32
(
v
 + 
off£t
);

328 
Çme¥aû
 
	gš‹º®
 {

329 * 
Com´essF¿gm’t
(cÚ¡ * 
šput
,

330 
size_t
 
šput_size
,

331 * 
İ
,

332 
ušt16
* 
bË
,

333 cÚ¡ 
bË_size
) {

335 cÚ¡ * 
	g
 = 
šput
;

336 
as£¹
(
šput_size
 <ğ
kBlockSize
);

337 
as£¹
((
bË_size
 & (table_size - 1)) == 0);

338 cÚ¡ 
	gshiá
 = 32 - 
B™s
::
Log2FloÜ
(
bË_size
);

339 
as£¹
(
¡©ic_ÿ¡
<>(
kušt32max
 >> 
shiá
è=ğ
bË_size
 - 1);

340 cÚ¡ * 
	g_’d
 = 
šput
 + 
šput_size
;

341 cÚ¡ * 
	gba£_
 = 

;

344 cÚ¡ * 
	gÃxt_em™
 = 

;

346 cÚ¡ 
size_t
 
	gkIÅutM¬gšBy‹s
 = 15;

347 ià(
PREDICT_TRUE
(
šput_size
 >ğ
kIÅutM¬gšBy‹s
)) {

348 cÚ¡ * 
_lim™
 = 
šput
 + 
šput_size
 - 
kIÅutM¬gšBy‹s
;

350 
ušt32
 
	gÃxt_hash
 = 
Hash
(++

, 
shiá
); ; ) {

351 
as£¹
(
Ãxt_em™
 < 

);

377 
ušt32
 
	gsk
 = 32;

379 cÚ¡ * 
	gÃxt_
 = 

;

380 cÚ¡ * 
	gÿndid©e
;

382 
	g
 = 
Ãxt_
;

383 
ušt32
 
	ghash
 = 
Ãxt_hash
;

384 
as£¹
(
hash
 =ğ
Hash
(

, 
shiá
));

385 
ušt32
 
	gby‹s_b‘w“n_hash_lookups
 = 
sk
 >> 5;

386 
	gsk
 +ğ
by‹s_b‘w“n_hash_lookups
;

387 
	gÃxt_
 = 

 + 
by‹s_b‘w“n_hash_lookups
;

388 ià(
PREDICT_FALSE
(
Ãxt_
 > 
_lim™
)) {

389 
	gem™_»mašd”
;

391 
	gÃxt_hash
 = 
Hash
(
Ãxt_
, 
shiá
);

392 
	gÿndid©e
 = 
ba£_
 + 
bË
[
hash
];

393 
as£¹
(
ÿndid©e
 >ğ
ba£_
);

394 
as£¹
(
ÿndid©e
 < 

);

396 
	gbË
[
hash
] = 

 - 
ba£_
;

397 } 
PREDICT_TRUE
(
UNALIGNED_LOAD32
(

) !=

398 
UNALIGNED_LOAD32
(
ÿndid©e
)));

403 
as£¹
(
Ãxt_em™
 + 16 <ğ
_’d
);

404 
	gİ
 = 
Em™L™”®
(
İ
, 
Ãxt_em™
, 

 -‚ext_em™, 
Œue
);

414 
EightBy‹sReã»nû
 
	gšput_by‹s
;

415 
ušt32
 
	gÿndid©e_by‹s
 = 0;

420 cÚ¡ * 
	gba£
 = 

;

421 
	gm©ched
 = 4 + 
FšdM©chL’gth
(
ÿndid©e
 + 4, 

 + 4, 
_’d
);

422 
	g
 +ğ
m©ched
;

423 
size_t
 
	goff£t
 = 
ba£
 - 
ÿndid©e
;

424 
as£¹
(0 =ğ
memcmp
(
ba£
, 
ÿndid©e
, 
m©ched
));

425 
	gİ
 = 
Em™Cİy
(
İ
, 
off£t
, 
m©ched
);

428 cÚ¡ * 
	gš£¹_
 = 

 - 1;

429 
	gÃxt_em™
 = 

;

430 ià(
PREDICT_FALSE
(

 >ğ
_lim™
)) {

431 
em™_»mašd”
;

433 
	gšput_by‹s
 = 
G‘EightBy‹sAt
(
š£¹_
);

434 
ušt32
 
	g´ev_hash
 = 
HashBy‹s
(
G‘Ušt32AtOff£t
(
šput_by‹s
, 0), 
shiá
);

435 
	gbË
[
´ev_hash
] = 

 - 
ba£_
 - 1;

436 
ušt32
 
	gcur_hash
 = 
HashBy‹s
(
G‘Ušt32AtOff£t
(
šput_by‹s
, 1), 
shiá
);

437 
	gÿndid©e
 = 
ba£_
 + 
bË
[
cur_hash
];

438 
	gÿndid©e_by‹s
 = 
UNALIGNED_LOAD32
(
ÿndid©e
);

439 
	gbË
[
cur_hash
] = 

 - 
ba£_
;

440 } 
G‘Ušt32AtOff£t
(
šput_by‹s
, 1è=ğ
ÿndid©e_by‹s
);

442 
	gÃxt_hash
 = 
HashBy‹s
(
G‘Ušt32AtOff£t
(
šput_by‹s
, 2), 
shiá
);

443 ++
	g
;

447 
	gem™_»mašd”
:

449 ià(
Ãxt_em™
 < 
_’d
) {

450 
İ
 = 
Em™L™”®
(İ, 
Ãxt_em™
, 
_’d
 -‚ext_em™, 
çl£
);

453  
	gİ
;

499 şas 
	cSÇµyDecom´essÜ
 {

500 
	g´iv©e
:

501 
Sourû
* 
»ad”_
;

502 cÚ¡ * 
	g_
;

503 cÚ¡ * 
	g_lim™_
;

504 
ušt32
 
	g³eked_
;

505 
boŞ
 
	geof_
;

506 
	gsü©ch_
[
kMaximumTagL’gth
];

513 
boŞ
 
ReflTag
();

515 
	gpublic
:

516 
ex¶ic™
 
SÇµyDecom´essÜ
(
Sourû
* 
»ad”
)

517 : 
»ad”_
(
»ad”
),

518 
_
(
NULL
),

519 
_lim™_
(
NULL
),

520 
³eked_
(0),

521 
eof_
(
çl£
) {

524 ~
SÇµyDecom´essÜ
() {

526 
	g»ad”_
->
Sk
(
³eked_
);

530 
boŞ
 
eof
() const {

531  
	geof_
;

537 
boŞ
 
R—dUncom´es£dL’gth
(
ušt32
* 
»suÉ
) {

538 
as£¹
(
_
 =ğ
NULL
);

540 *
	g»suÉ
 = 0;

541 
ušt32
 
	gshiá
 = 0;

542 
	gŒue
) {

543 ià(
	gshiá
 >ğ32è 
çl£
;

544 
size_t
 
	gn
;

545 cÚ¡ * 
	g
 = 
»ad”_
->
P“k
(&
n
);

546 ià(
	gn
 =ğ0è 
çl£
;

547 cÚ¡ 
	gc
 = *(
»š‹½»t_ÿ¡
<cÚ¡ *>(

));

548 
	g»ad”_
->
Sk
(1);

549 
ušt32
 
	gv®
 = 
c
 & 0x7f;

550 ià(((
	gv®
 << 
	gshiá
è>> shiáè!ğ
v®
è 
çl£
;

551 *
	g»suÉ
 |ğ
v®
 << 
shiá
;

552 ià(
	gc
 < 128) {

555 
	gshiá
 += 7;

557  
	gŒue
;

562 
	g‹m¶©e
 <
şass
 
	gWr™”
>

563 
Decom´essAÎTags
(
Wr™”
* 
wr™”
) {

564 cÚ¡ * 
	g
 = 
_
;

570 
	#MAYBE_REFILL
() \

571 ià(
_lim™_
 - 

 < 
kMaximumTagL’gth
) { \

572 
_
 = 

; \

573 ià(!
	`ReflTag
()) ; \

574 

 = 
_
; \

575 }

	)

577 
MAYBE_REFILL
();

579 cÚ¡ 
	gc
 = *(
»š‹½»t_ÿ¡
<cÚ¡ *>(

++));

581 ià((
	gc
 & 0x3è=ğ
LITERAL
) {

582 
size_t
 
l™”®_Ëngth
 = (
c
 >> 2) + 1u;

583 ià(
	gwr™”
->
TryFa¡Aµ’d
(

, 
_lim™_
 - ip, 
l™”®_Ëngth
)) {

584 
as£¹
(
l™”®_Ëngth
 < 61);

585 
	g
 +ğ
l™”®_Ëngth
;

591 ià(
PREDICT_FALSE
(
l™”®_Ëngth
 >= 61)) {

593 cÚ¡ 
size_t
 
l™”®_Ëngth_Ëngth
 = 
l™”®_Ëngth
 - 60;

594 
	gl™”®_Ëngth
 =

595 (
L™eEndŸn
::
Lßd32
(

è& 
wÜdmask
[
l™”®_Ëngth_Ëngth
]) + 1;

596 
	g
 +ğ
l™”®_Ëngth_Ëngth
;

599 
size_t
 
	gava
 = 
_lim™_
 - 

;

600 
	gava
 < 
	gl™”®_Ëngth
) {

601 ià(!
	gwr™”
->
Aµ’d
(

, 
ava
)) ;

602 
	gl™”®_Ëngth
 -ğ
ava
;

603 
	g»ad”_
->
Sk
(
³eked_
);

604 
size_t
 
	gn
;

605 
	g
 = 
»ad”_
->
P“k
(&
n
);

606 
	gava
 = 
n
;

607 
	g³eked_
 = 
ava
;

608 ià(
	gava
 == 0) ;

609 
	g_lim™_
 = 

 + 
ava
;

611 ià(!
	gwr™”
->
Aµ’d
(

, 
l™”®_Ëngth
)) {

614 
	g
 +ğ
l™”®_Ëngth
;

615 
MAYBE_REFILL
();

617 cÚ¡ 
ušt32
 
	g’Œy
 = 
ch¬_bË
[
c
];

618 cÚ¡ 
ušt32
 
	gŒa”
 = 
L™eEndŸn
::
Lßd32
(

è& 
wÜdmask
[
’Œy
 >> 11];

619 cÚ¡ 
ušt32
 
	gËngth
 = 
’Œy
 & 0xff;

620 
	g
 +ğ
’Œy
 >> 11;

625 cÚ¡ 
ušt32
 
	gcİy_off£t
 = 
’Œy
 & 0x700;

626 ià(!
	gwr™”
->
Aµ’dFromS–f
(
cİy_off£t
 + 
Œa”
, 
Ëngth
)) {

629 
MAYBE_REFILL
();

633 #undeà
MAYBE_REFILL


637 
boŞ
 
	gSÇµyDecom´essÜ
::
	$ReflTag
() {

638 cÚ¡ * 

 = 
_
;

639 ià(

 =ğ
_lim™_
) {

641 
»ad”_
->
	`Sk
(
³eked_
);

642 
size_t
 
n
;

643 

 = 
»ad”_
->
	`P“k
(&
n
);

644 
³eked_
 = 
n
;

645 ià(
n
 == 0) {

646 
eof_
 = 
Œue
;

647  
çl£
;

649 
_lim™_
 = 

 + 
n
;

653 
	`as£¹
(

 < 
_lim™_
);

654 cÚ¡ 
c
 = *(
»š‹½»t_ÿ¡
<cÚ¡ *>(

));

655 cÚ¡ 
ušt32
 
’Œy
 = 
ch¬_bË
[
c
];

656 cÚ¡ 
ušt32
 
Ãeded
 = (
’Œy
 >> 11) + 1;

657 
	`as£¹
(
Ãeded
 <ğ(
sü©ch_
));

660 
ušt32
 
nbuf
 = 
_lim™_
 - 

;

661 ià(
nbuf
 < 
Ãeded
) {

666 
	`memmove
(
sü©ch_
, 

, 
nbuf
);

667 
»ad”_
->
	`Sk
(
³eked_
);

668 
³eked_
 = 0;

669 
nbuf
 < 
Ãeded
) {

670 
size_t
 
Ëngth
;

671 cÚ¡ * 
¤c
 = 
»ad”_
->
	`P“k
(&
Ëngth
);

672 ià(
Ëngth
 =ğ0è 
çl£
;

673 
ušt32
 
to_add
 = 
mš
<ušt32>(
Ãeded
 - 
nbuf
, 
Ëngth
);

674 
	`memıy
(
sü©ch_
 + 
nbuf
, 
¤c
, 
to_add
);

675 
nbuf
 +ğ
to_add
;

676 
»ad”_
->
	`Sk
(
to_add
);

678 
	`as£¹
(
nbuf
 =ğ
Ãeded
);

679 
_
 = 
sü©ch_
;

680 
_lim™_
 = 
sü©ch_
 + 
Ãeded
;

681 } ià(
nbuf
 < (
ušt32
)
kMaximumTagL’gth
) {

684 
	`memmove
(
sü©ch_
, 

, 
nbuf
);

685 
»ad”_
->
	`Sk
(
³eked_
);

686 
³eked_
 = 0;

687 
_
 = 
sü©ch_
;

688 
_lim™_
 = 
sü©ch_
 + 
nbuf
;

691 
_
 = 

;

693  
Œue
;

694 
	}
}

696 
	g‹m¶©e
 <
ty³Çme
 
	gWr™”
>

697 
boŞ
 
	$IÁ”ÇlUncom´ess
(
Sourû
* 
r
, 
Wr™”
* 
wr™”
) {

699 
SÇµyDecom´essÜ
 
	`decom´essÜ
(
r
);

700 
ušt32
 
uncom´es£d_Ën
 = 0;

701 ià(!
decom´essÜ
.
	`R—dUncom´es£dL’gth
(&
uncom´es£d_Ën
)è 
çl£
;

702  
	`IÁ”ÇlUncom´essAÎTags
(&
decom´essÜ
, 
wr™”
, 
uncom´es£d_Ën
);

703 
	}
}

705 
	g‹m¶©e
 <
ty³Çme
 
	gWr™”
>

706 
boŞ
 
	$IÁ”ÇlUncom´essAÎTags
(
SÇµyDecom´essÜ
* 
decom´essÜ
,

707 
Wr™”
* 
wr™”
,

708 
ušt32
 
uncom´es£d_Ën
) {

709 
wr™”
->
	`S‘Ex³ùedL’gth
(
uncom´es£d_Ën
);

712 
decom´essÜ
->
	`Decom´essAÎTags
(
wr™”
);

713 
wr™”
->
	`Flush
();

714  (
decom´essÜ
->
	`eof
(è&& 
wr™”
->
	`CheckL’gth
());

715 
	}
}

717 
boŞ
 
	$G‘Uncom´es£dL’gth
(
Sourû
* 
sourû
, 
ušt32
* 
»suÉ
) {

718 
SÇµyDecom´essÜ
 
	`decom´essÜ
(
sourû
);

719  
decom´essÜ
.
	`R—dUncom´es£dL’gth
(
»suÉ
);

720 
	}
}

722 
size_t
 
	$Com´ess
(
Sourû
* 
»ad”
, 
Sšk
* 
wr™”
) {

723 
size_t
 
wr™‹n
 = 0;

724 
size_t
 
N
 = 
»ad”
->
	`AvaabË
();

725 
uËngth
[
V¬št
::
kMax32
];

726 * 
p
 = 
V¬št
::
	`Encode32
(
uËngth
, 
N
);

727 
wr™”
->
	`Aµ’d
(
uËngth
, 
p
-ulength);

728 
wr™‹n
 +ğ(
p
 - 
uËngth
);

730 
š‹º®
::
WÜkšgMemÜy
 
wmem
;

731 * 
sü©ch
 = 
NULL
;

732 * 
sü©ch_ouut
 = 
NULL
;

734 
N
 > 0) {

736 
size_t
 
äagm’t_size
;

737 cÚ¡ * 
äagm’t
 = 
»ad”
->
	`P“k
(&
äagm’t_size
);

738 
	`as£¹
(
äagm’t_size
 != 0);

739 cÚ¡ 
size_t
 
num_to_»ad
 = 
	`mš
(
N
, 
kBlockSize
);

740 
size_t
 
by‹s_»ad
 = 
äagm’t_size
;

742 
size_t
 
³ndšg_advªû
 = 0;

743 ià(
by‹s_»ad
 >ğ
num_to_»ad
) {

745 
³ndšg_advªû
 = 
num_to_»ad
;

746 
äagm’t_size
 = 
num_to_»ad
;

749 ià(
sü©ch
 =ğ
NULL
) {

753 
sü©ch
 = 
Ãw
 [
num_to_»ad
];

755 
	`memıy
(
sü©ch
, 
äagm’t
, 
by‹s_»ad
);

756 
»ad”
->
	`Sk
(
by‹s_»ad
);

758 
by‹s_»ad
 < 
num_to_»ad
) {

759 
äagm’t
 = 
»ad”
->
	`P“k
(&
äagm’t_size
);

760 
size_t
 
n
 = 
mš
<size_t>(
äagm’t_size
, 
num_to_»ad
 - 
by‹s_»ad
);

761 
	`memıy
(
sü©ch
 + 
by‹s_»ad
, 
äagm’t
, 
n
);

762 
by‹s_»ad
 +ğ
n
;

763 
»ad”
->
	`Sk
(
n
);

765 
	`as£¹
(
by‹s_»ad
 =ğ
num_to_»ad
);

766 
äagm’t
 = 
sü©ch
;

767 
äagm’t_size
 = 
num_to_»ad
;

769 
	`as£¹
(
äagm’t_size
 =ğ
num_to_»ad
);

772 
bË_size
;

773 
ušt16
* 
bË
 = 
wmem
.
	`G‘HashTabË
(
num_to_»ad
, &
bË_size
);

776 cÚ¡ 
max_ouut
 = 
	`MaxCom´es£dL’gth
(
num_to_»ad
);

780 ià(
sü©ch_ouut
 =ğ
NULL
) {

781 
sü©ch_ouut
 = 
Ãw
 [
max_ouut
];

787 * 
de¡
 = 
wr™”
->
	`G‘Aµ’dBufãr
(
max_ouut
, 
sü©ch_ouut
);

788 * 
’d
 = 
š‹º®
::
	`Com´essF¿gm’t
(
äagm’t
, 
äagm’t_size
,

789 
de¡
, 
bË
, 
bË_size
);

790 
wr™”
->
	`Aµ’d
(
de¡
, 
’d
 - dest);

791 
wr™‹n
 +ğ(
’d
 - 
de¡
);

793 
N
 -ğ
num_to_»ad
;

794 
»ad”
->
	`Sk
(
³ndšg_advªû
);

797 
d–‘e
[] 
sü©ch
;

798 
d–‘e
[] 
sü©ch_ouut
;

800  
wr™‹n
;

801 
	}
}

810 şas 
	cSÇµyIOVecWr™”
 {

811 
	g´iv©e
:

812 cÚ¡ 
iovec
* 
ouut_iov_
;

813 cÚ¡ 
size_t
 
	gouut_iov_couÁ_
;

816 
size_t
 
	gcu¼_iov_šdex_
;

819 
size_t
 
	gcu¼_iov_wr™‹n_
;

822 
size_t
 
	gtÙ®_wr™‹n_
;

825 
size_t
 
	gouut_lim™_
;

827 
šlše
 * 
G‘IOVecPoš‹r
(
size_t
 
šdex
, size_ˆ
off£t
) {

828  
	g»š‹½»t_ÿ¡
<*>(
	gouut_iov_
[
šdex
].
	giov_ba£
) +

829 
	goff£t
;

832 
	gpublic
:

835 
šlše
 
SÇµyIOVecWr™”
(cÚ¡ 
iovec
* 
iov
, 
size_t
 
iov_couÁ
)

836 : 
ouut_iov_
(
iov
),

837 
ouut_iov_couÁ_
(
iov_couÁ
),

838 
cu¼_iov_šdex_
(0),

839 
cu¼_iov_wr™‹n_
(0),

840 
tÙ®_wr™‹n_
(0),

841 
ouut_lim™_
(-1) {

844 
šlše
 
S‘Ex³ùedL’gth
(
size_t
 
Ën
) {

845 
	gouut_lim™_
 = 
Ën
;

848 
šlše
 
boŞ
 
CheckL’gth
() const {

849  
	gtÙ®_wr™‹n_
 =ğ
ouut_lim™_
;

852 
šlše
 
boŞ
 
Aµ’d
(cÚ¡ * 

, 
size_t
 
Ën
) {

853 ià(
	gtÙ®_wr™‹n_
 + 
	gËn
 > 
	gouut_lim™_
) {

854  
	gçl£
;

857 
	gËn
 > 0) {

858 
as£¹
(
cu¼_iov_wr™‹n_
 <ğ
ouut_iov_
[
cu¼_iov_šdex_
].
iov_Ën
);

859 ià(
	gcu¼_iov_wr™‹n_
 >ğ
ouut_iov_
[
cu¼_iov_šdex_
].
iov_Ën
) {

861 ià(
cu¼_iov_šdex_
 + 1 >ğ
ouut_iov_couÁ_
) {

862  
çl£
;

864 
	gcu¼_iov_wr™‹n_
 = 0;

865 ++
	gcu¼_iov_šdex_
;

868 cÚ¡ 
size_t
 
	gto_wr™e
 = 
¡d
::
mš
(

869 
Ën
, 
ouut_iov_
[
cu¼_iov_šdex_
].
iov_Ën
 - 
cu¼_iov_wr™‹n_
);

870 
memıy
(
G‘IOVecPoš‹r
(
cu¼_iov_šdex_
, 
cu¼_iov_wr™‹n_
),

871 

,

872 
to_wr™e
);

873 
	gcu¼_iov_wr™‹n_
 +ğ
to_wr™e
;

874 
	gtÙ®_wr™‹n_
 +ğ
to_wr™e
;

875 
	g
 +ğ
to_wr™e
;

876 
	gËn
 -ğ
to_wr™e
;

879  
	gŒue
;

882 
šlše
 
boŞ
 
TryFa¡Aµ’d
(cÚ¡ * 

, 
size_t
 
avaabË
, size_ˆ
Ën
) {

883 cÚ¡ 
size_t
 
	g¥aû_Ëá
 = 
ouut_lim™_
 - 
tÙ®_wr™‹n_
;

884 ià(
	gËn
 <ğ16 && 
avaabË
 >ğ16 + 
kMaximumTagL’gth
 && 
¥aû_Ëá
 >= 16 &&

885 
ouut_iov_
[
cu¼_iov_šdex_
].
iov_Ën
 - 
cu¼_iov_wr™‹n_
 >= 16) {

887 * 
±r
 = 
G‘IOVecPoš‹r
(
cu¼_iov_šdex_
, 
cu¼_iov_wr™‹n_
);

888 
UÇligÃdCİy64
(

, 
±r
);

889 
UÇligÃdCİy64
(

 + 8, 
±r
 + 8);

890 
	gcu¼_iov_wr™‹n_
 +ğ
Ën
;

891 
	gtÙ®_wr™‹n_
 +ğ
Ën
;

892  
	gŒue
;

895  
	gçl£
;

898 
šlše
 
boŞ
 
Aµ’dFromS–f
(
size_t
 
off£t
, size_ˆ
Ën
) {

899 ià(
	goff£t
 > 
	gtÙ®_wr™‹n_
 || offset == 0) {

900  
çl£
;

902 cÚ¡ 
size_t
 
	g¥aû_Ëá
 = 
ouut_lim™_
 - 
tÙ®_wr™‹n_
;

903 ià(
	gËn
 > 
	g¥aû_Ëá
) {

904  
	gçl£
;

908 
size_t
 
	gäom_iov_šdex
 = 
cu¼_iov_šdex_
;

909 
size_t
 
	gäom_iov_off£t
 = 
cu¼_iov_wr™‹n_
;

910 
	goff£t
 > 0) {

911 ià(
	gäom_iov_off£t
 >ğ
off£t
) {

912 
äom_iov_off£t
 -ğ
off£t
;

916 
	goff£t
 -ğ
äom_iov_off£t
;

917 
as£¹
(
äom_iov_šdex
 > 0);

918 --
	gäom_iov_šdex
;

919 
	gäom_iov_off£t
 = 
ouut_iov_
[
äom_iov_šdex
].
iov_Ën
;

924 
	gËn
 > 0) {

925 
as£¹
(
äom_iov_šdex
 <ğ
cu¼_iov_šdex_
);

926 ià(
	gäom_iov_šdex
 !ğ
cu¼_iov_šdex_
) {

927 cÚ¡ 
size_t
 
to_cİy
 = 
¡d
::
mš
(

928 
ouut_iov_
[
äom_iov_šdex
].
iov_Ën
 - 
äom_iov_off£t
,

929 
Ën
);

930 
Aµ’d
(
G‘IOVecPoš‹r
(
äom_iov_šdex
, 
äom_iov_off£t
), 
to_cİy
);

931 
	gËn
 -ğ
to_cİy
;

932 ià(
	gËn
 > 0) {

933 ++
	gäom_iov_šdex
;

934 
	gäom_iov_off£t
 = 0;

937 
as£¹
(
cu¼_iov_wr™‹n_
 <ğ
ouut_iov_
[
cu¼_iov_šdex_
].
iov_Ën
);

938 
size_t
 
	gto_cİy
 = 
¡d
::
mš
(
ouut_iov_
[
cu¼_iov_šdex_
].
iov_Ën
 -

939 
cu¼_iov_wr™‹n_
,

940 
Ën
);

941 ià(
	gto_cİy
 == 0) {

943 ià(
cu¼_iov_šdex_
 + 1 >ğ
ouut_iov_couÁ_
) {

944  
çl£
;

946 ++
	gcu¼_iov_šdex_
;

947 
	gcu¼_iov_wr™‹n_
 = 0;

950 ià(
	gto_cİy
 > 
	gËn
) {

951 
	gto_cİy
 = 
Ën
;

953 
Inüem’lCİy
(
G‘IOVecPoš‹r
(
äom_iov_šdex
, 
äom_iov_off£t
),

954 
G‘IOVecPoš‹r
(
cu¼_iov_šdex_
, 
cu¼_iov_wr™‹n_
),

955 
to_cİy
);

956 
	gcu¼_iov_wr™‹n_
 +ğ
to_cİy
;

957 
	gäom_iov_off£t
 +ğ
to_cİy
;

958 
	gtÙ®_wr™‹n_
 +ğ
to_cİy
;

959 
	gËn
 -ğ
to_cİy
;

963  
	gŒue
;

966 
šlše
 
Flush
() {}

969 
boŞ
 
	$RawUncom´essToIOVec
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

970 cÚ¡ 
iovec
* 
iov
, 
size_t
 
iov_út
) {

971 
By‹A¼aySourû
 
	`»ad”
(
com´es£d
, 
com´es£d_Ëngth
);

972  
	`RawUncom´essToIOVec
(&
»ad”
, 
iov
, 
iov_út
);

973 
	}
}

975 
boŞ
 
	$RawUncom´essToIOVec
(
Sourû
* 
com´es£d
, cÚ¡ 
iovec
* 
iov
,

976 
size_t
 
iov_út
) {

977 
SÇµyIOVecWr™”
 
	`ouut
(
iov
, 
iov_út
);

978  
	`IÁ”ÇlUncom´ess
(
com´es£d
, &
ouut
);

979 
	}
}

988 şas 
	cSÇµyA¼ayWr™”
 {

989 
	g´iv©e
:

990 * 
ba£_
;

991 * 
	gİ_
;

992 * 
	gİ_lim™_
;

994 
	gpublic
:

995 
šlše
 
ex¶ic™
 
SÇµyA¼ayWr™”
(* 
d¡
)

996 : 
ba£_
(
d¡
),

997 
İ_
(
d¡
),

998 
İ_lim™_
(
d¡
) {

1001 
šlše
 
S‘Ex³ùedL’gth
(
size_t
 
Ën
) {

1002 
	gİ_lim™_
 = 
İ_
 + 
Ën
;

1005 
šlše
 
boŞ
 
CheckL’gth
() const {

1006  
	gİ_
 =ğ
İ_lim™_
;

1009 
šlše
 
boŞ
 
Aµ’d
(cÚ¡ * 

, 
size_t
 
Ën
) {

1010 * 
	gİ
 = 
İ_
;

1011 cÚ¡ 
size_t
 
	g¥aû_Ëá
 = 
İ_lim™_
 - 
İ
;

1012 ià(
	g¥aû_Ëá
 < 
	gËn
) {

1013  
	gçl£
;

1015 
memıy
(
İ
, 

, 
Ën
);

1016 
	gİ_
 = 
İ
 + 
Ën
;

1017  
	gŒue
;

1020 
šlše
 
boŞ
 
TryFa¡Aµ’d
(cÚ¡ * 

, 
size_t
 
avaabË
, size_ˆ
Ën
) {

1021 * 
	gİ
 = 
İ_
;

1022 cÚ¡ 
size_t
 
	g¥aû_Ëá
 = 
İ_lim™_
 - 
İ
;

1023 ià(
	gËn
 <ğ16 && 
avaabË
 >ğ16 + 
kMaximumTagL’gth
 && 
¥aû_Ëá
 >= 16) {

1025 
UÇligÃdCİy64
(

, 
İ
);

1026 
UÇligÃdCİy64
(

 + 8, 
İ
 + 8);

1027 
	gİ_
 = 
İ
 + 
Ën
;

1028  
	gŒue
;

1030  
	gçl£
;

1034 
šlše
 
boŞ
 
Aµ’dFromS–f
(
size_t
 
off£t
, size_ˆ
Ën
) {

1035 * 
	gİ
 = 
İ_
;

1036 cÚ¡ 
size_t
 
	g¥aû_Ëá
 = 
İ_lim™_
 - 
İ
;

1045 
as£¹
(
İ
 >ğ
ba£_
);

1046 
size_t
 
	g´oduûd
 = 
İ
 - 
ba£_
;

1047 ià(
	g´oduûd
 <ğ
off£t
 - 1u) {

1048  
çl£
;

1050 ià(
	gËn
 <ğ16 && 
off£t
 >ğ8 && 
¥aû_Ëá
 >= 16) {

1052 
UÇligÃdCİy64
(
İ
 - 
off£t
, op);

1053 
UÇligÃdCİy64
(
İ
 - 
off£t
 + 8, op + 8);

1055 ià(
	g¥aû_Ëá
 >ğ
Ën
 + 
kMaxInüem’tCİyOv”æow
) {

1056 
Inüem’lCİyFa¡P©h
(
İ
 - 
off£t
, op, 
Ën
);

1058 ià(
	g¥aû_Ëá
 < 
	gËn
) {

1059  
	gçl£
;

1061 
Inüem’lCİy
(
İ
 - 
off£t
, op, 
Ën
);

1065 
	gİ_
 = 
İ
 + 
Ën
;

1066  
	gŒue
;

1068 
šlše
 
size_t
 
Produûd
() const {

1069  
	gİ_
 - 
	gba£_
;

1071 
šlše
 
Flush
() {}

1074 
boŞ
 
	$RawUncom´ess
(cÚ¡ * 
com´es£d
, 
size_t
 
n
, * 
uncom´es£d
) {

1075 
By‹A¼aySourû
 
	`»ad”
(
com´es£d
, 
n
);

1076  
	`RawUncom´ess
(&
»ad”
, 
uncom´es£d
);

1077 
	}
}

1079 
boŞ
 
	$RawUncom´ess
(
Sourû
* 
com´es£d
, * 
uncom´es£d
) {

1080 
SÇµyA¼ayWr™”
 
	`ouut
(
uncom´es£d
);

1081  
	`IÁ”ÇlUncom´ess
(
com´es£d
, &
ouut
);

1082 
	}
}

1084 
boŞ
 
	$Uncom´ess
(cÚ¡ * 
com´es£d
, 
size_t
 
n
, 
¡ršg
* 
uncom´es£d
) {

1085 
size_t
 
uËngth
;

1086 ià(!
	`G‘Uncom´es£dL’gth
(
com´es£d
, 
n
, &
uËngth
)) {

1087  
çl£
;

1091 ià(
uËngth
 > 
uncom´es£d
->
	`max_size
()) {

1092  
çl£
;

1094 
	`STLSŒšgResizeUnš™Ÿlized
(
uncom´es£d
, 
uËngth
);

1095  
	`RawUncom´ess
(
com´es£d
, 
n
, 
	`¡ršg_as_¬¿y
(
uncom´es£d
));

1096 
	}
}

1099 şas 
	cSÇµyDecom´essiÚV®id©Ü
 {

1100 
	g´iv©e
:

1101 
size_t
 
ex³ùed_
;

1102 
size_t
 
	g´oduûd_
;

1104 
	gpublic
:

1105 
šlše
 
SÇµyDecom´essiÚV®id©Ü
(è: 
ex³ùed_
(0), 
´oduûd_
(0) { }

1106 
šlše
 
S‘Ex³ùedL’gth
(
size_t
 
Ën
) {

1107 
	gex³ùed_
 = 
Ën
;

1109 
šlše
 
boŞ
 
CheckL’gth
() const {

1110  
	gex³ùed_
 =ğ
´oduûd_
;

1112 
šlše
 
boŞ
 
Aµ’d
(cÚ¡ * 

, 
size_t
 
Ën
) {

1113 
	g´oduûd_
 +ğ
Ën
;

1114  
	g´oduûd_
 <ğ
ex³ùed_
;

1116 
šlše
 
boŞ
 
TryFa¡Aµ’d
(cÚ¡ * 

, 
size_t
 
avaabË
, size_ˆ
Ëngth
) {

1117  
	gçl£
;

1119 
šlše
 
boŞ
 
Aµ’dFromS–f
(
size_t
 
off£t
, size_ˆ
Ën
) {

1122 ià(
	g´oduûd_
 <ğ
off£t
 - 1uè 
çl£
;

1123 
	g´oduûd_
 +ğ
Ën
;

1124  
	g´oduûd_
 <ğ
ex³ùed_
;

1126 
šlše
 
Flush
() {}

1129 
boŞ
 
	$IsV®idCom´es£dBufãr
(cÚ¡ * 
com´es£d
, 
size_t
 
n
) {

1130 
By‹A¼aySourû
 
	`»ad”
(
com´es£d
, 
n
);

1131 
SÇµyDecom´essiÚV®id©Ü
 
wr™”
;

1132  
	`IÁ”ÇlUncom´ess
(&
»ad”
, &
wr™”
);

1133 
	}
}

1135 
boŞ
 
	$IsV®idCom´es£d
(
Sourû
* 
com´es£d
) {

1136 
SÇµyDecom´essiÚV®id©Ü
 
wr™”
;

1137  
	`IÁ”ÇlUncom´ess
(
com´es£d
, &
wr™”
);

1138 
	}
}

1140 
	$RawCom´ess
(cÚ¡ * 
šput
,

1141 
size_t
 
šput_Ëngth
,

1142 * 
com´es£d
,

1143 
size_t
* 
com´es£d_Ëngth
) {

1144 
By‹A¼aySourû
 
	`»ad”
(
šput
, 
šput_Ëngth
);

1145 
UncheckedBy‹A¼aySšk
 
	`wr™”
(
com´es£d
);

1146 
	`Com´ess
(&
»ad”
, &
wr™”
);

1149 *
com´es£d_Ëngth
 = (
wr™”
.
	`Cu¼’tDe¡š©iÚ
(è- 
com´es£d
);

1150 
	}
}

1152 
size_t
 
	$Com´ess
(cÚ¡ * 
šput
, 
size_t
 
šput_Ëngth
, 
¡ršg
* 
com´es£d
) {

1154 
com´es£d
->
	`»size
(
	`MaxCom´es£dL’gth
(
šput_Ëngth
));

1156 
size_t
 
com´es£d_Ëngth
;

1157 
	`RawCom´ess
(
šput
, 
šput_Ëngth
, 
	`¡ršg_as_¬¿y
(
com´es£d
),

1158 &
com´es£d_Ëngth
);

1159 
com´es£d
->
	`»size
(
com´es£d_Ëngth
);

1160  
com´es£d_Ëngth
;

1161 
	}
}

1170 
	g‹m¶©e
 <
ty³Çme
 
	gAÎoÿtÜ
>

1171 şas 
	cSÇµySÿ‰”edWr™”
 {

1172 
AÎoÿtÜ
 
	g®loÿtÜ_
;

1177 
	gveùÜ
<*> 
	gblocks_
;

1178 
size_t
 
	gex³ùed_
;

1181 
size_t
 
	gfuÎ_size_
;

1184 * 
	gİ_ba£_
;

1185 * 
	gİ_±r_
;

1186 * 
	gİ_lim™_
;

1188 
šlše
 
size_t
 
Size
() const {

1189  
	gfuÎ_size_
 + (
	gİ_±r_
 - 
	gİ_ba£_
);

1192 
boŞ
 
SlowAµ’d
(cÚ¡ * 

, 
size_t
 
Ën
);

1193 
boŞ
 
SlowAµ’dFromS–f
(
size_t
 
off£t
, size_ˆ
Ën
);

1195 
	gpublic
:

1196 
šlše
 
ex¶ic™
 
SÇµySÿ‰”edWr™”
(cÚ¡ 
AÎoÿtÜ
& 
®loÿtÜ
)

1197 : 
®loÿtÜ_
(
®loÿtÜ
),

1198 
fuÎ_size_
(0),

1199 
İ_ba£_
(
NULL
),

1200 
İ_±r_
(
NULL
),

1201 
İ_lim™_
(
NULL
) {

1204 
šlše
 
S‘Ex³ùedL’gth
(
size_t
 
Ën
) {

1205 
as£¹
(
blocks_
.
em±y
());

1206 
	gex³ùed_
 = 
Ën
;

1209 
šlše
 
boŞ
 
CheckL’gth
() const {

1210  
Size
(è=ğ
ex³ùed_
;

1214 
šlše
 
size_t
 
Produûd
() const {

1215  
Size
();

1218 
šlše
 
boŞ
 
Aµ’d
(cÚ¡ * 

, 
size_t
 
Ën
) {

1219 
size_t
 
	gava
 = 
İ_lim™_
 - 
İ_±r_
;

1220 ià(
	gËn
 <ğ
ava
) {

1222 
memıy
(
İ_±r_
, 

, 
Ën
);

1223 
	gİ_±r_
 +ğ
Ën
;

1224  
	gŒue
;

1226  
SlowAµ’d
(

, 
Ën
);

1230 
šlše
 
boŞ
 
TryFa¡Aµ’d
(cÚ¡ * 

, 
size_t
 
avaabË
, size_ˆ
Ëngth
) {

1231 * 
	gİ
 = 
İ_±r_
;

1232 cÚ¡ 
	g¥aû_Ëá
 = 
İ_lim™_
 - 
İ
;

1233 ià(
	gËngth
 <ğ16 && 
avaabË
 >ğ16 + 
kMaximumTagL’gth
 &&

1234 
¥aû_Ëá
 >= 16) {

1236 
UNALIGNED_STORE64
(
İ
, 
UNALIGNED_LOAD64
(

));

1237 
UNALIGNED_STORE64
(
İ
 + 8, 
UNALIGNED_LOAD64
(

 + 8));

1238 
	gİ_±r_
 = 
İ
 + 
Ëngth
;

1239  
	gŒue
;

1241  
	gçl£
;

1245 
šlše
 
boŞ
 
Aµ’dFromS–f
(
size_t
 
off£t
, size_ˆ
Ën
) {

1248 ià(()(
	goff£t
 - 1uè< ()(
	gİ_±r_
 - 
	gİ_ba£_
)) {

1249 cÚ¡ 
size_t
 
	g¥aû_Ëá
 = 
İ_lim™_
 - 
İ_±r_
;

1250 ià(
	g¥aû_Ëá
 >ğ
Ën
 + 
kMaxInüem’tCİyOv”æow
) {

1252 
Inüem’lCİyFa¡P©h
(
İ_±r_
 - 
off£t
, op_±r_, 
Ën
);

1253 
	gİ_±r_
 +ğ
Ën
;

1254  
	gŒue
;

1257  
SlowAµ’dFromS–f
(
off£t
, 
Ën
);

1262 
šlše
 
Flush
(è{ 
	g®loÿtÜ_
.Flush(
Produûd
()); }

1265 
	g‹m¶©e
<
ty³Çme
 
	gAÎoÿtÜ
>

1266 
boŞ
 
	gSÇµySÿ‰”edWr™”
<
	gAÎoÿtÜ
>::
	$SlowAµ’d
(cÚ¡ * 

, 
size_t
 
Ën
) {

1267 
size_t
 
ava
 = 
İ_lim™_
 - 
İ_±r_
;

1268 
Ën
 > 
ava
) {

1270 
	`memıy
(
İ_±r_
, 

, 
ava
);

1271 
İ_±r_
 +ğ
ava
;

1272 
	`as£¹
(
İ_lim™_
 - 
İ_±r_
 == 0);

1273 
fuÎ_size_
 +ğ(
İ_±r_
 - 
İ_ba£_
);

1274 
Ën
 -ğ
ava
;

1275 

 +ğ
ava
;

1278 ià(
fuÎ_size_
 + 
Ën
 > 
ex³ùed_
) {

1279  
çl£
;

1283 
size_t
 
bsize
 = 
mš
<size_t>(
kBlockSize
, 
ex³ùed_
 - 
fuÎ_size_
);

1284 
İ_ba£_
 = 
®loÿtÜ_
.
	`AÎoÿ‹
(
bsize
);

1285 
İ_±r_
 = 
İ_ba£_
;

1286 
İ_lim™_
 = 
İ_ba£_
 + 
bsize
;

1287 
blocks_
.
	`push_back
(
İ_ba£_
);

1288 
ava
 = 
bsize
;

1291 
	`memıy
(
İ_±r_
, 

, 
Ën
);

1292 
İ_±r_
 +ğ
Ën
;

1293  
Œue
;

1294 
	}
}

1296 
	g‹m¶©e
<
ty³Çme
 
	gAÎoÿtÜ
>

1297 
boŞ
 
	gSÇµySÿ‰”edWr™”
<
	gAÎoÿtÜ
>::
	$SlowAµ’dFromS–f
(
size_t
 
off£t
,

1298 
size_t
 
Ën
) {

1302 cÚ¡ 
size_t
 
cur
 = 
	`Size
();

1303 ià(
off£t
 - 1u >ğ
cur
è 
çl£
;

1304 ià(
ex³ùed_
 - 
cur
 < 
Ën
è 
çl£
;

1311 
size_t
 
¤c
 = 
cur
 - 
off£t
;

1312 
Ën
-- > 0) {

1313 
c
 = 
blocks_
[
¤c
 >> 
kBlockLog
][¤ø& (
kBlockSize
-1)];

1314 
	`Aµ’d
(&
c
, 1);

1315 
¤c
++;

1317  
Œue
;

1318 
	}
}

1320 şas 
	cSÇµySškAÎoÿtÜ
 {

1321 
	gpublic
:

1322 
ex¶ic™
 
SÇµySškAÎoÿtÜ
(
Sšk
* 
de¡
): 
de¡_
(dest) {}

1323 ~
SÇµySškAÎoÿtÜ
() {}

1325 * 
AÎoÿ‹
(
size
) {

1326 
D©ablock
 
block
(
Ãw
 [
size
], size);

1327 
	gblocks_
.
push_back
(
block
);

1328  
	gblock
.
	gd©a
;

1336 
Flush
(
size_t
 
size
) {

1337 
size_t
 
	gsize_wr™‹n
 = 0;

1338 
size_t
 
	gblock_size
;

1339 
	gi
 = 0; i < 
	gblocks_
.
size
(); ++i) {

1340 
	gblock_size
 = 
mš
<
size_t
>(
blocks_
[
i
].
size
, 
	gsize
 - 
	gsize_wr™‹n
);

1341 
	gde¡_
->
Aµ’dAndTakeOwÃrsh
(
blocks_
[
i
].
d©a
, 
block_size
,

1342 &
SÇµySškAÎoÿtÜ
::
D–‘”
, 
NULL
);

1343 
	gsize_wr™‹n
 +ğ
block_size
;

1345 
	gblocks_
.
ş—r
();

1348 
	g´iv©e
:

1349 
	sD©ablock
 {

1350 * 
d©a
;

1351 
size_t
 
	gsize
;

1352 
D©ablock
(* 
p
, 
size_t
 
s
è: 
d©a
Õ), 
size
(s) {}

1355 
D–‘”
(* 
¬g
, cÚ¡ * 
by‹s
, 
size_t
 
size
) {

1356 
	gd–‘e
[] 
	gby‹s
;

1359 
Sšk
* 
	gde¡_
;

1360 
	gveùÜ
<
	gD©ablock
> 
	gblocks_
;

1365 
size_t
 
	$Uncom´essAsMuchAsPossibË
(
Sourû
* 
com´es£d
, 
Sšk
* 
uncom´es£d
) {

1366 
SÇµySškAÎoÿtÜ
 
	`®loÿtÜ
(
uncom´es£d
);

1367 
SÇµySÿ‰”edWr™”
<
SÇµySškAÎoÿtÜ
> 
	`wr™”
(
®loÿtÜ
);

1368 
	`IÁ”ÇlUncom´ess
(
com´es£d
, &
wr™”
);

1369  
wr™”
.
	`Produûd
();

1370 
	}
}

1372 
boŞ
 
	$Uncom´ess
(
Sourû
* 
com´es£d
, 
Sšk
* 
uncom´es£d
) {

1374 
SÇµyDecom´essÜ
 
	`decom´essÜ
(
com´es£d
);

1375 
ušt32
 
uncom´es£d_Ën
 = 0;

1376 ià(!
decom´essÜ
.
	`R—dUncom´es£dL’gth
(&
uncom´es£d_Ën
)) {

1377  
çl£
;

1380 
c
;

1381 
size_t
 
®loÿ‹d_size
;

1382 * 
buf
 = 
uncom´es£d
->
	`G‘Aµ’dBufãrV¬ŸbË
(

1383 1, 
uncom´es£d_Ën
, &
c
, 1, &
®loÿ‹d_size
);

1387 ià(
®loÿ‹d_size
 >ğ
uncom´es£d_Ën
) {

1388 
SÇµyA¼ayWr™”
 
	`wr™”
(
buf
);

1389 
boŞ
 
»suÉ
 = 
	`IÁ”ÇlUncom´essAÎTags
(

1390 &
decom´essÜ
, &
wr™”
, 
uncom´es£d_Ën
);

1391 
uncom´es£d
->
	`Aµ’d
(
buf
, 
wr™”
.
	`Produûd
());

1392  
»suÉ
;

1394 
SÇµySškAÎoÿtÜ
 
	`®loÿtÜ
(
uncom´es£d
);

1395 
SÇµySÿ‰”edWr™”
<
SÇµySškAÎoÿtÜ
> 
	`wr™”
(
®loÿtÜ
);

1396  
	`IÁ”ÇlUncom´essAÎTags
(&
decom´essÜ
, &
wr™”
, 
uncom´es£d_Ën
);

1398 
	}
}

	@robot/utils/snappy/snappy.h

39 #iâdeà
THIRD_PARTY_SNAPPY_SNAPPY_H__


40 
	#THIRD_PARTY_SNAPPY_SNAPPY_H__


	)

42 
	~<¡ddef.h
>

43 
	~<¡ršg
>

45 
	~"¢­py-¡ubs-public.h
"

47 
Çme¥aû
 
	g¢­py
 {

48 
şass
 
	gSourû
;

49 
şass
 
	gSšk
;

57 
size_t
 
Com´ess
(
Sourû
* 
sourû
, 
Sšk
* 
sšk
);

66 
boŞ
 
G‘Uncom´es£dL’gth
(
Sourû
* 
sourû
, 
ušt32
* 
»suÉ
);

76 
size_t
 
Com´ess
(cÚ¡ * 
šput
, size_ˆ
šput_Ëngth
, 
¡ršg
* 
ouut
);

84 
boŞ
 
Uncom´ess
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

85 
¡ršg
* 
uncom´es£d
);

90 
boŞ
 
Uncom´ess
(
Sourû
* 
com´es£d
, 
Sšk
* 
uncom´es£d
);

98 
size_t
 
Uncom´essAsMuchAsPossibË
(
Sourû
* 
com´es£d
, 
Sšk
* 
uncom´es£d
);

119 
RawCom´ess
(cÚ¡ * 
šput
,

120 
size_t
 
šput_Ëngth
,

121 * 
com´es£d
,

122 
size_t
* 
com´es£d_Ëngth
);

129 
boŞ
 
RawUncom´ess
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

130 * 
uncom´es£d
);

137 
boŞ
 
RawUncom´ess
(
Sourû
* 
com´es£d
, * 
uncom´es£d
);

147 
boŞ
 
RawUncom´essToIOVec
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

148 cÚ¡ 
iovec
* 
iov
, 
size_t
 
iov_út
);

158 
boŞ
 
RawUncom´essToIOVec
(
Sourû
* 
com´es£d
, cÚ¡ 
iovec
* 
iov
,

159 
size_t
 
iov_út
);

163 
size_t
 
MaxCom´es£dL’gth
(size_ˆ
sourû_by‹s
);

169 
boŞ
 
G‘Uncom´es£dL’gth
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

170 
size_t
* 
»suÉ
);

176 
boŞ
 
IsV®idCom´es£dBufãr
(cÚ¡ * 
com´es£d
,

177 
size_t
 
com´es£d_Ëngth
);

185 
boŞ
 
IsV®idCom´es£d
(
Sourû
* 
com´es£d
);

196 cÚ¡ 
	gkBlockLog
 = 16;

197 cÚ¡ 
size_t
 
	gkBlockSize
 = 1 << 
kBlockLog
;

199 cÚ¡ 
	gkMaxHashTabËB™s
 = 14;

200 cÚ¡ 
size_t
 
	gkMaxHashTabËSize
 = 1 << 
kMaxHashTabËB™s
;

	@robot/utils/speech.hpp

32 #´agm¨
Úû


34 
	~<c¡dlib
>

35 
	~<io¡»am
>

36 
	~<±h»ad.h
>

37 
	~<queue
>

38 
	~<sys/ty³s.h
>

39 
	~<sys/wa™.h
>

40 
	~<¡ršg
>

41 
	~<uni¡d.h
>

42 
	~"uts/Tim”.hµ
"

49 şas 
	cS³ech


51 
	mpublic
:

53 
S³ech
& 
	$š¡ªû
() {

54 
S³ech
 
š¡ªû
;

55  
š¡ªû
;

58 
	$add
(
¡d
::
¡ršg
 
‹xt
) {

59 
	`±h»ad_mu‹x_lock
(&
mu‹x
);

60 
§yText
 = 
‹xt
;

61 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
);

62 
	}
}

64 
	g¡d
::
¡ršg
 
	$pİ
() {

65 
	`±h»ad_mu‹x_lock
(&
mu‹x
);

66 
¡d
::
¡ršg
 
»tuºText
 = 
§yText
;

67 
§yText
 = "";

68 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
);

69  
»tuºText
;

70 
	}
}

72 
	g´iv©e
:

74 
	$S³ech
() {

75 
»t
 = 
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
);

76 ià(
»t
è
¡d
::
cout
 << "çedØü—‹ say mu‹x" << std::
’dl
;

77 
	}
};

81 
S³ech
(S³ech cÚ¡& 
cİy
);

82 
	gS³ech
& 
	gİ”©Ü
=(
S³ech
 cÚ¡& 
cİy
);

84 
	g¡d
::
¡ršg
 
§yText
;

85 
±h»ad_mu‹x_t
 
	gmu‹x
;

88 cÚ¡ 
šlše
 
	$SAY
(
¡d
::
¡ršg
 
‹xt
, 
boŞ
 
blockšg
 = 
çl£
) {

89 (
S³ech
::
	`š¡ªû
()).
	`add
(
‹xt
);

90 
	}
}

92 cÚ¡ 
šlše
 
	g¡d
::
¡ršg
 
	$GET_SAYTEXT
() {

93  (
S³ech
::
	`š¡ªû
()).
	`pİ
();

94 
	}
}

	@utils/cameraCalibrator/main.c

1 
	~<sys/ty³s.h
>

2 
	~<sys/¡©.h
>

3 
	~<fú.h
>

4 
	~<¡dlib.h
>

5 
	~<lšux/videodev2.h
>

6 
	~<¡dio.h
>

7 
	~<¡ršg.h
>

8 
	~<sys/ioùl.h
>

9 
	~<”ºo.h
>

10 
	#TRUE
 1

	)

11 
	#FALSE
 0

	)

12 
v4l2_qu”yù¾
 
	gqu”yù¾
;

13 
v4l2_qu”ym’u
 
	gqu”ym’u
;

14 
	gfd
;

16 
	$chªge_šput
()

18 
šdex
;

20 
šdex
 = 10;

22 ià(-1 =ğ
	`ioùl
 (
fd
, 
VIDIOC_S_INPUT
, &
šdex
)) {

23 
	`³¼Ü
 ("VIDIOC_S_INPUT");

24 
	`ex™
 (
EXIT_FAILURE
);

26 
	}
}

28 
	$´št_šput
()

30 
v4l2_šput
 
šput
;

31 
šdex
;

33 ià(-1 =ğ
	`ioùl
 (
fd
, 
VIDIOC_G_INPUT
, &
šdex
)) {

34 
	`³¼Ü
 ("VIDIOC_G_INPUT");

35 
	`ex™
 (
EXIT_FAILURE
);

38 
	`mem£t
 (&
šput
, 0,  (input));

39 
šput
.
šdex
 = index;

41 ià(-1 =ğ
	`ioùl
 (
fd
, 
VIDIOC_ENUMINPUT
, &
šput
)) {

42 
	`³¼Ü
 ("VIDIOC_ENUMINPUT");

43 
	`ex™
 (
EXIT_FAILURE
);

46 
	`´štf
 ("Cu¼’ˆšput: %s\n", 
šput
.
Çme
);

47 
	}
}

53 
	$’um”©e_m’u
 ()

55 
	`´štf
 (" Menu items:\n");

57 
	`mem£t
 (&
qu”ym’u
, 0,  (querymenu));

58 
qu”ym’u
.
id
 = 
qu”yù¾
.id;

60 
qu”ym’u
.
šdex
 = 
qu”yù¾
.
mšimum
;

61 
qu”ym’u
.
šdex
 <ğ
qu”yù¾
.
maximum
;

62 
qu”ym’u
.
šdex
++) {

63 ià(0 =ğ
	`ioùl
 (
fd
, 
VIDIOC_QUERYMENU
, &
qu”ym’u
)) {

64 
	`´štf
 (" %s\n", 
qu”ym’u
.
Çme
);

66 
	`³¼Ü
 ("VIDIOC_QUERYMENU");

67 
	`ex™
 (
EXIT_FAILURE
);

70 
	}
}

76 
	$»ad_cÚŒŞs
()

78 
__u32
 
id
;

80 
	`mem£t
 (&
qu”yù¾
, 0,  (queryctrl));

82 
id
 = 
V4L2_CID_BASE
;

84 
id
 < 
V4L2_CID_LASTP1
 + 32;

85 
id
++) {

86 
qu”yù¾
.
id
 = id;

87 ià(0 =ğ
	`ioùl
 (
fd
, 
VIDIOC_QUERYCTRL
, &
qu”yù¾
)) {

89 ià(
qu”yù¾
.
æags
 & 
V4L2_CTRL_FLAG_DISABLED
) {

93 
	`´štf
 ("%2d CÚŒŞ %22s", 
qu”yù¾
.
id
 - 
V4L2_CID_BASE
,

94 
qu”yù¾
.
Çme
);

95 
v4l2_cÚŒŞ
 
cÚŒŞ
;

96 
cÚŒŞ
.
id
 = 
qu”yù¾
.id;

97 if(
id
 !ğ
V4L2_CID_BASE
 + 33){

99 ià(0 =ğ
	`ioùl
 (
fd
, 
VIDIOC_G_CTRL
, &
cÚŒŞ
)) {

100 
	`´štf
 ("% 9d% 9d% 9d\n",

101 
qu”yù¾
.
mšimum
, 
cÚŒŞ
.
v®ue
, qu”yù¾.
maximum
);

102 } ià(
”ºo
 !ğ
EINVAL
) {

103 
	`³¼Ü
 ("VIDIOC_G_CTRL -he Nao said we could controlhis, but "

105 
	`ex™
 (
EXIT_FAILURE
);

109 
	`´štf
 ("\n");

110 ià(
qu”yù¾
.
ty³
 =ğ
V4L2_CTRL_TYPE_MENU
)

111 
	`’um”©e_m’u
 ();

113 ià(
”ºo
 =ğ
EINVAL
)

116 
	`³¼Ü
 ("VIDIOC_QUERYCTRL");

117 
	`ex™
 (
EXIT_FAILURE
);

163 
	}
}

168 
	$di§bË_autos
(){

169 
v4l2_cÚŒŞ
 
cÚŒŞ
;

170 
	`mem£t
 (&
cÚŒŞ
, 0,  (control));

172 
cÚŒŞ
.
id
 = 
V4L2_CID_AUTO_WHITE_BALANCE
;

173 
cÚŒŞ
.
v®ue
 = 
FALSE
;

175 ià(-1 =ğ
	`ioùl
 (
fd
, 
VIDIOC_S_CTRL
, &
cÚŒŞ
)

176 && 
”ºo
 !ğ
ERANGE
) {

177 
	`´štf
("exiting on AWB\n");

178 
	`³¼Ü
 ("VIDIOC_S_CTRL");

179 
	`ex™
 (
EXIT_FAILURE
);

182 
cÚŒŞ
.
id
 = 0x009a0901;

183 
cÚŒŞ
.
v®ue
 = 0x0;

184 ià(-1 =ğ
	`ioùl
 (
fd
, 
VIDIOC_S_CTRL
, &
cÚŒŞ
)

185 && 
”ºo
 !ğ
ERANGE
) {

186 
	`´štf
("exiting on AWB\n");

187 
	`³¼Ü
 ("VIDIOC_S_CTRL");

188 
	`ex™
 (
EXIT_FAILURE
);

211 
	}
}

217 
	$chªge_cÚŒŞs
()

219 
	`´štf
("chooose‡ controlo change: ");

220 
	`sÿnf
("%d", &
qu”yù¾
.
id
);

221 
qu”yù¾
.
id
 +ğ
V4L2_CID_BASE
;

222 ià(0 =ğ
	`ioùl
 (
fd
, 
VIDIOC_QUERYCTRL
, &
qu”yù¾
)) {

224 ià(
qu”yù¾
.
æags
 & 
V4L2_CTRL_FLAG_DISABLED
){

225 
	`´štf
("not valid!\n");

229 
	`´štf
 ("% 2d CÚŒŞ %20s", 
qu”yù¾
.
id
 - 
V4L2_CID_BASE
,

230 
qu”yù¾
.
Çme
);

231 
v4l2_cÚŒŞ
 
cÚŒŞ
;

232 
	`mem£t
 (&
cÚŒŞ
, 0,  (control));

233 
cÚŒŞ
.
id
 = 
qu”yù¾
.id;

235 ià(0 =ğ
	`ioùl
 (
fd
, 
VIDIOC_G_CTRL
, &
cÚŒŞ
)) {

236 
	`´štf
 ("% 9d% 9d% 9d\n",

237 
qu”yù¾
.
mšimum
, 
cÚŒŞ
.
v®ue
, qu”yù¾.
maximum
);

238 } ià(
”ºo
 !ğ
EINVAL
) {

239 
	`³¼Ü
 ("VIDIOC_G_CTRL -he Nao said we could controlhis, but it "

241 
	`ex™
 (
EXIT_FAILURE
);

243 ià(
qu”yù¾
.
ty³
 =ğ
V4L2_CTRL_TYPE_MENU
)

244 
	`’um”©e_m’u
 ();

246 
	`´štf
("v®utØ£ˆto: %d-%d: ", 
qu”yù¾
.
mšimum
, qu”yù¾.
maximum
);

247 
	`sÿnf
("%d", &
cÚŒŞ
.
v®ue
);

249 ià(-1 =ğ
	`ioùl
 (
fd
, 
VIDIOC_S_CTRL
, &
cÚŒŞ
)

250 && 
”ºo
 !ğ
ERANGE
) {

251 
	`³¼Ü
 ("VIDIOC_S_CTRL");

252 
	`ex™
 (
EXIT_FAILURE
);

255 ià(
”ºo
 =ğ
EINVAL
){

256 
	`´štf
("not valid!\n");

259 
	`³¼Ü
 ("VIDIOC_QUERYCTRL");

260 
	`ex™
 (
EXIT_FAILURE
);

262 
	}
}

268 
	$maš
()

270 
fd
 = 
	`İ’
("/dev/video0", 
O_RDWR
);

271 if(
fd
 < 0){

272 
	`³¼Ü
("/dev/video1");

273 
	`ex™
 (
EXIT_FAILURE
);

275 
	`´št_šput
();

276 
	`»ad_cÚŒŞs
();

279 
fd
 = 
	`İ’
("/dev/video1", 
O_RDWR
);

280 
	`´št_šput
();

281 
	`»ad_cÚŒŞs
();

282 
	`chªge_cÚŒŞs
();

285 
	`»ad_cÚŒŞs
();

286 
	`chªge_cÚŒŞs
();

290 
	}
}

	@utils/offnao/externaldata/ExternalData.hpp

1 #´agm¨
Úû


10 şas 
	cEx‹º®D©a


12 
	mpublic
:

13 
	$Ex‹º®D©a
() {};

14 
vœtu®
 ~
	$Ex‹º®D©a
(è{
	}
}

17 
	g‹m¶©e
<
şass
 
	gArchive
>

18 
	$£rŸlize
(
Archive
 & 
¬
, cÚ¡ 
v”siÚ
)

20 
	}
}

	@utils/offnao/fields.hpp

32 #´agm¨
Úû


38 şas 
	cF›lds
 {

	@utils/offnao/frame.hpp

32 #´agm¨
Úû


34 
	~<boo¡/£rŸliz©iÚ/acûss.hµ
>

35 
	~<boo¡/£rŸliz©iÚ/sh¬ed_±r.hµ
>

36 
	~<boo¡/sh¬ed_±r.hµ
>

37 
	~<¡dšt.h
>

38 
	~<c¡dio
>

39 
	~<ùime
>

40 
	~<QPošt
>

42 
	~<m­
>

43 
	~<¡ršg
>

45 
	~"bÏckbßrd/BÏckbßrd.hµ
"

46 
	~"ex‹º®d©a/Ex‹º®D©a.hµ
"

51 şas 
	cF¿me
 {

52 
	mpublic
:

53 
BÏckbßrd
 *
bÏckbßrd
;

54 
time_t
 
	mtime¡amp
;

55 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mboo¡
::
sh¬ed_±r
<
Ex‹º®D©a
> > 
ex‹º®D©a
;

56 
	$F¿me
(è: 
	$bÏckbßrd
(0) {

57 
time¡amp
 = 
	`time
(0);

59 ~
	$F¿me
(è{
	}
}

61 
ä›nd
 
şass
 
	gboo¡
::
£rŸliz©iÚ
::
acûss
;

65 
	g‹m¶©e
<
şass
 
	gArchive
>

66 
sh®lowS”Ÿlize
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
);

70 
	g‹m¶©e
<
şass
 
	gArchive
>

71 
	$§ve
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
) const;

75 
‹m¶©e
<
şass
 
Archive
>

76 
	`lßd
(
Archive
 &
¬
, cÚ¡ 
v”siÚ
);

77 
	`BOOST_SERIALIZATION_SPLIT_MEMBER
();

79 
	}
};

80 
	~"äame.tcc
"

	@utils/offnao/frame.tcc

1 
	~"qt_£rŸli§tiÚ/boo¡S”Ÿliz©iÚQPošt.hµ
"

2 
	~"´ogİts.hµ
"

5 
	g‹m¶©e
<
şass
 
	gArchive
>

6 
	gF¿me
::
	$sh®lowS”Ÿlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

7 
¬
 & 
time¡amp
;

12 
¬
 & 
ex‹º®D©a
;

13 
	}
}

15 
	g‹m¶©e
<
şass
 
	gArchive
>

16 
	gF¿me
::
	$§ve
(
Archive
 & 
¬
, cÚ¡ 
v”siÚ
) const {

17 
¬
 & *
bÏckbßrd
;

18 ((
F¿me
*)
this
)->
	`sh®lowS”Ÿlize
(
¬
, 
v”siÚ
);

19 
	}
}

21 
	g‹m¶©e
<
şass
 
	gArchive
>

22 
	gF¿me
::
	$lßd
(
Archive
 & 
¬
, cÚ¡ 
v”siÚ
) {

23 
bÏckbßrd
 = 
Ãw
 
	`BÏckbßrd
(
cÚfig
);

24 
¬
 & *
bÏckbßrd
;

25 
	`sh®lowS”Ÿlize
(
¬
, 
v”siÚ
);

27 
	}
}

	@utils/offnao/main.cpp

32 
	~<QtCÜe/qglob®.h
>

33 
	~<boo¡/´og¿m_İtiÚs.hµ
>

34 
	~<boo¡/sh¬ed_±r.hµ
>

35 
	~<QtGui/QAµliÿtiÚ
>

36 
	~<io¡»am
>

37 
	~"visu®i£r.hµ
"

38 
	~"uts/İtiÚs.hµ
"

40 
Çme¥aû
 
	gpo
 = 
boo¡
::
´og¿m_İtiÚs
;

41 
usšg
 
Çme¥aû
 
	g¡d
;

42 
usšg
 
Çme¥aû
 
	gboo¡
;

44 
¡ršg
 
g™_v”siÚ
;

46 
	gpo
::
v¬ŸbËs_m­
 
cÚfig
;

48 
	$maš
(
¬gc
, *
¬gv
[]) {

55 
po
::
İtiÚs_desütiÚ
 
cmdlše_İtiÚs
;

56 
po
::
İtiÚs_desütiÚ
 
	`g’”ic_İtiÚs
("Generic options");

57 
g’”ic_İtiÚs
.
	`add_İtiÚs
()

60 ("dump,d", 
po
::
v®ue
<
¡ršg
>(), "open dump.[ofn|yuv]");

63 
po
::
İtiÚs_desütiÚ
 
	`visiÚ_İtiÚs
("Vision options");

65 
cmdlše_İtiÚs
.
	`add
(
g’”ic_İtiÚs
);

66 
cmdlše_İtiÚs
.
	`add
(
visiÚ_İtiÚs
);

68 
po
::
v¬ŸbËs_m­
 
vm
;

69 
po
::
	`¡Üe
Õo::
	`·r£_commªd_lše
(
¬gc
, 
¬gv
, 
cmdlše_İtiÚs
), 
vm
);

70 
po
::
	`nÙify
(
vm
);

72 ià(
vm
.
	`couÁ
("help")) {

73 
¡d
::
cout
 << 
cmdlše_İtiÚs
 << 
’dl
;

77 ià(
vm
.
	`couÁ
("version")) {

78 
¡d
::
cout
 << "OffNaØ" << 
g™_v”siÚ
 << 
’dl
;

83 
po
::
İtiÚs_desütiÚ
 
cÚfig_fe_İtiÚs
;

84 
	`pİuÏ‹_İtiÚs
(
cÚfig_fe_İtiÚs
);

85 
if¡»am
 
ifs
;

86 
ifs
.
	`İ’
("../runswift.cfg");

87 
	`¡Üe
(
	`·r£_cÚfig_fe
(
ifs
, 
cÚfig_fe_İtiÚs
), 
cÚfig
);

88 
ifs
.
	`şo£
();

89 
ifs
.
	`İ’
("/etc/runswift/runswift.cfg");

90 
	`¡Üe
(
	`·r£_cÚfig_fe
(
ifs
, 
cÚfig_fe_İtiÚs
), 
cÚfig
);

91 
ifs
.
	`şo£
();

92 
po
::
	`nÙify
(
cÚfig
);

95 
QAµliÿtiÚ
 
	`a
(
¬gc
, 
¬gv
);

96 
Visu®i£r
 
w
;

98 ià(
vm
.
	`couÁ
("dump")) {

99 
w
.
	`İ’Fe
(
vm
["dump"].
as
<
¡ršg
>().
	`c_¡r
());

102 
w
.
	`show
();

105 ià(
vm
.
	`couÁ
("nnmc_top") || vm.count("nnmc_bot")) {

106 
w
.
bs
->
	`£tCu¼’tWidg‘
(w.
visiÚTab
);

110 
û¼
 << "log·th is: " << 
cÚfig
["debug.log·th"].
as
<
¡ršg
>(è<< 
’dl
;

112  
a
.
	`exec
();

113 
	}
}

	@utils/offnao/mediaPanel.cpp

32 
	~<QtGui
>

33 
	~<QDebug
>

34 
	~<QObjeù
>

35 
	~"medŸPª–.hµ
"

37 
	gMedŸPª–
::
	$MedŸPª–
(
QWidg‘
 *
·»Á
)

38 : 
	`QWidg‘
(
·»Á
), 
	`isPÏy
(
Œue
), 
	$isRecÜd
(
Œue
) {

39 
Ïyout
 = 
Ãw
 
	`QGridLayout
();

40 
this
->
	`£tLayout
(
Ïyout
);

42 
this
->
	`£tMšimumSize
(600, 50);

44 
»cÜdBu‰Ú
 = 
Ãw
 
	`QToŞBu‰Ú
();

45 
»cÜdAù
 = 
Ãw
 
	`QAùiÚ
(
»cÜdBu‰Ú
);

46 
»cÜdAù
->
	`£tIcÚ
(
	`QIcÚ
(
	`Œ
(":/icons/media_icons/media-record.svg")));

47 
»cÜdBu‰Ú
->
	`£tMšimumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

48 
»cÜdBu‰Ú
->
	`£tMaximumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

49 
Ïyout
->
	`addWidg‘
(
»cÜdBu‰Ú
, 0, 0, 1, 1);

50 
»cÜdBu‰Ú
->
	`£tDeçuÉAùiÚ
(
»cÜdAù
);

52 
¡İBu‰Ú
 = 
Ãw
 
	`QToŞBu‰Ú
();

53 
¡İAù
 = 
Ãw
 
	`QAùiÚ
(
¡İBu‰Ú
);

54 
¡İAù
->
	`£tIcÚ
(
	`QIcÚ
(
	`Œ
(":/icons/media_icons/media-playback-stop.svg")));

55 
¡İBu‰Ú
->
	`£tMšimumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

56 
¡İBu‰Ú
->
	`£tMaximumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

58 
¡İBu‰Ú
->
	`£tDeçuÉAùiÚ
(
¡İAù
);

60 
·u£Bu‰Ú
 = 
Ãw
 
	`QToŞBu‰Ú
();

61 
·u£Aù
 = 
Ãw
 
	`QAùiÚ
(
·u£Bu‰Ú
);

62 
·u£Aù
->
	`£tIcÚ
(
	`QIcÚ
(
	`Œ
(":/icons/media_icons/media-playback-pause.svg")));

63 
·u£Bu‰Ú
->
	`£tMšimumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

64 
·u£Bu‰Ú
->
	`£tMaximumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

66 
·u£Bu‰Ú
->
	`£tDeçuÉAùiÚ
(
·u£Aù
);

69 
¶ayBu‰Ú
 = 
Ãw
 
	`QToŞBu‰Ú
();

70 
¶ayAù
 = 
Ãw
 
	`QAùiÚ
(
¶ayBu‰Ú
);

71 
¶ayAù
->
	`£tIcÚ
(
	`QIcÚ
(
	`Œ
(":/icons/media_icons/media-playback-start.svg")));

72 
¶ayBu‰Ú
->
	`£tMšimumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

73 
¶ayBu‰Ú
->
	`£tMaximumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

74 
Ïyout
->
	`addWidg‘
(
¶ayBu‰Ú
, 0, 1, 1, 1);

75 
¶ayBu‰Ú
->
	`£tDeçuÉAùiÚ
(
¶ayAù
);

79 
backBu‰Ú
 = 
Ãw
 
	`QToŞBu‰Ú
();

80 
backAù
 = 
Ãw
 
	`QAùiÚ
(
backBu‰Ú
);

81 
backAù
->
	`£tIcÚ
(
	`QIcÚ
(
	`Œ
(":/icons/media_icons/media-skip-backward.svg")));

82 
backBu‰Ú
->
	`£tMšimumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

83 
backBu‰Ú
->
	`£tMaximumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

84 
Ïyout
->
	`addWidg‘
(
backBu‰Ú
, 0, 2, 1, 1);

85 
backBu‰Ú
->
	`£tDeçuÉAùiÚ
(
backAù
);

88 
fÜw¬dBu‰Ú
 = 
Ãw
 
	`QToŞBu‰Ú
();

89 
fÜw¬dAù
 = 
Ãw
 
	`QAùiÚ
(
fÜw¬dBu‰Ú
);

90 
fÜw¬dAù
->
	`£tIcÚ
(
	`QIcÚ
(
	`Œ
(":/icons/media_icons/media-skip-forward.svg")));

91 
fÜw¬dBu‰Ú
->
	`£tMšimumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

92 
fÜw¬dBu‰Ú
->
	`£tMaximumSize
(
BUTTON_WIDTH
, 
BUTTON_HEIGHT
);

93 
Ïyout
->
	`addWidg‘
(
fÜw¬dBu‰Ú
, 0, 3, 1, 1);

94 
fÜw¬dBu‰Ú
->
	`£tDeçuÉAùiÚ
(
fÜw¬dAù
);

98 
äameSlid”
 = 
Ãw
 
	`QSlid”
(
this
);

99 
äameSlid”
->
	`£tOr›Á©iÚ
(
Qt
::
HÜizÚl
);

100 
äameSlid”
->
	`£tSšgËS‹p
(1);

102 
Ïyout
->
	`addWidg‘
(
äameSlid”
, 0, 4, 1, 1);

103 
	`cÚÃù
(
¶ayBu‰Ú
, 
	`SIGNAL
(
	`Œigg”ed
(
QAùiÚ
*)), 
this
,

104 
	`SLOT
(
	`toggËPau£PÏy
(
QAùiÚ
*)));

105 
	`cÚÃù
(
»cÜdBu‰Ú
, 
	`SIGNAL
(
	`Œigg”ed
(
QAùiÚ
*)), 
this
,

106 
	`SLOT
(
	`toggËRecÜdStİ
(
QAùiÚ
*)));

107 
	}
}

108 
	gMedŸPª–
::
	$£tIsPÏy
(
boŞ
 
b
) {

109 ià(
b
 !ğ
isPÏy
è
	`toggËPau£PÏy
(
NULL
);

110 
isPÏy
 = 
b
;

111 
	}
}

113 
	gMedŸPª–
::
	$£tIsRecÜd
(
boŞ
 
b
) {

114 ià(
b
 !ğ
isRecÜd
è
	`toggËRecÜdStİ
(
NULL
);

115 
isRecÜd
 = 
b
;

116 
	}
}

117 
	gMedŸPª–
::
	$toggËPau£PÏy
(
QAùiÚ
* 
aùiÚ
) {

118 
isPÏy
 = !isPlay;

119 ià(
isPÏy
) {

120 
¶ayBu‰Ú
->
	`»moveAùiÚ
(
·u£Aù
);

121 
¶ayBu‰Ú
->
	`£tDeçuÉAùiÚ
(
¶ayAù
);

123 
¶ayBu‰Ú
->
	`»moveAùiÚ
(
¶ayAù
);

124 
¶ayBu‰Ú
->
	`£tDeçuÉAùiÚ
(
·u£Aù
);

126 
	}
}

128 
	gMedŸPª–
::
	$toggËRecÜdStİ
(
QAùiÚ
* 
aùiÚ
) {

129 
isRecÜd
 = !isRecord;

130 ià(
isRecÜd
) {

131 
»cÜdBu‰Ú
->
	`»moveAùiÚ
(
¡İAù
);

132 
»cÜdBu‰Ú
->
	`£tDeçuÉAùiÚ
(
»cÜdAù
);

133 
	`£tIsPÏy
(
Œue
);

135 
»cÜdBu‰Ú
->
	`»moveAùiÚ
(
»cÜdAù
);

136 
»cÜdBu‰Ú
->
	`£tDeçuÉAùiÚ
(
¡İAù
);

137 
	`£tIsPÏy
(
çl£
);

139 
	}
}

142 
	gMedŸPª–
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

143 ià(
ÇoD©a
) {

144 
äameSlid”
->
	`£tT¿ckšg
(
çl£
);

145 
äameSlid”
->
	`£tSlid”Pos™iÚ
(

146 
	`round
(100*(1.0*
ÇoD©a
->
	`g‘Cu¼’tF¿meIndex
())/

147 
ÇoD©a
->
	`g‘F¿mesTÙ®
()));

148 
äameSlid”
->
	`£tT¿ckšg
(
Œue
);

150 
	}
}

	@utils/offnao/mediaPanel.hpp

33 #´agm¨
Úû


35 
	~<QBrush
>

36 
	~<QP’
>

37 
	~<QPixm­
>

38 
	~<QWidg‘
>

39 
	~<QGridLayout
>

40 
	~<QSlid”
>

41 
	~<QToŞBu‰Ú
>

42 
	~<QAùiÚ
>

44 
	~"ÇoD©a.hµ
"

49 şas 
	cMedŸPª–
 : 
public
 
QWidg‘
 {

50 
Q_OBJECT


51 
public
 
¦Ùs
:

52 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

53 
toggËPau£PÏy
(
QAùiÚ
* 
aùiÚ
);

54 
toggËRecÜdStİ
(
QAùiÚ
* 
aùiÚ
);

56 
	mpublic
:

57 
ex¶ic™
 
MedŸPª–
(
QWidg‘
 *
·»Á
 = 0);

59 
QToŞBu‰Ú
 *
	m»cÜdBu‰Ú
;

60 
QToŞBu‰Ú
 *
	m·u£Bu‰Ú
;

61 
QToŞBu‰Ú
 *
	m¡İBu‰Ú
;

62 
QToŞBu‰Ú
 *
	m¶ayBu‰Ú
;

63 
QToŞBu‰Ú
 *
	mbackBu‰Ú
;

64 
QToŞBu‰Ú
 *
	mfÜw¬dBu‰Ú
;

67 
QSlid”
 *
	mäameSlid”
;

71 
QAùiÚ
 *
	m»cÜdAù
;

72 
QAùiÚ
 *
	m·u£Aù
;

73 
QAùiÚ
 *
	m¡İAù
;

74 
QAùiÚ
 *
	m¶ayAù
;

75 
QAùiÚ
 *
	mbackAù
;

76 
QAùiÚ
 *
	mfÜw¬dAù
;

78 
£tIsPÏy
(
boŞ
 
b
);

79 
£tIsRecÜd
(
boŞ
 
b
);

80 
	m´iv©e
:

81 
QGridLayout
 *
Ïyout
;

82 cÚ¡ 
	mBUTTON_HEIGHT
 = 30;

83 cÚ¡ 
	mBUTTON_WIDTH
 = 39;

84 
boŞ
 
	misPÏy
;

85 
boŞ
 
	misRecÜd
;

	@utils/offnao/naoData.hpp

32 #´agm¨
Úû


34 
	~<boo¡/£rŸliz©iÚ/acûss.hµ
>

35 
	~<ùime
>

36 
	~<veùÜ
>

37 
	~"äame.hµ
"

50 şas 
	cNaoD©a
 {

51 
	mpublic
:

52 
šlše
 
F¿me
 &
	$g‘Cu¼’tF¿me
() {

53 ià(
cu¼’tF¿me
 >ğ
äames
.
	`size
() ||

54 
cu¼’tF¿me
 < 0) {

55 
F¿me
 
äame
;

56  
äame
;

58  
äames
[
cu¼’tF¿me
];

60 
šlše
 
F¿me
 &
	$g‘F¿me
(
n
è{ 
äames
[n];
	}
}

62 
šlše
 
	$ÃxtF¿me
() {

63 ià(
cu¼’tF¿me
 !ğ
äames
.
	`size
() - 1) currentFrame++;

64  
cu¼’tF¿me
;

65 
	}
}

67 
šlše
 
	$´evF¿me
() {

68 ià(
cu¼’tF¿me
 != 0) currentFrame--;

69  
cu¼’tF¿me
;

70 
	}
}

72 
šlše
 
	$g‘F¿mesTÙ®
(è{ 
äames
.
	`size
(); 
	}
}

73 
šlše
 
	$g‘Cu¼’tF¿meIndex
(è{  
cu¼’tF¿me
; 
	}
}

74 
šlše
 
boŞ
 
	$g‘IsPau£d
(è{  
isPau£d
; 
	}
}

75 
šlše
 
	$£tPau£d
(
boŞ
 
b
è{ 
isPau£d
 = b; 
	}
}

77 
šlše
 
	$£tCu¼’tF¿me
(
šdex
) {

78 ià(
šdex
 >ğ
äames
.
	`size
()) ;

79 
cu¼’tF¿me
 = 
šdex
;

80 
	}
}

82 
šlše
 
time_t
 
	$timeTlNextF¿me
() {

83 ià(
	`g‘Cu¼’tF¿meIndex
(è!ğ
	`g‘F¿mesTÙ®
()) {

84  
äames
[
cu¼’tF¿me
].
time¡amp
 -

85 
äames
[
cu¼’tF¿me
].
time¡amp
;

88 
	}
}

90 
	$NaoD©a
(è: 
	`cu¼’tF¿me
(0), 
	$isPau£d
(
Œue
è{
	}
}

94 
šlše
 
	$­³ndF¿me
(
F¿me
 
äame
è{
äames
.
	`push_back
(äame);
	}
}

95 
	g´iv©e
:

97 
¡d
::
veùÜ
<
F¿me
> 
äames
;

100 
	gcu¼’tF¿me
;

103 
time_t
 
	gtimeRecÜded
;

106 
boŞ
 
	gisPau£d
;

108 
ä›nd
 
şass
 
	gboo¡
::
£rŸliz©iÚ
::
acûss
;

109 
	g‹m¶©e
<
şass
 
	gArchive
>

110 
£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
);

112 
	~"ÇoD©a.tcc
"

	@utils/offnao/naoData.tcc

1 
	~<boo¡/£rŸliz©iÚ/veùÜ.hµ
>

3 
	g‹m¶©e
<
şass
 
	gArchive
>

4 
	gNaoD©a
::
	$£rŸlize
(
Archive
 &
¬
, cÚ¡ 
fe_v”siÚ
) {

5 
¬
 & 
äames
;

6 
¬
 & 
cu¼’tF¿me
;

7 
¬
 & 
timeRecÜded
;

8 
¬
 & 
isPau£d
;

9 
	}
}

	@utils/offnao/progopts.hpp

32 
	~"boo¡/´og¿m_İtiÚs.hµ
"

33 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
cÚfig
;

	@utils/offnao/qt_serialisation/boostSerializationQPoint.hpp

1 #´agm¨
Úû


3 
Çme¥aû
 
	gboo¡
 {

4 
Çme¥aû
 
	g£rŸliz©iÚ
 {

5 
	g‹m¶©e
<
şass
 
	gArchive
>

6 
£rŸlize
(
Archive
 &
¬
, 
QPoštF
 &
g
, cÚ¡ 
v”siÚ
) {

7 
	g¬
 & 
	gg
.
rx
();

8 
	g¬
 & 
	gg
.
ry
();

10 
	g‹m¶©e
<
şass
 
	gArchive
>

11 
£rŸlize
(
Archive
 &
¬
, 
QPošt
 &
g
, cÚ¡ 
v”siÚ
) {

12 
	g¬
 & 
	gg
.
rx
();

13 
	g¬
 & 
	gg
.
ry
();

	@utils/offnao/readers/bbdReader.cpp

1 
	~"bbdR—d”.hµ
"

3 
	~<boo¡/¬chive/bš¬y_ßrchive.hµ
>

4 
	~<s¡»am
>

6 
usšg
 
Çme¥aû
 
	g¡d
;

8 
	gBBDR—d”
::
	$BBDR—d”
(cÚ¡ 
QSŒšg
 &
feName
è: 
	`ifs
(), 
	$š
(){

10 
ifs
.
	`exû±iÚs
(
if¡»am
::
eofb™
 | if¡»am::
çb™
 | if¡»am::
badb™
);

11 
ifs
.
	`İ’
(
	`qPršbË
(
feName
), 
ios
::
š
 | ios::
bš¬y
);

12 
š
.
	`push
(
ifs
);

13 
Ÿ
 = 
Ãw
 
boo¡
::
¬chive
::
	`bš¬y_Ÿrchive
(
š
);

14 
	}
}

16 
	gBBDR—d”
::
	$BBDR—d”
(cÚ¡ 
QSŒšg
 &
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
) :

17 
	`R—d”
(
ÇoD©a
), 
	`ifs
(), 
	$š
(){

19 
ifs
.
	`exû±iÚs
(
if¡»am
::
eofb™
 | if¡»am::
çb™
 | if¡»am::
badb™
);

20 
ifs
.
	`İ’
(
	`qPršbË
(
feName
), 
ios
::
š
 | ios::
bš¬y
);

21 
š
.
	`push
(
ifs
);

22 
Ÿ
 = 
Ãw
 
boo¡
::
¬chive
::
	`bš¬y_Ÿrchive
(
š
);

23 
	}
}

25 
	gBBDR—d”
::~
	$BBDR—d”
() {

26 
d–‘e
 
Ÿ
;

27 
	}
}

29 
	gBBDR—d”
::
	$run
() {

33 
Œy
 {

34 
F¿me
 
äame
;

35 
äame
.
bÏckbßrd
 = 
Ãw
 
	`BÏckbßrd
(
cÚfig
);

36 *
Ÿ
 & *
äame
.
bÏckbßrd
;

37 
ÇoD©a
.
	`­³ndF¿me
(
äame
);

38 } 
	`ÿtch
(cÚ¡ 
¡d
::
exû±iÚ
& 
e
) {

40 ià(
ÇoD©a
.
	`g‘F¿mesTÙ®
() == 0) {

41 
QSŒšg
 
	`s
("Can‚ot†oad„ecord: ");

42 
em™
 
	`discÚÃùFromNao
();

43 
em™
 
	`showMes§ge
(
s
 + 
e
.
	`wh©
());

50 
¡ršg¡»am
 
s
;

51 
s
 << "Finished†oading„ecord which consisted of " <<

52 
ÇoD©a
.
	`g‘F¿mesTÙ®
() << " frames.";

53 
em™
 
	`showMes§ge
(
s
.
	`¡r
().
	`c_¡r
(), 5000);

54 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

56 
cu¼’tIndex
 = 0;

57 
isAlive
 = 
Œue
;

58 
isAlive
) {

59 ià(!
ÇoD©a
.
	`g‘IsPau£d
() &&

60 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
(è<‚aoD©a.
	`g‘F¿mesTÙ®
() - 1) {

61 
ÇoD©a
.
	`ÃxtF¿me
();

62 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

63 } ià(
cu¼’tIndex
 !ğ
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
()) {

64 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

66 
cu¼’tIndex
 = 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
();

67 
	`m¦“p
(500);

69 
em™
 
	`ÃwNaoD©a
(
NULL
);

70 
	}
}

	@utils/offnao/readers/bbdReader.hpp

1 #´agm¨
Úû


3 
	~"»ad”.hµ
"

5 
	~<boo¡/¬chive/bš¬y_Ÿrchive.hµ
>

6 
	~<boo¡/io¡»ams/f‹ršg_¡»ambuf.hµ
>

7 
	~<f¡»am
>

8 
	~<QSŒšg
>

13 şas 
	cBBDR—d”
 : 
public
 
R—d”
 {

14 
Q_OBJECT


15 
public
:

21 
ex¶ic™
 
BBDR—d”
(cÚ¡ 
QSŒšg
 &
feName
);

29 
ex¶ic™
 
BBDR—d”
(cÚ¡ 
QSŒšg
 &
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
);

37 
wr™e
(cÚ¡ 
QSŒšg
 &
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
);

38 
vœtu®
 
run
();

43 
	mvœtu®
 ~
BBDR—d”
();

44 
	m´iv©e
:

48 
¡d
::
if¡»am
 
ifs
;

53 
	mboo¡
::
io¡»ams
::
f‹ršg_¡»ambuf
<
boo¡
::io¡»ams::
šput
> 
š
;

58 
	mboo¡
::
¬chive
::
bš¬y_Ÿrchive
 *
Ÿ
;

	@utils/offnao/readers/dumpReader.cpp

32 
	~<QDebug
>

33 
	~<QSŒšg
>

34 
	~<QMes§geBox
>

35 
	~<¡ršg
>

36 
	~<s¡»am
>

37 
	~<cm©h
>

38 
	~"uts/basic_m©hs.hµ
"

39 
	~"»ad”s/dumpR—d”.hµ
"

40 
	~"bÏckbßrd/BÏckbßrd.hµ
"

41 
	~"´ogİts.hµ
"

42 
	~<io¡»am
>

43 
usšg
 
Çme¥aû
 
	g¡d
;

44 
	gDumpR—d”
::
	$DumpR—d”
(
QSŒšg
 
feName
) {

45 
dumpFe
 = 
	`fİ’
(
feName
.
	`toAscii
().
	`d©a
(), "r");

46 ià(
dumpFe
 =ğ
NULL
) {

49 
	}
}

51 
	gDumpR—d”
::
	$DumpR—d”
(
QSŒšg
 
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
) :

52 
	$R—d”
(
ÇoD©a
) {

53 
dumpFe
 = 
	`fİ’
(
feName
.
	`toAscii
().
	`d©a
(), "r");

54 ià(
dumpFe
 =ğ
NULL
) {

57 
	}
}

59 
	gDumpR—d”
::
	$run
() {

61 
cu¼’tIndex
 = 0;

64 
äameLßded
 = 1;

66 
ušt8_t
* 
tİ
 =

67 (
ušt8_t
 *è
	`m®loc
((ušt8_t)*
TOP_SIZE
);

68 
ušt8_t
* 
bÙ
 =

69 (
ušt8_t
 *è
	`m®loc
((ušt8_t)*
BOT_SIZE
);

70 if(
	`ä—d
(
tİ
, 
TOP_SIZE
, 1, 
dumpFe
) != 1){

71 
	`ä“
(
tİ
);

74 if(
	`ä—d
(
bÙ
, 
BOT_SIZE
 ,1, 
dumpFe
)!= 1){

75 
	`ä“
(
bÙ
);

78 
F¿me
 
äame
;

79 
BÏckbßrd
 *
bÏckbßrd
 = 
Ãw
 
	`BÏckbßrd
(
cÚfig
);

80 
OffNaoMask_t
 
mask
 = 
RAW_IMAGE_MASK
;

82 
bÏckbßrd
->
	`wr™e
(&(bÏckbßrd->
mask
), mask);

83 
	`wr™eTo
(
visiÚ
, 
tİF¿me
, (cÚ¡ 
ušt8_t
*è
tİ
);

84 
	`wr™eTo
(
visiÚ
, 
bÙF¿me
, (cÚ¡ 
ušt8_t
*è
bÙ
);

85 
äame
.
bÏckbßrd
 = blackboard;

86 
ÇoD©a
.
	`­³ndF¿me
(
äame
);

87 
¡d
::
¡ršg¡»am
 
s
;

88 
s
 << "Lßdšg f¿m" << 
äameLßded
 << " from YUV dump.";

89 
em™
 
	`showMes§ge
(
s
.
	`¡r
().
	`c_¡r
(), 2000);

90 
äameLßded
++;

94 
¡d
::
¡ršg¡»am
 
s
;

95 
s
 << "Finshed†oading YUV dump which consisted of " <<

96 
äameLßded
 << " frames.";

97 
em™
 
	`showMes§ge
(
s
.
	`¡r
().
	`c_¡r
(), 5000);

98 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

100 
isAlive
 = 
Œue
;

101 
isAlive
) {

102 ià(!
ÇoD©a
.
	`g‘IsPau£d
(è&&‚aoD©a.
	`g‘Cu¼’tF¿meIndex
() <

103 
ÇoD©a
.
	`g‘F¿mesTÙ®
() - 1) {

104 
ÇoD©a
.
	`ÃxtF¿me
();

105 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

106 } ià(
cu¼’tIndex
 !ğ
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
()) {

107 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

109 
cu¼’tIndex
 = 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
();

110 
	`m¦“p
(500);

112 
em™
 
	`ÃwNaoD©a
(
NULL
);

113 
	}
}

116 
	gDumpR—d”
::
	$¡İMedŸTrigg”
() {

117 
	}
}

	@utils/offnao/readers/dumpReader.hpp

32 #´agm¨
Úû


33 
	~<QSŒšg
>

34 
	~<c¡dio
>

35 
	~"»ad”s/»ad”.hµ
"

36 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

37 
	#TOP_SIZE
 1280*960*2

	)

38 
	#BOT_SIZE
 640*480*2

	)

42 şas 
	cDumpR—d”
 : 
public
 
R—d”
 {

43 
Q_OBJECT


44 
public
:

45 
ex¶ic™
 
DumpR—d”
(
QSŒšg
 
f’ame
);

46 
ex¶ic™
 
DumpR—d”
(
QSŒšg
 
f’ame
, cÚ¡ 
NaoD©a
 &
ÇoD©a
);

47 
vœtu®
 
run
();

48 
	m´iv©e
:

49 
FILE
 *
dumpFe
;

50 
public
 
	m¦Ùs
:

51 
vœtu®
 
¡İMedŸTrigg”
();

	@utils/offnao/readers/networkReader.cpp

32 
	~<QDebug
>

33 
	~<QIÅutDŸlog
>

34 
	~<QMes§geBox
>

35 
	~<QSŒšg
>

36 
	~<QSŒšgLi¡
>

37 
	~<QIÅutDŸlog
>

38 
	~<cm©h
>

39 
	~<¡ršg
>

40 
	~<s¡»am
>

41 
	~<boo¡/£rŸliz©iÚ/li¡.hµ
>

42 
	~<boo¡/£rŸliz©iÚ/veùÜ.hµ
>

43 
	~<boo¡/sh¬ed_±r.hµ
>

45 
	~"»ad”s/ÃtwÜkR—d”.hµ
"

46 
	~"uts/Tim”.hµ
"

47 
	~"´ogİts.hµ
"

48 
	~"bÏckbßrd/BÏckbßrd.hµ
"

49 
	~"ty³s/AbsCoÜd.hµ
"

50 
	~"th»ad/Th»ad.hµ
"

52 
usšg
 
Çme¥aû
 
	g¡d
;

53 
usšg
 
Çme¥aû
 
	gboo¡
;

55 
	gN‘wÜkR—d”
::
	$N‘wÜkR—d”
(cÚ¡ 
QSŒšg
 &
robÙName
, 
OffNaoMask_t
 
mask
) :

56 
	`cÚÃùiÚ_
(0), 
	`»ûived
(), 
	`isRecÜdšg
(
çl£
), 
	$robÙName
(
robÙName
) {

57 
this
->
mask
 = mask;

58 
this
->
ÇoD©a
.
	`£tPau£d
(
çl£
);

59 
isAlive
 = 
Œue
;

60 
	}
}

62 
	gN‘wÜkR—d”
::
N‘wÜkR—d”
(
·œ
<cÚ¡ 
QSŒšg
 &, 
OffNaoMask_t
> 
robÙNameMask
):

63 
cÚÃùiÚ_
(0), 
»ûived
(), 
isRecÜdšg
(
çl£
),

64 
	$robÙName
(
robÙNameMask
.
fœ¡
) {

65 
this
->
mask
 = 
robÙNameMask
.
£cÚd
;

66 
this
->
ÇoD©a
.
	`£tPau£d
(
çl£
);

67 
isAlive
 = 
Œue
;

68 
	}
}

70 
	gN‘wÜkR—d”
::
N‘wÜkR—d”
(
·œ
<cÚ¡ 
QSŒšg
 &, 
OffNaoMask_t
> 
robÙNameMask
,

71 cÚ¡ 
NaoD©a
 &
ÇoD©a
) :

72 
R—d”
(
ÇoD©a
), 
cÚÃùiÚ_
(0), 
»ûived
(), 
isRecÜdšg
(
çl£
),

73 
	$robÙName
(
robÙNameMask
.
fœ¡
) {

74 
this
->
mask
 = 
robÙNameMask
.
£cÚd
;

75 
this
->
ÇoD©a
.
	`£tPau£d
(
çl£
);

76 
isAlive
 = 
Œue
;

77 
	}
}

79 
	gN‘wÜkR—d”
::~
	$N‘wÜkR—d”
() {

80 ià(
isRecÜdšg
è
	`discÚÃù
();

81 
isAlive
 = 
çl£
;

82 
	}
}

85 
	gN‘wÜkR—d”
::
	$hªdË_cÚÃù
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
,

86 
boo¡
::
asio
::

::
tı
::
»sŞv”
::
™”©Ü
 
’dpošt_™”©Ü
) {

87 
	`qDebug
("Connected!");

88 ià(
Th»ad
::
Çme
 =ğ
NULL
) {

89 
Th»ad
::
Çme
 = "NetworkReader";

92 ià(!
e
) {

97 
»ûived
.
bÏckbßrd
 = 
Ãw
 
	`BÏckbßrd
(
cÚfig
);

98 
cÚÃùiÚ_
->
	`async_»ad
(*
»ûived
.
bÏckbßrd
,

99 
boo¡
::
	`bšd
(&
N‘wÜkR—d”
::
hªdË_»ad
, 
this
,

100 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
));

103 
	`wr™e
(
mask
);

104 
em™
 
	`showMes§ge
(
	`QSŒšg
("Connected! Now streaming"));

105 } ià(
’dpošt_™”©Ü
 !ğ
boo¡
::
asio
::

::
tı
::
»sŞv”
::
	`™”©Ü
()) {

107 
cÚÃùiÚ_
->
	`sock‘
().
	`şo£
();

108 
boo¡
::
asio
::

::
tı
::
’dpošt
ƒndpošˆğ*
’dpošt_™”©Ü
;

109 
cÚÃùiÚ_
->
	`sock‘
().
	`async_cÚÃù
(
’dpošt
,

110 
boo¡
::
	`bšd
(&
N‘wÜkR—d”
::
hªdË_cÚÃù
, 
this
,

111 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
, ++
’dpošt_™”©Ü
));

117 
¡d
::
û¼
 << 
e
.
	`mes§ge
(è<< std::
’dl
;

118 
em™
 
	`showMes§ge
(
QSŒšg
::
	`äomStdSŒšg
(
e
.
	`mes§ge
()));

120 
	}
}

123 
	gN‘wÜkR—d”
::
	$hªdË_»ad
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
) {

124 ià(
Th»ad
::
Çme
 =ğ
NULL
) {

125 
Th»ad
::
Çme
 = "NetworkReader";

127 ià(!
isAlive
) {

130 ià(!
e
) {

131 
couÁ”
 = 0;

132 
Tim”
 
t
;

133 
em™
 
	`showMes§ge
(
	`QSŒšg
("average ms…er…ackets: ") +

134 
QSŒšg
::
	`numb”
(
t
.
	`–­£d_ms
()/++
couÁ”
));

136 
Œy
{

137 
ÇoD©a
.
	`­³ndF¿me
(
»ûived
);

138 if(!
ÇoD©a
.
	`g‘IsPau£d
()) {

139 
ÇoD©a
.
	`£tCu¼’tF¿me
ÒaoD©a.
	`g‘F¿mesTÙ®
()-1);

142 
ušt64_t
 
Ï¡Ãw
 = 0;

143 
timev®
 
now
;

144 
	`g‘timeofday
(&
now
, 
NULL
);

145 
ušt64_t
 
now2
 = 
now
.
tv_£c
 * 1000000uÎ +‚ow.
tv_u£c
;

146 ià(
now2
 >ğ
Ï¡Ãw
 + 250000) {

147 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

148 
Ï¡Ãw
 = 
now2
;

150 
»ûived
.
bÏckbßrd
 = 
Ãw
 
	`BÏckbßrd
(
cÚfig
);

151 
cÚÃùiÚ_
->
	`async_»ad
(*
»ûived
.
bÏckbßrd
,

152 
boo¡
::
	`bšd
(&
N‘wÜkR—d”
::
hªdË_»ad
, 
this
,

153 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
));

154 } 
	`ÿtch
(
boo¡
::
sy¡em
::
sy¡em_”rÜ
 &
£
) {

155 
	`qDebug
() << "Error in„eceiving wireless data. " <<

156 
£
.
	`wh©
(è<< 
’dl
;

157 
em™
 
	`showMes§ge
(
£
.
	`wh©
());

161 
	`qDebug
("Error in„eceiving wireless data. Disconnected");

162 
em™
 
	`showMes§ge
("Error in dataransmission. Disconnected...");

164 
	}
}

166 
	gN‘wÜkR—d”
::
	$run
() {

167 ià(
Th»ad
::
Çme
 =ğ
NULL
) {

168 
Th»ad
::
Çme
 = "NetworkReader";

170 
F¿me
 
äame
;

171 
cu¼’tF¿me
 = 0;

172 
em™
 
	`showMes§ge
(

173 
	`Œ
("Started session with‚ao. Hit„ecordo begin stream..."));

175 
isAlive
) {

186 
cu¼’tF¿me
 = 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
();

187 ià(
cu¼’tF¿me
 !ğ
ÇoD©a
.
	`g‘F¿mesTÙ®
() - 1) {

188 
	`m¦“p
(250);

190 
	`m¦“p
(200);

193 
em™
 
	`ÃwNaoD©a
(
NULL
);

194 
	}
}

197 
	gN‘wÜkR—d”
::
	$¡İMedŸTrigg”
() {

198 ià(
isRecÜdšg
)

199 
isRecÜdšg
 = 
	`discÚÃù
();

200 
ÇoD©a
.
	`£tPau£d
(
Œue
);

201 
em™
 
	`showMes§ge
(
	`QSŒšg
("Disconnected. Hit„ecordo continue."));

202 
	}
}

204 
	gN‘wÜkR—d”
::
	$»cÜdMedŸTrigg”
() {

205 ià(!
isRecÜdšg
) {

206 
isRecÜdšg
 = 
	`cÚÃù
();

208 
ÇoD©a
.
	`£tPau£d
(
çl£
);

209 
	}
}

211 
	gN‘wÜkR—d”
::
	$£ndCommªdLšeSŒšg
(
QSŒšg
 
™em
) {

212 
¡d
::
cout
 << 
™em
.
	`toStdSŒšg
(è<< std::
’dl
;

213 
OffNaoMask_t
 
£ndšgMask
 = 
COMMAND_MASK
;

214 ià(
cÚÃùiÚ_
 && cÚÃùiÚ_->
	`sock‘
().
	`is_İ’
()) {

215 
boo¡
::
asio
::
	`wr™e
(
cÚÃùiÚ_
->
	`sock‘
(),

216 
boo¡
::
asio
::
	`bufãr
(&
£ndšgMask
,

217 (
£ndšgMask
)));

218 
cÚÃùiÚ_
->
	`sync_wr™e
(
™em
.
	`toStdSŒšg
());

220 
	}
}

222 
boŞ
 
	gN‘wÜkR—d”
::
	$discÚÃù
() {

223 
¡d
::
û¼
 << "TryØdiscÚÃù!!" << std::
’dl
;

224 
Œy
 {

225 ià(
io£rviû
)

226 
io£rviû
->
	`¡İ
();

228 ià(
ùh»ad
) {

229 
ùh»ad
->
	`još
();

230 
d–‘e
 
ùh»ad
;

231 
ùh»ad
 = 
NULL
;

234 ià(
cÚÃùiÚ_
 && cÚÃùiÚ_->
	`sock‘
().
	`is_İ’
())

235 
cÚÃùiÚ_
->
	`sock‘
().
	`şo£
();

237 ià(
cÚÃùiÚ_
) {

238 
d–‘e
 
cÚÃùiÚ_
;

239 
cÚÃùiÚ_
 = 
NULL
;

241 ià(
io£rviû
) {

242 
d–‘e
 
io£rviû
;

243 
io£rviû
 = 
NULL
;

245 ià(
»sŞv”
) {

246 
d–‘e
 
»sŞv”
;

247 
»sŞv”
 = 
NULL
;

249 ià(
qu”y
) {

250 
d–‘e
 
qu”y
;

251 
qu”y
 = 
NULL
;

253 } 
	`ÿtch
(
boo¡
::
sy¡em
::
sy¡em_”rÜ
 &
£
) {

254 
em™
 
	`showMes§ge
(
	`QSŒšg
("Could‚ot disconnecto„obot!"));

257  
çl£
;

258 
	}
}

260 
boŞ
 
	gN‘wÜkR—d”
::
	$cÚÃù
() {

261 
¡d
::
û¼
 << "TryØcÚÃù!" << std::
’dl
;

262 
Œy
 {

263 
io£rviû
 = 
Ãw
 
boo¡
::
asio
::
	`io_£rviû
();

264 
cÚÃùiÚ_
 = 
Ãw
 
	`CÚÃùiÚ
(
io£rviû
);

265 
»sŞv”
 = 
Ãw
 
boo¡
::
asio
::

::
tı
::
	`»sŞv”
(*
io£rviû
);

266 
qu”y
 = 
Ãw
 
boo¡
::
asio
::

::
tı
::
»sŞv”
::
	`qu”y
(
robÙName
.
	`toStdSŒšg
()

268 
boo¡
::
asio
::

::
tı
::
»sŞv”
::
™”©Ü
 
’dpošt_™”©Ü
 =

269 
»sŞv”
->
	`»sŞve
(*
qu”y
);

270 
boo¡
::
asio
::

::
tı
::
’dpošt
ƒndpošˆğ*
’dpošt_™”©Ü
;

271 
cÚÃùiÚ_
->
	`sock‘
().
	`async_cÚÃù
(
’dpošt
,

272 
boo¡
::
	`bšd
(&
N‘wÜkR—d”
::
hªdË_cÚÃù
, 
this
,

273 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
, ++
’dpošt_™”©Ü
));

274 
ùh»ad
 = 
Ãw
 
boo¡
::
	`th»ad
(boo¡::
	`bšd
(&boo¡::
asio
::
io_£rviû
::
run
,

275 
io£rviû
));

276 
¡d
::
û¼
 <<"CÚÃùed!" << std::
’dl
;

277 } 
	`ÿtch
(
boo¡
::
sy¡em
::
sy¡em_”rÜ
 &
£
) {

278 
em™
 
	`showMes§ge
(
	`QSŒšg
("Could‚ot connecto„obot!"));

279 
¡d
::
û¼
 << "ERROR CODE: " << 
£
.
	`wh©
(è<< std::
’dl
;

280  
çl£
;

282  
Œue
;

283 
	}
}

285 
	gN‘wÜkR—d”
::
	$wr™e
(cÚ¡ 
msg_t
 &
msg
) {

286 ià(
cÚÃùiÚ_
 && cÚÃùiÚ_->
	`sock‘
().
	`is_İ’
())

287 
io£rviû
->
	`po¡
(
boo¡
::
	`bšd
(&
N‘wÜkR—d”
::
do_wr™e
, 
this
, 
msg
));

288 
	}
}

290 
	gN‘wÜkR—d”
::
	$do_wr™e
(
msg_t
 
msg
) {

291 
boŞ
 
wr™e_š_´og»ss
 = !
wr™e_msgs_
.
	`em±y
();

292 
wr™e_msgs_
.
	`push_back
(
msg
);

293 ià(!
wr™e_š_´og»ss
) {

294 
boo¡
::
asio
::
	`async_wr™e
(
cÚÃùiÚ_
->
	`sock‘
(),

295 
boo¡
::
asio
::
	`bufãr
(&(
wr™e_msgs_
.
	`äÚt
()),

296 (
wr™e_msgs_
.
	`äÚt
())),

297 
boo¡
::
	`bšd
(&
N‘wÜkR—d”
::
hªdË_wr™e
, 
this
,

298 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
));

300 
	}
}

302 
	gN‘wÜkR—d”
::
	$hªdË_wr™e
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
) {

303 ià(!
”rÜ
) {

304 ià(!
wr™e_msgs_
.
	`em±y
()) {

305 
boo¡
::
asio
::
	`async_wr™e
(
cÚÃùiÚ_
->
	`sock‘
(),

306 
boo¡
::
asio
::
	`bufãr
(&(
wr™e_msgs_
.
	`äÚt
()),

307 (
wr™e_msgs_
.
	`äÚt
())),

308 
boo¡
::
	`bšd
(&
N‘wÜkR—d”
::
hªdË_wr™e
, 
this
,

309 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
));

310 
wr™e_msgs_
.
	`pİ_äÚt
();

313 
	`do_şo£
();

315 
	}
}

317 
	gN‘wÜkR—d”
::
	$do_şo£
() {

318 
cÚÃùiÚ_
->
	`sock‘
().
	`şo£
();

319 
	}
}

	@utils/offnao/readers/networkReader.hpp

32 #´agm¨
Úû


34 
	~<boo¡/th»ad.hµ
>

35 
	~<deque
>

36 
	~"»ad”s/»ad”.hµ
"

37 
	~"uts/CÚÃùiÚ.hµ
"

38 
	~"Œªsm™‹r/T¿nsm™‹rDefs.hµ
"

40 
št64_t
 
	tmsg_t
;

41 
	g¡d
::
	tdeque
<
	tmsg_t
> 
	tch©_mes§ge_queue
;

47 şas 
	cN‘wÜkR—d”
 : 
public
 
R—d”
 {

48 
public
:

49 
ex¶ic™
 
N‘wÜkR—d”
(cÚ¡ 
QSŒšg
 &
robÙName
, 
OffNaoMask_t
 
mask
);

50 
ex¶ic™
 
N‘wÜkR—d”
(
¡d
::
·œ
<cÚ¡ 
QSŒšg
 &,

51 
OffNaoMask_t
> 
robÙNameMask
);

52 
ex¶ic™
 
N‘wÜkR—d”
(
¡d
::
·œ
<cÚ¡ 
QSŒšg
 &,

53 
OffNaoMask_t
> 
robÙNameMask
,

54 cÚ¡ 
NaoD©a
 &
ÇoD©a
);

55 ~
N‘wÜkR—d”
();

58 
vœtu®
 
run
();

61 
wr™e
(cÚ¡ 
msg_t
 &
msg
);

62 
	m´iv©e
:

63 
OffNaoMask_t
 
mask
;

64 
	mboo¡
::
asio
::
io_£rviû
 *
io£rviû
;

67 
hªdË_cÚÃù
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
,

68 
boo¡
::
asio
::

::
tı
::
»sŞv”
::
™”©Ü
 
’dpošt_™”©Ü
);

69 
hªdË_»ad
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
& 
e
);

70 
CÚÃùiÚ
 *
	mcÚÃùiÚ_
;

72 
	mboo¡
::
th»ad
 *
ùh»ad
;

73 
F¿me
 
	m»ûived
;

75 
	mboo¡
::
asio
::

::
tı
::
»sŞv”
 *resolver;

76 
	mboo¡
::
asio
::

::
tı
::
»sŞv”
::
qu”y
 *query;

78 
boŞ
 
	misRecÜdšg
;

79 
QSŒšg
 
	mrobÙName
;

81 
boŞ
 
discÚÃù
();

82 
boŞ
 
cÚÃù
();

85 
do_wr™e
(
msg_t
 
msg
);

87 
hªdË_wr™e
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
);

89 
do_şo£
();

91 
ch©_mes§ge_queue
 
	mwr™e_msgs_
;

92 
public
 
	m¦Ùs
:

93 
vœtu®
 
¡İMedŸTrigg”
();

94 
vœtu®
 
»cÜdMedŸTrigg”
();

98 
vœtu®
 
£ndCommªdLšeSŒšg
(
QSŒšg
 
™em
);

	@utils/offnao/readers/reader.cpp

32 
	~"»ad”s/»ad”.hµ
"

33 
	~<io¡»am
>

35 
	~"uts/basic_m©hs.hµ
"

37 
	gR—d”
::
	$fÜw¬dMedŸTrigg”
() {

38 
ÇoD©a
.
	`ÃxtF¿me
();

39 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

40 
ÇoD©a
.
	`£tPau£d
(
Œue
);

41 
	}
}

43 
	gR—d”
::
	$backw¬dMedŸTrigg”
() {

44 
ÇoD©a
.
	`´evF¿me
();

45 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

46 
ÇoD©a
.
	`£tPau£d
(
Œue
);

47 
	}
}

49 
	gR—d”
::
	$·u£MedŸTrigg”
() {

50 
ÇoD©a
.
	`£tPau£d
(
Œue
);

51 
	}
}

53 
	gR—d”
::
	$¶ayMedŸTrigg”
() {

54 
ÇoD©a
.
	`£tPau£d
(
çl£
);

55 
	}
}

56 
	gR—d”
::
	$¦id”Moved
(
amouÁ
) {

57 
äame
 = 
	`round
(((
amouÁ
/100.0è* 
ÇoD©a
.
	`g‘F¿mesTÙ®
()));

58 
ÇoD©a
.
	`£tCu¼’tF¿me
(
äame
);

59 
ÇoD©a
.
	`£tPau£d
(
Œue
);

60 
	`»äeshNaoD©a
();

61 
	}
}

63 
	gR—d”
::
	$»äeshNaoD©a
() {

64 ià(
ÇoD©a
.
	`g‘F¿mesTÙ®
() > 0) {

65 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

67 
	}
}

69 
	gR—d”
::
	$¡İMedŸTrigg”
() {

70 
	}
}

72 
R—d”
::
	$»cÜdMedŸTrigg”
() {

73 
	}
}

	@utils/offnao/readers/reader.hpp

32 #´agm¨
Úû


34 
	~<QTh»ad
>

35 
	~<QObjeù
>

36 
	~<QDebug
>

37 
	~<QAùiÚ
>

38 
	~"ÇoD©a.hµ
"

39 
	~"äame.hµ
"

40 
	~"Œªsm™‹r/T¿nsm™‹rDefs.hµ
"

46 şas 
	cR—d”
 : 
public
 
QTh»ad
 {

47 
Q_OBJECT


48 
public
 
¦Ùs
:

49 
vœtu®
 
fÜw¬dMedŸTrigg”
();

50 
vœtu®
 
backw¬dMedŸTrigg”
();

51 
vœtu®
 
·u£MedŸTrigg”
();

52 
vœtu®
 
¶ayMedŸTrigg”
();

53 
vœtu®
 
¦id”Moved
(
amouÁ
);

54 
vœtu®
 
»äeshNaoD©a
();

55 
vœtu®
 
¡İMedŸTrigg”
();

56 
vœtu®
 
»cÜdMedŸTrigg”
();

60 
vœtu®
 
	$£ndCommªdLšeSŒšg
(
QSŒšg
 
™em
) {};

62 
public
:

63 
	$R—d”
(è{
	}
}

64 
	$R—d”
(cÚ¡ 
NaoD©a
 &
ÇoD©a
è: 
	$ÇoD©a
(
ÇoD©a
è{
	}
}

65 
vœtu®
 ~
	$R—d”
(è{
	}
}

67 
NaoD©a
 
ÇoD©a
;

70 
vœtu®
 
run
() = 0;

71 
vœtu®
 
	$fšishUp
(è{ 
isAlive
 = 
çl£
;
	}
}

72 
	$£tS’dšgMask
(
OffNaoMask_t
 
mask
) {

73 
this
->
mask
 = mask;

74 
	}
}

75 
	gsigÇls
:

76 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

77 
showMes§ge
(cÚ¡ 
QSŒšg
 &, 
timeout
 = 0);

81 
İ’Fe
();

82 
discÚÃùFromNao
();

83 
	g´Ùeùed
:

84 
boŞ
 
isAlive
;

85 
OffNaoMask_t
 
	gmask
;

	@utils/offnao/readers/recordReader.cpp

1 
	~"»cÜdR—d”.hµ
"

3 
	~<boo¡/¬chive/bš¬y_ßrchive.hµ
>

4 #ià
BOOST_HAS_COMPRESSION


5 
	~<boo¡/io¡»ams/f‹r/bz2.hµ
>

6 
	~<boo¡/io¡»ams/f‹r/gz.hµ
>

8 
	~<s¡»am
>

10 
	~"bs/şassif›r.hµ
"

11 
	~"bÏckbßrd/BÏckbßrd.hµ
"

12 
	~"ÇoD©a.hµ
"

13 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

15 
usšg
 
Çme¥aû
 
	g¡d
;

17 
	gRecÜdR—d”
::
	$RecÜdR—d”
(cÚ¡ 
QSŒšg
 &
feName
è: 
	$feName
(
feName
)

19 
	}
}

21 
RecÜdR—d”
::
	$RecÜdR—d”
(cÚ¡ 
QSŒšg
 &
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
) :

22 
	`R—d”
(
ÇoD©a
), 
	$feName
(
feName
)

24 
	}
}

26 
	gRecÜdR—d”
::~
	$RecÜdR—d”
()

28 
	}
}

30 
RecÜdR—d”
::
	$»ad
(cÚ¡ 
QSŒšg
 &
feName
, 
NaoD©a
 &
ÇoD©a
)

32 
¡d
::
if¡»am
 
ifs
;

33 
boo¡
::
io¡»ams
::
f‹ršg_¡»ambuf
<boo¡::io¡»ams::
šput
> 
š
;

36 
ifs
.
	`exû±iÚs
(
if¡»am
::
eofb™
 | if¡»am::
çb™
 | if¡»am::
badb™
);

37 
ifs
.
	`İ’
(
	`qPršbË
(
feName
), 
ios
::
š
 | ios::
bš¬y
);

38 #ià
BOOST_HAS_COMPRESSION


39 ià(
feName
.
	`’dsW™h
(".gz")) {

40 
š
.
	`push
(
boo¡
::
io¡»ams
::
	`gz_decom´essÜ
());

42 ià(
feName
.
	`’dsW™h
(".bz2")) {

43 
š
.
	`push
(
boo¡
::
io¡»ams
::
	`bz2_decom´essÜ
());

46 
š
.
	`push
(
ifs
);

47 
boo¡
::
¬chive
::
bš¬y_Ÿrchive
 
	`Ÿ
(
š
);

49 
NaoD©a
 
nd
;

50 
Ÿ
 & 
nd
;

51 
f
 = 0; f < 
nd
.
	`g‘F¿mesTÙ®
(); ++f) {

52 
ÇoD©a
.
	`­³ndF¿me
(
nd
.
	`g‘F¿me
(
f
));

54 
	}
}

56 
	gRecÜdR—d”
::
	$wr™e
(cÚ¡ 
QSŒšg
 &
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
)

58 
of¡»am
 
	`ofs
(
	`qPršbË
(
feName
), 
ios
::
out
 | ios::
bš¬y
 | ios::
Œunc
);

59 
boo¡
::
io¡»ams
::
f‹ršg_¡»ambuf
<boo¡::io¡»ams::
ouut
> 
out
;

60 #ià
BOOST_HAS_COMPRESSION


61 ià(
feName
.
	`’dsW™h
(".gz"))

62 
out
.
	`push
(
boo¡
::
io¡»ams
::
	`gz_com´essÜ
());

63 ià(
feName
.
	`’dsW™h
(".bz2"))

64 
out
.
	`push
(
boo¡
::
io¡»ams
::
	`bz2_com´essÜ
());

66 
out
.
	`push
(
ofs
);

67 
boo¡
::
¬chive
::
bš¬y_ßrchive
 
	`ß
(
out
);

68 
ß
 & 
ÇoD©a
;

69 
	}
}

71 
	gRecÜdR—d”
::
	$ü—‹Image
(cÚ¡ 
ušt8_t
 *
äame
, cÚ¡ 
numRow
, cÚ¡ 
numCŞ
, cÚ¡ 
QSŒšg
 
feName
)

73 
ušt8_t
 
image
[
numRow
*
numCŞ
*3];

76 
row
 = 0;„ow < 
numRow
; ++row) {

77 
cŞ
 = 0; cŞ < 
numCŞ
; ++col) {

78 
QRgb
 
rgb
 = 
CÏssif›r
::
	`yuv2rgb
(
	`g‘y
(
äame
, 
row
, 
cŞ
, 
numCŞ
),

79 
	`g‘u
(
äame
, 
row
, 
cŞ
, 
numCŞ
),

80 
	`g‘v
(
äame
, 
row
, 
cŞ
, 
numCŞ
));

81 
image
[((((
numRow
-
row
-1)*
numCŞ
)+
cŞ
)*3)+0] = 
	`qBlue
(
rgb
);

82 
image
[((((
numRow
-
row
-1)*
numCŞ
)+
cŞ
)*3)+1] = 
	`qG»’
(
rgb
);

83 
image
[((((
numRow
-
row
-1)*
numCŞ
)+
cŞ
)*3)+2] = 
	`qRed
(
rgb
);

86 
FILE
 *
dumpFe
 = 
	`fİ’
(
feName
.
	`toUtf8
().
	`cÚ¡D©a
(), "w");

91 
fesize
 = 54 + (3*
numCŞ
*
numRow
);

96 
bmpfeh—d”
[14] = {'B','M', 0,0,0,0, 0,0, 0,0, 54,0,0,0};

97 
bmpšfoh—d”
[40] = {40,0,0,0, 0,0,0,0, 0,0,0,0, 1,0, 24,0};

99 
bmpfeh—d”
[ 2] = ()(
fesize
 );

100 
bmpfeh—d”
[ 3] = ()(
fesize
>> 8);

101 
bmpfeh—d”
[ 4] = ()(
fesize
>>16);

102 
bmpfeh—d”
[ 5] = ()(
fesize
>>24);

104 
bmpšfoh—d”
[ 4] = ()Ğ
numCŞ
 );

105 
bmpšfoh—d”
[ 5] = ()Ğ
numCŞ
>> 8);

106 
bmpšfoh—d”
[ 6] = ()Ğ
numCŞ
>>16);

107 
bmpšfoh—d”
[ 7] = ()Ğ
numCŞ
>>24);

108 
bmpšfoh—d”
[ 8] = ()Ğ
numRow
 );

109 
bmpšfoh—d”
[ 9] = ()Ğ
numRow
>> 8);

110 
bmpšfoh—d”
[10] = ()Ğ
numRow
>>16);

111 
bmpšfoh—d”
[11] = ()Ğ
numRow
>>24);

114 
	`fwr™e
(
bmpfeh—d”
,1,14,
dumpFe
);

115 
	`fwr™e
(
bmpšfoh—d”
,1,40,
dumpFe
);

118 
	`fwr™e
(&
image
, 
numCŞ
*
numRow
*3, 1, 
dumpFe
);

119 
	`fæush
(
dumpFe
);

120 
	`fşo£
(
dumpFe
);

121 
	}
}

123 
	gRecÜdR—d”
::
	$dumpImages
(cÚ¡ 
QSŒšg
 &
fŞd”Name
, 
NaoD©a
 &
ÇoD©a
, 
boŞ
 
exŒaùROI
)

127 
cu¼F¿me
 = 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
();

130 
ÇoD©a
.
	`£tCu¼’tF¿me
(0);

132 
BÏckbßrd
 *
bÏckbßrd
;

134 
ušt8_t
 cÚ¡* 
tİF¿me
;

135 
ušt8_t
 cÚ¡* 
bÙF¿me
;

137 
Œue
) {

139 
bÏckbßrd
 = 
ÇoD©a
.
	`g‘Cu¼’tF¿me
().blackboard;

141 
tİF¿me
 = 
	`»adFrom
(
visiÚ
,opFrame);

142 
bÙF¿me
 = 
	`»adFrom
(
visiÚ
, botFrame);

144 ià(
tİF¿me
 =ğ
NULL
 || 
bÙF¿me
 == NULL) {

149 ià(
exŒaùROI
) {

151 
	`ü—‹Image
(<<
ROI
 
¡¬t
>>, 
»giÚ_rows
, 
»giÚ_cŞs
);

154 
	`ü—‹Image
(
tİF¿me
, 
TOP_IMAGE_ROWS
, 
TOP_IMAGE_COLS
,

155 
fŞd”Name
 + "/tİ_image_" + 
QSŒšg
::
	`numb”
(
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
()) + ".bmp");

157 
	`ü—‹Image
(
bÙF¿me
, 
BOT_IMAGE_ROWS
, 
BOT_IMAGE_COLS
,

158 
fŞd”Name
 + "/bÙ_image_" + 
QSŒšg
::
	`numb”
(
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
()) + ".bmp");

162 
´ev
 = 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
();

163 
ÇoD©a
.
	`ÃxtF¿me
();

164 ià(
´ev
 =ğ
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
()) {

170 
ÇoD©a
.
	`£tCu¼’tF¿me
(
cu¼F¿me
);

171 
	}
}

173 
	gRecÜdR—d”
::
	$run
() {

174 
Œy
 {

175 
	`»ad
(
feName
, 
ÇoD©a
);

176 } 
	`ÿtch
(cÚ¡ 
¡d
::
exû±iÚ
& 
e
) {

177 
QSŒšg
 
	`s
("Can‚ot†oad„ecord: ");

178 
em™
 
	`discÚÃùFromNao
();

179 
em™
 
	`showMes§ge
(
s
 + 
e
.
	`wh©
());

180 
em™
 
	`İ’Fe
();

183 
¡ršg¡»am
 
s
;

184 
s
 << "Finished†oading„ecord which consisted of " <<

185 
ÇoD©a
.
	`g‘F¿mesTÙ®
() << " frames.";

186 
em™
 
	`showMes§ge
(
s
.
	`¡r
().
	`c_¡r
(), 5000);

187 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

189 
cu¼’tIndex
 = 0;

190 
isAlive
 = 
Œue
;

191 
isAlive
) {

192 ià(!
ÇoD©a
.
	`g‘IsPau£d
() &&

193 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
(è<‚aoD©a.
	`g‘F¿mesTÙ®
() - 1) {

194 
ÇoD©a
.
	`ÃxtF¿me
();

195 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

196 } ià(
cu¼’tIndex
 !ğ
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
()) {

197 
em™
 
	`ÃwNaoD©a
(&
ÇoD©a
);

199 
cu¼’tIndex
 = 
ÇoD©a
.
	`g‘Cu¼’tF¿meIndex
();

200 
	`m¦“p
(500);

202 
em™
 
	`ÃwNaoD©a
(
NULL
);

203 
	}
}

	@utils/offnao/readers/recordReader.hpp

1 #´agm¨
Úû


3 
	~"»ad”.hµ
"

5 
	~<boo¡/¬chive/bš¬y_Ÿrchive.hµ
>

6 
	~<boo¡/io¡»ams/f‹ršg_¡»ambuf.hµ
>

7 
	~<f¡»am
>

8 
	~<QSŒšg
>

10 
	#BOOST_HAS_COMPRESSION
 
çl£


	)

15 şas 
	cRecÜdR—d”
 : 
public
 
R—d”
 {

16 
Q_OBJECT


17 
public
:

23 
ex¶ic™
 
RecÜdR—d”
(cÚ¡ 
QSŒšg
 &
feName
);

31 
ex¶ic™
 
RecÜdR—d”
(cÚ¡ 
QSŒšg
 &
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
);

39 
»ad
(cÚ¡ 
QSŒšg
 &
feName
, 
NaoD©a
 &
ÇoD©a
);

47 
wr™e
(cÚ¡ 
QSŒšg
 &
feName
, cÚ¡ 
NaoD©a
 &
ÇoD©a
);

57 
ü—‹Image
(cÚ¡ 
ušt8_t
 *
äame
, cÚ¡ 
numRow
, cÚ¡ 
numCŞ
, cÚ¡ 
QSŒšg
 
feName
);

65 
dumpImages
(cÚ¡ 
QSŒšg
 &
fŞd”Name
, 
NaoD©a
 &
ÇoD©a
);

67 
vœtu®
 
run
();

72 
	mvœtu®
 ~
RecÜdR—d”
();

74 
	m´iv©e
:

75 cÚ¡ 
QSŒšg
 
feName
;

	@utils/offnao/tabs/LogTab.cpp

32 
	~"LogTab.hµ
"

33 
	~<QDebug
>

35 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	gLogTab
::
	$LogTab
(cÚ¡ 
QSŒšg
 &
Çme
, cÚ¡ QSŒšg &
commªd
è: 
	`QMašWšdow
(),

38 
	`sName
(
Çme
), 
	`´oûss
(
this
), 
	$uiTab
() {

39 
uiTab
.
	`£tupUi
(
this
);

40 
QFÚt
 
	`fÚt
("Monospace");

41 
fÚt
.
	`£tStyËHšt
(
QFÚt
::
Ty³Wr™”
);

42 
uiTab
.
‹Log
->
	`£tFÚt
(
fÚt
);

44 
	`£tC’Œ®Widg‘
(
uiTab
.
‹Log
);

46 
	`cÚÃù
(
uiTab
.
cbFšd
, 
	`SIGNAL
(
	`aùiv©ed
(cÚ¡ 
QSŒšg
 &)),

47 
this
, 
	`SLOT
(
	`fšd
(cÚ¡ 
QSŒšg
 &)));

48 
	`cÚÃù
(
uiTab
.
cbFšd
, 
	`SIGNAL
(
	`ed™TextChªged
(cÚ¡ 
QSŒšg
 &)),

49 
this
, 
	`SLOT
(
	`unfšd
(cÚ¡ 
QSŒšg
 &)));

51 
	`cÚÃù
(&
´oûss
, 
	`SIGNAL
(
	`»adyR—dSnd¬dOuut
()),

52 
this
, 
	`SLOT
(
	`»adAÎSnd¬dOuut
()));

53 
	`cÚÃù
(&
´oûss
, 
	`SIGNAL
(
	`»adyR—dSnd¬dE¼Ü
()),

54 
this
, 
	`SLOT
(
	`»adAÎSnd¬dE¼Ü
()));

57 
	`cÚÃù
(&
´oûss
, 
	`SIGNAL
(
	`”rÜ
(
QProûss
::
ProûssE¼Ü
)),

58 
this
, 
	`SLOT
(
	`”rÜ
(
QProûss
::
ProûssE¼Ü
)));

59 
	`cÚÃù
(&
´oûss
, 
	`SIGNAL
(
	`fšished
(, 
QProûss
::
Ex™Stus
)),

60 
this
, 
	`SLOT
(
	`fšished
(, 
QProûss
::
Ex™Stus
)));

61 
´oûss
.
	`¡¬t
(
commªd
, 
QIODeviû
::
R—dOÆy
 | QIODeviû::
Text
);

62 
	}
}

64 cÚ¡ 
	gQSŒšg
 &
	gLogTab
::
	$Çme
() const {

65  
sName
;

66 
	}
}

68 
	gLogTab
::
	$»adAÎSnd¬dOuut
() {

69 
uiTab
.
‹Log
->
	`­³nd
(
´oûss
.
	`»adAÎSnd¬dOuut
());

70 
	}
}

72 
	gLogTab
::
	$»adAÎSnd¬dE¼Ü
() {

73 
fw
 = 
uiTab
.
‹Log
->
	`fÚtWeight
();

74 
uiTab
.
‹Log
->
	`£tFÚtWeight
(
QFÚt
::
BŞd
);

75 
uiTab
.
‹Log
->
	`­³nd
(
´oûss
.
	`»adAÎSnd¬dE¼Ü
());

76 
uiTab
.
‹Log
->
	`£tFÚtWeight
(
fw
);

77 
	}
}

79 
	gLogTab
::
	$¡©eChªged
(
QProûss
::
ProûssS‹
 
¡©e
) {

80 
	`qDebug
(è<< 
__PRETTY_FUNCTION__
 << " - " << 
¡©e
;

81 
	}
}

83 
	gLogTab
::
	$”rÜ
(
QProûss
::
ProûssE¼Ü
 
”rÜ
) {

84 
	`qDebug
(è<< 
__PRETTY_FUNCTION__
 << " - " << 
”rÜ
;

85 
	}
}

87 
	gLogTab
::
	$fšished
(
ex™Code
, 
QProûss
::
Ex™Stus
 
ex™Stus
) {

88 
	`qDebug
(è<< 
__PRETTY_FUNCTION__
 << " - " << 
ex™Code
 << " - " << 
ex™Stus
;

89 
	`»adAÎSnd¬dOuut
();

90 
	`»adAÎSnd¬dE¼Ü
();

91 
	}
}

93 
	gLogTab
::
	$fšd
(cÚ¡ 
QSŒšg
 &
‹xt
) {

94 ià(
uiTab
.
‹Log
->
	`fšd
(
‹xt
, 
QTextDocum’t
::
FšdBackw¬d
))

95 
uiTab
.
cbFšd
->
	`£tStyËSh“t
("QComboBox { background-color:†ightgreen; }");

97 
uiTab
.
cbFšd
->
	`£tStyËSh“t
("QComboBox { background-color:„ed; }");

98 
	}
}

100 
	gLogTab
::
	$unfšd
(cÚ¡ 
QSŒšg
 &
‹xt
) {

101 
uiTab
.
cbFšd
->
	`£tStyËSh“t
("QComboBox { background-color: white; }");

102 
	}
}

104 
	gLogTab
::~
	$LogTab
() {

105 
´oûss
.
	`‹rmš©e
();

106 
´oûss
.
	`wa™FÜFšished
(1000);

107 
	}
}

	@utils/offnao/tabs/LogTab.hpp

32 #´agm¨
Úû


34 
	~"ui_LogTab.h
"

35 
	~<QProûss
>

37 şas 
	cLogTab
 : 
public
 
QMašWšdow
 {

38 
Q_OBJECT


39 cÚ¡ 
QSŒšg
 
sName
;

40 
QProûss
 
	m´oûss
;

41 
	mUi
::
LogTab
 
uiTab
;

42 
	mpublic
:

43 
LogTab
(cÚ¡ 
QSŒšg
 &
Çme
, cÚ¡ QSŒšg &
commªd
);

44 
	mvœtu®
 ~
LogTab
();

45 cÚ¡ 
	mQSŒšg
 &
	$Çme
() const;

46 
public
 
¦Ùs
:

47 
	`»adAÎSnd¬dOuut
();

48 
	`»adAÎSnd¬dE¼Ü
();

49 
	`¡©eChªged
(
QProûss
::
ProûssS‹
);

50 
	`”rÜ
(
QProûss
::
ProûssE¼Ü
);

51 
	`fšished
(, 
QProûss
::
Ex™Stus
);

52 
	`fšd
(cÚ¡ 
QSŒšg
 &
‹xt
);

53 
	`unfšd
(cÚ¡ 
QSŒšg
 &
‹xt
);

	@utils/offnao/tabs/LogsTab.cpp

32 
	~"LogsTab.hµ
"

33 
	~<QDebug
>

35 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	gLogsTab
::
	$LogsTab
(
QTabWidg‘
 *
·»Á
, 
QComboBox
 *
ho¡
è: 
	$Tab
(
·»Á
) {

38 
uiLogsTab
.
	`£tupUi
(
this
);

39 
	`cÚÃù
(
ho¡
, 
	`SIGNAL
(
	`aùiv©ed
(cÚ¡ 
QSŒšg
 &)),

40 
this
, 
	`SLOT
(
	`cÚÃùToNao
(cÚ¡ 
QSŒšg
 &)));

41 
	`cÚÃù
(
uiLogsTab
.
cbDœeùÜ›s
, 
	`SIGNAL
(
	`aùiv©ed
(cÚ¡ 
QSŒšg
 &)),

42 
this
, 
	`SLOT
(
	`İ’Logs
(cÚ¡ 
QSŒšg
 &)));

43 
	`cÚÃù
(
uiLogsTab
.
cbLev–s
, 
	`SIGNAL
(
	`aùiv©ed
(cÚ¡ 
QSŒšg
 &)),

44 
this
, 
	`SLOT
(
	`chªgeLog
(cÚ¡ 
QSŒšg
 &)));

45 
	`cÚÃù
(&
logsLi¡
, 
	`SIGNAL
(
	`»adyR—dSnd¬dOuut
()),

46 
this
, 
	`SLOT
(
	`upd©eDœLi¡
()));

47 
	`cÚÃù
(&
logsLi¡
, 
	`SIGNAL
(
	`»adyR—dSnd¬dE¼Ü
()),

48 
this
, 
	`SLOT
(
	`»adAÎSnd¬dE¼Ü
()));

51 
	`cÚÃù
(&
logsLi¡
, 
	`SIGNAL
(
	`”rÜ
(
QProûss
::
ProûssE¼Ü
)),

52 
this
, 
	`SLOT
(
	`”rÜ
(
QProûss
::
ProûssE¼Ü
)));

53 
	`cÚÃù
(&
logsLi¡
, 
	`SIGNAL
(
	`fšished
(, 
QProûss
::
Ex™Stus
)),

54 
this
, 
	`SLOT
(
	`fšished
(, 
QProûss
::
Ex™Stus
)));

55 
	}
}

57 
	gLogsTab
::
	$ş—r
() {

58 
uiLogsTab
.
twLogs
->
	`ş—r
();

59 
	`fÜ—ch
 (
LogTab
 *
t
, 
vTabs
) {

60 
d–‘e
 
t
;

62 
vTabs
.
	`ş—r
();

63 
	}
}

65 
	gLogsTab
::
	$cÚÃùToNao
(cÚ¡ 
QSŒšg
 &
ÇoName
) {

66 
this
->
ÇoName
 =‚aoName;

67 
logsLi¡
.
	`‹rmš©e
();

68 
logsLi¡
.
	`wa™FÜFšished
(1000);

69 
logsLi¡
.
	`¡¬t
("ssh‚ao@" + 
ÇoName
 + " \"while†s -t /var/volatile/runswift/ && sleep 1; dorue; done\"",

70 
QIODeviû
::
R—dOÆy
 | QIODeviû::
Text
);

71 
	}
}

73 
	gLogsTab
::
	$upd©eDœLi¡
() {

74 
QSŒšgLi¡
 
ÃwLi¡
 =

75 
	`QSŒšg
(
logsLi¡
.
	`»adAÎSnd¬dOuut
()).
	`¥l™
("\n",

76 
QSŒšg
::
SkEm±yP¬ts
);

77 ià(
uiLogsTab
.
cbDœeùÜ›s
->
	`cu¼’tIndex
() == -1 ||

78 
uiLogsTab
.
cbDœeùÜ›s
->
	`couÁ
() == 0 ||

79 
vTabs
.
	`size
() == 0 ||

80 
uiLogsTab
.
twLogs
->
	`couÁ
() == 0) {

81 
uiLogsTab
.
cbDœeùÜ›s
->
	`ş—r
();

82 
uiLogsTab
.
cbDœeùÜ›s
->
	`addI‹ms
(
ÃwLi¡
);

83 
uiLogsTab
.
cbDœeùÜ›s
->
	`£tCu¼’tIndex
(0);

84 
	`İ’Logs
(
ÃwLi¡
[0]);

86 
š£¹edI‹ms
 = 0;

87 
cu¼’tIndex
 = 
uiLogsTab
.
cbDœeùÜ›s
->
	`cu¼’tIndex
();

88 
	`fÜ—ch
 (cÚ¡ 
QSŒšg
 &
dœ
, 
ÃwLi¡
)

89 ià(
uiLogsTab
.
cbDœeùÜ›s
->
	`fšdText
(
dœ
) == -1)

90 
uiLogsTab
.
cbDœeùÜ›s
->
	`š£¹I‹m
(
š£¹edI‹ms
++, 
dœ
);

91 ià(
cu¼’tIndex
 == 0 &&

92 
ÃwLi¡
[0] !ğ
uiLogsTab
.
cbDœeùÜ›s
->
	`cu¼’tText
() &&

93 
š£¹edI‹ms
) {

94 
uiLogsTab
.
cbDœeùÜ›s
->
	`£tCu¼’tIndex
(0);

95 
	`İ’Logs
(
ÃwLi¡
[0]);

98 
	}
}

100 
	gLogsTab
::
	$İ’Logs
(cÚ¡ 
QSŒšg
 &
dœName
) {

101 
LogTab
 * 
ÉCu¼’t
 = 
dyÇmic_ÿ¡
<LogTab *>(
uiLogsTab
.
twLogs
->
	`cu¼’tWidg‘
());

102 
QSŒšg
 
sCu¼’t
;

103 ià(
ÉCu¼’t
)

104 
sCu¼’t
 = 
ÉCu¼’t
->
	`Çme
();

105 
	`ş—r
();

106 
vTabs
.
	`push_back
(
Ãw
 
	`LogTab
("Perception",

107 "ssh‚ao@"+
ÇoName
+" \"uÁ sË• 1 && [ -¸/v¬/vŞ©e/runswiá/"+
dœName
+"/Perception ]; dorue; done;ail -f /var/volatile/runswift/"+dirName+"/Perception\""));

108 
vTabs
.
	`push_back
(
Ãw
 
	`LogTab
("All",

109 "ssh‚ao@"+
ÇoName
+" \" -à/v¬/vŞ©e/runswiá/"+
dœName
+"/*\""));

112 
	`fÜ—ch
 (
LogTab
 *
t
, 
vTabs
) {

113 
uiLogsTab
.
twLogs
->
	`addTab
(
t
,->
	`Çme
());

114 ià(
sCu¼’t
 =ğ
t
->
	`Çme
())

115 
uiLogsTab
.
twLogs
->
	`£tCu¼’tWidg‘
(
t
);

117 
	}
}

119 
	gLogsTab
::
	$chªgeLog
(cÚ¡ 
QSŒšg
 &
logLev–
) {

120 
em™
 
	`£ndCommªdToRobÙ
("--debug.log=" + 
logLev–
);

121 
	}
}

123 
	gLogsTab
::
	$»adAÎSnd¬dE¼Ü
() {

124 
	`qDebug
(è<< 
logsLi¡
.
	`»adAÎSnd¬dE¼Ü
();

125 
	}
}

127 
	gLogsTab
::
	$¡©eChªged
(
QProûss
::
ProûssS‹
 
¡©e
) {

128 
	`qDebug
(è<< 
__PRETTY_FUNCTION__
 << " - " << 
¡©e
;

129 
	}
}

131 
	gLogsTab
::
	$”rÜ
(
QProûss
::
ProûssE¼Ü
 
”rÜ
) {

132 
	`qDebug
(è<< 
__PRETTY_FUNCTION__
 << " - " << 
”rÜ
;

133 
	}
}

135 
	gLogsTab
::
	$fšished
(
ex™Code
, 
QProûss
::
Ex™Stus
 
ex™Stus
) {

136 
	`qDebug
(è<< 
__PRETTY_FUNCTION__
 << " - " << 
ex™Code
 << " - " << 
ex™Stus
;

137 
	`qDebug
(è<< 
logsLi¡
.
	`»adAÎSnd¬dOuut
();

138 
	`»adAÎSnd¬dE¼Ü
();

139 
	}
}

141 
	gLogsTab
::~
	$LogsTab
() {

142 
	`ş—r
();

143 
	}
}

	@utils/offnao/tabs/LogsTab.hpp

32 #´agm¨
Úû


34 
	~"b.hµ
"

35 
	~<QComboBox
>

36 
	~"LogTab.hµ
"

37 
	~"ui_LogsTab.h
"

39 şas 
	cLogsTab
 : 
public
 
Tab
 {

40 
Q_OBJECT


41 
¡d
::
veùÜ
<
LogTab
 *> 
vTabs
;

42 
	mUi
::
LogsTab
 
uiLogsTab
;

43 
ş—r
();

44 
QSŒšg
 
	mÇoName
;

45 
QProûss
 
	mlogsLi¡
;

46 
	mpublic
:

47 
LogsTab
(
QTabWidg‘
 *
·»Á
, 
QComboBox
 *
ho¡Çme
);

48 
	mvœtu®
 ~
LogsTab
();

49 
public
 
	m¦Ùs
:

50 
	$ÃwNaoD©a
(
NaoD©a
 *) {}

54 
	`cÚÃùToNao
(cÚ¡ 
QSŒšg
 &
ÇoName
);

58 
	`İ’Logs
(cÚ¡ 
QSŒšg
 &
dœName
);

62 
	`chªgeLog
(cÚ¡ 
QSŒšg
 &
logLev–
);

66 
	`upd©eDœLi¡
();

67 
	`»adAÎSnd¬dE¼Ü
();

68 
	`¡©eChªged
(
QProûss
::
ProûssS‹
);

69 
	`”rÜ
(
QProûss
::
ProûssE¼Ü
);

70 
	`fšished
(, 
QProûss
::
Ex™Stus
);

71 
sigÇls
:

72 
	`£ndCommªdToRobÙ
(
QSŒšg
 
™em
);

73 
	}
};

	@utils/offnao/tabs/PointCloud.cpp

32 
	~"PoštCloud.hµ
"

33 
	~<m©h.h
>

35 
usšg
 
Çme¥aû
 
	gqglv›w”
;

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
d¿wPošts
(
¡d
::
veùÜ
<¡d::
·œ
<
qglv›w”
::
Vec
, qglv›w”::Vec> > &
pošts
)

40 
glBegš
(
GL_POINTS
);

41 
	gi
 = 0; i < 
	gpošts
.
size
(); ++i) {

42 
glCŞÜ3fv
(
pošts
[
i
].
fœ¡
);

43 
glV”‹x3fv
(
pošts
[
i
].
£cÚd
);

45 
glEnd
();

48 
	gPoštCloud
::
	$š™
()

52 #ià
QT_VERSION
 < 0x040000

53 
	`£tHªdËrKeybßrdModif›rs
(
QGLV›w”
::
CAMERA
, 
Qt
::
AÉBu‰Ú
);

54 
	`£tHªdËrKeybßrdModif›rs
(
QGLV›w”
::
FRAME
, 
Qt
::
NoBu‰Ú
);

55 
	`£tHªdËrKeybßrdModif›rs
(
QGLV›w”
::
CAMERA
, 
Qt
::
CÚŒŞBu‰Ú
);

57 
	`£tHªdËrKeybßrdModif›rs
(
QGLV›w”
::
CAMERA
, 
Qt
::
AÉModif›r
);

58 
	`£tHªdËrKeybßrdModif›rs
(
QGLV›w”
::
FRAME
, 
Qt
::
NoModif›r
);

59 
	`£tHªdËrKeybßrdModif›rs
(
QGLV›w”
::
CAMERA
, 
Qt
::
CÚŒŞModif›r
);

62 #ifdeà
GL_RESCALE_NORMAL


63 
	`glEÇbË
(
GL_RESCALE_NORMAL
);

69 
	`£tMªuÏ‹dF¿me
(
Ãw
 
	`MªuÏ‹dF¿me
());

72 
	`glDi§bË
(
GL_LIGHT0
);

73 
	`glEÇbË
(
GL_LIGHT1
);

76 cÚ¡ 
GLæßt
 
light_amb›Á
[4] = {1.0, 1.0, 1.0, 1.0};

79 cÚ¡ 
GLæßt
 
light_¥ecuÏr
[4] = {0.0, 0.0, 0.0, 0.0};

80 cÚ¡ 
GLæßt
 
light_diffu£
[4] = {0.0, 0.0, 0.0, 0.0};

82 
	`glLightf
Ğ
GL_LIGHT1
, 
GL_SPOT_EXPONENT
, 3.0);

83 
	`glLightf
Ğ
GL_LIGHT1
, 
GL_SPOT_CUTOFF
, 100.0);

84 
	`glLightf
Ğ
GL_LIGHT1
, 
GL_CONSTANT_ATTENUATION
, 0.1f);

85 
	`glLightf
Ğ
GL_LIGHT1
, 
GL_LINEAR_ATTENUATION
, 0.3f);

86 
	`glLightf
Ğ
GL_LIGHT1
, 
GL_QUADRATIC_ATTENUATION
, 0.3f);

87 
	`glLightfv
(
GL_LIGHT1
, 
GL_AMBIENT
, 
light_amb›Á
);

88 
	`glLightfv
(
GL_LIGHT1
, 
GL_SPECULAR
, 
light_¥ecuÏr
);

89 
	`glLightfv
(
GL_LIGHT1
, 
GL_DIFFUSE
, 
light_diffu£
);

98 
	`ÿm”a
()->
	`£tZClpšgCÛffic›Á
(5.0);

100 
	`£tSûÃBoundšgBox
(
	`Vec
(0.0, 0.0, 0.0), Vec(1.0, 1.0, 1.0));

101 
	`ÿm”a
()->
	`showEÁœeSûÃ
();

102 
	}
}

104 
	gPoštCloud
::
	$d¿w
()

110 
	`glPushM©rix
();

113 
	`glMuÉM©rixd
(
	`mªuÏ‹dF¿me
()->
	`m©rix
());

119 cÚ¡ 
Vec
 
ÿm”aPos
 = 
	`ÿm”a
()->
	`pos™iÚ
();

120 cÚ¡ 
GLæßt
 
pos
[4] = {
ÿm”aPos
[0], cameraPos[1], cameraPos[2], 0.0};

121 
	`glLightfv
(
GL_LIGHT1
, 
GL_POSITION
, 
pos
);

124 
	`glLightfv
(
GL_LIGHT1
, 
GL_SPOT_DIRECTION
, 
	`ÿm”a
()->
	`v›wDœeùiÚ
());

127 
	`d¿wAxis
();

131 
	`d¿wPošts
(
pošts
);

134 
	`glPİM©rix
();

135 
	}
}

137 
QSŒšg
 
	gPoštCloud
::
	$h–pSŒšg
() const

139 
QSŒšg
 
	`‹xt
("<h2>M‡‚ i… u†‡ƒ d F„‡ mƒ</h2>");

140 
‹xt
 += "A <i>ManipulatedFrame</i> converts mouse gestures into <i>Frame</i> displacements. ";

141 
‹xt
 += "Inhisƒxample, such‡n object defineshe…osition ofhe spiralhat can hence be manipulated.<br><br>";

142 
‹xt
 += "Addingwo†ines of code willhen‡llow youo movehe objects of ";

143 
‹xt
 += "your scene usinghe mouse. The button bindings ofhe <i>ManipulatedFrame</i> ";

144 
‹xt
 += "arehe samehan forhe camera. Spinning is…ossible.<br><br>";

145 
‹xt
 += "Default key bindings have been changed inhisƒxample :…ress <b>Control</b> ";

146 
‹xt
 += "while movinghe mouseo movehe camera instead ofhe ManipulatedFrame.";

147  
‹xt
;

148 
	}
}

	@utils/offnao/tabs/PointCloud.hpp

32 #´agm¨
Úû


34 
	~<QGLV›w”/qglv›w”.h
>

36 şas 
	cPoštCloud
 : 
public
 
QGLV›w”
 {

37 
´Ùeùed
:

38 
vœtu®
 
š™
();

39 
vœtu®
 
d¿w
();

40 
vœtu®
 
QSŒšg
 
	$h–pSŒšg
() const;

41 
public
:

46 
¡d
::
veùÜ
<¡d::
·œ
<
qglv›w”
::
Vec
, qglv›w”::Vec> > 
pošts
;

	@utils/offnao/tabs/cameraPoseTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<qpushbu‰Ú.h
>

35 
	~<QFeDŸlog
>

36 
	~<QDebug
>

37 
	~<QPaš‹r
>

38 
	~<QLše
>

39 
	~<QLab–
>

40 
	~<QPošt
>

41 
	~<QMou£Ev’t
>

42 
	~<QVBoxLayout
>

43 
	~<QRadioBu‰Ú
>

44 
	~<QTextEd™
>

45 
	~<veùÜ
>

46 
	~<io¡»am
>

47 
	~<ut™y
>

48 
	~<s¡»am
>

49 
	~<boo¡/num”ic/ubÏs/m©rix.hµ
>

50 
	~<boo¡/num”ic/ubÏs/io.hµ
>

51 
	~"ÿm”aPo£Tab.hµ
"

52 
	~"uts/m©rix_h–³rs.hµ
"

53 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

54 
	~"uts/basic_m©hs.hµ
"

55 
	~"uts/SPLDefs.hµ
"

56 
	~"³rû±iÚ/behaviour/Kšem©icsC®ib¿tiÚSkl.hµ
"

57 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

58 
	~"bÏckbßrd/BÏckbßrd.hµ
"

60 
	~"uts/CPÏÃCŞours.hµ
"

62 
usšg
 
Çme¥aû
 
	g¡d
;

63 
usšg
 
Çme¥aû
 
	gboo¡
::
num”ic
::
ubÏs
;

65 
	gCam”aPo£Tab
::
	$Cam”aPo£Tab
(
QTabWidg‘
 *
·»Á
,

66 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
) {

67 
	`š™M’u
(
m’uB¬
);

68 
	`š™
();

69 
this
->
visiÚ
 = vision;

70 
this
->
·»Á
 =…arent;

73 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2, 
FIELD_WIDTH
/2, 0));

74 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2, -
FIELD_WIDTH
/2, 0));

76 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LINE_WIDTH
/2, 
FIELD_WIDTH
/2, 0));

77 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LINE_WIDTH
/2, -
FIELD_WIDTH
/2, 0));

79 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
 +

80 
FIELD_LINE_WIDTH
/2, 
GOAL_BOX_WIDTH
/2, 0));

81 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
 +

82 
FIELD_LINE_WIDTH
/2, -
GOAL_BOX_WIDTH
/2, 0));

84 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
 -

85 
FIELD_LINE_WIDTH
/2, 
GOAL_BOX_WIDTH
/2, 0));

86 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
 -

87 
FIELD_LINE_WIDTH
/2, -
GOAL_BOX_WIDTH
/2, 0));

89 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
,

90 
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

91 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2,

92 
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

94 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
,

95 
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

96 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2,

97 
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

100 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
,

101 -
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

102 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2,

103 -
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

105 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
,

106 -
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

107 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LENGTH
/2,

108 -
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

112 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
 +

113 
FIELD_LINE_WIDTH
/2, 
GOAL_BOX_WIDTH
/2, 0));

114 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
 +

115 
FIELD_LINE_WIDTH
/2, -
GOAL_BOX_WIDTH
/2, 0));

117 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
 -

118 
FIELD_LINE_WIDTH
/2, 
GOAL_BOX_WIDTH
/2, 0));

119 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
 -

120 
FIELD_LINE_WIDTH
/2, -
GOAL_BOX_WIDTH
/2, 0));

124 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
,

125 
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

126 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2,

127 
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

129 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
,

130 
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

131 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2,

132 
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

135 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
,

136 -
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

137 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2,

138 -
GOAL_BOX_WIDTH
/2 + 
FIELD_LINE_WIDTH
/2, 0));

140 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2 + 
GOAL_BOX_LENGTH
,

141 -
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

142 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LENGTH
/2,

143 -
GOAL_BOX_WIDTH
/2 - 
FIELD_LINE_WIDTH
/2, 0));

145 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 - 
FIELD_LINE_WIDTH
,

146 
FIELD_LINE_WIDTH
/2, 0));

147 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 + 
FIELD_LINE_WIDTH
,

148 
FIELD_LINE_WIDTH
/2, 0));

150 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 - 
FIELD_LINE_WIDTH
,

151 -
FIELD_LINE_WIDTH
/2, 0));

152 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 + 
FIELD_LINE_WIDTH
,

153 -
FIELD_LINE_WIDTH
/2, 0));

156 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 - 
FIELD_LINE_WIDTH
/2,

157 -
FIELD_LINE_WIDTH
, 0));

158 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 - 
FIELD_LINE_WIDTH
/2,

159 +
FIELD_LINE_WIDTH
, 0));

161 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 + 
FIELD_LINE_WIDTH
/2,

162 -
FIELD_LINE_WIDTH
, 0));

163 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
MARKER_CENTER_X
 + 
FIELD_LINE_WIDTH
/2,

164 +
FIELD_LINE_WIDTH
, 0));

166 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2, 0));

167 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2, 0));

169 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2, 0));

170 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2, 0));

172 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2, 0));

173 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2, 0));

175 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2, 0));

176 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(-
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2, 0));

180 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2 + FIELD_LINE_WIDTH, 0));

181 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2 + FIELD_LINE_WIDTH, 0));

183 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2 - FIELD_LINE_WIDTH, 0));

184 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, 
FIELD_WIDTH
/2 - FIELD_LINE_WIDTH, 0));

186 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2 + FIELD_LINE_WIDTH, 0));

187 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2 + FIELD_LINE_WIDTH, 0));

189 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 + 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2 - FIELD_LINE_WIDTH, 0));

190 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
FIELD_LINE_WIDTH
/2 - 
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2 - FIELD_LINE_WIDTH, 0));

193 
PARTS
 = 20;

194 
i
 = 0; i < 
PARTS
; i++) {

195 
ªgË
 = (
i
 * 360 / 
PARTS
è* 
M_PI
/180.0;

196 
n_ªgË
 = ((
i
+1è* 360 / 
PARTS
è* 
M_PI
/180.0;

198 
sx
 = 
	`cos
(
ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 +

199 
FIELD_LINE_WIDTH
/2);

200 
sy
 = 
	`sš
(
ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 +

201 
FIELD_LINE_WIDTH
/2);

203 
nx
 = 
	`cos
(
n_ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 +

204 
FIELD_LINE_WIDTH
/2);

205 
ny
 = 
	`sš
(
n_ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 +

206 
FIELD_LINE_WIDTH
/2);

207 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
sx
, 
sy
, 0));

208 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
nx
, 
ny
, 0));

210 
sx
 = 
	`cos
(
ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 -

211 
FIELD_LINE_WIDTH
/2);

212 
sy
 = 
	`sš
(
ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 -

213 
FIELD_LINE_WIDTH
/2);

215 
nx
 = 
	`cos
(
n_ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 -

216 
FIELD_LINE_WIDTH
/2);

217 
ny
 = 
	`sš
(
n_ªgË
è* (
CENTER_CIRCLE_DIAMETER
/2.0 -

218 
FIELD_LINE_WIDTH
/2);

219 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
sx
, 
sy
, 0));

220 
f›ldLšes
.
	`push_back
(
	`ü—‹Pošt
(
nx
, 
ny
, 0));

222 
	}
}

225 
	gCam”aPo£Tab
::
	$š™M’u
(
QM’uB¬
 *
m’uB¬
) {

226 
	}
}

228 
Cam”aPo£Tab
::
	$š™
() {

229 
Ïyout
 = 
Ãw
 
	`QGridLayout
();

230 
this
->
	`£tLayout
(
Ïyout
);

234 
imagePixm­
 = 
	`QPixm­
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
);

235 
imagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

236 
ÿmLab–
 = 
Ãw
 
	`QLab–
();

237 
ÿmLab–
->
	`£tPixm­
(
imagePixm­
);

239 
Ïyout
->
	`addWidg‘
(
ÿmLab–
, 0, 0, 1, 1);

241 
İtiÚsLayout
 = 
Ãw
 
	`QGridLayout
();

242 
Ïyout
->
	`addLayout
(
İtiÚsLayout
, 0, 1, 1, 1, 
Qt
::
AlignTİ
);

244 
š¡ruùiÚSŒšg
 += "1) Place„obot on…enalty spot\n";

245 
š¡ruùiÚSŒšg
 += "2) Face„obots feet‡nd headowards far goal\n";

246 
š¡ruùiÚSŒšg
 += "3) Check imageo see if field†ines match\n";

247 
š¡ruùiÚSŒšg
 += "4) Turnhe heado check more field†ines\n";

248 
š¡ruùiÚSŒšg
 += "5) Adjust offset ifhey do‚ot match\n";

249 
š¡ruùiÚSŒšg
 += "6) Update config file for„obot whenhey match\n";

251 
QLab–
 *
š¡ruùiÚsBox
 = 
Ãw
 
	`QLab–
(
š¡ruùiÚSŒšg
);

252 
İtiÚsLayout
->
	`addWidg‘
(
š¡ruùiÚsBox
, 0, 0, 1, 1);

254 
QGridLayout
 *
cÚfigu»Layout
 = 
Ãw
 
	`QGridLayout
();

255 
off£tYawTİLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

256 
off£tP™chTİLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

257 
off£tRŞlTİLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

259 
off£tYawBÙtomLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

260 
off£tP™chBÙtomLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

261 
off£tRŞlBÙtomLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

262 
off£tBodyP™chLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

264 
off£tYawTİLab–
->
	`£tMaximumSize
(50, 30);

265 
off£tP™chTİLab–
->
	`£tMaximumSize
(50, 30);

266 
off£tRŞlTİLab–
->
	`£tMaximumSize
(50, 30);

268 
off£tYawBÙtomLab–
->
	`£tMaximumSize
(50, 30);

269 
off£tP™chBÙtomLab–
->
	`£tMaximumSize
(50, 30);

270 
off£tRŞlBÙtomLab–
->
	`£tMaximumSize
(50, 30);

271 
off£tBodyP™chLab–
->
	`£tMaximumSize
(50, 30);

274 
ÿlib¿tiÚOuutBox
 = 
Ãw
 
	`QTextEd™
("");

275 
off£tBodyP™chLab–
 = 
Ãw
 
	`QLšeEd™
("0.0");

277 
ÿlib¿tiÚOuutBox
->
	`£tMaximumSize
(400, 400);

278 
off£tBodyP™chLab–
->
	`£tMaximumSize
(50, 30);

280 
QPushBu‰Ú
 *
£ndBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("send");

281 
whichCam”a2
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`Œ
("BOTTOM Camera"));

282 
whichCam”a3
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`Œ
("TOP Camera"));

283 
isC®ib¿tšg
 = 
Ãw
 
	`QCheckBox
(
	`Œ
("Autocalibrate"));

284 
isC®ib¿tšg
->
	`£tChecked
(
çl£
);

285 
whichCam”a2
->
	`£tChecked
(
Œue
);

286 
QVBoxLayout
 *
vbox
 = 
Ãw
 QVBoxLayout;

287 
vbox
->
	`addWidg‘
(
whichCam”a2
);

288 
vbox
->
	`addWidg‘
(
whichCam”a3
);

289 
vbox
->
	`addWidg‘
(
isC®ib¿tšg
);

290 
vbox
->
	`addWidg‘
(
ÿlib¿tiÚOuutBox
);

296 
cÚfigu»Layout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Bottom Camera Yaw"), 0, 0, 1, 1);

297 
cÚfigu»Layout
->
	`addWidg‘
(
off£tYawBÙtomLab–
, 0, 1, 1, 1);

298 
cÚfigu»Layout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Bottom Camera Pitch"), 1, 0, 1, 1);

299 
cÚfigu»Layout
->
	`addWidg‘
(
off£tP™chBÙtomLab–
, 1, 1, 1, 1);

301 
cÚfigu»Layout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Bottom Roll Pitch"), 2, 0, 1, 1);

302 
cÚfigu»Layout
->
	`addWidg‘
(
off£tRŞlBÙtomLab–
, 2, 1, 1, 1);

305 
cÚfigu»Layout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Top Camera Yaw"), 3, 0, 1, 1);

306 
cÚfigu»Layout
->
	`addWidg‘
(
off£tYawTİLab–
, 3, 1, 1, 1);

308 
cÚfigu»Layout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Top Camera Pitch"), 4, 0, 1, 1);

309 
cÚfigu»Layout
->
	`addWidg‘
(
off£tP™chTİLab–
, 4, 1, 1, 1);

311 
cÚfigu»Layout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Top Roll Pitch"), 5, 0, 1, 1);

312 
cÚfigu»Layout
->
	`addWidg‘
(
off£tRŞlTİLab–
, 5, 1, 1, 1);

315 
cÚfigu»Layout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Body Pitch"), 6, 0, 1, 1);

316 
cÚfigu»Layout
->
	`addWidg‘
(
off£tBodyP™chLab–
, 6, 1, 1, 1);

318 
cÚfigu»Layout
->
	`addWidg‘
(
£ndBu‰Ú
, 7, 0, 1, 2);

319 
cÚfigu»Layout
->
	`addLayout
(
vbox
, 8, 0, 1, 2, 
Qt
::
AlignTİ
);

320 
İtiÚsLayout
->
	`addLayout
(
cÚfigu»Layout
, 1, 0, 1, 1,

321 
Qt
::
AlignLeá
);

323 
	`cÚÃù
(
£ndBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`upd©eOff£t
()));

324 
	`cÚÃù
(
isC®ib¿tšg
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`isC®ib¿tšgSlÙ
()));

327 
ÿmLab–
->
	`£tAlignm’t
(
Qt
::
AlignTİ
);

328 
ÿmLab–
->
	`£tMšimumSize
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
);

329 
ÿmLab–
->
	`£tMaximumSize
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
);

330 
ÿmLab–
->
	`š¡®lEv’tF‹r
(
this
);

348 
	}
}

350 
	gCam”aPo£Tab
::
	$»d¿w
() {

351 
boŞ
 
tİ
 = 
whichCam”a3
->
	`isChecked
();

352 ià(
tİ
) {

353 
Ï¡R’d”šg
 = 
	`QImage
(
TOP_IMAGE_COLS
,

354 
TOP_IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

356 
Ï¡R’d”šg
 = 
	`QImage
(
BOT_IMAGE_COLS
,

357 
BOT_IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

359 
	`d¿wImage
(&
Ï¡R’d”šg
);

360 ià(
tİ
) {

361 
imagePixm­
 = 
	`QPixm­
(
QPixm­
::
	`äomImage
(

362 
Ï¡R’d”šg
.
	`sÿËd
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
)));

364 
imagePixm­
 = 
	`QPixm­
(
QPixm­
::
	`äomImage
(
Ï¡R’d”šg
));

366 
	`d¿wOv”Ïys
(&
imagePixm­
);

368 
ÿmLab–
->
	`£tPixm­
(
imagePixm­
);

369 
P¬am‘”s
<> 
p
 = 
	`»adFrom
(
kšem©ics
, 
·¿m‘”s
);

370 
¡d
::
¡ršg
 
s
 = 
Kšem©icsC®ib¿tiÚSkl
::
	`´štP¬ams
(
p
);

371 
ÿlib¿tiÚOuutBox
->
	`£tText
(
	`QSŒšg
(
s
.
	`c_¡r
()));

372 
	}
}

376 
	gCam”aPo£Tab
::
	$d¿wImage
(
QImage
 *
image
) {

378 
s_row
, 
s_cŞ
;

379 ià(
whichCam”a3
->
	`isChecked
()) {

380 
row
 = 0;„ow < 
TOP_IMAGE_ROWS
; ++row) {

381 
cŞ
 = 0; cŞ < 
TOP_IMAGE_COLS
; ++col) {

382 
s_row
 = 
row
 / 
TOP_SALIENCY_DENSITY
;

383 
s_cŞ
 = 
cŞ
 / 
TOP_SALIENCY_DENSITY
;

384 
image
->
	`£tPix–
(
cŞ
, 
row
,

385 
CPLANE_COLOURS
[
tİS®›ncy
[
s_cŞ
][
s_row
]].
	`rgb
());

389 
row
 = 0;„ow < 
BOT_IMAGE_ROWS
; ++row) {

390 
cŞ
 = 0; cŞ < 
BOT_IMAGE_COLS
; ++col) {

391 
s_row
 = 
row
 / 
BOT_SALIENCY_DENSITY
;

392 
s_cŞ
 = 
cŞ
 / 
BOT_SALIENCY_DENSITY
;

393 
image
->
	`£tPix–
(
cŞ
, 
row
,

394 
CPLANE_COLOURS
[
bÙS®›ncy
[
s_cŞ
][
s_row
]].
	`rgb
());

398 
	}
}

400 
	gboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
Cam”aPo£Tab
::
	$ü—‹Pošt
(
a
,

401 
b
,

402 
c
) {

403 
m©rix
<> 
	`pošt
(4, 1);

404 
	`pošt
(0, 0èğ
a
;

405 
	`pošt
(1, 0èğ
b
;

406 
	`pošt
(2, 0èğ
c
;

407 
	`pošt
(3, 0) = 1;

408  
pošt
;

409 
	}
}

411 
	gCam”aPo£Tab
::
	$d¿wOv”Ïys
(
QPixm­
 *
pixm­
) {

412 
QPaš‹r
 
	`·š‹r
(
pixm­
);

416 
QPošt
 
	`pos™iÚ
(-
MARKER_CENTER_X
, 0);

420 
h—dšg
 = 
	`DEG2RAD
(0);

422 ià(!
bÏckbßrd
) ;

425 
S’sÜV®ues
 
£nsÜV®ues
;

426 
i
 = 0; i < 
Jošts
::
NUMBER_OF_JOINTS
; ++i) {

427 
£nsÜV®ues
.
jošts
.
ªgËs
[
i
] = 0;

429 
£nsÜV®ues
.
jošts
.
ªgËs
[
Jošts
::
H—dP™ch
] = 
	`DEG2RAD
(-10);

430 if(
bÏckbßrd
) {

431 
£nsÜV®ues
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
);

432 
kšem©ics
.
·¿m‘”s
 = 
	`»adFrom
(kinematics,…arameters);

434 
kšem©ics
.
	`£tS’sÜV®ues
(
£nsÜV®ues
);

435 
Kšem©ics
::
Chaš
 
foÙ
 = 
kšem©ics
.
	`d‘”mšeSuµÜtChaš
();

437 
kšem©ics
.
	`upd©eDHChaš
();

438 
m©rix
<> 
c2w
;

439 ià(
whichCam”a3
->
	`isChecked
()) {

440 
c2w
 = 
kšem©ics
.
	`ü—‹Cam”aToWÜldT¿nsfÜm
(
foÙ
, 
Œue
);

442 
c2w
 = 
kšem©ics
.
	`ü—‹Cam”aToWÜldT¿nsfÜm
(
foÙ
, 
çl£
);

447 
m©rix
<> 
w2c
 = 
c2w
;

449 
	`šv”tM©rix
(
c2w
, 
w2c
);

450 
m©rix
<> 
	`ùe¡
(4, 1);

451 
	`ùe¡
(0, 0) = 0;

452 
	`ùe¡
(1, 0) = 0;

453 
	`ùe¡
(2, 0) = 0;

454 
	`ùe¡
(3, 0) = 1;

457 
m©rix
<> 
	`pm©rix
(4, 4);

458 
	`pm©rix
(0, 0) = 1;

459 
	`pm©rix
(0, 1) = 0;

460 
	`pm©rix
(0, 2) = 0;

461 
	`pm©rix
(0, 3èğ-
pos™iÚ
.
	`x
();

463 
	`pm©rix
(1, 0) = 0;

464 
	`pm©rix
(1, 1) = 1;

465 
	`pm©rix
(1, 2) = 0;

466 
	`pm©rix
(1, 3èğ-
pos™iÚ
.
	`y
();

468 
	`pm©rix
(2, 0) = 0;

469 
	`pm©rix
(2, 1) = 0;

470 
	`pm©rix
(2, 2) = 1;

471 
	`pm©rix
(2, 3) = 0;

473 
	`pm©rix
(3, 0) = 0;

474 
	`pm©rix
(3, 1) = 0;

475 
	`pm©rix
(3, 2) = 0;

476 
	`pm©rix
(3, 3) = 1;

478 
m©rix
<> 
rm©rix
 = 
	`rÙ©eZM©rix
(
h—dšg
);

479 
w2c
 = 
	`´od
(w2c, 
rm©rix
);

480 
w2c
 = 
	`´od
(w2c, 
pm©rix
);

482 
m©rix
<> 
cm©rix
 = 
w2c
;

486 
ex
 = 0;

487 
ey
 = 0;

488 
ez
 = 1.0/
	`n
(
IMAGE_HFOV
/2);

489 
m©rix
<> 
	`´ojeùiÚ
(4, 4);

490 
	`´ojeùiÚ
(0, 0) = 1;

491 
	`´ojeùiÚ
(0, 1) = 0;

492 
	`´ojeùiÚ
(0, 2) = 0;

493 
	`´ojeùiÚ
(0, 3èğ-
ex
;

495 
	`´ojeùiÚ
(1, 0) = 0;

496 
	`´ojeùiÚ
(1, 1) = 1;

497 
	`´ojeùiÚ
(1, 2) = 0;

498 
	`´ojeùiÚ
(1, 3èğ-
ey
;

500 
	`´ojeùiÚ
(2, 0) = 0;

501 
	`´ojeùiÚ
(2, 1) = 0;

502 
	`´ojeùiÚ
(2, 2) = 1;

503 
	`´ojeùiÚ
(2, 3) = 0;

505 
	`´ojeùiÚ
(3, 0) = 0;

506 
	`´ojeùiÚ
(3, 1) = 0;

507 
	`´ojeùiÚ
(3, 2èğ1.0/
ez
;

508 
	`´ojeùiÚ
(3, 3) = 0;

510 
m©rix
<> 
ŒªsfÜm
 = 
	`´od
(
´ojeùiÚ
, 
w2c
);

528 
¡d
::
veùÜ
<
m©rix
<> > 
imageLšes
;

529 
i
 = 0; i < 
f›ldLšes
.
	`size
(); i++) {

532 
m©rix
<> 
pix–
 = 
	`´od
(
ŒªsfÜm
, 
f›ldLšes
[
i
]);

535 
	`pix–
(0, 0è/ğ
	`ABS
(pixel(3, 0));

536 
	`pix–
(1, 0è/ğ
	`ABS
(pixel(3, 0));

537 
	`pix–
(2, 0) = 0;

541 
xsÿË
 = 
BOT_IMAGE_COLS
/2;

542 
ysÿË
 = 
BOT_IMAGE_ROWS
/2;

543 
	`pix–
(0, 0èğÕix–(0, 0)è* 
xsÿË
 + xscale;

544 
	`pix–
(1, 0èğÕix–(1, 0)è* 
xsÿË
 + 
ysÿË
;

547 
imageLšes
.
	`push_back
(
pix–
);

549 
i
 = 0; i < 
f›ldLšes
.
	`size
(); i += 2) {

550 ià(
imageLšes
[
i
](3, 0) >= 0 || imageLines[i+1](3, 0) >= 0) {

551 
·š‹r
.
	`d¿wLše
(
imageLšes
[
i
](0, 0),

552 
imageLšes
[
i
](1, 0),

553 
imageLšes
[
i
+1](0, 0),

554 
imageLšes
[
i
+1](1, 0));

558 
	}
}

562 
	gCam”aPo£Tab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

563 ià(!
ÇoD©a
 || !ÇoD©a->
	`g‘Cu¼’tF¿me
().
bÏckbßrd
) {

564 
imagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

565 
ÿmLab–
->
	`£tPixm­
(
imagePixm­
);

566 
bÏckbßrd
 = 
NULL
;

568 ià(
·»Á
->
	`cu¼’tIndex
(è=ğ·»Á->
	`šdexOf
(
this
)) {

569 
bÏckbßrd
 = 
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard;

570 ià(
	`»adFrom
(
visiÚ
, 
tİS®›ncy
è&&„—dFrom(visiÚ, 
bÙS®›ncy
)) {

571 
	`memıy
(
tİS®›ncy
, 
	`»adFrom
(
visiÚ
,opSaliency),

572 
TOP_SALIENCY_ROWS
*
TOP_SALIENCY_COLS
*(
CŞour
));

573 
	`memıy
(
bÙS®›ncy
, 
	`»adFrom
(
visiÚ
, botSaliency),

574 
BOT_SALIENCY_ROWS
*
BOT_SALIENCY_COLS
*(
CŞour
));

575 
	`»d¿w
();

579 
	}
}

581 
	gCam”aPo£Tab
::
	$»d¿wSlÙ
() {

582 
	`»d¿w
();

583 
	}
}

585 
	gCam”aPo£Tab
::
	$isC®ib¿tšgSlÙ
() {

586 ià(
bÏckbßrd
) {

587 
¡ršg¡»am
 
ss
;

588 
ss
 << ("--kinematics.isCalibrating=");

589 ià(
isC®ib¿tšg
->
	`isChecked
()) {

590 
ss
 << "1";

592 
ss
 << "0";

594 
em™
 
	`£ndCommªdToRobÙ
(
	`QSŒšg
(
ss
.
	`¡r
().
	`c_¡r
()));

596 
	}
}

597 
	gCam”aPo£Tab
::
	$upd©eOff£t
() {

598 ià(
bÏckbßrd
) {

599 
¡d
::
veùÜ
<¡d::
¡ršg
> 
commªds
;

600 
commªds
.
	`push_back
(
	`ü—‹CommªdSŒšg
("--kšem©ics.ÿm”aYawBÙtom=", 
off£tYawBÙtomLab–
->
	`‹xt
().
	`toStdSŒšg
()));

601 
commªds
.
	`push_back
(
	`ü—‹CommªdSŒšg
("--kšem©ics.ÿm”aP™chBÙtom=", 
off£tP™chBÙtomLab–
->
	`‹xt
().
	`toStdSŒšg
()));

602 
commªds
.
	`push_back
(
	`ü—‹CommªdSŒšg
("--kšem©ics.ÿm”aRŞlBÙtom=", 
off£tRŞlBÙtomLab–
->
	`‹xt
().
	`toStdSŒšg
()));

603 
commªds
.
	`push_back
(
	`ü—‹CommªdSŒšg
("--kšem©ics.ÿm”aYawTİ=", 
off£tYawTİLab–
->
	`‹xt
().
	`toStdSŒšg
()));

604 
commªds
.
	`push_back
(
	`ü—‹CommªdSŒšg
("--kšem©ics.ÿm”aP™chTİ=", 
off£tP™chTİLab–
->
	`‹xt
().
	`toStdSŒšg
()));

605 
commªds
.
	`push_back
(
	`ü—‹CommªdSŒšg
("--kšem©ics.ÿm”aRŞlTİ=", 
off£tRŞlTİLab–
->
	`‹xt
().
	`toStdSŒšg
()));

606 
commªds
.
	`push_back
(
	`ü—‹CommªdSŒšg
("--kšem©ics.bodyP™ch=", 
off£tBodyP™chLab–
->
	`‹xt
().
	`toStdSŒšg
()));

615 
¡d
::
¡ršg
 
commªd
;

616 
i
 = 0; i < 
commªds
.
	`size
(); i++) {

617 
commªd
 +ğ
commªds
[
i
];

618 
commªd
 += " ";

620 
em™
 
	`£ndCommªdToRobÙ
(
	`QSŒšg
(
commªd
.
	`c_¡r
()));

622 
	}
}

624 
	g¡d
::
¡ršg
 
Cam”aPo£Tab
::
	$ü—‹CommªdSŒšg
(
¡d
::
¡ršg
 
¬gum’t
, std::¡ršg 
mes§ge
) {

625 
¡ršg¡»am
 
ss
;

626 
ss
 << 
¬gum’t
;

627 
ss
 << 
mes§ge
;

628  
ss
.
	`¡r
();

629 
	}
}

631 
	gCam”aPo£Tab
::
	$šcOff£t
() {

632 
	}
}

634 
Cam”aPo£Tab
::
	$decOff£t
() {

635 
	}
}

	@utils/offnao/tabs/cameraPoseTab.hpp

32 #´agm¨
Úû


34 
	~<QM’uB¬
>

35 
	~<QWidg‘
>

36 
	~<QObjeù
>

37 
	~<QEv’t
>

38 
	~<QLšeEd™
>

39 
	~<QTextEd™
>

40 
	~<QCheckBox
>

41 
	~<QGridLayout
>

42 
	~<QVBoxLayout
>

43 
	~<QRadioBu‰Ú
>

44 
	~<QLab–
>

45 
	~<QCheckBox
>

46 
	~<QTabWidg‘
>

47 
	~<c¡dio
>

48 
	~<veùÜ
>

49 
	~<¡ršg
>

50 
	~"bs/b.hµ
"

51 
	~"medŸPª–.hµ
"

53 
	~"../../../robÙ/³rû±iÚ/kšem©ics/Kšem©ics.hµ
"

54 
	~"../../../robÙ/³rû±iÚ/kšem©ics/Po£.hµ
"

60 şas 
	cCam”aPo£Tab
 : 
public
 
Tab
 {

61 
Q_OBJECT


62 
public
:

63 
Cam”aPo£Tab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

65 
	m´iv©e
:

66 
š™
();

67 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

69 
QGridLayout
 *
	mÏyout
;

70 
QGridLayout
 *
	mİtiÚsLayout
;

72 
QImage
 
	mÏ¡R’d”šg
;

74 
QPixm­
 
	mimagePixm­
;

75 
QLab–
 *
	mÿmLab–
;

76 
QTextEd™
 *
	mÿlib¿tiÚOuutBox
;

77 
QLšeEd™
 *
	moff£tYawTİLab–
;

78 
QLšeEd™
 *
	moff£tP™chTİLab–
;

79 
QLšeEd™
 *
	moff£tRŞlTİLab–
;

81 
QLšeEd™
 *
	moff£tYawBÙtomLab–
;

82 
QLšeEd™
 *
	moff£tP™chBÙtomLab–
;

83 
QLšeEd™
 *
	moff£tRŞlBÙtomLab–
;

85 
QLšeEd™
 *
	moff£tBodyP™chLab–
;

87 
QRadioBu‰Ú
 *
	mwhichCam”a2
;

88 
QRadioBu‰Ú
 *
	mwhichCam”a3
;

89 
QCheckBox
 *
	misC®ib¿tšg
;

92 
	mcu¼’tOff£tX
;

93 
	mcu¼’tOff£tY
;

94 
	mcu¼’tBodyP™chOff£t
;

97 
	m¡d
::
¡ršg
 
ü—‹CommªdSŒšg
(
¡d
::¡ršg 
¬gum’t
, std::¡ršg 
mes§ge
);

99 
»d¿w
();

102 
d¿wImage
(
QImage
 *
image
);

105 
d¿wOv”Ïys
(
QPixm­
 *
pixm­
);

107 
Kšem©ics
 
	mkšem©ics
;

109 
	mboo¡
::
num”ic
::
ubÏs
::
m©rix
<> 
ü—‹Pošt
(
a
, 
b
,

110 
c
);

112 
	m¡d
::
veùÜ
<
boo¡
::
num”ic
::
ubÏs
::
m©rix
<> > 
f›ldLšes
;

113 
BÏckbßrd
 *
	mbÏckbßrd
;

114 
CŞour
 
	mtİS®›ncy
[
TOP_SALIENCY_COLS
][
TOP_SALIENCY_ROWS
];

115 
CŞour
 
	mbÙS®›ncy
[
BOT_SALIENCY_COLS
][
BOT_SALIENCY_ROWS
];

117 
QSŒšg
 
	mš¡ruùiÚSŒšg
;

118 
public
 
	m¦Ùs
:

119 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

120 
»d¿wSlÙ
();

121 
šcOff£t
();

122 
decOff£t
();

123 
upd©eOff£t
();

124 
isC®ib¿tšgSlÙ
();

125 
	msigÇls
:

126 
£ndCommªdToRobÙ
(
QSŒšg
 
™em
);

	@utils/offnao/tabs/cameraTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QFeDŸlog
>

35 
	~<QDebug
>

36 
	~<QPaš‹r
>

37 
	~<QMou£Ev’t
>

39 
	~<io¡»am
>

40 
	~<uni¡d.h
>

41 
	~"bÏckbßrd/BÏckbßrd.hµ
"

42 
	~"ÿm”aTab.hµ
"

43 
	~"yuvHi¡og¿m.hµ
"

44 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

45 
	~"³rû±iÚ/visiÚ/ÿm”a/NaoCam”a.hµ
"

47 
usšg
 
Çme¥aû
 
	g¡d
;

49 
__u32
 
cÚŒŞIds
[
NUM_CONTROLS
];

52 cÚ¡ * 
	gCÚŒŞNames
[
NUM_CONTROLS
] = {

85 cÚ¡ 
	gcNUM_CAM_CONTROLS
 = (
CÚŒŞNames
)/(*);

86 
__u16
 
	gcÚŒŞMš
[
NUM_CONTROLS
] = {

103 
__u16
 
	gcÚŒŞMax
[
NUM_CONTROLS
] = {

119 
	scÚŒŞA‰ribu‹s
 {

120 
__u32
 
	mcÚŒŞ
;

121 
¡ršg
 
	mÇme
;

122 
__s32
 
	mmš
;

123 
__s32
 
	mmax
;

124 
__s32
 
	mcu¼’t
;

125 
boŞ
 
	mŒyInü—£
;

129 
cÚŒŞA‰ribu‹s
 
	gCÚŒŞV®ues
[] = {

131 {
V4L2_CID_EXPOSURE
, "Exposu»", 1, 140, 0, 
çl£
},

132 {
V4L2_CID_BRIGHTNESS
, "BrighŠess", 0, 255, 0, 
çl£
},

133 {
V4L2_CID_CONTRAST
, "CÚŒa¡", 16, 64, 0, 
çl£
},

134 {
V4L2_CID_GAIN
, "Gaš", 35, 255, 0, 
çl£
},

136 {
V4L2_CID_SATURATION
, "S©u¿tiÚ", 60, 255, 0, 
çl£
},

137 {
V4L2_CID_SHARPNESS
, "Sh¬²ess", 0, 7, 0, 
çl£
},

138 {
V4L2_CID_BACKLIGHT_COMPENSATION
, "BacklighˆCom³n§tiÚ", 0, 4, 0, 
çl£
},

139 {
V4L2_CID_DO_WHITE_BALANCE
, "Wh™B®ªû", 2700, 6500, 0, 
çl£
},

142 cÚ¡ 
	gcNUM_CONTROL_ATTRIBUTES
 = (
CÚŒŞV®ues
)/(
cÚŒŞA‰ribu‹s
);

144 
	gCam”aTab
::
	$Cam”aTab
(
QTabWidg‘
 *
·»Á
,

145 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
) {

146 
	`š™
();

147 
this
->
visiÚ
 = vision;

148 
cu¼’tF¿me
 = 
NULL
;

149 
tİF¿me
 = 
NULL
;

150 
bÙF¿me
 = 
NULL
;

151 
this
->
·»Á
 =…arent;

152 
äamesSšûRe£t
 = 
INT_MAX
;

154 
numLoÿlMax
 = 0;

155 
	}
}

157 
	gCam”aTab
::
	$š™
() {

158 
i
;

161 
Ïyout
 = 
Ãw
 
	`QGridLayout
();

162 
this
->
	`£tLayout
(
Ïyout
);

165 
i
 = 0; i < 
NUM_IMG_TYPES
; i++) {

167 
imagePixm­s
[
i
] = 
	`QPixm­
(320, 240);

168 
imagePixm­s
[
i
].
	`fl
(
Qt
::
d¬kG¿y
);

169 
imageLab–s
[
i
] = 
Ãw
 
	`QLab–
();

170 
imageLab–s
[
i
]->
	`£tPixm­
(
imagePixm­s
[i]);

173 
imageLab–s
[
i
]->
	`£tAlignm’t
(
Qt
::
AlignTİ
);

174 
imageLab–s
[
i
]->
	`£tMšimumSize
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
);

175 
imageLab–s
[
i
]->
	`£tMaximumSize
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
);

179 
Ïyout
->
	`addWidg‘
(
imageLab–s
[
CAMERA
], 0,0,1,1);

181 
Ïyout
->
	`addWidg‘
(&
poštCloud
, 1,0,1,1);

182 
Ïyout
->
	`addWidg‘
(
imageLab–s
[
YUV
], 0,1,1,1);

186 
QVBoxLayout
 *
cÚŒŞLayout
 = 
Ãw
 
	`QVBoxLayout
();

191 
QGroupBox
 *
ÿm”aBox
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("Camera"));

192 
QVBoxLayout
 *
ÿm”aGroupLayout
 = 
Ãw
 
	`QVBoxLayout
();

193 
ÿm”aBox
->
	`£tLayout
(
ÿm”aGroupLayout
);

194 
cÚŒŞLayout
->
	`addWidg‘
(
ÿm”aBox
);

195 
ÿm”aGroupLayout
->
	`£tAlignm’t
(
Qt
::
AlignTİ
);

197 
tİCam
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`QSŒšg
("Tİ Cam”a"), 
ÿm”aBox
);

198 
bÙtomCam
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`QSŒšg
("BÙtom Cam”a"), 
ÿm”aBox
);

199 
tİCam
->
	`£tChecked
(
Œue
);

200 
ÿm”aGroupLayout
->
	`addWidg‘
(
tİCam
);

201 
ÿm”aGroupLayout
->
	`addWidg‘
(
bÙtomCam
);

203 
	`cÚÃù
(
tİCam
, 
	`SIGNAL
(
	`toggËd
(
boŞ
)), 
this
, 
	`SLOT
(
	`toggËChªge
()));

204 
	`cÚÃù
(
bÙtomCam
, 
	`SIGNAL
(
	`toggËd
(
boŞ
)), 
this
, 
	`SLOT
(
	`toggËChªge
()));

207 
QGroupBox
 *
cÚŒŞsBox
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("Camera Controls"));

208 
QGridLayout
 *
cÚŒŞsGroupLayout
 = 
Ãw
 
	`QGridLayout
();

209 
cÚŒŞsBox
->
	`£tLayout
(
cÚŒŞsGroupLayout
);

210 
cÚŒŞLayout
->
	`addWidg‘
(
cÚŒŞsBox
);

213 
i
 = 0; i < 
cNUM_CAM_CONTROLS
-1; i++) {

217 ià(
	`¡rcmp
(
CÚŒŞNames
[
i
],"Exposure Auto") == 0) {

218 if(
i
 != 2){

219 
QLab–
 *
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
CÚŒŞNames
[
i
]);

220 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
ÇmeLab–
, 
i
 * 6, 0, 3, 1);

221 
QCheckBox
 *
checkbox
 = 
Ãw
 
	`QCheckBox
(
this
);

222 
checkbox
->
	`£tCheckabË
(
Œue
);

223 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
checkbox
, 
i
 *6, 3, 3, 1);

224 
exposu»CÚŒŞ
 = 
i
;

225 
i
++;

227 
QLab–
 *
’ameLab–
 = 
Ãw
 
	`QLab–
(
CÚŒŞNames
[
i
]);

228 
QPushBu‰Ú
 *
decBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("-");

229 
decBu‰Ú
->
	`£tMaximumSize
(30,30);

230 
QLšeEd™
 *
cu¼’tV®ue
 =

231 
Ãw
 
	`QLšeEd™
(
QSŒšg
::
	`numb”
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]));

232 
QPushBu‰Ú
 *
šcBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("+");

233 
šcBu‰Ú
->
	`£tMaximumSize
(30,30);

234 
QSlid”
 *
¦id”
 = 
Ãw
 
	`QSlid”
Ğ
Qt
::
HÜizÚl
,
this
);

235 
¦id”
->
	`£tMaximum
(
cÚŒŞMax
[
i
]);

236 
¦id”
->
	`£tMšimum
(
cÚŒŞMš
[
i
]);

237 
¦id”
->
	`£tT¿ckšg
(
Œue
);

238 
¦id”
->
	`£tSlid”Pos™iÚ
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]);

239 
Cam”aBu‰ÚHªdËr
* 
cbh
 = 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
NULL
, 
cu¼’tV®ue
, NULL);

240 
v®ueIÅutBoxes
.
	`push_back
(
cbh
);

241 
	`cÚÃù
(
decBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

242 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
decBu‰Ú
, 
cu¼’tV®ue
, 
¦id”
),

243 
	`SLOT
(
	`şicked
(
boŞ
)));

244 
	`cÚÃù
(
šcBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

245 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
šcBu‰Ú
, 
cu¼’tV®ue
, 
¦id”
),

246 
	`SLOT
(
	`şicked
(
boŞ
)));

247 
	`cÚÃù
(
cu¼’tV®ue
, 
	`SIGNAL
(
	`ed™šgFšished
()),

248 
cbh
, 
	`SLOT
(
	`şicked
()));

249 
	`cÚÃù
(
¦id”
, 
	`SIGNAL
(
	`v®ueChªged
()),

250 
Ãw
 
	`Slid”HªdËr
(
this
, 
i
, 
¦id”
, 
cu¼’tV®ue
),

251 
	`SLOT
(
	`£tV®ue
()));

252 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
’ameLab–
, 
i
 * 6, 0, 3, 1);

253 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
decBu‰Ú
, 
i
 * 6, 2, 3, 1);

254 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
cu¼’tV®ue
, 
i
 * 6, 3, 3, 1);

255 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
šcBu‰Ú
, 
i
 * 6, 4, 3, 1);

256 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
¦id”
,(
i
*6)+3,0,3,5);

257 
i
++;

259 
QLab–
 *
gÇmeLab–
 = 
Ãw
 
	`QLab–
(
CÚŒŞNames
[
i
]);

260 
QPushBu‰Ú
 *
decBu‰Ú2
 = 
Ãw
 
	`QPushBu‰Ú
("-");

261 
decBu‰Ú2
->
	`£tMaximumSize
(30,30);

262 
QLšeEd™
 *
cu¼’tV®ue2
 =

263 
Ãw
 
	`QLšeEd™
(
QSŒšg
::
	`numb”
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]));

264 
QPushBu‰Ú
 *
šcBu‰Ú2
 = 
Ãw
 
	`QPushBu‰Ú
("+");

265 
šcBu‰Ú2
->
	`£tMaximumSize
(30,30);

266 
QSlid”
 *
¦id”2
 = 
Ãw
 
	`QSlid”
Ğ
Qt
::
HÜizÚl
,
this
);

267 
¦id”2
->
	`£tMaximum
(
cÚŒŞMax
[
i
]);

268 
¦id”2
->
	`£tMšimum
(
cÚŒŞMš
[
i
]);

269 
¦id”2
->
	`£tT¿ckšg
(
Œue
);

270 
¦id”2
->
	`£tSlid”Pos™iÚ
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]);

271 
Cam”aBu‰ÚHªdËr
* 
cbh2
 = 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
NULL
, 
cu¼’tV®ue2
, NULL);

272 
v®ueIÅutBoxes
.
	`push_back
(
cbh2
);

273 
	`cÚÃù
(
decBu‰Ú2
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

274 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
decBu‰Ú2
, 
cu¼’tV®ue2
, 
¦id”2
),

275 
	`SLOT
(
	`şicked
(
boŞ
)));

276 
	`cÚÃù
(
šcBu‰Ú2
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

277 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
šcBu‰Ú2
, 
cu¼’tV®ue2
, 
¦id”2
),

278 
	`SLOT
(
	`şicked
(
boŞ
)));

279 
	`cÚÃù
(
cu¼’tV®ue2
, 
	`SIGNAL
(
	`ed™šgFšished
()),

280 
cbh
, 
	`SLOT
(
	`şicked
()));

281 
	`cÚÃù
(
¦id”2
, 
	`SIGNAL
(
	`v®ueChªged
()),

282 
Ãw
 
	`Slid”HªdËr
(
this
, 
i
, 
¦id”2
, 
cu¼’tV®ue2
),

283 
	`SLOT
(
	`£tV®ue
()));

284 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
gÇmeLab–
, 
i
 * 6, 0, 3, 1);

285 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
decBu‰Ú2
, 
i
 * 6, 2, 3, 1);

286 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
cu¼’tV®ue2
, 
i
 * 6, 3, 3, 1);

287 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
šcBu‰Ú2
, 
i
 * 6, 4, 3, 1);

288 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
¦id”2
,(
i
*6)+3,0,3,5);

289 
	`cÚÃù
(
checkbox
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),
Ãw
 
	`CheckboxHªdËr
(
this
, 
¦id”
,
decBu‰Ú
,
cu¼’tV®ue
,
šcBu‰Ú
,
exposu»CÚŒŞ
),
	`SLOT
(
	`toggËS‹
(bool)));

290 
	`cÚÃù
(
checkbox
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),
Ãw
 
	`CheckboxHªdËr
(
this
, 
¦id”2
,
decBu‰Ú2
,
cu¼’tV®ue2
,
šcBu‰Ú2
,
exposu»CÚŒŞ
),
	`SLOT
(
	`toggËS‹
(bool)));

293 } ià(
	`¡rcmp
(
CÚŒŞNames
[
i
],"Auto White Balance") == 0){

294 
QLab–
 *
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
CÚŒŞNames
[
i
]);

295 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
ÇmeLab–
, (
cNUM_CAM_CONTROLS
-1) *6, 0, 3, 1);

296 
QCheckBox
 *
checkbox
 = 
Ãw
 
	`QCheckBox
(
this
);

297 
checkbox
->
	`£tCheckabË
(
Œue
);

298 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
checkbox
, (
cNUM_CAM_CONTROLS
-1) *6, 3, 3, 1);

299 
wh™eb®toggË
 = 
i
;

300 
i
 = 
cNUM_CAM_CONTROLS
-1;

301 
QLab–
 *
wÇmeLab–
 = 
Ãw
 
	`QLab–
(
CÚŒŞNames
[
i
]);

302 
QPushBu‰Ú
 *
decBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("-");

303 
decBu‰Ú
->
	`£tMaximumSize
(30,30);

304 
QLšeEd™
 *
cu¼’tV®ue
 =

305 
Ãw
 
	`QLšeEd™
(
QSŒšg
::
	`numb”
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]));

306 
QPushBu‰Ú
 *
šcBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("+");

307 
šcBu‰Ú
->
	`£tMaximumSize
(30,30);

308 
QSlid”
 *
¦id”
 = 
Ãw
 
	`QSlid”
Ğ
Qt
::
HÜizÚl
,
this
);

309 
¦id”
->
	`£tMaximum
(
cÚŒŞMax
[
i
]);

310 
¦id”
->
	`£tMšimum
(
cÚŒŞMš
[
i
]);

311 
¦id”
->
	`£tT¿ckšg
(
Œue
);

312 
¦id”
->
	`£tSlid”Pos™iÚ
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]);

313 
Cam”aBu‰ÚHªdËr
* 
cbh
 = 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
NULL
, 
cu¼’tV®ue
, NULL);

314 
v®ueIÅutBoxes
.
	`push_back
(
cbh
);

315 
	`cÚÃù
(
decBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

316 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
decBu‰Ú
, 
cu¼’tV®ue
, 
¦id”
),

317 
	`SLOT
(
	`şicked
(
boŞ
)));

318 
	`cÚÃù
(
šcBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

319 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
šcBu‰Ú
, 
cu¼’tV®ue
, 
¦id”
),

320 
	`SLOT
(
	`şicked
(
boŞ
)));

321 
	`cÚÃù
(
cu¼’tV®ue
, 
	`SIGNAL
(
	`ed™šgFšished
()),

322 
cbh
, 
	`SLOT
(
	`şicked
()));

323 
	`cÚÃù
(
¦id”
, 
	`SIGNAL
(
	`v®ueChªged
()),

324 
Ãw
 
	`Slid”HªdËr
(
this
, 
i
, 
¦id”
, 
cu¼’tV®ue
),

325 
	`SLOT
(
	`£tV®ue
()));

326 
i
++;

327 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
wÇmeLab–
, 
i
 * 6, 0, 3, 1);

329 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
decBu‰Ú
, 
i
 * 6, 2, 3, 1);

330 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
cu¼’tV®ue
, 
i
 * 6, 3, 3, 1);

331 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
šcBu‰Ú
, 
i
 * 6, 4, 3, 1);

332 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
¦id”
,(
i
*6)+3,0,3,5);

333 
	`cÚÃù
(
checkbox
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),
Ãw
 
	`CheckboxHªdËr
(
this
, 
¦id”
,
decBu‰Ú
,
cu¼’tV®ue
,
šcBu‰Ú
,
wh™eb®toggË
),
	`SLOT
(
	`toggËS‹
(bool)));

334 
i
 = 
wh™eb®toggË
;

337 } ià(
	`¡rcmp
(
CÚŒŞNames
[
i
],"Horizontal Flip") == 0||

338 
	`¡rcmp
(
CÚŒŞNames
[
i
],"Vertical Flip") == 0) {

339 
QLab–
 *
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
CÚŒŞNames
[
i
]);

340 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
ÇmeLab–
, 
i
 * 4, 0, 3, 1);

341 
QCheckBox
 *
checkbox
 = 
Ãw
 
	`QCheckBox
(
this
);

342 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
checkbox
, 
i
 * 4, 3, 3, 1);

343 
	`cÚÃù
(
checkbox
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),
Ãw
 
	`CheckboxHªdËr
(
this
, 
NULL
,NULL,NULL,NULL,
i
),
	`SLOT
(
	`toggËS‹
(bool)));

345 
QLab–
 *
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
CÚŒŞNames
[
i
]);

347 
QPushBu‰Ú
 *
decBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("-");

348 
decBu‰Ú
->
	`£tMaximumSize
(30,30);

349 
QLšeEd™
 *
cu¼’tV®ue
 =

350 
Ãw
 
	`QLšeEd™
(
QSŒšg
::
	`numb”
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]));

352 
QPushBu‰Ú
 *
šcBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("+");

353 
šcBu‰Ú
->
	`£tMaximumSize
(30,30);

355 
QSlid”
 *
¦id”
 = 
Ãw
 
	`QSlid”
Ğ
Qt
::
HÜizÚl
,
this
);

356 
¦id”
->
	`£tMaximum
(
cÚŒŞMax
[
i
]);

357 
¦id”
->
	`£tMšimum
(
cÚŒŞMš
[
i
]);

358 
¦id”
->
	`£tT¿ckšg
(
Œue
);

359 
¦id”
->
	`£tSlid”Pos™iÚ
(
cÚŒŞV®ues
[
TOP_CAMERA
][
i
]);

360 
Cam”aBu‰ÚHªdËr
* 
cbh
 = 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
NULL
, 
cu¼’tV®ue
, NULL);

361 
v®ueIÅutBoxes
.
	`push_back
(
cbh
);

362 
	`cÚÃù
(
decBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

363 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
decBu‰Ú
, 
cu¼’tV®ue
, 
¦id”
),

364 
	`SLOT
(
	`şicked
(
boŞ
)));

365 
	`cÚÃù
(
šcBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

366 
Ãw
 
	`Cam”aBu‰ÚHªdËr
(
this
, 
i
, 
šcBu‰Ú
, 
cu¼’tV®ue
, 
¦id”
),

367 
	`SLOT
(
	`şicked
(
boŞ
)));

368 
	`cÚÃù
(
cu¼’tV®ue
, 
	`SIGNAL
(
	`ed™šgFšished
()),

369 
cbh
, 
	`SLOT
(
	`şicked
()));

370 
	`cÚÃù
(
¦id”
, 
	`SIGNAL
(
	`v®ueChªged
()),

371 
Ãw
 
	`Slid”HªdËr
(
this
, 
i
, 
¦id”
, 
cu¼’tV®ue
),

372 
	`SLOT
(
	`£tV®ue
()));

373 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
ÇmeLab–
, 
i
 * 6, 0, 3, 1);

375 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
decBu‰Ú
, 
i
 * 6, 2, 3, 1);

376 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
cu¼’tV®ue
, 
i
 * 6, 3, 3, 1);

377 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
šcBu‰Ú
, 
i
 * 6, 4, 3, 1);

378 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
¦id”
,(
i
*6)+3,0,3,5);

384 
i
++;

385 
i
++;

387 
QPushBu‰Ú
 *
lßdV®uesBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("Load Values");

388 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
lßdV®uesBu‰Ú
, 
i
 * 6, 0, 3, 1);

389 
	`cÚÃù
(
lßdV®uesBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)), 
this
, 
	`SLOT
(
	`v®ueF‘ch”
()));

392 
QPushBu‰Ú
 *
autoTuÃBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("Auto Tune");

393 
cÚŒŞsGroupLayout
->
	`addWidg‘
(
autoTuÃBu‰Ú
, 
i
 * 6, 2, 3, 3);

394 
	`cÚÃù
(
autoTuÃBu‰Ú
, 
	`SIGNAL
(
	`şicked
(
boŞ
)), 
this
, 
	`SLOT
(
	`autoTuÃr
()));

396 
Ïyout
->
	`addLayout
(
cÚŒŞLayout
, 0,2,1,1);

399 
be¡EÁrİy
 = 0.0;

400 
glob®Be¡EÁrİy
 = 0.0;

401 
autoTuÃOn
 = 
çl£
;

402 
cu¼’tCam”a
 = 
TOP_CAMERA
;

403 
ÿm”aToggËd
 = 
çl£
;

404 
	}
}

407 
	gCam”aTab
::
	$toggËChªge
() {

408 
ÿm”aToggËd
 = 
Œue
;

409 ià(
tİCam
->
	`isChecked
()) {

410 
cu¼’tCam”a
 = 
TOP_CAMERA
;

412 
cu¼’tCam”a
 = 
BOTTOM_CAMERA
;

414 if((
tİF¿me
!ğ
NULL
è&& (
bÙF¿me
 != NULL)){

415 
	`upd©eCam”aV®ues
();

417 
	}
}

419 
	gCam”aTab
::
	$»d¿w
() {

420 
QImage
 
image
;

421 
imageRows
, 
imageCŞs
;

422 cÚ¡ 
ušt8_t
* 
äame
;

424 ià(
cu¼’tCam”a
 =ğ
TOP_CAMERA
) {

425 
image
 = 
	`QImage
(
TOP_IMAGE_COLS
, 
TOP_IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

426 
äame
 = 
tİF¿me
;

427 
imageRows
 = 
TOP_IMAGE_ROWS
;

428 
imageCŞs
 = 
TOP_IMAGE_COLS
;

430 
image
 = 
	`QImage
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

431 
äame
 = 
bÙF¿me
;

432 
imageRows
 = 
BOT_IMAGE_ROWS
;

433 
imageCŞs
 = 
BOT_IMAGE_COLS
;

436 
poštCloud
.
pošts
.
	`»size
(0);

438 ià(
tİF¿me
 && 
bÙF¿me
) {

440 
row
 = 0;„ow < 
imageRows
; ++row) {

441 
cŞ
 = 0; cŞ < 
imageCŞs
; ++col) {

442 
QRgb
 
rgb
 = 
	`g‘RGB
(
cŞ
, 
row
, 
äame
, 
imageCŞs
);

443 
image
.
	`£tPix–
(
cŞ
, 
row
, 
rgb
);

444 
r
, 
g
, 
b
;

445 
QCŞÜ
::
	`äomRgb
(
rgb
).
	`g‘Rgb
(&
r
, &
g
, &
b
);

446 
poštCloud
.
pošts
.
	`push_back
(
	`make_·œ
(
qglv›w”
::
	`Vec
(
r
 / 255.0,

447 
g
 / 255.0,

448 
b
 / 255.0),

449 
qglv›w”
::
Vec


450 (
	`g‘y
(
äame
, 
row
, 
cŞ
) / 255.0,

451 
	`g‘u
(
äame
, 
row
, 
cŞ
) / 255.0,

452 
	`g‘v
(
äame
, 
row
, 
cŞ
) / 255.0)));

457 ià(
autoTuÃOn
 || 
ÿm”aToggËd
) {

458 
	`upd©eCam”aV®ues
();

459 
ÿm”aToggËd
 = 
çl£
;

463 
image
.
	`fl
(
Qt
::
d¬kG¿y
);

466 
QPixm­
 
imagePixm­
 = 
	`QPixm­
(QPixm­::
	`äomImage
(
image
.
	`sÿËd
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
)));

468 
imageLab–s
[
CAMERA
]->
	`£tPixm­
(
imagePixm­
);

472 
YUVHi¡og¿m
 
	`yuvHi¡og¿m
(0x00000000U, 0x00ffffffU);

475 
row
 = 0;„ow < 
imageRows
; ++row) {

476 
cŞ
 = 0; cŞ < 
imageCŞs
; ++col) {

477 
YUVV®ue
 = 0x00ffffff &

478 ((
	`g‘y
(
äame
, 
row
, 
cŞ
) << 16) |

479 (
	`g‘u
(
äame
, 
row
, 
cŞ
) << 8) |

480 
	`g‘v
(
äame
, 
row
, 
cŞ
));

483 
yuvHi¡og¿m
.
	`addD©­ošt
(
YUVV®ue
);

488 
imagePixm­s
[
YUV
].
	`fl
(
Qt
::
d¬kG¿y
);

490 
yuvHi¡og¿m
.
	`d¿wHi¡og¿m
(
imagePixm­s
[
YUV
], ()(
IMAGE_COLS
/2), ()(
IMAGE_ROWS
/2), 
YUVHi¡og¿m
::
eYUV
);

492 
imageLab–s
[
YUV
]->
	`£tPixm­
(
imagePixm­s
[YUV]);

494 ià(
autoTuÃOn
) {

496 
	`tuÃV®ue
(
	`g‘EÁrİyV®ue
());

498 
	}
}

500 
boŞ
 
	gCam”aTab
::
	$outOfBounds
(
row
, 
cŞ
) {

501 
imageRows
, 
imageCŞs
;

502 ià(
cu¼’tCam”a
 =ğ
TOP_CAMERA
) {

503 
imageRows
 = 
TOP_IMAGE_ROWS
;

504 
imageCŞs
 = 
TOP_IMAGE_COLS
;

506 
imageRows
 = 
BOT_IMAGE_ROWS
;

507 
imageCŞs
 = 
BOT_IMAGE_COLS
;

510 ià(
row
 < 0 ||„ow > 
imageRows
) {

511  
Œue
;

514 ià(
cŞ
 < 0 || cŞ > 
imageCŞs
) {

515  
Œue
;

518  
çl£
;

519 
	}
}

522 
	gCam”aTab
::
	$g‘EÁrİyV®ue
() {

525 ià(
äamesSšûRe£t
 < 3) {

529 
imageRows
, 
imageCŞs
;

530 cÚ¡ 
ušt8_t
* 
äame
;

531 
numCÜ»ù
 = 0;

534 ià(
cu¼’tCam”a
 =ğ
TOP_CAMERA
) {

535 
äame
 = 
tİF¿me
;

536 
imageRows
 = 
TOP_IMAGE_ROWS
;

537 
imageCŞs
 = 
TOP_IMAGE_COLS
;

539 
äame
 = 
bÙF¿me
;

540 
imageRows
 = 
BOT_IMAGE_ROWS
;

541 
imageCŞs
 = 
BOT_IMAGE_COLS
;

544 
row
 = 0;„ow < 
imageRows
; ++row) {

545 
cŞ
 = 0; cŞ < 
imageCŞs
; ++col) {

547 
y
 = 
	`g‘y
(
äame
, 
row
, 
cŞ
);

548 
u
 = 
	`g‘u
(
äame
, 
row
, 
cŞ
);

549 
v
 = 
	`g‘v
(
äame
, 
row
, 
cŞ
);

552 ià(160 <ğ
y
 && y <= 255 &&

553 120 <ğ
u
 && u <= 155 &&

554 95 <ğ
v
 && v <= 130) {

555 
numCÜ»ù
++;

559 ià(55 <ğ
y
 && y <= 85 &&

560 46 <ğ
u
 && u <= 120 &&

561 90 <ğ
v
 && v <= 115) {

562 
numCÜ»ù
++;

567  
numCÜ»ù
;

568 
	}
}

572 
	gCam”aTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

573 ià(!
ÇoD©a
 || !ÇoD©a->
	`g‘Cu¼’tF¿me
().
bÏckbßrd
) {

574 
tİF¿me
 = 
NULL
;

575 
bÙF¿me
 = 
NULL
;

578 
BÏckbßrd
 *
bÏckbßrd
 = 
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard;

579 
tİCam”aS‘tšgs
 = 
	`»adFrom
(
visiÚ
,topCameraSettings);

580 
bÙCam”aS‘tšgs
 = 
	`»adFrom
(
visiÚ
,botCameraSettings);

581 ià(((
tİF¿me
 = 
	`»adFrom
(
visiÚ
,İF¿me)è!ğ
NULL
è&& ((
bÙF¿me
 =„eadFrom(vision, botFrame)) != NULL)) {

582 ià(
·»Á
->
	`cu¼’tIndex
(è=ğ·»Á->
	`šdexOf
(
this
)) {

584 ià(
cu¼’tCam”a
 =ğ
TOP_CAMERA
) {

585 
cu¼’tS‘tšgs
 = 
	`»adFrom
(
visiÚ
, 
tİCam”aS‘tšgs
);

587 
cu¼’tS‘tšgs
 = 
	`»adFrom
(
visiÚ
, 
bÙCam”aS‘tšgs
);

589 
	`»d¿w
();

594 
	}
}

597 
	gCam”aTab
::
	$upd©eCam”aV®ues
() {

606 
Cam”aS‘tšgs
 
cu¼’tS‘tšg
;

607 ià(
cu¼’tCam”a
 =ğ
TOP_CAMERA
){

608 
cu¼’tS‘tšg
 = 
tİCam”aS‘tšgs
;

610 
cu¼’tS‘tšg
 = 
bÙCam”aS‘tšgs
;

612 
i
 = 0;

613 
veùÜ
<
Cam”aBu‰ÚHªdËr
*>::
™”©Ü
 
™
 = 
v®ueIÅutBoxes
.
	`begš
(); iˆ!ğv®ueIÅutBoxes.
	`’d
(); ++it) {

614 
Cam”aBu‰ÚHªdËr
 *
cbh
 = *
™
;

615 
i
){

618 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
brighŠess
);

622 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
cÚŒa¡
);

626 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
§tu¿tiÚ
);

630 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
hue
);

634 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
sh¬²ess
);

638 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
wh™eB®ªû
);

643 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
backlightCom³n§tiÚ
);

647 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
exposu»
);

652 
cbh
->
	`£tV®ue
(
cu¼’tS‘tšg
.
gaš
);

655 
i
++;

658 
	}
}

660 
	gCam”aTab
::
£tCÚŒŞs
(cÚ¡ 
veùÜ
<
v4l2_cÚŒŞ
> &
cÚŒŞs
){

661 
¡ršg
 
£ËùedCam
 = (
tİCam
->
isChecked
() ? "top" : "bot");

662 
Cam”aS‘tšgs
 *
	gcu¼’tS‘tšg
;

663 
¡ršg¡»am
 
	gss
;

664 if(
	gtİCam
->
isChecked
()){

665 
	gcu¼’tS‘tšg
 = &
tİCam”aS‘tšgs
;

667 
	gcu¼’tS‘tšg
 = &
bÙCam”aS‘tšgs
;

670 
	gveùÜ
<
	gv4l2_cÚŒŞ
>::
cÚ¡_™”©Ü
 
ci
 = 
cÚŒŞs
.
begš
();

671 
	gci
 !ğ
cÚŒŞs
.
’d
(); ++ci) {

672 
	gci
->
	gid
){

673 
	gV4L2_CID_BRIGHTNESS
:

674 
cu¼’tS‘tšg
->
brighŠess
 = 
ci
->
v®ue
;

676 
	gV4L2_CID_CONTRAST
:

677 
cu¼’tS‘tšg
->
cÚŒa¡
 = 
ci
->
v®ue
;

679 
	gV4L2_CID_SATURATION
:

680 
cu¼’tS‘tšg
->
§tu¿tiÚ
ğ
ci
->
v®ue
;

682 
	gV4L2_CID_HUE
:

683 
cu¼’tS‘tšg
->
hue
ğ
ci
->
v®ue
;

685 
	gV4L2_CID_SHARPNESS
:

686 
cu¼’tS‘tšg
->
sh¬²ess
ğ
ci
->
v®ue
;

688 
	gV4L2_CID_BACKLIGHT_COMPENSATION
:

689 
cu¼’tS‘tšg
->
backlightCom³n§tiÚ
ğ
ci
->
v®ue
;

691 
	gV4L2_CID_EXPOSURE
:

692 
cu¼’tS‘tšg
->
exposu»
ğ
ci
->
v®ue
;

694 
	gV4L2_CID_GAIN
:

695 
cu¼’tS‘tšg
->
gaš
ğ
ci
->
v®ue
;

697 
	gV4L2_CID_DO_WHITE_BALANCE
:

698 
cu¼’tS‘tšg
->
wh™eB®ªû
ğ
ci
->
v®ue
;

701 
	gss
 << "--ÿm”a." << 
	g£ËùedCam
 << "." << 
g‘Cam”aCÚŒŞName
(
ci
->
id
)

702 << "=" << 
	gci
->
	gv®ue
 << " ";

705 
em™
 
£ndCommªdToRobÙ
(
QSŒšg
(
ss
.
¡r
().
c_¡r
()));

708 
¡ršg
 
	gCam”aTab
::
	$g‘Cam”aCÚŒŞName
(
__u32
 
cÚŒŞName
) {

709 
cÚŒŞName
) {

710 
V4L2_CID_HFLIP
:  "hflip";

711 
V4L2_CID_VFLIP
:  "vflip";

713 
V4L2_CID_EXPOSURE_AUTO
:  "autoexp";

714 
V4L2_CID_BRIGHTNESS
:  "brightness";

715 
V4L2_CID_CONTRAST
:  "contrast";

716 
V4L2_CID_SATURATION
:  "saturation";

717 
V4L2_CID_HUE
:  "hue";

718 
V4L2_CID_SHARPNESS
:  "sharpness";

720 
V4L2_CID_AUTO_WHITE_BALANCE
:  "autowb";

721 
V4L2_CID_BACKLIGHT_COMPENSATION
:  "backlightcompensation";

722 
V4L2_CID_EXPOSURE
:  "exposure";

723 
V4L2_CID_GAIN
:  "gain";

724 
V4L2_CID_DO_WHITE_BALANCE
:  "whitebalance";

727 
	}
}

730 
	gCam”aTab
::
	$g‘P¬amV®ue
(cÚ¡ * 
cÚŒŞName
) const {

731 ià(
	`¡rcmp
(
cÚŒŞName
, "Horizontal Flip") == 0) {

732  
cu¼’tS‘tšgs
.
hæ
;

734 ià(
	`¡rcmp
(
cÚŒŞName
, "Vertical Flip") == 0) {

735  
cu¼’tS‘tšgs
.
væ
;

737 ià(
	`¡rcmp
(
cÚŒŞName
, "Brightness") == 0) {

738  
cu¼’tS‘tšgs
.
brighŠess
;

740 ià(
	`¡rcmp
(
cÚŒŞName
, "Contrast") == 0) {

741  
cu¼’tS‘tšgs
.
cÚŒa¡
;

743 ià(
	`¡rcmp
(
cÚŒŞName
, "Saturation") == 0) {

744  
cu¼’tS‘tšgs
.
§tu¿tiÚ
;

746 ià(
	`¡rcmp
(
cÚŒŞName
, "Hue") == 0) {

747  
cu¼’tS‘tšgs
.
hue
;

749 ià(
	`¡rcmp
(
cÚŒŞName
, "Sharpness") == 0) {

750  
cu¼’tS‘tšgs
.
sh¬²ess
;

752 ià(
	`¡rcmp
(
cÚŒŞName
, "Backlight Compensation") == 0) {

753  
cu¼’tS‘tšgs
.
backlightCom³n§tiÚ
;

755 ià(
	`¡rcmp
(
cÚŒŞName
, "Exposure") == 0) {

756  
cu¼’tS‘tšgs
.
exposu»
;

758 ià(
	`¡rcmp
(
cÚŒŞName
, "Gain") == 0) {

759  
cu¼’tS‘tšgs
.
gaš
;

761 ià(
	`¡rcmp
(
cÚŒŞName
, "White Balance") == 0) {

762  
cu¼’tS‘tšgs
.
wh™eB®ªû
;

765 
	}
}

767 
	gCam”aTab
::
	$v®ueF‘ch”
() {

768 
	`upd©eCam”aV®ues
();

769 
	}
}

771 
	gCam”aTab
::
	$autoTuÃr
() {

772 ià(
autoTuÃOn
) {

773 
	`qDebug
() << "Autotuning off!";

774 
numLoÿlMax
 = 0;

776 
	`qDebug
() << "Autotuning on!";

778 
be¡EÁrİy
 = 0.0;

781 
i
 = 0; i < 
cNUM_CONTROL_ATTRIBUTES
; i++) {

782 
CÚŒŞV®ues
[
i
].
cu¼’t
 = 
	`g‘P¬amV®ue
(CÚŒŞV®ues[i].
Çme
.
	`c_¡r
());

785 
autoTuÃOn
 = !autoTuneOn;

786 
	`¤ªdom
(
	`time
(
NULL
));

787 
äamesSšûRe£t
 = 0;

788 
	}
}

790 
	gCam”aTab
::
	$tuÃV®ue
(
’Œİy
) {

791 
veùÜ
<
v4l2_cÚŒŞ
> 
v®s
;

792 
™”©iÚs
 = 0;

793 
cÚŒŞ
 = -1;

794 
‹m³¿tu»
 = 12;

795 
™”©iÚsSšûChªge
 = 0;

798 ià(
äamesSšûRe£t
 > 5) {

799 
	`qDebug
() << "Pre change: ";

800 
	`´štCam”aCÚŒŞV®ues
();

803 ià(
’Œİy
 < 
be¡EÁrİy
) {

805 
v4l2_cÚŒŞ
 
v®
 = {
CÚŒŞV®ues
[
´evCÚŒŞ
].
cÚŒŞ
, 
´evCÚŒŞV®ue
};

806 
v®s
.
	`push_back
(
v®
);

808 
CÚŒŞV®ues
[
´evCÚŒŞ
].
ŒyInü—£
 = !ControlValues[prevControl].tryIncrease;

809 
CÚŒŞV®ues
[
´evCÚŒŞ
].
cu¼’t
 = 
´evCÚŒŞV®ue
;

810 
	`qDebug
(è<< "Deü—£dƒÁrİy: " << 
’Œİy
;

811 
	`´štCam”aCÚŒŞV®ues
();

813 
be¡EÁrİy
 = 
’Œİy
;

814 
™”©iÚsSšûChªge
 = 0;

815 
	`qDebug
(è<< "Inü—£dƒÁrİy: " << 
’Œİy
;

816 
	`´štCam”aCÚŒŞV®ues
();

820 ià((
™”©iÚs
 % 
cNUM_CONTROL_ATTRIBUTES
) == 0) {

821 
™”©iÚsSšûChªge
++;

822 ià(
™”©iÚsSšûChªge
 == 2) {

824 ià(
be¡EÁrİy
 > 
glob®Be¡EÁrİy
) {

825 
	`qDebug
() << "Better set of settings!";

826 
glob®Be¡EÁrİy
 = 
be¡EÁrİy
;

827 
glob®Be¡S‘tšgs
 = 
cu¼’tS‘tšgs
;

832 ià(
numLoÿlMax
 < 1) {

833 
numLoÿlMax
++;

834 
	`qDebug
(è<< "Re¡¬tšgunšg #" << 
numLoÿlMax
;

836 
autoTuÃOn
 = 
çl£
;

839 
veùÜ
<
v4l2_cÚŒŞ
> 
ÃwV®s
;

840 
i
 = 0; i < 
cNUM_CONTROL_ATTRIBUTES
; i++) {

841 
v®ue
 = 
CÚŒŞV®ues
[
i
].
mš
 + (
	`¿ndom
(è% ((CÚŒŞV®ues[i].
max
 - ControlValues[i].min)/2));

842 
CÚŒŞV®ues
[
i
].
cu¼’t
 = 
v®ue
;

843 
v4l2_cÚŒŞ
 
v®
 = {
CÚŒŞV®ues
[
i
].
cÚŒŞ
, 
v®ue
};

844 
ÃwV®s
.
	`push_back
(
v®
);

848 
	`£tCÚŒŞs
(
ÃwV®s
);

851 
autoTuÃOn
 = 
Œue
;

852 
be¡EÁrİy
 = 0.0;

853 
™”©iÚsSšûChªge
 = 0;

854 
	`¤ªdom
(
	`time
(
NULL
));

855 
äamesSšûRe£t
 = 0;

858 
cout
 << "R—ched 2†oÿÈmax" << 
’dl
;

859 
cout
 << "Tuºšg‡utÙunšg off" << 
’dl
;

860 
autoTuÃOn
 = !autoTuneOn;

863 
veùÜ
<
v4l2_cÚŒŞ
> 
be¡V®s
;

864 
i
 = 0; i < 
cNUM_CONTROL_ATTRIBUTES
; i++) {

865 
v4l2_cÚŒŞ
 
v®
 = {
CÚŒŞV®ues
[
i
].
cÚŒŞ
, 
	`g‘Be¡S‘tšgsV®ue
(ControlValues[i].control)};

866 
be¡V®s
.
	`push_back
(
v®
);

868 
	`£tCÚŒŞs
(
be¡V®s
);

875 
cÚŒŞ
 = (cÚŒŞ + 1è% 
cNUM_CONTROL_ATTRIBUTES
;

877 
´evCÚŒŞ
 = 
cÚŒŞ
;

878 
´evCÚŒŞV®ue
 = 
CÚŒŞV®ues
[
cÚŒŞ
].
cu¼’t
;

880 
deg»eOfChªge
 = 
	`max
((
CÚŒŞV®ues
[
cÚŒŞ
].
max
 - CÚŒŞV®ues[cÚŒŞ].
mš
)/
‹m³¿tu»
, 
¡©ic_ÿ¡
<>(1));

882 ià(
deg»eOfChªge
 > 100) {

883 
deg»eOfChªge
 = 
	`¿ndom
() % 50;

885 
ÃwV®ue
 = 
´evCÚŒŞV®ue
 + (
CÚŒŞV®ues
[
cÚŒŞ
].
ŒyInü—£
 ? 
deg»eOfChªge
 : -degreeOfChange);

886 
ş³dNewV®ue
 = 
	`mš
(
ÃwV®ue
, 
CÚŒŞV®ues
[
cÚŒŞ
].
max
);

887 
ş³dNewV®ue
 = 
	`max
(ş³dNewV®ue, 
CÚŒŞV®ues
[
cÚŒŞ
].
mš
);

888 ià(
ş³dNewV®ue
 =ğ
´evCÚŒŞV®ue
)

889 
CÚŒŞV®ues
[
cÚŒŞ
].
ŒyInü—£
 = !ControlValues[control].tryIncrease;

890 
v4l2_cÚŒŞ
 
v®
 = {
CÚŒŞV®ues
[
cÚŒŞ
].cÚŒŞ, 
ş³dNewV®ue
};

891 
CÚŒŞV®ues
[
cÚŒŞ
].
cu¼’t
 = 
ş³dNewV®ue
;

892 
v®s
.
	`push_back
(
v®
);

893 
	`£tCÚŒŞs
(
v®s
);

895 
äamesSšûRe£t
 = 0;

896 
™”©iÚs
++;

899 
äamesSšûRe£t
++;

903 ià(
™”©iÚs
 !ğ0 && (™”©iÚ % (2 * 
cNUM_CONTROL_ATTRIBUTES
)) == 0) {

904 
‹m³¿tu»
 *= 2;

906 
	}
}

909 
	gCam”aTab
::
	$g‘Be¡S‘tšgsV®ue
(
__u32
 
cÚŒŞName
) {

910 
cÚŒŞName
) {

911 
V4L2_CID_EXPOSURE
:  
glob®Be¡S‘tšgs
.
exposu»
;

912 
V4L2_CID_BRIGHTNESS
:  
glob®Be¡S‘tšgs
.
brighŠess
;

913 
V4L2_CID_CONTRAST
:  
glob®Be¡S‘tšgs
.
cÚŒa¡
;

914 
V4L2_CID_GAIN
:  
glob®Be¡S‘tšgs
.
gaš
;

915 
V4L2_CID_SATURATION
:  
glob®Be¡S‘tšgs
.
§tu¿tiÚ
;

916 
V4L2_CID_SHARPNESS
:  
glob®Be¡S‘tšgs
.
sh¬²ess
;

917 
V4L2_CID_BACKLIGHT_COMPENSATION
:  
glob®Be¡S‘tšgs
.
backlightCom³n§tiÚ
;

918 
V4L2_CID_DO_WHITE_BALANCE
:  
glob®Be¡S‘tšgs
.
wh™eB®ªû
;

920  
INT_MIN
;

921 
	}
}

923 
	gCam”aTab
::
	$´štCam”aCÚŒŞV®ues
() {

924 
	`qDebug
() << "Camera control settings";

925 
i
 = 0; i < 
cNUM_CONTROL_ATTRIBUTES
; i++) {

926 
	`qDebug
(è<< "\t" << 
CÚŒŞV®ues
[
i
].
Çme
.
	`c_¡r
(è<< "=" << CÚŒŞV®ues[i].
cu¼’t
;

928 
	}
}

930 
	gCam”aBu‰ÚHªdËr
::
	$Cam”aBu‰ÚHªdËr
(
Cam”aTab
 *
ÿmb
, 
cÚŒŞ
,

931 
QPushBu‰Ú
 *
qpb
, 
QLšeEd™
 *
qË
, 
QSlid”
 *
¦
) :

932 
	`ÿmb
(
ÿmb
), 
	`cÚŒŞ
(
cÚŒŞ
), 
	`qpb
(
qpb
), 
	`qË
(
qË
), 
	$¦
(
¦
) {

933 
	}
}

935 
	gSlid”HªdËr
::
	$Slid”HªdËr
(
Cam”aTab
 *
ÿmb
, 
cÚŒŞ
, 
QSlid”
 *
¦
, 
QLšeEd™
 *
qË
) :

936 
	`ÿmb
(
ÿmb
), 
	`cÚŒŞ
(
cÚŒŞ
), 
	`¦
(
¦
), 
	$qË
(
qË
) {

938 
	}
}

939 
	gCheckboxHªdËr
::
	$CheckboxHªdËr
(
Cam”aTab
 *
ÿmb
,
QSlid”
 *
¦
,
QPushBu‰Ú
 *
db
,
QLšeEd™
 *
qË
,QPushBu‰Ú *
ib
,
cÚŒŞ
):

940 
	`ÿmb
(
ÿmb
),
	`¦
(
¦
),
	`db
(
db
),
	`qË
(
qË
),
	`ib
(
ib
),
	$cÚŒŞ
(
cÚŒŞ
){

942 
	}
}

943 
	gCheckboxHªdËr
::
	$toggËS‹
(
boŞ
 
’abË
){

944 if(
cÚŒŞ
 > 1){

945 
¦
->
	`£tEÇbËd
(!
’abË
);

946 
db
->
	`£tEÇbËd
(!
’abË
);

947 
qË
->
	`£tEÇbËd
(!
’abË
);

948 
ib
->
	`£tEÇbËd
(!
’abË
);

950 
toggË
 = 
’abË
 ? 1:0;

951 if(
cÚŒŞ
 <= 1)

952 
toggË
 = 
’abË
 ? 0:1;

953 
v4l2_cÚŒŞ
 
v®
 = {
cÚŒŞIds
[
cÚŒŞ
], 
toggË
};

954 
veùÜ
<
v4l2_cÚŒŞ
> 
	`v®s
(1, 
v®
);

955 
ÿmb
->
	`£tCÚŒŞs
(
v®s
);

957 
	}
}

958 
	gSlid”HªdËr
::
	$£tV®ue
(
ÃwV®ue
){

959 
qË
->
	`£tText
(
QSŒšg
::
	`numb”
(
ÃwV®ue
));

960 
v4l2_cÚŒŞ
 
v®
 = {
cÚŒŞIds
[
cÚŒŞ
], 
ÃwV®ue
};

961 
veùÜ
<
v4l2_cÚŒŞ
> 
	`v®s
(1, 
v®
);

962 
ÿmb
->
	`£tCÚŒŞs
(
v®s
);

963 
	}
}

965 
	gCam”aBu‰ÚHªdËr
::
	$£tV®ue
(
v®
) {

966 
qË
->
	`£tText
(
QSŒšg
::
	`numb”
(
v®
));

967 
	}
}

969 
	gCam”aBu‰ÚHªdËr
::
	$g‘CÚŒŞ
() const {

970  
cÚŒŞ
;

971 
	}
}

973 
	gCam”aBu‰ÚHªdËr
::
	$şicked
(
boŞ
) {

974 
__s32
 
diff
 = 
qpb
 ? (qpb->
	`‹xt
() == "-" ? -1 : 1) : 0;

975 
__s32
 
Ãwv®
 = 
qË
->
	`‹xt
().
	`toIÁ
(è+ 
diff
;

976 ià(
Ãwv®
 >ğ
cÚŒŞMš
[
cÚŒŞ
] &&‚ewv® <ğ
cÚŒŞMax
[control]){

977 
qË
->
	`£tText
(
QSŒšg
::
	`numb”
(
Ãwv®
));

978 
¦
->
	`£tSlid”Pos™iÚ
(
Ãwv®
);

980 
	}
}

	@utils/offnao/tabs/cameraTab.hpp

32 #´agm¨
Úû


33 
	~<QM’uB¬
>

34 
	~<QWidg‘
>

35 
	~<QObjeù
>

36 
	~<QEv’t
>

37 
	~<QGridLayout
>

38 
	~<QHBoxLayout
>

39 
	~<QBoxLayout
>

40 
	~<QLab–
>

41 
	~<QLšeEd™
>

42 
	~<QCheckBox
>

43 
	~<QTabWidg‘
>

44 
	~<QGroupBox
>

45 
	~<QBu‰ÚGroup
>

46 
	~<QPushBu‰Ú
>

47 
	~<QRadioBu‰Ú
>

49 
	~<c¡dio
>

50 
	~<lšux/videodev2.h
>

51 
	~<veùÜ
>

52 
	~"bs/b.hµ
"

53 
	~"medŸPª–.hµ
"

54 
	~"bs/PoštCloud.hµ
"

55 
	~"ty³s/Cam”aS‘tšgs.hµ
"

57 
	~"uts/Tim”.hµ
"

58 
	~<f¡»am
>

59 
	~<io¡»am
>

65 
şass
 
	gCam”aBu‰ÚHªdËr
;

67 şas 
	cCam”aTab
 : 
public
 
Tab
 {

68 
Q_OBJECT


69 
public
:

70 
Cam”aTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

71 
£tCÚŒŞs
(cÚ¡ 
¡d
::
veùÜ
<
v4l2_cÚŒŞ
> &);

73 
	m´iv©e
:

74 
š™
();

75 
upd©eCam”aV®ues
();

76 
	$g‘P¬amV®ue
(cÚ¡ * 
cÚŒŞName
) const;

77 
¡d
::
¡ršg
 
	`g‘Cam”aCÚŒŞName
(
__u32
 
cÚŒŞName
);

78 
	`g‘Be¡S‘tšgsV®ue
(
__u32
 
cÚŒŞName
);

79 
	`g‘EÁrİyV®ue
();

80 
boŞ
 
	`outOfBounds
(
row
, 
cŞ
);

82 
	eImageTy³
 {
CAMERA
, 
RGB
, 
YUV
, 
HSV
};

85 cÚ¡ 
NUM_IMG_TYPES
 = 
HSV
 + 1;

86 cÚ¡ 
MAX_RGB_VALUE
 = 0x00ffffff;

87 cÚ¡ 
MAX_B_VALUE
 = 0x000000ff;

88 cÚ¡ 
HISTOGRAM_COLS
 = 
IMAGE_COLS
/2;

89 cÚ¡ 
RGB_SCALEFACTOR
 = 
MAX_RGB_VALUE
/
HISTOGRAM_COLS
;

90 cÚ¡ 
B_SCALEFACTOR
 = 1;

91 cÚ¡ 
RED_MASK
 = 0x00ff0000;

92 cÚ¡ 
GREEN_MASK
 = 0x0000ff00;

93 cÚ¡ 
BLUE_MASK
 = 0x000000ff;

95 
QRadioBu‰Ú
 *
tİCam
;

96 
QRadioBu‰Ú
 *
bÙtomCam
;

97 
¡d
::
veùÜ
<
Cam”aBu‰ÚHªdËr
*> 
v®ueIÅutBoxes
;

99 
Cam”aS‘tšgs
 
cu¼’tS‘tšgs
;

100 
Cam”aS‘tšgs
 
tİCam”aS‘tšgs
;

101 
Cam”aS‘tšgs
 
bÙCam”aS‘tšgs
;

102 
WhichCam”a
 
cu¼’tCam”a
;

104 
numLoÿlMax
;

105 
Cam”aS‘tšgs
 
glob®Be¡S‘tšgs
;

106 
glob®Be¡EÁrİy
;

109 
äamesSšûRe£t
;

110 
´evCÚŒŞ
;

111 
´evCÚŒŞV®ue
;

116 
QPixm­
 
imagePixm­s
[
NUM_IMG_TYPES
];

117 
QLab–
 *
imageLab–s
[
NUM_IMG_TYPES
];

118 
PoštCloud
 
poštCloud
;

120 
QGridLayout
 *
Ïyout
;

123 
boŞ
 
autoTuÃOn
;

124 
be¡EÁrİy
;

125 
boŞ
 
ÿm”aToggËd
;

128 
	`»d¿w
();

129 
public
 
¦Ùs
:

130 
	`toggËChªge
();

131 
	`ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

132 
	`autoTuÃr
();

133 
	`v®ueF‘ch”
();

134 
	`tuÃV®ue
(
’Œİy
);

135 
	`´štCam”aCÚŒŞV®ues
();

136 
sigÇls
:

137 
	`£ndCommªdToRobÙ
(
QSŒšg
 
™em
);

138 
	}
};

139 şas 
	cCheckboxHªdËr
 : 
public
 
QObjeù
 {

140 
Q_OBJECT


141 
public
:

142 
CheckboxHªdËr
(
Cam”aTab
 *
ÿmb
,
QSlid”
 *
¦
,
QPushBu‰Ú
 *
db
,
QLšeEd™
 *
qË
,QPushBu‰Ú *
ib
,
cÚŒŞ
);

144 
public
 
	m¦Ùs
:

145 
toggËS‹
(
boŞ
 
’abË
);

147 
	m´iv©e
:

148 
Cam”aTab
 *
ÿmb
;

150 
QSlid”
 *
	m¦
;

152 
QPushBu‰Ú
 *
	mdb
;

154 
QLšeEd™
 *
	mqË
;

156 
QPushBu‰Ú
 *
	mib
;

158 
	mcÚŒŞ
;

161 şas 
	cSlid”HªdËr
 : 
public
 
QObjeù
 {

162 
Q_OBJECT


163 
public
:

164 
Slid”HªdËr
(
Cam”aTab
 *
ÿmb
, 
cÚŒŞ
, 
QSlid”
 *
¦
, 
QLšeEd™
 *
qË
);

166 
public
 
	m¦Ùs
:

167 
£tV®ue
(
ÃwV®ue
);

169 
	m´iv©e
:

170 
Cam”aTab
 *
ÿmb
;

172 
	mcÚŒŞ
;

174 
QSlid”
 *
	m¦
;

176 
QLšeEd™
 *
	mqË
;

181 şas 
	cCam”aBu‰ÚHªdËr
 : 
public
 
QObjeù
 {

182 
Q_OBJECT


183 
public
:

195 
Cam”aBu‰ÚHªdËr
(
Cam”aTab
 *
ÿmb
, 
cÚŒŞ
, 
QPushBu‰Ú
 *
qpb
,

196 
QLšeEd™
 *
qË
, 
QSlid”
 *
¦
);

197 
£tV®ue
();

198 
	$g‘CÚŒŞ
() const;

199 
public
 
¦Ùs
:

203 
	`şicked
(
boŞ
 
checked
 = 
çl£
);

204 
´iv©e
:

208 
Cam”aTab
 *
ÿmb
;

213 
cÚŒŞ
;

218 
QPushBu‰Ú
 *
qpb
;

223 
QLšeEd™
 *
qË
;

227 
QSlid”
 *
¦
;

	@utils/offnao/tabs/classifier.cpp

32 
	~<m©h.h
>

33 
	~<¡ršg.h
>

34 
	~<bzlib.h
>

36 
	~<¡dexû±
>

38 
	~"şassif›r.hµ
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
	gCÏssif›r
::
	$CÏssif›r
() {

43 
	}
}

44 
CÏssif›r
::~
	$CÏssif›r
() {

45 
	}
}

47 
boŞ
 
CÏssif›r
::
	$lßdCÏssifiÿtiÚFe
(
¡d
::
¡ršg
 
f’ame
) {

48 
FILE
 *
f
 = 
	`fİ’
(
f’ame
.
	`c_¡r
(), "rb");

49 
bz”rÜ
;

50 
BZFILE
 *
bf
 = 
	`BZ2_bzR—dO³n
(&
bz”rÜ
, 
f
, 0, 0, 0, 0);

51 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

52 
throw
 
¡d
::
	`ruÁime_”rÜ
("error openning kernel file for decompression");

54 
	`BZ2_bzR—d
 (&
bz”rÜ
, 
bf
, &
weight
,  (weight));

55 ià(! 
bz”rÜ
 =ğ
BZ_OK
 && ! bz”rÜ =ğ
BZ_STREAM_END
) {

56 
throw
 
¡d
::
	`ruÁime_”rÜ
("error decompressing kernel file");

58 
	`BZ2_bzR—dClo£
(&
bz”rÜ
, 
bf
);

59 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

60 
throw
 
¡d
::
	`ruÁime_”rÜ
("error closing kernel file");

62 
	`fşo£
(
f
);

65 
	`makeNnmc
();

68 
undoBufãr
.
	`ş—r
();

69 
feO³Ãd
 = 
Œue
;

70  
Œue
;

71 
	}
}

73 
	gCÏssif›r
::
	$§veCÏssifiÿtiÚFe
(
¡ršg
 
f’ame
) {

74 
FILE
 *
f
 = 
	`fİ’
(
f’ame
.
	`c_¡r
(), "wb");

75 
bz”rÜ
;

76 
BZFILE
 *
bf
 = 
	`BZ2_bzWr™eO³n
(&
bz”rÜ
, 
f
, 3, 0, 0);

77 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

78 
throw
 
¡d
::
	`ruÁime_”rÜ
("error openning kernel file for compression");

80 
	`BZ2_bzWr™e
 (&
bz”rÜ
, 
bf
, &
weight
,  (weight));

81 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

82 
throw
 
¡d
::
	`ruÁime_”rÜ
("error compressing kernel file");

84 
	`BZ2_bzWr™eClo£
(&
bz”rÜ
, 
bf
, 0, 0, 0);

85 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

86 
throw
 
¡d
::
	`ruÁime_”rÜ
("error closing kernel file");

88 
	`fşo£
(
f
);

89 
	}
}

92 
	gCÏssif›r
::
	$ÃwCÏssifiÿtiÚFe
() {

93 
y
 = 0; y < 
YMAX
; y++) {

94 
u
 = 0; u < 
UMAX
; u++) {

95 
v
 = 0; v < 
VMAX
; v++) {

96 
c
 = 0; c < 
CMAX
; c++) {

97 
weight
[
y
][
u
][
v
].
w
[
c
] = 0.0;

104 
undoBufãr
.
	`ş—r
();

105 
	`makeNnmc
();

106 
feO³Ãd
 = 
Œue
;

107 
	}
}

109 
boŞ
 
	gCÏssif›r
::
	$şassifiÿtiÚFeO³Ãd
() {

110  
feO³Ãd
;

111 
	}
}

113 
	gCÏssif›r
::
	$begšAùiÚ
() {

114 ià(
nÙ
 
cu¼’tAùiÚ
.
gaussŸns
.
	`em±y
()) {

115 
û¼
 << "begšAùiÚ(): Begª‡ùiÚ w™houˆ’dšg…»viou Úe" << 
’dl
;

118 
	}
}

119 
	gCÏssif›r
::
	$’dAùiÚ
() {

120 
undoBufãr
.
	`push_back
(
cu¼’tAùiÚ
);

122 
	`­¶yAùiÚ
(
cu¼’tAùiÚ
, 
çl£
);

124 
cu¼’tAùiÚ
.
	`ş—r
();

125 
	}
}

128 
	gCÏssif›r
::
	$­¶yAùiÚ
(
AùiÚ
 &
a
, 
boŞ
 
undo
) {

129 
i
 = 0; i < 
a
.
gaussŸns
.
	`size
(); i++) {

130 
	`­¶yGaussŸn
(
a
.
gaussŸns
[
i
], 
undo
);

132 
	}
}

134 
	gCÏssif›r
::
	$g‘UndoStus
(& 
Ëv–s
, 
CŞour
& 
Ï¡CŞour
) {

135 
Ëv–s
 = 
undoBufãr
.
	`size
();

136 ià(
nÙ
 
undoBufãr
.
	`em±y
()) {

137 ià(
undoBufãr
.
	`back
().
gaussŸns
.
	`em±y
()) {

138 
Ï¡CŞour
 = 
cBACKGROUND
;

140 
Ï¡CŞour
 = 
undoBufãr
.
	`back
().
gaussŸns
[0].
şassif›d
;

143 
	}
}

145 
	gCÏssif›r
::
	$­¶yGaussŸn
(
YuvGaussŸn
 &
g
, 
boŞ
 
undo
) {

148 
dy
 = -
g
.
yRadius
; dy <= g.yRadius; dy++) {

149 
du
 = -
g
.
uRadius
; du <= g.uRadius; du++) {

150 
dv
 = -
g
.
vRadius
; dv <= g.vRadius; dv++) {

151 
YuvTrË
 
yuv
 = 
g
.yuv;

152 
yuv
.
y
 +ğ
dy
;

153 
yuv
.
u
 +ğ
du
;

154 
yuv
.
v
 +ğ
dv
;

155 
	`addWeight
(
yuv
, 
g
.
weight
 * 
	`¿wK”ÃlV®
(
dy
, 
du
, 
dv
, g.
yRadius
,

156 
g
.
uRadius
, g.
vRadius
, g.
hacks
), g.
şassif›d
, 
undo
);

160 
	}
}

165 
boŞ
 
	gCÏssif›r
::
	$isMo¡lyCÏssif›d
(
y
, 
u
, 
v
, 
CŞour
 
c
) {

167  (
	`g‘CÏssif›dCŞour
(
y
, 
u
, 
v
è=ğ
c
 
ªd


168 
	`g‘CÏssif›dCŞour
(
y
 - 2, 
u
, 
v
è=ğ
c
 
ªd


169 
	`g‘CÏssif›dCŞour
(
y
 + 2, 
u
, 
v
è=ğ
c
 
ªd


170 
	`g‘CÏssif›dCŞour
(
y
, 
u
 - 2, 
v
è=ğ
c
 
ªd


171 
	`g‘CÏssif›dCŞour
(
y
, 
u
 + 2, 
v
è=ğ
c
 
ªd


172 
	`g‘CÏssif›dCŞour
(
y
, 
u
, 
v
 - 2è=ğ
c
 
ªd


173 
	`g‘CÏssif›dCŞour
(
y
, 
u
, 
v
 + 2è=ğ
c
);

174 
	}
}

176 
	gCÏssif›r
::
	$g‘CŞourM¬gš
(
y
, 
u
, 
v
) {

179 
w
[
CMAX
];

181 
	`cŞourInfo
(
y
, 
u
, 
v
, 
w
);

183 
CŞour
 
c
 = 
	`g‘CÏssif›dCŞour
(
y
, 
u
, 
v
);

185 
£cÚdMaxWeight
 = 
w
[0];

186 ià(
c
 == 0) {

187 
£cÚdMaxWeight
 = 
w
[1];

189 
i
 = 0; i < 
CMAX
; i++) {

190 ià(
w
[
i
] > 
£cÚdMaxWeight
) {

191 
£cÚdMaxWeight
 = 
w
[
i
];

195  
w
[
c
] - 
£cÚdMaxWeight
;

196 
	}
}

198 
	gCÏssif›r
::
	$cŞourInfo
(
y
, 
u
, 
v
, 
weights
[
CMAX
]) {

200 
YuvTrË
 
yuv
;

201 
yuv
.
y
 = y/2;

202 
yuv
.
u
 = u/2;

203 
yuv
.
v
 = v/2;

205 
Weights
 
w
;

207 
	`g‘Weights
(
yuv
, 
w
);

209 
i
 = 0; i < 
CMAX
; i++) {

210 
weights
[
i
] = 
w
.w[i];

212 
	}
}

214 
	gCÏssif›r
::
	$addWeight
(
YuvTrË
 
yuv
, 
amouÁ
, 
CŞour
 
c
, 
boŞ
 
undo
) {

215 
Weights
 
weights
;

216 
ŞdWeight
;

218 ià(
yuv
.
y
 < 
YMAX
 
ªd
 yuv.
u
 < 
UMAX
‡nd yuv.
v
 < 
VMAX
) {

220 
	`g‘Weights
(
yuv
, 
weights
);

223 
ŞdWeight
 = 
weights
.
w
[
c
];

224 ià(
undo
) {

225 
weights
.
w
[
c
] -ğ
amouÁ
;

227 
weights
.
w
[
c
] +ğ
amouÁ
;

231 
	`£tWeights
(
yuv
, 
weights
);

234 
Âmc
[
yuv
.
v
][yuv.
u
][yuv.
y
] = 
	`maxWeightIndex
(
weights
);

235 ià(
u£LiveNnmc
) {

236 
liveNnmc
[&(
Âmc
[
yuv
.
v
][yuv.
u
][yuv.
y
]) -

237 &(
Âmc
[0][0][0])] =‚nmc[
yuv
.
v
][yuv.
u
][yuv.
y
];

240 
	}
}

242 
	gCÏssif›r
::
	$£tWeights
(
YuvTrË
 
yuv
, 
Weights
 &
weights
) {

243 
weight
[
yuv
.
y
][yuv.
u
][yuv.
v
] = 
weights
;

244 
	}
}

246 
št64_t
 
	gCÏssif›r
::
	$yuvToFePos
(
YuvTrË
 
yuv
) {

248  ((
yuv
.
y
 * 
UMAX
 * 
VMAX
 * 
CMAX
 +

249 
yuv
.
u
 * 
VMAX
 * 
CMAX
 +

250 
yuv
.
v
 * 
CMAX
) * ());

251 
	}
}

253 
	gCÏssif›r
::
	$¿wK”ÃlV®
(
dY
, 
dU
, 
dV
, 
yRadius
,

254 
uRadius
, 
vRadius
, 
boŞ
 
hacks
) {

255 
uvV¬
 = 10;

256 ià(
nÙ
 
hacks
) {

257 
uvV¬
 = 1;

260 
»suÉ
 = 0;

262 
dCŞSqr
 = (()
dU
 * dUè/ (()(
uRadius
 * uRadius)) +

263 (()
dV
 * dVè/ (()(
vRadius
 * vRadius)) +

264 (()
dY
 * dYè/ (()(
yRadius
 * yRadius));

266 ià(
hacks
) {

267 
dCŞSqr
 = ()
dU
*dU * 
INV_U_KERNEL_RADIUS_SQUARED
 +

268 ()
dV
*dV * 
INV_V_KERNEL_RADIUS_SQUARED
 +

269 ()
dY
*dY*dY*dY * 
INV_Y_KERNEL_RADIUS_POW_4
;

273 ià(
dCŞSqr
 > 1.0) {

276 
»suÉ
 +ğ
	`exp
(-
dCŞSqr
*
uvV¬
);

277 ià(
hacks
) {

278 
»suÉ
 -ğ
	`exp
(-
uvV¬
);

281 ià(
hacks
 
ªd
 
dY
 =ğ0 && 
dU
 =ğ0 && 
dV
 == 0) {

282 
»suÉ
 *= 1.1;

286  
»suÉ
;

287 
	}
}

289 
	gCÏssif›r
::
	$şassify
(
y
, 
u
, 
v
, 
weight
, 
CŞour
 
c
,

290 
yRadius
, 
uRadius
, 
vRadius
, 
boŞ
 
hacks
) {

292 
YuvTrË
 
yuv
;

294 
cout
 << "CÏssifyšg YUV(" << 
y
 << ", " << 
u
 << ", " << 
v


295 << "èa " << 
c
 << ". Radiu ğ(" << 
yRadius


296 << ", " << 
uRadius
 << ", " << 
vRadius
 << ")" << 
’dl
;

297 
yuv
.
y
 = 
¡©ic_ÿ¡
<>(y / 2);

298 
yuv
.
u
 = 
¡©ic_ÿ¡
<>(u / 2);

299 
yuv
.
v
 = 
¡©ic_ÿ¡
<>(v / 2);

301 
YuvGaussŸn
 
	`thisGaussŸn
(
yuv
, 
weight
, 
c
, 
yRadius
, 
uRadius
, 
vRadius
, 
hacks
);

302 
cu¼’tAùiÚ
.
gaussŸns
.
	`push_back
(
thisGaussŸn
);

303 
	}
}

305 
boŞ
 
	gCÏssif›r
::
	$ÿnUndo
() {

306  
nÙ
 
undoBufãr
.
	`em±y
();

307 
	}
}

308 
	gCÏssif›r
::
	$undo
() {

309 ià(
nÙ
 
	`ÿnUndo
()) {

310 
û¼
 << "NØaùiÚ tØundo" << 
’dl
;

313 
AùiÚ
 
aùiÚToUndo
 = 
undoBufãr
.
	`back
();

314 
undoBufãr
.
	`pİ_back
();

315 
	`­¶yAùiÚ
(
aùiÚToUndo
, 
Œue
);

316 
	}
}

318 
	gCÏssif›r
::
	$§veNnmc
(
¡ršg
 
f’ame
) {

319 
FILE
 *
f
 = 
	`fİ’
(
f’ame
.
	`c_¡r
(), "wb");

320 
bz”rÜ
;

321 
BZFILE
 *
bf
 = 
	`BZ2_bzWr™eO³n
(&
bz”rÜ
, 
f
, 9, 0, 100);

322 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

323 
throw
 
¡d
::
	`ruÁime_”rÜ
("error openning‚nmc file for compression");

325 
	`BZ2_bzWr™e
 (&
bz”rÜ
, 
bf
, &
Âmc
,  (nnmc));

326 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

327 
throw
 
¡d
::
	`ruÁime_”rÜ
("error compressing‚nmc file");

329 
	`BZ2_bzWr™eClo£
(&
bz”rÜ
, 
bf
, 0, 0, 0);

330 ià(! 
bz”rÜ
 =ğ
BZ_OK
) {

331 
throw
 
¡d
::
	`ruÁime_”rÜ
("error closing‚nmc file");

333 
	`fşo£
(
f
);

334 
	}
}

336 
	gCÏssif›r
::
	$g‘Weights
(
YuvTrË
 
yuv
, 
Weights
 &
weights
) {

337 
weights
 = 
weight
[
yuv
.
y
][yuv.
u
][yuv.
v
];

339 
	}
}

341 
	gCÏssif›r
::
	$makeNnmc
() {

342 
Weights
 
weights
;

344 
y
 = 0; y < 
YMAX
; y++) {

345 
u
 = 0; u < 
UMAX
; u++) {

346 
v
 = 0; v < 
VMAX
; v++) {

347 
YuvTrË
 
yuv
;

348 
yuv
.
y
 = y;

349 
yuv
.
u
 = u;

350 
yuv
.
v
 = v;

351 
	`g‘Weights
(
yuv
, 
weights
);

352 
Âmc
[
v
][
u
][
y
] = 
	`maxWeightIndex
(
weights
);

356 
	}
}

358 
CŞour
 
	gCÏssif›r
::
	$maxWeightIndex
(
Weights
 &
weights
) {

359 
maxWeight
 = 
INITIAL_NONE_VALUE
;

360 
maxIndex
 = 
cBACKGROUND
;

362 
i
 = 0; i < 
CMAX
; i++) {

363 ià(
weights
.
w
[
i
] > 
maxWeight
) {

364 
maxIndex
 = 
i
;

365 
maxWeight
 = 
weights
.
w
[
i
];

369  
¡©ic_ÿ¡
<
CŞour
>(
maxIndex
);

370 
	}
}

372 
CŞour
 
	gCÏssif›r
::
	$g‘CÏssif›dCŞour
(
y
, 
u
, 
v
) {

375 ià(
y
 < 0 
Ü
 y/2 >ğ
YMAX
 or

376 
u
 < 0 
Ü
 u/2 >ğ
UMAX
 or

377 
v
 < 0 
Ü
 v/2 >ğ
VMAX
) {

378  
cBACKGROUND
;

380  
¡©ic_ÿ¡
<
CŞour
>(
Âmc
[
v
/2][
u
/2][
y
/2]);

381 
	}
}

384 * 
	gCÏssif›r
::
	$g‘NnmcPoš‹r
() {

385  &(
Âmc
[0][0][0]);

386 
	}
}

388 
	gCÏssif›r
::
	$£tNnmcPoš‹r
(* 
Âmc
) {

389 
liveNnmc
 = 
Âmc
;

390 
	}
}

392 
	gCÏssif›r
::
	$£tUpd©eLiveNnmc
(
boŞ
 
u£Live
) {

393 
u£LiveNnmc
 = 
u£Live
;

395 ià(
u£Live
) {

396 ià(
liveNnmc
 !ğ
NULL
) {

398 
	`memıy
(
liveNnmc
, 
	`g‘NnmcPoš‹r
(), 
YMAX
 * 
UMAX
 * 
VMAX
);

400 
û¼
 << "£tUpd©eLiveNnmc(boŞ): NØlivÂmøpoš‹¸giv’" << 
’dl
;

401 
u£Live
 = 
çl£
;

404 
liveNnmc
 = 
NULL
;

406 
	}
}

409 
QRgb
 
	gCÏssif›r
::
	$yuv2rgb
(
y
, 
u
, 
v
) {

410 
y
 -= 16;

411 
u
 -= 128;

412 
v
 -= 128;

413 
r
 = 
¡©ic_ÿ¡
<>((298.082 * 
y
 + 0 * 
u
 + 408.583 * 
v
) / 256);

414 
g
 = 
¡©ic_ÿ¡
<>((298.082 * 
y
 - 100.291 * 
u
 - 208.120 * 
v
) / 256);

415 
b
 = 
¡©ic_ÿ¡
<>((298.082 * 
y
 + 516.411 * 
u
 + 0 * 
v
) / 256);

416 ià(
r
 < 0)„ = 0;

417 ià(
g
 < 0) g = 0;

418 ià(
b
 < 0) b = 0;

419 ià(
r
 > 255)„ = 255;

420 ià(
g
 > 255) g = 255;

421 ià(
b
 > 255) b = 255;

422  
	`qRgb
(
r
, 
g
, 
b
);

423 
	}
}

	@utils/offnao/tabs/classifier.hpp

32 #´agm¨
Úû


34 
	~<¡dio.h
>

35 
	~<¡dšt.h
>

36 
	~<QRgb
>

37 
	~<f¡»am
>

38 
	~<deque
>

39 
	~<io¡»am
>

40 
	~<veùÜ
>

41 
	~<¡ršg
>

42 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

44 cÚ¡ 
	gYMAX
 = 128;

45 cÚ¡ 
	gUMAX
 = 128;

46 cÚ¡ 
	gVMAX
 = 128;

47 cÚ¡ 
	gCMAX
 = 
cNUM_COLOURS
;

49 cÚ¡ 
	gY_KERNEL_RADIUS
 = 10;

50 cÚ¡ 
	gY_KERNEL_RADIUS_SQUARED
 = 
Y_KERNEL_RADIUS
 * Y_KERNEL_RADIUS;

51 cÚ¡ 
	gY_KERNEL_RADIUS_POW_4
 = 
Y_KERNEL_RADIUS_SQUARED
*

52 
Y_KERNEL_RADIUS_SQUARED
;

53 cÚ¡ 
	gINV_Y_KERNEL_RADIUS_SQUARED
 = 1.0/

54 (
Y_KERNEL_RADIUS_SQUARED
);

55 cÚ¡ 
	gINV_Y_KERNEL_RADIUS_POW_4
 = 1.0 / (
Y_KERNEL_RADIUS_POW_4
);

58 cÚ¡ 
	gU_KERNEL_RADIUS
 = 10;

59 cÚ¡ 
	gU_KERNEL_RADIUS_SQUARED
 = 
U_KERNEL_RADIUS
 * U_KERNEL_RADIUS;

60 cÚ¡ 
	gINV_U_KERNEL_RADIUS_SQUARED
 = 1.0 /

61 (
U_KERNEL_RADIUS_SQUARED
);

63 cÚ¡ 
	gV_KERNEL_RADIUS
 = 10;

64 cÚ¡ 
	gV_KERNEL_RADIUS_SQUARED
 = 
V_KERNEL_RADIUS
 * V_KERNEL_RADIUS;

65 cÚ¡ 
	gINV_V_KERNEL_RADIUS_SQUARED
 = 1.0/

66 (
V_KERNEL_RADIUS_SQUARED
);

68 cÚ¡ 
	gINITIAL_NONE_VALUE
 = 0.001f;

70 
	sYuvTrË
 {

71 
	my
, 
	mu
, 
	mv
;

74 
	sWeights
 {

75 
	mw
[
CMAX
];

78 
	sYuvGaussŸn
 {

79 
YuvGaussŸn
() {

80 
	myuv
.
	my
 = 255;

81 
	myuv
.
	mu
 = 255;

82 
	myuv
.
	mv
 = 255;

83 
	mweight
 = 0;

84 
	mhacks
 = 
çl£
;

85 
	mşassif›d
 = 
cBACKGROUND
;

88 
YuvGaussŸn
(
YuvTrË
 
yuv
, 
weight
, 
CŞour
 
şassif›d
, 
yRadius
,

89 
uRadius
, 
vRadius
, 
boŞ
 
hacks
) {

90 
	mthis
->
	myuv
 = 
yuv
;

92 
	mthis
->
	mweight
 = 
weight
;

93 
	mthis
->
	myRadius
 = 
yRadius
;

94 
	mthis
->
	muRadius
 = 
uRadius
;

95 
	mthis
->
	mvRadius
 = 
vRadius
;

96 
	mthis
->
	mşassif›d
 = 
şassif›d
;

97 
	mthis
->
	mhacks
 = 
hacks
;

100 
YuvTrË
 
	myuv
;

101 
	mweight
;

102 
	myRadius
, 
	muRadius
, 
	mvRadius
;

103 
boŞ
 
	mhacks
;

104 
CŞour
 
	mşassif›d
;

108 
	sAùiÚ
 {

109 
	m¡d
::
veùÜ
<
YuvGaussŸn
> 
gaussŸns
;

110 
ş—r
() {

111 
	mgaussŸns
.
ş—r
();

116 şas 
	cCÏssif›r
 {

117 
	mpublic
:

120 
QRgb
 
yuv2rgb
(
y
, 
u
, 
v
);

122 
CÏssif›r
();

123 ~
CÏssif›r
();

125 
ÃwCÏssifiÿtiÚFe
();

126 
§veCÏssifiÿtiÚFe
(
¡d
::
¡ršg
 
f’ame
);

127 
boŞ
 
lßdCÏssifiÿtiÚFe
(
¡d
::
¡ršg
 
f’ame
);

129 
begšAùiÚ
();

130 
’dAùiÚ
();

132 
boŞ
 
isMo¡lyCÏssif›d
(
y
, 
u
, 
v
, 
CŞour
 
c
);

133 
şassify
(
y
, 
u
, 
v
, 
weight
, 
CŞour
 
c
, 
yRadius
,

134 
uRadius
, 
vRadius
, 
boŞ
 
hacks
);

136 
boŞ
 
ÿnUndo
();

137 
g‘UndoStus
(& 
Ëv–s
, 
CŞour
& 
Ï¡CŞour
);

138 
undo
();

140 
§veNnmc
(
¡d
::
¡ršg
 
f’ame
);

142 
boŞ
 
şassifiÿtiÚFeO³Ãd
();

144 
CŞour
 
g‘CÏssif›dCŞour
(
y
, 
u
, 
v
);

145 
g‘CŞourM¬gš
(
y
, 
u
, 
v
);

146 
cŞourInfo
(
y
, 
u
, 
v
, 
weights
[
CMAX
]);

147 
¿wK”ÃlV®
(
dY
, 
dU
, 
dV
, 
yRadius
, 
uRadius
,

148 
vRadius
, 
boŞ
 
hacks
);

152 * 
g‘NnmcPoš‹r
();

153 
£tNnmcPoš‹r
(* 
Âmc
);

154 
£tUpd©eLiveNnmc
(
boŞ
);

156 
	m´iv©e
:

157 
­¶yAùiÚ
(
AùiÚ
 &
a
, 
boŞ
 
undo
);

158 
­¶yGaussŸn
(
YuvGaussŸn
&, 
boŞ
 
undo
);

159 
addWeight
(
YuvTrË
 
yuv
, 
amouÁ
, 
CŞour
 
c
, 
boŞ
 
undo
);

161 
boŞ
 
	mfeO³Ãd
;

163 
ş—rFe
();

164 
CŞour
 
maxWeightIndex
(
Weights
&);

165 
makeNnmc
();

166 
g‘Weights
(
YuvTrË
, 
Weights
&);

167 
£tWeights
(
YuvTrË
, 
Weights
&);

168 
št64_t
 
yuvToFePos
(
YuvTrË
);

169 
	m¡d
::
deque
<
AùiÚ
> 
undoBufãr
;

170 
AùiÚ
 
	mcu¼’tAùiÚ
;

172 
	mÂmc
[
VMAX
][
UMAX
][
YMAX
];

173 * 
	mliveNnmc
;

174 
boŞ
 
	mu£LiveNnmc
;

175 
Weights
 
	mweight
[
YMAX
][
UMAX
][
VMAX
];

	@utils/offnao/tabs/controlTab.cpp

1 
	~<QDebug
>

2 
	~<QFe
>

3 
	~<QM’u
>

4 
	~<QM’uB¬
>

5 
	~<QIÅutDŸlog
>

6 
	~<veùÜ
>

7 
	~<io¡»am
>

8 
	~<ut™y
>

9 
	~<cm©h
>

10 
	~<s¡»am
>

11 
	~<boo¡/asio.hµ
>

12 
	~<boo¡/¬¿y.hµ
>

13 
	~<c¡dio
>

15 
	~"cÚŒŞTab.hµ
"

16 
	~<boo¡/sh¬ed_±r.hµ
>

17 
	~"bÏckbßrd/BÏckbßrd.hµ
"

18 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

19 
	~"ty³s/BehaviourReque¡.hµ
"

20 
	~"ty³s/AùiÚCommªd.hµ
"

21 
	~"uts/CPÏÃCŞours.hµ
"

23 
usšg
 
Çme¥aû
 
	g¡d
;

24 
usšg
 
	gboo¡
::
asio
::

::
udp
;

25 
usšg
 
Çme¥aû
 
	gQt
;

27 
	ekeyTy³


29 
	mKEY_BODY_CONTROL
,

30 
	mKEY_HEAD_CONTROL
,

31 
	mKEY_INDIRECT_CONTROL
,

32 
	mKEY_NO_CONTROL


36 
	gbodyPow”s
[5] = {0, 10, 40, 80, 160};

37 
	gh—dPow”s
[5] = {0.02, 0.05, 0.1, 0.15, 0.2};

38 
	gkickPow”s
[5] = {0.05, 0.15, 0.4, 0.7, 1.0};

39 
	gtuºPow”s
[5] = {0.05, 0.15, 0.4, 0.7, 1.0};

42 
	$ty³OfKey
(
šKey
)

44 
šKey
)

46 
Key_W
:

47 
Key_S
:

48 
Key_A
:

49 
Key_D
:

50 
Key_Q
:

51 
Key_E
:

52 
Key_X
:

53 
Key_CÚŒŞ
:

54 
Key_C
:

55  
KEY_BODY_CONTROL
;

57 
Key_P
:

58 
Key_SemicŞÚ
:

59 
Key_L
:

60 
Key_Apo¡rİhe
:

61  
KEY_HEAD_CONTROL
;

63 
Key_T
:

64 
Key_B
:

65 
Key_Equ®
:

66 
Key_Mšus
:

67  
KEY_INDIRECT_CONTROL
;

70  
KEY_NO_CONTROL
;

72 
	}
}

74 
	gCÚŒŞTab
::
	$CÚŒŞTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
,

75 
VisiÚ
 *
visiÚ
) :

76 
	`zoomLev–
(1), 
	`zoomLog
(0), 
	`´evMou£X
(0), 
	`´evMou£Y
(0),

77 
	`´evZoomLev–
(1), 
	$ÇoD©a
(0) {

78 
	`š™M’u
(
m’uB¬
);

79 
	`š™
();

80 
this
->
visiÚ
 = vision;

81 
this
->
·»Á
 =…arent;

82 
	`mem£t
(
§l›ncyr
, 0, 160*120*(
CŞour
));

83 
und”CÚŒŞ
 = 
çl£
;

84 
couÁ”
 = 0;

85 
curNao
 = "";

86 
br
.
whichCam”a
 = 
TOP_CAMERA
;

87 
br
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
STAND
;

88 
br
.
aùiÚs
.
h—d
.
isR–©ive
 = 
Œue
;

89 
curPow”
 = 3;

90 
commªdsIssued
 = 0;

91 
	}
}

93 
	gCÚŒŞTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

94 ià(! 
ÇoD©a
) {

108 
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

127 
	`»d¿w
();

128 
	}
}

130 
	gCÚŒŞTab
::
	$š™M’u
(
QM’uB¬
 *
m’uB¬
) {

131 
cÚŒŞM’u
 = 
Ãw
 
	`QM’u
("&Control");

132 
m’uB¬
->
	`addM’u
(
cÚŒŞM’u
);

134 
cÚŒŞOnAù
 = 
Ãw
 
	`QAùiÚ
(
	`Œ
("S‘ MÙiÚ CÚŒŞ on"), 
cÚŒŞM’u
);

136 
cÚŒŞM’u
->
	`addAùiÚ
(
cÚŒŞOnAù
);

139 
	`cÚÃù
(
cÚŒŞOnAù
, 
	`SIGNAL
(
	`Œigg”ed
()), 
this
, 
	`SLOT
(
	`cÚŒŞOn
()));

140 
	}
}

142 
QLab–
 *
	gCÚŒŞTab
::
	$Ïb–W™hText
(cÚ¡ *
‹xt
, 
boŞ
 
isBŞd
)

144 
QLab–
 *
ÃwLab–
 = 
Ãw
 
	`QLab–
();

145 
ÃwLab–
->
	`£tAlignm’t
(
Qt
::
AlignVC’‹r
 | Qt::
AlignHC’‹r
);

146 
QFÚt
 
	`fÚt
("Monospace");

147 ià(
isBŞd
)

148 
fÚt
.
	`£tBŞd
(
Œue
);

149 
ÃwLab–
->
	`£tFÚt
(
fÚt
);

150 
ÃwLab–
->
	`£tText
(
‹xt
);

151 
Ïb–s
.
	`push_back
(
ÃwLab–
);

152  
ÃwLab–
;

153 
	}
}

155 
QLab–
 *
	gCÚŒŞTab
::
	$Ïb–W™hText
(cÚ¡ *
‹xt
)

157  
	`Ïb–W™hText
(
‹xt
, 
çl£
);

158 
	}
}

160 
	gCÚŒŞTab
::
	$š™
() {

161 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

162 
	`£tLayout
(
Ïyout
);

163 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

164 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

166 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Body CÚŒŞs", 
Œue
), 0, 0, 1, 3);

167 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Q"), 1, 0, 1, 1);

168 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("W"), 1, 1, 1, 1);

169 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("E"), 1, 2, 1, 1);

170 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("A"), 2, 0, 1, 1);

171 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("S"), 3, 1, 1, 1);

172 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("D"), 2, 2, 1, 1);

174 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("H—d CÚŒŞs", 
Œue
), 0, 3, 1, 3);

175 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("P"), 1, 4, 1, 1);

176 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("L"), 2, 3, 1, 1);

177 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
(";"), 3, 4, 1, 1);

178 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("'"), 2, 5, 1, 1);

180 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Misc. CÚŒŞs", 
Œue
), 0, 6, 1, 2);

181 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Kick (Left Foot): Control"), 1, 6, 1, 2);

182 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Kick (Right Foot): X"), 2, 6, 1, 2);

183 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Crouch: C"), 3, 6, 1, 2);

184 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Increase Power: ="), 4, 6, 1, 2);

185 
Ïyout
->
	`addWidg‘
(
	`Ïb–W™hText
("Decrease Power: -"), 5, 6, 1, 2);

187 
curPow”Lab–
 = 
	`Ïb–W™hText
("Current Power Level [0-4]: 3");

188 
Ïyout
->
	`addWidg‘
(
curPow”Lab–
, 6, 6, 1, 2);

190 
commªdsIssuedLab–
 = 
	`Ïb–W™hText
("Commands Issued: 0");

191 
Ïyout
->
	`addWidg‘
(
commªdsIssuedLab–
, 10, 0, 1, 1);

200 
	}
}

202 
	gCÚŒŞTab
::
	$£tNao
(cÚ¡ 
QSŒšg
 &
ÇoName
)

204 
curNao
 = 
ÇoName
.
	`toStdSŒšg
();

205 
cout
 << "S‘ curNaØtØ" << 
curNao
 << 
’dl
;

206 
	}
}

208 
	gCÚŒŞTab
::
	$cÚŒŞOn
() {

209 
und”CÚŒŞ
 = !underControl;

211 ià(
und”CÚŒŞ
 && 
curNao
 != "")

213 
cÚŒŞOnAù
->
	`£tText
("Set Motion Control off");

214 
em™
 
	`showMes§ge
("Motion Control on.");

218 
cÚŒŞOnAù
->
	`£tText
("Set Motion Control on");

219 
	`¡İBehaviour
();

220 
em™
 
	`showMes§ge
("");

223 
	`»d¿w
();

224 
	}
}

226 
	gCÚŒŞTab
::
	$d¿wImage
(
QImage
 *
image
) {

227 ià(
cu¼’tF¿me
) {

229 
row
 = 0;„ow < 
IMAGE_ROWS
; ++row) {

230 
cŞ
 = 0; cŞ < 
IMAGE_COLS
; ++col) {

231 
image
->
	`£tPix–
(
cŞ
, 
row
,

232 
	`g‘RGB
(
cŞ
, 
row
, 
cu¼’tF¿me
, 
TOP_IMAGE_COLS
));

235 } ià(
§l›ncyr
) {

236 
row
 = 0;„ow <
IMAGE_ROWS
/
BOT_SALIENCY_DENSITY
; ++row) {

237 
cŞ
=0; cŞ<
IMAGE_COLS
/
BOT_SALIENCY_DENSITY
; ++col) {

238 ià(0 <ğ
§l›ncyr
[
cŞ
][
row
] && s®›ncyr[cŞ][row] < 
cNUM_COLOURS
) {

239 
image
->
	`£tPix–
(
cŞ
, 
row
,

240 
CPLANE_COLOURS
[
§l›ncyr
[
cŞ
][
row
]].
	`rgb
());

242 
¡d
::
û¼
 << "Bad…ix–‡ˆ" << 
cŞ
 << " " << 
row
 << std::
’dl
;

247 
	}
}

249 
	gCÚŒŞTab
::
	$»d¿w
() {

250 
o¡ršg¡»am
 
oss
;

251 
oss
 << "Cu¼’ˆPow” Lev– [0-4]: " << 
curPow”
;

252 
curPow”Lab–
->
	`£tText
(
oss
.
	`¡r
().
	`c_¡r
());

254 
oss
.
	`¡r
("");

255 
oss
 << "Commªd Issued: " << 
commªdsIssued
;

256 
commªdsIssuedLab–
->
	`£tText
(
oss
.
	`¡r
().
	`c_¡r
());

277 
	}
}

279 
	gCÚŒŞTab
::
	$keyP»ssEv’t
(
QKeyEv’t
* 
ev’t
)

281 ià(
und”CÚŒŞ
 && 
curNao
 != "")

283 
key
;

285 
key
 = 
ev’t
->
	`key
();

290 ià(
	`ty³OfKey
(
key
è=ğ
KEY_BODY_CONTROL
)

292 
br
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
WALK
;

294 ià(
key
 =ğ
Qt
::
Key_W
)

296 
br
.
aùiÚs
.
body
.
fÜw¬d
 = 
bodyPow”s
[
curPow”
];

298 ià(
key
 =ğ
Qt
::
Key_S
)

300 
br
.
aùiÚs
.
body
.
fÜw¬d
 = -
bodyPow”s
[
curPow”
];

302 ià(
key
 =ğ
Qt
::
Key_A
)

304 
br
.
aùiÚs
.
body
.
Ëá
 = 
bodyPow”s
[
curPow”
];

306 ià(
key
 =ğ
Qt
::
Key_D
)

308 
br
.
aùiÚs
.
body
.
Ëá
 = -
bodyPow”s
[
curPow”
];

310 ià(
key
 =ğ
Qt
::
Key_Q
)

312 
br
.
aùiÚs
.
body
.
tuº
 = 
tuºPow”s
[
curPow”
];

314 ià(
key
 =ğ
Qt
::
Key_E
)

316 
br
.
aùiÚs
.
body
.
tuº
 = -
tuºPow”s
[
curPow”
];

318 ià(
key
 =ğ
Qt
::
Key_CÚŒŞ
)

320 
br
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
KICK
;

321 
br
.
aùiÚs
.
body
.
pow”
 = 
kickPow”s
[
curPow”
];

322 
br
.
aùiÚs
.
body
.
foÙ
 = 
AùiÚCommªd
::
Body
::
LEFT
;

324 ià(
key
 =ğ
Qt
::
Key_X
)

326 
br
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
KICK
;

327 
br
.
aùiÚs
.
body
.
pow”
 = 
kickPow”s
[
curPow”
];

328 
br
.
aùiÚs
.
body
.
foÙ
 = 
AùiÚCommªd
::
Body
::
RIGHT
;

330 ià(
key
 =ğ
Qt
::
Key_C
)

332 
br
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
GOALIE_SIT
;

336 ià(
	`ty³OfKey
(
key
è=ğ
KEY_INDIRECT_CONTROL
)

338 ià(
key
 =ğ
Qt
::
Key_T
)

340 
br
.
whichCam”a
 = 
TOP_CAMERA
;

342 ià(
key
 =ğ
Qt
::
Key_B
)

344 
br
.
whichCam”a
 = 
BOTTOM_CAMERA
;

346 ià(
key
 =ğ
Qt
::
Key_Equ®
)

348 
curPow”
++;

349 ià(
curPow”
 > 4) curPower = 4;

351 ià(
key
 =ğ
Qt
::
Key_Mšus
)

353 
curPow”
--;

354 ià(
curPow”
 < 0) curPower = 0;

359 ià(
	`ty³OfKey
(
key
è=ğ
KEY_HEAD_CONTROL
)

361 ià(
key
 =ğ
Qt
::
Key_P
)

363 
br
.
aùiÚs
.
h—d
.
p™chS³ed
 = 
h—dPow”s
[
curPow”
];

364 
br
.
aùiÚs
.
h—d
.
p™ch
 = -0.5;

366 ià(
key
 =ğ
Qt
::
Key_SemicŞÚ
)

368 
br
.
aùiÚs
.
h—d
.
p™chS³ed
 = 
h—dPow”s
[
curPow”
];

369 
br
.
aùiÚs
.
h—d
.
p™ch
 = 0.5;

371 ià(
key
 =ğ
Qt
::
Key_L
)

373 
br
.
aùiÚs
.
h—d
.
yawS³ed
 = 
h—dPow”s
[
curPow”
];

374 
br
.
aùiÚs
.
h—d
.
yaw
 = 0.5;

376 ià(
key
 =ğ
Qt
::
Key_Apo¡rİhe
)

378 
br
.
aùiÚs
.
h—d
.
yawS³ed
 = 
h—dPow”s
[
curPow”
];

379 
br
.
aùiÚs
.
h—d
.
yaw
 = -0.5;

383 ià(
	`ty³OfKey
(
key
è!ğ
KEY_NO_CONTROL
)

385 
	`£ndBehaviour
();

386 
commªdsIssued
++;

389 
	`»d¿w
();

391 
	}
}

393 
	gCÚŒŞTab
::
	$keyR–—£Ev’t
(
QKeyEv’t
 *
ev’t
)

395 
key
 = 
ev’t
->
	`key
();

396 ià(
und”CÚŒŞ
 && 
curNao
 != "")

398 ià(
	`ty³OfKey
(
key
è=ğ
KEY_HEAD_CONTROL
)

400 ià(
key
 =ğ
Qt
::
Key_P
 || key =ğQt::
Key_SemicŞÚ
)

401 
br
.
aùiÚs
.
h—d
.
p™chS³ed
 = 0.0;

403 
br
.
aùiÚs
.
h—d
.
yawS³ed
 = 0.0;

405 ià(
	`ty³OfKey
(
key
è=ğ
KEY_BODY_CONTROL
)

407 ià(
key
 =ğ
Qt
::
Key_W
 || key =ğQt::
Key_S
)

408 
br
.
aùiÚs
.
body
.
fÜw¬d
 = 0.0;

409 ià(
key
 =ğ
Qt
::
Key_A
 || key =ğQt::
Key_D
)

410 
br
.
aùiÚs
.
body
.
Ëá
 = 0.0;

411 ià(
key
 =ğ
Qt
::
Key_Q
 || key =ğQt::
Key_E
)

412 
br
.
aùiÚs
.
body
.
tuº
 = 0.0;

413 ià(
key
 =ğ
Qt
::
Key_K
)

414 
br
.
aùiÚs
.
body
.
pow”
 = 0.0;

419 ià(
	`ty³OfKey
(
key
è!ğ
KEY_NO_CONTROL
)

421 ià((
br
.
aùiÚs
.
h—d
.
p™chS³ed
 =ğbr.aùiÚs.h—d.
yawS³ed
) && (br.actions.head.yawSpeed == 0.0))

423 
br
.
aùiÚs
.
h—d
 = 
AùiÚCommªd
::
	`H—d
();

425 ià(
br
.
aùiÚs
.
body
.
fÜw¬d
 =ğ0.0 && br.aùiÚs.body.
Ëá
 =ğ0.0 && br.aùiÚs.body.
tuº
 == 0.0)

426 
br
.
aùiÚs
.
body
 = 
AùiÚCommªd
::
	`Body
();

429 
	`£ndBehaviour
();

430 
commªdsIssued
++;

432 
	`»d¿w
();

434 
	}
}

436 
	gCÚŒŞTab
::
	$¡İBehaviour
()

438 
	`£ndBehaviour
();

439 
	}
}

441 
	gCÚŒŞTab
::
	$£ndBehaviour
()

443 
Œy


445 
boo¡
::
asio
::
io_£rviû
 io_service;

447 
udp
::
’dpošt
 
	`»ûiv”_’dpošt
(
boo¡
::
asio
::

::
	`add»ss
(boo¡::asio::::
add»ss_v4
::
	`äom_¡ršg
(
curNao
)), 4000);

451 
udp
::
sock‘
 
	`sock‘
(
io_£rviû
);

452 
sock‘
.
	`İ’
(
udp
::
	`v4
());

454 ià(
br
.
aùiÚs
.
body
.
aùiÚTy³
 !ğ
AùiÚCommªd
::
Body
::
WALK
 && br.aùiÚs.body.aùiÚTy³ !ğAùiÚCommªd::Body::
KICK
 && br.aùiÚs.body.aùiÚTy³ !ğAùiÚCommªd::Body::
GOALIE_SIT
)

455 
br
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
STAND
;

457 ià(
br
.
aùiÚs
.
body
.
aùiÚTy³
 !ğ
AùiÚCommªd
::
Body
::
KICK
 && br.aùiÚs.body.aùiÚTy³ !ğAùiÚCommªd::Body::
GOALIE_SIT
 && br.aùiÚs.
h—d
.
p™chS³ed
 =ğ0.0 && br.aùiÚs.h—d.
yawS³ed
 == 0.0)

458 
br
.
aùiÚs
.
body
.
aùiÚTy³
 = 
AùiÚCommªd
::
Body
::
WALK
;

460 *
dp
 = (*)&
br
;

462 
sock‘
.
	`£nd_to
(
boo¡
::
asio
::
	`bufãr
(
dp
,(
BehaviourReque¡
)), 
»ûiv”_’dpošt
);

470 
	`ÿtch
 (
exû±iÚ
 
e
)

474 
	}
}

	@utils/offnao/tabs/controlTab.hpp

1 #´agm¨
Úû


2 
	~<QBu‰ÚGroup
>

3 
	~<QCheckBox
>

4 
	~<QEv’t
>

5 
	~<QFeDŸlog
>

6 
	~<QGridLayout
>

7 
	~<QGroupBox
>

8 
	~<QLab–
>

9 
	~<QM©rix
>

10 
	~<QM’uB¬
>

11 
	~<QMes§geBox
>

12 
	~<QMou£Ev’t
>

13 
	~<QObjeù
>

14 
	~<QPaš‹r
>

15 
	~<QProg»ssDŸlog
>

16 
	~<QPushBu‰Ú
>

17 
	~<QRadioBu‰Ú
>

18 
	~<QTabWidg‘
>

19 
	~<QWh“lEv’t
>

20 
	~<QWidg‘
>

22 
	~<c¡dio
>

23 
	~<¡ršg
>

24 
	~<veùÜ
>

26 
	~"medŸPª–.hµ
"

27 
	~"bs/b.hµ
"

28 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

29 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

30 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

35 şas 
	cCÚŒŞTab
 : 
public
 
Tab
 {

36 
Q_OBJECT


37 
public
:

38 
CÚŒŞTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

39 
QAùiÚ
 *
	mlßdDumpAù
;

41 
keyR–—£Ev’t
(
QKeyEv’t
 *
ev’t
);

42 
keyP»ssEv’t
(
QKeyEv’t
 *
ev’t
);

44 
£tNao
(cÚ¡ 
QSŒšg
 &
ÇoName
);

46 
	m´iv©e
:

47 
š™
();

48 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

50 
QCheckBox
 *
	mcheckAutoWeight
;

51 
QCheckBox
 *
	mcheckVisiÚOv”Ïy
;

53 cÚ¡ 
	mZOOM_LIMIT
 = 6;

54 
	mzoomLev–
, 
	mzoomLog
;

56 
	mcouÁ”
;

58 
£ndBehaviour
();

59 
¡İBehaviour
();

61 
QLab–
 *
Ïb–W™hText
(cÚ¡ *
‹xt
, 
boŞ
 
isBŞd
);

62 
QLab–
 *
Ïb–W™hText
(cÚ¡ *
‹xt
);

63 
	m¡d
::
veùÜ
<
QLab–
*> 
Ïb–s
;

64 
QLab–
 *
	mcurPow”Lab–
, *
	mcommªdsIssuedLab–
;

66 
CŞour
 
	m§l›ncyr
[160][120];

68 
	mcurPow”
, 
	mcommªdsIssued
;

70 
	m¡d
::
¡ršg
 
curNao
;

72 
BehaviourReque¡
 
	mbr
;

75 
	moNONE
 = 0,

76 
	moSELECTED
 = 1,

77 
	moSELECTED_UNCLASSIFIED
 = 2,

78 
	moALL
 = 3,

79 
	moALL_UNCLASSIFIED
 = 4,

80 
	moNUM_OVERLAYS
 = 5

81 } 
	tOv”Ïy
;

88 
QLab–
 *
	gÿmLab–
;

89 
QPixm­
 
	gimagePixm­
;

92 
QPushBu‰Ú
 *
	gundo
;

96 
QVBoxLayout
 *
	gcheckboxLayout
;

98 
QBu‰ÚGroup
 *
	gcŞourGroup
;

99 
QVBoxLayout
 *
	gcŞourGroupLayout
;

101 
QBu‰ÚGroup
 *
	gov”ÏyGroup
;

102 
QVBoxLayout
 *
	gov”ÏyGroupLayout
;

104 
QGroupBox
 *
	gcŞourBox
;

105 
QRadioBu‰Ú
 *
	gcŞours
[
cNUM_COLOURS
];

106 
QGroupBox
 *
	gov”ÏyBox
;

107 
QRadioBu‰Ú
 *
	gov”Ïys
[
oNUM_OVERLAYS
];

110 
QGridLayout
 *
	gÏyout
;

112 
QLab–
 *
	gËáLab–
, *
	grightLab–
, *
	gmiddËLab–
;

115 
CŞour
 
	gcŞour
;

116 
Ov”Ïy
 
	gov”Ïy
;

117 
FILE
 *
	gdumpFe
;

122 
QPošt
 
	gmou£Pos™iÚ
;

125 
»d¿w
();

127 
d¿wImage
(
QImage
 *
image
);

128 
QPixm­
 
d¿wCrosshaœ
();

129 
QPošt
 
Œª¦©eToZoomedImageCoÜds
(QPoint);

131 
	gmou£X
, 
	gmou£Y
;

132 
	g´evMou£X
, 
	g´evMou£Y
, 
	g´evZoomLev–
;

135 
QM’u
 *
	gcÚŒŞM’u
;

137 
QAùiÚ
 *
	gcÚŒŞOnAù
;

139 
BÏckbßrd
 *
	gbÏckbßrd
;

141 
QFe
 *
	gÂmcFe
;

142 
QAùiÚ
 *
	gundoAù
;

143 
NaoD©a
 *
	gÇoD©a
;

144 
boŞ
 
	gund”CÚŒŞ
;

146 
public
 
	g¦Ùs
:

148 
cÚŒŞOn
();

149 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

	@utils/offnao/tabs/fieldView.cpp

32 
	~"f›ldV›w.hµ
"

33 
	~<QCŞÜ
>

34 
	~<QBrush
>

35 
	~<QImage
>

36 
	~<QReùF
>

38 
	~"uts/F›ldPaš‹r.hµ
"

39 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

40 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

41 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

42 
	~"³rû±iÚ/visiÚ/Ùh”/RobÙRegiÚ.hµ
"

43 
	~"³rû±iÚ/loÿli§tiÚ/Loÿli§tiÚDefs.hµ
"

44 
	~"uts/Logg”.hµ
"

45 
	~"uts/šÿ·c™©ed.hµ
"

46 
	~"bÏckbßrd/BÏckbßrd.hµ
"

47 
	~"´ogİts.hµ
"

48 
	~"ty³s/RobÙOb¡aşe.hµ
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
	gF›ldV›w
::
	$F›ldV›w
(è: 
	`image
(":/images/spl_field.svg") {

54 
»nd”Pixm­
 = 
Ãw
 
	`QPixm­
(640, 480);

56 
imagePixm­
 = 
	`QPixm­
(640, 480);

57 
imagePixm­
.
	`fl
(
	`QCŞÜ
(0, 128, 0));

58 
F›ldPaš‹r
 
	`·š‹r
(&
imagePixm­
);

59 
·š‹r
.
	`d¿wF›ld
();

61 
»nd”Pixm­
->
	`fl
(
Qt
::
d¬kG¿y
);

62 
	`£tPixm­
(*
»nd”Pixm­
);

63 
	`£tMšimumSize
(640, 480);

64 
	`£tMaximumSize
(640, 480);

65 
	`£tAlignm’t
(
Qt
::
AlignTİ
);

66 
	}
}

68 
	gF›ldV›w
::~
	$F›ldV›w
() {

69 
	}
}

72 
F›ldV›w
::
»d¿w
(
¡d
::
veùÜ
<
AbsCoÜd
> &
robÙPos
,

73 
¡d
::
veùÜ
<
AbsCoÜd
> &
w®kšgTo
,

74 
¡d
::
veùÜ
<
AbsCoÜd
> &
b®lPos
,

75 
¡d
::
veùÜ
<
AbsCoÜd
> &
shoÙšgTo
){

77 *
»nd”Pixm­
 = 
imagePixm­
;

78 
F›ldPaš‹r
 
·š‹r
(
»nd”Pixm­
);

79 if(
	grobÙPos
.
size
(è> 0 && 
	gw®kšgTo
.size(è> 0 && 
	gshoÙšgTo
.size() > 0) {

80 
	gi
 = 0; i < 
	grobÙPos
.
size
(); ++i) {

81 ià(!
i¢ª
(
w®kšgTo
[
i
].
x
()) &&

82 !
i¢ª
(
w®kšgTo
[
i
].
y
()) &&

83 !
i¢ª
(
shoÙšgTo
[
i
].
y
()) &&

84 !
i¢ª
(
shoÙšgTo
[
i
].
y
())) {

85 
	g·š‹r
.
d¿wLšeAbs
(
robÙPos
[
i
], 
w®kšgTo
[i], "#ff0000");

86 
	g·š‹r
.
d¿wRobÙAbs
(
w®kšgTo
[
i
],"#ff0000", 
çl£
, "black");

87 
	g·š‹r
.
d¿wLšeAbs
(
robÙPos
[
i
], 
shoÙšgTo
[i], "#00ff00");

88 
	g·š‹r
.
d¿wB®lPosAbs
(
shoÙšgTo
[
i
],"#00ff00");

93 if(
	grobÙPos
.
size
() > 0){

94 
	gi
 = 0; i < 
	grobÙPos
.
size
(); ++i) {

95 ià(!
i¢ª
(
robÙPos
[
i
].
th‘a
()) &&

96 !
i¢ª
(
robÙPos
[
i
].
x
()) &&

97 !
i¢ª
(
robÙPos
[
i
].
y
())) {

98 
	g·š‹r
.
d¿wRobÙAbs
(
robÙPos
[
i
], "#fãe00", 
Œue
, "black");

99 
	g·š‹r
.
d¿wPÏy”Numb”
(
robÙPos
[
i
], i+1);

104 ià(
	gb®lPos
.
size
() > 0){

105 
	gi
 = 0; i < 
	gb®lPos
.
size
(); ++i) {

106 ià(!
i¢ª
(
b®lPos
[
i
].
x
()) &&

107 !
i¢ª
(
b®lPos
[
i
].
y
())) {

108 
	g·š‹r
.
d¿wLšeAbs
(
robÙPos
[
i
], 
w®kšgTo
[i], "#0000ff");

109 
	g·š‹r
.
d¿wB®lPosAbs
(
b®lPos
[
i
]);

113 
£tPixm­
 (*
»nd”Pixm­
);

117 
	gF›ldV›w
::
»d¿w
(
¡d
::
veùÜ
<
AbsCoÜd
> &
robÙPos
){

119 *
»nd”Pixm­
 = 
imagePixm­
;

120 if(
	grobÙPos
.
size
() > 0){

121 
F›ldPaš‹r
 
·š‹r
(
»nd”Pixm­
);

122 
	gi
 = 1; i < 
	grobÙPos
.
size
(); ++i) {

123 ià(!
i¢ª
(
robÙPos
[
i
].
th‘a
()è&& !i¢ªÔobÙPos[i].
x
()è&& !i¢ªÔobÙPos[i].
y
())) {

125 
	g·š‹r
.
d¿wRobÙAbs
(
robÙPos
[
i
], "bÏck", 
Œue
);

129 ià(!
i¢ª
(
robÙPos
[0].
th‘a
()è&& !i¢ªÔobÙPos[0].
x
()è&& !i¢ªÔobÙPos[0].
y
())) {

130 
	g·š‹r
.
d¿wRobÙAbs
(
robÙPos
[0], "#fãe00", 
Œue
);

134 
£tPixm­
 (*
»nd”Pixm­
);

139 
	gF›ldV›w
::
	$»d¿w
(
NaoD©a
 *
ÇoD©a
) {

140 *
»nd”Pixm­
 = 
imagePixm­
;

141 
BÏckbßrd
 *
bÏckbßrd
;

143 ià(! (
ÇoD©a
 && (
bÏckbßrd
 =‚aoD©a->
	`g‘Cu¼’tF¿me
 ().blackboard))) {

144 
	`£tPixm­
 (*
»nd”Pixm­
);

148 
F›ldPaš‹r
 
	`·š‹r
(
»nd”Pixm­
);

150 
boŞ
 
‹amB®lEx³rim’t
 = 
çl£
;

151 ià(
‹amB®lEx³rim’t
) {

152 cÚ¡ 
AbsCoÜd
 
robÙPos
 = 
	`»adFrom
(
loÿli§tiÚ
,„obotPos);

153 ià(!
	`i¢ª
(
robÙPos
.
	`th‘a
()è&& !i¢ªÔobÙPos.
	`x
()è&& !i¢ªÔobÙPos.
	`y
())) {

155 
·š‹r
.
	`d¿wRobÙAbs
(
robÙPos
, "blue", 
Œue
, "blue");

158 
AbsCoÜd
 
bPos
 = 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

159 ià(!
	`i¢ª
(
bPos
.
	`x
()è&& !i¢ª(bPos.
	`y
())){

160 
·š‹r
.
	`d¿wB®lPosAbs
(
bPos
, "yellow");

164 
¶ay”Numb”
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
¶ay”_numb”
);

165 
Brßdÿ¡D©a
 
‹amD©a
[
ROBOTS_PER_TEAM
];

166 
	`»adA¼ay
(
»ûiv”
, 
d©a
, 
‹amD©a
);

167 
boŞ
 
šÿ·c™©ed
[
ROBOTS_PER_TEAM
];

168 
	`»adA¼ay
(
»ûiv”
, 
šÿ·c™©ed
, incapacitated);

169 
¶ay”Index
 = 0;…Ïy”Index < 
ROBOTS_PER_TEAM
;…layerIndex++) {

170 ià(!(
šÿ·c™©ed
[
¶ay”Index
] || (¶ay”Index =ğ
¶ay”Numb”
 - 1))) {

171 
·š‹r
.
	`d¿wRobÙAbs
(
‹amD©a
[
¶ay”Index
].
robÙPos
, "blue", 
Œue
, "blue");

172 ià(!
	`i¢ª
(
‹amD©a
[
¶ay”Index
].
b®lPosAbs
.
	`x
())) {

173 
·š‹r
.
	`d¿wB®lPosAbs
(
‹amD©a
[
¶ay”Index
].
b®lPosAbs
, "yellow");

178 
T—mB®lInfo
 
‹amB®l
 = 
	`»adFrom
(
loÿli§tiÚ
,eamBall);

179 ià(
‹amB®l
.
cÚŒibutÜs
 > 0){

180 
·š‹r
.
	`d¿wB®lPosAbs
(
‹amB®l
.
pos
, 
	`QCŞÜ
(255, 0, 255));

182 
	`£tPixm­
 (*
»nd”Pixm­
);

187 
·š‹r
.
	`d¿wGßlA»a
(
	`»adFrom
(
visiÚ
, 
gßlA»a
));

191 cÚ¡ 
AbsCoÜd
 
robÙPos
 = 
	`»adFrom
(
loÿli§tiÚ
,„obotPos);

192 ià(!
	`i¢ª
(
robÙPos
.
	`th‘a
()è&& !i¢ªÔobÙPos.
	`x
()è&& !i¢ªÔobÙPos.
	`y
())) {

193 
·š‹r
.
	`d¿wRobÙAbs
(
robÙPos
, "#fãe00", 
Œue
, "black");

196 
AbsCoÜd
 
bPos
 = 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

197 ià(!
	`i¢ª
(
bPos
.
	`x
()è&& !i¢ª(bPos.
	`y
())){

198 
·š‹r
.
	`d¿wB®lPosAbs
(
bPos
);

203 
¶ay”Numb”
 = 
	`»adFrom
(
gameCÚŒŞËr
, 
¶ay”_numb”
);

204 
Brßdÿ¡D©a
 
‹amD©a
[
ROBOTS_PER_TEAM
];

205 
	`»adA¼ay
(
»ûiv”
, 
d©a
, 
‹amD©a
);

206 
boŞ
 
šÿ·c™©ed
[
ROBOTS_PER_TEAM
];

207 
	`»adA¼ay
(
»ûiv”
, 
šÿ·c™©ed
, incapacitated);

208 
¶ay”Index
 = 0;…Ïy”Index < 
ROBOTS_PER_TEAM
;…layerIndex++) {

209 ià(!(
šÿ·c™©ed
[
¶ay”Index
] ||

210 
¶ay”Index
 =ğ
¶ay”Numb”
 - 1 ||

211 
	`i¢ª
(
‹amD©a
[
¶ay”Index
].
b®lPosAbs
.
	`x
()))){

212 
·š‹r
.
	`d¿wB®lPosAbs
(
‹amD©a
[
¶ay”Index
].
b®lPosAbs
, "yellow");

216 
AbsCoÜd
 
pos
 = 
robÙPos
;

217 
boŞ
 
d¿wRR
 = 
Œue
;

220 ià(
d¿wRR
) {

223 
¡d
::
veùÜ
<
B®lInfo
> 
b®ls
 = 
	`»adFrom
(
visiÚ
, balls);

224 
¡d
::
veùÜ
<
B®lInfo
>::
™”©Ü
 
b®l_i
;

225 
b®l_i
 = 
b®ls
.
	`begš
 (); b®l_˜!ğb®ls.
	`’d
 (); ++ball_i) {

226 
·š‹r
.
	`d¿wB®lRR
(*
b®l_i
, 
pos
);

230 
¡d
::
veùÜ
<
Po¡Info
> 
po¡s
 = 
	`»adFrom
(
visiÚ
,…osts);

231 
¡d
::
veùÜ
<
Po¡Info
>::
™”©Ü
 
po¡_i
;

232 
po¡_i
 = 
po¡s
.
	`begš
 ();…o¡_˜<…o¡s.
	`’d
 (); ++…ost_i) {

233 
·š‹r
.
	`d¿wPo¡RR
(*
po¡_i
, 
pos
);

243 
veùÜ
<
RobÙOb¡aşe
> 
robÙOb¡aşes
 = 
	`»adFrom
(
loÿli§tiÚ
,„obotObstacles);

244 
veùÜ
<
RobÙOb¡aşe
>::
™”©Ü
 
robÙobs_i
;

245 
robÙobs_i
 = 
robÙOb¡aşes
.
	`begš
();„obÙobs_˜!ğrobÙOb¡aşes.
	`’d
(); ++„obotobs_i) {

246 
absX
 = 
robÙobs_i
->
¼
.
	`di¡ªû
(è* 
	`cos
ÔobÙobs_i->¼.
	`h—dšg
(è+ 
pos
.
	`th‘a
());

247 
absY
 = 
robÙobs_i
->
¼
.
	`di¡ªû
(è* 
	`sš
ÔobÙobs_i->¼.
	`h—dšg
(è+ 
pos
.
	`th‘a
());

248 
absX
 +ğ
pos
.
	`x
();

249 
absY
 +ğ
pos
.
	`y
();

250 
AbsCoÜd
 
	`absRobÙ
(
absX
, 
absY
, 0);

251 
Eig’
::
M©rix
<, 2, 2> 
rÙ©iÚ
 = Eig’::
RÙ©iÚ2D
<>(
pos
.
	`th‘a
()).
	`toRÙ©iÚM©rix
();

252 
absRobÙ
.
v¬
.
	`block
(0,0,2,2èğ
rÙ©iÚ
 * 
robÙobs_i
->
¼
.v¬.block(0,0,2,2è*„Ù©iÚ.
	`šv”£
();

253 
absRobÙ
.
	`v¬
(2,2) = 0.f;

255 if(
robÙobs_i
->
ty³
 =ğ
RobÙInfo
::
rRed
) {

256 
·š‹r
.
	`d¿wRobÙAbs
(
absRobÙ
, "pink");

257 } if(
robÙobs_i
->
ty³
 =ğ
RobÙInfo
::
rBlue
) {

258 
·š‹r
.
	`d¿wRobÙAbs
(
absRobÙ
, "#7f7fff");

260 
·š‹r
.
	`d¿wRobÙAbs
(
absRobÙ
, "#00ff00");

265 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
ã©u»s
 = 
	`»adFrom
(
visiÚ
,
f›ldF—tu»s
);

266 
¡d
::
veùÜ
<
F›ldF—tu»Info
>::
™”©Ü
 
ã©u»_i
;

267 
ã©u»_i
 = 
ã©u»s
.
	`begš
 (); f—tu»_˜< f—tu»s.
	`’d
 ();

268 ++ 
ã©u»_i
) {

269 
·š‹r
.
	`d¿wF—tu»RR
(*
ã©u»_i
, 
pos
);

283 
	`£tPixm­
 (*
»nd”Pixm­
);

285 
	}
}

	@utils/offnao/tabs/fieldView.hpp

32 #´agm¨
Úû


34 
	~<io¡»am
>

35 
	~<QLab–
>

36 
	~<QPixm­
>

37 
	~<QPošt
>

38 
	~<QPaš‹r
>

39 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

40 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

41 
	~"uts/Logg”.hµ
"

42 
	~"ÇoD©a.hµ
"

43 
	~"äame.hµ
"

44 
	~"ty³s/Rª§cTy³s.hµ
"

45 
	~"ty³s/Brßdÿ¡D©a.hµ
"

47 şas 
	cF›ldV›w
: 
public
 
QLab–
 {

48 
public
:

49 
F›ldV›w
();

50 ~
F›ldV›w
();

52 
»d¿w
(
NaoD©a
 *
ÇoD©a
);

55 
»d¿w
(
¡d
::
veùÜ
<
AbsCoÜd
> &
robÙPos
);

57 
»d¿w
(
¡d
::
veùÜ
<
AbsCoÜd
> &
robÙPos
,

58 
¡d
::
veùÜ
<
AbsCoÜd
> &
w®kšgTo
,

59 
¡d
::
veùÜ
<
AbsCoÜd
> &
b®lPos
,

60 
¡d
::
veùÜ
<
AbsCoÜd
> &
shoÙšgTo
);

62 
	m´iv©e
:

63 
QImage
 
image
;

64 
QPixm­
 
	mimagePixm­
;

65 
QPixm­
 *
	m»nd”Pixm­
;

	@utils/offnao/tabs/graphTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QDebug
>

36 
	~<io¡»am
>

37 
	~<s¡»am
>

38 
	~"g¿phTab.hµ
"

39 
	~"uts/basic_m©hs.hµ
"

40 
	~"uts/body.hµ
"

41 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

42 
	~"bÏckbßrd/BÏckbßrd.hµ
"

43 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

46 
usšg
 
Çme¥aû
 
	g¡d
;

48 
	gG¿phTab
::
	$G¿phTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
,

49 
VisiÚ
 *
visiÚ
) {

50 
	`š™M’u
(
m’uB¬
);

51 
	`š™
();

52 
this
->
visiÚ
 = vision;

53 
this
->
·»Á
 =…arent;

54 
	}
}

56 
	gG¿phTab
::
	$š™M’u
(
QM’uB¬
 *) {

57 
	}
}

59 
G¿phTab
::
	$š™
() {

61 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

62 
	`£tLayout
(
Ïyout
);

63 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

64 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

65 
Ïyout
->
	`£tV”tiÿlS·cšg
(5);

67 
Ï¡_äame
 = -1;

69 
i
 = 0; i < 3; i++) {

70 
accPlÙs
[
i
] = 
Ãw
 
	`MuÉiPlÙ
(
this
, 
S’sÜs
::
£nsÜNames
[S’sÜs::
IÃ¹ŸlS’sÜ_AccX
+i], 2, -15, 15);

71 
Ïyout
->
	`addWidg‘
(
accPlÙs
[
i
], 0, i);

74 
i
 = 0; i < 2; i++) {

75 
gyrPlÙs
[
i
] = 
Ãw
 
	`MuÉiPlÙ
(
this
, 
S’sÜs
::
£nsÜNames
[S’sÜs::
IÃ¹ŸlS’sÜ_GyrX
+i], 2, -2, 2);

76 
Ïyout
->
	`addWidg‘
(
gyrPlÙs
[
i
], 1, i);

78 
gyrPlÙs
[2] = 
Ãw
 
	`MuÉiPlÙ
(
this
, 
S’sÜs
::
£nsÜNames
[S’sÜs::
IÃ¹ŸlS’sÜ_GyroscİeZ
], 1, -2, 2);

79 
Ïyout
->
	`addWidg‘
(
gyrPlÙs
[2], 1, 2);

81 
i
 = 0; i < 2; i++) {

82 
ªgËPlÙs
[
i
] = 
Ãw
 
	`MuÉiPlÙ
(
this
, 
S’sÜs
::
£nsÜNames
[S’sÜs::
IÃ¹ŸlS’sÜ_AngËX
+i], 1, -1, 1);

83 
Ïyout
->
	`addWidg‘
(
ªgËPlÙs
[
i
], 2, i);

85 
odomPlÙ
 = 
Ãw
 
	`MuÉiPlÙ
(
this
, "Turn„ate", 2, -180, 180);

86 
Ïyout
->
	`addWidg‘
(
odomPlÙ
, 2, 2);

87 
	}
}

89 
	gG¿phTab
::
	$upd©ePlÙs
(
S’sÜV®ues
 
s
, 
Odom‘ry
 
o
, 
boŞ
 
Ëá
) {

90 
i
 = 0; i < 3; i++) {

91 
¡d
::
veùÜ
<> 
acc
;

92 
acc
.
	`push_back
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AccX
+
i
]);

93 
acc
.
	`push_back
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AcûËrom‘”X
+
i
]);

94 
accPlÙs
[
i
]->
	`push
(
acc
, 
Ëá
);

96 
i
 = 0; i < 2; i++) {

97 
¡d
::
veùÜ
<> 
gyro
;

98 
gyro
.
	`push_back
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
+
i
]);

99 
gyro
.
	`push_back
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyroscİeX
+
i
]);

100 
gyrPlÙs
[
i
]->
	`push
(
gyro
, 
Ëá
);

102 
¡d
::
veùÜ
<> 
gyro
;

103 
gyro
.
	`push_back
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyroscİeZ
]);

104 
gyrPlÙs
[2]->
	`push
(
gyro
, 
Ëá
);

105 
i
 = 0; i < 2; i++) {

106 
¡d
::
veùÜ
<> 
ªgË
;

107 
ªgË
.
	`push_back
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
+
i
]);

108 
ªgËPlÙs
[
i
]->
	`push
(
ªgË
, 
Ëá
);

110 
¡d
::
veùÜ
<> 
odom
;

111 
odom
.
	`push_back
(-
	`RAD2DEG
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyroscİeZ
]));

112 
odom
.
	`push_back
(
	`RAD2DEG
(
o
.
tuº
));

113 
odomPlÙ
->
	`push
(
odom
, 
Ëá
);

114 
	}
}

116 
	gG¿phTab
::
upd©ePlÙs
(
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
, std::veùÜ<
Odom‘ry
> 
o
, 
boŞ
 
Ëá
) {

117 ià(
	gËá
)

118 
	gi
 = 
s
.
size
() - 1; i > 0; i--) {

119 
upd©ePlÙs
(
s
[
i
], 
o
[i], 
Ëá
);

122 
u_št
 
	gi
 = 0; i < 
	gs
.
size
(); i++) {

123 
upd©ePlÙs
(
s
[
i
], 
o
[i], 
Ëá
);

127 
	gG¿phTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

131 ià(!
ÇoD©a
 || !ÇoD©a->
	`g‘Cu¼’tF¿me
().
bÏckbßrd
) {

133 } ià(
ÇoD©a
->
	`g‘F¿mesTÙ®
() != 0) {

134 
Ãw_äame
 = 
ÇoD©a
->
	`g‘Cu¼’tF¿meIndex
();

135 ià(
Ãw_äame
 =ğ
Ï¡_äame
 + 1) {

137 
BÏckbßrd
 *
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

138 
S’sÜV®ues
 
s
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
);

139 
Odom‘ry
 
odom‘ry
 = 
	`»adFrom
(
mÙiÚ
, odometry);

140 
	`upd©ePlÙs
(
s
, 
odom‘ry
);

141 } ià(
Ãw_äame
 =ğ
Ï¡_äame
 - 1) {

153 } ià(
	`ABS
(
Ãw_äame
 - 
Ï¡_äame
è> 
PLOT_SIZE
) {

155 
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
;

156 
¡d
::
veùÜ
<
Odom‘ry
> 
o
;

157 
S’sÜV®ues
 
em±yS
;

158 
Odom‘ry
 
em±yO
;

159 ià(
Ãw_äame
 < 
PLOT_SIZE
 - 1)

160 
ušt8_t
 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i)

161 
em±yS
.
£nsÜs
[
i
] = 0.0f;

162 
i
 = 
Ãw_äame
 - 
PLOT_SIZE
 + 1; i <=‚ew_frame; ++i) {

163 ià(
i
 >= 0) {

164 
s
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
£nsÜs
);

165 
o
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
odom‘ry
);

167 
s
.
	`push_back
(
em±yS
);

168 
o
.
	`push_back
(
em±yO
);

171 
	`upd©ePlÙs
(
s
, 
o
);

172 } ià(
Ãw_äame
 < 
Ï¡_äame
) {

174 
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
;

175 
¡d
::
veùÜ
<
Odom‘ry
> 
o
;

176 
S’sÜV®ues
 
em±yS
;

177 
Odom‘ry
 
em±yO
;

178 ià(
Ãw_äame
 < 
PLOT_SIZE
 - 1)

179 
ušt8_t
 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i)

180 
em±yS
.
£nsÜs
[
i
] = 0.0f;

181 
i
 = 
Ãw_äame
 - 
PLOT_SIZE
 + 1; i <=‚ew_frame; ++i) {

182 ià(
i
 >= 0) {

183 
s
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
£nsÜs
);

184 
o
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
odom‘ry
);

186 
s
.
	`push_back
(
em±yS
);

187 
o
.
	`push_back
(
em±yO
);

191 
	`upd©ePlÙs
(
s
, 
o
, 
Œue
);

192 } ià(
Ãw_äame
 > 
Ï¡_äame
) {

194 
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
;

195 
¡d
::
veùÜ
<
Odom‘ry
> 
o
;

196 
i
 = 
Ï¡_äame
 + 1; i <ğ
Ãw_äame
; ++i) {

197 
s
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
£nsÜs
);

198 
o
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
odom‘ry
);

200 
	`upd©ePlÙs
(
s
, 
o
);

202 
Ï¡_äame
 = 
Ãw_äame
;

204 
	}
}

206 
	gG¿phTab
::
	$»ad”Clo£d
() {

207 
	}
}

	@utils/offnao/tabs/graphTab.hpp

32 #´agm¨
Úû


34 
	~<QTabWidg‘
>

36 
	~<QM’uB¬
>

37 
	~<QWidg‘
>

38 
	~<QObjeù
>

39 
	~<QEv’t
>

40 
	~<QGridLayout
>

41 
	~<QPixm­
>

42 
	~<QLab–
>

43 
	~<QPaš‹r
>

44 
	~<QCŞÜ
>

45 
	~<QT»eWidg‘I‹m
>

46 
	~<QT»eWidg‘
>

47 
	~<QLab–
>

49 
	~<c¡dio
>

50 
	~<deque
>

52 
	~"bs/b.hµ
"

53 
	~"bs/v¬ŸbËV›w.hµ
"

54 
	~"bs/¶Ùs.hµ
"

55 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

56 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

57 
	~"uts/Logg”.hµ
"

58 
	~"f›ldV›w.hµ
"

59 
	~"medŸPª–.hµ
"

61 
şass
 
	gVisiÚ
;

63 şas 
	cG¿phTab
 : 
public
 
Tab
 {

64 
Q_OBJECT


65 
public
:

66 
G¿phTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

67 
	m´iv©e
:

68 
š™
();

69 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

70 
upd©ePlÙs
(
S’sÜV®ues
 
s
, 
Odom‘ry
 
o
, 
boŞ
 
Ëá
=
çl£
);

71 
upd©ePlÙs
(
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
, std::veùÜ<
Odom‘ry
> 
o
, 
boŞ
 
Ëá
=
çl£
);

72 
QGridLayout
 *
	mÏyout
;

73 
MuÉiPlÙ
* 
	maccPlÙs
[3];

74 
MuÉiPlÙ
* 
	mgyrPlÙs
[3];

75 
MuÉiPlÙ
* 
	mªgËPlÙs
[2];

76 
MuÉiPlÙ
* 
	modomPlÙ
;

77 
	mÏ¡_äame
;

78 
public
 
	m¦Ùs
:

79 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

80 
»ad”Clo£d
();

	@utils/offnao/tabs/icpFieldView.cpp

32 
	~"iıF›ldV›w.hµ
"

33 
	~<QCŞÜ
>

34 
	~<QBrush
>

35 
	~<QImage
>

36 
	~<QReùF
>

38 
	~"uts/F›ldPaš‹r.hµ
"

39 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

40 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

41 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

42 
	~"³rû±iÚ/visiÚ/Ùh”/RobÙRegiÚ.hµ
"

43 
	~"³rû±iÚ/loÿli§tiÚ/Loÿli§tiÚDefs.hµ
"

44 
	~"uts/Logg”.hµ
"

45 
	~"uts/šÿ·c™©ed.hµ
"

46 
	~"bÏckbßrd/BÏckbßrd.hµ
"

47 
	~"´ogİts.hµ
"

48 
	~"³rû±iÚ/loÿli§tiÚ/ICP.hµ
"

50 
usšg
 
Çme¥aû
 
	g¡d
;

52 
	gICPF›ldV›w
::
	$ICPF›ldV›w
(è: 
	`image
(":/images/spl_field.svg") {

53 
»nd”Pixm­
 = 
Ãw
 
	`QPixm­
(640, 480);

55 
imagePixm­
 = 
	`QPixm­
(640, 480);

56 
QReùF
 
	`rg‘
(0.0, 0.0, 640.0, 480.0);

57 
QReùF
 
	`sourû
(0.0, 0.0, 740, 540.0);

58 
QPaš‹r
 
	`·š‹r
(&
imagePixm­
);

59 
·š‹r
.
	`d¿wImage
(
rg‘
, 
image
, 
sourû
);

61 
»nd”Pixm­
->
	`fl
(
Qt
::
d¬kG¿y
);

62 
	`£tPixm­
(*
»nd”Pixm­
);

63 
	`£tMšimumSize
(640, 480);

64 
	`£tMaximumSize
(640, 480);

65 
	`£tAlignm’t
(
Qt
::
AlignTİ
);

66 
	}
}

68 
	gICPF›ldV›w
::~
	$ICPF›ldV›w
() {

69 
	}
}

71 
ICPF›ldV›w
::
	$»d¿w
() {

72 *
»nd”Pixm­
 = 
imagePixm­
;

73 
	`£tPixm­
 (*
»nd”Pixm­
);

75 
	}
}

77 
	gICPF›ldV›w
::
	$»d¿w
(
BÏckbßrd
 *
bÏckbßrd
,

78 cÚ¡ 
AbsCoÜd
 &
robÙPos
,

79 
iıResuÉ
,

80 cÚ¡ 
AbsCoÜd
 &
iıObs
,

81 cÚ¡ 
AbsCoÜd
 &
b®lRRC
,

82 cÚ¡ 
AbsCoÜd
 &
‹amB®l
) {

84 *
»nd”Pixm­
 = 
imagePixm­
;

85 
F›ldPaš‹r
 
	`·š‹r
(
»nd”Pixm­
);

87 
AbsCoÜd
 
ªchÜ
;

88 ià(
iıResuÉ
 >ğ
ICP_LOCALISED
){

89 
ªchÜ
 = 
iıObs
;

91 
ªchÜ
 = 
robÙPos
;

95 ià(!
	`i¢ª
(
robÙPos
.
	`th‘a
()è&& !i¢ªÔobÙPos.
	`x
()è&& !i¢ªÔobÙPos.
	`y
())) {

98 ià(!
	`i¢ª
(
‹amB®l
.
	`x
()è&& !i¢ªÑ—mB®l.
	`y
())){

99 
·š‹r
.
	`d¿wB®lPosAbs
(
‹amB®l
, 
	`QCŞÜ
(255, 0, 255));

102 
·š‹r
.
	`d¿wRobÙAbs
(
robÙPos
, "#fãe00", 
Œue
, "black");

104 ià(
iıResuÉ
 >ğ
ICP_LOCALISED
) {

107 ià(!
	`i¢ª
(
iıObs
.
	`th‘a
()è&& !i¢ª(iıObs.
	`x
()è&& !i¢ª(iıObs.
	`y
())) {

108 
·š‹r
.
	`d¿wRobÙAbs
(
iıObs
, "blue", 
Œue
, "blue");

114 ià((!
	`i¢ª
(
ªchÜ
.
	`th‘a
()è&& !i¢ª×nchÜ.
	`x
()è&& !i¢ª×nchÜ.
	`y
()))) {

116 
¡d
::
veùÜ
<
Po¡Info
> 
po¡s
 = 
	`»adFrom
(
visiÚ
,…osts);

117 
¡d
::
veùÜ
<
Po¡Info
>::
™”©Ü
 
po¡_i
;

118 
po¡_i
 = 
po¡s
.
	`begš
 ();…o¡_˜<…o¡s.
	`’d
 (); ++…ost_i) {

119 
·š‹r
.
	`d¿wPo¡RR
(*
po¡_i
, 
ªchÜ
);

123 
AbsCoÜd
 
bV–
;

124 ià(!
	`i¢ª
(
b®lRRC
.
	`x
()è&& !i¢ª(b®lRRC.
	`y
())){

125 
·š‹r
.
	`d¿wB®lPosRRC
(
b®lRRC
, 
bV–
, 
çl£
, 
ªchÜ
);

130 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
ã©u»s
 = 
	`»adFrom
(
visiÚ
,
f›ldF—tu»s
);

131 
¡d
::
veùÜ
<
F›ldF—tu»Info
>::
™”©Ü
 
ã©u»_i
;

132 
ã©u»_i
 = 
ã©u»s
.
	`begš
 (); f—tu»_˜< f—tu»s.
	`’d
 ();

133 ++ 
ã©u»_i
) {

134 
·š‹r
.
	`d¿wF—tu»RR
(*
ã©u»_i
, 
ªchÜ
);

150 
¡d
::
veùÜ
<
LšeInfo
>::
cÚ¡_™”©Ü
 
lše
 = 
ICP
::
	`g‘AÎF›ldLšes
().
	`begš
();

151 ; 
lše
 !ğ
ICP
::
	`g‘AÎF›ldLšes
().
	`’d
(); ++line) {

152 
·š‹r
.
	`d¿wF›ldLše
(*
lše
);

156 
	`£tPixm­
 (*
»nd”Pixm­
);

158 
	}
}

	@utils/offnao/tabs/icpFieldView.hpp

32 #´agm¨
Úû


34 
	~<io¡»am
>

35 
	~<QLab–
>

36 
	~<QPixm­
>

37 
	~<QPošt
>

38 
	~<QPaš‹r
>

39 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

40 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

41 
	~"uts/Logg”.hµ
"

42 
	~"ÇoD©a.hµ
"

43 
	~"äame.hµ
"

44 
	~"ty³s/Rª§cTy³s.hµ
"

45 
	~"ty³s/Brßdÿ¡D©a.hµ
"

47 şas 
	cICPF›ldV›w
: 
public
 
QLab–
 {

48 
public
:

49 
ICPF›ldV›w
();

50 ~
ICPF›ldV›w
();

52 
»d¿w
();

53 
»d¿w
(
BÏckbßrd
 *
bÏckbßrd
,

54 cÚ¡ 
AbsCoÜd
 &
robÙPos
,

55 
iıResuÉ
,

56 cÚ¡ 
AbsCoÜd
 &
iıObs
,

57 cÚ¡ 
AbsCoÜd
 &
b®lRRC
 = AbsCoÜd(
NAN
,NAN,NAN),

58 cÚ¡ 
AbsCoÜd
 &
‹amB®l
 = AbsCoÜd(
NAN
,NAN,NAN));

60 
	m´iv©e
:

61 
QImage
 
image
;

62 
QPixm­
 
	mimagePixm­
;

63 
QPixm­
 *
	m»nd”Pixm­
;

	@utils/offnao/tabs/icpTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QDebug
>

35 
	~<QB™m­
>

36 
	~<QGroupBox
>

39 
	~<ut™y
>

40 
	~<io¡»am
>

41 
	~"iıTab.hµ
"

42 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

43 
	~"³rû±iÚ/kšem©ics/Po£.hµ
"

44 
	~"bÏckbßrd/BÏckbßrd.hµ
"

46 
	~"uts/CPÏÃCŞours.hµ
"

48 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

50 
	#DEBUG_IMAGE_ROWS
 (
IMAGE_ROWS
 / 4)

	)

51 
	#DEBUG_IMAGE_COLS
 (
IMAGE_COLS
 / 4)

	)

53 
usšg
 
Çme¥aû
 
	g¡d
;

55 
	gICPTab
::
	$ICPTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
,

56 
VisiÚ
 *
visiÚ
è: 
	$bÏckbßrd
(0) {

57 
	`š™M’u
(
m’uB¬
);

58 
	`š™
();

59 
this
->
visiÚ
 = vision;

60 
	`mem£t
(
tİS®›ncy
, 0, 
TOP_SALIENCY_ROWS
*
TOP_SALIENCY_COLS
*(
CŞour
));

61 
	`mem£t
(
bÙS®›ncy
, 0, 
BOT_SALIENCY_ROWS
*
BOT_SALIENCY_COLS
*(
CŞour
));

62 
this
->
·»Á
 =…arent;

63 
	}
}

66 
	gICPTab
::
	$š™M’u
(
QM’uB¬
 *) {

67 
	}
}

69 
ICPTab
::
	$š™
() {

70 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

71 
	`£tLayout
(
Ïyout
);

72 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

74 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

75 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

78 
Ïyout
->
	`addWidg‘
(&
f›ldV›w
, 0, 0, 2, 1);

81 
f›ldV›w
.
	`»d¿w
();

83 
tİImagePixm­
 = 
	`QPixm­
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

84 
tİImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

85 
tİCamLab–
 = 
Ãw
 
	`QLab–
();

86 
tİCamLab–
->
	`£tPixm­
(
tİImagePixm­
);

87 
tİCamLab–
->
	`£tMšimumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

88 
tİCamLab–
->
	`£tMaximumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

89 
Ïyout
->
	`addWidg‘
(
tİCamLab–
, 0, 1, 1, 2);

91 
bÙImagePixm­
 = 
	`QPixm­
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

92 
bÙImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

93 
bÙCamLab–
 = 
Ãw
 
	`QLab–
();

94 
bÙCamLab–
->
	`£tPixm­
(
bÙImagePixm­
);

95 
bÙCamLab–
->
	`£tMšimumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

96 
bÙCamLab–
->
	`£tMaximumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

97 
Ïyout
->
	`addWidg‘
(
bÙCamLab–
, 1, 1, 1, 2);

101 
QGroupBox
 *
£tup
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("Robot Position Setup"));

103 
Ïyout
->
	`addWidg‘
(
£tup
, 0, 3, 1, 1);

105 
QGridLayout
 *
£tupGroupLayout
 = 
Ãw
 
	`QGridLayout
();

106 
£tup
->
	`£tLayout
(
£tupGroupLayout
);

108 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("X: "), 1, 1);

109 
ŒueX
 = 
Ãw
 
	`QLšeEd™
("-1500");

110 
£tupGroupLayout
->
	`addWidg‘
(
ŒueX
, 1, 2);

111 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Y: "), 2, 1);

112 
ŒueY
 = 
Ãw
 
	`QLšeEd™
("0.0");

113 
£tupGroupLayout
->
	`addWidg‘
(
ŒueY
, 2, 2);

114 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Theta: "), 3, 1);

115 
ŒueTh‘a
 = 
Ãw
 
	`QLšeEd™
("0.0");

116 
£tupGroupLayout
->
	`addWidg‘
(
ŒueTh‘a
, 3, 2);

118 
lo¡Bu‰Ú
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`QSŒšg
("Lost"));

119 
lo¡Bu‰Ú
->
	`£tChecked
(
çl£
);

120 
£tupGroupLayout
->
	`addWidg‘
(
lo¡Bu‰Ú
, 4, 1, 1, 2, 
Qt
::
AlignHC’‹r
);

122 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("TeamBall X: "), 5, 1);

123 
b®lX
 = 
Ãw
 
	`QLšeEd™
("1500");

124 
£tupGroupLayout
->
	`addWidg‘
(
b®lX
, 5, 2);

125 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("TeamBall Y: "), 6, 1);

126 
b®lY
 = 
Ãw
 
	`QLšeEd™
("0.0");

127 
£tupGroupLayout
->
	`addWidg‘
(
b®lY
, 6, 2);

130 
‹amB®lBu‰Ú
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`QSŒšg
("Add Team Ball"));

131 
‹amB®lBu‰Ú
->
	`£tChecked
(
çl£
);

132 
£tupGroupLayout
->
	`addWidg‘
(
‹amB®lBu‰Ú
, 7, 1, 1, 2, 
Qt
::
AlignHC’‹r
);

135 
š™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("Set…osition");

136 
£tupGroupLayout
->
	`addWidg‘
(
š™Bu‰Ú
, 8, 1, 1, 2);

138 
	`cÚÃù
(
š™Bu‰Ú
, 
	`SIGNAL
(
	`»Ëa£d
()), 
this
, 
	`SLOT
(
	`£tPos
()));

140 
QGroupBox
 *
šfo
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("ICP Information"));

141 
QGridLayout
 *
šfoGroupLayout
 = 
Ãw
 
	`QGridLayout
();

142 
šfo
->
	`£tLayout
(
šfoGroupLayout
);

143 
iıInfo
 = 
Ãw
 
	`QLab–
();

144 
iıInfo
->
	`£tAlignm’t
(
Qt
::
AlignTİ
 | Qt::
AlignLeá
);

145 
iıInfo
->
	`£tFÚt
(
	`QFÚt
("Monospace"));

146 
iıInfo
->
	`£tText
("hello world");

147 
šfoGroupLayout
->
	`addWidg‘
(
iıInfo
, 0, 0);

149 
Ïyout
->
	`addWidg‘
(
šfo
, 1, 3);

151 
	`£tPos
();

152 
	}
}

154 
	gICPTab
::
	$£tPos
() {

155 
fixedPos
.
	`x
(èğ
ŒueX
->
	`‹xt
().
	`toFlßt
();

156 
fixedPos
.
	`y
(èğ
ŒueY
->
	`‹xt
().
	`toFlßt
();

157 
fixedPos
.
	`th‘a
(èğ
	`DEG2RAD
(
ŒueTh‘a
->
	`‹xt
().
	`toFlßt
());

158 
fixedPos
.
	`v¬
(0, 0) = 50000;

159 
fixedPos
.
	`v¬
(1, 1) = 50000;

160 
fixedPos
.
	`v¬
(2, 2èğ
	`DEG2RAD
(10);

161 
isLo¡
 = 
lo¡Bu‰Ú
->
	`isChecked
();

162 
‹amB®l
.
	`x
(èğ
b®lX
->
	`‹xt
().
	`toFlßt
();

163 
‹amB®l
.
	`y
(èğ
b®lY
->
	`‹xt
().
	`toFlßt
();

164 
‹amB®l
.
	`v¬
(0, 0) = 50000;

165 
‹amB®l
.
	`v¬
(1, 1) = 50000;

166 
u£T—mB®l
 = 
‹amB®lBu‰Ú
->
	`isChecked
();

167 
	`d¿wICP
();

168 
	}
}

170 
	gICPTab
::
	$»d¿w
() {

171 ià(
tİF¿me
 || 
bÙF¿me
 || 
tİS®›ncy
 || 
bÙS®›ncy
) {

172 
QImage
 *
tİImage
;

173 
QImage
 *
bÙImage
;

175 ià(
tİF¿me
 && 
bÙF¿me
) {

176 
tİImage
 = 
Ãw
 
	`QImage
(
IMAGE_COLS
, 
IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

177 
bÙImage
 = 
Ãw
 
	`QImage
(
IMAGE_COLS
, 
IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

179 
tİImage
 = 
Ãw
 
	`QImage
(
TOP_SALIENCY_COLS
,

180 
TOP_SALIENCY_ROWS
,

181 
QImage
::
FÜm©_RGB32
);

182 
bÙImage
 = 
Ãw
 
	`QImage
(
BOT_SALIENCY_COLS
,

183 
BOT_SALIENCY_ROWS
,

184 
QImage
::
FÜm©_RGB32
);

186 
	`d¿wImage
(
tİImage
, 
bÙImage
);

189 
tİImagePixm­
 = 
QPixm­
::
	`äomImage
(

190 
tİImage
->
	`sÿËd
(2*
DEBUG_IMAGE_COLS
, 2*
DEBUG_IMAGE_ROWS
));

191 
bÙImagePixm­
 = 
QPixm­
::
	`äomImage
(

192 
bÙImage
->
	`sÿËd
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
));

194 
	`d¿wOv”Ïys
(&
tİImagePixm­
, &
bÙImagePixm­
);

197 
tİImagePixm­
 =İImagePixm­.
	`sÿËd
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

199 
d–‘e
 
tİImage
;

200 
d–‘e
 
bÙImage
;

202 
tİImagePixm­
 = 
	`QPixm­
(
IMAGE_COLS
, 
IMAGE_ROWS
);

203 
tİImagePixm­
.
	`fl
(
Qt
::
d¬kRed
);

204 
bÙImagePixm­
 = 
	`QPixm­
(
IMAGE_COLS
, 
IMAGE_ROWS
);

205 
bÙImagePixm­
.
	`fl
(
Qt
::
d¬kRed
);

207 
tİCamLab–
->
	`£tPixm­
(
tİImagePixm­
);

208 
bÙCamLab–
->
	`£tPixm­
(
bÙImagePixm­
);

209 
	}
}

211 
	gICPTab
::
	$d¿wOv”Ïys
(
QPixm­
 *
tİImage
, QPixm­ *
bÙImage
) {

212 ià(!
bÏckbßrd
) ;

214 
¡d
::
veùÜ
<
FoÙInfo
> 
ã‘
 = std::vector<FootInfo>();

216 
¡d
::
veùÜ
<
B®lInfo
> 
b®ls
 = 
	`»adFrom
(
visiÚ
, balls);

217 
¡d
::
veùÜ
<
Po¡Info
> 
po¡s
 = 
	`»adFrom
(
visiÚ
,…osts);

218 
¡d
::
veùÜ
<
RobÙInfo
> 
robÙs
 = 
	`»adFrom
(
visiÚ
,„obots);

219 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> 
f›ldBound¬›s
 = 
	`»adFrom
(
visiÚ
, fieldBoundaries);

220 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
f›ldF—tu»s
 = 
	`»adFrom
(
visiÚ
, fieldFeatures);

221 
¡d
::
veùÜ
<
Ipošt
> 
Ïndm¬ks
 = 
	`»adFrom
(
visiÚ
,†andmarks);

223 
¡d
::
·œ
<, > 
hÜizÚ
 = 
	`»adFrom
(
mÙiÚ
, 
po£
).
	`g‘HÜizÚ
();

224 
¡d
::
·œ
<, > *
hÜizÚ_p
 = &
hÜizÚ
;

226 
	`d¿wOv”ÏysG’”ic
 (
tİImage
,

227 
bÙImage
,

228 
hÜizÚ_p
,

229 &
ã‘
,

230 &
b®ls
,

231 &
po¡s
,

232 &
robÙs
,

233 &
f›ldBound¬›s
,

234 &
f›ldF—tu»s
,

235 &
Ïndm¬ks
,

259 
	}
}

262 
	gICPTab
::
	$d¿wImage
(
QImage
 *
tİImage
, QImag*
bÙImage
) {

302 
	}
}

306 
	gICPTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

308 ià(!
ÇoD©a
 || !ÇoD©a->
	`g‘Cu¼’tF¿me
().
bÏckbßrd
) {

309 
tİImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

310 
tİCamLab–
->
	`£tPixm­
(
tİImagePixm­
);

311 
bÙImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

312 
bÙCamLab–
->
	`£tPixm­
(
bÙImagePixm­
);

313 } ià(
ÇoD©a
->
	`g‘F¿mesTÙ®
() != 0) {

314 
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

315 
tİF¿me
 = 
	`»adFrom
(
visiÚ
,opFrame);

316 
bÙF¿me
 = 
	`»adFrom
(
visiÚ
, botFrame);

317 ià(!
tİF¿me
) {

318 ià(
	`»adFrom
(
visiÚ
, 
tİS®›ncy
))

319 
	`memıy
(
tİS®›ncy
, 
	`»adFrom
(
visiÚ
,opSaliency),

320 
TOP_SALIENCY_ROWS
*
TOP_SALIENCY_COLS
*(
CŞour
));

322 ià(!
bÙF¿me
) {

323 ià(
	`»adFrom
(
visiÚ
, 
bÙS®›ncy
))

324 
	`memıy
(
bÙS®›ncy
, 
	`»adFrom
(
visiÚ
, botSaliency),

325 
BOT_SALIENCY_ROWS
*
BOT_SALIENCY_COLS
*(
CŞour
));

327 ià(
·»Á
->
	`cu¼’tIndex
(è=ğ·»Á->
	`šdexOf
(
this
)) {

328 
	`»d¿w
();

329 
	`d¿wICP
();

332 
	}
}

334 
	gICPTab
::
	$d¿wICP
() {

335 ià(
bÏckbßrd
 && !
	`i¢ª
(
fixedPos
.
	`th‘a
()è&& !i¢ª(fixedPos.
	`x
()è&& !i¢ª(fixedPos.
	`y
())) {

336 
¡d
::
veùÜ
<
Po¡Info
> 
po¡s
 = 
	`»adFrom
(
visiÚ
,…osts);

337 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> 
f›ldBound¬›s
 = 
	`»adFrom
(
visiÚ
, fieldBoundaries);

338 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
f›ldF—tu»s
 = 
	`»adFrom
(
visiÚ
, fieldFeatures);

339 
awayGßlProb
 = 
	`»adFrom
(
visiÚ
,‡wayGoalProb);

341 
AbsCoÜd
 
b®lPosAbs
 = 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

342 
AbsCoÜd
 
robÙPos
 = 
	`»adFrom
(
loÿli§tiÚ
,„obotPos);

343 
AbsCoÜd
 
b®lRRC
 = 
b®lPosAbs
.
	`cÚv”tToRobÙR–©iveC¬‹sŸn
(
robÙPos
);

345 
S’sÜV®ues
 
v®ues
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
);

346 
h—dYaw
 = 
v®ues
.
jošts
.
ªgËs
[
Jošts
::
H—dYaw
];

348 
iıResuÉ
;

349 ià(
u£T—mB®l
) {

350 
iıResuÉ
 = 
ICP
::
	`loÿli£
(
fixedPos
, 
f›ldF—tu»s
, 
po¡s
, 
awayGßlProb
, 
h—dYaw
, 
f›ldBound¬›s
, 
b®lRRC
, 
isLo¡
, 
‹amB®l
);

351 
f›ldV›w
.
	`»d¿w
(
bÏckbßrd
, 
fixedPos
, 
iıResuÉ
, 
ICP
::
	`g‘CombšedObs
(), 
b®lRRC
, 
‹amB®l
);

353 
iıResuÉ
 = 
ICP
::
	`loÿli£
(
fixedPos
, 
f›ldF—tu»s
, 
po¡s
, 
awayGßlProb
, 
h—dYaw
, 
f›ldBound¬›s
, 
b®lRRC
, 
isLo¡
);

354 
f›ldV›w
.
	`»d¿w
(
bÏckbßrd
, 
fixedPos
, 
iıResuÉ
, 
ICP
::
	`g‘CombšedObs
(), 
b®lRRC
);

357 
¡ršg¡»am
 
iıSŒ—m
;

365 
iıSŒ—m
 << "VisiÚ IÅuts;" << 
¡d
::
’dl
;

366 
iıSŒ—m
 << "Numb” oàpo¡  : " << 
po¡s
.
	`size
(è<< 
¡d
::
’dl
;

367 
iıSŒ—m
 << "Numb” oàf›ld bound¬›  : " << 
f›ldBound¬›s
.
	`size
(è<< 
¡d
::
’dl
;

368 
iıSŒ—m
 << "Numb” oàf›ld f—tu» : " << 
f›ldF—tu»s
.
	`size
(è<< 
¡d
::
’dl
;

369 
iıSŒ—m
 << "Away GßÈProb : " << 
awayGßlProb
 << 
¡d
::
’dl
;

370 
iıSŒ—m
 << 
¡d
::
’dl
;

372 
iıSŒ—m
 << "ICP ResuÉs;" << 
¡d
::
’dl
;

373 
iıSŒ—m
 << "Return value: ";

374 ià(
iıResuÉ
 =ğ
ICP_LOST
) {

375 
iıSŒ—m
 << "ICP_LOST (";

376 } ià(
iıResuÉ
 =ğ
ICP_NO_OBS
) {

377 
iıSŒ—m
 << "ICP_NO_OBS (";

378 } ià(
iıResuÉ
 >ğ
ICP_LOCALISED
) {

379 
iıSŒ—m
 << "ICP_LOCALISED (";

381 
iıSŒ—m
 << "invalid icp†ocalise„eturn (";

383 
iıSŒ—m
 << 
iıResuÉ
 << ")" << 
¡d
::
’dl
;

384 
iıInfo
->
	`£tText
(
iıSŒ—m
.
	`¡r
().
	`c_¡r
());

386 
	}
}

	@utils/offnao/tabs/icpTab.hpp

32 #´agm¨
Úû


34 
	~<QTabWidg‘
>

36 
	~<QM’uB¬
>

37 
	~<QWidg‘
>

38 
	~<QObjeù
>

39 
	~<QEv’t
>

40 
	~<QGridLayout
>

41 
	~<QPixm­
>

42 
	~<QLab–
>

43 
	~<QPaš‹r
>

44 
	~<QCŞÜ
>

45 
	~<QT»eWidg‘I‹m
>

46 
	~<QT»eWidg‘
>

47 
	~<QPushBu‰Ú
>

48 
	~<QLšeEd™
>

49 
	~<QRadioBu‰Ú
>

51 
	~<c¡dio
>

52 
	~<deque
>

54 
	~"bs/b.hµ
"

55 
	~"bs/v¬ŸbËV›w.hµ
"

56 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

57 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

58 
	~"³rû±iÚ/loÿli§tiÚ/ICP.hµ
"

59 
	~"uts/Logg”.hµ
"

60 
	~"iıF›ldV›w.hµ
"

61 
	~"medŸPª–.hµ
"

63 
şass
 
	gVisiÚ
;

65 
şass
 
	gBÏckbßrd
;

67 şas 
	cICPTab
 : 
public
 
Tab
 {

68 
Q_OBJECT


69 
public
:

70 
ICPTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

71 
QPixm­
 *
	m»nd”Pixm­
;

72 
QLab–
 *
	m»nd”Widg‘
;

73 
	m´iv©e
:

74 
š™
();

75 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

76 
»d¿w
();

79 
d¿wImage
(
QImage
 *
tİImage
, QImag*
bÙImage
);

80 
d¿wOv”Ïys
(
QPixm­
 *
tİImage
, QPixm­ *
bÙImage
);

82 
QGridLayout
 *
	mÏyout
;

83 
QLšeEd™
 *
	mŒueX
;

84 
QLšeEd™
 *
	mŒueY
;

85 
QLšeEd™
 *
	mŒueTh‘a
;

86 
QRadioBu‰Ú
 *
	mlo¡Bu‰Ú
;

87 
QLšeEd™
 *
	mb®lX
;

88 
QLšeEd™
 *
	mb®lY
;

89 
QRadioBu‰Ú
 *
	m‹amB®lBu‰Ú
;

90 
QPushBu‰Ú
 *
	mš™Bu‰Ú
;

91 
QLab–
 *
	miıInfo
;

95 
ICPF›ldV›w
 
	mf›ldV›w
;

98 
QPixm­
 
	mtİImagePixm­
;

99 
QLab–
 *
	mtİCamLab–
;

100 
QPixm­
 
	mbÙImagePixm­
;

101 
QLab–
 *
	mbÙCamLab–
;

104 
AbsCoÜd
 
	mfixedPos
;

105 
AbsCoÜd
 
	m‹amB®l
;

106 
boŞ
 
	misLo¡
;

107 
boŞ
 
	mu£T—mB®l
;

108 
d¿wICP
();

111 
CŞour
 
	mtİS®›ncy
[
TOP_SALIENCY_COLS
][
TOP_SALIENCY_ROWS
];

112 
CŞour
 
	mbÙS®›ncy
[
BOT_SALIENCY_COLS
][
BOT_SALIENCY_ROWS
];

113 
BÏckbßrd
 *
	mbÏckbßrd
;

115 
public
 
	m¦Ùs
:

116 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

117 
£tPos
();

	@utils/offnao/tabs/localisationTab.cpp

32 
	~"loÿli§tiÚTab.hµ
"

34 
	~"uts/SPLDefs.hµ
"

35 
	~"uts/ªgËs.hµ
"

36 
	~"ty³s/AùiÚCommªd.hµ
"

38 
	~<QEv’t
>

39 
	~<QMou£Ev’t
>

40 
	~<QGridLayout
>

41 
	~<QReù
>

42 
	~<QRadioBu‰Ú
>

43 
	~<QGroupBox
>

44 
	~<QLab–
>

45 
	~<QPixm­
>

47 
	~"³rû±iÚ/loÿli§tiÚ/Loÿli£r.hµ
"

48 
	~"³rû±iÚ/loÿli§tiÚ/VisiÚUpd©eBundË.hµ
"

50 
	~<io¡»am
>

51 
	~<veùÜ
>

53 
	~<boo¡/¿ndom.hµ
>

54 
	~<boo¡/¿ndom/nÜm®_di¡ributiÚ.hµ
>

56 
usšg
 
Çme¥aû
 
	g¡d
;

58 
	gLoÿli§tiÚTab
::
	$Loÿli§tiÚTab
(è: 
	`image
(":/images/spl_field.svg"),

59 
	`‹am_»d
(
çl£
), 
	`loÿli£r
(
NULL
),

60 
	`mou£Down
(
çl£
), 
	`mou£Ov”Objeù
(
NULL
),

61 
	$ºg
(42) {

62 
	`š™F›ldObjeùs
();

63 
	`š™IÁ”çû
();

64 
	`š™Loÿli§tiÚ
();

66 
	`»d¿w
();

67 
	}
}

69 
	gLoÿli§tiÚTab
::
	$š™Loÿli§tiÚ
() {

70 ià(
loÿli£r
 !ğ
NULL
) {

71 
d–‘e
 
loÿli£r
;

73 
loÿli£r
 = 
Ãw
 
	`Loÿli£r
(1);

75 
ŒueRobÙPos
.
	`x
(èğ
ŒueX
->
	`‹xt
().
	`toFlßt
();

76 
ŒueRobÙPos
.
	`y
(èğ
ŒueY
->
	`‹xt
().
	`toFlßt
();

77 
ŒueRobÙPos
.
	`th‘a
(èğ
	`DEG2RAD
(
ŒueTh‘a
->
	`‹xt
().
	`toFlßt
());

79 
ŒueRobÙPos
.
v¬
.
	`£tZ”o
();

80 
	}
}

82 
	gLoÿli§tiÚTab
::
	$š™F›ldObjeùs
() {

86 
F›ldObjeù
 
p1
;

87 
p1
.
ty³
 = 
F›ldObjeù
::
POST
;

88 
p1
.
subTy³
.
po¡Ty³
 = 
Po¡Info
::
pAwayLeá
;

89 
p1
.
pos
.
	`x
(èğ
GOAL_POST_ABS_X
;

90 
p1
.
pos
.
	`y
(èğ
GOAL_WIDTH
/2.0;

91 
p1
.
pos
.
	`th‘a
(èğ
NAN
;

92 
f›ldObjeùs
.
	`push_back
(
p1
);

94 
F›ldObjeù
 
p2
;

95 
p2
.
ty³
 = 
F›ldObjeù
::
POST
;

96 
p2
.
subTy³
.
po¡Ty³
 = 
Po¡Info
::
pAwayRight
;

97 
p2
.
pos
.
	`x
(èğ
GOAL_POST_ABS_X
;

98 
p2
.
pos
.
	`y
(èğ-
GOAL_WIDTH
/2.0;

99 
p2
.
pos
.
	`th‘a
(èğ
NAN
;

100 
f›ldObjeùs
.
	`push_back
(
p2
);

102 
F›ldObjeù
 
p3
;

103 
p3
.
ty³
 = 
F›ldObjeù
::
POST
;

104 
p3
.
subTy³
.
po¡Ty³
 = 
Po¡Info
::
pHomeRight
;

105 
p3
.
pos
.
	`x
(èğ-
GOAL_POST_ABS_X
;

106 
p3
.
pos
.
	`y
(èğ
GOAL_WIDTH
/2.0;

107 
p3
.
pos
.
	`th‘a
(èğ
NAN
;

108 
f›ldObjeùs
.
	`push_back
(
p3
);

110 
F›ldObjeù
 
p4
;

111 
p4
.
ty³
 = 
F›ldObjeù
::
POST
;

112 
p4
.
subTy³
.
po¡Ty³
 = 
Po¡Info
::
pHomeLeá
;

113 
p4
.
pos
.
	`x
(èğ-
GOAL_POST_ABS_X
;

114 
p4
.
pos
.
	`y
(èğ-
GOAL_WIDTH
/2.0;

115 
p4
.
pos
.
	`th‘a
(èğ
NAN
;

116 
f›ldObjeùs
.
	`push_back
(
p4
);

118 
F›ldObjeù
 
p5
;

119 
p5
.
ty³
 = 
F›ldObjeù
::
TWOPOSTS
;

120 
p5
.
subTy³
.
po¡Ty³
 = 
Po¡Info
::
pAway
;

121 
p5
.
pos
.
	`x
(èğ
FIELD_LENGTH
/2.0;

122 
p5
.
pos
.
	`y
() = 0;

123 
p5
.
pos
.
	`th‘a
(èğ
NAN
;

124 
f›ldObjeùs
.
	`push_back
(
p5
);

126 
F›ldObjeù
 
p6
;

127 
p6
.
ty³
 = 
F›ldObjeù
::
TWOPOSTS
;

128 
p6
.
subTy³
.
po¡Ty³
 = 
Po¡Info
::
pHome
;

129 
p6
.
pos
.
	`x
(èğ-
FIELD_LENGTH
/2.0;

130 
p6
.
pos
.
	`y
() = 0;

131 
p6
.
pos
.
	`th‘a
(èğ
NAN
;

132 
f›ldObjeùs
.
	`push_back
(
p6
);

137 
F›ldObjeù
 
æc
;

138 
æc
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

139 
æc
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

140 
æc
.
pos
.
	`x
(èğ
FIELD_LENGTH
/2;

141 
æc
.
pos
.
	`y
(èğ
FIELD_WIDTH
/2;

142 
æc
.
pos
.
	`th‘a
(èğ-3*
M_PI_4
;

143 
f›ldObjeùs
.
	`push_back
(
æc
);

146 
F›ldObjeù
 
äc
;

147 
äc
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

148 
äc
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

149 
äc
.
pos
.
	`x
(èğ
FIELD_LENGTH
/2;

150 
äc
.
pos
.
	`y
(èğ-
FIELD_WIDTH
/2;

151 
äc
.
pos
.
	`th‘a
(èğ3*
M_PI_4
;

152 
f›ldObjeùs
.
	`push_back
(
äc
);

155 
F›ldObjeù
 
¾c
;

156 
¾c
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

157 
¾c
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

158 
¾c
.
pos
.
	`x
(èğ-
FIELD_LENGTH
/2;

159 
¾c
.
pos
.
	`y
(èğ
FIELD_WIDTH
/2;

160 
¾c
.
pos
.
	`th‘a
(èğ-
M_PI_4
;

161 
f›ldObjeùs
.
	`push_back
(
¾c
);

164 
F›ldObjeù
 
¼c
;

165 
¼c
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

166 
¼c
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

167 
¼c
.
pos
.
	`x
(èğ-
FIELD_LENGTH
/2;

168 
¼c
.
pos
.
	`y
(èğ-
FIELD_WIDTH
/2;

169 
¼c
.
pos
.
	`th‘a
(èğ
M_PI_4
;

170 
f›ldObjeùs
.
	`push_back
(
¼c
);

173 
F›ldObjeù
 
fgbl
;

174 
fgbl
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

175 
fgbl
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

176 
fgbl
.
pos
.
	`x
(èğ
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
;

177 
fgbl
.
pos
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

178 
fgbl
.
pos
.
	`th‘a
(èğ-
M_PI_4
;

179 
f›ldObjeùs
.
	`push_back
(
fgbl
);

182 
F›ldObjeù
 
fgbr
;

183 
fgbr
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

184 
fgbr
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

185 
fgbr
.
pos
.
	`x
(èğ
FIELD_LENGTH
/2-
GOAL_BOX_LENGTH
;

186 
fgbr
.
pos
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

187 
fgbr
.
pos
.
	`th‘a
(èğ
M_PI_4
;

188 
f›ldObjeùs
.
	`push_back
(
fgbr
);

191 
F›ldObjeù
 
rgbl
;

192 
rgbl
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

193 
rgbl
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

194 
rgbl
.
pos
.
	`x
(èğ-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
;

195 
rgbl
.
pos
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

196 
rgbl
.
pos
.
	`th‘a
(èğ-3*
M_PI_4
;

197 
f›ldObjeùs
.
	`push_back
(
rgbl
);

200 
F›ldObjeù
 
rgbr
;

201 
rgbr
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

202 
rgbr
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fCÜÃr
;

203 
rgbr
.
pos
.
	`x
(èğ-
FIELD_LENGTH
/2+
GOAL_BOX_LENGTH
;

204 
rgbr
.
pos
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

205 
rgbr
.
pos
.
	`th‘a
(èğ3*
M_PI_4
;

206 
f›ldObjeùs
.
	`push_back
(
rgbr
);

211 
F›ldObjeù
 
lht
;

212 
lht
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

213 
lht
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fTJunùiÚ
;

214 
lht
.
pos
.
	`x
() = 0;

215 
lht
.
pos
.
	`y
(èğ-
FIELD_WIDTH
/2;

216 
lht
.
pos
.
	`th‘a
(èğ
M_PI_2
;

217 
f›ldObjeùs
.
	`push_back
(
lht
);

220 
F›ldObjeù
 
rht
;

221 
rht
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

222 
rht
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fTJunùiÚ
;

223 
rht
.
pos
.
	`x
() = 0;

224 
rht
.
pos
.
	`y
(èğ
FIELD_WIDTH
/2;

225 
rht
.
pos
.
	`th‘a
(èğ-
M_PI_2
;

226 
f›ldObjeùs
.
	`push_back
(
rht
);

229 
F›ldObjeù
 
ægt
;

230 
ægt
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

231 
ægt
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fTJunùiÚ
;

232 
ægt
.
pos
.
	`x
(èğ
FIELD_LENGTH
/2;

233 
ægt
.
pos
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

234 
ægt
.
pos
.
	`th‘a
(èğ-
M_PI
;

235 
f›ldObjeùs
.
	`push_back
(
ægt
);

238 
F›ldObjeù
 
ägt
;

239 
ägt
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

240 
ägt
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fTJunùiÚ
;

241 
ägt
.
pos
.
	`x
(èğ
FIELD_LENGTH
/2;

242 
ägt
.
pos
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

243 
ägt
.
pos
.
	`th‘a
(èğ-
M_PI
;

244 
f›ldObjeùs
.
	`push_back
(
ägt
);

247 
F›ldObjeù
 
¾gt
;

248 
¾gt
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

249 
¾gt
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fTJunùiÚ
;

250 
¾gt
.
pos
.
	`x
(èğ-
FIELD_LENGTH
/2;

251 
¾gt
.
pos
.
	`y
(èğ
GOAL_BOX_WIDTH
/2;

252 
¾gt
.
pos
.
	`th‘a
() = 0;

253 
f›ldObjeùs
.
	`push_back
(
¾gt
);

256 
F›ldObjeù
 
¼gt
;

257 
¼gt
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

258 
¼gt
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fTJunùiÚ
;

259 
¼gt
.
pos
.
	`x
(èğ-
FIELD_LENGTH
/2;

260 
¼gt
.
pos
.
	`y
(èğ-
GOAL_BOX_WIDTH
/2;

261 
¼gt
.
pos
.
	`th‘a
() = 0;

262 
f›ldObjeùs
.
	`push_back
(
¼gt
);

266 
F›ldObjeù
 
ûÁ»Cœşe
;

267 
ûÁ»Cœşe
.
ty³
 = 
F›ldObjeù
::
FEATURE
;

268 
ûÁ»Cœşe
.
subTy³
.
ã©u»Ty³
 = 
F›ldF—tu»Info
::
fC’ŒeCœşe
;

269 
ûÁ»Cœşe
.
pos
.
	`x
() = 0;

270 
ûÁ»Cœşe
.
pos
.
	`y
() = 0;

271 
ûÁ»Cœşe
.
pos
.
	`th‘a
() = 0;

272 
f›ldObjeùs
.
	`push_back
(
ûÁ»Cœşe
);

274 
	}
}

276 
	gLoÿli§tiÚTab
::
	$š™IÁ”çû
() {

277 
f›ldLab–
 = 
Ãw
 
	`QLab–
();

278 
imagePixm­
 = 
	`QPixm­
(640, 480);

279 
QReùF
 
	`rg‘
(0.0, 0.0, 640.0, 480.0);

280 
QReùF
 
	`sourû
(0.0, 0.0, 740, 540.0);

281 
QPaš‹r
 
	`·š‹r
(&
imagePixm­
);

282 
·š‹r
.
	`d¿wImage
(
rg‘
, 
image
, 
sourû
);

284 
QGridLayout
 *
Ïyout
 = 
Ãw
 
	`QGridLayout
();

286 
QGroupBox
 *
v¬Ÿnû
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("Observation Standard Deviation"));

287 
QGroupBox
 *
bŸs
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("Observation Bias"));

288 
QGroupBox
 *
modes
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("Modes"));

289 
QGroupBox
 *
£tup
 = 
Ãw
 
	`QGroupBox
(
	`Œ
("Setup"));

291 
this
->
	`£tLayout
(
Ïyout
);

292 
Ïyout
->
	`£tAlignm’t
(
Qt
::
AlignTİ
);

293 
Ïyout
->
	`addWidg‘
(
f›ldLab–
, 1, 1, 4, 1);

294 
Ïyout
->
	`addWidg‘
(
v¬Ÿnû
, 1, 2);

295 
Ïyout
->
	`addWidg‘
(
bŸs
, 2, 2);

296 
Ïyout
->
	`addWidg‘
(
modes
, 3, 2);

297 
Ïyout
->
	`addWidg‘
(
£tup
, 4, 2);

299 
QGridLayout
 *
£tupGroupLayout
 = 
Ãw
 
	`QGridLayout
();

300 
£tup
->
	`£tLayout
(
£tupGroupLayout
);

302 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("X: "), 1, 1);

303 
ŒueX
 = 
Ãw
 
	`QLšeEd™
("0.0");

304 
£tupGroupLayout
->
	`addWidg‘
(
ŒueX
, 1, 2);

305 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Y: "), 1, 3);

306 
ŒueY
 = 
Ãw
 
	`QLšeEd™
("0.0");

307 
£tupGroupLayout
->
	`addWidg‘
(
ŒueY
, 1, 4);

308 
£tupGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("Theta: "), 1, 5);

309 
ŒueTh‘a
 = 
Ãw
 
	`QLšeEd™
("0.0");

310 
£tupGroupLayout
->
	`addWidg‘
(
ŒueTh‘a
, 1, 6);

312 
QGridLayout
 *
£tupLayout2
 = 
Ãw
 
	`QGridLayout
();

313 
£tupGroupLayout
->
	`addLayout
(
£tupLayout2
, 2, 1, 1, 6);

315 
QLab–
 *
‹amLab–
 = 
Ãw
 
	`QLab–
("Team:");

316 
£tupLayout2
->
	`addWidg‘
(
‹amLab–
, 1, 1);

317 
‹amBu‰ÚGroup
 = 
Ãw
 
	`QBu‰ÚGroup
();

318 
QRadioBu‰Ú
 *
blueBu‰Ú
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`QSŒšg
("blue"), 
‹amLab–
);

319 
blueBu‰Ú
->
	`£tChecked
(
Œue
);

320 
QRadioBu‰Ú
 *
»dBu‰Ú
 = 
Ãw
 
	`QRadioBu‰Ú
(
	`QSŒšg
("»d"), 
‹amLab–
);

321 
‹amBu‰ÚGroup
->
	`addBu‰Ú
(
blueBu‰Ú
, 0);

322 
‹amBu‰ÚGroup
->
	`addBu‰Ú
(
»dBu‰Ú
, 1);

323 
£tupLayout2
->
	`addWidg‘
(
blueBu‰Ú
, 1, 2);

324 
£tupLayout2
->
	`addWidg‘
(
»dBu‰Ú
, 1, 3);

325 
š™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
("Initialise filter");

326 
£tupLayout2
->
	`addWidg‘
(
š™Bu‰Ú
, 1, 4);

328 
QLab–
 *
di¡ªûV¬ŸnûLab–
 = 
Ãw
 
	`QLab–
("Distance");

329 
QLab–
 *
h—dšgV¬ŸnûLab–
 = 
Ãw
 
	`QLab–
("Heading");

330 
QLab–
 *
Ü›Á©iÚV¬ŸnûLab–
 = 
Ãw
 
	`QLab–
("Orientation");

332 
QGridLayout
 *
v¬ŸnûGroupLayout
 = 
Ãw
 
	`QGridLayout
();

333 
v¬Ÿnû
->
	`£tLayout
(
v¬ŸnûGroupLayout
);

335 
v¬ŸnûDi¡ªû
 = 
Ãw
 
	`QLšeEd™
("800");

336 
v¬ŸnûH—dšg
 = 
Ãw
 
	`QLšeEd™
("10");

337 
v¬ŸnûOr›Á©iÚ
 = 
Ãw
 
	`QLšeEd™
("10");

338 
v¬ŸnûGroupLayout
->
	`addWidg‘
(
di¡ªûV¬ŸnûLab–
, 1, 1);

339 
v¬ŸnûGroupLayout
->
	`addWidg‘
(
h—dšgV¬ŸnûLab–
, 2, 1);

340 
v¬ŸnûGroupLayout
->
	`addWidg‘
(
Ü›Á©iÚV¬ŸnûLab–
, 3, 1);

341 
v¬ŸnûGroupLayout
->
	`addWidg‘
(
v¬ŸnûDi¡ªû
, 1, 2);

342 
v¬ŸnûGroupLayout
->
	`addWidg‘
(
v¬ŸnûH—dšg
, 2, 2);

343 
v¬ŸnûGroupLayout
->
	`addWidg‘
(
v¬ŸnûOr›Á©iÚ
, 3, 2);

345 
QLab–
 *
di¡ªûBŸsLab–
 = 
Ãw
 
	`QLab–
("Distance");

346 
QLab–
 *
h—dšgBŸsLab–
 = 
Ãw
 
	`QLab–
("Heading");

347 
QLab–
 *
Ü›Á©iÚBŸsLab–
 = 
Ãw
 
	`QLab–
("Orientation");

350 
QGridLayout
 *
bŸsGroupLayout
 = 
Ãw
 
	`QGridLayout
();

351 
bŸs
->
	`£tLayout
(
bŸsGroupLayout
);

352 
bŸsDi¡ªû
 = 
Ãw
 
	`QLšeEd™
("0.0");

353 
bŸsH—dšg
 = 
Ãw
 
	`QLšeEd™
("0.0");

354 
bŸsOr›Á©iÚ
 = 
Ãw
 
	`QLšeEd™
("0.0");

355 
bŸsGroupLayout
->
	`addWidg‘
(
di¡ªûBŸsLab–
, 1, 1);

356 
bŸsGroupLayout
->
	`addWidg‘
(
h—dšgBŸsLab–
, 2, 1);

357 
bŸsGroupLayout
->
	`addWidg‘
(
Ü›Á©iÚBŸsLab–
, 3, 1);

358 
bŸsGroupLayout
->
	`addWidg‘
(
bŸsDi¡ªû
, 1, 2);

359 
bŸsGroupLayout
->
	`addWidg‘
(
bŸsH—dšg
, 2, 2);

360 
bŸsGroupLayout
->
	`addWidg‘
(
bŸsOr›Á©iÚ
, 3, 2);

362 
QGridLayout
 *
modesGroupLayout
 = 
Ãw
 
	`QGridLayout
();

363 
modes
->
	`£tLayout
(
modesGroupLayout
);

364 
modesGroupLayout
->
	`addWidg‘
(
Ãw
 
	`QLab–
("x, y,heta forƒach mode goes here"));

366 
f›ldLab–
->
	`£tMou£T¿ckšg
(
Œue
);

367 
f›ldLab–
->
	`š¡®lEv’tF‹r
(
this
);

370 
	`cÚÃù
(
š™Bu‰Ú
, 
	`SIGNAL
(
	`»Ëa£d
()), 
this
, 
	`SLOT
(
	`š™Loÿli§tiÚ
()));

371 
	`cÚÃù
(
‹amBu‰ÚGroup
, 
	`SIGNAL
(
	`bu‰ÚR–—£d
()), 
this
, 
	`SLOT
(
	`£tT—m
()));

373 
	}
}

375 
	gLoÿli§tiÚTab
::
	$£tT—m
(
‹am
) {

377 
	}
}

379 
Loÿli§tiÚTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

381 
	}
}

383 
Loÿli§tiÚTab
::
	$£tT¿nsfÜm
(
deviû_width
, 
deviû_height
) {

384 
ŒªsfÜm
 = 
	`QT¿nsfÜm
();

389 
ŒªsfÜm
.
	`Œª¦©e
(
deviû_width
/2, 
deviû_height
/2);

391 
ŒªsfÜm
.
	`sÿË
(1,-1);

392 ià(
‹am_»d
) {

394 
ŒªsfÜm
.
	`sÿË
(-1, -1);

397 
ŒªsfÜm
.
	`sÿË
(()
deviû_width
/
OFFNAO_FULL_FIELD_LENGTH
,

398 ()
deviû_height
/
OFFNAO_FULL_FIELD_WIDTH
);

399 
	}
}

401 
	gLoÿli§tiÚTab
::
	$»d¿w
() {

403 
QPixm­
 
	`f›ldPixm­
(
imagePixm­
);

405 
F›ldPaš‹r
 
	`f›ldPaš‹r
(&
f›ldPixm­
);

406 
	`£tT¿nsfÜm
(
f›ldPixm­
.
	`width
(), f›ldPixm­.
	`height
());

408 
f›ldPaš‹r
.
	`d¿wRobÙAbs
(
ŒueRobÙPos
, "»d", 
çl£
);

410 
AbsCoÜd
 
robÙPos
 = 
loÿli£r
->
	`g‘RobÙPo£
();

412 
f›ldPaš‹r
.
	`d¿wRobÙAbs
(
robÙPos
, "#ffee00");

414 ià(
mou£Ov”Objeù
 !ğ
NULL
) {

415 
AbsCoÜd
 
objAbs
 = 
mou£Ov”Objeù
->
pos
;

416 ià(
‹am_»d
) {

417 
objAbs
.
	`x
() *= -1;

418 
objAbs
.
	`y
() *= -1;

419 
objAbs
.
	`th‘a
(èğ
	`NORMALISE
(objAbs.th‘a(è+ 
M_PI
);

422 ià(
mou£Ov”Objeù
->
ty³
 =ğ
F›ldObjeù
::
POST
) {

423 
QCŞÜ
 
cŞour
;

424 ià(
mou£Ov”Objeù
->
subTy³
.
po¡Ty³
 & 
Po¡Info
::
pAway
) {

425 ià(
mou£Down
) {

426 
cŞour
 = 
	`QCŞÜ
("#FFFF66");

428 
cŞour
 = 
	`QCŞÜ
("#808000");

431 ià(
mou£Down
) {

432 
cŞour
 = 
	`QCŞÜ
("#33FFFF");

434 
cŞour
 = 
	`QCŞÜ
("blue");

437 
f›ldPaš‹r
.
	`d¿wPo¡Abs
(
objAbs
, 
cŞour
);

438 } ià(
mou£Ov”Objeù
->
ty³
 =ğ
F›ldObjeù
::
FEATURE
) {

439 
f›ldPaš‹r
.
	`d¿wF—tu»Abs
 (
objAbs
, 
mou£Ov”Objeù
->
subTy³
.
ã©u»Ty³
);

440 } ià(
mou£Ov”Objeù
->
ty³
 =ğ
F›ldObjeù
::
TWOPOSTS
) {

441 
QCŞÜ
 
cŞour
;

442 
AbsCoÜd
 
p1
 = 
objAbs
;

443 
p1
.
	`y
(è+ğ
GOAL_WIDTH
/2.0;

444 
AbsCoÜd
 
p2
 = 
objAbs
;

445 
p2
.
	`y
(è-ğ
GOAL_WIDTH
/2.0;

446 ià(
mou£Ov”Objeù
->
subTy³
.
po¡Ty³
 & 
Po¡Info
::
pAway
) {

447 ià(
mou£Down
) {

448 
cŞour
 = 
	`QCŞÜ
("#FFFF66");

450 
cŞour
 = 
	`QCŞÜ
("#808000");

453 ià(
mou£Down
) {

454 
cŞour
 = 
	`QCŞÜ
("#33FFFF");

456 
cŞour
 = 
	`QCŞÜ
("blue");

459 
f›ldPaš‹r
.
	`d¿wPo¡Abs
(
p1
, 
cŞour
);

460 
f›ldPaš‹r
.
	`d¿wPo¡Abs
(
p2
, 
cŞour
);

464 
f›ldLab–
->
	`£tPixm­
(
f›ldPixm­
);

465 
	}
}

467 
boŞ
 
	gLoÿli§tiÚTab
::
	$ev’tF‹r
(
QObjeù
 *
objeù
, 
QEv’t
 *
ev’t
) {

468 ià(
objeù
 =ğ
f›ldLab–
) {

469 
QMou£Ev’t
 *
mev’t
 = 
¡©ic_ÿ¡
<QMou£Ev’ˆ*>(
ev’t
);

470 ià(
ev’t
->
	`ty³
(è=ğ
QEv’t
::
EÁ”
) {

471  
	`ÚMou£EÁ”
(
mev’t
);

472 } ià(
ev’t
->
	`ty³
(è=ğ
QEv’t
::
L—ve
) {

473  
	`ÚMou£L—ve
(
mev’t
);

474 } ià(
ev’t
->
	`ty³
(è=ğ
QEv’t
::
Mou£Move
) {

475  
	`ÚMou£Move
(
mev’t
);

476 } ià(
ev’t
->
	`ty³
(è=ğ
QEv’t
::
Mou£Bu‰ÚP»ss
) {

477  
	`ÚMou£Bu‰ÚP»ss
(
mev’t
);

478 } ià(
ev’t
->
	`ty³
(è=ğ
QEv’t
::
Mou£Bu‰ÚR–—£
) {

479  
	`ÚMou£Bu‰ÚR–—£
(
mev’t
);

481  
çl£
;

484  
çl£
;

486 
	}
}

488 
boŞ
 
	gLoÿli§tiÚTab
::
	$ÚMou£EÁ”
(
QMou£Ev’t
 *
mev’t
) {

489 
mou£Ov”Objeù
 = 
NULL
;

490 
mou£Down
 = 
çl£
;

491  
Œue
;

492 
	}
}

494 
boŞ
 
	gLoÿli§tiÚTab
::
	$ÚMou£L—ve
(
QMou£Ev’t
 *
mev’t
) {

495 
mou£Ov”Objeù
 = 
NULL
;

496 
mou£Down
 = 
çl£
;

497  
Œue
;

498 
	}
}

500 
boŞ
 
	gLoÿli§tiÚTab
::
	$ÚMou£Move
(
QMou£Ev’t
 *
mev’t
) {

501 
QPošt
 
p
 = 
ŒªsfÜm
.
	`šv”‹d
().
	`m­
(
mev’t
->
	`pos
());

504 
mou£Ov”Objeù
 = 
NULL
;

505 
veùÜ
<
F›ldObjeù
>::
™”©Ü
 
i
;

506 
i
 = 
f›ldObjeùs
.
	`begš
(); i !ğf›ldObjeùs.
	`’d
(); ++i) {

507 
AbsCoÜd
 
objAbs
 = 
i
->
pos
;

508 ià(
‹am_»d
) {

509 
objAbs
.
	`x
() *= -1;

510 
objAbs
.
	`y
() *= -1;

511 
objAbs
.
	`th‘a
(èğ
	`NORMALISE
(objAbs.th‘a(è+ 
M_PI
);

513 iàĞ(
	`ABS
(
objAbs
.
	`x
(è- 
p
.x()) < 200)

514 && (
	`ABS
(
objAbs
.
	`y
(è- 
p
.y()) < 200)) {

515 
mou£Ov”Objeù
 = &(*
i
);

519  
Œue
;

520 
	}
}

521 
boŞ
 
	gLoÿli§tiÚTab
::
	$ÚMou£Bu‰ÚP»ss
(
QMou£Ev’t
 *
mev’t
) {

522 ià(
mev’t
->
	`bu‰Ú
(è=ğ
Qt
::
LeáBu‰Ú
) {

523 
QPošt
 
p
 = 
ŒªsfÜm
.
	`šv”‹d
().
	`m­
(
mev’t
->
	`pos
());

525 
mou£Down
 = 
Œue
;

526  
Œue
;

528  
çl£
;

530 
	}
}

532 
boŞ
 
	gLoÿli§tiÚTab
::
	$ÚMou£Bu‰ÚR–—£
(
QMou£Ev’t
 *
mev’t
) {

533 ià(
mev’t
->
	`bu‰Ú
(è=ğ
Qt
::
LeáBu‰Ú
) {

534 
QPošt
 
p
 = 
ŒªsfÜm
.
	`šv”‹d
().
	`m­
(
mev’t
->
	`pos
());

536 
mou£Down
 = 
çl£
;

537 ià(
mou£Ov”Objeù
 !ğ
NULL
) {

538 
cout
 << "You clicked oÀobjeù‡t: " << 
mou£Ov”Objeù
->
pos
.
	`x
(è<< " " << mou£Ov”Objeù->pos.
	`y
(è<< 
’dl
;

539 
	`ü—‹Ob£rv©iÚ
(
mou£Ov”Objeù
);

542  
Œue
;

544  
çl£
;

546 
	}
}

548 
	gLoÿli§tiÚTab
::
	$·štEv’t
(
QPaštEv’t
*) {

549 
	`»d¿w
();

550 
	}
}

552 
	gLoÿli§tiÚTab
::
	$z”oM—nGaussŸnSam¶e
(
¡ªd¬dDevŸtiÚ
) {

553 
boo¡
::
nÜm®_di¡ributiÚ
<> 
	`nd
(0.0, 
¡ªd¬dDevŸtiÚ
);

554 
boo¡
::
v¬Ÿ‹_g’”©Ü
<boo¡::
mt19937
&,

555 
boo¡
::
nÜm®_di¡ributiÚ
<> > 
	`v¬_nÜ
(
ºg
, 
nd
);

556 
d
 = 
	`v¬_nÜ
();

557 
cout
 << "GaussŸÀ§m¶e: " << 
d
 << 
’dl
;

558  
d
;

559 
	}
}

561 
RRCoÜd
 
	gLoÿli§tiÚTab
::
	$absToRR
(
AbsCoÜd
 
obsAbs
) {

562 
RRCoÜd
 
obsRR
;

563 
obsRR
.
	`di¡ªû
(èğ
	`sq¹
(
	`SQUARE
(
obsAbs
.
	`x
()-
ŒueRobÙPos
.x()è+ SQUARE(obsAbs.
	`y
()-trueRobotPos.y()));

564 
obsRR
.
	`h—dšg
(èğ
	`NORMALISE
(
	`©ª2
(
obsAbs
.
	`y
()-
ŒueRobÙPos
.y(),

565 
obsAbs
.
	`x
()-
ŒueRobÙPos
.x()è-rueRobÙPos.
	`th‘a
());

566 
obsRR
.
	`Ü›Á©iÚ
(èğ
	`NORMALISE
(obsRR.
	`h—dšg
(è+ 
ŒueRobÙPos
.
	`th‘a
(è- 
obsAbs
.th‘a(è+ 
M_PI
);

568 
obsRR
.
	`di¡ªû
(è+ğ
bŸsDi¡ªû
->
	`‹xt
().
	`toFlßt
();

569 
obsRR
.
	`di¡ªû
(è+ğ
	`z”oM—nGaussŸnSam¶e
(
v¬ŸnûDi¡ªû
->
	`‹xt
().
	`toFlßt
()/4.0);

570 
obsRR
.
	`h—dšg
(è+ğ
	`DEG2RAD
(
bŸsH—dšg
->
	`‹xt
().
	`toFlßt
());

571 
obsRR
.
	`h—dšg
(è+ğ
	`z”oM—nGaussŸnSam¶e
(
	`DEG2RAD
(
v¬ŸnûH—dšg
->
	`‹xt
().
	`toFlßt
())/4.0);

572 
obsRR
.
	`Ü›Á©iÚ
(è+ğ
	`DEG2RAD
(
bŸsOr›Á©iÚ
->
	`‹xt
().
	`toFlßt
());

573 
obsRR
.
	`Ü›Á©iÚ
(è+ğ
	`z”oM—nGaussŸnSam¶e
(
	`DEG2RAD
(
v¬ŸnûOr›Á©iÚ
->
	`‹xt
().
	`toFlßt
()))/4.0;

575 
obsRR
.
v¬
.
	`£tZ”o
();

576 
obsRR
.
	`v¬
(0,0èğ
	`SQUARE
(
v¬ŸnûDi¡ªû
->
	`‹xt
().
	`toFlßt
());

577 
obsRR
.
	`v¬
(1,1èğ
	`SQUARE
(
	`DEG2RAD
(
v¬ŸnûH—dšg
->
	`‹xt
().
	`toFlßt
()));

578 
obsRR
.
	`v¬
(2,2èğ
	`SQUARE
(
	`DEG2RAD
(
v¬ŸnûOr›Á©iÚ
->
	`‹xt
().
	`toFlßt
()));

579 
cout
 << "G’”©šg ob£rv©iÚ: (" << 
obsRR
.
	`di¡ªû
(è<< "," << 
	`RAD2DEG
(obsRR.
	`h—dšg
()è<< "," << RAD2DEG(obsRR.
	`Ü›Á©iÚ
()è<< ")" << 
’dl
;

580  
obsRR
;

581 
	}
}

583 
	gLoÿli§tiÚTab
::
	$ü—‹Ob£rv©iÚ
(
F›ldObjeù
 *
obj
) {

585 
veùÜ
<
F›ldBound¬yInfo
> 
f›ldBound¬›s
;

586 
veùÜ
<
F›ldF—tu»Info
> 
f›ldF—tu»s
;

587 
veùÜ
<
Po¡Info
> 
po¡s
;

588 
veùÜ
<
RobÙInfo
> 
robÙs
;

589 
veùÜ
<
AbsCoÜd
> 
‹amm©ePo£s
;

590 
AbsCoÜd
 
b®l
;

591 
T—mB®lInfo
 
‹amB®l
;

593 
Odom‘ry
 
odom‘ry
;

595 
AbsCoÜd
 
obsAbs
 = 
obj
->
pos
;

597 ià(
‹am_»d
) {

598 
obsAbs
.
	`x
() *= -1;

599 
obsAbs
.
	`y
() *= -1;

600 
obsAbs
.
	`th‘a
(èğ
	`NORMALISE
(obsAbs.th‘a(è+ 
M_PI
);

603 ià(
obj
->
ty³
 =ğ
F›ldObjeù
::
POST
) {

604 
RRCoÜd
 
obsRR
 = 
	`absToRR
(
obsAbs
);

605 
Po¡Info
 
p
;

606 
p
.
¼
 = 
obsRR
;

607 
p
.
ty³
 = 
obj
->
subTy³
.
po¡Ty³
;

608 
po¡s
.
	`push_back
(
p
);

609 } ià(
obj
->
ty³
 =ğ
F›ldObjeù
::
TWOPOSTS
) {

610 
AbsCoÜd
 
a1
 = 
obsAbs
;

611 
a1
.
	`y
(è+ğ
GOAL_WIDTH
/2.0;

612 
AbsCoÜd
 
a2
 = 
obsAbs
;

613 
a2
.
	`y
(è-ğ
GOAL_WIDTH
/2.0;

614 ià(
obj
->
subTy³
.
po¡Ty³
 =ğ
Po¡Info
::
pHome
) {

615 
a1
.
	`y
() *= -1;

616 
a2
.
	`y
() *= -1;

618 ià(
‹am_»d
) {

619 
a1
.
	`y
() *= -1;

620 
a2
.
	`y
() *= -1;

623 
RRCoÜd
 
¼1
 = 
	`absToRR
(
a1
);

624 
RRCoÜd
 
¼2
 = 
	`absToRR
(
a2
);

625 
Po¡Info
 
p1
;

626 
Po¡Info
 
p2
;

627 
p1
.
¼
 = 
¼1
;

628 
p2
.
¼
 = 
¼2
;

629 
cout
 << "======================" << 
’dl
;

630 
cout
 << "Ëá…o¡‡b coÜds: " << 
a1
.
	`x
(è<< " " <<‡1.
	`y
(è<< 
’dl
;

631 
cout
 << "Ëá…o¡„¸coÜds: " << 
p1
.
¼
.
	`di¡ªû
(è<< " " << 
	`RAD2DEG
Õ1.¼.
	`h—dšg
()è<< 
’dl
;

632 
cout
 << "righˆpo¡‡b coÜds: " << 
a2
.
	`x
(è<< " " <<‡2.
	`y
(è<< 
’dl
;

633 
cout
 << "righˆpo¡„¸coÜds: " << 
p2
.
¼
.
	`di¡ªû
(è<< " " << 
	`RAD2DEG
Õ2.¼.
	`h—dšg
()è<< 
’dl
;

634 
p1
.
ty³
 = (
Po¡Info
::
Ty³
è(
obj
->
subTy³
.
po¡Ty³
 | Po¡Info::
pLeá
);

635 
p2
.
ty³
 = (
Po¡Info
::
Ty³
è(
obj
->
subTy³
.
po¡Ty³
 | Po¡Info::
pRight
);

636 
po¡s
.
	`push_back
(
p1
);

637 
po¡s
.
	`push_back
(
p2
);

639 
RRCoÜd
 
obsRR
 = 
	`absToRR
(
obsAbs
);

640 
F›ldF—tu»Info
 
f
;

641 
f
.
¼
 = 
obsRR
;

642 
f
.
ty³
 = 
obj
->
subTy³
.
ã©u»Ty³
;

643 
f›ldF—tu»s
.
	`push_back
(
f
);

647 
AùiÚCommªd
::
AÎ
 
aùiÚ
;

649 
VisiÚUpd©eBundË
 
	`visiÚUpd©eBundË
(

650 
f›ldBound¬›s
,

651 
f›ldF—tu»s
,

652 
po¡s
,

653 
robÙs
,

654 
‹amm©ePo£s
,

655 
çl£
,

658 
¡d
::
veùÜ
<
B®lInfo
>(),

659 
Œue
,rue);

661 
loÿli£r
->
	`loÿli£
(
	`Loÿli£rBundË
(
odom‘ry
, 
visiÚUpd©eBundË
, 
aùiÚ
,

662 
çl£
, 3 , 1 , 1.0à/ 30.0f), 
Œue
);

663 
	}
}

	@utils/offnao/tabs/localisationTab.hpp

32 #´agm¨
Úû


34 
	~"bs/b.hµ
"

35 
	~"medŸPª–.hµ
"

36 
	~"uts/F›ldPaš‹r.hµ
"

37 
	~"uts/F›ldObjeù.hµ
"

38 
	~"ty³s/AbsCoÜd.hµ
"

40 
	~<veùÜ
>

42 
	~<QLšeEd™
>

43 
	~<QPaštDeviû
>

44 
	~<QPushBu‰Ú
>

45 
	~<QBu‰ÚGroup
>

47 
	~<boo¡/¿ndom.hµ
>

48 
şass
 
	gQLab–
;

49 
şass
 
	gLoÿli£r
;

54 şas 
	cLoÿli§tiÚTab
 : 
public
 
Tab
 {

55 
Q_OBJECT


56 
public
:

57 
Loÿli§tiÚTab
();

58 
boŞ
 
ev’tF‹r
 (
QObjeù
 *
objeù
, 
QEv’t
 *
ev’t
);

60 
	m´iv©e
:

61 
š™IÁ”çû
();

62 
š™F›ldObjeùs
();

64 
AbsCoÜd
 
	mŒueRobÙPos
;

65 
ü—‹Ob£rv©iÚ
(
F›ldObjeù
 *
obj
);

67 
RRCoÜd
 
absToRR
(
AbsCoÜd
 
obsAbs
);

69 
QLab–
 *
	mf›ldLab–
;

70 
QImage
 
	mimage
;

71 
QPixm­
 
	mimagePixm­
;

72 
QLšeEd™
 *
	mŒueX
;

73 
QLšeEd™
 *
	mŒueY
;

74 
QLšeEd™
 *
	mŒueTh‘a
;

75 
QLšeEd™
 *
	mv¬ŸnûDi¡ªû
;

76 
QLšeEd™
 *
	mv¬ŸnûH—dšg
;

77 
QLšeEd™
 *
	mv¬ŸnûOr›Á©iÚ
;

78 
QLšeEd™
 *
	mbŸsDi¡ªû
;

79 
QLšeEd™
 *
	mbŸsH—dšg
;

80 
QLšeEd™
 *
	mbŸsOr›Á©iÚ
;

81 
QPushBu‰Ú
 *
	mš™Bu‰Ú
;

82 
QBu‰ÚGroup
 *
	m‹amBu‰ÚGroup
;

84 
»d¿w
();

85 
boŞ
 
	m‹am_»d
;

86 
Loÿli£r
 *
	mloÿli£r
;

87 
QT¿nsfÜm
 
	mŒªsfÜm
;

88 
£tT¿nsfÜm
(
deviû_width
, 
deviû_height
);

90 
	m¡d
::
veùÜ
<
F›ldObjeù
> 
f›ldObjeùs
;

92 
boŞ
 
ÚMou£EÁ”
(
QMou£Ev’t
 *
mev’t
);

93 
boŞ
 
ÚMou£L—ve
(
QMou£Ev’t
 *
mev’t
);

94 
boŞ
 
ÚMou£Move
(
QMou£Ev’t
 *
mev’t
);

95 
boŞ
 
ÚMou£Bu‰ÚP»ss
(
QMou£Ev’t
 *
mev’t
);

96 
boŞ
 
ÚMou£Bu‰ÚR–—£
(
QMou£Ev’t
 *
mev’t
);

98 
boŞ
 
	mmou£Down
;

99 
F›ldObjeù
 *
	mmou£Ov”Objeù
;

101 
vœtu®
 
·štEv’t
(
QPaštEv’t
*);

103 
z”oM—nGaussŸnSam¶e
(
¡ªd¬dDevŸtiÚ
);

105 
	mboo¡
::
mt19937
 
ºg
;

106 
public
 
	m¦Ùs
:

107 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

108 
š™Loÿli§tiÚ
();

109 
£tT—m
();

	@utils/offnao/tabs/overviewTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QDebug
>

35 
	~<QB™m­
>

37 
	~<ut™y
>

38 
	~<io¡»am
>

39 
	~"ov”v›wTab.hµ
"

40 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

41 
	~"³rû±iÚ/kšem©ics/Po£.hµ
"

42 
	~"bÏckbßrd/BÏckbßrd.hµ
"

44 
	~"uts/CPÏÃCŞours.hµ
"

46 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

48 
	#DEBUG_IMAGE_ROWS
 (
IMAGE_ROWS
 / 4)

	)

49 
	#DEBUG_IMAGE_COLS
 (
IMAGE_COLS
 / 4)

	)

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
	gOv”v›wTab
::
	$Ov”v›wTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
,

54 
VisiÚ
 *
visiÚ
è: 
	$bÏckbßrd
(0) {

55 
	`š™M’u
(
m’uB¬
);

56 
	`š™
();

57 
this
->
visiÚ
 = vision;

58 
	`mem£t
(
tİS®›ncy
, 0, 
TOP_SALIENCY_ROWS
*
TOP_SALIENCY_COLS
*(
CŞour
));

59 
	`mem£t
(
bÙS®›ncy
, 0, 
BOT_SALIENCY_ROWS
*
BOT_SALIENCY_COLS
*(
CŞour
));

60 
this
->
·»Á
 =…arent;

61 
	}
}

64 
	gOv”v›wTab
::
	$š™M’u
(
QM’uB¬
 *) {

65 
	}
}

67 
Ov”v›wTab
::
	$š™
() {

68 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

69 
	`£tLayout
(
Ïyout
);

70 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

72 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

73 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

76 
Ïyout
->
	`addWidg‘
(&
f›ldV›w
, 0, 0, 2, 1);

79 
f›ldV›w
.
	`»d¿w
(
NULL
);

81 
tİImagePixm­
 = 
	`QPixm­
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

82 
tİImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

83 
tİCamLab–
 = 
Ãw
 
	`QLab–
();

84 
tİCamLab–
->
	`£tPixm­
(
tİImagePixm­
);

85 
tİCamLab–
->
	`£tMšimumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

86 
tİCamLab–
->
	`£tMaximumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

87 
Ïyout
->
	`addWidg‘
(
tİCamLab–
, 0, 1, 1, 2);

89 
bÙImagePixm­
 = 
	`QPixm­
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

90 
bÙImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

91 
bÙCamLab–
 = 
Ãw
 
	`QLab–
();

92 
bÙCamLab–
->
	`£tPixm­
(
bÙImagePixm­
);

93 
bÙCamLab–
->
	`£tMšimumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

94 
bÙCamLab–
->
	`£tMaximumSize
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

95 
Ïyout
->
	`addWidg‘
(
bÙCamLab–
, 1, 1, 1, 2);

97 
Ïyout
->
	`addWidg‘
(&
v¬ŸbËV›w
, 0, 3, 2, 2);

98 
	}
}

100 
	gOv”v›wTab
::
	$»d¿w
() {

101 ià(
tİF¿me
 || 
bÙF¿me
 || 
tİS®›ncy
 || 
bÙS®›ncy
) {

102 
QImage
 *
tİImage
;

103 
QImage
 *
bÙImage
;

105 
tİImage
 = 
Ãw
 
	`QImage
(
TOP_SALIENCY_COLS
,

106 
TOP_SALIENCY_ROWS
,

107 
QImage
::
FÜm©_RGB32
);

108 
bÙImage
 = 
Ãw
 
	`QImage
(
BOT_SALIENCY_COLS
,

109 
BOT_SALIENCY_ROWS
,

110 
QImage
::
FÜm©_RGB32
);

112 
	`d¿wImage
(
tİImage
, 
bÙImage
);

115 
QPixm­
 
t
 = QPixm­::
	`äomImage
(

116 
tİImage
->
	`sÿËd
(2*
DEBUG_IMAGE_COLS
, 2*
DEBUG_IMAGE_ROWS
));

117 
bÙImagePixm­
 = 
QPixm­
::
	`äomImage
(

118 
bÙImage
->
	`sÿËd
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
));

120 
	`d¿wOv”Ïys
(&
t
, &
bÙImagePixm­
);

123 
tİImagePixm­
 = 
t
.
	`sÿËd
(
DEBUG_IMAGE_COLS
, 
DEBUG_IMAGE_ROWS
);

125 
d–‘e
 
tİImage
;

126 
d–‘e
 
bÙImage
;

128 
tİImagePixm­
 = 
	`QPixm­
(
IMAGE_COLS
, 
IMAGE_ROWS
);

129 
tİImagePixm­
.
	`fl
(
Qt
::
d¬kRed
);

130 
bÙImagePixm­
 = 
	`QPixm­
(
IMAGE_COLS
, 
IMAGE_ROWS
);

131 
bÙImagePixm­
.
	`fl
(
Qt
::
d¬kRed
);

133 
tİCamLab–
->
	`£tPixm­
(
tİImagePixm­
);

134 
bÙCamLab–
->
	`£tPixm­
(
bÙImagePixm­
);

135 
	}
}

137 
	gOv”v›wTab
::
	$d¿wOv”Ïys
(
QPixm­
 *
tİImage
, QPixm­ *
bÙImage
) {

138 ià(!
bÏckbßrd
) ;

140 
¡d
::
veùÜ
<
FoÙInfo
> 
ã‘Boxes
 = 
	`»adFrom
(
visiÚ
, feetBoxes);

142 
¡d
::
veùÜ
<
B®lInfo
> 
b®ls
 = 
	`»adFrom
(
visiÚ
, balls);

143 
¡d
::
veùÜ
<
Po¡Info
> 
po¡s
 = 
	`»adFrom
(
visiÚ
,…osts);

144 
¡d
::
veùÜ
<
RobÙInfo
> 
robÙs
 = 
	`»adFrom
(
visiÚ
,„obots);

145 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> 
f›ldBound¬›s
 = 
	`»adFrom
(
visiÚ
, fieldBoundaries);

146 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
f›ldF—tu»s
 = 
	`»adFrom
(
visiÚ
, fieldFeatures);

147 
¡d
::
veùÜ
<
Ipošt
> 
Ïndm¬ks
 = 
	`»adFrom
(
visiÚ
,†andmarks);

149 
¡d
::
·œ
<, > 
hÜizÚ
 = 
	`»adFrom
(
mÙiÚ
, 
po£
).
	`g‘HÜizÚ
();

150 
¡d
::
·œ
<, > *
hÜizÚ_p
 = &
hÜizÚ
;

152 
	`d¿wOv”ÏysG’”ic
 (
tİImage
,

153 
bÙImage
,

154 
hÜizÚ_p
,

155 &
ã‘Boxes
,

156 &
b®ls
,

157 &
po¡s
,

158 &
robÙs
,

159 &
f›ldBound¬›s
,

160 &
f›ldF—tu»s
,

161 &
Ïndm¬ks
,

187 
	}
}

190 
	gOv”v›wTab
::
	$d¿wImage
(
QImage
 *
tİImage
, QImag*
bÙImage
) {

191 ià(
tİF¿me
 && 
bÙF¿me
) {

192 
VisiÚBÏckbßrdInfo
 
bb
;

193 
visiÚ
->
	`´oûssF¿me
(
	`CombšedF¿me
(
tİF¿me
, 
bÙF¿me
), 
bb
);

195 
f›ldV›w
.
	`»d¿w
(
NULL
);

198 
row
 = 0;„ow < 
TOP_SALIENCY_ROWS
; ++row) {

199 
cŞ
 = 0; cŞ < 
TOP_SALIENCY_COLS
; ++col) {

200 
tİImage
->
	`£tPix–
(
cŞ
, 
row
,

201 
CPLANE_COLOURS
[
visiÚ
->
	`g‘FuÎRegiÚTİ
().
	`g‘Pix–CŞour
(
cŞ
, 
row
)].
	`rgb
());

206 
row
 = 0;„ow < 
BOT_SALIENCY_ROWS
; ++row) {

207 
cŞ
 = 0; cŞ < 
BOT_SALIENCY_COLS
; ++col) {

208 
bÙImage
->
	`£tPix–
(
cŞ
, 
row
,

209 
CPLANE_COLOURS
[
visiÚ
->
	`g‘FuÎRegiÚBÙ
().
	`g‘Pix–CŞour
(
cŞ
, 
row
)].
	`rgb
());

214 
row
 = 0;

215 
row
 < 
TOP_IMAGE_ROWS
 / 
TOP_SALIENCY_DENSITY
; ++row) {

216 
cŞ
 = 0;

217 
cŞ
 < 
TOP_IMAGE_COLS
 / 
TOP_SALIENCY_DENSITY
; ++col) {

218 ià(0 <ğ
tİS®›ncy
[
cŞ
][
row
] &&İS®›ncy[cŞ][row] < 
cNUM_COLOURS
) {

219 
tİImage
->
	`£tPix–
(
cŞ
, 
row
,

220 
CPLANE_COLOURS
[
tİS®›ncy
[
cŞ
][
row
]].
	`rgb
());

222 
¡d
::
û¼
 << "Bad…ix–‡ˆ" << 
cŞ
 << " " << 
row
 << std::
’dl
;

226 
row
 = 0;

227 
row
 < 
BOT_IMAGE_ROWS
 / 
BOT_SALIENCY_DENSITY
; ++row) {

228 
cŞ
= 0;

229 
cŞ
 < 
BOT_IMAGE_COLS
 / 
BOT_SALIENCY_DENSITY
; ++col) {

230 ià(0 <ğ
bÙS®›ncy
[
cŞ
][
row
] && bÙS®›ncy[cŞ][row] < 
cNUM_COLOURS
) {

231 
bÙImage
->
	`£tPix–
(
cŞ
, 
row
,

232 
CPLANE_COLOURS
[
bÙS®›ncy
[
cŞ
][
row
]].
	`rgb
());

234 
¡d
::
û¼
 << "Bad…ix–‡ˆ" << 
cŞ
 << " " << 
row
 << std::
’dl
;

240 
	}
}

244 
	gOv”v›wTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

246 ià(!
ÇoD©a
 || !ÇoD©a->
	`g‘Cu¼’tF¿me
().
bÏckbßrd
) {

247 
tİImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

248 
tİCamLab–
->
	`£tPixm­
(
tİImagePixm­
);

249 
bÙImagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

250 
bÙCamLab–
->
	`£tPixm­
(
bÙImagePixm­
);

251 } ià(
ÇoD©a
->
	`g‘F¿mesTÙ®
() != 0) {

252 
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

253 
tİF¿me
 = 
	`»adFrom
(
visiÚ
,opFrame);

254 
bÙF¿me
 = 
	`»adFrom
(
visiÚ
, botFrame);

255 ià(!
tİF¿me
) {

256 ià(
	`»adFrom
(
visiÚ
, 
tİS®›ncy
))

257 
	`memıy
(
tİS®›ncy
, 
	`»adFrom
(
visiÚ
,opSaliency),

258 
TOP_SALIENCY_ROWS
*
TOP_SALIENCY_COLS
*(
CŞour
));

260 ià(!
bÙF¿me
) {

261 ià(
	`»adFrom
(
visiÚ
, 
bÙS®›ncy
))

262 
	`memıy
(
bÙS®›ncy
, 
	`»adFrom
(
visiÚ
, botSaliency),

263 
BOT_SALIENCY_ROWS
*
BOT_SALIENCY_COLS
*(
CŞour
));

265 ià(
·»Á
->
	`cu¼’tIndex
(è=ğ·»Á->
	`šdexOf
(
this
)) {

266 
	`»d¿w
();

267 
f›ldV›w
.
	`»d¿w
(
ÇoD©a
);

268 
v¬ŸbËV›w
.
	`»d¿w
(
ÇoD©a
);

271 
	}
}

	@utils/offnao/tabs/overviewTab.hpp

32 #´agm¨
Úû


34 
	~<QTabWidg‘
>

36 
	~<QM’uB¬
>

37 
	~<QWidg‘
>

38 
	~<QObjeù
>

39 
	~<QEv’t
>

40 
	~<QGridLayout
>

41 
	~<QPixm­
>

42 
	~<QLab–
>

43 
	~<QPaš‹r
>

44 
	~<QCŞÜ
>

45 
	~<QT»eWidg‘I‹m
>

46 
	~<QT»eWidg‘
>

48 
	~<c¡dio
>

49 
	~<deque
>

51 
	~"bs/b.hµ
"

52 
	~"bs/v¬ŸbËV›w.hµ
"

53 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

54 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

55 
	~"uts/Logg”.hµ
"

56 
	~"f›ldV›w.hµ
"

57 
	~"medŸPª–.hµ
"

59 
şass
 
	gVisiÚ
;

61 
şass
 
	gBÏckbßrd
;

71 şas 
	cOv”v›wTab
 : 
public
 
Tab
 {

72 
Q_OBJECT


73 
public
:

74 
Ov”v›wTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ


76 
QPixm­
 *
	m»nd”Pixm­
;

77 
QLab–
 *
	m»nd”Widg‘
;

78 
	m´iv©e
:

79 
š™
();

80 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

81 
»d¿w
();

84 
d¿wImage
(
QImage
 *
tİImage
, QImag*
bÙImage
);

85 
d¿wOv”Ïys
(
QPixm­
 *
tİImage
, QPixm­ *
bÙImage
);

87 
QGridLayout
 *
	mÏyout
;

90 
V¬ŸbËV›w
 
	mv¬ŸbËV›w
;

91 
F›ldV›w
 
	mf›ldV›w
;

94 
QPixm­
 
	mtİImagePixm­
;

95 
QLab–
 *
	mtİCamLab–
;

96 
QPixm­
 
	mbÙImagePixm­
;

97 
QLab–
 *
	mbÙCamLab–
;

100 
CŞour
 
	mtİS®›ncy
[
TOP_SALIENCY_COLS
][
TOP_SALIENCY_ROWS
];

101 
CŞour
 
	mbÙS®›ncy
[
BOT_SALIENCY_COLS
][
BOT_SALIENCY_ROWS
];

102 
BÏckbßrd
 *
	mbÏckbßrd
;

104 
public
 
	m¦Ùs
:

105 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

	@utils/offnao/tabs/plots.cpp

32 
	~"bs/¶Ùs.hµ
"

33 
	~<qwt_·š‹r.h
>

34 
	~<qwt_¶Ù_ÿnvas.h
>

35 
	~<qwt_¶Ù_m¬k”.h
>

36 
	~<qwt_¶Ù_curve.h
>

37 
	~<qwt_sÿË_widg‘.h
>

38 
	~<qwt_Ëg’d.h
>

39 
	~<qwt_sÿË_d¿w.h
>

40 
	~"uts/ªgËs.hµ
"

42 #ià
QWT_VERSION
 >= 0x060000

43 
	#£tRawD©a
 
£tRawSam¶es


	)

46 
	gD©aPlÙ
::
	$®ignSÿËs
() {

51 
	`ÿnvas
()->
	`£tF¿meStyË
(
QF¿me
::
Box
 | QF¿me::
PÏš
);

52 
	`ÿnvas
()->
	`£tLšeWidth
(1);

54 
i
 = 0; i < 
QwtPlÙ
::
axisCÁ
; i++) {

55 
QwtSÿËWidg‘
 *
sÿËWidg‘
 = (QwtSÿËWidg‘ *)
	`axisWidg‘
(
i
);

56 ià(
sÿËWidg‘
)

57 
sÿËWidg‘
->
	`£tM¬gš
(0);

59 
QwtSÿËD¿w
 *
sÿËD¿w
 = (QwtSÿËD¿w *)
	`axisSÿËD¿w
(
i
);

60 ià(
sÿËD¿w
)

61 
sÿËD¿w
->
	`’abËCompÚ’t
(
QwtAb¡¿ùSÿËD¿w
::
BackbÚe
, 
çl£
);

63 
	}
}

65 
	gXYZPlÙ
::
	$®ignSÿËs
() {

70 
	`ÿnvas
()->
	`£tF¿meStyË
(
QF¿me
::
Box
 | QF¿me::
PÏš
);

71 
	`ÿnvas
()->
	`£tLšeWidth
(1);

73 
i
 = 0; i < 
QwtPlÙ
::
axisCÁ
; i++) {

74 
QwtSÿËWidg‘
 *
sÿËWidg‘
 = (QwtSÿËWidg‘ *)
	`axisWidg‘
(
i
);

75 ià(
sÿËWidg‘
)

76 
sÿËWidg‘
->
	`£tM¬gš
(0);

78 
QwtSÿËD¿w
 *
sÿËD¿w
 = (QwtSÿËD¿w *)
	`axisSÿËD¿w
(
i
);

79 ià(
sÿËD¿w
)

80 
sÿËD¿w
->
	`’abËCompÚ’t
(
QwtAb¡¿ùSÿËD¿w
::
BackbÚe
, 
çl£
);

82 
	}
}

84 
	gD©aPlÙ
::
push
(
¡d
::
veùÜ
<
S’sÜV®ues
> 
£nsÜs
, 
boŞ
 
Ëá
) {

85 ià(
	gËá
)

86 
	g¡d
::
veùÜ
<
S’sÜV®ues
>::
»v”£_™”©Ü
 
™
 = 
£nsÜs
.
rbegš
();

87 
	g™
 !ğ
£nsÜs
.
»nd
(); it++)

88 
push
(*
™
, 
Ëá
);

90 
	g¡d
::
veùÜ
<
S’sÜV®ues
>::
™”©Ü
 
™
 = 
£nsÜs
.
begš
();

91 
	g™
 !ğ
£nsÜs
.
’d
(); it++)

92 
push
(*
™
, 
Ëá
);

95 
	gXYZPlÙ
::
push
(
¡d
::
veùÜ
<
XYZ_CoÜd
> 
coms
, 
boŞ
 
Ëá
) {

96 ià(
	gËá
)

97 
	g¡d
::
veùÜ
<
XYZ_CoÜd
>::
»v”£_™”©Ü
 
™
 = 
coms
.
rbegš
();

98 
	g™
 !ğ
coms
.
»nd
(); it++)

99 
push
(*
™
, 
Ëá
);

101 
	g¡d
::
veùÜ
<
XYZ_CoÜd
>::
™”©Ü
 
™
 = 
coms
.
begš
();

102 
	g™
 !ğ
coms
.
’d
(); it++)

103 
push
(*
™
, 
Ëá
);

106 
	gD©aPlÙ
::
	$D©aPlÙ
(
QWidg‘
 *
·»Á
):

107 
	$QwtPlÙ
(
·»Á
) {

109 #ià
QWT_VERSION
 >= 0x060000

111 
	`ÿnvas
()->
	`£tPaštA‰ribu‹
(
QwtPlÙCªvas
::
BackšgStÜe
, 
çl£
);

114 
QwtPaš‹r
::
	`£tDeviûClpšg
(
çl£
);

117 
	`ÿnvas
()->
	`£tPaštA‰ribu‹
(
QwtPlÙCªvas
::
PaštCached
, 
çl£
);

118 
	`ÿnvas
()->
	`£tPaštA‰ribu‹
(
QwtPlÙCªvas
::
PaštPacked
, 
çl£
);

121 #ià
QT_VERSION
 >= 0x040000

122 #ifdeà
Q_WS_X11


127 
	`ÿnvas
()->
	`£tA‰ribu‹
(
Qt
::
WA_PaštOnSü“n
, 
Œue
);

131 
	`®ignSÿËs
();

133 
i
 = 0; i < 
PLOT_SIZE
; ++i) {

134 
t
[
i
] = i;

136 
	}
}

138 
	gXYZPlÙ
::
	$XYZPlÙ
(
QWidg‘
 *
·»Á
):

139 
	$QwtPlÙ
(
·»Á
) {

141 #ià
QWT_VERSION
 >= 0x060000

143 
	`ÿnvas
()->
	`£tPaštA‰ribu‹
(
QwtPlÙCªvas
::
BackšgStÜe
, 
çl£
);

146 
QwtPaš‹r
::
	`£tDeviûClpšg
(
çl£
);

149 
	`ÿnvas
()->
	`£tPaštA‰ribu‹
(
QwtPlÙCªvas
::
PaštCached
, 
çl£
);

150 
	`ÿnvas
()->
	`£tPaštA‰ribu‹
(
QwtPlÙCªvas
::
PaštPacked
, 
çl£
);

153 #ià
QT_VERSION
 >= 0x040000

154 #ifdeà
Q_WS_X11


159 
	`ÿnvas
()->
	`£tA‰ribu‹
(
Qt
::
WA_PaštOnSü“n
, 
Œue
);

163 
	`®ignSÿËs
();

165 
i
 = 0; i < 
PLOT_SIZE
; ++i) {

166 
t
[
i
] = i;

168 
	}
}

170 
	gMuÉiPlÙ
::
	$MuÉiPlÙ
(
QWidg‘
 *
·»Á
, cÚ¡ 
¡d
::
¡ršg
 &
t™Ë
, 
u_št
 
size
, 
mš
, 
max
)

171 : 
	$D©aPlÙ
(
·»Á
) {

172 
d©um
 = 
Ãw
 *[
size
];

173 
u_št
 
i
 = 0; i < 
size
; ++i) {

174 
d©um
[
i
] = 
Ãw
 [
PLOT_SIZE
];

175 
u_št
 
j
 = 0; j < 
PLOT_SIZE
; j++) {

176 
d©um
[
i
][
j
] = 0.0;

178 
QwtPlÙCurve
 *
com·»Curve
 = 
Ãw
 
	`QwtPlÙCurve
();

179 
com·»Curve
->
	`©ch
(
this
);

180 
com·»Curve
->
	`£tRawD©a
(
t
, 
d©um
[
i
], 
PLOT_SIZE
);

181 
Qt
::
Glob®CŞÜ
 
cŞour
 = 
¡©ic_ÿ¡
<Qt::Glob®CŞÜ>(Qt::
»d
 + 
i
);

182 
com·»Curve
->
	`£tP’
(
	`QP’
(
cŞour
));

184 
	`£tT™Ë
(
QSŒšg
::
	`äomUtf8
(
t™Ë
.
	`c_¡r
()));

186 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

187 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, 
mš
, 
max
);

188 
	}
}

190 
	gMuÉiPlÙ
::
push
(
¡d
::
veùÜ
<> 
v®ues
, 
boŞ
 
Ëá
) {

191 ià(
	gËá
)

192 
u_št
 
	gi
 = 0; i < 
	gv®ues
.
size
(); ++i) {

193 
u_št
 
	gj
 = 
PLOT_SIZE
-1; j > 0; --j) {

194 
	gd©um
[
i
][
j
] = 
d©um
[i][j - 1];

198 
u_št
 
	gi
 = 0; i < 
	gv®ues
.
size
(); ++i) {

199 
u_št
 
	gj
 = 0; j < 
	gPLOT_SIZE
 - 1; ++j) {

200 
	gd©um
[
i
][
j
] = 
d©um
[i][j + 1];

203 
u_št
 
	gi
 = 0; i < 
	gv®ues
.
size
(); ++i) {

204 
	gd©um
[
i
][
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
v®ues
[i];

206 
»¶Ù
();

209 
	gMuÉiPlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
è{
	}
}

212 
	gF¤PlÙ
::
	$F¤PlÙ
(
QWidg‘
 *
·»Á
)

213 : 
	$D©aPlÙ
(
·»Á
) {

214 
i
 = 0; i < 
PLOT_SIZE
; ++i)

215 
d©a_r2
[
i
] = 
d©a_l
[i] = 
d©a_r
[i] = 
d©a_t
[i] = 0.0;

216 
	`£tT™Ë
("angleX");

218 
QwtPlÙCurve
 *
curveL
 = 
Ãw
 
	`QwtPlÙCurve
("filtered‡ngleX");

219 
curveL
->
	`©ch
(
this
);

220 
curveL
->
	`£tRawD©a
(
t
, 
d©a_l
, 
PLOT_SIZE
);

221 
curveL
->
	`£tP’
(
	`QP’
(
Qt
::
»d
));

223 
QwtPlÙCurve
 *
curveR
 = 
Ãw
 
	`QwtPlÙCurve
("raw‡ngleX");

224 
curveR
->
	`©ch
(
this
);

225 
curveR
->
	`£tRawD©a
(
t
, 
d©a_r
, 
PLOT_SIZE
);

226 
curveR
->
	`£tP’
(
	`QP’
(
Qt
::
blue
));

237 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

238 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -12, 12);

239 
	}
}

241 
	gF¤PlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

242 ià(
Ëá
)

243 
i
 = 
PLOT_SIZE
-1; i > 0; --i) {

244 
d©a_l
[
i
] = data_l[i-1];

245 
d©a_r
[
i
] = data_r[i-1];

246 
d©a_t
[
i
] = data_t[i-1];

247 
d©a_r2
[
i
] = data_r2[i-1];

250 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i) {

251 
d©a_l
[
i
] = data_l[i+1];

252 
d©a_r
[
i
] = data_r[i+1];

253 
d©a_t
[
i
] = data_t[i+1];

254 
d©a_r2
[
i
] = data_r2[i+1];

256 
d©a_l
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] =

257 
	`RAD2DEG
(
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
]);

274 
	`»¶Ù
();

275 
	}
}

277 
	gSÚ¬PlÙ
::
	$SÚ¬PlÙ
(
QWidg‘
 *
·»Á
)

278 : 
	$D©aPlÙ
(
·»Á
) {

279 
i
 = 0; i < 
PLOT_SIZE
; ++i)

280 
j
 = 0; j < 10; ++j)

281 
d©a
[
j
][
i
] = 0.0;

282 
	`£tT™Ë
("Sonar");

284 
QwtPlÙCurve
 *
curve
 = 
Ãw
 
	`QwtPlÙCurve
("Sonar");

285 
curve
->
	`©ch
(
this
);

286 
curve
->
	`£tRawD©a
(
t
, 
d©a
[0], 
PLOT_SIZE
);

287 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

288 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, 0, 2.55);

289 
	}
}

291 
	gSÚ¬PlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

292 ià(
Ëá
)

293 
i
 = 
PLOT_SIZE
-1; i > 0; --i)

294 
j
 = 0; j < 10; ++j)

295 
d©a
[
j
][
i
] = data[j][i-1];

297 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i)

298 
j
 = 0; j < 10; ++j)

299 
d©a
[
j
][
i
] = data[j][i+1];

300 
j
 = 0; j < 10; ++j)

301 
d©a
[
j
][
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
£nsÜs
.
sÚ¬
[j];

302 
	`»¶Ù
();

303 
	}
}

306 
	gOdomPlÙ
::
	$OdomPlÙ
(
QWidg‘
 *
·»Á
)

307 : 
	$D©aPlÙ
(
·»Á
) {

308 
i
 = 0; i < 
PLOT_SIZE
; ++i){

309 
mÙiÚD©a
[
i
] = 0.0; 
visiÚD©a
[i] = 0.0; 
combšedD©a
[i] = 0.0;

311 
i
 = 0; i < 
PLOT_SIZE
-1; ++i){

312 
mÙiÚDiff
[
i
] = 0.0; 
visiÚDiff
[i] = 0.0; 
combšedDiff
[i] = 0.0;

314 
	`£tT™Ë
("Odometryurn");

316 
QwtPlÙCurve
 *
fcurve
 = 
Ãw
 
	`QwtPlÙCurve
("Vision");

317 
fcurve
->
	`©ch
(
this
);

318 
fcurve
->
	`£tRawD©a
(
t
, 
visiÚDiff
, 
PLOT_SIZE
-1);

319 
fcurve
->
	`£tP’
(
	`QP’
(
Qt
::
»d
));

321 
QwtPlÙCurve
 *
rcurve
 = 
Ãw
 
	`QwtPlÙCurve
("Motion");

322 
rcurve
->
	`©ch
(
this
);

323 
rcurve
->
	`£tRawD©a
(
t
, 
mÙiÚDiff
, 
PLOT_SIZE
-1);

324 
rcurve
->
	`£tP’
(
	`QP’
(
Qt
::
blue
));

326 
QwtPlÙCurve
 *
vcurve
 = 
Ãw
 
	`QwtPlÙCurve
("Combined");

327 
vcurve
->
	`©ch
(
this
);

328 
vcurve
->
	`£tRawD©a
(
t
, 
combšedDiff
, 
PLOT_SIZE
-1);

329 
vcurve
->
	`£tP’
(
	`QP’
(
Qt
::
g»’
));

331 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 2);

332 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -10, 10);

333 
	}
}

335 
	gOdomPlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

336 
	}
}

338 
	gOdomPlÙ
::
push
(
¡d
::
veùÜ
<
Odom‘ry
> 
visiÚ
, std::veùÜ<Odom‘ry> 
mÙiÚ
, std::veùÜ<Odom‘ry> 
combšed
, 
boŞ
 
Ëá
) {

339 ià(
	gËá
){

340 
	gi
=
visiÚ
.
size
()-1; i>=0; i--){

341 
push
(
visiÚ
[
i
], 
mÙiÚ
[i], 
combšed
[i], 
Ëá
);

344 
	gi
=0; i< (è
	gvisiÚ
.
size
(); i++){

345 
push
(
visiÚ
[
i
], 
mÙiÚ
[i], 
combšed
[i], 
Ëá
);

350 
	gOdomPlÙ
::
	$push
(
Odom‘ry
 
visiÚ
, Odom‘ry 
mÙiÚ
, Odom‘ry 
combšed
, 
boŞ
 
Ëá
) {

351 ià(
Ëá
)

352 
i
 = 
PLOT_SIZE
-1; i > 0; --i){

353 
mÙiÚD©a
[
i
] = motionData[i-1];

354 
visiÚD©a
[
i
] = visionData[i-1];

355 
combšedD©a
[
i
] = combinedData[i-1];

358 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i){

359 
mÙiÚD©a
[
i
] = motionData[i+1];

360 
visiÚD©a
[
i
] = visionData[i+1];

361 
combšedD©a
[
i
] = combinedData[i+1];

363 
mÙiÚD©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
	`RAD2DEG
(
mÙiÚ
.
tuº
);

364 
visiÚD©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
	`RAD2DEG
(
visiÚ
.
tuº
);

365 
combšedD©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
	`RAD2DEG
(
combšed
.
tuº
);

369 
i
=0; i< (
PLOT_SIZE
-2); ++i){

370 
mÙiÚDiff
[
i
] = 
mÙiÚD©a
[i+1] - motionData[i];

371 
visiÚDiff
[
i
] = 
visiÚD©a
[i+1] - visionData[i];

372 
combšedDiff
[
i
] = 
combšedD©a
[i+1] - combinedData[i];

375 
	`»¶Ù
();

376 
	}
}

381 
	gCh¬gePlÙ
::
	$Ch¬gePlÙ
(
QWidg‘
 *
·»Á
)

382 : 
	$D©aPlÙ
(
·»Á
) {

383 
i
 = 0; i < 
PLOT_SIZE
; ++i) {

384 
d©a
[
i
] = 0.0; 
d©a2
[i] = 0.0;

386 
	`£tT™Ë
("gyroX");

388 
QwtPlÙCurve
 *
fcurve
 = 
Ãw
 
	`QwtPlÙCurve
("filtered gyroX");

389 
fcurve
->
	`©ch
(
this
);

390 
fcurve
->
	`£tRawD©a
(
t
, 
d©a
, 
PLOT_SIZE
);

391 
fcurve
->
	`£tP’
(
	`QP’
(
Qt
::
»d
));

393 
QwtPlÙCurve
 *
rcurve
 = 
Ãw
 
	`QwtPlÙCurve
("raw gyroX");

394 
rcurve
->
	`©ch
(
this
);

395 
rcurve
->
	`£tRawD©a
(
t
, 
d©a2
, 
PLOT_SIZE
);

396 
rcurve
->
	`£tP’
(
	`QP’
(
Qt
::
blue
));

398 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

399 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -70, 70);

400 
	}
}

402 
	gCh¬gePlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

403 ià(
Ëá
)

404 
i
 = 
PLOT_SIZE
-1; i > 0; --i){

405 
d©a
[
i
] = data[i-1];

406 
d©a2
[
i
] = data2[i-1];

409 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i){

410 
d©a
[
i
] = data[i+1];

411 
d©a2
[
i
] = data2[i+1];

413 
d©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
	`RAD2DEG
(
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
]);

415 
	`»¶Ù
();

416 
	}
}

419 
	gCu¼’tPlÙ
::
	$Cu¼’tPlÙ
(
QWidg‘
 *
·»Á
)

420 : 
	$D©aPlÙ
(
·»Á
) {

421 
i
 = 0; i < 
PLOT_SIZE
; ++i) {

422 
d©a
[
i
] = 0.0; 
d©a2
[i] = 0.0;

424 
	`£tT™Ë
("gyroY");

426 
QwtPlÙCurve
 *
fcurve
 = 
Ãw
 
	`QwtPlÙCurve
("filtered gyroY");

427 
fcurve
->
	`©ch
(
this
);

428 
fcurve
->
	`£tRawD©a
(
t
, 
d©a
, 
PLOT_SIZE
);

429 
fcurve
->
	`£tP’
(
	`QP’
(
Qt
::
»d
));

431 
QwtPlÙCurve
 *
rcurve
 = 
Ãw
 
	`QwtPlÙCurve
("raw gyroY");

432 
rcurve
->
	`©ch
(
this
);

433 
rcurve
->
	`£tRawD©a
(
t
, 
d©a2
, 
PLOT_SIZE
);

434 
rcurve
->
	`£tP’
(
	`QP’
(
Qt
::
blue
));

436 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

437 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -70, 70);

438 
	}
}

440 
	gCu¼’tPlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

441 ià(
Ëá
)

442 
i
 = 
PLOT_SIZE
-1; i > 0; --i){

443 
d©a
[
i
] = data[i-1];

444 
d©a2
[
i
] = data2[i-1];

447 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i){

448 
d©a
[
i
] = data[i+1];

449 
d©a2
[
i
] = data2[i+1];

451 
d©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
	`RAD2DEG
(
£nsÜs
.£nsÜs[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrY
]);

453 
	`»¶Ù
();

454 
	}
}

456 
	gCÜÚ®ZMPPlÙ
::
	$CÜÚ®ZMPPlÙ
(
QWidg‘
 *
·»Á
)

457 : 
	$D©aPlÙ
(
·»Á
) {

458 
i
 = 0; i < 
PLOT_SIZE
; ++i) {

459 
d©a_l
[
i
] = 0.0;

460 
d©a_r
[
i
] = 0.0;

461 
d©a_t
[
i
] = 0.0;

463 
	`£tT™Ë
("Coronal Plane");

465 
QwtPlÙCurve
 *
curveL
 = 
Ãw
 
	`QwtPlÙCurve
("Left");

466 
curveL
->
	`©ch
(
this
);

467 
curveL
->
	`£tRawD©a
(
t
, 
d©a_l
, 
PLOT_SIZE
);

468 
curveL
->
	`£tP’
(
	`QP’
(
Qt
::
»d
));

470 
QwtPlÙCurve
 *
curveR
 = 
Ãw
 
	`QwtPlÙCurve
("Right");

471 
curveR
->
	`©ch
(
this
);

472 
curveR
->
	`£tRawD©a
(
t
, 
d©a_r
, 
PLOT_SIZE
);

473 
curveR
->
	`£tP’
(
	`QP’
(
Qt
::
blue
));

475 
QwtPlÙCurve
 *
curveT
 = 
Ãw
 
	`QwtPlÙCurve
("Total");

476 
curveT
->
	`©ch
(
this
);

477 
curveT
->
	`£tRawD©a
(
t
, 
d©a_t
, 
PLOT_SIZE
);

479 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

480 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -100, 100);

481 
	}
}

483 
	gCÜÚ®ZMPPlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

484 ià(
Ëá
)

485 
i
 = 
PLOT_SIZE
-1; i > 0; --i) {

486 
d©a_l
[
i
] = data_l[i-1];

487 
d©a_r
[
i
] = data_r[i-1];

488 
d©a_t
[
i
] = data_t[i-1];

491 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i) {

492 
d©a_l
[
i
] = data_l[i+1];

493 
d©a_r
[
i
] = data_r[i+1];

494 
d©a_t
[
i
] = data_t[i+1];

496 
tÙ®_weight
 = (
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

497 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

498 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

499 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
]

500 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

501 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

502 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

503 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]);

504 ià(
tÙ®_weight
 != 0)

505 
d©a_t
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] =

506 (80.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

507 + 30.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

508 + 80.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

509 + 30.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
]

510 - 30.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

511 - 80.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

512 - 30.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

513 - 80.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]è/ 
tÙ®_weight
;

515 
d©a_t
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 0.0f;

516 
d©a_l
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 1000 *

517 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_C’‹rOfP»ssu»_Y
];

518 
d©a_r
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 1000 *

519 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_C’‹rOfP»ssu»_Y
];

520 
	`»¶Ù
();

521 
	}
}

523 
	gSag™lZMPPlÙ
::
	$Sag™lZMPPlÙ
(
QWidg‘
 *
·»Á
)

524 : 
	$D©aPlÙ
(
·»Á
) {

525 
i
 = 0; i < 
PLOT_SIZE
; ++i)

526 
d©a
[
i
] = 0.0;

527 
	`£tT™Ë
("Sagittal Plane");

529 
QwtPlÙCurve
 *
curve
 = 
Ãw
 
	`QwtPlÙCurve
("SagittalZMP");

530 
curve
->
	`©ch
(
this
);

531 
curve
->
	`£tRawD©a
(
t
, 
d©a
, 
PLOT_SIZE
);

532 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

533 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -100, 100);

534 
	}
}

536 
	gSag™lZMPPlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

537 ià(
Ëá
)

538 
i
 = 
PLOT_SIZE
-1; i > 0; --i)

539 
d©a
[
i
] = data[i-1];

541 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i)

542 
d©a
[
i
] = data[i+1];

543 
tÙ®_weight
 = (
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

544 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

545 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

546 + 
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
]

547 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

548 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

549 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

550 + 
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]);

551 ià(
tÙ®_weight
 != 0)

552 
d©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] =

553 (50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

554 + 50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

555 - 50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

556 - 50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
LFoÙ_FSR_R—rRight
]

557 + 50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

558 + 50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

559 - 50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

560 - 50.0f*
£nsÜs
.£nsÜs[
S’sÜs
::
RFoÙ_FSR_R—rRight
]è/ 
tÙ®_weight
;

562 
d©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 0.0f;

563 
	`»¶Ù
();

564 
	}
}

566 
	gCOMxPlÙ
::
	$COMxPlÙ
(
QWidg‘
 *
·»Á
)

567 : 
	$XYZPlÙ
(
·»Á
) {

568 
i
 = 0; i < 
PLOT_SIZE
; ++i)

569 
d©a
[
i
] = 0.0;

570 
	`£tT™Ë
("COM„elativeo footouching ground x");

572 
QwtPlÙCurve
 *
curve
 = 
Ãw
 
	`QwtPlÙCurve
("COMx");

573 
curve
->
	`©ch
(
this
);

574 
curve
->
	`£tRawD©a
(
t
, 
d©a
, 
PLOT_SIZE
);

575 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

576 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -100, 100);

577 
	}
}

579 
	gCOMxPlÙ
::
	$push
(
XYZ_CoÜd
 
coÜd
, 
boŞ
 
Ëá
) {

580 ià(
Ëá
)

581 
i
 = 
PLOT_SIZE
-1; i > 0; --i)

582 
d©a
[
i
] = data[i-1];

584 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i)

585 
d©a
[
i
] = data[i+1];

587 
d©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
coÜd
.
x
;

589 
	`»¶Ù
();

590 
	}
}

592 
	gCOMyPlÙ
::
	$COMyPlÙ
(
QWidg‘
 *
·»Á
)

593 : 
	$XYZPlÙ
(
·»Á
) {

594 
i
 = 0; i < 
PLOT_SIZE
; ++i)

595 
d©a
[
i
] = 0.0;

596 
	`£tT™Ë
("COM„elativeo footouching ground y");

598 
QwtPlÙCurve
 *
curve
 = 
Ãw
 
	`QwtPlÙCurve
("COMy");

599 
curve
->
	`©ch
(
this
);

600 
curve
->
	`£tRawD©a
(
t
, 
d©a
, 
PLOT_SIZE
);

601 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
PLOT_SIZE
 - 1);

602 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -100, 100);

603 
	}
}

605 
	gCOMyPlÙ
::
	$push
(
XYZ_CoÜd
 
coÜd
, 
boŞ
 
Ëá
) {

606 ià(
Ëá
)

607 
i
 = 
PLOT_SIZE
-1; i > 0; --i)

608 
d©a
[
i
] = data[i-1];

610 
i
 = 0; i < 
PLOT_SIZE
 - 1; ++i)

611 
d©a
[
i
] = data[i+1];

613 
d©a
[
Ëá
 ? 0 : 
PLOT_SIZE
 - 1] = 
coÜd
.
y
;

615 
	`»¶Ù
();

616 
	}
}

618 
	gSurfPlÙ
::
	$SurfPlÙ
(
QWidg‘
 *
·»Á
)

619 : 
	$D©aPlÙ
(
·»Á
) {

620 
i
 = 0; i < 
SURF_PLOT_SIZE
; ++i)

621 
d©a
[
i
] = 0.0;

622 
	`£tT™Ë
("Surf†andmark matching score");

624 
QwtPlÙCurve
 *
curve
 = 
Ãw
 
	`QwtPlÙCurve
("Surf");

625 
curve
->
	`©ch
(
this
);

626 
curve
->
	`£tRawD©a
(
t
, 
d©a
, 
SURF_PLOT_SIZE
);

627 
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, 0, 
SURF_PLOT_SIZE
 - 1);

628 
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, 0, 2000);

629 
	}
}

631 
	gSurfPlÙ
::
push
(
¡d
::
veùÜ
<> 
scÜes
) {

632 
d©a
[0] = 0.f;

633 
	gi
 = 1; i < 
	gSURF_PLOT_SIZE
 - 1; ++i){

634 if(
	gi
 < ()
	gscÜes
.
size
()+1è
	gd©a
[
i
] = 
scÜes
[i-1];

635 
	gd©a
[
i
] = 0.f;

637 
»¶Ù
();

640 
	gSurfPlÙ
::
	$push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
) {

642 
	}
}

	@utils/offnao/tabs/plots.hpp

32 #´agm¨
Úû


34 
	~<qwt_¶Ù.h
>

35 
	~<veùÜ
>

36 
	~"ty³s/S’sÜV®ues.hµ
"

37 
	~"ty³s/Odom‘ry.hµ
"

38 
	~"ty³s/XYZ_CoÜd.hµ
"

41 
	#PLOT_SIZE
 101

	)

42 
	#SURF_PLOT_SIZE
 20

	)

44 şas 
	cD©aPlÙ
 : 
public
 
QwtPlÙ
 {

45 
Q_OBJECT


47 
public
:

48 
D©aPlÙ
(
QWidg‘
* = 
NULL
);

50 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
) = 0;

51 
push
(
¡d
::
veùÜ
<
S’sÜV®ues
> 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

53 
	m´Ùeùed
:

54 
®ignSÿËs
();

55 
	mt
[
PLOT_SIZE
];

58 şas 
	cMuÉiPlÙ
 : 
public
 
D©aPlÙ
 {

59 
Q_OBJECT


61 
public
:

62 
MuÉiPlÙ
(
QWidg‘
* 
·»Á
, cÚ¡ 
¡d
::
¡ršg
 &
t™Ë
, 
u_št
 
size
, 
mš
, 
max
);

63 
push
(
¡d
::
veùÜ
<> 
v®ues
, 
boŞ
 
Ëá
=
çl£
);

64 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

66 
	m´iv©e
:

67 **
d©um
;

70 şas 
	cXYZPlÙ
 : 
public
 
QwtPlÙ
 {

71 
Q_OBJECT


73 
public
:

74 
XYZPlÙ
(
QWidg‘
* = 
NULL
);

76 
vœtu®
 
push
(
XYZ_CoÜd
 
coÜd
, 
boŞ
 
Ëá
=
çl£
) = 0;

77 
push
(
¡d
::
veùÜ
<
XYZ_CoÜd
> 
coÜds
, 
boŞ
 
Ëá
=
çl£
);

79 
	m´Ùeùed
:

80 
®ignSÿËs
();

81 
	mt
[
PLOT_SIZE
];

84 şas 
	cF¤PlÙ
 : 
public
 
D©aPlÙ
 {

85 
Q_OBJECT


87 
public
:

88 
F¤PlÙ
(
QWidg‘
* = 
NULL
);

89 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

90 
	m´iv©e
:

91 
d©a_l
[
PLOT_SIZE
];

92 
	md©a_r
[
PLOT_SIZE
];

93 
	md©a_r2
[
PLOT_SIZE
];

94 
	md©a_t
[
PLOT_SIZE
];

96 şas 
	cSÚ¬PlÙ
 : 
public
 
D©aPlÙ
 {

97 
Q_OBJECT


99 
public
:

100 
SÚ¬PlÙ
(
QWidg‘
* = 
NULL
);

101 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

102 
	m´iv©e
:

103 
d©a
[10][
PLOT_SIZE
];

105 şas 
	cOdomPlÙ
 : 
public
 
D©aPlÙ
 {

106 
Q_OBJECT


108 
public
:

109 
OdomPlÙ
(
QWidg‘
* = 
NULL
);

110 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

111 
vœtu®
 
push
(
Odom‘ry
 
visiÚ
, Odom‘ry 
mÙiÚ
, Odom‘ry 
combšed
, 
boŞ
 
Ëá
=
çl£
);

112 
vœtu®
 
push
(
¡d
::
veùÜ
<
Odom‘ry
> 
visiÚ
, std::veùÜ<Odom‘ry> 
mÙiÚ
,

113 
¡d
::
veùÜ
<
Odom‘ry
> 
combšed
, 
boŞ
 
Ëá
=
çl£
);

114 
	m´iv©e
:

115 
visiÚD©a
[
PLOT_SIZE
];

116 
	mmÙiÚD©a
[
PLOT_SIZE
];

117 
	mcombšedD©a
[
PLOT_SIZE
];

118 
	mvisiÚDiff
[
PLOT_SIZE
-1];

119 
	mmÙiÚDiff
[
PLOT_SIZE
-1];

120 
	mcombšedDiff
[
PLOT_SIZE
-1];

122 şas 
	cCh¬gePlÙ
 : 
public
 
D©aPlÙ
 {

123 
Q_OBJECT


125 
public
:

126 
Ch¬gePlÙ
(
QWidg‘
* = 
NULL
);

127 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

128 
	m´iv©e
:

129 
d©a
[
PLOT_SIZE
];

130 
	md©a2
[
PLOT_SIZE
];

132 şas 
	cCu¼’tPlÙ
 : 
public
 
D©aPlÙ
 {

133 
Q_OBJECT


135 
public
:

136 
Cu¼’tPlÙ
(
QWidg‘
* = 
NULL
);

137 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

138 
	m´iv©e
:

139 
d©a
[
PLOT_SIZE
];

140 
	md©a2
[
PLOT_SIZE
];

142 şas 
	cCÜÚ®ZMPPlÙ
 : 
public
 
D©aPlÙ
 {

143 
Q_OBJECT


145 
public
:

146 
CÜÚ®ZMPPlÙ
(
QWidg‘
* = 
NULL
);

147 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

148 
	m´iv©e
:

149 
d©a_l
[
PLOT_SIZE
];

150 
	md©a_r
[
PLOT_SIZE
];

151 
	md©a_t
[
PLOT_SIZE
];

153 şas 
	cSag™lZMPPlÙ
 : 
public
 
D©aPlÙ
 {

154 
Q_OBJECT


156 
public
:

157 
Sag™lZMPPlÙ
(
QWidg‘
* = 
NULL
);

158 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

159 
	m´iv©e
:

160 
d©a
[
PLOT_SIZE
];

162 şas 
	cCOMxPlÙ
 : 
public
 
XYZPlÙ
 {

163 
Q_OBJECT


165 
public
:

166 
COMxPlÙ
(
QWidg‘
* = 
NULL
);

167 
vœtu®
 
push
(
XYZ_CoÜd
 
com
, 
boŞ
 
Ëá
=
çl£
);

168 
	m´iv©e
:

169 
d©a
[
PLOT_SIZE
];

171 şas 
	cCOMyPlÙ
 : 
public
 
XYZPlÙ
 {

172 
Q_OBJECT


174 
public
:

175 
COMyPlÙ
(
QWidg‘
* = 
NULL
);

176 
vœtu®
 
push
(
XYZ_CoÜd
 
com
, 
boŞ
 
Ëá
=
çl£
);

177 
	m´iv©e
:

178 
d©a
[
PLOT_SIZE
];

180 şas 
	cSurfPlÙ
 : 
public
 
D©aPlÙ
 {

181 
Q_OBJECT


183 
public
:

184 
SurfPlÙ
(
QWidg‘
* = 
NULL
);

185 
vœtu®
 
push
(
¡d
::
veùÜ
<> 
scÜes
);

186 
vœtu®
 
push
(
S’sÜV®ues
 
£nsÜs
, 
boŞ
 
Ëá
=
çl£
);

187 
	m´iv©e
:

188 
d©a
[
SURF_PLOT_SIZE
];

	@utils/offnao/tabs/sensorTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QDebug
>

36 
	~<io¡»am
>

37 
	~<f¡»am
>

38 
	~<s¡»am
>

39 
	~"£nsÜTab.hµ
"

40 
	~"uts/basic_m©hs.hµ
"

41 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

42 
	~"ty³s/S’sÜV®ues.hµ
"

43 
	~"bÏckbßrd/BÏckbßrd.hµ
"

44 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

46 
usšg
 
Çme¥aû
 
	g¡d
;

48 
	gS’sÜTab
::
	$S’sÜTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
,

49 
VisiÚ
 *
visiÚ
) {

50 
	`š™M’u
(
m’uB¬
);

51 
	`š™
();

52 
this
->
visiÚ
 = vision;

53 
this
->
·»Á
 =…arent;

54 
	}
}

57 
	gS’sÜTab
::
	$š™M’u
(
QM’uB¬
 *) {

58 
	}
}

60 
S’sÜTab
::
	$š™
() {

61 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

62 
	`£tLayout
(
Ïyout
);

63 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

64 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

65 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

67 
joštV®ueLab–
 = 
Ãw
 
	`QLab–
();

68 
joštV®ueLab–
->
	`£tAlignm’t
(
Qt
::
AlignTİ
 | Qt::
AlignLeá
);

69 
joštV®ueLab–
->
	`£tFÚt
(
	`QFÚt
("Monospace"));

71 
£nsÜV®ueLab–
 = 
Ãw
 
	`QLab–
();

72 
£nsÜV®ueLab–
->
	`£tAlignm’t
(
Qt
::
AlignTİ
 | Qt::
AlignLeá
);

73 
£nsÜV®ueLab–
->
	`£tFÚt
(
	`QFÚt
("Monospace"));

75 
sÚ¬V®ueLab–
 = 
Ãw
 
	`QLab–
();

76 
sÚ¬V®ueLab–
->
	`£tAlignm’t
(
Qt
::
AlignTİ
 | Qt::
AlignLeá
);

77 
sÚ¬V®ueLab–
->
	`£tFÚt
(
	`QFÚt
("Monospace"));

79 
g’Pos
 = 
Ãw
 
	`QPushBu‰Ú
("Generate Pos");

81 
	`upd©eD©aV›w
(
NULL
);

82 
Ïyout
->
	`addWidg‘
(
joštV®ueLab–
, 0, 0, 1, 1);

83 
Ïyout
->
	`addWidg‘
(
£nsÜV®ueLab–
, 0, 1, 1, 1);

84 
Ïyout
->
	`addWidg‘
(
sÚ¬V®ueLab–
, 0, 2, 1, 1);

85 
Ïyout
->
	`addWidg‘
(
g’Pos
, 0, 3, 1, 1);

87 
	`cÚÃù
(
g’Pos
, 
	`SIGNAL
(
	`»Ëa£d
()), 
this
, 
	`SLOT
(
	`g’”©ePosFe
()));

88 
	}
}

90 
	gS’sÜTab
::
	$upd©eD©aV›w
(
BÏckbßrd
 *
bÏckbßrd
) {

91 
¡ršg¡»am
 
joštSŒ—m
;

92 
S’sÜV®ues
 
s
;

94 
¡d
::
veùÜ
< std::veùÜ <> > 
sÚ¬F‹»d
;

96 if(
bÏckbßrd
 !ğ
NULL
) {

97 
s
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
);

98 
sÚ¬F‹»d
 = 
	`»adFrom
(
kšem©ics
, sonarFiltered);

100 
jošts
.
	`ş—r
();

101 
i
 = 0;

102 
i
 < (
Jošts
::
joštCodes
)/(Jošts::
JoštCode
);

103 
i
++) {

104 
joštSŒ—m
.
	`width
(20);

105 
joštSŒ—m
 << 
Jošts
::
joštNames
[
i
] << ": ";

106 if(
bÏckbßrd
 =ğ
NULL
) {

107 
joštSŒ—m
 << "";

109 
joštSŒ—m
 << 
s
.
jošts
.
ªgËs
[
i
] << " (" <<

110 
	`RAD2DEG
(
s
.
jošts
.
ªgËs
[
i
]) << ") "

111 << 
s
.
jošts
.
cu¼’ts
[
i
];

112 
jošts
.
	`push_back
(
¡©ic_ÿ¡
<>(
	`RAD2DEG
(
s
.jošts.
ªgËs
[
i
])));

114 
joštSŒ—m
 << 
¡d
::
’dl
;

116 
joštV®ueLab–
->
	`£tText
(
	`QSŒšg
(
joštSŒ—m
.
	`¡r
().
	`c_¡r
()));

118 
¡ršg¡»am
 
£nsÜSŒ—m
;

119 
i
 = 0;

120 
i
 < (
S’sÜs
::
£nsÜCodes
)/(S’sÜs::
S’sÜCode
);

121 
i
++) {

122 
£nsÜSŒ—m
.
	`width
(25);

123 
£nsÜSŒ—m
 << 
S’sÜs
::
£nsÜNames
[
i
] << ": ";

124 if(
bÏckbßrd
 =ğ
NULL
) {

125 
£nsÜSŒ—m
 << "";

127 
£nsÜSŒ—m
 << 
s
.
£nsÜs
[
i
];

129 
£nsÜSŒ—m
 << 
¡d
::
’dl
;

131 
£nsÜSŒ—m
 << 
¡d
::
’dl
;

132 
£nsÜSŒ—m
 << "LFoÙÙ®: " << 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
] +

133 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
] +

134 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rLeá
] +

135 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rRight
]

136 << 
¡d
::
’dl
;

137 
£nsÜSŒ—m
 << "RFoÙÙ®: " << 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

138 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

139 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

140 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rRight
]

141 << 
¡d
::
’dl
;

142 
£nsÜSŒ—m
 << "TÙ® weight: " << 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtLeá
]

143 + 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_FrÚtRight
]

144 + 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rLeá
]

145 + 
s
.
£nsÜs
[
S’sÜs
::
LFoÙ_FSR_R—rRight
]

146 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtLeá
]

147 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_FrÚtRight
]

148 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rLeá
]

149 + 
s
.
£nsÜs
[
S’sÜs
::
RFoÙ_FSR_R—rRight
]

150 << 
¡d
::
’dl
;

151 
£nsÜV®ueLab–
->
	`£tText
(
	`QSŒšg
(
£nsÜSŒ—m
.
	`¡r
().
	`c_¡r
()));

153 
¡ršg¡»am
 
sÚ¬SŒ—m
;

155 
sÚ¬SŒ—m
 << "Sonar Filtered Left:\n";

156 ià(
bÏckbßrd
 =ğ
NULL
){

157 
sÚ¬SŒ—m
 << 
¡d
::
’dl
;

159 
i
=0; i< 
sÚ¬F‹»d
[
SÚ¬
::
LEFT
].
	`size
(); i++){

160 
sÚ¬SŒ—m
 << 
sÚ¬F‹»d
[
SÚ¬
::
LEFT
][
i
] << ", ";

162 
sÚ¬SŒ—m
 << "\n";

165 
sÚ¬SŒ—m
 << "Sonar Filtered Middle:\n";

166 ià(
bÏckbßrd
 =ğ
NULL
){

167 
sÚ¬SŒ—m
 << 
¡d
::
’dl
;

169 
i
=0; i< 
sÚ¬F‹»d
[
SÚ¬
::
MIDDLE
].
	`size
(); i++){

170 
sÚ¬SŒ—m
 << 
sÚ¬F‹»d
[
SÚ¬
::
MIDDLE
][
i
] << ", ";

172 
sÚ¬SŒ—m
 << "\n";

175 
sÚ¬SŒ—m
 << "Sonar Filtered Right:\n";

176 ià(
bÏckbßrd
 =ğ
NULL
){

177 
sÚ¬SŒ—m
 << 
¡d
::
’dl
;

179 
i
=0; i< 
sÚ¬F‹»d
[
SÚ¬
::
RIGHT
].
	`size
(); i++){

180 
sÚ¬SŒ—m
 << 
sÚ¬F‹»d
[
SÚ¬
::
RIGHT
][
i
] << ", ";

182 
sÚ¬SŒ—m
 << "\n";

185 
i
 = 0; i < 
SÚ¬
::
NUMBER_OF_READINGS
; i++) {

186 
sÚ¬SŒ—m
.
	`width
(20);

187 
sÚ¬SŒ—m
 << 
SÚ¬
::
»adšgNames
[
i
] << ": ";

188 if(
bÏckbßrd
 =ğ
NULL
) {

189 
sÚ¬SŒ—m
 << "";

191 
sÚ¬SŒ—m
 << 
s
.
sÚ¬
[
i
];

193 
sÚ¬SŒ—m
 << 
¡d
::
’dl
;

195 
sÚ¬V®ueLab–
->
	`£tText
(
	`QSŒšg
(
sÚ¬SŒ—m
.
	`¡r
().
	`c_¡r
()));

196 
	}
}

198 
	gS’sÜTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

199 ià(!
ÇoD©a
 || !ÇoD©a->
	`g‘Cu¼’tF¿me
().
bÏckbßrd
) {

200 ià(
·»Á
->
	`cu¼’tIndex
(è=ğ·»Á->
	`šdexOf
(
this
)) {

201 
	`upd©eD©aV›w
(
NULL
);

203 } ià(
ÇoD©a
->
	`g‘F¿mesTÙ®
() != 0) {

204 
BÏckbßrd
 *
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

205 ià(
·»Á
->
	`cu¼’tIndex
(è=ğ·»Á->
	`šdexOf
(
this
)) {

206 
	`upd©eD©aV›w
(
bÏckbßrd
);

209 
	}
}

211 
	gS’sÜTab
::
	$g’”©ePosFe
() {

213 
¡d
::
of¡»am
 
	`fs
("current_pose.pos");

215 ià(!
fs
) {

216 
¡d
::
û¼
 << "CªnÙ o³Àthouuˆfe." << std::
’dl
;

220 
fs
 << 
POS_FILE_HEADER
;

221 
fs
 << 
¡d
::
’dl
;

222 
fs
 << " ";

225 
i
 = 0; i < 
jošts
.
	`size
(); i ++) {

226 
¡ršg¡»am
 
ss
;

227 
ss
 << 
jošts
[
i
];

228 
¡d
::
¡ršg
 
v®ue
 = 
ss
.
	`¡r
();

231 
v®ue
.
	`Ëngth
(è< 
COL_WIDTH
) {

232 
v®ue
 += " ";

236 
fs
 << 
v®ue
;

240 
fs
 << "1000" << 
¡d
::
’dl
;

243 
fs
 << 
POS_FILE_STIFFNESS
;

245 
fs
.
	`şo£
();

246 
	}
}

	@utils/offnao/tabs/sensorTab.hpp

32 #´agm¨
Úû


34 
	~<QTabWidg‘
>

36 
	~<QM’uB¬
>

37 
	~<QWidg‘
>

38 
	~<QObjeù
>

39 
	~<QEv’t
>

40 
	~<QGridLayout
>

41 
	~<QPixm­
>

42 
	~<QLab–
>

43 
	~<QPaš‹r
>

44 
	~<QCŞÜ
>

45 
	~<QT»eWidg‘I‹m
>

46 
	~<QT»eWidg‘
>

47 
	~<QLab–
>

48 
	~<QPushBu‰Ú
>

50 
	~<c¡dio
>

51 
	~<deque
>

53 
	~"bs/b.hµ
"

54 
	~"bs/v¬ŸbËV›w.hµ
"

55 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

56 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

57 
	~"uts/Logg”.hµ
"

58 
	~"f›ldV›w.hµ
"

59 
	~"medŸPª–.hµ
"

60 
	~"uts/body.hµ
"

63 
	#POS_FILE_HEADER
 "# HY HP LSP LSR LEY LER LWY LH LHYP LHR LHP LKP LAP LAR RHR RHP RKP RAP RAR RSP RSR REY RER RWY RH DUR"

	)

64 
	#POS_FILE_STIFFNESS
 "$ 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5"

	)

66 
	#COL_WIDTH
 5

	)

68 
şass
 
	gVisiÚ
;

70 şas 
	cS’sÜTab
 : 
public
 
Tab
 {

71 
Q_OBJECT


72 
public
:

73 
S’sÜTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

74 
	m´iv©e
:

75 
š™
();

76 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

77 
upd©eD©aV›w
(
BÏckbßrd
 *
bÏckbßrd
);

78 
QGridLayout
 *
	mÏyout
;

79 
QLab–
 *
	mjoštV®ueLab–
;

80 
QLab–
 *
	m£nsÜV®ueLab–
;

81 
QLab–
 *
	msÚ¬V®ueLab–
;

82 
QPushBu‰Ú
 *
	mg’Pos
;

83 
	m¡d
::
veùÜ
<> 
jošts
;

84 
public
 
	m¦Ùs
:

85 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

86 
g’”©ePosFe
();

	@utils/offnao/tabs/surfTab.cpp

	@utils/offnao/tabs/surfTab.hpp

32 #´agm¨
Úû


34 
	~<QTabWidg‘
>

35 
	~<QM’uB¬
>

36 
	~<QWidg‘
>

37 
	~<QObjeù
>

38 
	~<QEv’t
>

39 
	~<QGridLayout
>

40 
	~<QPixm­
>

41 
	~<QLab–
>

42 
	~<QPaš‹r
>

43 
	~<QCŞÜ
>

44 
	~<QT»eWidg‘I‹m
>

45 
	~<QT»eWidg‘
>

46 
	~<QPushBu‰Ú
>

47 
	~<QSŒšg
>

48 
	~<QIÅutDŸlog
>

49 
	~<QMes§geBox
>

50 
	~<QKeyEv’t
>

51 
	~<QDŸl
>

52 
	~<QSlid”
>

54 
	~<c¡dio
>

55 
	~<io¡»am
>

56 
	~<f¡»am
>

57 
	~<deque
>

58 
	~<boo¡/¬chive/‹xt_ßrchive.hµ
>

59 
	~<boo¡/¬chive/‹xt_Ÿrchive.hµ
>

60 
	~<boo¡/£rŸliz©iÚ/veùÜ.hµ
>

63 
	~"bs/b.hµ
"

64 
	~"ty³s/M­EÁry.hµ
"

65 
	~"ty³s/RobÙInfo.hµ
"

66 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

67 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

69 
	~"uts/Logg”.hµ
"

70 
	~"f›ldV›w.hµ
"

71 
	~"medŸPª–.hµ
"

75 
şass
 
	gVisiÚ
;

77 
şass
 
	gBÏckbßrd
;

	@utils/offnao/tabs/tab.cpp

32 
	~"b.hµ
"

34 
	~"uts/Ov”ÏyPaš‹r.hµ
"

35 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

36 
	~"şassif›r.hµ
"

38 
usšg
 
Çme¥aû
 
	g¡d
;

40 
QRgb
 
	gTab
::
	$g‘RGB
(
cŞ
,

41 
row
,

42 cÚ¡ 
ušt8_t
 *
yuv
,

43 
num_cŞs
) {

45 
y
 = 
	`g‘y
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
);

46 
u
 = 
	`g‘u
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
);

47 
v
 = 
	`g‘v
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
);

49 ià(
y
 < 130 && 
u
 < 145 && 
v
 < 238) {

54 ià(
y
 < 85 && 
u
 < 128 && 
v
 < 140) {

59  
CÏssif›r
::
	`yuv2rgb
(
	`g‘y
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
),

60 
	`g‘u
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
),

61 
	`g‘v
(
yuv
, 
row
, 
cŞ
, 
num_cŞs
));

62 
	}
}

64 
	gTab
::
d¿wOv”ÏysG’”ic
 (
QPaštDeviû
 *
tİImage
,

65 
QPaštDeviû
 *
bÙImage
,

66 cÚ¡ 
¡d
::
·œ
<, > *
hÜizÚ
,

67 cÚ¡ 
¡d
::
veùÜ
<
FoÙInfo
> *
ã‘
,

68 cÚ¡ 
¡d
::
veùÜ
<
B®lInfo
> *
b®ls
,

69 cÚ¡ 
¡d
::
veùÜ
<
Po¡Info
> *
po¡s
,

70 cÚ¡ 
¡d
::
veùÜ
<
RobÙInfo
> *
robÙs
,

71 cÚ¡ 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> *
f›ldBound¬›s
,

72 cÚ¡ 
¡d
::
veùÜ
<
F›ldF—tu»Info
> *
f›ldF—tu»s
,

73 cÚ¡ 
¡d
::
veùÜ
<
Ipošt
> *
Ïndm¬ks
,

74 
sÿË
)

76 
Ov”ÏyPaš‹r
 
	gtİPaš‹r
;

77 
Ov”ÏyPaš‹r
 
	gbÙPaš‹r
;

79 ià(
	gtİImage
) {

80 
	gtİPaš‹r
.
begš
(
tİImage
);

81 
	gtİPaš‹r
.
sÿË
 (scale, scale);

84 ià(
	gbÙImage
){

85 
	gbÙPaš‹r
.
begš
(
bÙImage
);

86 
	gbÙPaš‹r
.
sÿË
 (scale, scale);

87 
	gbÙPaš‹r
.
Œª¦©e
(0, -
TOP_IMAGE_ROWS
);

90 ià(
	gtİImage
 && 
	ghÜizÚ
) {

91 
	gtİPaš‹r
.
d¿wHÜizÚ
(*
hÜizÚ
);

94 ià(
	gbÙImage
 && 
	gã‘
) {

95 
	g¡d
::
veùÜ
<
FoÙInfo
>::
cÚ¡_™”©Ü
 
i
;

96 
	gi
 = 
ã‘
->
begš
 (); i !ğã‘->
’d
 (); ++ i) {

97 
	gbÙPaš‹r
.
d¿wFoÙOv”Ïy
 (*
i
);

101 ià(
	gb®ls
) {

102 
	g¡d
::
veùÜ
<
B®lInfo
>::
cÚ¡_™”©Ü
 
i
;

103 
	gi
 = 
b®ls
->
begš
 (); i !ğb®ls->
’d
 (); ++ i) {

104 ià(
	gtİImage
è
	gtİPaš‹r
.
d¿wB®lOv”Ïy
 (*
i
);

105 ià(
	gbÙImage
è
	gbÙPaš‹r
.
d¿wB®lOv”Ïy
 (*
i
);

109 ià(
	gpo¡s
) {

110 
	g¡d
::
veùÜ
<
Po¡Info
>::
cÚ¡_™”©Ü
 
i
;

111 
	gi
 = 
po¡s
->
begš
 (); i !ğpo¡s->
’d
 (); ++ i) {

112 ià(
	gtİImage
è
	gtİPaš‹r
.
d¿wPo¡Ov”Ïy
 (*
i
);

113 ià(
	gbÙImage
è
	gbÙPaš‹r
.
d¿wPo¡Ov”Ïy
 (*
i
);

117 ià(
	grobÙs
) {

118 
	g¡d
::
veùÜ
<
RobÙInfo
>::
cÚ¡_™”©Ü
 
i
;

119 
	gi
 = 
robÙs
->
begš
 (); i !ğrobÙs->
’d
 (); ++ i) {

120 ià(
	gtİImage
è
	gtİPaš‹r
.
d¿wRobÙOv”Ïy
 (*
i
);

121 ià(
	gbÙImage
è
	gbÙPaš‹r
.
d¿wRobÙOv”Ïy
 (*
i
);

125 ià(
	gf›ldBound¬›s
) {

126 
	g¡d
::
veùÜ
<
F›ldBound¬yInfo
>::
cÚ¡_™”©Ü
 
i
;

127 
	gi
 = 
f›ldBound¬›s
->
begš
 (); i !ğf›ldBound¬›s->
’d
 (); ++ i) {

128 ià(
	gtİImage
è
	gtİPaš‹r
.
d¿wF›ldBound¬yOv”Ïy
 (*
i
);

129 ià(
	gbÙImage
è
	gbÙPaš‹r
.
d¿wF›ldBound¬yOv”Ïy
 (*
i
);

133 ià(
	gf›ldF—tu»s
) {

134 
	g¡d
::
veùÜ
<
F›ldF—tu»Info
>::
cÚ¡_™”©Ü
 
i
;

135 
	gi
 = 
f›ldF—tu»s
->
begš
 (); i !ğf›ldF—tu»s->
’d
 (); ++ i) {

136 ià(
	gtİImage
è
	gtİPaš‹r
.
d¿wF›ldF—tu»Ov”Ïy
 (*
i
);

137 ià(
	gbÙImage
è
	gbÙPaš‹r
.
d¿wF›ldF—tu»Ov”Ïy
 (*
i
);

141 ià(
	gÏndm¬ks
 && 
	gtİImage
) {

142 
	g¡d
::
veùÜ
<
Ipošt
>::
cÚ¡_™”©Ü
 
i
;

143 
	gi
 = 
Ïndm¬ks
->
begš
 (); i !ğÏndm¬ks->
’d
 (); ++ i) {

144 
	gtİPaš‹r
.
d¿wLªdm¬kOv”Ïy
 (*
i
, *
hÜizÚ
);

148 ià(
	gtİImage
è
	gtİPaš‹r
.
’d
();

149 ià(
	gbÙImage
è
	gbÙPaš‹r
.
’d
();

152 
	gTab
::
	$bS–eùed
()

154 
	}
}

156 
Tab
::
	$bDe£Ëùed
()

158 
	}
}

161 
veùÜ
<
¡d
::
·œ
<
ušt16_t
, 
	gušt16_t
> > *
	gedgePošts
,

162 
F›ldEdge
 
	gedgeLšes
[2],

163 
ušt8_t
 
	gnumEdgeLšes
,

164 
ušt16_t
 *
	ggßls
,

165 
ušt16_t
 
	gnumPo¡s
,

166 
WhichPo¡s
 
	gpo¡s
,

167 
ImageRegiÚ
 *
	g»giÚs
,

168 
ušt16_t
 
	gnumRegiÚs
,

169 
ušt16_t
 
	g¿dius
,

170 
	g¡d
::
·œ
<
ušt16_t
, 
	gušt16_t
> 
	gb®lC’Œe
,

171 
	g¡d
::
·œ
<
ušt16_t
, 
	gušt16_t
> *
	gb®lEdgePošts
,

172 
ušt16_t
 
	gnumB®lEdgePošts
,

173 
RobÙRegiÚ
 **
	grobÙRegiÚs
,

174 
ušt16_t
 
	gnumRobÙRegiÚs
,

175 
ImageRegiÚ
 **
	glšeRegiÚs
,

176 
ušt16_t
 
	gnumLšeRegiÚs
,

177 
ušt16_t
 
	gnumF“t
,

178 
ušt16_t
 *
	gfoÙImageCoÜds
,

179 
	gsÿË
) {

180 
QPaš‹r
 
·š‹r
(
image
);

181 ià(
	gedgePošts
 != 0) {

182 
·š‹r
.
£tP’
(
QCŞÜ
(1, 0, 0));

183 
	g·š‹r
.
£tBrush
(
QBrush
(
QCŞÜ
(255, 255, 0)));

184 
	gveùÜ
<
	g·œ
<
	gušt16_t
, ušt16_t> >::
cÚ¡_™”©Ü
 
p
;

185 
	gp
 = 
edgePošts
->
begš
();… !ğedgePošts->
’d
(); ++p) {

186 
	g·š‹r
.
d¿wEÎ£
(
QPošt
((*
p
).
fœ¡
*
sÿË
, (*p).
£cÚd
)*scale, 2, 2);

190 ià(
	gedgeLšes
 != 0) {

191 
·š‹r
.
£tP’
(
QCŞÜ
(255, 255, 0));

192 
	gi
 = 0; i < 
	gnumEdgeLšes
; ++i) {

193 
	g·š‹r
.
d¿wLše
(

194 0, -1*()
edgeLšes
[
i
].
t3
/edgeLšes[i].
t2
 * 
sÿË
,

195 (
IMAGE_COLS
-1)*
sÿË
,

196 
sÿË
*((-1*()
edgeLšes
[
i
].
t3


197 - (()
edgeLšes
[
i
].
t1
)*(
IMAGE_COLS
-1))

198 /
edgeLšes
[
i
].
t2
));

199 
	g·š‹r
.
£tP’
(
QCŞÜ
(255, 0, 0));

203 ià(
	gnumPo¡s
 !ğ0 && 
gßls
 != 0) {

204 ià(
po¡s
 >ğ
p_Ëgacy_YELLOW_LEFT
) {

205 
·š‹r
.
£tP’
(
QCŞÜ
(255, 255, 0));

207 
	g·š‹r
.
£tP’
(
QCŞÜ
(0, 255, 255));

209 
ušt16_t
 
	gp
 = 0;… < 
	gnumPo¡s
*4;… += 4) {

210 
QLšeF
 
lšes
[4] = {

211 
QLšeF
(
sÿË
*
gßls
[
p
], scale*goals[p+1], scale*goals[p+2],

212 
sÿË
*
gßls
[
p
+1]),

213 
QLšeF
(
sÿË
*
gßls
[
p
+2], scale*goals[p+1], scale*goals[p+2],

214 
sÿË
*
gßls
[
p
+3]),

215 
QLšeF
(
sÿË
*
gßls
[
p
+2], scale*goals[p+3], scale*goals[p],

216 
sÿË
*
gßls
[
p
+3]),

217 
QLšeF
(
sÿË
*
gßls
[
p
], scale*goals[p+3], scale*goals[p],

218 
sÿË
*
gßls
[
p
+1])

220 
	g·š‹r
.
d¿wLšes
(
lšes
, 4);

224 ià(
	g¿dius
 != 0) {

225 
·š‹r
.
£tP’
(
QCŞÜ
(0, 0, 0));

226 
	g·š‹r
.
£tBrush
(
QBrush
(
Qt
::
NoBrush
));

227 
	g·š‹r
.
d¿wEÎ£
(
QPošt
(
sÿË
 * 
b®lC’Œe
.
fœ¡
,

228 
sÿË
 * 
b®lC’Œe
.
£cÚd
),

229 ()(
sÿË
 * 
¿dius
), ()(scale *„adius));

230 
	g·š‹r
.
£tP’
(
QCŞÜ
(255, 255, 255));

231 
	gi
;

232 
	gi
 = 0; i < 
	gnumB®lEdgePošts
; i++) {

233 
	g·š‹r
.
d¿wEÎ£
(
QPošt
(
b®lEdgePošts
[
i
].
fœ¡
,

234 
b®lEdgePošts
[
i
].
£cÚd
), 1, 1);

236 
	g·š‹r
.
£tP’
(
QCŞÜ
(0,255,0));

248 ià(
	gnumF“t
 > 0){

249 
	g·š‹r
.
£tP’
(
QCŞÜ
(0, 0, 255));

250 
	g·š‹r
.
£tBrush
(
QBrush
(
Qt
::
NoBrush
));

251 
	g·š‹r
.
d¿wEÎ£
(
QPošt
(
sÿË
 * 
foÙImageCoÜds
[0],

252 
sÿË
 * 
foÙImageCoÜds
[1]),

253 ()(
sÿË
 * 
FOOT_RADIUS
), ()(scale * FOOT_RADIUS));

254 ià(
	gnumF“t
 > 1){

255 
	g·š‹r
.
d¿wEÎ£
(
QPošt
(
sÿË
 * 
foÙImageCoÜds
[2],

256 
sÿË
 * 
foÙImageCoÜds
[3]),

257 ()(
sÿË
 * 
FOOT_RADIUS
), ()(scale * FOOT_RADIUS));

261 ià(
	gnumRobÙRegiÚs
 != 0) {

262 
·š‹r
.
£tP’
(
QCŞÜ
(255, 255, 255));

263 
ušt16_t
 
	gp
 = 0;… < 
	gnumRobÙRegiÚs
;…++) {

265 ià(
	grobÙRegiÚs
[
p
]->
	gty³
 =ğ
RED_ROBOT
) {

266 
·š‹r
.
£tP’
(
QCŞÜ
(255, 0, 0));

267 } ià(
	grobÙRegiÚs
[
p
]->
	gty³
 =ğ
BLUE_ROBOT
) {

268 
·š‹r
.
£tP’
(
QCŞÜ
(0, 0, 255));

270 
	g·š‹r
.
£tP’
(
QCŞÜ
(0, 50, 0));

273 
QLšeF
 
	glšes
[4] = {

274 
QLšeF
(
robÙRegiÚs
[
p
]->
ËáMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

275 
robÙRegiÚs
[
p
]->
bÙtomMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

276 
robÙRegiÚs
[
p
]->
ËáMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

277 
robÙRegiÚs
[
p
]->
tİMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
),

278 
QLšeF
(
robÙRegiÚs
[
p
]->
ËáMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

279 
robÙRegiÚs
[
p
]->
tİMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

280 
robÙRegiÚs
[
p
]->
rightMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

281 
robÙRegiÚs
[
p
]->
tİMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
),

282 
QLšeF
(
robÙRegiÚs
[
p
]->
rightMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

283 
robÙRegiÚs
[
p
]->
tİMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

284 
robÙRegiÚs
[
p
]->
rightMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

285 
robÙRegiÚs
[
p
]->
bÙtomMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
),

286 
QLšeF
(
robÙRegiÚs
[
p
]->
ËáMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

287 
robÙRegiÚs
[
p
]->
bÙtomMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

288 
robÙRegiÚs
[
p
]->
rightMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
,

289 
robÙRegiÚs
[
p
]->
bÙtomMo¡
 * 
SALIENCY_DENSITY
 * 
sÿË
)

291 
	g·š‹r
.
d¿wLšes
(
lšes
, 4);

295 ià(
	gnumLšeRegiÚs
 !ğ0 && 
numRegiÚs
 == 0) {

296 
·š‹r
.
£tP’
(
QCŞÜ
(255, 0, 255));

297 
ušt16_t
 
	gp
 = 0;… < 
	gnumLšeRegiÚs
;…++) {

298 
ušt16_t
 
	gi
 = 0; i < 
	glšeRegiÚs
[
p
]->
	gnumSÿnPošts
; i++) {

299 
	g·š‹r
.
d¿wEÎ£
(

300 
lšeRegiÚs
[
p
]->
¡¬tSÿns
[
i
].
fœ¡
 * 
SALIENCY_DENSITY
,

301 
lšeRegiÚs
[
p
]->
¡¬tSÿns
[
i
].
£cÚd
 * 
SALIENCY_DENSITY
,

304 
	g·š‹r
.
d¿wEÎ£
(

305 
lšeRegiÚs
[
p
]->
’dSÿns
[
i
].
fœ¡
 * 
SALIENCY_DENSITY
,

306 
lšeRegiÚs
[
p
]->
’dSÿns
[
i
].
£cÚd
 * 
SALIENCY_DENSITY
,

313 ià(
	gnumRegiÚs
 != 0) {

314 
ušt16_t
 
p
 = 0; 
	gp
 < 
	gnumRegiÚs
;…++) {

315 
RegiÚTy³
 
	g¡©us
 = 
»giÚs
[
p
].
şassifiÿtiÚ
;

316 ià(
	g¡©us
 =ğ
rBALL
) {

317 
·š‹r
.
£tP’
(
QCŞÜ
(128, 20, 20));

318 } ià(
	g¡©us
 =ğ
rROBOT
) {

319 
·š‹r
.
£tP’
(
QCŞÜ
(255, 255, 255));

320 } ià(
	g¡©us
 =ğ
rMAYBE_ROBOT
) {

321 
·š‹r
.
£tP’
(
QCŞÜ
(255, 255, 0));

322 } ià(
	g¡©us
 =ğ
rFIELD_LINE
) {

323 
·š‹r
.
£tP’
(
QCŞÜ
(255, 0, 255));

324 } ià(
	g¡©us
 =ğ
rCONNECTED_ROBOT
) {

325 
·š‹r
.
£tP’
(
QCŞÜ
(0, 255, 0));

327 
	g·š‹r
.
£tP’
(
QCŞÜ
(0, 255, 255));

329 ià(!(
	g»giÚs
[
p
].
	gd–‘ed
)) {

337 
ušt16_t
 
	gi
 = 0; i < 
	g»giÚs
[
p
].
	gnumSÿnPošts
; i++) {

338 
	g·š‹r
.
d¿wEÎ£
(

339 
»giÚs
[
p
].
¡¬tSÿns
[
i
].
fœ¡
 * 
SALIENCY_DENSITY
,

340 
»giÚs
[
p
].
¡¬tSÿns
[
i
].
£cÚd
 * 
SALIENCY_DENSITY
,

343 
	g·š‹r
.
d¿wEÎ£
(

344 
»giÚs
[
p
].
’dSÿns
[
i
].
fœ¡
 * 
SALIENCY_DENSITY
,

345 
»giÚs
[
p
].
’dSÿns
[
i
].
£cÚd
 * 
SALIENCY_DENSITY
,

351 
QLšeF
 
	glšes
[4] = {

352 
QLšeF
(
»giÚs
[
p
].
ËáMo¡
 * 
SALIENCY_DENSITY
,

353 
»giÚs
[
p
].
bÙtomMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
,

354 
»giÚs
[
p
].
ËáMo¡
 * 
SALIENCY_DENSITY
,

355 
»giÚs
[
p
].
tİMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
),

356 
QLšeF
(
»giÚs
[
p
].
ËáMo¡
 * 
SALIENCY_DENSITY
,

357 
»giÚs
[
p
].
tİMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
,

358 
»giÚs
[
p
].
rightMo¡
 * 
SALIENCY_DENSITY
,

359 
»giÚs
[
p
].
tİMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
),

360 
QLšeF
(
»giÚs
[
p
].
rightMo¡
 * 
SALIENCY_DENSITY
,

361 
»giÚs
[
p
].
tİMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
,

362 
»giÚs
[
p
].
rightMo¡
 * 
SALIENCY_DENSITY
,

363 
»giÚs
[
p
].
bÙtomMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
),

364 
QLšeF
(
»giÚs
[
p
].
ËáMo¡
 * 
SALIENCY_DENSITY
,

365 
»giÚs
[
p
].
bÙtomMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
,

366 
»giÚs
[
p
].
rightMo¡
 * 
SALIENCY_DENSITY
,

367 
»giÚs
[
p
].
bÙtomMo¡
.
£cÚd
 * 
SALIENCY_DENSITY
)

369 
	g·š‹r
.
d¿wLšes
(
lšes
, 4);

	@utils/offnao/tabs/tab.hpp

32 #´agm¨
Úû


34 
	~<QObjeù
>

35 
	~<QWidg‘
>

36 
	~<QM’uB¬
>

37 
	~<QSŒšg
>

38 
	~<QRgb
>

39 
	~<QPaštDeviû
>

40 
	~<QTabWidg‘
>

42 
	~<veùÜ
>

43 
	~<ut™y
>

45 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

46 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

47 
	~"uts/Logg”.hµ
"

49 
	~"ty³s/FoÙInfo.hµ
"

50 
	~"ty³s/B®lInfo.hµ
"

51 
	~"ty³s/Po¡Info.hµ
"

52 
	~"ty³s/Ipošt.hµ
"

54 
	~"ÇoD©a.hµ
"

56 
şass
 
	gVisiÚ
;

58 şas 
	cTab
 : 
public
 
QWidg‘
 {

59 
Q_OBJECT


61 
public
:

62 
	$Tab
(è: 
	`visiÚ
(0), 
	$cu¼’tF¿me
(0) {}

63 
	$Tab
(
QTabWidg‘
 *
·»Á
è: 
	`QWidg‘
Õ¬’t), 
	`·»Á
Õ¬’t), 
	`visiÚ
(0),

64 
	`tİF¿me
(0), 
	$bÙF¿me
(0è{
	}
}

66 
	g´Ùeùed
:

70 
vœtu®
 
QRgb
 
g‘RGB
(
cŞ
, 
row
,

71 cÚ¡ 
ušt8_t
 *
yuv
, 
num_cŞs
);

73 
QTabWidg‘
 *
	g·»Á
;

76 
VisiÚ
 *
	gvisiÚ
;

81 cÚ¡ 
ušt8_t
 *
	gcu¼’tF¿me
;

82 cÚ¡ 
ušt8_t
 *
	gtİF¿me
;

83 cÚ¡ 
ušt8_t
 *
	gbÙF¿me
;

90 
d¿wOv”ÏysG’”ic
 (
QPaštDeviû
 *
tİImage
,

91 
QPaštDeviû
 *
bÙImage
,

92 cÚ¡ 
¡d
::
·œ
<, > *
hÜizÚ
,

93 cÚ¡ 
¡d
::
veùÜ
<
FoÙInfo
> *
ã‘
,

94 cÚ¡ 
¡d
::
veùÜ
<
B®lInfo
> *
b®ls
,

95 cÚ¡ 
¡d
::
veùÜ
<
Po¡Info
> *
po¡s
,

96 cÚ¡ 
¡d
::
veùÜ
<
RobÙInfo
> *
robÙs
,

97 cÚ¡ 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> *
f›ldBound¬›s
,

98 cÚ¡ 
¡d
::
veùÜ
<
F›ldF—tu»Info
> *
f›ldF—tu»s
,

99 cÚ¡ 
¡d
::
veùÜ
<
Ipošt
> *
Ïndm¬ks
,

100 
sÿË


103 
vœtu®
 
bS–eùed
();

104 
vœtu®
 
bDe£Ëùed
();

106 
	gsigÇls
:

107 
showMes§ge
(cÚ¡ 
QSŒšg
 &, 
timeout
 = 0);

109 
public
 
	g¦Ùs
:

110 
vœtu®
 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) = 0;

111 
vœtu®
 
	$»ad”Clo£d
(è{
	}
}

113 
ä›nd
 
şass
 
	gVisu®i£r
;

	@utils/offnao/tabs/teamBallTab.cpp

31 
	~"‹amB®lTab.hµ
"

33 
	~"uts/SPLDefs.hµ
"

34 
	~"uts/ªgËs.hµ
"

35 
	~"ty³s/AùiÚCommªd.hµ
"

36 
	~"ty³s/RobÙOb¡aşe.hµ
"

38 
	~<QGridLayout
>

39 
	~<QReù
>

40 
	~<QGroupBox
>

41 
	~<QLab–
>

42 
	~<QPixm­
>

43 
	~<QPaš‹r
>

44 
	~<QCŞÜ
>

45 
	~<QT¿nsfÜm
>

47 
	~<io¡»am
>

48 
	~<veùÜ
>

50 
	~"bÏckbßrd/BÏckbßrd.hµ
"

52 
	#DEBUG_IMAGE_ROWS
 (
IMAGE_ROWS
 / 4)

	)

53 
	#DEBUG_IMAGE_COLS
 (
IMAGE_COLS
 / 4)

	)

55 
	#MAX_LAST_SEEN
 10

	)

57 
usšg
 
Çme¥aû
 
	g¡d
;

59 
	gT—mB®lTab
::
	$T—mB®lTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
è: 
	`image
(":/images/spl_field.svg"),

60 
	$bÏckbßrd
(0) {

61 
	`š™M’u
(
m’uB¬
);

62 
	`š™
();

63 
this
->
·»Á
 =…arent;

64 
	}
}

67 
	gT—mB®lTab
::
	$š™M’u
(
QM’uB¬
 *) {

68 
	}
}

70 
T—mB®lTab
::
	$š™
() {

71 
f›ldLab–
 = 
Ãw
 
	`QLab–
();

72 
imagePixm­
 = 
	`QPixm­
(640, 480);

73 
QReùF
 
	`rg‘
(0.0, 0.0, 640.0, 480.0);

74 
QReùF
 
	`sourû
(0.0, 0.0, 740, 540.0);

75 
QPaš‹r
 
	`·š‹r
(&
imagePixm­
);

76 
·š‹r
.
	`d¿wImage
(
rg‘
, 
image
, 
sourû
);

78 
QGridLayout
 *
Ïyout
 = 
Ãw
 
	`QGridLayout
();

79 
this
->
	`£tLayout
(
Ïyout
);

80 
Ïyout
->
	`£tAlignm’t
(
Qt
::
AlignTİ
);

81 
Ïyout
->
	`addWidg‘
(
f›ldLab–
, 1, 1, 4, 1);

84 
QPixm­
 
	`f›ldPixm­
(
imagePixm­
);

85 
F›ldPaš‹r
 
	`f›ldPaš‹r
(&
f›ldPixm­
);

86 
	`£tT¿nsfÜm
(
f›ldPixm­
.
	`width
(), f›ldPixm­.
	`height
());

87 
f›ldLab–
->
	`£tPixm­
(
f›ldPixm­
);

88 
	}
}

90 
	gT—mB®lTab
::
	$£tT¿nsfÜm
(
deviû_width
, 
deviû_height
) {

91 
ŒªsfÜm
 = 
	`QT¿nsfÜm
();

96 
ŒªsfÜm
.
	`Œª¦©e
(
deviû_width
/2, 
deviû_height
/2);

98 
ŒªsfÜm
.
	`sÿË
(1,-1);

100 
ŒªsfÜm
.
	`sÿË
(()
deviû_width
/
OFFNAO_FULL_FIELD_LENGTH
,

101 ()
deviû_height
/
OFFNAO_FULL_FIELD_WIDTH
);

102 
	}
}

104 
	gT—mB®lTab
::
	$»d¿w
() {

105 ià(!
bÏckbßrd
) ;

107 cÚ¡ 
¡d
::
veùÜ
<
B®lInfo
> 
hypÙhe£s
 = 
	`»adFrom
(
visiÚ
, 
b®ls
);

108 cÚ¡ 
AbsCoÜd
 
bÙPos
 = 
	`»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

109 cÚ¡ 
AbsCoÜd
 
b®lAbs
 = 
	`»adFrom
(
loÿli§tiÚ
, 
b®lPos
);

111 
QPixm­
 
	`f›ldPixm­
(
imagePixm­
);

113 
F›ldPaš‹r
 
	`f›ldPaš‹r
(&
f›ldPixm­
);

114 
	`£tT¿nsfÜm
(
f›ldPixm­
.
	`width
(), f›ldPixm­.
	`height
());

116 
i
 = 0; i < 
hypÙhe£s
.
	`size
(); i++) {

117 
liãtime
 = 
hypÙhe£s
[
i
].lifetime;

118 
Ï¡S“n
 = 
hypÙhe£s
[
i
].lastSeen;

120 
cout
 << "B®È" << 
i
 << " - " << "Liãtime: " << 
liãtime
 << ", La¡ s“n: " << 
Ï¡S“n
 << 
’dl
;

121 
QCŞÜ
 
cŞ
 = 
	`QCŞÜ
(0, 255, 0, 255);

122 
f›ldPaš‹r
.
	`d¿wB®lRR
(
hypÙhe£s
[
i
], 
bÙPos
, 
cŞ
);

126 
f›ldPaš‹r
.
	`d¿wRobÙAbs
(
bÙPos
, "yellow");

127 
f›ldPaš‹r
.
	`d¿wRobÙAbs
(
b®lAbs
, "red");

128 
f›ldLab–
->
	`£tPixm­
(
f›ldPixm­
);

131 
	}
}

137 
	gT—mB®lTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

139 ià(
ÇoD©a
) {

141 ià(
ÇoD©a
->
	`g‘F¿mesTÙ®
() != 0) {

142 
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

143 ià(
·»Á
->
	`cu¼’tIndex
(è=ğ·»Á->
	`šdexOf
(
this
)) {

144 
	`»d¿w
();

148 
	}
}

	@utils/offnao/tabs/teamBallTab.hpp

32 #´agm¨
Úû


34 
	~"bs/b.hµ
"

35 
	~"medŸPª–.hµ
"

36 
	~"uts/F›ldPaš‹r.hµ
"

37 
	~"uts/F›ldObjeù.hµ
"

38 
	~"ty³s/AbsCoÜd.hµ
"

40 
	~<veùÜ
>

42 
	~<QGroupBox
>

43 
	~<QM’uB¬
>

44 
	~<QGridLayout
>

45 
	~<QPixm­
>

46 
	~<QLab–
>

47 
	~<QImage
>

49 
	~<c¡dio
>

50 
	~<deque
>

54 
şass
 
	gVisiÚ
;

56 
şass
 
	gBÏckbßrd
;

66 şas 
	cT—mB®lTab
 : 
public
 
Tab
 {

67 
Q_OBJECT


68 
public
:

69 
T—mB®lTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬


71 
	m´iv©e
:

72 
š™
();

73 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

74 
»d¿w
();

76 
QT¿nsfÜm
 
	mŒªsfÜm
;

77 
£tT¿nsfÜm
(
deviû_width
, 
deviû_height
);

79 
QGridLayout
 *
	mÏyout
;

82 
QLab–
 *
	mf›ldLab–
;

83 
QPixm­
 
	mimagePixm­
;

84 
QImage
 
	mimage
;

87 
BÏckbßrd
 *
	mbÏckbßrd
;

89 
public
 
	m¦Ùs
:

90 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

	@utils/offnao/tabs/teamTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QDebug
>

35 
	~<QB™m­
>

37 
	~<io¡»am
>

38 
	~<time.h
>

39 
	~<ut™y
>

41 
	~"bÏckbßrd/BÏckbßrd.hµ
"

42 
	~"‹amTab.hµ
"

43 
	~"ty³s/SPLSnd¬dMes§ge.hµ
"

45 
	~<boo¡/asio/¶aûhŞd”s.hµ
>

47 
usšg
 
Çme¥aû
 
	g¡d
;

49 
	gT—mTab
::
	$T—mTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
) :

50 
	`£rviû
(),

51 
	`sock‘
(
£rviû
,

52 
boo¡
::
asio
::

::
udp
::
	`’dpošt
(boo¡::asio::::udp::
	`v4
(),

53 
PORT
)),

54 
	$‹am
(18) {

55 
	`š™M’u
(
m’uB¬
);

56 
	`š™
();

57 
this
->
·»Á
 =…arent;

59 
time_t
 
cu¼’tTime
 = 
	`time
(
NULL
);

61 
i
 = 0; i < 
NUM_ROBOTS
; ++i) {

62 
AbsCoÜd
 
	`r
 (0, 3400, 0);

63 
r
.
v¬
.
	`£tZ”o
();

64 
robÙs
.
	`push_back
(
r
);

65 
b®ls
.
	`push_back
(
r
);

66 
w®kšgTo
.
	`push_back
(
r
);

67 
shoÙšgTo
.
	`push_back
(
r
);

68 
timeOut
.
	`push_back
(
cu¼’tTime
);

70 
	`¡¬tLi¡’šg
();

71 
t
 = 
Ãw
 
boo¡
::
	`th»ad
(boo¡::
	`bšd
(&boo¡::
asio
::
io_£rviû
::
run
, &
£rviû
));

72 
	}
}

74 
	gT—mTab
::~
	$T—mTab
() {

75 
d–‘e
 
Ïyout
;

76 
	}
}

78 
	gT—mTab
::
	$š™M’u
(
QM’uB¬
 *) {

79 
	}
}

81 
T—mTab
::
	$š™
() {

83 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

84 
	`£tLayout
(
Ïyout
);

85 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

86 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

87 
‹amNum
 = 
Ãw
 
	`QLšeEd™
("18");

88 
‹amNum
->
	`£tFixedWidth
(100);

89 
‹amUpd©e
 = 
Ãw
 
	`QPushBu‰Ú
("Change Team");

91 
Ïyout
->
	`addWidg‘
(&
f›ldV›w
, 0, 0);

92 
Ïyout
->
	`addWidg‘
(
Ãw
 
	`QLab–
 ("Team: "), 0, 1);

93 
Ïyout
->
	`addWidg‘
(
‹amNum
, 0, 2);

94 
Ïyout
->
	`addWidg‘
(
‹amUpd©e
, 0, 3);

97 
f›ldV›w
.
	`»d¿w
(
NULL
);

99 
	`cÚÃù
(
this
, 
	`SIGNAL
(
	`upd©e
()),his, 
	`SLOT
(
	`»d¿w
()));

100 
	`cÚÃù
(
‹amUpd©e
, 
	`SIGNAL
(
	`»Ëa£d
()), 
this
, 
	`SLOT
(
	`chªgeT—m
()));

101 
	}
}

103 
	gT—mTab
::
	$»d¿w
() {

104 
f›ldV›w
.
	`»d¿w
(
robÙs
, 
w®kšgTo
, 
b®ls
, 
shoÙšgTo
);

105 
	}
}

107 
	gT—mTab
::
	$chªgeT—m
() {

108 
‹am
 = 
‹amNum
->
	`‹xt
().
	`toFlßt
();

109 
	}
}

111 
	gT—mTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

113 
	}
}

115 
T—mTab
::
	$hªdËReûive
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
,

116 
¡d
::
size_t
 
size
) {

117 
time_t
 
cu¼’tTime
 = 
	`time
(
NULL
);

119 
SPLSnd¬dMes§ge
* 
m
 = 
»š‹½»t_ÿ¡
<SPLSnd¬dMes§ge*>(
»cvBufãr
);

120 
Brßdÿ¡D©a
* 
bd
 = (Brßdÿ¡D©a*)
m
->
d©a
;

121 ià(
size
 =ğ(
SPLSnd¬dMes§ge
) &&

122 
m
->
numOfD©aBy‹s
 =ğ(
Brßdÿ¡D©a
) &&

123 
bd
->
‹am
 ==eam) {

124 
robÙs
 [
bd
->
¶ay”Num
-1] = bd->
robÙPos
;

125 
b®ls
 [
bd
->
¶ay”Num
-1] = bd->
b®lPosAbs
;

126 
timeOut
[
bd
->
¶ay”Num
-1] = 
cu¼’tTime
;

128 
AbsCoÜd
 
	`w
 (
m
->
w®kšgTo
[0], m->walkingTo[1], 0);

129 
i
 = 0; i < 3; i++) {

130 
j
 = 0; j < 3; j++) {

131 
w
.
	`v¬
(
i
, 
j
) = 0;

134 
w®kšgTo
[
bd
->
¶ay”Num
-1] = 
w
;

136 
AbsCoÜd
 
	`s
 (
m
->
shoÙšgTo
[0], m->shootingTo[1], 0);

137 
shoÙšgTo
[
bd
->
¶ay”Num
-1] = 
s
;

141 
tim”
 = 
cu¼’tTime
 - 5;

142 
i
 = 0; i < 
NUM_ROBOTS
; ++i) {

143 ià(
timeOut
[
i
] < 
tim”
) {

144 
AbsCoÜd
 
	`r
 (0, 3400, 0);

145 
r
.
v¬
.
	`£tZ”o
();

146 
robÙs
[
i
] = 
r
;

147 
b®ls
[
i
] = 
r
;

148 
w®kšgTo
[
i
] = 
r
;

149 
shoÙšgTo
[
i
] = 
r
;

153 
	`upd©e
();

154 
	`¡¬tLi¡’šg
();

155 
	}
}

157 
	gT—mTab
::
	$¡¬tLi¡’šg
() {

159 
sock‘
.
	`async_»ûive_äom
(

160 
boo¡
::
asio
::
	`bufãr
(boo¡::asio::
	`mubË_bufãr
((*)&
»cvBufãr
,

161 (
»cvBufãr
))),

162 
»mÙeEndpošt
,

163 
boo¡
::
	`bšd
(&
T—mTab
::
hªdËReûive
, 
this
,

164 
boo¡
::
asio
::
¶aûhŞd”s
::
”rÜ
,

165 
boo¡
::
asio
::
¶aûhŞd”s
::
by‹s_Œªsã¼ed
));

167 
	}
}

	@utils/offnao/tabs/teamTab.hpp

32 #´agm¨
Úû


35 
	~<QCŞÜ
>

36 
	~<QEv’t
>

37 
	~<QGridLayout
>

38 
	~<QLab–
>

39 
	~<QLšeEd™
>

40 
	~<QM’uB¬
>

41 
	~<QObjeù
>

42 
	~<QPaš‹r
>

43 
	~<QPixm­
>

44 
	~<QPushBu‰Ú
>

45 
	~<QTabWidg‘
>

46 
	~<QTh»ad
>

47 
	~<QT»eWidg‘I‹m
>

48 
	~<QT»eWidg‘
>

49 
	~<QWidg‘
>

50 
	~<QVBoxLayout
>

52 
	~<c¡dio
>

53 
	~<deque
>

55 
	~"bÏckbßrd/BÏckbßrd.hµ
"

56 
	~"bs/b.hµ
"

57 
	~"uts/Logg”.hµ
"

58 
	~"f›ldV›w.hµ
"

59 
	~"medŸPª–.hµ
"

61 
	~<boo¡/sy¡em/”rÜ_code.hµ
>

62 
	~<boo¡/asio/io_£rviû.hµ
>

63 
	~<boo¡/asio//udp.hµ
>

64 
	~<boo¡/th»ad.hµ
>

66 
	#PORT
 10018

	)

67 
	#NUM_ROBOTS
 5

	)

69 
şass
 
	gBÏckbßrd
;

71 şas 
	cT—mTab
 : 
public
 
Tab
 {

72 
Q_OBJECT


73 
public
:

74 
T—mTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
);

75 ~
T—mTab
();

77 
¡¬tLi¡’šg
();

78 
hªdËReûive
(cÚ¡ 
boo¡
::
sy¡em
::
”rÜ_code
 &
”rÜ
,

79 
¡d
::
size_t
 
size
);

81 
QPixm­
 *
	m»nd”Pixm­
;

82 
QLab–
 *
	m»nd”Widg‘
;

86 
	m»cvBufãr
[1500];

88 
	m¡d
::
veùÜ
<
AbsCoÜd
> 
robÙs
;

89 
	m¡d
::
veùÜ
<
AbsCoÜd
> 
w®kšgTo
;

90 
	m¡d
::
veùÜ
<
AbsCoÜd
> 
shoÙšgTo
;

91 
	m¡d
::
veùÜ
<
AbsCoÜd
> 
b®ls
;

92 
	m¡d
::
veùÜ
<> 
timeOut
;

94 
	m´iv©e
:

95 
š™
();

96 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

98 
QGridLayout
 *
	mÏyout
;

99 
QLšeEd™
 *
	m‹amNum
;

100 
QPushBu‰Ú
 *
	m‹amUpd©e
;

103 
F›ldV›w
 
	mf›ldV›w
;

106 
	mboo¡
::
asio
::
io_£rviû
 
£rviû
;

107 
	mboo¡
::
asio
::

::
udp
::
sock‘
 socket;

108 
	mboo¡
::
asio
::

::
udp
::
’dpošt
 
»mÙeEndpošt
;

109 
	mboo¡
::
th»ad
 *
t
;

112 
	m‹am
;

114 
public
 
	m¦Ùs
:

115 
chªgeT—m
();

116 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

117 
»d¿w
();

119 
	msigÇls
:

120 
upd©e
();

	@utils/offnao/tabs/variableView.cpp

32 
	~"v¬ŸbËV›w.hµ
"

33 
	~<QT»eWidg‘I‹m
>

34 
	~<QSŒšgLi¡
>

35 
	~<QSŒšg
>

36 
	~<¡ršg
>

37 
	~<ut™y
>

38 
	~"ty³s/AùiÚCommªd.hµ
"

39 
	~"bÏckbßrd/BÏckbßrd.hµ
"

40 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

45 
	gV¬ŸbËV›w
::
	$V¬ŸbËV›w
() {

46 
³rû±iÚH—dšg
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
this
, 
	`QSŒšgLi¡
(
	`QSŒšg
("Perception")), 1);

47 
³rû±iÚH—dšg
->
	`£tEx·nded
(
Œue
);

48 
³rû±iÚAv”ageFPS
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
³rû±iÚH—dšg
,

49 
	`QSŒšgLi¡
(
	`QSŒšg
("Framerate: ")), 1);

50 
³rû±iÚKšem©icsTime
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
³rû±iÚH—dšg
,

51 
	`QSŒšgLi¡
(
	`QSŒšg
("Kinematicsime: ")), 1);

52 
³rû±iÚVisiÚTime
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
³rû±iÚH—dšg
,

53 
	`QSŒšgLi¡
(
	`QSŒšg
("Visionime: ")), 1);

54 
³rû±iÚLoÿli§tiÚTime
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
³rû±iÚH—dšg
,

55 
	`QSŒšgLi¡
(
	`QSŒšg
("Localisationime: ")), 1);

56 
³rû±iÚBehaviourTime
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
³rû±iÚH—dšg
,

57 
	`QSŒšgLi¡
(
	`QSŒšg
("Behaviourime: ")), 1);

58 
³rû±iÚTÙ®Time
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
³rû±iÚH—dšg
,

59 
	`QSŒšgLi¡
(
	`QSŒšg
("Totalime: ")), 1);

61 
visiÚH—dšg
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
this
, 
	`QSŒšgLi¡
(
	`QSŒšg
("Vision")), 1);

62 
visiÚH—dšg
->
	`£tEx·nded
(
Œue
);

64 
visiÚTime¡amp
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

65 
	`QSŒšgLi¡
(
	`QSŒšg
("Vision Timestamp = ")), 1);

66 
visiÚDxdy
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

67 
	`QSŒšgLi¡
(
	`QSŒšg
("Vision DxDy = ")), 1);

68 
visiÚF¿mes
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

69 
	`QSŒšgLi¡
(
	`QSŒšg
("Surf Missed Frames = ")), 1);

70 
visiÚGßlProb
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

71 
	`QSŒšgLi¡
(
	`QSŒšg
("Away Goal Prob = ")), 1);

72 
visiÚHomeM­Size
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

73 
	`QSŒšgLi¡
(
	`QSŒšg
("Home Map Size = ")), 1);

74 
visiÚAwayM­Size
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

75 
	`QSŒšgLi¡
(
	`QSŒšg
("Away Map Size = ")), 1);

76 
visiÚGßl
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

77 
	`QSŒšgLi¡
(
	`QSŒšg
("Goal Area = ")), 1);

78 
visiÚNumB®ls
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

79 
	`QSŒšgLi¡
(
	`QSŒšg
("# Balls = ")), 1);

80 
visiÚB®lPos
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

81 
	`QSŒšgLi¡
(
	`QSŒšg
("Ball Pos = ")), 1);

82 
visiÚB®lPosRobÙR–©ive
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

83 
	`QSŒšgLi¡
(
	`QSŒšg
("Robot„elative Ball Pos = ")), 1);

84 
visiÚPo¡Ty³1
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

85 
	`QSŒšgLi¡
(
	`QSŒšg
("Post Type 1 = ")), 1);

86 
visiÚPo¡1
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

87 
	`QSŒšgLi¡
(
	`QSŒšg
("Post 1 @ ")), 1);

88 
visiÚPo¡Info1
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

89 
	`QSŒšgLi¡
(
	`QSŒšg
("Post 1 - ")), 1);

90 
visiÚPo¡Ty³2
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

91 
	`QSŒšgLi¡
(
	`QSŒšg
("Post Type 2 = ")), 1);

92 
visiÚPo¡2
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

93 
	`QSŒšgLi¡
(
	`QSŒšg
("Post 2 @ ")), 1);

94 
visiÚPo¡Info2
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

95 
	`QSŒšgLi¡
(
	`QSŒšg
("Post 2 - ")), 1);

96 
visiÚNumF“t
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

97 
	`QSŒšgLi¡
(
	`QSŒšg
("NumFeet = ")), 1);

98 
visiÚFoÙ1
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

99 
	`QSŒšgLi¡
(
	`QSŒšg
("Foot1 = ")), 1);

100 
visiÚFoÙ2
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
visiÚH—dšg
,

101 
	`QSŒšgLi¡
(
	`QSŒšg
("Foot2 = ")), 1);

103 
this
->
	`£tH—d”Lab–
(
	`QSŒšg
("State variables"));

105 
loÿli§tiÚH—dšg
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
this
,

106 
	`QSŒšgLi¡
(
	`QSŒšg
("Localisation")), 1);

107 
loÿli§tiÚH—dšg
->
	`£tEx·nded
(
Œue
);

108 
loÿli§tiÚRobÙPos
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
loÿli§tiÚH—dšg
,

109 
	`QSŒšgLi¡
(
	`QSŒšg
("Robot…os = ")), 1);

111 
mÙiÚH—dšg
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
this
, 
	`QSŒšgLi¡
(
	`QSŒšg
("Motion")), 1);

112 
mÙiÚH—dšg
->
	`£tEx·nded
(
Œue
);

114 
mÙiÚH—dYaw
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
mÙiÚH—dšg
,

115 
	`QSŒšgLi¡
(
	`QSŒšg
("HeadYaw = ")), 1);

116 
kšem©icsH—dYaw
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
mÙiÚH—dšg
,

117 
	`QSŒšgLi¡
(
	`QSŒšg
("HeadYawK = ")), 1);

119 
behaviourH—dšg
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
this
,

120 
	`QSŒšgLi¡
(
	`QSŒšg
("Behaviour")), 1);

121 
behaviourBodyReque¡
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
behaviourH—dšg
,

122 
	`QSŒšgLi¡
(
	`QSŒšg
("request.body.actionType = ")), 1);

123 
behaviourH—dšg
->
	`£tEx·nded
(
Œue
);

125 
gameCÚŒŞËrH—dšg
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
this
,

126 
	`QSŒšgLi¡
(
	`QSŒšg
("GameController")), 1);

127 
gameCÚŒŞËrT—m
 = 
Ãw
 
	`QT»eWidg‘I‹m
(
gameCÚŒŞËrH—dšg
,

128 
	`QSŒšgLi¡
(
	`QSŒšg
("gameController.team_red = ")), 1);

129 
gameCÚŒŞËrH—dšg
->
	`£tEx·nded
(
Œue
);

131 
this
->
	`addTİLev–I‹m
(
visiÚH—dšg
);

132 
this
->
	`addTİLev–I‹m
(
loÿli§tiÚH—dšg
);

133 
this
->
	`addTİLev–I‹m
(
mÙiÚH—dšg
);

134 
this
->
	`addTİLev–I‹m
(
behaviourH—dšg
);

135 
	}
}

137 
	gV¬ŸbËV›w
::
	$»d¿w
(
NaoD©a
 *
ÇoD©a
) {

138 
F¿me
 
äame
 = 
ÇoD©a
->
	`g‘Cu¼’tF¿me
();

139 
BÏckbßrd
 *
bÏckbßrd
 = (
äame
.blackboard);

140 if(!
bÏckbßrd
) ;

144 
AbsCoÜd
 
pos
 = 
	`»adFrom
(
loÿli§tiÚ
, 
robÙPos
);

145 
¡ršg¡»am
 
¥os
;

147 
ušt32_t
 
b®lLo¡CouÁ
 = 
	`»adFrom
(
loÿli§tiÚ
, ballLostCount);

148 
AbsCoÜd
 
b®lPos
 = 
	`»adFrom
(
loÿli§tiÚ
, ballPos);

149 
AbsCoÜd
 
b®lV–RRC
 = 
	`»adFrom
(
loÿli§tiÚ
, ballVelRRC);

151 
¥os
 << " RobÙ @ (" << 
pos
.
	`x
(è<< ", " <<…os.
	`y
(è<< ")" << 
’dl
;

152 
¥os
 << "H—dšg: " << 
pos
.
	`th‘a
(è<< " (" << 
	`RAD2DEG
Õos.th‘a()è<< " deg)" << 
’dl
;

153 
¥os
 << "V¬Ÿnû: " << 
pos
.
	`v¬
(0,0è<< ", " <<…os.v¬(1,1è<< ", " <<…os.v¬(2,2è<< 
’dl
;

155 
¥os
 << "b®lLo¡CouÁ: " << 
b®lLo¡CouÁ
 << 
’dl
;

156 
¥os
 << "b®Èpos; x:" << 
b®lPos
.
	`x
(è<< ", y:" << b®lPos.
	`y
(è<< 
’dl
;

157 
¥os
 << "b®Èv¬; xx:" << 
b®lPos
.
	`v¬
(0,0è<< ", xy:" << b®lPos.v¬(0,1è<< 
’dl
;

158 
¥os
 << " yx:" << 
b®lPos
.
	`v¬
(1,0è<< ", yy:" << b®lPos.v¬(1,1è<< 
’dl
;

159 
¥os
 << "b®Èv–„rc; x':" << 
b®lV–RRC
.
	`x
(è<< ", y':" << b®lV–RRC.
	`y
(è<< 
’dl
;

160 
¥os
 << "b®Èv–„røv¬; x'x':" << 
b®lV–RRC
.
	`v¬
(0,0è<< ", x'y':" << b®lV–RRC.v¬(0,1è<< 
’dl
;

161 
¥os
 << " y'x':" << 
b®lV–RRC
.
	`v¬
(1,0è<< ", y'y':" << b®lV–RRC.v¬(1,1è<< 
’dl
;

163 
loÿli§tiÚRobÙPos
->
	`£tText
(0, 
¥os
.
	`¡r
().
	`c_¡r
());

165 
	`upd©eVisiÚ
(
ÇoD©a
);

166 
	`upd©eBehaviour
(
ÇoD©a
);

167 
¡ršg¡»am
 
¡—m
;

168 
¡—m
 << "gamecÚŒŞËr.‹am_»d = " << 
	`»adFrom
(
gameCÚŒŞËr
, 
‹am_»d
è<< 
’dl
;

169 
gameCÚŒŞËrT—m
->
	`£tText
(0, 
¡—m
.
	`¡r
().
	`c_¡r
());

170 
	}
}

172 
	g‹m¶©e
 <
şass
 
	gT
>

173 cÚ¡ * 
	gV¬ŸbËV›w
::
	$ü—‹SufP»f
(
¡ršg
 
´ef
, 
T
 
t
, sŒšg 
suff
) {

174 
¡ršg¡»am
 
s
;

175 
s
 << 
´ef
 << 
t
 << 
suff
;

176  
s
.
	`¡r
().
	`c_¡r
();

177 
	}
}

179 
	gV¬ŸbËV›w
::
	$upd©eBehaviour
(
NaoD©a
 *
ÇoD©a
) {

180 
BÏckbßrd
 *
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

181 ià(!
bÏckbßrd
) ;

183 
¡ršg
 
aùiÚName
;

185 
	`»adFrom
(
mÙiÚ
, 
aùive
).
body
.
aùiÚTy³
) {

186 
AùiÚCommªd
::
Body
::
NONE
: 
aùiÚName
 = "NONE"; ;

187 
AùiÚCommªd
::
Body
::
STAND
: 
aùiÚName
 = "STAND"; ;

188 
AùiÚCommªd
::
Body
::
WALK
: 
aùiÚName
 = "WALK"; ;

189 
AùiÚCommªd
::
Body
::
DRIBBLE
: 
aùiÚName
 = "DRIBBLE"; ;

190 
AùiÚCommªd
::
Body
::
GETUP_FRONT
: 
aùiÚName
 = "GETUP_FRONT"; ;

191 
AùiÚCommªd
::
Body
::
GETUP_BACK
: 
aùiÚName
 = "GETUP_BACK"; ;

192 
AùiÚCommªd
::
Body
::
KICK
: 
aùiÚName
 = "KICK"; ;

193 
AùiÚCommªd
::
Body
::
INITIAL
: 
aùiÚName
 = "INITIAL"; ;

194 
AùiÚCommªd
::
Body
::
DEAD
: 
aùiÚName
 = "DEAD"; ;

195 
AùiÚCommªd
::
Body
::
REF_PICKUP
: 
aùiÚName
 = "REF_PICKUP"; ;

196 
AùiÚCommªd
::
Body
::
OPEN_FEET
: 
aùiÚName
 = "OPEN_FEET"; ;

197 
AùiÚCommªd
::
Body
::
THROW_IN
: 
aùiÚName
 = "THROW_IN"; ;

198 
AùiÚCommªd
::
Body
::
GOALIE_SIT
: 
aùiÚName
 = "GOALIE_SIT"; ;

199 
AùiÚCommªd
::
Body
::
GOALIE_DIVE_RIGHT
: 
aùiÚName
 = "GOALIE_DIVE_RIGHT"; ;

200 
AùiÚCommªd
::
Body
::
GOALIE_DIVE_LEFT
: 
aùiÚName
 = "GOALIE_DIVE_LEFT"; ;

201 
AùiÚCommªd
::
Body
::
GOALIE_CENTRE
: 
aùiÚName
 = "GOALIE_CENTRE"; ;

202 
AùiÚCommªd
::
Body
::
GOALIE_UNCENTRE
: 
aùiÚName
 = "GOALIE_UNCENTRE"; ;

203 
AùiÚCommªd
::
Body
::
GOALIE_STAND
: 
aùiÚName
 = "GOALIE_STAND"; ;

204 
AùiÚCommªd
::
Body
::
GOALIE_INITIAL
: 
aùiÚName
 = "GOALIE_INITIAL"; ;

205 
AùiÚCommªd
::
Body
::
GOALIE_AFTERSIT_INITIAL
: 
aùiÚName
 = "GOALIE_AFTERSIT_INITIAL"; ;

207 : 
aùiÚName
 = "Other"; ;

209 
behaviourBodyReque¡
->
	`£tText
(0, 
	`ü—‹SufP»f
("request.body.actionType = ",

210 
aùiÚName
, ""));

211 
	}
}

213 
	gV¬ŸbËV›w
::
	$upd©eVisiÚ
(
NaoD©a
 *
ÇoD©a
) {

214 
BÏckbßrd
 *
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

215 ià(!
bÏckbßrd
) ;

217 
¡d
::
veùÜ
<
FoÙInfo
> 
ã‘
 = 
	`»adFrom
 (
visiÚ
, 
ã‘Boxes
);

218 
¡d
::
veùÜ
<
B®lInfo
> 
b®ls
 = 
	`»adFrom
 (
visiÚ
, balls);

219 
B®lHšt
 
b®lHšt
 = 
	`»adFrom
 (
visiÚ
, ballHint);

220 
¡d
::
veùÜ
<
Po¡Info
> 
po¡s
 = 
	`»adFrom
 (
visiÚ
,…osts);

221 
¡d
::
veùÜ
<
RobÙInfo
> 
robÙs
 = 
	`»adFrom
 (
visiÚ
,„obots);

222 
¡d
::
veùÜ
<
F›ldBound¬yInfo
> 
f›ldBound¬›s
 = 
	`»adFrom
 (
visiÚ
, fieldBoundaries);

223 
¡d
::
veùÜ
<
F›ldF—tu»Info
> 
f›ldF—tu»s
 = 
	`»adFrom
 (
visiÚ
, fieldFeatures);

224 
¡d
::
·œ
<, > 
dxdy
 = 
	`»adFrom
 (
visiÚ
, dxdy);

226 
h—dYaw
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
).
jošts
.
ªgËs
[
Jošts
::
H—dYaw
];

227 
h—dYawK
 = 
	`»adFrom
(
kšem©ics
, 
£nsÜsLagged
).
jošts
.
ªgËs
[
Jošts
::
H—dYaw
];

228 
ušt32_t
 
tÙ®
 = 
	`»adFrom
(
³rû±iÚ
,otal);

230 
times
.
	`push_back
(
tÙ®
);

231 ià(
times
.
	`size
(è> 10ètimes.
	`pİ_äÚt
();

232 
sum
 = 0;

233 
i
 = 0; i < 
times
.
	`size
(); i++è
sum
 +=imes[i];

234 
ås
 = 1000000.0/
tÙ®
;

237 
³rû±iÚAv”ageFPS
->
	`£tText
(0, 
	`ü—‹SufP»f
("F¿m”©e: ", 
ås
, " fps"));

238 
³rû±iÚKšem©icsTime
->
	`£tText
(0, 
	`ü—‹SufP»f
("Kšem©ic time: ", 
	`»adFrom
(
³rû±iÚ
, 
kšem©ics
), ""));

239 
³rû±iÚVisiÚTime
->
	`£tText
(0, 
	`ü—‹SufP»f
("VisiÚime: ", 
	`»adFrom
(
³rû±iÚ
, 
visiÚ
), ""));

240 
³rû±iÚLoÿli§tiÚTime
->
	`£tText
(0, 
	`ü—‹SufP»f
("Loÿli§tiÚime: ", 
	`»adFrom
(
³rû±iÚ
, 
loÿli§tiÚ
), ""));

241 
³rû±iÚBehaviourTime
->
	`£tText
(0, 
	`ü—‹SufP»f
("Behaviou¸time: ", 
	`»adFrom
(
³rû±iÚ
, 
behaviour
), ""));

242 
³rû±iÚTÙ®Time
->
	`£tText
(0, 
	`ü—‹SufP»f
("TÙ®ime: ", 
tÙ®
, ""));

244 
visiÚTime¡amp
->
	`£tText
(0, 
	`ü—‹SufP»f
("Time¡amp: ", 
	`»adFrom
(
visiÚ
, 
time¡amp
), ""));

245 
visiÚF¿mes
->
	`£tText
(0, 
	`ü—‹SufP»f
("Suràmis£d f¿mes: ", 
	`»adFrom
(
visiÚ
, 
mis£dF¿mes
), ""));

246 
visiÚGßlProb
->
	`£tText
(0, 
	`ü—‹SufP»f
("Away GßÈProb: ", 
	`»adFrom
(
visiÚ
, 
awayGßlProb
), ""));

247 
visiÚHomeM­Size
->
	`£tText
(0, 
	`ü—‹SufP»f
("HomM­ Size: ", 
	`»adFrom
(
visiÚ
, 
homeM­Size
), ""));

248 
visiÚAwayM­Size
->
	`£tText
(0, 
	`ü—‹SufP»f
("Away M­ Size: ", 
	`»adFrom
(
visiÚ
, 
awayM­Size
), ""));

249 
visiÚGßl
->
	`£tText
(0, 
	`ü—‹SufP»f
("GßÈA»a: ", 
Po¡Info
::
Ty³Name
[
	`»adFrom
(
visiÚ
, 
gßlA»a
)], ""));

251 
¡ršg¡»am
 
sdxdy
;

252 
sdxdy
 << "VisiÚ DxDy: (" << 
dxdy
.
fœ¡
 << "," << dxdy.
£cÚd
 << ")";

253 
visiÚDxdy
->
	`£tText
(0, 
sdxdy
.
	`¡r
().
	`c_¡r
());

256 
¡ršg¡»am
 
sB®lPos
;

258 
sB®lPos
 << "B®lHšt: " << 
B®lHšt
::
Ty³Name
[
b®lHšt
.
ty³
] << "\n";

260 
numB®ls
 = 
b®ls
.
	`size
 ();

261 ià(
numB®ls
 == 0) {

263 
Pošt
 
b®lLoÿtiÚ
 = 
b®ls
[0].
imageCoÜds
;

264 
sB®lPos
 << "B®Èi © (" << 
b®lLoÿtiÚ
.
	`x
() <<

265 ", " << 
b®lLoÿtiÚ
.
	`y
 () << ")";

267 
visiÚB®lPos
->
	`£tText
(0, 
sB®lPos
.
	`¡r
().
	`c_¡r
());

269 
¡ršg¡»am
 
s
;

271 
numBound¬›s
 = 
f›ldBound¬›s
.
	`size
 ();

272 
RANSACLše
 
bound¬›s
[
MAX_FIELD_BOUNDARIES
];

274 
i
 = 0; i < 
numBound¬›s
; ++ i) {

275 
bound¬›s
[
i
] = 
f›ldBound¬›s
[i].
¼Bound¬y
;

279 
s
 << "numBound¬› " << 
numBound¬›s
 << 
’dl
;

280 
i
 = 0; i < 
numBound¬›s
; i++) {

281 
s
 << "Edg1: " << 
bound¬›s
[
i
].
t1
 << "x + " << bound¬›s[i].
t2
 <<

282 "y + " << 
bound¬›s
[
i
].
t3
 << 
’dl
;

285 
s
.
	`¡r
 ("");

286 
s
 << "Po¡ Ty³ 1 = " << 
Po¡Info
::
Ty³Name
[Po¡Info::
pNÚe
];

287 
visiÚPo¡Ty³1
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

289 
s
.
	`¡r
 ("");

290 
s
 << "Po¡ Ty³ 2 = " << 
Po¡Info
::
Ty³Name
[Po¡Info::
pNÚe
];

291 
visiÚPo¡Ty³2
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

293 
visiÚPo¡1
->
	`£tText
 (0, "Post 1 @ ");

294 
visiÚPo¡2
->
	`£tText
 (0, "Post 2 @ ");

295 
visiÚPo¡Info1
->
	`£tText
 (0, "P1 - ");

296 
visiÚPo¡Info2
->
	`£tText
 (0, "P2 - ");

299 ià(
po¡s
.
	`size
 () > 0) {

300 
Po¡Info
 
p
 = 
po¡s
[0];

301 
RRCoÜd
 
¼
 = 
po¡s
[0].rr;

303 
s
.
	`¡r
 ("");

304 
s
 << "Po¡ Ty³ 1 = " << 
Po¡Info
::
Ty³Name
[
po¡s
[0].
ty³
];

305 
visiÚPo¡Ty³1
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

307 
s
.
	`¡r
 ("");

308 
s
 << "Post 1 @ "

309 << 
¼
.
	`di¡ªû
(è<< ", " << 
	`RAD2DEG
Ôr.
	`h—dšg
()) << ", " <<„r.heading()

310 << ", (" << 
¼
.
	`v¬
(0,0) << ", " <<„r.var(1,1) << ")";

311 
visiÚPo¡1
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

313 
s
.
	`¡r
 ("");

314 
s
 << "P1 - Tru¡ = " << 
p
.
Œu¡Di¡ªû
;

315 
s
 << ", dœ = " << 
Po¡Info
::
DœName
[
p
.
dœ
];

316 
visiÚPo¡Info1
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

319 ià(
po¡s
.
	`size
 () > 1) {

320 
Po¡Info
 
p
 = 
po¡s
[1];

321 
RRCoÜd
 
¼
 = 
po¡s
[1].rr;

323 
s
.
	`¡r
 ("");

324 
s
 << "Po¡ Ty³ 2 = " << 
Po¡Info
::
Ty³Name
[
po¡s
[1].
ty³
];

325 
visiÚPo¡Ty³2
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

327 
s
.
	`¡r
 ("");

328 
s
 << "Post 2 @ "

329 << 
¼
.
	`di¡ªû
(è<< ", " << 
	`RAD2DEG
Ôr.
	`h—dšg
()) << ", " <<„r.heading()

330 << ", (" << 
¼
.
	`v¬
(1,1) << ", " <<„r.var(2,2) << ")";

331 
visiÚPo¡2
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

333 
s
.
	`¡r
 ("");

334 
s
 << "P2 - Tru¡ = " << 
p
.
Œu¡Di¡ªû
;

335 
s
 << ", dœ = " << 
Po¡Info
::
DœName
[
p
.
dœ
];

336 
visiÚPo¡Info2
->
	`£tText
 (0, 
s
.
	`¡r
 ().
	`c_¡r
 ());

340 
¡ršg¡»am
 
sB®lPosR–©ive
;

341 if(
numB®ls
 > 0) {

342 
sB®lPosR–©ive
 << "B®È@ " << 
b®ls
[0].
¼
.
	`di¡ªû
() << ", " <<

343 
	`RAD2DEG
(
b®ls
[0].
¼
.
	`h—dšg
()) << ", " << balls[0].rr.heading();

345 
visiÚB®lPosRobÙR–©ive
->
	`£tText
(0, 
sB®lPosR–©ive
.
	`¡r
().
	`c_¡r
());

347 
this
->
visiÚNumB®ls
->
	`£tText
(0,
	`ü—‹SufP»f
("# B®ls: ", 
numB®ls
, ""));

349 
numF“t
 = 
ã‘
.
	`size
();

350 
this
->
visiÚNumF“t
->
	`£tText
(0,
	`ü—‹SufP»f
("# F“t: ", 
numF“t
, ""));

352 
¡ršg¡»am
 
foÙ1
;

353 
foÙ1
 << "Foot 1 Box: ";

354 
¡ršg¡»am
 
foÙ2
;

355 
foÙ2
 << "Foot 2 Box: ";

356 ià(
numF“t
 > 0) {

357 
foÙ1
 << "(" << 
ã‘
[0].
robÙBounds
.
a
.
	`x
(è<< ", " << f“t[0].robÙBounds.a.
	`y
(è<< ")" << 
’dl
;

358 
foÙ1
 << " (" << 
ã‘
[0].
robÙBounds
.
b
.
	`x
(è<< ", " << f“t[0].robÙBounds.b.
	`y
(è<< ")" << 
’dl
;

359 ià(
numF“t
 > 1) {

360 
foÙ2
 << "(" << 
ã‘
[1].
robÙBounds
.
a
.
	`x
(è<< ", " << f“t[1].robÙBounds.a.
	`y
(è<< ")" << 
’dl
;

361 
foÙ2
 << " (" << 
ã‘
[1].
robÙBounds
.
b
.
	`x
(è<< ", " << f“t[1].robÙBounds.b.
	`y
(è<< ")" << 
’dl
;

364 
visiÚFoÙ1
->
	`£tText
(0, 
foÙ1
.
	`¡r
().
	`c_¡r
());

365 
visiÚFoÙ2
->
	`£tText
(0, 
foÙ2
.
	`¡r
().
	`c_¡r
());

367 
¡ršg¡»am
 
h—d
;

368 
h—d
.
	`¡r
("");

369 
h—d
 << "H—dYaw = " << 
h—dYaw
;

370 
mÙiÚH—dYaw
->
	`£tText
 (0, 
h—d
.
	`¡r
 ().
	`c_¡r
 ());

372 
h—d
.
	`¡r
("");

373 
h—d
 << "H—dYawK = " << 
h—dYawK
;

374 
kšem©icsH—dYaw
->
	`£tText
 (0, 
h—d
.
	`¡r
 ().
	`c_¡r
 ());

376 
	}
}

	@utils/offnao/tabs/variableView.hpp

32 #´agm¨
Úû


34 
	~<QT»eWidg‘
>

35 
	~<QT»eWidg‘I‹m
>

36 
	~<deque
>

37 
	~<¡ršg
>

39 
	~"ÇoD©a.hµ
"

40 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

41 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

42 
	~"ty³s/B®lInfo.hµ
"

44 şas 
	cV¬ŸbËV›w
 : 
public
 
QT»eWidg‘
 {

45 
public
:

46 
V¬ŸbËV›w
();

47 
»d¿w
(
NaoD©a
 *
ÇoD©a
);

49 
	m´iv©e
:

50 
‹m¶©e
 <
şass
 
T
>

51 cÚ¡ * 
ü—‹SufP»f
(
¡d
::
¡ršg
, 
T
, std::string);

53 
QT»eWidg‘I‹m
 *
	mbehaviourH—dšg
;

54 
QT»eWidg‘I‹m
 *
	mbehaviourBodyReque¡
;

56 
QT»eWidg‘I‹m
 *
	mmÙiÚH—dšg
;

58 
QT»eWidg‘I‹m
 *
	mgameCÚŒŞËrH—dšg
;

59 
QT»eWidg‘I‹m
 *
	mgameCÚŒŞËrT—m
;

61 
QT»eWidg‘I‹m
 *
	m³rû±iÚH—dšg
;

62 
QT»eWidg‘I‹m
 *
	m³rû±iÚAv”ageFPS
;

63 
QT»eWidg‘I‹m
 *
	m³rû±iÚKšem©icsTime
;

64 
QT»eWidg‘I‹m
 *
	m³rû±iÚVisiÚTime
;

65 
QT»eWidg‘I‹m
 *
	m³rû±iÚLoÿli§tiÚTime
;

66 
QT»eWidg‘I‹m
 *
	m³rû±iÚBehaviourTime
;

67 
QT»eWidg‘I‹m
 *
	m³rû±iÚTÙ®Time
;

70 
QT»eWidg‘I‹m
 *
	mvisiÚTime¡amp
;

71 
QT»eWidg‘I‹m
 *
	mvisiÚDxdy
;

72 
QT»eWidg‘I‹m
 *
	mvisiÚF¿mes
;

73 
QT»eWidg‘I‹m
 *
	mvisiÚH—dšg
;

74 
QT»eWidg‘I‹m
 *
	mvisiÚGßl
;

75 
QT»eWidg‘I‹m
 *
	mvisiÚGßlProb
;

76 
QT»eWidg‘I‹m
 *
	mvisiÚHomeM­Size
;

77 
QT»eWidg‘I‹m
 *
	mvisiÚAwayM­Size
;

78 
QT»eWidg‘I‹m
 *
	mvisiÚB®lPos
;

79 
QT»eWidg‘I‹m
 *
	mvisiÚB®lPosRobÙR–©ive
;

80 
QT»eWidg‘I‹m
 *
	mvisiÚF¿meR©e
;

81 
QT»eWidg‘I‹m
 *
	mvisiÚNumB®ls
;

82 
QT»eWidg‘I‹m
 *
	mvisiÚPo¡Ty³1
;

83 
QT»eWidg‘I‹m
 *
	mvisiÚPo¡Ty³2
;

84 
QT»eWidg‘I‹m
 *
	mvisiÚPo¡1
;

85 
QT»eWidg‘I‹m
 *
	mvisiÚPo¡2
;

86 
QT»eWidg‘I‹m
 *
	mvisiÚPo¡Info1
;

87 
QT»eWidg‘I‹m
 *
	mvisiÚPo¡Info2
;

88 
QT»eWidg‘I‹m
 *
	mvisiÚNumF“t
;

89 
QT»eWidg‘I‹m
 *
	mvisiÚFoÙ1
;

90 
QT»eWidg‘I‹m
 *
	mvisiÚFoÙ2
;

92 
QT»eWidg‘I‹m
 *
	mmÙiÚH—dYaw
;

93 
QT»eWidg‘I‹m
 *
	mkšem©icsH—dYaw
;

95 
QT»eWidg‘I‹m
 *
	mloÿli§tiÚH—dšg
;

96 
QT»eWidg‘I‹m
 *
	mloÿli§tiÚRobÙPos
;

97 
	m¡d
::
deque
<> 
times
;

98 
upd©eVisiÚ
(
NaoD©a
 *
ÇoD©a
);

99 
upd©eBehaviour
(
NaoD©a
 *
ÇoD©a
);

	@utils/offnao/tabs/visionTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QFeDŸlog
>

35 
	~<QDebug
>

36 
	~<QPaš‹r
>

37 
	~<QMou£Ev’t
>

38 
	~<veùÜ
>

39 
	~<io¡»am
>

40 
	~<ut™y
>

41 
	~<s¡»am
>

42 
	~<¡ršg
>

43 
	~"visiÚTab.hµ
"

44 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

45 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

46 
	~"bÏckbßrd/BÏckbßrd.hµ
"

47 
	~"uts/Ov”ÏyPaš‹r.hµ
"

48 
	~"ty³s/VisiÚBÏckbßrdInfo.hµ
"

49 
	~"uts/CPÏÃCŞours.hµ
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

54 
	g¡d
::
¡ršg
 
	$di¥ÏyPošt2
(
Pošt
 
p
) {

55 
¡d
::
¡ršg¡»am
 
ss
;

57 
ss
 << "[" << 
p
.
	`x
(è<< "," <<….
	`y
() << "]";

58  
ss
.
	`¡r
();

59 
	}
}

61 
	g¡d
::
¡ršg
 
	$di¥ÏyBBox
(
BBox
 
b
) {

62 
¡d
::
¡ršg¡»am
 
ss
;

63 
ss
 << 
	`di¥ÏyPošt2
(
b
.
a
) << "o " << displayPoint2(b.b);

64  
ss
.
	`¡r
();

65 
	}
}

67 
	$d¿wBoundšgBox
(
Ov”ÏyPaš‹r
 &
·š‹r
, 
BBox
 
box
, 
QCŞÜ
 
cŞour
, cÚ¡ 
d’s™y
, cÚ¡ 
rowOff£t
) {

68 
QPaš‹rP©h
 
boxP©h
;

69 
boxP©h
.
	`moveTo
(
box
.
a
.
	`x
(è* 
d’s™y
, box.a.
	`y
(è* d’s™y + 
rowOff£t
);

70 
boxP©h
.
	`lšeTo
(
box
.
b
.
	`x
(è* 
d’s™y
, box.
a
.
	`y
(è* d’s™y + 
rowOff£t
);

71 
boxP©h
.
	`lšeTo
(
box
.
b
.
	`x
(è* 
d’s™y
, box.b.
	`y
(è* d’s™y + 
rowOff£t
);

72 
boxP©h
.
	`lšeTo
(
box
.
a
.
	`x
(è* 
d’s™y
, box.
b
.
	`y
(è* d’s™y + 
rowOff£t
);

73 
boxP©h
.
	`lšeTo
(
box
.
a
.
	`x
(è* 
d’s™y
, box.a.
	`y
(è* d’s™y + 
rowOff£t
);

74 
·š‹r
.
	`d¿wLšeP©h
(
boxP©h
, 
cŞour
);

75 
	}
}

77 
	g‹m¶©e
<
şass
 
	gT
>

78 
¡ršg
 
	$myts
(cÚ¡ 
T
& 
t
) {

79 
¡ršg¡»am
 
ss
;

80 
ss
 << 
t
;

81  
ss
.
	`¡r
();

82 
	}
}

84 
¡ršg
 
	gİ”©Ü
+(¡ršg 
	ga
, sŒšg 
	gb
) {

85 
¡ršg¡»am
 
	gss
;

86 
	gss
 << 
	ga
 << 
	gb
;

87  
	gss
.
¡r
().
c_¡r
();

90 
	gVisiÚTab
::
	$VisiÚTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
)

91 : 
	`zoomLev–
(1), 
	`zoomLog
(0), 
	`mou£X
(0), 
	`mou£Y
(0),

92 
	`´evMou£X
(0), 
	`´evMou£Y
(0), 
	`´evZoomLev–
(1),

93 
	$Âmc_lßded
(
çl£
)

95 
this
->
·»Á
 =…arent;

96 
this
->
visiÚ
 = vision;

98 
	`š™M’u
(
m’uB¬
);

99 
	`š™
();

100 
cu¼’tF¿me
 = 
NULL
;

101 
tİF¿me
 = 
NULL
;

102 
bÙF¿me
 = 
NULL
;

103 
	}
}

106 
	gVisiÚTab
::
	$š™M’u
(
QM’uB¬
 *
m’uB¬
) {

107 
visiÚM’u
 = 
Ãw
 
	`QM’u
("Vision");

108 
m’uB¬
->
	`addM’u
(
visiÚM’u
);

136 
	}
}

138 
	gVisiÚTab
::
	$š™
() {

139 
Ïyout
 = 
Ãw
 
	`QGridLayout
();

140 
this
->
	`£tLayout
(
Ïyout
);

142 
imagePixm­
 = 
	`QPixm­
(
IMAGE_COLS
, 
IMAGE_ROWS
);

143 
imagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

144 
ÿmLab–
 = 
Ãw
 
	`QLab–
();

145 
ÿmLab–
->
	`£tPixm­
(
imagePixm­
);

147 
Ïyout
->
	`addWidg‘
(
ÿmLab–
, 0, 0, 1, 1);

149 
QGroupBox
 *
groupBoxImage
 = 
Ãw
 
	`QGroupBox
 (
	`Œ
 ("Image Type"));

150 
QGroupBox
 *
groupBoxLowF—tu»s
 = 
Ãw
 
	`QGroupBox
 (
	`Œ
 ("Low Features"));

151 
QGroupBox
 *
groupBoxF—tu»s
 = 
Ãw
 
	`QGroupBox
 (
	`Œ
 ("Features"));

153 
groupBoxImage
->
	`£tMaximumWidth
 (200);

154 
groupBoxF—tu»s
->
	`£tMaximumWidth
 (200);

156 
QVBoxLayout
 *
vboxImage
 = 
Ãw
 
	`QVBoxLayout
 ();

157 
QVBoxLayout
 *
vboxLowF—tu»s
 = 
Ãw
 
	`QVBoxLayout
 ();

158 
QVBoxLayout
 *
vboxF—tu»s
 = 
Ãw
 
	`QVBoxLayout
 ();

160 
QVBoxLayout
 *
vboxRight
 = 
Ãw
 
	`QVBoxLayout
 ();

163 
¿dioImage
 = 
Ãw
 
	`QRadioBu‰Ú
 (
	`Œ
 ("Full Image"));

164 
¿dioS®›ncy
 = 
Ãw
 
	`QRadioBu‰Ú
 (
	`Œ
 ("Saliency Image\n(Load‚nmc)"));

165 
¿dioS®›ncyEdge
 = 
Ãw
 
	`QRadioBu‰Ú
 (
	`Œ
 ("Edge Saliency Image"));

166 
¿dioS®›ncyG»y
 = 
Ãw
 
	`QRadioBu‰Ú
 (
	`Œ
 ("Grey Saliency Image"));

171 
¿dioImage
->
	`£tChecked
(
Œue
);

174 
¿dioS®›ncy
->
	`£tEÇbËd
 (
çl£
);

176 
vboxImage
->
	`addWidg‘
 (
¿dioImage
);

177 
vboxImage
->
	`addWidg‘
 (
¿dioS®›ncy
);

178 
vboxImage
->
	`addWidg‘
 (
¿dioS®›ncyEdge
);

179 
vboxImage
->
	`addWidg‘
 (
¿dioS®›ncyG»y
);

182 
groupBoxImage
->
	`£tLayout
 (
vboxImage
);

185 
checkBÙtomImage
 = 
Ãw
 
	`QCheckBox
("BÙtomCam”a", 
this
);

186 
checkEdgeDœeùiÚs
 = 
Ãw
 
	`QCheckBox
("EdgDœeùiÚs", 
this
);

187 
checkEdgeOr›Á©iÚs
 = 
Ãw
 
	`QCheckBox
("EdgOr›Á©iÚs", 
this
);

188 
checkP©ches
 = 
Ãw
 
	`QCheckBox
("P©ches", 
this
);

189 
checkLowLšes
 = 
Ãw
 
	`QCheckBox
("Low Lšes", 
this
);

191 
vboxLowF—tu»s
->
	`addWidg‘
 (
checkBÙtomImage
 );

192 
vboxLowF—tu»s
->
	`addWidg‘
 (
checkEdgeDœeùiÚs
 );

193 
vboxLowF—tu»s
->
	`addWidg‘
 (
checkEdgeOr›Á©iÚs
);

194 
vboxLowF—tu»s
->
	`addWidg‘
 (
checkP©ches
 );

195 
vboxLowF—tu»s
->
	`addWidg‘
 (
checkLowLšes
 );

197 
groupBoxLowF—tu»s
->
	`£tLayout
 (
vboxLowF—tu»s
);

199 
checkHÜizÚ
 = 
Ãw
 
	`QCheckBox
("HÜizÚ" , 
this
);

200 
checkB®l
 = 
Ãw
 
	`QCheckBox
("B®l" , 
this
);

201 
checkF“t
 = 
Ãw
 
	`QCheckBox
("F“t" , 
this
);

202 
checkGßls
 = 
Ãw
 
	`QCheckBox
("Gßls" , 
this
);

203 
checkRobÙs
 = 
Ãw
 
	`QCheckBox
("RobÙs" , 
this
);

204 
checkRobÙsDebug
 = 
Ãw
 
	`QCheckBox
("RobÙ Debug" , 
this
);

205 
checkF›ldEdges
 = 
Ãw
 
	`QCheckBox
("F›ld Edges" , 
this
);

206 
checkF›ldF—tu»s
 = 
Ãw
 
	`QCheckBox
("F›ld F—tu»s", 
this
);

207 
checkF“tDebug
 = 
Ãw
 
	`QCheckBox
("F“ˆDebug" , 
this
);

210 
checkHÜizÚ
->
	`£tChecked
(
çl£
);

211 
checkB®l
->
	`£tChecked
(
Œue
);

212 
checkF“t
->
	`£tChecked
(
çl£
);

213 
checkGßls
->
	`£tChecked
(
çl£
);

214 
checkRobÙs
->
	`£tChecked
(
çl£
);

215 
checkRobÙsDebug
->
	`£tChecked
(
çl£
);

216 
checkF›ldEdges
->
	`£tChecked
(
çl£
);

217 
checkF›ldF—tu»s
->
	`£tChecked
(
çl£
);

219 
vboxF—tu»s
->
	`addWidg‘
(
checkHÜizÚ
);

220 
vboxF—tu»s
->
	`addWidg‘
(
checkB®l
);

221 
vboxF—tu»s
->
	`addWidg‘
(
checkGßls
);

222 
vboxF—tu»s
->
	`addWidg‘
(
checkRobÙs
);

223 
vboxF—tu»s
->
	`addWidg‘
(
checkRobÙsDebug
);

224 
vboxF—tu»s
->
	`addWidg‘
(
checkF›ldEdges
);

225 
vboxF—tu»s
->
	`addWidg‘
(
checkF›ldF—tu»s
);

226 
vboxF—tu»s
->
	`addWidg‘
(
checkF“t
);

227 
vboxF—tu»s
->
	`addWidg‘
(
checkF“tDebug
);

229 
groupBoxF—tu»s
->
	`£tLayout
 (
vboxF—tu»s
);

232 
vboxRight
->
	`addWidg‘
 (
groupBoxImage
);

233 
vboxRight
->
	`addWidg‘
 (
groupBoxLowF—tu»s
);

234 
vboxRight
->
	`addWidg‘
 (
groupBoxF—tu»s
);

236 
Ïyout
->
	`addLayout
(
vboxRight
, 0, 2, 1, 1, 
Qt
::
AlignTİ
 | Qt::
AlignLeá
);

238 
	`cÚÃù
(
¿dioImage
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

239 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

240 
	`cÚÃù
(
¿dioS®›ncy
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

241 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

242 
	`cÚÃù
(
¿dioS®›ncyEdge
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

243 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

244 
	`cÚÃù
(
¿dioS®›ncyG»y
, 
	`SIGNAL
(
	`şicked
(
boŞ
)),

245 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

246 
	`cÚÃù
(
checkBÙtomImage
, 
	`SIGNAL
(
	`¡©eChªged
()),

247 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

248 
	`cÚÃù
(
checkEdgeDœeùiÚs
, 
	`SIGNAL
(
	`¡©eChªged
()),

249 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

250 
	`cÚÃù
(
checkEdgeOr›Á©iÚs
, 
	`SIGNAL
(
	`¡©eChªged
()),

251 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

252 
	`cÚÃù
(
checkP©ches
, 
	`SIGNAL
(
	`¡©eChªged
()),

253 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

254 
	`cÚÃù
(
checkLowLšes
, 
	`SIGNAL
(
	`¡©eChªged
()),

255 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

257 
	`cÚÃù
(
checkB®l
, 
	`SIGNAL
(
	`¡©eChªged
()),

258 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

259 
	`cÚÃù
(
checkF“t
, 
	`SIGNAL
(
	`¡©eChªged
()),

260 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

261 
	`cÚÃù
(
checkF“tDebug
, 
	`SIGNAL
(
	`¡©eChªged
()),

262 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

263 
	`cÚÃù
(
checkGßls
, 
	`SIGNAL
(
	`¡©eChªged
()),

264 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

265 
	`cÚÃù
(
checkRobÙs
, 
	`SIGNAL
(
	`¡©eChªged
()),

266 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

267 
	`cÚÃù
(
checkRobÙsDebug
, 
	`SIGNAL
(
	`¡©eChªged
()),

268 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

269 
	`cÚÃù
(
checkF›ldEdges
, 
	`SIGNAL
(
	`¡©eChªged
()),

270 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

271 
	`cÚÃù
(
checkF›ldF—tu»s
, 
	`SIGNAL
(
	`¡©eChªged
()),

272 
this
, 
	`SLOT
(
	`»d¿wSlÙ
()));

274 
this
->
	`£tMou£T¿ckšg
(
Œue
);

275 
ÿmLab–
->
	`£tMou£T¿ckšg
(
Œue
);

276 
ÿmLab–
->
	`£tAlignm’t
(
Qt
::
AlignTİ
);

277 
ÿmLab–
->
	`£tMšimumSize
(
IMAGE_COLS
, 
IMAGE_ROWS
);

278 
ÿmLab–
->
	`£tMaximumSize
(
IMAGE_COLS
, 
IMAGE_ROWS
);

279 
ÿmLab–
->
	`š¡®lEv’tF‹r
(
this
);

280 
	}
}

282 
	gVisiÚTab
::
	$mou£MoveEv’t
(
QMou£Ev’t
 * 
ev’t
) {

283 
mou£Pos™iÚ
 = 
ev’t
->
	`pos
();

284 
mou£Pos™iÚ
 -ğ
ÿmLab–
->
	`pos
();

285 ià(
cu¼’tF¿me
 && 
mou£Pos™iÚ
.
	`x
() >= 0 &&

286 
mou£Pos™iÚ
.
	`x
(è< 
IMAGE_COLS
 &&

287 
mou£Pos™iÚ
.
	`y
(è>ğ0 && mou£Pos™iÚ.y(è< 
IMAGE_ROWS
) {

288 
¡ršg¡»am
 
mes§ge
;

290 
mes§ge
 << "(" << 
mou£Pos™iÚ
.
	`x
(è<< "," << mou£Pos™iÚ.
	`y
() << ")";

291 
cŞs
 = (!
checkBÙtomImage
->
	`isChecked
()) ?

292 
TOP_IMAGE_COLS
 : 
BOT_IMAGE_COLS
;

293 
QCŞÜ
 
cŞour
 = 
	`QCŞÜ
(
this
->
	`g‘RGB
(
mou£Pos™iÚ
.
	`x
(),

294 
mou£Pos™iÚ
.
	`y
(), 
cu¼’tF¿me
, 
cŞs
));

296 
mes§ge
 << " - (" << 
cŞour
.
	`»d
() << ", " <<

297 
cŞour
.
	`g»’
(è<< ", " << cŞour.
	`blue
() << ")";

298 
em™
 
	`showMes§ge
(
	`QSŒšg
(
mes§ge
.
	`¡r
().
	`c_¡r
()), 0);

300 
	}
}

302 
	gVisiÚTab
::
	$»d¿w
() {

303 ià(
tİF¿me
) {

305 
VisiÚBÏckbßrdInfo
 
bb
;

306 
visiÚ
->
	`´oûssF¿me
(
	`CombšedF¿me
(
tİF¿me
, 
bÙF¿me
), 
bb
);

308 
boŞ
 
tİ
 = !(
checkBÙtomImage
->
	`isChecked
());

310 
Ï¡R’d”šg
 = 
	`QImage
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

311 ià(
tİ
) {

312 
Ï¡R’d”šg
 = 
	`QImage
(
IMAGE_COLS
, 
IMAGE_ROWS
, 
QImage
::
FÜm©_RGB32
);

314 ià(
¿dioImage
->
	`isChecked
 ()) {

315 
	`d¿wImage
 (&
Ï¡R’d”šg
, 
tİ
);

316 } ià(
¿dioS®›ncy
->
	`isChecked
 ()) {

317 
	`d¿wS®›ncy
 (&
Ï¡R’d”šg
, 
tİ
);

318 } ià(
¿dioS®›ncyEdge
->
	`isChecked
 ()) {

319 
	`d¿wS®›ncyEdge
 (&
Ï¡R’d”šg
, 
tİ
);

320 } ià(
¿dioS®›ncyG»y
->
	`isChecked
 ()) {

321 
	`d¿wS®›ncyG»y
 (&
Ï¡R’d”šg
, 
tİ
);

324 ià(
checkEdgeDœeùiÚs
->
	`isChecked
 ()) {

325 
	`d¿wEdgeDœeùiÚs
 (&
Ï¡R’d”šg
, 
tİ
);

328 ià(
Âmc_lßded
) {

329 
	`d¿wOv”Ïys
(&
Ï¡R’d”šg
, 
tİ
);

331 
imagePixm­
 = 
	`QPixm­
(
QPixm­
::
	`äomImage
(

332 
Ï¡R’d”šg
.
	`sÿËd
(
BOT_IMAGE_COLS
, 
BOT_IMAGE_ROWS
)));

336 ià(
tİ
) {

337 
QT¿nsfÜm
 
´evT¿nsfÜm
;

338 
´evT¿nsfÜm
 =…»vT¿nsfÜm.
	`Œª¦©e
(+
´evMou£X
, +
´evMou£Y
);

339 
´evT¿nsfÜm
 =…»vT¿nsfÜm.
	`sÿË
(1.0/
´evZoomLev–
,

340 1.0/
´evZoomLev–
);

341 
´evT¿nsfÜm
 =…»vT¿nsfÜm.
	`Œª¦©e
(-
´evMou£X
, -
´evMou£Y
);

343 
QReùF
 
»®Mou£CoÜds
 = 
´evT¿nsfÜm
.
	`m­Reù
(

344 
	`QReùF
(
mou£X
, 
mou£Y
, 0, 0));

345 
mou£X
 = 
»®Mou£CoÜds
.
	`Ëá
();

346 
mou£Y
 = 
»®Mou£CoÜds
.
	`tİ
();

348 
QT¿nsfÜm
 
ŒªsfÜm
;

349 
ŒªsfÜm
 =¿nsfÜm.
	`Œª¦©e
(+
mou£X
, +
mou£Y
);

350 
ŒªsfÜm
 =¿nsfÜm.
	`sÿË
(1.0/
zoomLev–
, 1.0/zoomLevel);

351 
ŒªsfÜm
 =¿nsfÜm.
	`Œª¦©e
(-
mou£X
, -
mou£Y
);

352 
imagePixm­
 = 
	`QPixm­
(
QPixm­
::
	`äomImage
(

353 
Ï¡R’d”šg
.
	`sÿËd
(
IMAGE_COLS
, 
IMAGE_ROWS
)));

354 
QPaš‹r
 
	`·š‹r
(&
Ï¡R’d”šg
);

355 
QReùF
 
bound
 = 
ŒªsfÜm
.
	`m­Reù
(
	`QReùF
(0, 0, 
IMAGE_COLS
, 
IMAGE_ROWS
));

357 
·š‹r
.
	`d¿wImage
(
	`QReùF
(0, 0, 
IMAGE_COLS
, 
IMAGE_ROWS
),

358 
imagePixm­
.
	`toImage
(), 
bound
);

360 
´evZoomLev–
 = 
zoomLev–
;

361 
´evMou£X
 = 
mou£X
;

362 
´evMou£Y
 = 
mou£Y
;

366 
imagePixm­
 = 
	`QPixm­
(
IMAGE_COLS
, 
IMAGE_ROWS
);

367 
imagePixm­
.
	`fl
(
Qt
::
d¬kG¿y
);

370 
imagePixm­
 = 
QPixm­
::
	`äomImage
(
Ï¡R’d”šg
.
	`sÿËd
(
BOT_IMAGE_COLS
,

371 
BOT_IMAGE_ROWS
));

372 
ÿmLab–
->
	`£tPixm­
(
imagePixm­
);

373 
	}
}

377 
	gVisiÚTab
::
	$d¿wImage
(
QImage
 *
image
, 
boŞ
 
tİ
) {

378 
R
 = (
tİ
è? 
TOP_IMAGE_ROWS
 : 
BOT_IMAGE_ROWS
;

379 
C
 = (
tİ
è? 
TOP_IMAGE_COLS
 : 
BOT_IMAGE_COLS
;

380 
row
 = 0;„ow < 
R
; ++row) {

381 
cŞ
 = 0; cŞ < 
C
; ++col) {

382 ià(
tİ
) {

383 
image
->
	`£tPix–
(
cŞ
, 
row
, 
	`g‘RGB
(cŞ,„ow, 
tİF¿me
, 
C
));

385 
image
->
	`£tPix–
(
cŞ
, 
row
, 
	`g‘RGB
(cŞ,„ow, 
bÙF¿me
, 
C
));

389 
	}
}

391 
	gVisiÚTab
::
	$d¿wS®›ncy
 (
QImage
 *
image
, 
boŞ
 
tİ
)

393 ià(
tİ
) {

448 
	}
}

450 
	gVisiÚTab
::
	$d¿wS®›ncyFov—
(
QImage
 *
image
, cÚ¡ 
Fov—
 &
fov—
)

467 
	}
}

469 
	gVisiÚTab
::
	$d¿wS®›ncyG»y
 (
QImage
 *
image
, 
boŞ
 
tİ
)

511 
	}
}

514 
	gVisiÚTab
::
	$d¿wS®›ncyEdge
 (
QImage
 *
image
, 
boŞ
 
tİ
)

556 
	}
}

558 
	gVisiÚTab
::
	$d¿wS®›ncyEdgeFov—
(
QImage
 *
image
, cÚ¡ 
Fov—
 &
fov—
)

609 
	}
}

611 
	gVisiÚTab
::
	$d¿wEdgeDœeùiÚs
 (
QImage
 *
image
, 
boŞ
 
tİ
)

662 
	}
}

665 
	gVisiÚTab
::
	$d¿wOv”Ïys
(
QImage
 *
image
, 
boŞ
 
tİ
) {

870 
	}
}

874 
	gVisiÚTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
)

906 
	}
}

909 
VisiÚTab
::
	$»d¿wSlÙ
() {

910 
	`»d¿w
();

911 
	}
}

913 
boŞ
 
	gVisiÚTab
::
	$ev’tF‹r
(
QObjeù
 *
objeù
, 
QEv’t
 *
ev’t
) {

914 ià((
objeù
 =ğ
ÿmLab–
è&& (
ev’t
->
	`ty³
(è=ğ
QEv’t
::
Mou£Bu‰ÚP»ss
)) {

915  
	`şassifyMou£Ev’t
(
¡©ic_ÿ¡
<
QMou£Ev’t
*>(
ev’t
));

916 } ià((
objeù
 =ğ
ÿmLab–
è&& (
ev’t
->
	`ty³
(è=ğ
QEv’t
::
Wh“l
)) {

917  
	`şassifyWh“lEv’t
(
¡©ic_ÿ¡
<
QWh“lEv’t
*>(
ev’t
));

919  
çl£
;

921 
	}
}

923 
boŞ
 
	gVisiÚTab
::
	$şassifyMou£Ev’t
(
QMou£Ev’t
 *
e
) {

924 ià(
e
->
	`bu‰Ú
(è=ğ
Qt
::
RightBu‰Ú
) {

925 
QSŒšg
 
feName
 = 
QFeDŸlog
::
	`g‘SaveFeName
(
this
, "Save image");

926 ià(
feName
 != "") {

927 
Ï¡R’d”šg
.
	`§ve
(
feName
);

930  
Œue
;

931 
	}
}

933 
boŞ
 
	gVisiÚTab
::
	$şassifyWh“lEv’t
(
QWh“lEv’t
 *
e
) {

934 
boŞ
 
tİ
 = !
checkBÙtomImage
->
	`isChecked
();

935 
ŞdZoomLog
 = 
zoomLog
;

936 
zoomLog
 +ğ
e
->
	`d–
()/100;

938 ià(
zoomLog
 < 0) zoomLog = 0;

940 ià(
zoomLog
 > 
ZOOM_LIMIT
) zoomLog = ZOOM_LIMIT;

942 
zoomLev–
 = 1u<<
zoomLog
;

944 
mou£X
 = 
e
->
	`x
();

945 
mou£Y
 = 
e
->
	`y
();

947 ià(
tİ
) {

948 
mou£X
*=2;

949 
mou£Y
*=2;

952 ià(
zoomLog
 !ğ
ŞdZoomLog
è
	`»d¿w
();

953  
Œue
;

954 
	}
}

	@utils/offnao/tabs/visionTab.hpp

32 #´agm¨
Úû


34 
	~<QM’uB¬
>

35 
	~<QWidg‘
>

36 
	~<QObjeù
>

37 
	~<QEv’t
>

38 
	~<QGridLayout
>

39 
	~<QGroupBox
>

40 
	~<QVBoxLayout
>

41 
	~<QLab–
>

42 
	~<QCheckBox
>

43 
	~<QRadioBu‰Ú
>

44 
	~<QPushBu‰Ú
>

45 
	~<QTabWidg‘
>

46 
	~<c¡dio
>

47 
	~"bs/b.hµ
"

48 
	~"medŸPª–.hµ
"

50 
şass
 
	gFov—
;

56 şas 
	cVisiÚTab
 : 
public
 
Tab
 {

57 
Q_OBJECT


58 
public
:

59 
VisiÚTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

61 
lßdNnmcFe
(
WhichCam”a
 
ÿm
, cÚ¡ *
f
);

63 
	m´iv©e
:

64 
š™
();

65 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

68 cÚ¡ 
	mZOOM_LIMIT
 = 6;

69 
	mzoomLev–
, 
	mzoomLog
;

70 
	mmou£X
, 
	mmou£Y
;

71 
	m´evMou£X
, 
	m´evMou£Y
, 
	m´evZoomLev–
;

74 
QM’u
 *
	mvisiÚM’u
;

84 
QPixm­
 
	mimagePixm­
;

85 
QLab–
 *
	mÿmLab–
;

87 
QGridLayout
 *
	mÏyout
;

90 
QRadioBu‰Ú
 *
	m¿dioImage
;

91 
QRadioBu‰Ú
 *
	m¿dioS®›ncy
;

92 
QRadioBu‰Ú
 *
	m¿dioS®›ncyEdge
;

93 
QRadioBu‰Ú
 *
	m¿dioS®›ncyG»y
;

96 
QCheckBox
 *
	mcheckBÙtomImage
;

97 
QCheckBox
 *
	mcheckEdgeDœeùiÚs
;

98 
QCheckBox
 *
	mcheckEdgeOr›Á©iÚs
;

99 
QCheckBox
 *
	mcheckP©ches
;

100 
QCheckBox
 *
	mcheckLowLšes
;

102 
QCheckBox
 *
	mcheckHÜizÚ
;

103 
QCheckBox
 *
	mcheckB®l
;

104 
QCheckBox
 *
	mcheckF“t
;

105 
QCheckBox
 *
	mcheckF“tDebug
;

106 
QCheckBox
 *
	mcheckGßls
;

107 
QCheckBox
 *
	mcheckRobÙs
;

108 
QCheckBox
 *
	mcheckRobÙsDebug
;

109 
QCheckBox
 *
	mcheckF›ldEdges
;

110 
QCheckBox
 *
	mcheckF›ldF—tu»s
;

112 
QImage
 
	mÏ¡R’d”šg
;

115 
»d¿w
();

118 
d¿wImage
 (
QImage
 *
image
, 
boŞ
 
tİ
 = 
Œue
);

119 
d¿wS®›ncy
 (
QImage
 *
image
, 
boŞ
 
tİ
 = 
Œue
);

120 
d¿wS®›ncyFov—
 (
QImage
 *
image
, cÚ¡ 
Fov—
 &
fov—
);

122 
d¿wS®›ncyEdge
 (
QImage
 *
image
, 
boŞ
 
tİ
 = 
Œue
);

123 
d¿wS®›ncyEdgeFov—
(
QImage
 *
image
, cÚ¡ 
Fov—
 &
fov—
);

125 
d¿wS®›ncyG»y
 (
QImage
 *
image
, 
boŞ
 
tİ
 = 
Œue
);

126 
d¿wEdgeDœeùiÚs
 (
QImage
 *
image
, 
boŞ
 
tİ
 = 
Œue
);

129 
d¿wOv”Ïys
(
QImage
 *
image
, 
boŞ
 
tİ
);

133 
mou£MoveEv’t
(
QMou£Ev’t
 * 
ev’t
);

135 
QPošt
 
	mmou£Pos™iÚ
;

137 
boŞ
 
ev’tF‹r
(
QObjeù
 *
objeù
, 
QEv’t
 *
ev’t
);

139 
boŞ
 
şassifyMou£Ev’t
(
QMou£Ev’t
 *
e
);

140 
boŞ
 
şassifyWh“lEv’t
(
QWh“lEv’t
 *
e
);

142 
boŞ
 
	mÂmc_lßded
;

145 
public
 
	m¦Ùs
:

146 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

156 
»d¿wSlÙ
();

	@utils/offnao/tabs/walkTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QDebug
>

35 
	~<QSŒšg
>

37 
	~<io¡»am
>

38 
	~<s¡»am
>

39 
	~"w®kTab.hµ
"

40 
	~"uts/basic_m©hs.hµ
"

41 
	~"uts/body.hµ
"

42 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

43 
	~"mÙiÚ/g’”©Ü/P’dulumMod–.hµ
"

44 
	~"mÙiÚ/touch/F‹»dTouch.hµ
"

45 
	~"bÏckbßrd/BÏckbßrd.hµ
"

46 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

48 
usšg
 
Çme¥aû
 
	g¡d
;

50 
	#X_LEN
 30

	)

51 
	#Y_LEN
 100

	)

52 cÚ¡ 
	gW®kTab
::
numEÁr›s
 = 5;

54 #ià
QWT_VERSION
 >= 0x060000

55 
	#£tRawD©a
 
£tRawSam¶es


	)

58 
	gW®kTab
::
	$W®kTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
,

59 
VisiÚ
 *
visiÚ
) {

60 
	`š™M’u
(
m’uB¬
);

61 
this
->
visiÚ
 = vision;

62 
this
->
·»Á
 =…arent;

63 
Ï¡Cu¼’t
 = 0;

64 
bodyPlÙ
[0] = 
Ãw
 
	`QwtPlÙ
(
	`QSŒšg
("X - Th‘¨&& dTh‘a"), 
·»Á
);

65 
bodyPlÙ
[1] = 
Ãw
 
	`QwtPlÙ
(
	`QSŒšg
("Y - Th‘¨&& dTh‘a"), 
·»Á
);

66 cÚ¡ 
QSŒšg
 
	`t™Ë
("Graph 1");

68 (
bodyPlÙ
[0])->
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, -
X_LEN
/2, X_LEN/2);

69 (
bodyPlÙ
[0])->
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -
Y_LEN
/2, Y_LEN/2);

70 (
bodyPlÙ
[1])->
	`£tAxisSÿË
(
QwtPlÙ
::
xBÙtom
, -
X_LEN
/2, X_LEN/2);

71 (
bodyPlÙ
[1])->
	`£tAxisSÿË
(
QwtPlÙ
::
yLeá
, -
Y_LEN
/2, Y_LEN/2);

74 
axis
[0][0] = 
Ãw
 
	`QwtPlÙCurve
("XaxisTheta");

75 (
axis
[0][0])->
	`©ch
(
bodyPlÙ
[0]);

76 (
axis
[0][0])->
	`£tP’
(
	`QP’
(
Qt
::
bÏck
));

77 
axis
[0][1] = 
Ãw
 
	`QwtPlÙCurve
("XaxisdTheta");

78 (
axis
[0][1])->
	`©ch
(
bodyPlÙ
[0]);

79 (
axis
[0][1])->
	`£tP’
(
	`QP’
(
Qt
::
bÏck
));

81 
axis
[1][0] = 
Ãw
 
	`QwtPlÙCurve
("YaxisTheta");

82 (
axis
[1][0])->
	`©ch
(
bodyPlÙ
[1]);

83 (
axis
[1][0])->
	`£tP’
(
	`QP’
(
Qt
::
bÏck
));

84 
axis
[1][1] = 
Ãw
 
	`QwtPlÙCurve
("YaxisdTheta");

85 (
axis
[1][1])->
	`©ch
(
bodyPlÙ
[1]);

86 (
axis
[1][1])->
	`£tP’
(
	`QP’
(
Qt
::
bÏck
));

88 
curve
[0] = 
Ãw
 
	`QwtPlÙCurve
("xData");

89 (
curve
[0])->
	`©ch
(
bodyPlÙ
[0]);

90 (
curve
[0])->
	`£tP’
(
	`QP’
(
Qt
::
»d
));

91 
curve
[1] = 
Ãw
 
	`QwtPlÙCurve
("yData");

92 (
curve
[1])->
	`©ch
(
bodyPlÙ
[1]);

93 (
curve
[1])->
	`£tP’
(
	`QP’
(
Qt
::
»d
));

95 
	`š™
();

96 
	}
}

98 
	gW®kTab
::
	$š™M’u
(
QM’uB¬
 *) {

99 
	}
}

101 
W®kTab
::
	$š™
() {

102 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

103 
	`£tLayout
(
Ïyout
);

104 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

105 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

106 
Ïyout
->
	`£tV”tiÿlS·cšg
(5);

108 
Ïyout
->
	`addWidg‘
(
bodyPlÙ
[0], 0, 0);

109 
Ïyout
->
	`addWidg‘
(
bodyPlÙ
[1], 0, 1);

110 
i
 = 0; i < 100; i++){

111 
lše
[
i
] = i - 50;

112 
z”o
[
i
] = 0;

115 
i
 = 0; i < 2; i++){

116 (
axis
[
i
][0])->
	`£tRawD©a
(
lše
, 
z”o
, 100);

117 (
axis
[
i
][1])->
	`£tRawD©a
(
z”o
, 
lše
, 100);

120 
	}
}

122 
	gW®kTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

123 
BÏckbßrd
 *
bÏckbßrd
;

124 ià(
ÇoD©a
 && (
bÏckbßrd
 =‚aoD©a->
	`g‘Cu¼’tF¿me
().blackboard)) {

126 
S’sÜV®ues
 
s
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
);

127 
th‘a
[0].
	`push_back
(
	`RAD2DEG
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËX
]));

128 
th‘a
[1].
	`push_back
(
	`RAD2DEG
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_AngËY
]));

129 
dTh‘a
[0].
	`push_back
(
	`RAD2DEG
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrX
]));

130 
dTh‘a
[1].
	`push_back
(
	`RAD2DEG
(
s
.
£nsÜs
[
S’sÜs
::
IÃ¹ŸlS’sÜ_GyrY
]));

131 ià(
th‘a
[0].
	`size
(è> 
numEÁr›s
) {

132 
th‘a
[0].
	`pİ_äÚt
();

133 
th‘a
[1].
	`pİ_äÚt
();

134 
dTh‘a
[0].
	`pİ_äÚt
();

135 
dTh‘a
[1].
	`pİ_äÚt
();

138 
i
 = 0; i < 2; i++){

139 
¡d
::
li¡
<>::
™”©Ü
 
™”
 = 
th‘a
[
i
].
	`begš
();

140 
j
 = 0;

141 
™”
 !ğ
th‘a
[
i
].
	`’d
()) {

142 
©h‘a
[
i
][
j
] = *
™”
;

143 ++
™”
;

144 
j
++;

147 
™”
 = 
dTh‘a
[
i
].
	`begš
();

148 
j
 = 0;

149 
™”
 !ğ
dTh‘a
[
i
].
	`’d
()) {

150 
aDTh‘a
[
i
][
j
] = *
™”
;

151 ++
™”
;

152 
j
++;

156 (
curve
[0])->
	`£tRawD©a
(
©h‘a
[0], 
aDTh‘a
[0], 
th‘a
[0].
	`size
());

157 (
curve
[1])->
	`£tRawD©a
(
©h‘a
[1], 
aDTh‘a
[1], 
th‘a
[1].
	`size
());

159 
bodyPlÙ
[0]->
	`»¶Ù
();

160 
bodyPlÙ
[1]->
	`»¶Ù
();

162 
	}
}

164 
	gW®kTab
::
	$»ad”Clo£d
() {

165 
	}
}

	@utils/offnao/tabs/walkTab.hpp

32 #´agm¨
Úû


33 
	~<qwt_·š‹r.h
>

34 
	~<qwt_¶Ù_ÿnvas.h
>

35 
	~<qwt_¶Ù_m¬k”.h
>

36 
	~<qwt_¶Ù_curve.h
>

37 
	~<qwt_sÿË_widg‘.h
>

38 
	~<qwt_Ëg’d.h
>

39 
	~<qwt_sÿË_d¿w.h
>

41 
	~<QTabWidg‘
>

43 
	~<QM’uB¬
>

44 
	~<QWidg‘
>

45 
	~<QObjeù
>

46 
	~<QEv’t
>

47 
	~<QGridLayout
>

48 
	~<QPixm­
>

49 
	~<QLab–
>

50 
	~<QPaš‹r
>

51 
	~<QCŞÜ
>

52 
	~<QT»eWidg‘I‹m
>

53 
	~<QT»eWidg‘
>

54 
	~<QLab–
>

55 
	~<li¡
>

57 
	~<c¡dio
>

58 
	~<deque
>

59 
	~<QPaš‹r
>

61 
	~"bs/b.hµ
"

62 
	~"bs/v¬ŸbËV›w.hµ
"

63 
	~"bs/¶Ùs.hµ
"

64 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

65 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

66 
	~"uts/Logg”.hµ
"

67 
	~"f›ldV›w.hµ
"

68 
	~"medŸPª–.hµ
"

71 şas 
	cW®kTab
 : 
public
 
Tab
 {

72 
Q_OBJECT


73 
public
:

74 
W®kTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

75 
	m´iv©e
:

76 
š™
();

77 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

78 
QGridLayout
 *
	mÏyout
;

79 
QwtPlÙ
 *
	mbodyPlÙ
[2];

80 
QwtPlÙCurve
 *
	mcurve
[2];

81 
QwtPlÙCurve
 *
	maxis
[2][2];

82 
	m¡d
::
li¡
<> 
th‘a
[2], 
	mdTh‘a
[2];

83 
	mÏ¡Cu¼’t
;

84 cÚ¡ 
	mnumEÁr›s
;

85 
	m©h‘a
[2][5], 
	maDTh‘a
[2][5];

86 
	mz”o
[100], 
	mlše
[100];

88 
public
 
	m¦Ùs
:

89 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

90 
»ad”Clo£d
();

	@utils/offnao/tabs/yuvHistogram.cpp

32 
	~<as£¹.h
>

33 
	~<lim™s.h
>

34 
	~<m©h.h
>

35 
	~<QPaš‹r
>

37 
	~"yuvHi¡og¿m.hµ
"

38 
	~"şassif›r.hµ
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

43 
	gYUVHi¡og¿m
::
	$YUVHi¡og¿m
(
mšimum
, 
maximum
) {

44 
äom
 = 
mšimum
;

45 
to
 = 
maximum
;

46 
numb”OfI‹ms
 = 0;

48 
numb”OfBuck‘s
 = 
maximum
 - 
mšimum
 + 1;

49 
äequ’cy
.
	`»size
(
numb”OfBuck‘s
);

51 
mšCouÁ
 = 
UINT_MAX
;

52 
maxCouÁ
 = 0U;

53 
mšV®ue
 = 
to
;

54 
maxV®ue
 = 
äom
;

56 
v®uesV®id
 = 
Œue
;

57 
mšCouÁV®id
 = 
çl£
;

58 
m—nV®id
 = 
çl£
;

59 
¡devV®id
 = 
çl£
;

60 
’ŒİyV®id
 = 
çl£
;

61 
maxEÁrİyV®id
 = 
çl£
;

62 
	}
}

65 
	gYUVHi¡og¿m
::
	$YUVHi¡og¿m
(
mšimum
, 
maximum
, 
buck‘s
) {

66 
äom
 = 
mšimum
;

67 
to
 = 
maximum
;

68 
numb”OfI‹ms
 = 0;

69 
numb”OfBuck‘s
 = 
buck‘s
;

71 
äequ’cy
.
	`»size
(
numb”OfBuck‘s
);

73 
mšCouÁ
 = 
UINT_MAX
;

74 
maxCouÁ
 = 0U;

75 
mšV®ue
 = 
to
;

76 
maxV®ue
 = 
äom
;

78 
v®uesV®id
 = 
Œue
;

79 
mšCouÁV®id
 = 
çl£
;

80 
m—nV®id
 = 
çl£
;

81 
¡devV®id
 = 
çl£
;

82 
’ŒİyV®id
 = 
çl£
;

83 
maxEÁrİyV®id
 = 
çl£
;

84 
	}
}

87 
	gYUVHi¡og¿m
::
	$addD©­ošt
(
™em
) {

88 
	`as£¹
(
™em
 >ğ
äom
 && i‹m <ğ
to
);

90 ià(
™em
 >ğ
äom
 && i‹m <ğ
to
) {

91 ià(
™em
 > 
äequ’cy
.
	`size
()) {

92 
äequ’cy
.
	`»size
(
™em
);

94 
äequ’cy
[
™em
]++;

95 
numb”OfI‹ms
++;

97 
û¼
 << "YUVHi¡og¿m::addD©­ošt(): " << 
™em
 << " out of„ange\n";

102 ià(
v®uesV®id
) {

103 ià(
maxCouÁ
 < 
äequ’cy
[
™em
]) {

104 
maxCouÁ
 = 
äequ’cy
[
™em
];

106 ià(
äequ’cy
[
™em
] > 0 && i‹m < 
mšV®ue
) {

107 
mšV®ue
 = 
™em
;

109 ià(
äequ’cy
[
™em
] > 0 && i‹m > 
maxV®ue
) {

110 
maxV®ue
 = 
™em
;

113 
	}
}

116 
	gYUVHi¡og¿m
::
	$d–‘eD©­ošt
(
™em
) {

117 
	`as£¹
(
™em
 >ğ
äom
 && i‹m <ğ
to
);

118 
	`as£¹
(
äequ’cy
[
™em
] > 0);

120 
äequ’cy
[
™em
]--;

122 
v®uesV®id
 = 
çl£
;

123 
mšCouÁV®id
 = 
çl£
;

124 
m—nV®id
 = 
çl£
;

125 
¡devV®id
 = 
çl£
;

126 
’ŒİyV®id
 = 
çl£
;

127 
maxEÁrİyV®id
 = 
çl£
;

128 
	}
}

131 
	gYUVHi¡og¿m
::
	$g‘Mšimum
() {

132  
äom
;

133 
	}
}

136 
	gYUVHi¡og¿m
::
	$g‘Maximum
() {

137  
to
;

138 
	}
}

141 
	gYUVHi¡og¿m
::
	$g‘Numb”OfI‹ms
() {

142  
numb”OfI‹ms
;

143 
	}
}

146 
	gYUVHi¡og¿m
::
	$g‘MšCouÁ
() {

147 ià(!
mšCouÁV®id
) {

148 
mšCouÁ
 = 
UINT_MAX
;

150 
veùÜ
<>::
cÚ¡_™”©Ü
 
™em
 = 
äequ’cy
.
	`begš
(); i‹m !ğäequ’cy.
	`’d
(); ++item) {

151 ià(
mšCouÁ
 > *
™em
 && *item != 0) {

152 
mšCouÁ
 = *
™em
;

155 
mšCouÁV®id
 = 
Œue
;

158  
mšCouÁ
;

159 
	}
}

162 
	gYUVHi¡og¿m
::
	$g‘MaxCouÁ
() {

163 ià(!
v®uesV®id
) {

165 
maxCouÁ
 = 0U;

167 
veùÜ
<>::
cÚ¡_™”©Ü
 
™em
 = 
äequ’cy
.
	`begš
(); i‹m !ğäequ’cy.
	`’d
(); ++item) {

168 ià(
maxCouÁ
 < *
™em
) {

169 
maxCouÁ
 = *
™em
;

172 
v®uesV®id
 = 
Œue
;

175  
maxCouÁ
;

176 
	}
}

179 
	gYUVHi¡og¿m
::
	$g‘MšV®ue
() {

180 ià(!
v®uesV®id
) {

182 
mšV®ue
 = 
to
;

184 
i
 = 0; i < 
äequ’cy
.
	`size
(); ++i) {

185 ià(
äequ’cy
[
i
] > 0 && i < 
mšV®ue
) {

186 
mšV®ue
 = 
i
;

189 
v®uesV®id
 = 
Œue
;

192  
mšV®ue
;

193 
	}
}

196 
	gYUVHi¡og¿m
::
	$g‘MaxV®ue
() {

197 ià(!
v®uesV®id
) {

199 
maxV®ue
 = 
äom
;

201 
i
 = 0; i < 
äequ’cy
.
	`size
(); ++i) {

202 ià(
äequ’cy
[
i
] > 0 && i > 
maxV®ue
) {

203 
maxV®ue
 = 
i
;

206 
v®uesV®id
 = 
Œue
;

209  
maxV®ue
;

210 
	}
}

213 
	gYUVHi¡og¿m
::
	$g‘M—nV®ue
() {

214 ià(!
m—nV®id
) {

215 
m—nV®ue
 = 0.0;

217 
i
 = 0; i < 
äequ’cy
.
	`size
(); ++i) {

218 ià(
äequ’cy
[
i
] > 0) {

220 
m—nV®ue
 +ğ()
äequ’cy
[
i
]/()
numb”OfI‹ms
 * ()i;

223 
m—nV®id
 = 
Œue
;

226  
m—nV®ue
;

227 
	}
}

230 
	gYUVHi¡og¿m
::
	$g‘StdevV®ue
() {

231 ià(!
¡devV®id
) {

232 
¡devV®ue
 = 0.0;

234 
	`g‘M—nV®ue
();

235 
i
 = 0; i < 
äequ’cy
.
	`size
(); ++i) {

236 ià(
äequ’cy
[
i
] > 0) {

237 
¡devV®ue
 +ğ(((()
i
 - 
m—nV®ue
è* (()˜- m—nV®ue))/()
numb”OfI‹ms
è* ()
äequ’cy
[i];

240 
¡devV®ue
 = 
	`sq¹
(stdevValue);

241 
¡devV®id
 = 
Œue
;

244  
¡devV®ue
;

245 
	}
}

248 
	gYUVHi¡og¿m
::
	$g‘EÁrİyV®ue
() {

249 ià(!
’ŒİyV®id
) {

250 
’ŒİyV®ue
 = 0.0;

252 
i
 = 0; i < 
äequ’cy
.
	`size
(); ++i) {

253 ià(
äequ’cy
[
i
] > 0) {

254 
’ŒİyV®ue
 -ğ(()
äequ’cy
[
i
]/
numb”OfI‹ms
è* 
	`log
(()frequency[i]/numberOfItems);

257 
’ŒİyV®id
 = 
Œue
;

260  
’ŒİyV®ue
;

261 
	}
}

264 
	gYUVHi¡og¿m
::
	$g‘MaxEÁrİyV®ue
() {

265 ià(!
maxEÁrİyV®id
) {

266 
maxEÁrİyV®ue
 = 0.0;

268 
i
 = 0; i < 
to
 + 1; i++) {

269 
maxEÁrİyV®ue
 -ğ(1.0/(
to
 + 1)è* 
	`log
(1.0/(to + 1));

271 
maxEÁrİyV®id
 = 
Œue
;

274  
maxEÁrİyV®ue
;

275 
	}
}

278 
	gYUVHi¡og¿m
::
	$d¿wHi¡og¿m
(
QPixm­
 &
imagePixm­
, 
width
, 
height
, 
ImageTy³
 
cŞour
) {

279 
buck‘Size
 = 
	`û
((
to
 - 
äom
 + 1)/()
width
);

280 
couÁ
 = 0U;

281 
äeq
[
width
];

284 
QPaš‹r
 
	`imagePaš‹r
(&
imagePixm­
);

285 
imagePaš‹r
.
	`£tP’
(
Qt
::
bÏck
);

286 
imagePaš‹r
.
	`£tBrush
(
Qt
::
SŞidP©‹º
);

288 
imagePaš‹r
.
	`£tR’d”Hšt
(
QPaš‹r
::
AÁŸlŸsšg
, 
Œue
);

291 
cŞ
 = 0U; cŞ < 
width
 && (cŞ * 
buck‘Size
è<ğ
to
; ++col) {

292 
äeq
[
cŞ
] = 0U;

294 
buck‘
 = 0U; buck‘ < 
buck‘Size
 && ((
cŞ
 * buck‘Sizeè+ buck‘è<ğ
to
; bucket++) {

295 
äeq
[
cŞ
] +ğ
äequ’cy
[(cŞ * 
buck‘Size
è+ 
buck‘
];

297 ià(
äeq
[
cŞ
] > 
couÁ
) {

298 
couÁ
 = 
äeq
[
cŞ
];

303 
cŞ
;

304 
cŞ
 = 0U; cŞ < 
width
 && (cŞ * 
buck‘Size
è<ğ
to
; ++col) {

305 ià(
äeq
[
cŞ
] > 0) {

307 
cŞourV®ue
 = (
cŞ
 * 
buck‘Size
) + bucketSize/2;

313 
cŞour
) {

314 
eRGB
:

315 
imagePaš‹r
.
	`£tP’
(
	`QCŞÜ
((
cŞourV®ue
 & 0x00ff0000) >> 16,

316 (
cŞourV®ue
 & 0x0000ff00) >> 8,

317 (
cŞourV®ue
 & 0x000000ff)));

319 
eYUV
:

320 
cŞourV®ue
 = 
CÏssif›r
::
	`yuv2rgb
((colourValue & 0x00ff0000) >> 16,

321 (
cŞourV®ue
 & 0x0000ff00) >> 8,

322 (
cŞourV®ue
 & 0x000000ff));

323 
imagePaš‹r
.
	`£tP’
(
	`QCŞÜ
((
cŞourV®ue
 & 0x00ff0000) >> 16,

324 (
cŞourV®ue
 & 0x0000ff00) >> 8,

325 (
cŞourV®ue
 & 0x000000ff)));

327 
eRED
:

328 
imagePaš‹r
.
	`£tP’
(
	`QCŞÜ
(
cŞourV®ue
, 0, 0));

330 
eGREEN
:

331 
imagePaš‹r
.
	`£tP’
(
	`QCŞÜ
(0, 
cŞourV®ue
, 0));

333 
eBLUE
:

334 
imagePaš‹r
.
	`£tP’
(
	`QCŞÜ
(0, 0, 
cŞourV®ue
));

336 
eHSV
:

337 
eBW
:

342 
imagePaš‹r
.
	`d¿wLše
(
	`QPošt
(
cŞ
, 
height
 - 1),

343 
	`QPošt
(
cŞ
, (
height
 - 1è- (()
äeq
[cŞ]/()
couÁ
*height)));

348 
imagePaš‹r
.
	`£tP’
(
Qt
::
lightG¿y
);

349 ; 
cŞ
 < 
width
; ++col) {

350 
imagePaš‹r
.
	`d¿wLše
(
	`QPošt
(
cŞ
, 
height
 - 1), QPoint(col, 0));

352 
	}
}

355 
	gYUVHi¡og¿m
::
	$´štSti¡ics
(
o¡ršg¡»am
 &
o¡
) {

357 
o¡
 << "STATISTICS\n";

358 
o¡
 << 
dec
 << " Numb” oàI‹m =\t" << ()
	`g‘Numb”OfI‹ms
() << "\n";

359 
o¡
 << 
hex
 << " Mš V®u=\t0x" << 
	`g‘MšV®ue
(è<< "\t/\t0x" << 
	`g‘Maximum
() << "\t (" << getMinValue()/getMaximum() * 100.0 << "%)\n";

360 
o¡
 << 
hex
 << " Max V®u=\t0x" << 
	`g‘MaxV®ue
(è<< "\t/\t0x" << 
	`g‘Maximum
() << "\t (" << getMaxValue()/getMaximum() * 100.0 << "%)\n";

361 
o¡
 << 
dec
 << " Mš CouÁ =\t" << 
	`g‘MšCouÁ
(è<< "\t/\t" << 
	`g‘Numb”OfI‹ms
() << "\t (" << ()getMinCount()/getNumberOfItems() * 100.0 << "%)\n";

362 
o¡
 << 
dec
 << " Max CouÁ =\t" << 
	`g‘MaxCouÁ
(è<< "\t/\t" << 
	`g‘Numb”OfI‹ms
() << "\t (" << ()getMaxCount()/getNumberOfItems() * 100.0 << "%)\n";

363 
o¡
 << 
hex
 << " Avg V®u=\t0x" << ()
	`g‘M—nV®ue
(è<< "\t/\t0x" << 
	`g‘Maximum
() << "\t (" << getMeanValue()/getMaximum() * 100.0 << "%)\n";

364 
o¡
 << 
dec
 << " Stdev =\t" << 
	`g‘StdevV®ue
(è<< "\t/\t" << 
	`g‘Maximum
() << "\t (" << getStdevValue()/getMaximum()*100.0 << "%)\n";

365 
o¡
 << 
dec
 << " EÁrİy =\t" << 
	`g‘EÁrİyV®ue
(è<< "\t/\t" << 
	`g‘MaxEÁrİyV®ue
() << "\t (" << getEntropyValue()/getMaxEntropyValue() * 100.0 << "%)\n";

367 
	}
}

	@utils/offnao/tabs/yuvHistogram.hpp

32 #´agm¨
Úû


34 
	~<io¡»am
>

35 
	~<s¡»am
>

36 
	~<veùÜ
>

37 
	~<QObjeù
>

43 şas 
	cYUVHi¡og¿m
 {

44 
	m¡d
::
veùÜ
<> 
äequ’cy
;

45 
	mäom
;

46 
	mto
;

47 
	mnumb”OfBuck‘s
;

48 
	mnumb”OfI‹ms
;

50 
	mmšV®ue
;

51 
	mmaxV®ue
;

52 
	mmšCouÁ
;

53 
	mmaxCouÁ
;

54 
g‘ModeV®ue
();

55 
g‘MedŸnV®ue
();

56 
	mm—nV®ue
;

57 
	m¡devV®ue
;

58 
	m’ŒİyV®ue
;

59 
	mmaxEÁrİyV®ue
;

61 
boŞ
 
	mv®uesV®id
;

62 
boŞ
 
	mmšCouÁV®id
;

63 
boŞ
 
	mm—nV®id
;

64 
boŞ
 
	m¡devV®id
;

65 
boŞ
 
	m’ŒİyV®id
;

66 
boŞ
 
	mmaxEÁrİyV®id
;

68 
	mpublic
:

69 
	eImageTy³
 {
eBW
, 
	meRGB
, 
	meYUV
, 
	meHSV
, 
	meRED
, 
	meGREEN
, 
	meBLUE
};

71 
YUVHi¡og¿m
(
mšimum
, 
maximum
);

72 
YUVHi¡og¿m
(
mšimum
, 
maximum
, 
buck‘s
);

74 
addD©­ošt
(
™em
);

75 
d–‘eD©­ošt
(
™em
);

77 
g‘Mšimum
();

78 
g‘Maximum
();

79 
g‘Numb”OfI‹ms
();

80 
g‘MšCouÁ
();

81 
g‘MaxCouÁ
();

82 
g‘MšV®ue
();

83 
g‘MaxV®ue
();

84 
g‘M—nV®ue
();

85 
g‘StdevV®ue
();

86 
g‘EÁrİyV®ue
();

87 
g‘MaxEÁrİyV®ue
();

88 
d¿wHi¡og¿m
(
QPixm­
 &
imagePixm­
, 
width
, 
height
, 
ImageTy³
 
cŞour
 =
eBW
);

89 
´štSti¡ics
(
¡d
::
o¡ršg¡»am
 &
o¡
);

	@utils/offnao/tabs/zmpTab.cpp

32 
	~<QM’u
>

33 
	~<QM’uB¬
>

34 
	~<QDebug
>

36 
	~<io¡»am
>

37 
	~<s¡»am
>

38 
	~"zmpTab.hµ
"

39 
	~"uts/basic_m©hs.hµ
"

40 
	~"uts/body.hµ
"

41 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

42 
	~"bÏckbßrd/BÏckbßrd.hµ
"

43 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

45 
usšg
 
Çme¥aû
 
	g¡d
;

47 
	gZMPTab
::
	$ZMPTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
,

48 
VisiÚ
 *
visiÚ
) {

49 
	`š™M’u
(
m’uB¬
);

50 
	`š™
();

51 
this
->
visiÚ
 = vision;

52 
this
->
·»Á
 =…arent;

53 
	}
}

55 
	gZMPTab
::
	$š™M’u
(
QM’uB¬
 *) {

56 
	}
}

58 
ZMPTab
::
	$š™
() {

59 
Ïyout
 = 
Ãw
 
	`QGridLayout
(
this
);

60 
	`£tLayout
(
Ïyout
);

61 
Ïyout
->
	`£tAlignm’t
Öayout, 
Qt
::
AlignTİ
);

62 
Ïyout
->
	`£tHÜizÚlS·cšg
(5);

63 
Ïyout
->
	`£tV”tiÿlS·cšg
(5);

65 
Ï¡_äame
 = -1;

67 
cÜÚ®_¶Ù
 = (
D©aPlÙ
*è
Ãw
 
	`CÜÚ®ZMPPlÙ
(
this
);

68 
§g™l_¶Ù
 = (
D©aPlÙ
*è
Ãw
 
	`Sag™lZMPPlÙ
(
this
);

69 
com_x_¶Ù
 = (
XYZPlÙ
*è
Ãw
 
	`COMxPlÙ
(
this
);

70 
com_y_¶Ù
 = (
XYZPlÙ
*è
Ãw
 
	`COMyPlÙ
(
this
);

72 
Ïyout
->
	`addWidg‘
(
cÜÚ®_¶Ù
, 0, 0);

73 
Ïyout
->
	`addWidg‘
(
§g™l_¶Ù
, 1, 0);

74 
Ïyout
->
	`addWidg‘
(
com_y_¶Ù
, 0, 1);

75 
Ïyout
->
	`addWidg‘
(
com_x_¶Ù
, 1, 1);

77 
	}
}

79 
	gZMPTab
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

83 ià(!
ÇoD©a
 || !ÇoD©a->
	`g‘Cu¼’tF¿me
().
bÏckbßrd
) {

85 } ià(
ÇoD©a
->
	`g‘F¿mesTÙ®
() != 0) {

86 
Ãw_äame
 = 
ÇoD©a
->
	`g‘Cu¼’tF¿meIndex
();

87 ià(
Ãw_äame
 =ğ
Ï¡_äame
 + 1) {

89 
BÏckbßrd
 *
bÏckbßrd
 = (
ÇoD©a
->
	`g‘Cu¼’tF¿me
().blackboard);

90 
S’sÜV®ues
 
s
 = 
	`»adFrom
(
mÙiÚ
, 
£nsÜs
);

91 
XYZ_CoÜd
 
com
 = 
	`»adFrom
(
mÙiÚ
, com);

92 
cÜÚ®_¶Ù
->
	`push
(
s
);

93 
§g™l_¶Ù
->
	`push
(
s
);

94 
com_x_¶Ù
->
	`push
(
com
);

95 
com_y_¶Ù
->
	`push
(
com
);

96 } ià(
Ãw_äame
 =ğ
Ï¡_äame
 - 1) {

107 } ià(
	`ABS
(
Ãw_äame
 - 
Ï¡_äame
è> 
PLOT_SIZE
) {

109 
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
;

110 
S’sÜV®ues
 
nuÎ
;

111 
¡d
::
veùÜ
<
XYZ_CoÜd
> 
coms
;

112 
XYZ_CoÜd
 
‹mp
;

113 ià(
Ãw_äame
 < 
PLOT_SIZE
 - 1) {

114 
ušt8_t
 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i)

115 
nuÎ
.
£nsÜs
[
i
] = 0.0f;

116 
‹mp
.
x
 = 0;

117 
‹mp
.
y
 = 0;

118 
‹mp
.
z
 = 0;

120 
i
 = 
Ãw_äame
 - 
PLOT_SIZE
 + 1; i <=‚ew_frame; ++i) {

121 ià(
i
 >= 0) {

122 
s
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
£nsÜs
);

123 
coms
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
com
);

125 
s
.
	`push_back
(
nuÎ
);

126 
coms
.
	`push_back
(
‹mp
);

129 
cÜÚ®_¶Ù
->
	`push
(
s
);

130 
§g™l_¶Ù
->
	`push
(
s
);

131 
com_x_¶Ù
->
	`push
(
coms
);

132 
com_y_¶Ù
->
	`push
(
coms
);

133 } ià(
Ãw_äame
 < 
Ï¡_äame
) {

135 
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
;

136 
S’sÜV®ues
 
nuÎ
;

137 
¡d
::
veùÜ
<
XYZ_CoÜd
> 
coms
;

138 
XYZ_CoÜd
 
‹mp
;

139 ià(
Ãw_äame
 < 
PLOT_SIZE
 - 1) {

140 
ušt8_t
 
i
 = 0; i < 
S’sÜs
::
NUMBER_OF_SENSORS
; ++i)

141 
nuÎ
.
£nsÜs
[
i
] = 0.0f;

142 
‹mp
.
x
 = 0;

143 
‹mp
.
y
 = 0;

144 
‹mp
.
z
 = 0;

146 
i
 = 
Ãw_äame
 - 
PLOT_SIZE
 + 1; i <ğ
Ï¡_äame
 - PLOT_SIZE; ++i) {

147 ià(
i
 < 0) {

148 
s
.
	`push_back
(
nuÎ
);

149 
coms
.
	`push_back
(
‹mp
);

151 
s
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
£nsÜs
);

152 
coms
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
com
);

155 
cÜÚ®_¶Ù
->
	`push
(
s
, 
Œue
);

156 
§g™l_¶Ù
->
	`push
(
s
, 
Œue
);

157 
com_x_¶Ù
->
	`push
(
coms
, 
Œue
);

158 
com_y_¶Ù
->
	`push
(
coms
, 
Œue
);

159 } ià(
Ãw_äame
 > 
Ï¡_äame
) {

161 
¡d
::
veùÜ
<
S’sÜV®ues
> 
s
;

162 
¡d
::
veùÜ
<
XYZ_CoÜd
> 
coms
;

163 
i
 = 
Ï¡_äame
 + 1; i <ğ
Ãw_äame
; ++i) {

164 
s
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
£nsÜs
);

165 
coms
.
	`push_back
(
ÇoD©a
->
	`g‘F¿me
(
i
).
bÏckbßrd
->
mÙiÚ
.
com
);

167 
cÜÚ®_¶Ù
->
	`push
(
s
);

168 
§g™l_¶Ù
->
	`push
(
s
);

169 
com_x_¶Ù
->
	`push
(
coms
);

170 
com_y_¶Ù
->
	`push
(
coms
);

172 
Ï¡_äame
 = 
Ãw_äame
;

174 
	}
}

176 
	gZMPTab
::
	$»ad”Clo£d
() {

177 
	}
}

	@utils/offnao/tabs/zmpTab.hpp

32 #´agm¨
Úû


34 
	~<QTabWidg‘
>

36 
	~<QM’uB¬
>

37 
	~<QWidg‘
>

38 
	~<QObjeù
>

39 
	~<QEv’t
>

40 
	~<QGridLayout
>

41 
	~<QPixm­
>

42 
	~<QLab–
>

43 
	~<QPaš‹r
>

44 
	~<QCŞÜ
>

45 
	~<QT»eWidg‘I‹m
>

46 
	~<QT»eWidg‘
>

47 
	~<QLab–
>

49 
	~<c¡dio
>

50 
	~<deque
>

52 
	~"bs/b.hµ
"

53 
	~"bs/v¬ŸbËV›w.hµ
"

54 
	~"bs/¶Ùs.hµ
"

55 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

56 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

57 
	~"uts/Logg”.hµ
"

58 
	~"f›ldV›w.hµ
"

59 
	~"medŸPª–.hµ
"

61 şas 
	cZMPTab
 : 
public
 
Tab
 {

62 
Q_OBJECT


63 
public
:

64 
ZMPTab
(
QTabWidg‘
 *
·»Á
, 
QM’uB¬
 *
m’uB¬
, 
VisiÚ
 *
visiÚ
);

65 
	m´iv©e
:

66 
š™
();

67 
š™M’u
(
QM’uB¬
 *
m’uB¬
);

68 
QGridLayout
 *
	mÏyout
;

69 
D©aPlÙ
* 
	mcÜÚ®_¶Ù
;

70 
D©aPlÙ
* 
	m§g™l_¶Ù
;

71 
XYZPlÙ
* 
	mcom_x_¶Ù
;

72 
XYZPlÙ
* 
	mcom_y_¶Ù
;

73 
XYZPlÙ
* 
	mzmp_x_¶Ù
;

74 
XYZPlÙ
* 
	mzmp_y_¶Ù
;

75 
	mÏ¡_äame
;

76 
public
 
	m¦Ùs
:

77 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

78 
»ad”Clo£d
();

	@utils/offnao/utils/CPlaneColours.cpp

1 
	~"CPÏÃCŞours.hµ
"

3 cÚ¡ 
QCŞÜ
 
	gCPLANE_COLOURS
[] = {

	@utils/offnao/utils/CPlaneColours.hpp

1 #´agm¨
Úû


2 
	~<QCŞÜ
>

4 cÚ¡ 
QCŞÜ
 
CPLANE_COLOURS
[];

	@utils/offnao/utils/FieldObject.hpp

1 #´agm¨
Úû


3 
	~"ty³s/F›ldF—tu»Info.hµ
"

4 
	~"ty³s/Po¡Info.hµ
"

5 
	~"ty³s/AbsCoÜd.hµ
"

7 
	sF›ldObjeù
 {

9 
	mPOST
 = 0,

10 
	mTWOPOSTS
,

11 
	mFEATURE


12 } 
	mty³
;

15 
	mPo¡Info
::
Ty³
 
po¡Ty³
;

16 
	mF›ldF—tu»Info
::
Ty³
 
ã©u»Ty³
;

17 } 
	msubTy³
;

19 
AbsCoÜd
 
	mpos
;

	@utils/offnao/utils/FieldPainter.cpp

1 
	~"F›ldPaš‹r.hµ
"

3 
	~<Eig’/QR
>

4 
	~<¡dšt.h
>

5 
	~"ty³s/Pošt.hµ
"

6 
	~"ty³s/B®lInfo.hµ
"

7 
	~"ty³s/Po¡Info.hµ
"

8 
	~"ty³s/RobÙInfo.hµ
"

9 
	~"ty³s/F›ldBound¬yInfo.hµ
"

10 
	~"ty³s/F›ldF—tu»Info.hµ
"

11 
	~"ty³s/AbsCoÜd.hµ
"

12 
	~"uts/ªgËs.hµ
"

13 
	~"uts/SPLDefs.hµ
"

15 
	gF›ldPaš‹r
::
	$F›ldPaš‹r
 (
QPaštDeviû
 *
deviû
è: 
	$QPaš‹r
 (
deviû
)

18 
deviû_width
 = 
deviû
->
	`width
();

19 
deviû_height
 = 
deviû
->
	`height
();

21 
	`Œª¦©e
(
deviû_width
/2, 
deviû_height
/2);

23 
	`sÿË
(1,-1);

25 
	`sÿË
(()
deviû_width
/
OFFNAO_FULL_FIELD_LENGTH
,

26 ()
deviû_height
/
OFFNAO_FULL_FIELD_WIDTH
);

27 
	}
}

29 
	gF›ldPaš‹r
::~
	$F›ldPaš‹r
 ()

31 
	}
}

33 
F›ldPaš‹r
::
	$d¿wF›ld
() {

35 
QBrush
 
	`no_brush
(
Qt
::
NoBrush
);

36 
QBrush
 
	`gßl_brush
(
Qt
::
y–low
);

38 
QP’
 
	`no_³n
(
Qt
::
NoP’
);

40 
QP’
 
	`f›ld_lše_³n
(
	`QCŞÜ
(255, 255, 255));

41 
f›ld_lše_³n
.
	`£tWidth
(
FIELD_LINE_WIDTH
);

42 
f›ld_lše_³n
.
	`£tJošStyË
(
Qt
::
M™”Još
);

43 
f›ld_lše_³n
.
	`£tM™”Lim™
(0.5);

45 
QP’
 
	`m¬k”_³n
(
	`QCŞÜ
(255, 255, 255));

46 
m¬k”_³n
.
	`£tWidth
(
FIELD_LINE_WIDTH
);

47 
m¬k”_³n
.
	`£tJošStyË
(
Qt
::
M™”Još
);

48 
m¬k”_³n
.
	`£tC­StyË
(
Qt
::
FÏtC­
);

49 
m¬k”_³n
.
	`£tM™”Lim™
(0);

51 
QP’
 
	`üossb¬_³n
(
Qt
::
y–low
);

52 
üossb¬_³n
.
	`£tWidth
(
GOAL_POST_DIAMETER
);

53 
m¬k”_³n
.
	`£tC­StyË
(
Qt
::
FÏtC­
);

54 
üossb¬_³n
.
	`£tM™”Lim™
(0);

56 
QP’
 
	`gßl_suµÜts_³n
(
Qt
::
g¿y
);

57 
gßl_suµÜts_³n
.
	`£tWidth
(
GOAL_SUPPORT_DIAMETER
);

59 
	`§ve
();

61 
	`£tR’d”Hšt
(
QPaš‹r
::
AÁŸlŸsšg
);

63 
	`£tBrush
(
no_brush
);

64 
	`£tP’
(
f›ld_lše_³n
);

66 
	`d¿wReù
(-
FIELD_LENGTH
/2, -
FIELD_WIDTH
/2, FIELD_LENGTH, FIELD_WIDTH);

67 
	`d¿wLše
(0, 
FIELD_WIDTH
/2, 0, -FIELD_WIDTH/2);

68 
	`d¿wReù
(-
FIELD_LENGTH
/2, -
GOAL_BOX_WIDTH
/2, 
GOAL_BOX_LENGTH
, GOAL_BOX_WIDTH);

69 
	`d¿wReù
(
FIELD_LENGTH
/2 - 
GOAL_BOX_LENGTH
, -
GOAL_BOX_WIDTH
/2, GOAL_BOX_LENGTH, GOAL_BOX_WIDTH);

70 
	`d¿wEÎ£
(
	`QPošt
(0, 0), 
CENTER_CIRCLE_DIAMETER
/2, CENTER_CIRCLE_DIAMETER/2);

72 
	`£tBrush
(
no_brush
);

73 
	`£tP’
(
m¬k”_³n
);

75 
	`d¿wLše
(-
MARKER_DIMENSIONS
/2, 0, MARKER_DIMENSIONS/2, 0);

77 
³ÇÉy_x
 = 
FIELD_LENGTH
/2 - 
DIST_GOAL_LINE_TO_MARKER
;

79 
	`d¿wLše
(
³ÇÉy_x
 - 
MARKER_DIMENSIONS
/2, 0,…enalty_x + MARKER_DIMENSIONS/2, 0);

80 
	`d¿wLše
(
³ÇÉy_x
, -
MARKER_DIMENSIONS
/2,…enalty_x, MARKER_DIMENSIONS/2);

82 
	`d¿wLše
(-
³ÇÉy_x
 - 
MARKER_DIMENSIONS
/2, 0, -penalty_x + MARKER_DIMENSIONS/2, 0);

83 
	`d¿wLše
(-
³ÇÉy_x
, -
MARKER_DIMENSIONS
/2, -penalty_x, MARKER_DIMENSIONS/2);

85 
	`£tBrush
(
no_brush
);

86 
	`£tP’
(
gßl_suµÜts_³n
);

88 
gßl_x
 = 
FIELD_LENGTH
/2 + 
FIELD_LINE_WIDTH
/2;

90 
	`d¿wLše
(-
gßl_x
, -
GOAL_WIDTH
/2, -gßl_x - 
GOAL_DEPTH
, -GOAL_WIDTH/2);

91 
	`d¿wLše
(-
gßl_x
, 
GOAL_WIDTH
/2, -gßl_x - 
GOAL_DEPTH
, GOAL_WIDTH/2);

92 
	`d¿wLše
Ğ
gßl_x
, -
GOAL_WIDTH
/2, gßl_x + 
GOAL_DEPTH
, -GOAL_WIDTH/2);

93 
	`d¿wLše
Ğ
gßl_x
, 
GOAL_WIDTH
/2, gßl_x + 
GOAL_DEPTH
, GOAL_WIDTH/2);

94 
	`d¿wLše
Ğ
gßl_x
 + 
GOAL_DEPTH
, -
GOAL_WIDTH
/2, goal_x + GOAL_DEPTH, GOAL_WIDTH/2);

95 
	`d¿wLše
(-
gßl_x
 - 
GOAL_DEPTH
, -
GOAL_WIDTH
/2, -goal_x - GOAL_DEPTH, GOAL_WIDTH/2);

97 
	`£tBrush
(
no_brush
);

98 
	`£tP’
(
üossb¬_³n
);

100 
	`d¿wLše
(-
gßl_x
, -
GOAL_WIDTH
/2, -goal_x, GOAL_WIDTH/2);

101 
	`d¿wLše
Ğ
gßl_x
, -
GOAL_WIDTH
/2, goal_x, GOAL_WIDTH/2);

103 
	`£tBrush
(
gßl_brush
);

104 
	`£tP’
(
no_³n
);

106 
	`d¿wEÎ£
(
	`QPošt
(-
gßl_x
, -
GOAL_WIDTH
/2), 
GOAL_POST_DIAMETER
/2, GOAL_POST_DIAMETER/2);

107 
	`d¿wEÎ£
(
	`QPošt
(-
gßl_x
, 
GOAL_WIDTH
/2), 
GOAL_POST_DIAMETER
/2, GOAL_POST_DIAMETER/2);

108 
	`d¿wEÎ£
(
	`QPošt
Ğ
gßl_x
, -
GOAL_WIDTH
/2), 
GOAL_POST_DIAMETER
/2, GOAL_POST_DIAMETER/2);

109 
	`d¿wEÎ£
(
	`QPošt
Ğ
gßl_x
, 
GOAL_WIDTH
/2), 
GOAL_POST_DIAMETER
/2, GOAL_POST_DIAMETER/2);

111 
	`»¡Üe
();

112 
	}
}

114 
	gF›ldPaš‹r
::
	$Œª¦©eRR
(cÚ¡ 
RRCoÜd
 &
¼
, cÚ¡ 
AbsCoÜd
 &
robÙ
) {

115 
	`Œª¦©e
(
robÙ
.
	`x
(),„obÙ.
	`y
());

116 
	`rÙ©e
((cÚ¡ )
	`RAD2DEG
(
robÙ
.
	`th‘a
()));

117 
	`rÙ©e
((cÚ¡ )
	`RAD2DEG
(
¼
.
	`h—dšg
()));

118 
	`Œª¦©e
(
¼
.
	`di¡ªû
(), 0);

123 ià(!
	`i¢ª
(
¼
.
	`Ü›Á©iÚ
())) {

124 
	`rÙ©e
(
	`RAD2DEG
(-
¼
.
	`Ü›Á©iÚ
()));

126 
	}
}

128 
	gF›ldPaš‹r
::
	$Œª¦©ePošt
(cÚ¡ 
RRCoÜd
 &
¼
) {

130 
	`rÙ©e
((cÚ¡ )
	`RAD2DEG
(
¼
.
	`h—dšg
()));

131 
	`Œª¦©e
(
¼
.
	`di¡ªû
(), 0);

132 ià(!
	`i¢ª
(
¼
.
	`Ü›Á©iÚ
())) {

133 
	`rÙ©e
(
	`RAD2DEG
(-
¼
.
	`Ü›Á©iÚ
()));

135 
	}
}

137 
	gF›ldPaš‹r
::
	$d¿wB®lRR
 (cÚ¡ 
B®lInfo
 &
b®l
, cÚ¡ 
AbsCoÜd
 &
robÙ
, cÚ¡ 
QCŞÜ
 &
cŞ
)

139 
	`§ve
 ();

140 
	`Œª¦©eRR
(
b®l
.
¼
, 
robÙ
);

141 
	`£tP’
 (
	`QCŞÜ
 ("black"));

142 
	`£tBrush
(
	`QBrush
(
cŞ
));

143 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 40, 40);

144 
	`»¡Üe
 ();

145 
	}
}

147 
	gF›ldPaš‹r
::
	$d¿wB®lRR
 (cÚ¡ 
B®lInfo
 &
b®l
, cÚ¡ 
AbsCoÜd
 &
robÙ
)

149 
QCŞÜ
 
cŞ
 = 
	`QCŞÜ
(255, 127, 0);

150 
	`d¿wB®lRR
(
b®l
, 
robÙ
, 
cŞ
);

151 
	}
}

153 
	gF›ldPaš‹r
::
	$d¿wGßlA»a
(cÚ¡ 
Po¡Info
::
Ty³
 &
gßlA»a
){

155 
	`§ve
 ();

156 if(
gßlA»a
 & 
Po¡Info
::
pAway
){

157 
	`£tP’
("white");

158 
	`£tBrush
(
	`QCŞÜ
("red"));

159 
	`Œª¦©e
(3000, 705);

160 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 5, 140);

161 
	`Œª¦©e
(3000, -705);

162 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 5, 140);

164 } ià(
gßlA»a
 & 
Po¡Info
::
pHome
){

165 
	`£tP’
("white");

166 
	`£tBrush
(
	`QCŞÜ
("blue"));

167 
	`Œª¦©e
(-3000, 705);

168 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 5, 140);

169 
	`Œª¦©e
(-3000, -705);

170 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 5, 140);

172 
	`»¡Üe
 ();

173 
	}
}

175 
	gF›ldPaš‹r
::
	$d¿wPo¡RR
 (cÚ¡ 
Po¡Info
 &
po¡
, cÚ¡ 
AbsCoÜd
 &
robÙ
)

177 
	`§ve
();

178 
	`Œª¦©eRR
(
po¡
.
¼
, 
robÙ
);

179 
	`£tP’
("white");

180 ià(
po¡
.
ty³
 & 
Po¡Info
::
pAway
) {

181 
	`£tBrush
(
	`QCŞÜ
("red"));

182 } ià(
po¡
.
ty³
 & 
Po¡Info
::
pHome
){

183 
	`£tBrush
(
	`QCŞÜ
("blue"));

185 
	`£tBrush
(
	`QCŞÜ
("yellow"));

187 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 80, 80);

188 
	`»¡Üe
();

189 
	}
}

191 
	gF›ldPaš‹r
::
	$d¿wPo¡Abs
 (cÚ¡ 
AbsCoÜd
 &
po¡
, 
QCŞÜ
 
cŞour
)

193 
	`§ve
();

194 
	`Œª¦©e
(
po¡
.
	`x
(),…o¡.
	`y
());

195 
	`£tP’
("white");

196 
	`£tBrush
(
cŞour
);

197 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 80, 80);

198 
	`»¡Üe
();

199 
	}
}

201 
	gF›ldPaš‹r
::
	$d¿wF—tu»RR
 (cÚ¡ 
F›ldF—tu»Info
 &
ã©
, cÚ¡ 
AbsCoÜd
 &
robÙ
)

203 
	`§ve
();

204 
	`£tP’
(
Qt
::
NoP’
);

205 
	`£tBrush
(
	`QBrush
("red"));

206 
	`Œª¦©eRR
(
ã©
.
¼
, 
robÙ
);

207 
QP’
 
p
;

208 
ã©
.
ty³
) {

209 
F›ldF—tu»Info
::
fF›ldLšePošt
:

211 
	`§ve
();

212 
	`£tP’
("blue");

213 
p
 = 
	`³n
();

214 
p
.
	`£tWidth
(25);

215 
	`£tP’
(
p
);

216 
	`£tBrush
(
	`QBrush
("blue"));

217 
ušt16_t
 
i
 = 0; i < 
ã©
.
f›ldlš•ošts
.
	`size
(); i++) {

218 
Pošt
 
p
 = 
ã©
.
f›ldlš•ošts
[
i
].
¼p
;

219 
	`d¿wPošt
 (
	`QPošt
(
p
.
	`x
(),p.
	`y
()));

221 
	`»¡Üe
();

224 
F›ldF—tu»Info
::
fCÜÃr
:

225 
	`£tP’
("black");

226 
p
 = 
	`³n
();

227 
p
.
	`£tWidth
(50);

228 
	`£tP’
(
p
);

229 
	`§ve
();

230 
	`rÙ©e
(
	`RAD2DEG
(
M_PI_4
));

231 
	`d¿wReù
(25, 25, -300, -50);

232 
	`»¡Üe
();

233 
	`§ve
();

234 
	`rÙ©e
(
	`RAD2DEG
(-
M_PI_4
));

235 
	`d¿wReù
(25, 25, -300, -50);

236 
	`»¡Üe
();

238 
F›ldF—tu»Info
::
fTJunùiÚ
:

239 
	`£tP’
("black");

240 
p
 = 
	`³n
();

241 
p
.
	`£tWidth
(50);

242 
	`£tP’
(
p
);

243 
	`d¿wReù
(-25, -300, 50, 600);

244 
	`d¿wReù
(0, 25, -300, -50);

246 
F›ldF—tu»Info
::
fP’®tySpÙ
:

247 
	`£tP’
("black");

248 
p
 = 
	`³n
();

249 
p
.
	`£tWidth
(50);

250 
	`£tP’
(
p
);

251 
	`£tBrush
(
Qt
::
NoBrush
);

252 
	`d¿wEÎ£
 (
	`QPošt
(-30,-30), 60,60);

254 
F›ldF—tu»Info
::
fC’ŒeCœşe
:

255 
	`£tP’
("red");

256 
p
 = 
	`³n
();

257 
p
.
	`£tWidth
(50);

258 
	`£tP’
(
p
);

259 
	`£tBrush
(
Qt
::
NoBrush
);

260 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 
CENTER_CIRCLE_DIAMETER
 / 2, CENTER_CIRCLE_DIAMETER / 2);

262 
F›ldF—tu»Info
::
fLše
:

264 
	`§ve
();

265 
	`£tP’
("red");

266 
p
 = 
	`³n
();

267 
p
.
	`£tWidth
(50);

268 
	`£tP’
(
p
);

269 
	`£tBrush
(
	`QBrush
("red"));

270 
	`d¿wLše
(
ã©
.
lše
.
p1
.
	`x
(), f—t.lše.p1.
	`y
(),

271 
ã©
.
lše
.
p2
.
	`x
(), f—t.lše.p2.
	`y
());

272 
	`»¡Üe
();

275 
F›ldF—tu»Info
::
fP¬®ËlLšes
:

277 
	`§ve
();

278 
	`£tP’
("black");

279 
p
 = 
	`³n
();

280 
p
.
	`£tWidth
(75);

281 
	`£tP’
(
p
);

282 
	`£tBrush
(
	`QBrush
("black"));

283 
	`d¿wLše
(
ã©
.
·¿Î–lšes
.
l1
.
p1
.
	`x
(), f—t.·¿Î–lšes.l1.p1.
	`y
(),

284 
ã©
.
·¿Î–lšes
.
l1
.
p2
.
	`x
(), f—t.·¿Î–lšes.l1.p2.
	`y
());

285 
	`d¿wLše
(
ã©
.
·¿Î–lšes
.
l2
.
p1
.
	`x
(), f—t.·¿Î–lšes.l2.p1.
	`y
(),

286 
ã©
.
·¿Î–lšes
.
l2
.
p2
.
	`x
(), f—t.·¿Î–lšes.l2.p2.
	`y
());

287 
	`»¡Üe
();

294 
	`»¡Üe
();

296 
	}
}

298 
	gF›ldPaš‹r
::
	$d¿wF—tu»Abs
 (cÚ¡ 
AbsCoÜd
 &
pos
, cÚ¡ 
F›ldF—tu»Info
::
Ty³
 &
ty³
) {

299 
	`§ve
();

300 
	`Œª¦©e
(
pos
.
	`x
(),…os.
	`y
());

301 
	`rÙ©e
(
	`RAD2DEG
(
pos
.
	`th‘a
()));

302 
	`£tP’
(
Qt
::
NoP’
);

303 
	`£tBrush
(
	`QBrush
("red"));

304 
QP’
 
p
;

305 
ty³
) {

306 
F›ldF—tu»Info
::
fCÜÃr
:

307 
	`§ve
();

308 
	`rÙ©e
(
	`RAD2DEG
(
M_PI_4
));

309 
	`d¿wReù
(-25, -25, 300, 50);

310 
	`»¡Üe
();

311 
	`§ve
();

312 
	`rÙ©e
(
	`RAD2DEG
(-
M_PI_4
));

313 
	`d¿wReù
(-25, -25, 300, 50);

314 
	`»¡Üe
();

316 
F›ldF—tu»Info
::
fTJunùiÚ
:

317 
	`d¿wReù
(-25, -300, 50, 600);

318 
	`d¿wReù
(0, -25, 300, 50);

319 
F›ldF—tu»Info
::
fP’®tySpÙ
:

321 
F›ldF—tu»Info
::
fC’ŒeCœşe
:

322 
	`§ve
();

323 
	`£tP’
("red");

324 
p
 = 
	`³n
();

325 
p
.
	`£tWidth
(50);

326 
	`£tP’
(
p
);

327 
	`£tBrush
(
Qt
::
NoBrush
);

328 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 600, 600);

329 
	`»¡Üe
();

331 
F›ldF—tu»Info
::
fLše
:

336 
	`»¡Üe
();

337 
	}
}

339 
	gF›ldPaš‹r
::
	$d¿wPÏy”Numb”
 (cÚ¡ 
AbsCoÜd
 &
pos
, 
num
) {

340 
	`§ve
();

341 
	`Œª¦©e
(
pos
.
	`x
(è- 50,…os.
	`y
() - 400);

342 
	`sÿË
(1,-1);

343 
	`£tP’
("white");

344 
	`£tBrush
(
	`QCŞÜ
("white"));

345 
QFÚt
 
fÚt
;

346 
fÚt
.
	`£tPix–Size
(200);

347 
	`£tFÚt
(
fÚt
);

348 
	`d¿wText
(0, 0, 
QSŒšg
::
	`numb”
(
num
));

349 
	`»¡Üe
();

350 
	}
}

354 
	gF›ldPaš‹r
::
	$d¿wRobÙAbs
 (cÚ¡ 
AbsCoÜd
 &
pos
, 
QCŞÜ
 
cŞour
, 
boŞ
 
–l£
, QCŞÜ 
v¬CŞour
)

356 cÚ¡ 
robÙ_¿dius
 = 120;

357 
QReù
 
	`roboReù
(-
robÙ_¿dius
,-robot_radius,robot_radius*2,robot_radius*2);

358 
QP’
 
	`v¬ŸnûP’
(
v¬CŞour
);

359 
v¬ŸnûP’
.
	`£tWidth
(20);

362 
	`§ve
();

363 
	`Œª¦©e
(
pos
.
	`x
(),…os.
	`y
());

364 
	`£tP’
("black");

365 
fov
;

366 ià(
pos
.
	`v¬
(2,2) > 0) {

367 
fov
 = 
	`MIN
(160, 
	`RAD2DEG
(
	`sq¹
(
pos
.
	`v¬
(2,2))));

369 
fov
 = 0;

371 
	`£tBrush
(
	`QBrush
(
cŞour
));

372 
	`rÙ©e
((
	`RAD2DEG
(
pos
.
	`th‘a
())-(
fov
/2)));

373 
	`d¿wP›
(
roboReù
, 0, (360-
fov
)*16);

374 
	`»¡Üe
();

380 ià(
–l£
) {

381 
Eig’
::
VeùÜXf
 
eig’v®ues
 = 
pos
.
v¬
.
block
<2, 2>(0,0).
m¬ked
<Eig’::
S–fAdjošt
>().
	`eig’v®ues
();

382 
r_majÜ_axis
 = 
	`MAX
(
	`sq¹
(MAX(
eig’v®ues
[0],ƒig’v®ues[1])), 
robÙ_¿dius
);

383 
r_mšÜ_axis
 = 
	`MAX
(
	`sq¹
(
	`MIN
(
eig’v®ues
[0],ƒig’v®ues[1])), 
robÙ_¿dius
);

384 
th‘a
 = 
	`©ª2
(2*
pos
.
	`v¬
(0,1),…os.var(0,0)-pos.var(1,1))/2.0;

387 
	`§ve
();

388 
	`Œª¦©e
(
pos
.
	`x
(),…os.
	`y
());

389 
	`rÙ©e
(
	`RAD2DEG
(
th‘a
));

390 
QReù
 
	`v¬Reù
(-
r_majÜ_axis
, -
r_mšÜ_axis
,„_major_axis*2,„_minor_axis*2);

391 
	`£tP’
(
v¬ŸnûP’
);

392 
	`£tBrush
(
	`QBrush
(
Qt
::
NoBrush
));

393 
	`d¿wEÎ£
(
v¬Reù
);

394 
	`»¡Üe
();

396 
	}
}

398 
	gF›ldPaš‹r
::
	$d¿wRobÙRR
 (cÚ¡ 
RobÙInfo
 &
robÙ
, cÚ¡ 
AbsCoÜd
 &
robÙPos
)

400 
	`§ve
 ();

401 
	`Œª¦©eRR
(
robÙ
.
¼
, 
robÙPos
);

402 if(
robÙ
.
ty³
 =ğ
RobÙInfo
::
rRed
) {

403 
	`£tBrush
(
	`QBrush
(
Qt
::
»d
));

404 } if(
robÙ
.
ty³
 =ğ
RobÙInfo
::
rBlue
) {

405 
	`£tBrush
(
	`QBrush
(
Qt
::
blue
));

407 
	`£tBrush
(
	`QBrush
(
Qt
::
g»’
));

409 
	`£tP’
(
	`QCŞÜ
(255, 127, 0));

410 
	`d¿wEÎ£
 (
	`QPošt
(0, 0), 120, 120);

411 
	`»¡Üe
 ();

412 
	}
}

414 
	gF›ldPaš‹r
::
	$d¿wB®lPosRRC
(cÚ¡ 
AbsCoÜd
 &
b®lPos
, cÚ¡ AbsCoÜd &
b®lV–
, 
boŞ
 
movšg
, cÚ¡ AbsCoÜd &
robÙ
)

416 
	`§ve
();

417 
	`Œª¦©e
(
robÙ
.
	`x
(),„obÙ.
	`y
());

418 
	`rÙ©e
(
	`RAD2DEG
(
robÙ
.
	`th‘a
()));

419 
QPošt
 
ÃwB®l
 = 
	`QPošt
(
b®lPos
.
	`x
(), b®lPos.
	`y
());

420 
QPošt
 
ÃxtB®l
 = 
	`QPošt
(
b®lPos
.
	`x
(è+ 
b®lV–
.x(), b®lPos.
	`y
() + ballVel.y());

421 
	`£tP’
(
	`QP’
(
	`QCŞÜ
(255, 0, 0)));

422 
	`£tBrush
(
	`QBrush
(
	`QCŞÜ
(255, 0, 0)));

423 
	`d¿wEÎ£
(
ÃwB®l
, 40, 40);

424 ià(
movšg
è
	`d¿wLše
(
ÃwB®l
, 
ÃxtB®l
);

425 
	`»¡Üe
();

427 
	`d¿wRRCovEÎ£
(
b®lPos
, 
robÙ
);

428 
	}
}

431 
	gF›ldPaš‹r
::
	$d¿wRRCovEÎ£
(cÚ¡ 
AbsCoÜd
 &
pos
, cÚ¡ AbsCoÜd &
robÙPos
) {

432 
QP’
 
	`v¬ŸnûP’
("red");

433 
v¬ŸnûP’
.
	`£tWidth
(20);

435 
Eig’
::
VeùÜXf
 
eig’v®ues
 = 
pos
.
v¬
.
block
<2, 2>(0,0).
m¬ked
<Eig’::
S–fAdjošt
>().
	`eig’v®ues
();

436 
r_majÜ_axis
 = 
	`sq¹
(
	`MAX
(
eig’v®ues
[0],ƒigenvalues[1]));

437 
r_mšÜ_axis
 = 
	`sq¹
(
	`MIN
(
eig’v®ues
[0],ƒigenvalues[1]));

438 
th‘a
 = 
	`©ª2
(2*
pos
.
	`v¬
(0,1),…os.var(0,0)-pos.var(1,1))/2.0;

440 
	`§ve
();

441 
	`Œª¦©e
(
robÙPos
.
	`x
(),„obÙPos.
	`y
());

442 
	`rÙ©e
(
	`RAD2DEG
(
robÙPos
.
	`th‘a
()));

443 
	`Œª¦©e
(
pos
.
	`x
(),…os.
	`y
());

444 
	`rÙ©e
(
	`RAD2DEG
(
th‘a
));

445 
QReù
 
	`v¬Reù
(-
r_majÜ_axis
, -
r_mšÜ_axis
,„_major_axis*2,„_minor_axis*2);

446 
	`£tP’
(
v¬ŸnûP’
);

447 
	`£tBrush
(
	`QBrush
(
Qt
::
NoBrush
));

448 
	`d¿wEÎ£
(
v¬Reù
);

449 
	`»¡Üe
();

450 
	}
}

452 
	gF›ldPaš‹r
::
	$d¿wB®lPosAbs
(cÚ¡ 
AbsCoÜd
 &
b®l
, 
QCŞÜ
 
cŞour
)

454 
	`§ve
();

455 
QPošt
 
ÃwB®l
 = 
	`QPošt
(
b®l
.
	`x
(), b®l.
	`y
());

456 
QP’
 
	`absP’
(
cŞour
);

457 
	`£tP’
(
absP’
);

458 
	`£tBrush
(
	`QBrush
(
cŞour
));

459 
	`d¿wEÎ£
(
ÃwB®l
, 40, 40);

460 
	`»¡Üe
();

462 
	`d¿wAbsCovEÎ£
(
b®l
, 
absP’
);

463 
	}
}

466 
	gF›ldPaš‹r
::
	$d¿wAbsCovEÎ£
(cÚ¡ 
AbsCoÜd
 &
pos
, 
QP’
 
v¬ŸnûP’
) {

467 
v¬ŸnûP’
.
	`£tWidth
(20);

469 
Eig’
::
VeùÜXf
 
eig’v®ues
 = 
pos
.
v¬
.
block
<2, 2>(0,0).
m¬ked
<Eig’::
S–fAdjošt
>().
	`eig’v®ues
();

470 
r_majÜ_axis
 = 
	`sq¹
(
	`MAX
(
eig’v®ues
[0],ƒigenvalues[1]));

471 
r_mšÜ_axis
 = 
	`sq¹
(
	`MIN
(
eig’v®ues
[0],ƒigenvalues[1]));

472 
th‘a
 = 
	`©ª2
(2*
pos
.
	`v¬
(0,1),…os.var(0,0)-pos.var(1,1))/2.0;

474 
	`§ve
();

475 
	`Œª¦©e
(
pos
.
	`x
(),…os.
	`y
());

476 
	`rÙ©e
(
	`RAD2DEG
(
th‘a
));

477 
QReù
 
	`v¬Reù
(-
r_majÜ_axis
, -
r_mšÜ_axis
,„_major_axis*2,„_minor_axis*2);

478 
	`£tP’
(
v¬ŸnûP’
);

479 
	`£tBrush
(
	`QBrush
(
Qt
::
NoBrush
));

480 
	`d¿wEÎ£
(
v¬Reù
);

481 
	`»¡Üe
();

482 
	}
}

484 
	gF›ldPaš‹r
::
	$d¿wF›ldLše
(
LšeInfo
 
lše
) {

485 
	`§ve
();

486 
	`d¿wLše
(
lše
.
p1
.
	`x
(),†še.p1.
	`y
(),†še.
p2
.x(),†ine.p2.y());

487 
	`»¡Üe
();

488 
	}
}

490 
	gF›ldPaš‹r
::
	$d¿wLšeAbs
(cÚ¡ 
AbsCoÜd
 &
äom
, cÚ¡ AbsCoÜd &
to
, 
QCŞÜ
 
q
) {

491 
	`§ve
();

492 
	`£tP’
 (
q
);

493 
	`d¿wLše
(
äom
.
	`x
(), from.
	`y
(), 
to
.x(),o.y());

494 
	`»¡Üe
();

495 
	}
}

	@utils/offnao/utils/FieldPainter.hpp

1 #´agm¨
Úû


3 
	~<QPaš‹r
>

4 
	~<QReùF
>

6 
şass
 
	gB®lInfo
;

7 
şass
 
	gPo¡Info
;

8 
şass
 
	gAbsCoÜd
;

9 
şass
 
	gRRCoÜd
;

11 
	~"ty³s/F›ldF—tu»Info.hµ
"

12 
	~"ty³s/Po¡Info.hµ
"

13 
	~"ty³s/RobÙInfo.hµ
"

15 şas 
	cF›ldPaš‹r
 : 
´iv©e
 
QPaš‹r


17 
public
:

18 
F›ldPaš‹r
 (
QPaštDeviû
 * 
deviû
);

19 
	mvœtu®
 ~
F›ldPaš‹r
 ();

21 
d¿wF›ld
();

23 
d¿wGßlA»a
(cÚ¡ 
Po¡Info
::
Ty³
 &
gßlA»a
);

24 
d¿wB®lRR
 (cÚ¡ 
B®lInfo
 &
b®l
, cÚ¡ 
AbsCoÜd
 &
robÙ
, cÚ¡ 
QCŞÜ
 &
cŞ
);

25 
d¿wB®lRR
(cÚ¡ 
B®lInfo
 &
b®l
, cÚ¡ 
AbsCoÜd
 &
robÙ
);

26 
d¿wPo¡RR
(cÚ¡ 
Po¡Info
 &
po¡
, cÚ¡ 
AbsCoÜd
 &
robÙ
);

27 
d¿wPo¡Abs
 (cÚ¡ 
AbsCoÜd
 &
po¡
, 
QCŞÜ
 
cŞour
);

28 
d¿wF—tu»RR
 (cÚ¡ 
F›ldF—tu»Info
 &
ã©
, cÚ¡ 
AbsCoÜd
 &
robÙ
);

29 
d¿wF—tu»Abs
 (cÚ¡ 
AbsCoÜd
 &
pos
, cÚ¡ 
F›ldF—tu»Info
::
Ty³
 &
ty³
);

30 
d¿wPÏy”Numb”
(cÚ¡ 
AbsCoÜd
 &
pos
, 
num
);

31 
d¿wRobÙAbs
(cÚ¡ 
AbsCoÜd
 &
pos
, 
QCŞÜ
 
cŞour
, 
boŞ
 
d¿wEÎ£
=
Œue
, QCŞÜ 
v¬CŞour
="black");

32 
d¿wRobÙRR
 (cÚ¡ 
RobÙInfo
 &
robÙ
, cÚ¡ 
AbsCoÜd
 &
robÙPos
);

34 
d¿wB®lPosRRC
 (cÚ¡ 
AbsCoÜd
 &
b®lPos
, cÚ¡ AbsCoÜd &
b®lV–
, 
boŞ
 
movšg
, cÚ¡ AbsCoÜd &
robÙPos
);

35 
d¿wB®lPosAbs
 (cÚ¡ 
AbsCoÜd
 &
b®l
, 
QCŞÜ
 
cŞour
=QColor(0,0,255));

37 
d¿wRRCovEÎ£
 (cÚ¡ 
AbsCoÜd
 &
pos
, cÚ¡ AbsCoÜd &
robÙPos
);

38 
d¿wAbsCovEÎ£
 (cÚ¡ 
AbsCoÜd
 &
pos
, 
QP’
 
v¬ŸnûP’
);

40 
d¿wF›ldLše
(
LšeInfo
 
lše
);

41 
d¿wLšeAbs
(cÚ¡ 
AbsCoÜd
 &
äom
, cÚ¡ AbsCoÜd &
to
, 
QCŞÜ
 
q
);

49 
	m´iv©e
:

50 
Œª¦©eRR
(cÚ¡ 
RRCoÜd
 &
¼
, cÚ¡ 
AbsCoÜd
 &
robÙ
);

51 
Œª¦©ePošt
(cÚ¡ 
RRCoÜd
 &
¼
);

53 
QPošt
 
PToC
(cÚ¡ 
RRCoÜd
 &
¼
);

	@utils/offnao/utils/OverlayPainter.cpp

1 
	~"Ov”ÏyPaš‹r.hµ
"

3 
	~"³rû±iÚ/visiÚ/Ùh”/ImageRegiÚ.hµ
"

4 
	~"³rû±iÚ/visiÚ/Ùh”/RobÙRegiÚ.hµ
"

5 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

6 
	~"uts/SPLDefs.hµ
"

8 
	~"ty³s/FoÙInfo.hµ
"

9 
	~"ty³s/B®lInfo.hµ
"

10 
	~"ty³s/Po¡Info.hµ
"

11 
	~"ty³s/RobÙInfo.hµ
"

12 
	~"ty³s/F›ldBound¬yInfo.hµ
"

13 
	~"ty³s/F›ldF—tu»Info.hµ
"

14 
	~"ty³s/Ipošt.hµ
"

17 
QPošt
 
	$p2q
 (
Pošt
 
p
è{  
	`QPošt
 (p.
	`x
 (),….
	`y
 ()); 
	}
}

19 
	gOv”ÏyPaš‹r
::
	$Ov”ÏyPaš‹r
 (è: 
	$QPaš‹r
 ()

21 
	}
}

23 
Ov”ÏyPaš‹r
::
	$Ov”ÏyPaš‹r
 (
QPaštDeviû
 *
deviû
è: 
	$QPaš‹r
 (
deviû
)

25 
	}
}

27 
Ov”ÏyPaš‹r
::~
	$Ov”ÏyPaš‹r
 ()

29 
	}
}

31 
Ov”ÏyPaš‹r
::
	$£tP’
(cÚ¡ 
QP’
 &
³n
)

33 
QP’
 
	`ÃwP’
(
³n
);

35 
width
 = 
³n
.
	`width
();

37 
zoom
 = 
	`sq¹
(
	`ŒªsfÜm
().
	`d‘”mšªt
());

39 
ÃwP’
.
	`£tWidth
(
width
 / 
zoom
);

41 
QPaš‹r
::
	`£tP’
(
ÃwP’
);

42 
	}
}

44 
	gOv”ÏyPaš‹r
::
d¿wHÜizÚ
(
¡d
::
·œ
<, > 
hÜizÚ
)

46 
§ve
();

48 
QPošt
 
p1
(0 , 
hÜizÚ
.
fœ¡
 );

49 
QPošt
 
p2
(
TOP_IMAGE_COLS
, 
hÜizÚ
.
£cÚd
);

51 
£tP’
(
QP’
(
QBrush
("pink"), 2));

52 
d¿wLše
(
p1
, 
p2
);

54 
»¡Üe
();

57 
	gOv”ÏyPaš‹r
::
	$d¿wFoÙOv”Ïy
 (cÚ¡ 
FoÙInfo
 &
foÙ
)

59 
	`§ve
 ();

60 
	`£tP’
(
	`QCŞÜ
 ("blue"));

61 
	`d¿wReù
(
foÙ
.
imageBounds
.
a
.
	`x
(), foÙ.imageBounds.a.
	`y
(),

62 
foÙ
.
imageBounds
.
b
.
	`x
(è- foÙ.imageBounds.
a
.x(),

63 
foÙ
.
imageBounds
.
b
.
	`y
(è- foÙ.imageBounds.
a
.y());

64 
	`»¡Üe
();

66 
	}
}

69 
	gOv”ÏyPaš‹r
::
	$d¿wB®lOv”Ïy
 (cÚ¡ 
B®lInfo
 &
b®l
)

71 
	`§ve
 ();

73 
QPošt
 
ûÁ»
 = 
	`p2q
 (
b®l
.
imageCoÜds
);

74 
¿dius
 = 
b®l
.radius;

76 
	`£tP’
 (
	`QCŞÜ
 ("black"));

77 
	`d¿wEÎ£
 (
ûÁ»
, 
¿dius
,„adius);

79 
	`»¡Üe
 ();

80 
	}
}

82 
	gOv”ÏyPaš‹r
::
	$d¿wPo¡Ov”Ïy
 (cÚ¡ 
Po¡Info
 &
po¡
)

84 
	`§ve
 ();

87 
QPošt
 
a
 = 
	`p2q
 (
po¡
.
imageCoÜds
.a);

88 
QPošt
 
b
 = 
	`p2q
 (
po¡
.
imageCoÜds
.b);

90 ià(
po¡
.
ty³
 & 
Po¡Info
::
pHome
) {

91 
	`£tP’
 (
	`QP’
(
Qt
::
blue
, 2, Qt::
SŞidLše
));

92 } ià(
po¡
.
ty³
 & 
Po¡Info
::
pAway
){

93 
	`£tP’
 (
	`QP’
(
Qt
::
»d
, 2, Qt::
SŞidLše
));

95 
	`£tP’
 (
	`QP’
(
Qt
::
bÏck
, 2, Qt::
SŞidLše
));

98 
	`d¿wReù
 (
	`QReù
 (
a
, 
b
));

100 
	`»¡Üe
 ();

101 
	}
}

103 
	gOv”ÏyPaš‹r
::
d¿wLªdm¬kOv”Ïy
 (cÚ¡ 
Ipošt
 &
Ïndm¬k
, 
¡d
::
·œ
<, > 
hÜizÚ
)

106 
§ve
 ();

108 
£tP’
 ("black");

109 
QReù
 
»ù
 (
Ïndm¬k
.
x
*
SURF_SUBSAMPLE
 -†ªdm¬k.
sÿË
/2*SURF_SUBSAMPLE,

110 
hÜizÚ
.
fœ¡
 + (hÜizÚ.
£cÚd
 - hÜizÚ.fœ¡)*
Ïndm¬k
.
x
/
IMAGE_COLS
*
SURF_SUBSAMPLE
 -†ªdm¬k.
sÿË
/2*SURF_SUBSAMPLE,

111 
Ïndm¬k
.
sÿË
*
SURF_SUBSAMPLE
,†andmark.scale*SURF_SUBSAMPLE);

113 ià(
	gÏndm¬k
.
	gisRobÙ
 == 1){

114 
£tBrush
 (
QBrush
 ("pšk", 
Qt
::
SŞidP©‹º
));

115 } ià(
	gÏndm¬k
.
	gÏ¶acŸn
 == 1) {

116 
£tBrush
 (
QBrush
 ("»d", 
Qt
::
SŞidP©‹º
));

118 
£tBrush
 (
QBrush
 ("blue", 
Qt
::
SŞidP©‹º
));

120 
d¿wEÎ£
 (
»ù
);

122 
»¡Üe
 ();

125 
	gOv”ÏyPaš‹r
::
	$d¿wRobÙBox
(cÚ¡ 
BBox
 &
»giÚ
, cÚ¡ 
QBrush
 &
cŞour
) {

126 cÚ¡ 
PEN_WIDTH
 = 2;

127 
this
->
	`§ve
();

128 
QPošt
 
a
 = 
	`p2q
 (
»giÚ
.a);

129 
QPošt
 
b
 = 
	`p2q
 (
»giÚ
.b);

131 
this
->
	`£tP’
(
	`QP’
(
cŞour
, 
PEN_WIDTH
));

133 
this
->
	`d¿wReù
(
	`QReù
 (
a
,
b
));

135 
this
->
	`d¿wLše
(
a
, 
b
);

136 
tmp
 = 
a
.
	`x
();

137 
a
.
	`£tX
(
b
.
	`x
());

138 
b
.
	`£tX
(
tmp
);

139 
this
->
	`d¿wLše
(
a
, 
b
);

141 
this
->
	`»¡Üe
();

142 
	}
}

144 
	gOv”ÏyPaš‹r
::
	$d¿wRobÙOv”Ïy
 (cÚ¡ 
RobÙInfo
 &
robÙ
)

146 
QBrush
 
cŞour
;

147 if(
robÙ
.
ty³
 =ğ
RobÙInfo
::
rRed
) {

148 
cŞour
 = 
	`QBrush
("pink");

149 } if(
robÙ
.
ty³
 =ğ
RobÙInfo
::
rBlue
) {

150 
cŞour
 = 
	`QBrush
("#7f7fff");

152 
cŞour
 = 
	`QBrush
("#00ff00");

155 ià(
robÙ
.
ÿm”as
 =ğ
RobÙInfo
::
BOTH_CAMERAS
) {

156 
	`d¿wRobÙBox
(
robÙ
.
tİImageCoÜds
, 
cŞour
);

157 
	`d¿wRobÙBox
(
robÙ
.
bÙImageCoÜds
, 
cŞour
);

158 } ià(
robÙ
.
ÿm”as
 =ğ
RobÙInfo
::
TOP_CAMERA
) {

159 
	`d¿wRobÙBox
(
robÙ
.
tİImageCoÜds
, 
cŞour
);

160 } ià(
robÙ
.
ÿm”as
 =ğ
RobÙInfo
::
BOT_CAMERA
) {

161 
	`d¿wRobÙBox
(
robÙ
.
bÙImageCoÜds
, 
cŞour
);

162 } ià(
robÙ
.
ÿm”as
 =ğ
RobÙInfo
::
OLD_DETECTION
) {

163 
	`d¿wRobÙBox
(
robÙ
.
imageCoÜds
, 
cŞour
);

167 
	}
}

169 
	gOv”ÏyPaš‹r
::
	$d¿wLšeP©h
(cÚ¡ 
QPaš‹rP©h
 &
·th
, 
QCŞÜ
 
cŞour
) {

170 
this
->
	`§ve
();

171 
this
->
	`£tP’
(
cŞour
);

172 
this
->
	`d¿wP©h
(
·th
);

173 
this
->
	`»¡Üe
();

174 
	}
}

176 
	gOv”ÏyPaš‹r
::
	$d¿wF›ldBound¬yOv”Ïy
 (cÚ¡ 
F›ldBound¬yInfo
 &
f›ldBound¬y
)

178 
QPošt
 
p1
, 
p2
;

181 
a
 = 
f›ldBound¬y
.
imageBound¬y
.
t1
;

182 
b
 = 
f›ldBound¬y
.
imageBound¬y
.
t2
;

183 
c
 = 
f›ldBound¬y
.
imageBound¬y
.
t3
;

186 ià(
a
 =ğ0 && 
b
 == 0) {

191 ià(
	`abs
 (
a
è>‡b (
b
)) {

192 
x
, 
y
;

194 
y
 = 0;

195 
x
 = (-
c
 - 
b
*
y
è/ 
a
;

196 
p1
 = 
	`QPošt
 (
x
, 
y
);

198 
y
 = 
TOP_IMAGE_ROWS
;

199 
x
 = (-
c
 - 
b
*
y
è/ 
a
;

200 
p2
 = 
	`QPošt
 (
x
, 
y
);

202 
x
, 
y
;

204 
x
 = 0;

205 
y
 = (-
c
 - 
a
*
x
è/ 
b
;

206 
p1
 = 
	`QPošt
 (
x
, 
y
);

208 
x
 = 
TOP_IMAGE_COLS
;

209 
y
 = (-
c
 - 
a
*
x
è/ 
b
;

210 
p2
 = 
	`QPošt
 (
x
, 
y
);

213 
	`§ve
 ();

214 
	`£tP’
 (
	`QCŞÜ
 ("brown"));

216 
	`d¿wLše
 (
p1
, 
p2
);

218 
	`»¡Üe
 ();

219 
	}
}

221 
	gOv”ÏyPaš‹r
::
	$d¿wF›ldF—tu»Ov”Ïy
 (cÚ¡ 
F›ldF—tu»Info
 &
f›ldF—tu»
)

223 
	}
}

225 
Ov”ÏyPaš‹r
::
	$d¿wF›ldF—tu»Ov”Ïy
 (cÚ¡ 
F›ldF—tu»Info
 &
f›ldF—tu»
, 
QCŞÜ
 
cŞour
)

227 ià(
f›ldF—tu»
.
ty³
 =ğ
F›ldF—tu»Info
::
fLše
)

229 
QPošt
 
p1
, 
p2
;

232 
a
 = 
f›ldF—tu»
.
lše
.
t1
;

233 
b
 = 
f›ldF—tu»
.
lše
.
t2
;

234 
c
 = 
f›ldF—tu»
.
lše
.
t3
;

237 ià(
a
 =ğ0 && 
b
 == 0) {

242 ià(
	`abs
 (
a
è>‡b (
b
)) {

243 
x
, 
y
;

245 
y
 = 0;

246 
x
 = (-
c
 - 
b
*
y
è/ 
a
;

247 
p1
 = 
	`QPošt
 (
x
, 
y
);

249 
y
 = 
BOT_IMAGE_ROWS
;

250 
x
 = (-
c
 - 
b
*
y
è/ 
a
;

251 
p2
 = 
	`QPošt
 (
x
, 
y
);

253 
x
, 
y
;

255 
x
 = 0;

256 
y
 = (-
c
 - 
a
*
x
è/ 
b
;

257 
p1
 = 
	`QPošt
 (
x
, 
y
);

259 
x
 = 
BOT_IMAGE_COLS
;

260 
y
 = (-
c
 - 
a
*
x
è/ 
b
;

261 
p2
 = 
	`QPošt
 (
x
, 
y
);

264 
	`§ve
 ();

265 
	`£tP’
 (
	`QCŞÜ
 (
cŞour
));

267 
	`d¿wLše
 (
p1
, 
p2
);

269 
	`»¡Üe
 ();

272 ià(
f›ldF—tu»
.
ty³
 =ğ
F›ldF—tu»Info
::
fCÜÃr
) {

273 
	`d¿wPošt
 (
f›ldF—tu»
.
cÜÃr
.
p
, "black");

276 ià(
f›ldF—tu»
.
ty³
 =ğ
F›ldF—tu»Info
::
fTJunùiÚ
) {

279 ià(
f›ldF—tu»
.
ty³
 =ğ
F›ldF—tu»Info
::
fP’®tySpÙ
) {

280 
w
 = 
f›ldF—tu»
.
³ÇÉy¥Ù
.w;

281 
h
 = 
f›ldF—tu»
.
³ÇÉy¥Ù
.h;

282 
Pošt
 
ûÁ»
 = 
f›ldF—tu»
.
³ÇÉy¥Ù
.
p
;

284 
Pošt
 
	`
(
ûÁ»
.
	`x
(è- 
w
/2, c’Œe.
	`y
(è- 
h
/2);

286 
	`d¿wPošt
(
ûÁ»
, "green");

288 
	`d¿wReù
(

.
	`x
(),l.
	`y
(), 
w
, 
h
);

292 
	}
}

294 
	gOv”ÏyPaš‹r
::
	$d¿wImageRegiÚ
 (
ImageRegiÚ
 *
»giÚ
, 
QCŞÜ
 
cŞour
)

296 
x
 = 
»giÚ
->
tİMo¡
.
fœ¡
;

297 
y
 = 
»giÚ
->
tİMo¡
.
£cÚd
;

298 
w
 = 
»giÚ
->
bÙtomMo¡
.
fœ¡
 - 
x
;

299 
h
 = 
»giÚ
->
bÙtomMo¡
.
£cÚd
 - 
y
;

301 
	`§ve
 ();

304 
	`£tP’
 (
cŞour
);

305 
	`d¿wReù
 (
x
, 
y
, 
w
, 
h
);

307 
	`»¡Üe
 ();

308 
	}
}

310 
	gOv”ÏyPaš‹r
::
	$d¿wRobÙRegiÚ
 (
RobÙRegiÚ
 *
»giÚ
, 
QCŞÜ
 
cŞour
)

312 
x
 = 
»giÚ
->
tİMo¡
;

313 
y
 = 
»giÚ
->
ËáMo¡
;

314 
w
 = 
»giÚ
->
rightMo¡
 - 
x
;

315 
h
 = 
»giÚ
->
bÙtomMo¡
 - 
y
;

317 
	`§ve
 ();

320 
	`£tP’
 (
cŞour
);

321 
	`d¿wReù
 (
x
, 
y
, 
w
, 
h
);

323 
	`»¡Üe
 ();

324 
	}
}

326 
	gOv”ÏyPaš‹r
::
	$d¿wPŞygÚ
(
QPŞygÚ
 
pŞy
, 
QBrush
 
fl
){

327 
	`§ve
();

328 
	`£tBrush
 (
fl
);

329 
QPaš‹r
::
	`d¿wPŞygÚ
(
pŞy
);

330 
	`»¡Üe
();

331 
	}
}

333 
	gOv”ÏyPaš‹r
::
	$d¿wReùªgË
(
Pošt
 
a
, Pošˆ
b
){

334 
	`§ve
();

335 
	`d¿wReù
(
a
.
	`x
(),‡.
	`y
(), 
b
.x() -‡.x(), b.y() -‡.y());

336 
	`»¡Üe
();

337 
	}
}

339 
	gOv”ÏyPaš‹r
::
	$d¿wPošt
 (
Pošt
 
p
, 
QCŞÜ
 
cŞour
)

341 
QReù
 
	`»ù
 (
p
.
	`x
 (è- 1,….
	`y
 () - 1, 3, 3);

343 
	`§ve
 ();

345 
	`£tP’
 ("black");

346 
	`£tBrush
 (
	`QBrush
 (
cŞour
, 
Qt
::
SŞidP©‹º
));

347 
	`d¿wEÎ£
 (
»ù
);

349 
	`»¡Üe
 ();

350 
	}
}

355 cÚ¡ 
	gOv”ÏyPaš‹r
::
cŞour_·œ


356 
Ov”ÏyPaš‹r
::
cŞour_¬r
[
fNUM_FEATURES
] =

357 { 
cŞour_·œ
(
fBALL
 , 
QCŞÜ
(225, 114, 0)),

358 
cŞour_·œ
(
fGOAL_POST_BLUE
 , 
QCŞÜ
( 63, 162, 255)),

359 
cŞour_·œ
(
fGOAL_BAR_BLUE
 , 
QCŞÜ
( 63, 162, 255)),

360 
cŞour_·œ
(
fGOAL_POST_YELLOW
 , 
QCŞÜ
(237, 229, 0)),

361 
cŞour_·œ
(
fGOAL_BAR_YELLOW
 , 
QCŞÜ
(237, 229, 0)),

362 
cŞour_·œ
(
fROBOT_BLUE
 , 
QCŞÜ
( 0, 5, 203)),

363 
cŞour_·œ
(
fROBOT_RED
 , 
QCŞÜ
(188, 0, 0)),

364 
cŞour_·œ
(
fFIELD_LINE
 , 
QCŞÜ
(255, 255, 255)),

365 
cŞour_·œ
(
fFIELD_LINE_THIN
 , 
QCŞÜ
(255, 255, 255)),

366 
cŞour_·œ
(
fFIELD_CORNER
 , 
QCŞÜ
(255, 255, 255)),

367 
cŞour_·œ
(
fFIELD_T_JUNCTION
 , 
QCŞÜ
(255, 255, 255)),

368 
cŞour_·œ
(
fFIELD_PENALTY_SPOT
 , 
QCŞÜ
(255, 255, 255)),

369 
cŞour_·œ
(
fFIELD_CENTRE_CIRCLE
 , 
QCŞÜ
(255, 255, 255)),

370 
cŞour_·œ
(
fFIELD_BOUNDARY
 , 
QCŞÜ
( 0, 255, 0))

373 cÚ¡ 
	g¡d
::
veùÜ
<
Ov”ÏyPaš‹r
::
cŞour_·œ
>

374 
Ov”ÏyPaš‹r
::
cŞour_veùÜ
(
cŞour_¬r
, cŞour_¬¸+ 
fNUM_FEATURES
);

376 cÚ¡ 
	g¡d
::
m­
<
ã©u»_ty³
, 
	gQCŞÜ
>

377 
	gOv”ÏyPaš‹r
::
cŞour_m­
(
cŞour_veùÜ
.
begš
(), cŞour_veùÜ.
’d
());

	@utils/offnao/utils/OverlayPainter.hpp

1 #´agm¨
Úû


3 
	~<QPaš‹r
>

5 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

7 
	~"ty³s/BBox.hµ
"

8 
	~"ty³s/Po¡Info.hµ
"

9 
	~"ty³s/Pošt.hµ
"

11 
şass
 
	gB®lInfo
;

12 
şass
 
	gGßlInfo
;

13 
şass
 
	gRobÙInfo
;

14 
şass
 
	gF›ldBound¬yInfo
;

15 
şass
 
	gF›ldF—tu»Info
;

16 
şass
 
	gFoÙInfo
;

17 
şass
 
	gIpošt
;

19 
şass
 
	gImageRegiÚ
;

20 
şass
 
	gRobÙRegiÚ
;

22 
Çme¥aû
 
	gVisiÚTe¡


24 
şass
 
	gF—tu»
;

26 
şass
 
	gSh­e
;

27 
şass
 
	gCœşe
;

28 
şass
 
	gEÎ£
;

30 
şass
 
	gIÁ”£ùiÚ
;

33 şas 
	cOv”ÏyPaš‹r
 : 
´iv©e
 
QPaš‹r


35 
public
:

37 
usšg
 
QPaš‹r
::
begš
;

38 
usšg
 
	mQPaš‹r
::
’d
;

39 
usšg
 
	mQPaš‹r
::
sÿË
;

40 
usšg
 
	mQPaš‹r
::
Œª¦©e
;

41 
usšg
 
	mQPaš‹r
::
£tT¿nsfÜm
;

42 
usšg
 
	mQPaš‹r
::
d¿wImage
;

44 
usšg
 
	mQPaš‹r
::
£tP’
;

46 
£tP’
(cÚ¡ 
QP’
 & 
³n
);

48 
Ov”ÏyPaš‹r
();

49 
Ov”ÏyPaš‹r
(
QPaštDeviû
 * 
deviû
);

50 
	mvœtu®
 ~
Ov”ÏyPaš‹r
();

52 
d¿wHÜizÚ
(
¡d
::
·œ
<, > 
hÜizÚ
);

54 
d¿wRobÙBox
(cÚ¡ 
BBox
 &
»giÚ
, cÚ¡ 
QBrush
 &
cŞour
);

56 
d¿wFoÙOv”Ïy
(cÚ¡ 
FoÙInfo
 &
foÙ
);

57 
d¿wB®lOv”Ïy
(cÚ¡ 
B®lInfo
 &
b®l
);

58 
d¿wPo¡Ov”Ïy
(cÚ¡ 
Po¡Info
 &
po¡
);

59 
d¿wRobÙOv”Ïy
(cÚ¡ 
RobÙInfo
 &
robÙ
);

60 
d¿wF›ldBound¬yOv”Ïy
(cÚ¡ 
F›ldBound¬yInfo
 &
f›ldBound¬y
);

61 
d¿wF›ldF—tu»Ov”Ïy
(cÚ¡ 
F›ldF—tu»Info
 &
f›ldF—tu»
);

62 
d¿wF›ldF—tu»Ov”Ïy
(cÚ¡ 
F›ldF—tu»Info
 &
f›ldF—tu»
,

63 
QCŞÜ
 
cŞour
);

64 
d¿wLªdm¬kOv”Ïy
(cÚ¡ 
Ipošt
 &
Ïndm¬k
, 
¡d
::
·œ
<, > 
hÜizÚ
);

66 
d¿wImageRegiÚ
(
ImageRegiÚ
 *
»giÚ
, 
QCŞÜ
 
cŞour
);

67 
d¿wRobÙRegiÚ
(
RobÙRegiÚ
 *
»giÚ
, 
QCŞÜ
 
cŞour
);

68 
d¿wPošt
(
Pošt
 
p
, 
QCŞÜ
 
cŞour
);

69 
d¿wReùªgË
(
Pošt
 
a
, Pošˆ
b
);

70 
d¿wF—tu»
(cÚ¡ 
VisiÚTe¡
::
F—tu»
 &
ã©u»
, 
boŞ
 
isS–eùed
);

71 
d¿wIÁ”£ùiÚ
(cÚ¡ 
VisiÚTe¡
::
IÁ”£ùiÚ
 &
š‹r£ùiÚ
);

73 
d¿wLšeP©h
(cÚ¡ 
QPaš‹rP©h
 &
·th
, 
QCŞÜ
 
cŞour
);

74 
d¿wPŞygÚ
(
QPŞygÚ
 
pŞy
, 
QBrush
 
fl
);

75 
	m´iv©e
:

76 
d¿wSh­e
(cÚ¡ 
VisiÚTe¡
::
Sh­e
 &
sh­e
);

77 
d¿wSh­eG¿bs
(cÚ¡ 
VisiÚTe¡
::
Sh­e
 &
sh­e
);

78 
d¿wCœşeSh­e
(cÚ¡ 
VisiÚTe¡
::
Cœşe
 &
cœşe
);

79 
d¿wEÎ£Sh­e
(cÚ¡ 
VisiÚTe¡
::
EÎ£
 &
–l£
);

80 
d¿wPŞySh­e
(cÚ¡ 
VisiÚTe¡
::
Sh­e
 &
sh­e
);

83 
	m¡d
::
	t·œ
<
	tã©u»_ty³
, 
	tQCŞÜ
> 
	tcŞour_·œ
;

84 cÚ¡ 
cŞour_·œ
 
	mcŞour_¬r
[
fNUM_FEATURES
];

85 cÚ¡ 
	m¡d
::
veùÜ
<
cŞour_·œ
> 
cŞour_veùÜ
;

86 cÚ¡ 
	m¡d
::
m­
<
ã©u»_ty³
, 
	mQCŞÜ
> 
	mcŞour_m­
;

	@utils/offnao/visualiser.cpp

32 
	~<boo¡/sh¬ed_±r.hµ
>

33 
	~<QBu‰ÚGroup
>

34 
	~<QDebug
>

35 
	~<QSŒšg
>

36 
	~<QDockWidg‘
>

37 
	~<QIÅutDŸlog
>

38 
	~<¡ršg
>

39 
	~<io¡»am
>

40 
	~<f¡»am
>

41 
	~"visu®i£r.hµ
"

42 
	~"visu®i£r.tcc
"

43 
	~"ui_visu®i£r.h
"

44 
	~"»ad”s/»cÜdR—d”.hµ
"

45 
	~"»ad”s/bbdR—d”.hµ
"

46 
	~<uts/Logg”.hµ
>

47 
	~<th»ad/Th»ad.hµ
>

48 
	~<¡dlib.h
>

49 
	~<s¡»am
>

50 
	~<time.h
>

51 
	~"´ogİts.hµ
"

53 
usšg
 
Çme¥aû
 
	gboo¡
;

54 
usšg
 
	g¡d
::
¡ršg
;

55 
usšg
 
Çme¥aû
 
	g¡d
;

57 
	gVisu®i£r
::
	$Visu®i£r
(
QWidg‘
 *
·»Á
)

58 : 
	`QMašWšdow
(
·»Á
), 
	`ui
(
Ãw
 
Ui
::
Visu®i£r
),

59 
	`»ad”
(0), 
	`ÇoD©a
(0), 
	$cb
() {

61 
Th»ad
::
Çme
 = "Visualiser";

62 
Logg”
::
	`š™
(
cÚfig
["debug.log·th"].
as
<
¡ršg
>(), cÚfig["debug.log"].as<¡ršg>(), 
Œue
);

64 
Ï¡TabIndex
 = -1;

66 
	`¤ªd
(
	`time
(0));

67 
boŞ
 
offNao
;

68 
offNao
 = 
Œue
;

71 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("apollo", 10));

72 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("hotdog", 12));

73 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("husker", 13));

74 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("helo", 14));

75 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("thor", 20));

76 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("odin", 21));

77 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("loki", 22));

78 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("tyr", 23));

79 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("freya", 24));

80 
M­
.
	`š£¹
(
·œ
<
¡ršg
, >("vali", 25));

82 
visiÚ
 = 
Ãw
 
	`VisiÚ
();

84 
ui
->
	`£tupUi
(
this
);

85 
ui
->
ûÁ¿lWidg‘
->
	`£tMšimumSize
(1250, 600);

87 
	`š™M’u
();

90 
medŸPª–
 = 
Ãw
 
	`MedŸPª–
(
ui
->
ûÁ¿lWidg‘
);

93 
cÚÃùiÚB¬
 = 
Ãw
 
QDockWidg‘
;

94 
cb
.
	`£tupUi
(
cÚÃùiÚB¬
);

95 
	`cÚÃù
(
cb
.
cbHo¡
, 
	`SIGNAL
(
	`aùiv©ed
(cÚ¡ 
QSŒšg
 &)),

96 
this
, 
	`SLOT
(
	`cÚÃùToNao
(cÚ¡ 
QSŒšg
 &)));

97 
	`cÚÃù
(
cb
.
bgMasks
, 
	`SIGNAL
(
	`bu‰ÚClicked
(
QAb¡¿ùBu‰Ú
 *)),

98 
this
, 
	`SLOT
(
	`wr™eToNao
(
QAb¡¿ùBu‰Ú
 *)));

101 
bs
 = 
Ãw
 
	`QTabWidg‘
(
ui
->
ûÁ¿lWidg‘
);

102 
bs
->
	`£tMšimumSize
(600, 450);

104 
ov”v›wTab
 = 
Ãw
 
	`Ov”v›wTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

105 
visiÚTab
 = 
Ãw
 
	`VisiÚTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

106 
loÿli§tiÚTab
 = 
Ãw
 
	`Loÿli§tiÚTab
();

107 
ÿm”aTab
 = 
Ãw
 
	`Cam”aTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

108 
£nsÜTab
 = 
Ãw
 
	`S’sÜTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

109 
ÿm”aPo£Tab
 = 
Ãw
 
	`Cam”aPo£Tab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

110 
g¿phTab
 = 
Ãw
 
	`G¿phTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

111 
w®kTab
 = 
Ãw
 
	`W®kTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

112 
zmpTab
 = 
Ãw
 
	`ZMPTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

113 
cÚŒŞTab
 = 
Ãw
 
	`CÚŒŞTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

115 
iıTab
 = 
Ãw
 
	`ICPTab
(
bs
, 
ui
->
m’uB¬
, 
visiÚ
);

116 
‹amTab
 = 
Ãw
 
	`T—mTab
(
bs
, 
ui
->
m’uB¬
);

117 
‹amB®lTab
 = 
Ãw
 
	`T—mB®lTab
(
bs
, 
ui
->
m’uB¬
);

119 
bVeùÜ
.
	`push_back
(
ov”v›wTab
);

120 
bVeùÜ
.
	`push_back
(
‹amTab
);

121 
bVeùÜ
.
	`push_back
(
visiÚTab
);

123 
bVeùÜ
.
	`push_back
(
iıTab
);

124 
bVeùÜ
.
	`push_back
(
loÿli§tiÚTab
);

125 
bVeùÜ
.
	`push_back
(
ÿm”aTab
);

126 
bVeùÜ
.
	`push_back
(
£nsÜTab
);

127 
bVeùÜ
.
	`push_back
(
ÿm”aPo£Tab
);

128 
bVeùÜ
.
	`push_back
(
g¿phTab
);

129 
bVeùÜ
.
	`push_back
(
w®kTab
);

130 
bVeùÜ
.
	`push_back
(
zmpTab
);

131 
bVeùÜ
.
	`push_back
(
cÚŒŞTab
);

132 
bVeùÜ
.
	`push_back
(
logsTab
 = 
Ãw
 
	`LogsTab
(
bs
, 
cb
.
cbHo¡
));

133 
bVeùÜ
.
	`push_back
(
‹amB®lTab
);

139 
	`fÜ—ch
 (
Tab
 *
t
, 
bVeùÜ
) {

140 
bs
->
	`addTab
(
t
, 
	`QSŒšg
Ñ->
	`m‘aObjeù
()->
	`şassName
()).

141 
	`»move
(
	`QRegExp
("Tab$", 
Qt
::
Ca£In£ns™ive
)));

142 
	`cÚÃù
(
t
, 
	`SIGNAL
(
	`showMes§ge
(
QSŒšg
, )),

143 
ui
->
¡©usB¬
, 
	`SLOT
(
	`showMes§ge
(
QSŒšg
, )));

147 
	`cÚÃù
(
bs
, 
	`SIGNAL
(
	`cu¼’tChªged
()), 
this
,

148 
	`SLOT
(
	`cu¼’tTabChªged
()));

150 
ui
->
roÙLayout
->
	`addWidg‘
(
medŸPª–
, 1, 0, 1, 1);

151 
ui
->
roÙLayout
->
	`addWidg‘
(
bs
, 0, 0, 1, 1);

152 
	}
}

154 
	gVisu®i£r
::~
	$Visu®i£r
() {

155 
¡d
::
cout
 << "----‡bouˆtØex™ ----" << std::
’dl
 << std::
æush
;

163 
	}
}

165 
	gVisu®i£r
::
	$ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
) {

166 
this
->
ÇoD©a
 =‚aoData;

167 
	}
}

170 
	gVisu®i£r
::
	$š™M’u
() {

171 
feM’u
 = 
Ãw
 
	`QM’u
("&File");

172 
ui
->
m’uB¬
->
	`addM’u
(
feM’u
);

175 
lßdAù
 = 
Ãw
 
	`QAùiÚ
(
	`Œ
("&Lßd"), 
feM’u
);

176 
§veAsAù
 = 
Ãw
 
	`QAùiÚ
(
	`Œ
("&SavAs"), 
feM’u
);

178 
ex™Aù
 = 
Ãw
 
	`QAùiÚ
(
	`Œ
("&Qu™"), 
feM’u
);

181 
feM’u
->
	`addAùiÚ
(
	`Œ
("CÚÃùØ&Nao"), 
this
, 
	`SLOT
(
	`cÚÃùToNao
()),

182 
	`QKeySequ’û
(
	`Œ
("Ctrl+N", "File|New")));

183 
feM’u
->
	`addAùiÚ
(
	`Œ
("&O³ÀFe"), 
this
, 
	`SLOT
(
	`İ’FeDŸlogue
()),

184 
	`QKeySequ’û
(
	`Œ
("Ctrl+O", "File|Open")));

186 
feM’u
->
	`addAùiÚ
(
	`Œ
("S’d Co&mmªd LšSŒšg"), 
this
,

187 
	`SLOT
(
	`commªdLšeSŒšg
()),

188 
	`QKeySequ’û
(
	`Œ
("F5", "Refresh")));

189 
feM’u
->
	`addAùiÚ
(
	`Œ
("&SavFe"), 
this
, 
	`SLOT
(
	`§veFeDŸlogue
()),

190 
	`QKeySequ’û
(
	`Œ
("Ctrl+S", "File|Save")));

191 
feM’u
->
	`addAùiÚ
(
	`Œ
("&ExŒaù Raw Images"), 
this
, 
	`SLOT
(
	`exŒaùRawImagesDŸlogue
()),

192 
	`QKeySequ’û
(
	`Œ
("Ctrl+E", "File|Extract")));

193 
feM’u
->
	`addAùiÚ
(
	`Œ
("&Clo£ Cu¼’ˆR—d”"), 
this
,

194 
	`SLOT
(
	`discÚÃùFromNao
()),

195 
	`QKeySequ’û
(
	`Œ
("Ctrl+W", "File|Close")));

197 
feM’u
->
	`addAùiÚ
(
	`Œ
("&Qu™"), 
this
,

198 
	`SLOT
(
	`şo£
()),

199 
	`QKeySequ’û
(
	`Œ
("Ctrl+Q", "Close")));

201 
	}
}

204 
	gVisu®i£r
::
	$şo£
() {

205 
d–‘e
 
cÚÃùiÚB¬
;

206 
i
 = 0; i > 
bVeùÜ
.
	`size
(); i++) {

207 
d–‘e
 
bVeùÜ
[
i
];

211 
d–‘e
 
ui
;

212 
	`ex™
(0);

213 
	}
}

215 
	gVisu®i£r
::
	$İ’FeDŸlogue
() {

216 
QSŒšg
 
feName
 =

217 
QFeDŸlog
::
	`g‘O³nFeName
(
this
, "Open File",

218 
	`g‘’v
("RUNSWIFT_CHECKOUT_DIR"),

219 #ià
BOOST_HAS_COMPRESSION


225 #ià
BOOST_HAS_COMPRESSION


232 
	`İ’Fe
(
feName
);

234 
	}
}

236 
	gVisu®i£r
::
	$İ’Fe
 (cÚ¡ 
QSŒšg
 &
·th
)

238 ià(!
·th
.
	`isEm±y
()) {

239 if(
·th
.
	`’dsW™h
(".bbd")) {

240 
»cÚÃù
<
BBDR—d”
, cÚ¡ 
QSŒšg
 &>(
·th
);

241 } if(
·th
.
	`’dsW™h
(".yuv"))

242 
»cÚÃù
<
DumpR—d”
, cÚ¡ 
QSŒšg
 &>(
·th
);

243 if(
·th
.
	`’dsW™h
(".ofn")

244 #ià
BOOST_HAS_COMPRESSION


245 || 
·th
.
	`’dsW™h
(".ofn.gz") ||…ath.endsWith(".ofn.bz2")

248 
»cÚÃù
<
RecÜdR—d”
, cÚ¡ 
QSŒšg
 &>(
·th
);

250 
ui
->
¡©usB¬
->
	`showMes§ge
(

251 
	`QSŒšg
("Unknown fileƒxtension, modify %1:%2:%3").

252 
	`¬g
(
__FILE__
, 
__PRETTY_FUNCTION__
,

253 
QSŒšg
::
	`numb”
(
__LINE__
)));

255 
	}
}

257 
	gVisu®i£r
::
	$§veFeDŸlogue
() {

258 
QSŒšg
 
feName
 =

259 
QFeDŸlog
::
	`g‘SaveFeName
(
this
, "Save File",

260 
	`g‘’v
("RUNSWIFT_CHECKOUT_DIR"),

261 #ià
BOOST_HAS_COMPRESSION


267 #ià
BOOST_HAS_COMPRESSION


274 
	`§veFe
(
feName
);

275 
	}
}

277 
	gVisu®i£r
::
	$§veFe
 (cÚ¡ 
QSŒšg
 &
·th
)

279 ià(!
·th
.
	`isEm±y
()) {

280 if(
·th
.
	`’dsW™h
(".ofn")

281 #ià
BOOST_HAS_COMPRESSION


282 || 
·th
.
	`’dsW™h
(".ofn.gz") ||…ath.endsWith(".ofn.bz2")

285 
RecÜdR—d”
::
	`wr™e
(
·th
, *
ÇoD©a
);

289 
ui
->
¡©usB¬
->
	`showMes§ge
(

290 
	`QSŒšg
("Unknown fileƒxtension, saving‡s %1.ofn").

291 
	`¬g
(
·th
));

292 
RecÜdR—d”
::
	`wr™e
(
·th
 + ".oâ", *
ÇoD©a
);

295 
	}
}

297 
	gVisu®i£r
::
	$exŒaùRawImagesDŸlogue
() {

298 
QSŒšg
 
dœ
 = 
QFeDŸlog
::
	`g‘Exi¡šgDœeùÜy
(
this
, 
	`Œ
("Save imageso folder"),

299 
	`g‘’v
("RUNSWIFT_CHECKOUT_DIR"),

300 
QFeDŸlog
::
ShowDœsOÆy


301 | 
QFeDŸlog
::
DÚtResŞveSymlšks
);

302 
	`exŒaùRawImages
(
dœ
);

303 
	}
}

305 
	gVisu®i£r
::
	$exŒaùRawImages
(cÚ¡ 
QSŒšg
 &
·th
)

307 ià(!
·th
.
	`isEm±y
(è&& 
ÇoD©a
) {

308 
RecÜdR—d”
::
	`dumpImages
(
·th
, *
ÇoD©a
);

310 
	}
}

312 
	gVisu®i£r
::
	$keyP»ssEv’t
(
QKeyEv’t
 *
ev’t
)

315 ià(!
ev’t
->
	`isAutoR•—t
())

317 
cÚŒŞTab
->
	`keyP»ssEv’t
(
ev’t
);

320 
	}
}

322 
	gVisu®i£r
::
	$keyR–—£Ev’t
(
QKeyEv’t
 *
ev’t
)

325 ià(!
ev’t
->
	`isAutoR•—t
())

327 
cÚŒŞTab
->
	`keyR–—£Ev’t
(
ev’t
);

330 
	}
}

335 
	gVisu®i£r
::
	$¡¬tRecÜdšg
(
QAùiÚ
 *
aùiÚ
) {

336 
	}
}

338 
Visu®i£r
::
	$cu¼’tTabChªged
(
bIndex
) {

339 ià(
Ï¡TabIndex
 != -1) {

340 
bVeùÜ
[
Ï¡TabIndex
]->
	`bDe£Ëùed
();

342 
bVeùÜ
[
bIndex
]->
	`bS–eùed
();

344 
em™
 
	`»äeshNaoD©a
();

345 
	}
}

347 
OffNaoMask_t
 
	gVisu®i£r
::
	$ŒªsmissiÚMask
(cÚ¡ 
QAb¡¿ùBu‰Ú
 *) {

348 
OffNaoMask_t
 
mask
 = 0;

350 
QLi¡
<
QAb¡¿ùBu‰Ú
 *> 
bu‰Ús
 = 
cb
.
bgMasks
->
	`bu‰Ús
();

351 !
bu‰Ús
.
	`isEm±y
()) {

352 
QAb¡¿ùBu‰Ú
 *
bu‰Ú
 = 
bu‰Ús
.
	`keFœ¡
();

353 ià(
bu‰Ú
->
	`isChecked
()) {

354 ià(
bu‰Ú
 =ğ
cb
.
cbBÏckbßrd
)

355 
mask
 |ğ
BLACKBOARD_MASK
;

356 ià(
bu‰Ú
 =ğ
cb
.
cbS®›ncy
)

357 
mask
 |ğ
SALIENCY_MASK
;

358 ià(
bu‰Ú
 =ğ
cb
.
cbRaw
)

359 
mask
 |ğ
RAW_IMAGE_MASK
;

360 ià(
bu‰Ú
 =ğ
cb
.
cbP¬tişes
)

361 
mask
 |ğ
PARTICLE_FILTER_MASK
;

362 ià(
bu‰Ú
 =ğ
cb
.
cbRobÙF‹r
)

363 
mask
 |ğ
ROBOT_FILTER_MASK
;

364 ià(
bu‰Ú
 =ğ
cb
.
cbLªdm¬ks
)

365 
mask
 |ğ
LANDMARKS_MASK
;

367 
ui
->
¡©usB¬
->
	`showMes§ge
("Error in…arsing mask checkboxes!");

370  
mask
;

371 
	}
}

373 
	gVisu®i£r
::
	$cÚÃùToNao
(cÚ¡ 
QSŒšg
 &
ÇoName
) {

374 
QSŒšg
 
ÃwÇoName
 = 
ÇoName
;

375 
¡ršg
 
¡rNao
 = 
ÇoName
.
	`toStdSŒšg
();

376 ià(
¡rNao
.
	`fšd
('.'è!ğ
¡ršg
::
Åos
){

377 ià(
¡rNao
[0] > '9'){

378 
¡rNao
 = sŒNao.
	`sub¡r
(0, sŒNao.
	`fšd
('.'));

382 if(
M­
.
	`fšd
(
¡rNao
è!ğM­.
	`’d
()){

383 

 = 
M­
[
¡rNao
];

384 
¡d
::
¡ršg¡»am
 
ss
;

385 
ss
 << "10.0.18.1" << 

;

386 
ÃwÇoName
 = 
ss
.
	`¡r
().
	`c_¡r
();

388 if(
»cÚÃù
<
N‘wÜkR—d”
, 
·œ
<cÚ¡ 
QSŒšg
 &, 
OffNaoMask_t
> >

389 (
	`make_·œ
(
ÃwÇoName
, 
	`ŒªsmissiÚMask
(
NULL
)))) {

390 
N‘wÜkR—d”
 *
»ad”
 = 
dyÇmic_ÿ¡
<N‘wÜkR—d” *>(
this
->reader);

391 
	`Q_ASSERT
(
»ad”
);

392 
	`cÚÃù
(
this
, 
	`SIGNAL
(
	`£ndCommªdLšeSŒšg
(cÚ¡ 
QSŒšg
&)), 
»ad”
,

393 
	`SLOT
(
	`£ndCommªdLšeSŒšg
(
QSŒšg
)));

394 
	`cÚÃù
(
ÿm”aPo£Tab
, 
	`SIGNAL
(
	`£ndCommªdToRobÙ
(
QSŒšg
)),

395 
»ad”
, 
	`SLOT
(
	`£ndCommªdLšeSŒšg
(
QSŒšg
)));

396 
	`cÚÃù
(
ÿm”aTab
, 
	`SIGNAL
(
	`£ndCommªdToRobÙ
(
QSŒšg
)),

397 
»ad”
, 
	`SLOT
(
	`£ndCommªdLšeSŒšg
(
QSŒšg
)));

398 
	`cÚÃù
(
logsTab
, 
	`SIGNAL
(
	`£ndCommªdToRobÙ
(
QSŒšg
)),

399 
»ad”
, 
	`SLOT
(
	`£ndCommªdLšeSŒšg
(
QSŒšg
)));

401 
this
->
»ad”
 =„eader;

402 
	`£tUpR—d”SigÇls
(
this
->
»ad”
);

403 
this
->
»ad”
->
	`¡¬t
();

404 
cÚŒŞTab
->
	`£tNao
(
ÃwÇoName
);

406 
	}
}

408 
	gVisu®i£r
::
	$wr™eToNao
(
QAb¡¿ùBu‰Ú
 *
qab
) {

409 ià(
»ad”
)

411 ((
N‘wÜkR—d”
*)
»ad”
)->
	`wr™e
(
	`ŒªsmissiÚMask
(
qab
));

412 
	}
}

414 
	gVisu®i£r
::
	$cÚÃùToNao
() {

415 
	`addDockWidg‘
(
Qt
::
TİDockWidg‘A»a
, 
cÚÃùiÚB¬
);

416 
cÚÃùiÚB¬
->
	`show
();

417 
cb
.
cbHo¡
->
	`£tFocus
();

418 
cb
.
cbHo¡
->
	`lšeEd™
()->
	`£ËùAÎ
();

419 
	}
}

422 
	gVisu®i£r
::
	$commªdLšeSŒšg
() {

423 
QSŒšg
 
™em
 = 
QIÅutDŸlog
::
	`g‘Text
(
NULL
, "Send String",

424 
	`Œ
("Command FieldEdge String:"));

425 
em™
 
	`£ndCommªdLšeSŒšg
(
™em
);

426 
	}
}

428 
	gVisu®i£r
::
	$discÚÃùFromNao
() {

429 ià(
»ad”
 &&„—d”->
	`isFšished
(è=ğ
çl£
) {

430 
	`cÚÃù
(
»ad”
, 
	`SIGNAL
(
	`fšished
()), 
this
, 
	`SLOT
(
	`discÚÃùFromNao
()));

431 
»ad”
->
	`fšishUp
();

432 
	`qDebug
("Tryo destroy„eader. Wait forhreadoƒxit.");

433 } ià(
»ad”
) {

434 
em™
 
	`»ad”Clo£d
();

435 
d–‘e
 
»ad”
;

436 
»ad”
 = 0;

437 
	`qDebug
("Finished destroying„eader");

438 
ui
->
¡©usB¬
->
	`showMes§ge
(
	`QSŒšg
("Reader destroyed."));

440 
	}
}

442 
	gVisu®i£r
::
	$£tUpR—d”SigÇls
(
R—d”
 *
»ad”
) {

444 
i
 = 0; i < 
bVeùÜ
.
	`size
(); i++) {

445 
	`cÚÃù
(
»ad”
, 
	`SIGNAL
(
	`ÃwNaoD©a
(
NaoD©a
*)), 
bVeùÜ
[
i
],

446 
	`SLOT
(
	`ÃwNaoD©a
(
NaoD©a
 *)));

447 
	`cÚÃù
(
this
, 
	`SIGNAL
(
	`»ad”Clo£d
()), 
bVeùÜ
[
i
],

448 
	`SLOT
(
	`»ad”Clo£d
()));

451 
	`cÚÃù
(
»ad”
, 
	`SIGNAL
(
	`ÃwNaoD©a
(
NaoD©a
*)), 
medŸPª–
,

452 
	`SLOT
(
	`ÃwNaoD©a
(
NaoD©a
 *)));

453 
	`cÚÃù
(
»ad”
, 
	`SIGNAL
(
	`ÃwNaoD©a
(
NaoD©a
*)), 
this
,

454 
	`SLOT
(
	`ÃwNaoD©a
(
NaoD©a
 *)));

456 
	`cÚÃù
(
medŸPª–
->
fÜw¬dAù
, 
	`SIGNAL
(
	`Œigg”ed
()), 
»ad”
,

457 
	`SLOT
(
	`fÜw¬dMedŸTrigg”
()));

458 
	`cÚÃù
(
medŸPª–
->
backAù
, 
	`SIGNAL
(
	`Œigg”ed
()), 
»ad”
,

459 
	`SLOT
(
	`backw¬dMedŸTrigg”
()));

460 
	`cÚÃù
(
medŸPª–
->
¶ayAù
, 
	`SIGNAL
(
	`Œigg”ed
()), 
»ad”
,

461 
	`SLOT
(
	`¶ayMedŸTrigg”
()));

462 
	`cÚÃù
(
medŸPª–
->
·u£Aù
, 
	`SIGNAL
(
	`Œigg”ed
()), 
»ad”
,

463 
	`SLOT
(
	`·u£MedŸTrigg”
()));

464 
	`cÚÃù
(
medŸPª–
->
¡İAù
, 
	`SIGNAL
(
	`Œigg”ed
()), 
»ad”
,

465 
	`SLOT
(
	`¡İMedŸTrigg”
()));

466 
	`cÚÃù
(
medŸPª–
->
»cÜdAù
, 
	`SIGNAL
(
	`Œigg”ed
()), 
»ad”
,

467 
	`SLOT
(
	`»cÜdMedŸTrigg”
()));

468 
	`cÚÃù
(
medŸPª–
->
äameSlid”
, 
	`SIGNAL
(
	`v®ueChªged
()),

469 
»ad”
, 
	`SLOT
(
	`¦id”Moved
()));

471 
	`cÚÃù
(
this
, 
	`SIGNAL
(
	`»äeshNaoD©a
()), 
»ad”
, 
	`SLOT
(refreshNaoData()));

472 
	`cÚÃù
(
medŸPª–
->
äameSlid”
, 
	`SIGNAL
(
	`¦id”R–—£d
()), 
»ad”
,

473 
	`SLOT
(
	`»äeshNaoD©a
()));

474 
	`cÚÃù
(
»ad”
, 
	`SIGNAL
(
	`showMes§ge
(
QSŒšg
, )), 
ui
->
¡©usB¬
,

475 
	`SLOT
(
	`showMes§ge
(
QSŒšg
, )));

476 
	`cÚÃù
(
»ad”
, 
	`SIGNAL
(
	`İ’Fe
()), 
this
, 
	`SLOT
(
	`İ’FeDŸlogue
()));

477 
	`cÚÃù
(
»ad”
, 
	`SIGNAL
(
	`discÚÃùFromNao
()), 
this
,

478 
	`SLOT
(
	`discÚÃùFromNao
()));

479 
medŸPª–
->
»cÜdBu‰Ú
->
	`£tFocus
();

480 
	}
}

	@utils/offnao/visualiser.hpp

32 #´agm¨
Úû


34 
	~<QtGui/QMašWšdow
>

35 
	~<QT»eWidg‘
>

36 
	~<QTabWidg‘
>

37 
	~<QLab–
>

38 
	~<QFeDŸlog
>

40 
	~<veùÜ
>

41 
	~<m­
>

42 
	~<¡ršg
>

44 
	~"ÇoD©a.hµ
"

45 
	~"medŸPª–.hµ
"

47 
	~"»ad”s/»ad”.hµ
"

48 
	~"»ad”s/ÃtwÜkR—d”.hµ
"

49 
	~"»ad”s/dumpR—d”.hµ
"

51 
	~"bs/ÿm”aTab.hµ
"

52 
	~"bs/şassif›r.hµ
"

53 
	~"bs/ov”v›wTab.hµ
"

54 
	~"bs/visiÚTab.hµ
"

55 
	~"bs/loÿli§tiÚTab.hµ
"

56 
	~"bs/£nsÜTab.hµ
"

57 
	~"bs/ÿm”aPo£Tab.hµ
"

58 
	~"bs/g¿phTab.hµ
"

59 
	~"bs/w®kTab.hµ
"

60 
	~"bs/zmpTab.hµ
"

61 
	~"bs/cÚŒŞTab.hµ
"

62 
	~"bs/LogsTab.hµ
"

64 
	~"bs/iıTab.hµ
"

65 
	~"bs/‹amTab.hµ
"

66 
	~"bs/‹amB®lTab.hµ
"

69 
	~"³rû±iÚ/visiÚ/Ùh”/YUV.hµ
"

70 
	~"³rû±iÚ/visiÚ/VisiÚDefš™iÚs.hµ
"

71 
	~"³rû±iÚ/visiÚ/VisiÚ.hµ
"

72 
	~"³rû±iÚ/loÿli§tiÚ/Loÿli§tiÚDefs.hµ
"

74 
	~"uts/Logg”.hµ
"

76 
	~"ui_CÚÃùiÚB¬.h
"

78 
şass
 
	gTab
;

80 
Çme¥aû
 
	gUi
 {

81 
şass
 
	gVisu®i£r
;

88 şas 
	cVisu®i£r
 : 
public
 
QMašWšdow
 {

90 
ä›nd
 
maš
 (, **);

92 
Q_OBJECT


94 
	mpublic
:

95 
ex¶ic™
 
Visu®i£r
(
QWidg‘
 *
·»Á
 = 0);

96 ~
Visu®i£r
();

98 
public
 
	m¦Ùs
:

100 
ÃwNaoD©a
(
NaoD©a
 *
ÇoD©a
);

103 
¡¬tRecÜdšg
(
QAùiÚ
* 
aùiÚ
);

108 
İ’FeDŸlogue
();

109 
İ’Fe
(cÚ¡ 
QSŒšg
 &
·th
);

114 
§veFeDŸlogue
();

115 
§veFe
(cÚ¡ 
QSŒšg
 &
·th
);

120 
exŒaùRawImagesDŸlogue
();

121 
exŒaùRawImages
(cÚ¡ 
QSŒšg
 &
·th
);

126 
cu¼’tTabChªged
(
bIndex
);

128 
cÚÃùToNao
();

129 
cÚÃùToNao
(cÚ¡ 
QSŒšg
 &
ÇoName
);

130 
wr™eToNao
(
QAb¡¿ùBu‰Ú
 *
qab
);

132 
keyP»ssEv’t
(
QKeyEv’t
 *
ev’t
);

133 
keyR–—£Ev’t
(
QKeyEv’t
 *
ev’t
);

135 
discÚÃùFromNao
();

140 
commªdLšeSŒšg
();

143 
şo£
();

145 
	msigÇls
:

149 
»äeshNaoD©a
();

154 
£ndCommªdLšeSŒšg
(cÚ¡ 
QSŒšg
 &);

156 
»ad”Clo£d
();

158 
	m´iv©e
:

159 
Ui
::
Visu®i£r
 *
ui
;

160 
	m¡d
::
m­
<
¡d
::
¡ršg
, > 
	mM­
;

161 
	m¡d
::
veùÜ
<
Tab
*> 
bVeùÜ
;

165 
R—d”
 *
	m»ad”
;

168 
NaoD©a
 *
	mÇoD©a
;

170 
QTabWidg‘
 *
	mbs
;

173 
Ov”v›wTab
 *
	mov”v›wTab
;

174 
VisiÚTab
 *
	mvisiÚTab
;

175 
Loÿli§tiÚTab
 *
	mloÿli§tiÚTab
;

176 
Cam”aTab
 *
	mÿm”aTab
;

177 
S’sÜTab
 *
	m£nsÜTab
;

178 
Cam”aPo£Tab
 *
	mÿm”aPo£Tab
;

179 
G¿phTab
 *
	mg¿phTab
;

180 
W®kTab
 *
	mw®kTab
;

181 
ZMPTab
 *
	mzmpTab
;

182 
CÚŒŞTab
 *
	mcÚŒŞTab
;

183 
LogsTab
 *
	mlogsTab
;

185 
ICPTab
 *
	miıTab
;

186 
T—mTab
 *
	m‹amTab
;

187 
T—mB®lTab
 *
	m‹amB®lTab
;

192 
š™M’u
();

196 
QM’u
 *
	mfeM’u
;

197 
QAùiÚ
 *
	mlßdAù
;

198 
QAùiÚ
 *
	m§veAsAù
;

199 
QAùiÚ
 *
	mex™Aù
;

202 
QDockWidg‘
 *
	mcÚÃùiÚB¬
;

203 
	mUi
::
CÚÃùiÚB¬
 
cb
;

204 
OffNaoMask_t
 
ŒªsmissiÚMask
(cÚ¡ 
QAb¡¿ùBu‰Ú
 *);

209 
MedŸPª–
 *
	mmedŸPª–
;

211 
VisiÚ
 *
	mvisiÚ
;

213 
£tUpR—d”SigÇls
(
R—d”
 *
»ad”
);

216 
	mÏ¡TabIndex
;

225 
	m‹m¶©e
<
şass
 
	mR—d”CÏss
, 
ty³Çme
 
	mVoid
>

226 
boŞ
 
»cÚÃù
(cÚ¡ 
Void
 &
cÚ¡ruùÜArg1
);

	@utils/offnao/visualiser.tcc

1 
	~"ui_visu®i£r.h
"

3 
	g‹m¶©e
<
şass
 
	gR—d”CÏss
, 
ty³Çme
 
	gVoid
>

4 
boŞ
 
	gVisu®i£r
::
	$»cÚÃù
(cÚ¡ 
Void
 &
cÚ¡ruùÜArg1
) {

5 
R—d”
 *
r
;

6 ià(!
»ad”
) {

7 
r
 = 
Ãw
 
	`R—d”CÏss
(
cÚ¡ruùÜArg1
);

8 } ià(
»ad”
->
	`isFšished
()) {

9 
r
 = 
Ãw
 
	`R—d”CÏss
(
cÚ¡ruùÜArg1
, 
»ad”
->
ÇoD©a
);

10 
em™
 
	`»ad”Clo£d
();

11 
d–‘e
 
»ad”
;

13 
»ad”
->
	`fšishUp
();

14 
	`qDebug
("Tryo destroy„eader. Wait forhreadoƒxit.");

15 if(
»ad”
->
	`wa™
(2000)) {

16 
r
 = 
Ãw
 
	`R—d”CÏss
(
cÚ¡ruùÜArg1
, 
»ad”
->
ÇoD©a
);

17 
em™
 
	`»ad”Clo£d
();

18 
d–‘e
 
»ad”
;

20 
ui
->
¡©usB¬
->
	`showMes§ge
(
	`QSŒšg
("Failedo close„eader."));

21  
çl£
;

24 
»ad”
 = 
r
;

25 
	`£tUpR—d”SigÇls
(
»ad”
);

26 
»ad”
->
	`¡¬t
();

27  
Œue
;

28 
	}
}

	@utils/webnao/node_modules/fsevents/fsevents.cc

6 
	~"Çn.h
"

7 
	~"uv.h
"

8 
	~"v8.h
"

9 
	~"±h»ad.h
"

10 
	~"CÜeFound©iÚ/CÜeFound©iÚ.h
"

11 
	~"CÜeS”viûs/CÜeS”viûs.h
"

12 
	~<io¡»am
>

13 
	~<veùÜ
>

15 
	~"¤c/¡Üage.cc
"

16 
Çme¥aû
 
	gf£
 {

17 şas 
	cFSEv’ts
 : 
public
 
node
::
ObjeùW¿p
 {

18 
public
:

19 
FSEv’ts
(cÚ¡ *
·th
, 
Nª
::
C®lback
 *
hªdËr
);

20 ~
FSEv’ts
();

23 
boŞ
 
	glockS¹ed
;

24 
±h»ad_mu‹x_t
 
	glockmu‹x
;

25 
lockšgS¹
();

26 
lock
();

27 
uÆock
();

28 
lockšgStİ
();

31 
uv_async_t
 
	gasync
;

32 
asyncS¹
();

33 
asyncTrigg”
();

34 
asyncStİ
();

37 
±h»ad_t
 
	gth»ad
;

38 
CFRunLoİRef
 
	gth»adloİ
;

39 
th»adS¹
();

40 *
th»adRun
(*
ùx
);

41 
th»adStİ
();

44 
	gNª
::
C®lback
 *
hªdËr
;

45 
em™Ev’t
(cÚ¡ *
·th
, 
UIÁ32
 
æags
, 
UIÁ64
 
id
);

48 
CFA¼ayRef
 
	g·ths
;

49 
	g¡d
::
veùÜ
<
f£_ev’t
*> 
ev’ts
;

50 
In™Ÿlize
(
v8
::
HªdË
<v8::
Objeù
> 
expÜts
);

53 
NAN_METHOD
(
New
);

54 
NAN_METHOD
(
Stİ
);

55 
NAN_METHOD
(
S¹
);

60 
usšg
 
Çme¥aû
 
	gf£
;

62 
	gFSEv’ts
::
	$FSEv’ts
(cÚ¡ *
·th
, 
Nª
::
C®lback
 *
hªdËr
): 
	$hªdËr
(
hªdËr
) {

63 
CFSŒšgRef
 
dœs
[] = { 
	`CFSŒšgC»©eW™hCSŒšg
(
NULL
, 
·th
, 
kCFSŒšgEncodšgUTF8
) };

64 
·ths
 = 
	`CFA¼ayC»©e
(
NULL
, (cÚ¡ **)&
dœs
, 1, NULL);

65 
th»adloİ
 = 
NULL
;

66 
	`lockšgS¹
();

67 
	}
}

68 
	gFSEv’ts
::~
	$FSEv’ts
() {

69 
¡d
::
cout
 << "YIKES" << std::
’dl
;

70 
	`lockšgStİ
();

71 
d–‘e
 
hªdËr
;

72 
hªdËr
 = 
NULL
;

74 
	`CFR–—£
(
·ths
);

75 
	}
}

77 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mC»©ed


78 
	#kFSEv’tSŒ—mEv’tFÏgI‹mC»©ed
 0x00000010

	)

81 
	~"¤c/lockšg.cc
"

82 
	~"¤c/async.cc
"

83 
	~"¤c/th»ad.cc
"

84 
	~"¤c/cÚ¡ªts.cc
"

85 
	~"¤c/m‘hods.cc
"

87 
	gFSEv’ts
::
In™Ÿlize
(
v8
::
HªdË
<v8::
Objeù
> 
expÜts
) {

88 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
l
 = 
Nª
::
New
<v8::FunùiÚTem¶©e>(
FSEv’ts
::New);

89 
	gl
->
S‘CÏssName
(
Nª
::
New
<
v8
::
SŒšg
>("FSEv’ts").
ToLoÿlChecked
());

90 
	gl
->
In¡ªûTem¶©e
()->
S‘IÁ”ÇlF›ldCouÁ
(1);

91 
	gl
->
PrÙÙy³Tem¶©e
()->
S‘
(

92 
Nª
::
New
<
v8
::
SŒšg
>("¡¬t").
ToLoÿlChecked
(),

93 
Nª
::
New
<
v8
::
FunùiÚTem¶©e
>(
FSEv’ts
::
S¹
));

94 
	gl
->
PrÙÙy³Tem¶©e
()->
S‘
(

95 
Nª
::
New
<
v8
::
SŒšg
>("¡İ").
ToLoÿlChecked
(),

96 
Nª
::
New
<
v8
::
FunùiÚTem¶©e
>(
FSEv’ts
::
Stİ
));

97 
	gexpÜts
->
S‘
(
Nª
::
New
<
v8
::
SŒšg
>("CÚ¡ªts").
ToLoÿlChecked
(), 
CÚ¡ªts
());

98 
	gexpÜts
->
S‘
(
Nª
::
New
<
v8
::
SŒšg
>("FSEv’ts").
ToLoÿlChecked
(),

99 
l
->
G‘FunùiÚ
());

102 
NODE_MODULE
(
f£
, 
FSEv’ts
::
In™Ÿlize
)

	@utils/webnao/node_modules/fsevents/src/async.cc

7 
	$async_´İag©e
(
uv_async_t
 *
async
) {

8 ià(!
async
->
d©a
) ;

9 
FSEv’ts
 *
f£
 = (FSEv’t *)
async
->
d©a
;

10 
CFIndex
 
idx
, 
út
;

11 
f£_ev’t
 *
ev’t
;

12 
·thbuf
[1024];

13 cÚ¡ *
·th±r
 = 
NULL
;

14 
f£
->
	`lock
();

15 
út
 = 
f£
->
ev’ts
.
	`size
();

16 
idx
=0; idx<
út
; idx++) {

17 
ev’t
 = 
f£
->
ev’ts
.
	`©
(
idx
);

18 ià(
ev’t
 =ğ
NULL
) ;

19 
·th±r
 = 
	`CFSŒšgG‘CSŒšgPŒ
(
ev’t
->
·th
, 
kCFSŒšgEncodšgUTF8
);

20 ià(!
·th±r
è
	`CFSŒšgG‘CSŒšg
(
ev’t
->
·th
, 
·thbuf
, 1024, 
kCFSŒšgEncodšgUTF8
);

21 
f£
->
	`em™Ev’t
(
·th±r
 ?…©h±¸: 
·thbuf
, 
ev’t
->
æags
,ƒv’t->
id
);

22 
d–‘e
 
ev’t
;

24 ià(
út
>0è
f£
->
ev’ts
.
	`ş—r
();

25 
f£
->
	`uÆock
();

26 
	}
}

28 
	gFSEv’ts
::
	$asyncS¹
() {

29 ià(
async
.
d©a
 =ğ
this
) ;

30 
async
.
d©a
 = 
this
;

31 
	`uv_async_š™
(
	`uv_deçuÉ_loİ
(), &
async
, (
uv_async_cb
è
async_´İag©e
);

32 
	}
}

34 
	gFSEv’ts
::
	$asyncTrigg”
() {

35 ià(
async
.
d©a
 !ğ
this
) ;

36 
	`uv_async_£nd
(&
async
);

37 
	}
}

39 
	gFSEv’ts
::
	$asyncStİ
() {

40 ià(
async
.
d©a
 !ğ
this
) ;

41 
async
.
d©a
 = 
NULL
;

42 
	`uv_şo£
((
uv_hªdË_t
 *è&
async
, 
NULL
);

43 
	}
}

	@utils/webnao/node_modules/fsevents/src/constants.cc

7 #iâdeà
kFSEv’tSŒ—mEv’tFÏgNÚe


8 
	#kFSEv’tSŒ—mEv’tFÏgNÚe
 0x00000000

	)

11 #iâdeà
kFSEv’tSŒ—mEv’tFÏgMu¡SÿnSubDœs


12 
	#kFSEv’tSŒ—mEv’tFÏgMu¡SÿnSubDœs
 0x00000001

	)

15 #iâdeà
kFSEv’tSŒ—mEv’tFÏgU£rDrİ³d


16 
	#kFSEv’tSŒ—mEv’tFÏgU£rDrİ³d
 0x00000002

	)

19 #iâdeà
kFSEv’tSŒ—mEv’tFÏgK”ÃlDrİ³d


20 
	#kFSEv’tSŒ—mEv’tFÏgK”ÃlDrİ³d
 0x00000004

	)

23 #iâdeà
kFSEv’tSŒ—mEv’tFÏgEv’tIdsW¿µed


24 
	#kFSEv’tSŒ—mEv’tFÏgEv’tIdsW¿µed
 0x00000008

	)

27 #iâdeà
kFSEv’tSŒ—mEv’tFÏgHi¡ÜyDÚe


28 
	#kFSEv’tSŒ—mEv’tFÏgHi¡ÜyDÚe
 0x00000010

	)

31 #iâdeà
kFSEv’tSŒ—mEv’tFÏgRoÙChªged


32 
	#kFSEv’tSŒ—mEv’tFÏgRoÙChªged
 0x00000020

	)

35 #iâdeà
kFSEv’tSŒ—mEv’tFÏgMouÁ


36 
	#kFSEv’tSŒ—mEv’tFÏgMouÁ
 0x00000040

	)

39 #iâdeà
kFSEv’tSŒ—mEv’tFÏgUnmouÁ


40 
	#kFSEv’tSŒ—mEv’tFÏgUnmouÁ
 0x00000080

	)

43 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mC»©ed


44 
	#kFSEv’tSŒ—mEv’tFÏgI‹mC»©ed
 0x00000100

	)

47 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mRemoved


48 
	#kFSEv’tSŒ—mEv’tFÏgI‹mRemoved
 0x00000200

	)

51 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mInodeM‘aMod


52 
	#kFSEv’tSŒ—mEv’tFÏgI‹mInodeM‘aMod
 0x00000400

	)

55 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mR’amed


56 
	#kFSEv’tSŒ—mEv’tFÏgI‹mR’amed
 0x00000800

	)

59 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mModif›d


60 
	#kFSEv’tSŒ—mEv’tFÏgI‹mModif›d
 0x00001000

	)

63 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mFšd”InfoMod


64 
	#kFSEv’tSŒ—mEv’tFÏgI‹mFšd”InfoMod
 0x00002000

	)

67 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mChªgeOwÃr


68 
	#kFSEv’tSŒ—mEv’tFÏgI‹mChªgeOwÃr
 0x00004000

	)

71 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mX©ŒMod


72 
	#kFSEv’tSŒ—mEv’tFÏgI‹mX©ŒMod
 0x00008000

	)

75 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mIsFe


76 
	#kFSEv’tSŒ—mEv’tFÏgI‹mIsFe
 0x00010000

	)

79 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mIsDœ


80 
	#kFSEv’tSŒ—mEv’tFÏgI‹mIsDœ
 0x00020000

	)

83 #iâdeà
kFSEv’tSŒ—mEv’tFÏgI‹mIsSymlšk


84 
	#kFSEv’tSŒ—mEv’tFÏgI‹mIsSymlšk
 0x00040000

	)

87 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$CÚ¡ªts
() {

88 
v8
::
Loÿl
<v8::
Objeù
> 
objeù
 = 
Nª
::
New
<v8::Object>();

89 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgNÚe").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgNÚe
));

90 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgMu¡SÿnSubDœs").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgMu¡SÿnSubDœs
));

91 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgU£rDrİ³d").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgU£rDrİ³d
));

92 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgK”ÃlDrİ³d").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgK”ÃlDrİ³d
));

93 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgEv’tIdsW¿µed").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgEv’tIdsW¿µed
));

94 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgHi¡ÜyDÚe").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgHi¡ÜyDÚe
));

95 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgRoÙChªged").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgRoÙChªged
));

96 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgMouÁ").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgMouÁ
));

97 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgUnmouÁ").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgUnmouÁ
));

98 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mC»©ed").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mC»©ed
));

99 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mRemoved").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mRemoved
));

100 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mInodeM‘aMod").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mInodeM‘aMod
));

101 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mR’amed").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mR’amed
));

102 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mModif›d").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mModif›d
));

103 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mFšd”InfoMod").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mFšd”InfoMod
));

104 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mChªgeOwÃr").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mChªgeOwÃr
));

105 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mX©ŒMod").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mX©ŒMod
));

106 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mIsFe").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mIsFe
));

107 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mIsDœ").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mIsDœ
));

108 
objeù
->
	`S‘
(
Nª
::
New
<
v8
::
SŒšg
>("kFSEv’tSŒ—mEv’tFÏgI‹mIsSymlšk").
	`ToLoÿlChecked
(), Nª::New<v8::
IÁeg”
>(
kFSEv’tSŒ—mEv’tFÏgI‹mIsSymlšk
));

109  
objeù
;

110 
	}
}

	@utils/webnao/node_modules/fsevents/src/locking.cc

6 
	gFSEv’ts
::
	$lockšgS¹
() {

7 ià(
lockS¹ed
) ;

8 
lockS¹ed
 = 
Œue
;

9 
	`±h»ad_mu‹x_š™
(&
lockmu‹x
, 
NULL
);

10 
	}
}

12 
	gFSEv’ts
::
	$lock
() {

13 ià(!
lockS¹ed
) ;

14 
	`±h»ad_mu‹x_lock
(&
lockmu‹x
);

15 
	}
}

17 
	gFSEv’ts
::
	$uÆock
() {

18 ià(!
lockS¹ed
) ;

19 
	`±h»ad_mu‹x_uÆock
(&
lockmu‹x
);

20 
	}
}

22 
	gFSEv’ts
::
	$lockšgStİ
() {

23 ià(!
lockS¹ed
) ;

24 
lockS¹ed
 = 
çl£
;

26 
	`±h»ad_mu‹x_de¡roy
(&
lockmu‹x
);

27 
	}
}

	@utils/webnao/node_modules/fsevents/src/methods.cc

6 
	gFSEv’ts
::
	$em™Ev’t
(cÚ¡ *
·th
, 
UIÁ32
 
æags
, 
UIÁ64
 
id
) {

7 ià(!
hªdËr
) ;

8 
Nª
::
HªdËScİe
 
hªdË_scİe
;

9 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[] = {

10 
Nª
::
New
<
v8
::
SŒšg
>(
·th
).
	`ToLoÿlChecked
(),

11 
Nª
::
New
<
v8
::
Numb”
>(
æags
),

12 
Nª
::
New
<
v8
::
Numb”
>(
id
)

14 
hªdËr
->
	`C®l
(3, 
¬gv
);

15 
	}
}

17 
	$NAN_METHOD
(
FSEv’ts
::
New
) {

18 
Nª
::
Utf8SŒšg
 *
·th
 = 
Ãw
 Nª::
	`Utf8SŒšg
(
šfo
[0]);

19 
Nª
::
C®lback
 *
ÿÎback
 = 
Ãw
 Nª::
	`C®lback
(
šfo
[1].
As
<
v8
::
FunùiÚ
>());

21 
FSEv’ts
 *
f£
 = 
Ãw
 
	`FSEv’ts
(**
·th
, 
ÿÎback
);

22 
f£
->
	`W¿p
(
šfo
.
	`This
());

24 
šfo
.
	`G‘R‘uºV®ue
().
	`S‘
(šfo.
	`This
());

25 
	}
}

27 
	$NAN_METHOD
(
FSEv’ts
::
Stİ
) {

28 
FSEv’ts
* 
f£
 = 
node
::
ObjeùW¿p
::
Unw¿p
<FSEv’ts>(
šfo
.
	`This
());

30 
f£
->
	`th»adStİ
();

31 
f£
->
	`asyncStİ
();

33 
šfo
.
	`G‘R‘uºV®ue
().
	`S‘
(šfo.
	`This
());

34 
	}
}

36 
	$NAN_METHOD
(
FSEv’ts
::
S¹
) {

37 
FSEv’ts
* 
f£
 = 
node
::
ObjeùW¿p
::
Unw¿p
<FSEv’ts>(
šfo
.
	`This
());

38 
f£
->
	`asyncS¹
();

39 
f£
->
	`th»adS¹
();

41 
šfo
.
	`G‘R‘uºV®ue
().
	`S‘
(šfo.
	`This
());

42 
	}
}

	@utils/webnao/node_modules/fsevents/src/storage.cc

6 
	sf£_ev’t
 {

7 
UIÁ64
 
	mid
;

8 
UIÁ32
 
	mæags
;

9 
CFSŒšgRef
 
	m·th
;

11 
f£_ev’t
(
CFSŒšgRef
 
ev’tP©h
, 
UIÁ32
 
ev’tFÏg
, 
UIÁ64
 
ev’tId
) {

12 
	mthis
->
	m·th
 = 
ev’tP©h
;

13 
	mthis
->
	mæags
 = 
ev’tFÏg
;

14 
	mthis
->
	mid
 = 
ev’tId
;

15 ià(
	mthis
->
	m·th
 !ğ
NULL
)

16 
CFR‘aš
(
this
->
·th
);

19 ~
f£_ev’t
() {

20 ià(
	mthis
->
	m·th
 !ğ
NULL
)

21 
CFR–—£
(
this
->
·th
);

24 
	m´iv©e
:

25 
f£_ev’t
(const fse_event&);

26 
	mİ”©Ü
=(cÚ¡ 
f£_ev’t
&);

	@utils/webnao/node_modules/fsevents/src/thread.cc

7 #iâdeà
kFSEv’tSŒ—mC»©eFÏgNÚe


8 
	#kFSEv’tSŒ—mC»©eFÏgNÚe
 0x00000000

	)

11 #iâdeà
kFSEv’tSŒ—mC»©eFÏgU£CFTy³s


12 
	#kFSEv’tSŒ—mC»©eFÏgU£CFTy³s
 0x00000001

	)

15 #iâdeà
kFSEv’tSŒ—mC»©eFÏgNoDeãr


16 
	#kFSEv’tSŒ—mC»©eFÏgNoDeãr
 0x00000002

	)

19 #iâdeà
kFSEv’tSŒ—mC»©eFÏgW©chRoÙ


20 
	#kFSEv’tSŒ—mC»©eFÏgW©chRoÙ
 0x00000004

	)

23 #iâdeà
kFSEv’tSŒ—mC»©eFÏgIgnÜeS–f


24 
	#kFSEv’tSŒ—mC»©eFÏgIgnÜeS–f
 0x00000008

	)

27 #iâdeà
kFSEv’tSŒ—mC»©eFÏgFeEv’ts


28 
	#kFSEv’tSŒ—mC»©eFÏgFeEv’ts
 0x00000010

	)

31 
	gFSEv’ts
::
	$th»adS¹
() {

32 ià(
th»adloİ
) ;

33 
	`±h»ad_ü—‹
(&
th»ad
, 
NULL
, &
FSEv’ts
::
th»adRun
, 
this
);

34 
	}
}

36 
	$HªdËSŒ—mEv’ts
(
CÚ¡FSEv’tSŒ—mRef
 
¡»am
, *
ùx
, 
size_t
 
numEv’ts
, *
ev’tP©hs
, cÚ¡ 
FSEv’tSŒ—mEv’tFÏgs
 
ev’tFÏgs
[], cÚ¡ 
FSEv’tSŒ—mEv’tId
 
ev’tIds
[]) {

37 
FSEv’ts
 * 
f£
 = (FSEv’t *)
ùx
;

38 
size_t
 
idx
;

39 
f£
->
	`lock
();

40 
idx
=0; idx < 
numEv’ts
; idx++) {

41 
f£_ev’t
 *
ev’t
 = 
Ãw
 
	`f£_ev’t
(

42 (
CFSŒšgRef
)
	`CFA¼ayG‘V®ueAtIndex
((
CFA¼ayRef
)
ev’tP©hs
, 
idx
),

43 
ev’tFÏgs
[
idx
],

44 
ev’tIds
[
idx
]

46 
f£
->
ev’ts
.
	`push_back
(
ev’t
);

48 
f£
->
	`asyncTrigg”
();

49 
f£
->
	`uÆock
();

50 
	}
}

52 *
	gFSEv’ts
::
	$th»adRun
(*
ùx
) {

53 
FSEv’ts
 *
f£
 = (FSEv’ts*)
ùx
;

54 
FSEv’tSŒ—mCÚ‹xt
 
cÚ‹xt
 = { 0, 
ùx
, 
NULL
, NULL, NULL };

55 
f£
->
th»adloİ
 = 
	`CFRunLoİG‘Cu¼’t
();

56 
FSEv’tSŒ—mRef
 
¡»am
 = 
	`FSEv’tSŒ—mC»©e
(
NULL
, &
HªdËSŒ—mEv’ts
, &
cÚ‹xt
, 
f£
->
·ths
, 
kFSEv’tSŒ—mEv’tIdSšûNow
, (
CFAbsŞu‹Time
è0.1, 
kFSEv’tSŒ—mC»©eFÏgNÚe
 | 
kFSEv’tSŒ—mC»©eFÏgW©chRoÙ
 | 
kFSEv’tSŒ—mC»©eFÏgFeEv’ts
 | 
kFSEv’tSŒ—mC»©eFÏgU£CFTy³s
);

57 
	`FSEv’tSŒ—mScheduËW™hRunLoİ
(
¡»am
, 
f£
->
th»adloİ
, 
kCFRunLoİDeçuÉMode
);

58 
	`FSEv’tSŒ—mS¹
(
¡»am
);

59 
	`CFRunLoİRun
();

60 
	`FSEv’tSŒ—mStİ
(
¡»am
);

61 
	`FSEv’tSŒ—mUnscheduËFromRunLoİ
(
¡»am
, 
f£
->
th»adloİ
, 
kCFRunLoİDeçuÉMode
);

62 
	`FSEv’tSŒ—mInv®id©e
(
¡»am
);

63 
	`FSEv’tSŒ—mR–—£
(
¡»am
);

64 
f£
->
th»adloİ
 = 
NULL
;

65  
NULL
;

66 
	}
}

68 
	gFSEv’ts
::
	$th»adStİ
() {

69 ià(!
th»adloİ
) ;

70 
	`CFRunLoİStİ
(
th»adloİ
);

71 
	`±h»ad_još
(
th»ad
, 
NULL
);

72 
	}
}

	@utils/webnao/node_modules/nan/nan.h

20 #iâdeà
NAN_H_


21 
	#NAN_H_


	)

23 
	~<node_v”siÚ.h
>

25 
	#NODE_0_10_MODULE_VERSION
 11

	)

26 
	#NODE_0_12_MODULE_VERSION
 14

	)

27 
	#ATOM_0_21_MODULE_VERSION
 41

	)

28 
	#IOJS_1_0_MODULE_VERSION
 42

	)

29 
	#IOJS_1_1_MODULE_VERSION
 43

	)

30 
	#IOJS_2_0_MODULE_VERSION
 44

	)

31 
	#IOJS_3_0_MODULE_VERSION
 45

	)

32 
	#NODE_4_0_MODULE_VERSION
 46

	)

33 
	#NODE_5_0_MODULE_VERSION
 47

	)

34 
	#NODE_6_0_MODULE_VERSION
 48

	)

36 #ifdeà
_MSC_VER


37 
	#NAN_HAS_CPLUSPLUS_11
 (
_MSC_VER
 >ğ1800)

	)

39 
	#NAN_HAS_CPLUSPLUS_11
 (
__ılu¥lus
 >ğ201103L)

	)

42 #ià
NODE_MODULE_VERSION
 >ğ
IOJS_3_0_MODULE_VERSION
 && !
NAN_HAS_CPLUSPLUS_11


43 #”rÜ 
This
 
v”siÚ
 
of
 
node
/
NAN
/
v8
 
»quœes
 
a
 
C
++11 
comp”


46 
	~<uv.h
>

47 
	~<node.h
>

48 
	~<node_bufãr.h
>

49 
	~<node_objeù_w¿p.h
>

50 
	~<®gÜ™hm
>

51 
	~<c¡ršg
>

52 
	~<şim™s
>

53 
	~<c¡dlib
>

54 #ià
defšed
(
_MSC_VER
)

55 #´agm¨
w¬nšg
Ğ
push
 )

56 #´agm¨
w¬nšg
Ğ
di§bË
 : 4530 )

57 
	~<¡ršg
>

58 
	~<veùÜ
>

59 #´agm¨
w¬nšg
Ğ
pİ
 )

61 
	~<¡ršg
>

62 
	~<veùÜ
>

66 #ifdeà
UV_VERSION_MAJOR


67 #iâdeà
UV_VERSION_PATCH


68 
	#UV_VERSION_PATCH
 0

	)

70 
	#NAUV_UVVERSION
 ((
UV_VERSION_MAJOR
 << 16) | \

71 (
UV_VERSION_MINOR
 << 8) | \

72 (
UV_VERSION_PATCH
))

	)

74 
	#NAUV_UVVERSION
 0x000b00

	)

77 #ià
NAUV_UVVERSION
 < 0x000b0b

78 #ifdeà
WIN32


79 
	~<wšdows.h
>

81 
	~<±h»ad.h
>

85 
Çme¥aû
 
	gNª
 {

87 
	#NAN_INLINE
 
šlše


88 

	)

89 #ià
defšed
(
__GNUC__
) && \

90 !(
defšed
(
V8_DISABLE_DEPRECATIONS
è&& 
	gV8_DISABLE_DEPRECATIONS
)

91 
	#NAN_DEPRECATED
 
	`__©Œibu‹__
((
d•»ÿ‹d
))

	)

92 #–ià
defšed
(
_MSC_VER
) && \

93 !(
defšed
(
V8_DISABLE_DEPRECATIONS
è&& 
	gV8_DISABLE_DEPRECATIONS
)

94 
	#NAN_DEPRECATED
 
	`__deş¥ec
(
d•»ÿ‹d
)

	)

96 
	#NAN_DEPRECATED


	)

99 #ià
NAN_HAS_CPLUSPLUS_11


100 
	#NAN_DISALLOW_ASSIGN
(
CLASS
è
İ”©Ü
=(cÚ¡ CLASS&èğ
d–‘e
;

	)

101 
	#NAN_DISALLOW_COPY
(
CLASS
è
	`CLASS
(cÚ¡ CLASS&èğ
d–‘e
;

	)

102 
	#NAN_DISALLOW_MOVE
(
CLASS
) \

103 
	`CLASS
(
CLASS
&&èğ
d–‘e
; \

104 
İ”©Ü
=(
CLASS
&&èğ
d–‘e
;

	)

106 
	#NAN_DISALLOW_ASSIGN
(
CLASS
è
İ”©Ü
=(cÚ¡ CLASS&);

	)

107 
	#NAN_DISALLOW_COPY
(
CLASS
è
	`CLASS
(cÚ¡ CLASS&);

	)

108 
	#NAN_DISALLOW_MOVE
(
CLASS
)

	)

111 
	#NAN_DISALLOW_ASSIGN_COPY
(
CLASS
) \

112 
	`NAN_DISALLOW_ASSIGN
(
CLASS
) \

113 
	`NAN_DISALLOW_COPY
(
CLASS
)

	)

115 
	#NAN_DISALLOW_ASSIGN_MOVE
(
CLASS
) \

116 
	`NAN_DISALLOW_ASSIGN
(
CLASS
) \

117 
	`NAN_DISALLOW_MOVE
(
CLASS
)

	)

119 
	#NAN_DISALLOW_COPY_MOVE
(
CLASS
) \

120 
	`NAN_DISALLOW_COPY
(
CLASS
) \

121 
	`NAN_DISALLOW_MOVE
(
CLASS
)

	)

123 
	#NAN_DISALLOW_ASSIGN_COPY_MOVE
(
CLASS
) \

124 
	`NAN_DISALLOW_ASSIGN
(
CLASS
) \

125 
	`NAN_DISALLOW_COPY
(
CLASS
) \

126 
	`NAN_DISALLOW_MOVE
(
CLASS
)

	)

128 
	#TYPE_CHECK
(
T
, 
S
) \

129 
çl£
) { \

130 *(
¡©ic_ÿ¡
<
T
 *vŞ©*>(0)èğ¡©ic_ÿ¡<
S
*>(0); \

131 }

	)

135 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


136 
	gv8
::
	tHªdË
<
	tv8
::
	tObjeù
> 
	tADDON_REGISTER_FUNCTION_ARGS_TYPE
;

138 
	gv8
::
	tLoÿl
<
	tv8
::
	tObjeù
> 
	tADDON_REGISTER_FUNCTION_ARGS_TYPE
;

141 
	#NAN_MODULE_INIT
(
Çme
) \

142 
	`Çme
(
Nª
::
ADDON_REGISTER_FUNCTION_ARGS_TYPE
 
rg‘
)

	)

146 
	~"Çn_ÿÎbacks.h
"

150 #ià(
NODE_MODULE_VERSION
 < 
NODE_0_12_MODULE_VERSION
)

151 
	gv8
::
	tSüt
 
	tUnboundSüt
;

152 
	gv8
::
	tSüt
 
	tBoundSüt
;

154 
	gv8
::
	tUnboundSüt
 UnboundScript;

155 
	gv8
::
	tSüt
 
	tBoundSüt
;

158 #ià(
NODE_MODULE_VERSION
 < 
ATOM_0_21_MODULE_VERSION
)

159 
	gv8
::
	tSŒšg
::
	tEx‹º®AsciiSŒšgResourû


160 
	tEx‹º®OÃBy‹SŒšgResourû
;

162 
	gv8
::
	tSŒšg
::
	tEx‹º®OÃBy‹SŒšgResourû


163 
	tEx‹º®OÃBy‹SŒšgResourû
;

166 #ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

167 
	g‹m¶©e
<
ty³Çme
 
	gT
>

168 
şass
 
	gNÚCİyabËP”si¡’tT¿™s
 :

169 
public
 
v8
::
NÚCİyabËP”si¡’tT¿™s
<
T
> {};

170 
	g‹m¶©e
<
ty³Çme
 
	gT
>

171 
şass
 
	gCİyabËP”si¡’tT¿™s
 :

172 
public
 
v8
::
CİyabËP”si¡’tT¿™s
<
T
> {};

174 
	g‹m¶©e
<
ty³Çme
 
	gT
>

175 
şass
 
	gP”si¡’tBa£
 :

176 
public
 
v8
::
P”si¡’tBa£
<
T
> {};

178 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gM
 = 
v8
::
NÚCİyabËP”si¡’tT¿™s
<
T
> >

179 
şass
 
P”si¡’t
;

181 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
şass
 
	gNÚCİyabËP”si¡’tT¿™s
;

182 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
şass
 
	gP”si¡’tBa£
;

183 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gP
> 
şass
 
	gW—kC®lbackD©a
;

184 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gM
 = 
NÚCİyabËP”si¡’tT¿™s
<
T
> >

185 
şass
 
P”si¡’t
;

188 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

189 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

190 
	~"Çn_maybe_43_šl.h
"

192 
	~"Çn_maybe_´e_43_šl.h
"

195 
	~"Çn_cÚv”‹rs.h
"

196 
	~"Çn_Ãw.h
"

198 #ià
NAUV_UVVERSION
 < 0x000b17

199 
	#NAUV_WORK_CB
(
func
) \

200 
	`func
(
uv_async_t
 *
async
, )

	)

202 
	#NAUV_WORK_CB
(
func
) \

203 
	`func
(
uv_async_t
 *
async
)

	)

206 #ià
NAUV_UVVERSION
 >= 0x000b0b

208 
uv_key_t
 
	tÇuv_key_t
;

210 
šlše
 
Çuv_key_ü—‹
(
Çuv_key_t
 *
key
) {

211  
uv_key_ü—‹
(
key
);

214 
šlše
 
Çuv_key_d–‘e
(
Çuv_key_t
 *
key
) {

215 
uv_key_d–‘e
(
key
);

218 
šlše
 * 
Çuv_key_g‘
(
Çuv_key_t
 *
key
) {

219  
uv_key_g‘
(
key
);

222 
šlše
 
Çuv_key_£t
(
Çuv_key_t
 *
key
, *
v®ue
) {

223 
uv_key_£t
(
key
, 
v®ue
);

233 #iâdeà
WIN32


235 
±h»ad_key_t
 
	tÇuv_key_t
;

237 
šlše
 
Çuv_key_ü—‹
(
Çuv_key_t
* 
key
) {

238  -
±h»ad_key_ü—‹
(
key
, 
NULL
);

241 
šlše
 
Çuv_key_d–‘e
(
Çuv_key_t
* 
key
) {

242 ià(
±h»ad_key_d–‘e
(*
key
))

243 
abÜt
();

246 
šlše
 * 
Çuv_key_g‘
(
Çuv_key_t
* 
key
) {

247  
±h»ad_g‘¥ecific
(*
key
);

250 
šlše
 
Çuv_key_£t
(
Çuv_key_t
* 
key
, * 
v®ue
) {

251 ià(
±h»ad_£t¥ecific
(*
key
, 
v®ue
))

252 
abÜt
();

258 
DWORD
 
	gs_šdex
;

259 } 
	tÇuv_key_t
;

261 
šlše
 
Çuv_key_ü—‹
(
Çuv_key_t
* 
key
) {

262 
	gkey
->
	gs_šdex
 = 
TlsAÎoc
();

263 ià(
	gkey
->
	gs_šdex
 =ğ
TLS_OUT_OF_INDEXES
)

264  
UV_ENOMEM
;

268 
šlše
 
Çuv_key_d–‘e
(
Çuv_key_t
* 
key
) {

269 ià(
TlsF»e
(
key
->
s_šdex
è=ğ
FALSE
)

270 
abÜt
();

271 
	gkey
->
	gs_šdex
 = 
TLS_OUT_OF_INDEXES
;

274 
šlše
 * 
Çuv_key_g‘
(
Çuv_key_t
* 
key
) {

275 * 
	gv®ue
 = 
TlsG‘V®ue
(
key
->
s_šdex
);

276 ià(
	gv®ue
 =ğ
NULL
)

277 ià(
G‘La¡E¼Ü
(è!ğ
ERROR_SUCCESS
)

278 
abÜt
();

279  
	gv®ue
;

282 
šlše
 
Çuv_key_£t
(
Çuv_key_t
* 
key
, * 
v®ue
) {

283 ià(
TlsS‘V®ue
(
key
->
s_šdex
, 
v®ue
è=ğ
FALSE
)

284 
abÜt
();

290 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


291 
	g‹m¶©e
<
ty³Çme
 
	gT
>

292 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
HªdË
<T>);

295 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

296 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

297 
v8
::
	tW—kC®lbackTy³
 WeakCallbackType;

299 
	sW—kC®lbackTy³
 {

300 
	eE
 {
	gkP¬am‘”
, 
	gkIÁ”ÇlF›lds
};

301 
E
 
	gty³
;

302 
W—kC®lbackTy³
(
E
 
Ùh”
è: 
ty³
(other) {}

303 
šlše
 
boŞ
 
İ”©Ü
==(
E
 
Ùh”
è{  oth” =ğ
this
->
ty³
; }

304 
šlše
 
boŞ
 
	gİ”©Ü
!=(
E
 
Ùh”
è{  !
İ”©Ü
==(other); }

308 
	g‹m¶©e
<
ty³Çme
 
	gP
> 
şass
 
	gW—kC®lbackInfo
;

310 #ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


311 
	~"Çn_³rsi¡’t_12_šl.h
"

313 
	~"Çn_³rsi¡’t_´e_12_šl.h
"

316 
Çme¥aû
 
	gimp
 {

317 cÚ¡ 
size_t
 
	gkMaxL’gth
 = 0x3fffffff;

320 #ià
NODE_MAJOR_VERSION
 > 0 || \

321 
	gNODE_MINOR_VERSION
 > 10 || \

322 
	gNODE_MINOR_VERSION
 =ğ10 && 
NODE_PATCH_VERSION
 >= 29 || \

323 
NODE_MINOR_VERSION
 =ğ8 && 
NODE_PATCH_VERSION
 >= 27

324 cÚ¡ 
kR•ÏûInv®idUtf8
 = 
v8
::
SŒšg
::
REPLACE_INVALID_UTF8
;

326 cÚ¡ 
	gkR•ÏûInv®idUtf8
 = 0;

332 şas 
	cHªdËScİe
 {

333 
	gv8
::
HªdËScİe
 
scİe
;

335 
	gpublic
:

336 #ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


337 
šlše
 
HªdËScİe
(è: 
scİe
(
v8
::
IsŞ©e
::
G‘Cu¼’t
()) {}

338 
šlše
 
Numb”OfHªdËs
() {

339  
v8
::
HªdËScİe
::
Numb”OfHªdËs
(v8::
IsŞ©e
::
G‘Cu¼’t
());

342 
šlše
 
HªdËScİe
(è: 
scİe
() {}

343 
šlše
 
Numb”OfHªdËs
() {

344  
v8
::
HªdËScİe
::
Numb”OfHªdËs
();

348 
	g´iv©e
:

351 
HªdËScİe
(const HandleScope &);

352 
	gİ”©Ü
=(cÚ¡ 
HªdËScİe
 &);

353 *
İ”©Ü
 
Ãw
(
size_t
 
size
);

354 
İ”©Ü
 
d–‘e
(*, 
size_t
) {

355 
abÜt
();

359 şas 
	cEsÿ·bËHªdËScİe
 {

360 
	gpublic
:

361 #ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


362 
šlše
 
Esÿ·bËHªdËScİe
(è: 
scİe
(
v8
::
IsŞ©e
::
G‘Cu¼’t
()) {}

364 
šlše
 
Numb”OfHªdËs
() {

365  
v8
::
Esÿ·bËHªdËScİe
::
Numb”OfHªdËs
(v8::
IsŞ©e
::
G‘Cu¼’t
());

368 
	g‹m¶©e
<
ty³Çme
 
	gT
>

369 
šlše
 
	gv8
::
Loÿl
<
T
> 
Esÿ³
(
v8
::Loÿl<T> 
v®ue
) {

370  
scİe
.
Esÿ³
(
v®ue
);

373 
	g´iv©e
:

374 
v8
::
Esÿ·bËHªdËScİe
 
scİe
;

376 
šlše
 
Esÿ·bËHªdËScİe
(è: 
scİe
() {}

378 
šlše
 
Numb”OfHªdËs
() {

379  
v8
::
HªdËScİe
::
Numb”OfHªdËs
();

382 
	g‹m¶©e
<
ty³Çme
 
	gT
>

383 
šlše
 
	gv8
::
Loÿl
<
T
> 
Esÿ³
(
v8
::Loÿl<T> 
v®ue
) {

384  
scİe
.
Clo£
(
v®ue
);

387 
	g´iv©e
:

388 
v8
::
HªdËScİe
 
scİe
;

391 
	g´iv©e
:

394 
Esÿ·bËHªdËScİe
(const EscapableHandleScope &);

395 
	gİ”©Ü
=(cÚ¡ 
Esÿ·bËHªdËScİe
 &);

396 *
İ”©Ü
 
Ãw
(
size_t
 
size
);

397 
İ”©Ü
 
d–‘e
(*, 
size_t
) {

398 
abÜt
();

404 şas 
	cTryC©ch
 {

405 
	gv8
::
TryC©ch
 
Œy_ÿtch_
;

406 
ä›nd
 
F©®Exû±iÚ
(cÚ¡ 
TryC©ch
&);

408 
	gpublic
:

409 #ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


410 
TryC©ch
(è: 
Œy_ÿtch_
(
v8
::
IsŞ©e
::
G‘Cu¼’t
()) {}

413 
šlše
 
boŞ
 
HasCaught
(ècÚ¡ {  
Œy_ÿtch_
.HasCaught(); }

415 
šlše
 
boŞ
 
CªCÚtšue
(ècÚ¡ {  
	gŒy_ÿtch_
.CanContinue(); }

417 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
ReThrow
() {

418 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


419  
New
(
Œy_ÿtch_
.
ReThrow
());

421  
	gŒy_ÿtch_
.
ReThrow
();

425 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
Exû±iÚ
() const {

426  
Œy_ÿtch_
.
Exû±iÚ
();

429 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

430 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

431 
šlše
 
v8
::
MaybeLoÿl
<v8::
V®ue
> 
SckT¿û
() const {

432 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

433 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

434  
	gscİe
.
Esÿ³
(
Œy_ÿtch_
.
SckT¿û
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

435 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

438 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
SckT¿û
() const {

439  
Œy_ÿtch_
.
SckT¿û
();

443 
šlše
 
	gv8
::
Loÿl
<
v8
::
Mes§ge
> Message() const {

444  
Œy_ÿtch_
.
Mes§ge
();

447 
šlše
 
Re£t
(è{ 
	gŒy_ÿtch_
.Reset(); }

449 
šlše
 
S‘V”bo£
(
boŞ
 
v®ue
è{ 
	gŒy_ÿtch_
.SetVerbose(value); }

451 
šlše
 
S‘C­tu»Mes§ge
(
boŞ
 
v®ue
) {

452 
	gŒy_ÿtch_
.
S‘C­tu»Mes§ge
(
v®ue
);

459 #ià
NODE_MODULE_VERSION
 >ğ
NODE_0_12_MODULE_VERSION


460 
šlše


461 
	$S‘CouÁ”FunùiÚ
(
v8
::
CouÁ”LookupC®lback
 
cb
) {

462 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`S‘CouÁ”FunùiÚ
(
cb
);

463 
	}
}

465 
šlše


466 
	$S‘C»©eHi¡og¿mFunùiÚ
(
v8
::
C»©eHi¡og¿mC®lback
 
cb
) {

467 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`S‘C»©eHi¡og¿mFunùiÚ
(
cb
);

468 
	}
}

470 
šlše


471 
	$S‘AddHi¡og¿mSam¶eFunùiÚ
(
v8
::
AddHi¡og¿mSam¶eC®lback
 
cb
) {

472 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`S‘AddHi¡og¿mSam¶eFunùiÚ
(
cb
);

473 
	}
}

475 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

476 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

477 
šlše
 
boŞ
 
	$IdËNÙifiÿtiÚ
(
idË_time_š_ms
) {

478  
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`IdËNÙifiÿtiÚD—dlše
(

479 
idË_time_š_ms
 * 0.001);

480 
	}
}

482 
šlše
 
boŞ
 
	$IdËNÙifiÿtiÚ
(
idË_time_š_ms
) {

483  
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`IdËNÙifiÿtiÚ
(
idË_time_š_ms
);

484 
	}
}

487 
šlše
 
	$LowMemÜyNÙifiÿtiÚ
() {

488 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`LowMemÜyNÙifiÿtiÚ
();

489 
	}
}

491 
šlše
 
	$CÚ‹xtDi¥o£dNÙifiÿtiÚ
() {

492 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`CÚ‹xtDi¥o£dNÙifiÿtiÚ
();

493 
	}
}

495 
šlše


496 
	$S‘CouÁ”FunùiÚ
(
v8
::
CouÁ”LookupC®lback
 
cb
) {

497 
v8
::
V8
::
	`S‘CouÁ”FunùiÚ
(
cb
);

498 
	}
}

500 
šlše


501 
	$S‘C»©eHi¡og¿mFunùiÚ
(
v8
::
C»©eHi¡og¿mC®lback
 
cb
) {

502 
v8
::
V8
::
	`S‘C»©eHi¡og¿mFunùiÚ
(
cb
);

503 
	}
}

505 
šlše


506 
	$S‘AddHi¡og¿mSam¶eFunùiÚ
(
v8
::
AddHi¡og¿mSam¶eC®lback
 
cb
) {

507 
v8
::
V8
::
	`S‘AddHi¡og¿mSam¶eFunùiÚ
(
cb
);

508 
	}
}

510 
šlše
 
boŞ
 
	$IdËNÙifiÿtiÚ
(
idË_time_š_ms
) {

511  
v8
::
V8
::
	`IdËNÙifiÿtiÚ
(
idË_time_š_ms
);

512 
	}
}

514 
šlše
 
	$LowMemÜyNÙifiÿtiÚ
() {

515 
v8
::
V8
::
	`LowMemÜyNÙifiÿtiÚ
();

516 
	}
}

518 
šlše
 
	$CÚ‹xtDi¥o£dNÙifiÿtiÚ
() {

519 
v8
::
V8
::
	`CÚ‹xtDi¥o£dNÙifiÿtiÚ
();

520 
	}
}

523 #ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

524 
šlše
 
	gv8
::
Loÿl
<
v8
::
Prim™ive
> 
	$Undefšed
() {

525 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


526 
Esÿ·bËHªdËScİe
 
scİe
;

527  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`Undefšed
(v8::
IsŞ©e
::
	`G‘Cu¼’t
())));

529  
v8
::
	`Undefšed
(v8::
IsŞ©e
::
	`G‘Cu¼’t
());

531 
	}
}

533 
šlše
 
	gv8
::
Loÿl
<
v8
::
Prim™ive
> 
	$NuÎ
() {

534 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


535 
Esÿ·bËHªdËScİe
 
scİe
;

536  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`NuÎ
(v8::
IsŞ©e
::
	`G‘Cu¼’t
())));

538  
v8
::
	`NuÎ
(v8::
IsŞ©e
::
	`G‘Cu¼’t
());

540 
	}
}

542 
šlše
 
	gv8
::
Loÿl
<
v8
::
BoŞ—n
> 
	$True
() {

543 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


544 
Esÿ·bËHªdËScİe
 
scİe
;

545  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`True
(v8::
IsŞ©e
::
	`G‘Cu¼’t
())));

547  
v8
::
	`True
(v8::
IsŞ©e
::
	`G‘Cu¼’t
());

549 
	}
}

551 
šlše
 
	gv8
::
Loÿl
<
v8
::
BoŞ—n
> 
	$F®£
() {

552 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


553 
Esÿ·bËHªdËScİe
 
scİe
;

554  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`F®£
(v8::
IsŞ©e
::
	`G‘Cu¼’t
())));

556  
v8
::
	`F®£
(v8::
IsŞ©e
::
	`G‘Cu¼’t
());

558 
	}
}

560 
šlše
 
	gv8
::
Loÿl
<
v8
::
SŒšg
> 
	$Em±ySŒšg
() {

561  
v8
::
SŒšg
::
	`Em±y
(v8::
IsŞ©e
::
	`G‘Cu¼’t
());

562 
	}
}

564 
šlše
 
	$Adju¡Ex‹º®MemÜy
(
bc
) {

565  
¡©ic_ÿ¡
<>(

566 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`Adju¡AmouÁOfEx‹º®AÎoÿ‹dMemÜy
(
bc
));

567 
	}
}

569 
šlše
 
S‘Tem¶©e
(

570 
v8
::
Loÿl
<v8::
Tem¶©e
> 
‹m¶


571 , cÚ¡ *
Çme


572 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue
) {

573 
‹m¶
->
S‘
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
Çme
, 
v®ue
);

576 
šlše
 
S‘Tem¶©e
(

577 
v8
::
Loÿl
<v8::
Tem¶©e
> 
‹m¶


578 , 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme


579 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue


580 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibu‹s
) {

581 
‹m¶
->
S‘
(
Çme
, 
v®ue
, 
©Œibu‹s
);

584 
šlše
 
	gv8
::
Loÿl
<
v8
::
CÚ‹xt
> 
	$G‘Cu¼’tCÚ‹xt
() {

585  
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`G‘Cu¼’tCÚ‹xt
();

586 
	}
}

588 
šlše
 * 
G‘IÁ”ÇlF›ldPoš‹r
(

589 
v8
::
Loÿl
<v8::
Objeù
> 
objeù


590 , 
šdex
) {

591  
	gobjeù
->
G‘AligÃdPoš‹rFromIÁ”ÇlF›ld
(
šdex
);

594 
šlše
 
S‘IÁ”ÇlF›ldPoš‹r
(

595 
v8
::
Loÿl
<v8::
Objeù
> 
objeù


596 , 
šdex


597 , * 
v®ue
) {

598 
	gobjeù
->
S‘AligÃdPoš‹rInIÁ”ÇlF›ld
(
šdex
, 
v®ue
);

601 
	#NAN_GC_CALLBACK
(
Çme
) \

602 
	$Çme
(
v8
::
IsŞ©e
 *
isŞ©e
, v8::
GCTy³
 
ty³
, v8::
GCC®lbackFÏgs
 
æags
)

	)

604 #ià
NODE_MODULE_VERSION
 <ğ
NODE_4_0_MODULE_VERSION


605 
v8
::
	tIsŞ©e
::
	tGCEpogueC®lback
 GCEpilogueCallback;

606 
v8
::
	tIsŞ©e
::
	tGCPrŞogueC®lback
 GCPrologueCallback;

608 
v8
::
	tIsŞ©e
::
	tGCC®lback
 
	tGCEpogueC®lback
;

609 
v8
::
	tIsŞ©e
::
	tGCC®lback
 
	tGCPrŞogueC®lback
;

612 
šlše
 
	$AddGCEpogueC®lback
(

613 
GCEpogueC®lback
 
ÿÎback


614 , 
v8
::
GCTy³
 
gc_ty³_f‹r
 = v8::
kGCTy³AÎ
) {

615 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`AddGCEpogueC®lback
(
ÿÎback
, 
gc_ty³_f‹r
);

616 
	}
}

618 
šlše
 
	$RemoveGCEpogueC®lback
(

619 
GCEpogueC®lback
 
ÿÎback
) {

620 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`RemoveGCEpogueC®lback
(
ÿÎback
);

621 
	}
}

623 
šlše
 
	$AddGCPrŞogueC®lback
(

624 
GCPrŞogueC®lback
 
ÿÎback


625 , 
v8
::
GCTy³
 
gc_ty³_f‹r
 = v8::
kGCTy³AÎ
) {

626 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`AddGCPrŞogueC®lback
(
ÿÎback
, 
gc_ty³_f‹r
);

627 
	}
}

629 
šlše
 
	$RemoveGCPrŞogueC®lback
(

630 
GCPrŞogueC®lback
 
ÿÎback
) {

631 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`RemoveGCPrŞogueC®lback
(
ÿÎback
);

632 
	}
}

634 
šlše
 
	$G‘H—pSti¡ics
(

635 
v8
::
H—pSti¡ics
 *
h—p_¡©i¡ics
) {

636 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`G‘H—pSti¡ics
(
h—p_¡©i¡ics
);

637 
	}
}

639 
	#X
(
NAME
) \

640 
šlše
 
v8
::
Loÿl
<v8::
V®ue
> 
	$NAME
(cÚ¡ *
msg
) { \

641 
Esÿ·bËHªdËScİe
 
scİe
; \

642  
scİe
.
	`Esÿ³
(
v8
::
Exû±iÚ
::
	`NAME
(
	`New
(
msg
).
	`ToLoÿlChecked
())); \

643 
	}
} \

645 
šlše
 \

646 
v8
::
Loÿl
<v8::
V®ue
> 
	`NAME
(v8::Loÿl<v8::
SŒšg
> 
msg
) { \

647  
v8
::
Exû±iÚ
::
	`NAME
(
msg
); \

650 
šlše
 
Throw
 ## 
	$NAME
(cÚ¡ *
msg
) { \

651 
HªdËScİe
 
scİe
; \

652 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`ThrowExû±iÚ
( \

653 
v8
::
Exû±iÚ
::
	`NAME
(
	`New
(
msg
).
	`ToLoÿlChecked
())); \

654 
	}
} \

656 
šlše
 
Throw
 ## 
	`NAME
(
v8
::
Loÿl
<v8::
SŒšg
> 
msg
) { \

657 
HªdËScİe
 
scİe
; \

658 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`ThrowExû±iÚ
( \

659 
v8
::
Exû±iÚ
::
	`NAME
(
msg
)); \

660 }

	)

662 
	$X
(
E¼Ü
)

663 
	$X
(
RªgeE¼Ü
)

664 
	$X
(
Reã»nûE¼Ü
)

665 
	$X
(
SyÁaxE¼Ü
)

666 
	$X
(
Ty³E¼Ü
)

668 #undeà
X


670 
šlše
 
	`ThrowE¼Ü
(
v8
::
Loÿl
<v8::
V®ue
> 
”rÜ
) {

671 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`ThrowExû±iÚ
(
”rÜ
);

672 
	}
}

674 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
NewBufãr
(

675 *
d©a


676 , 
size_t
 
Ëngth


677 #ià
NODE_MODULE_VERSION
 > 
IOJS_2_0_MODULE_VERSION


678 , 
node
::
Bufãr
::
F»eC®lback
 
ÿÎback


680 , 
node
::
sm®loc
::
F»eC®lback
 
ÿÎback


682 , *
hšt


686 
as£¹
(
Ëngth
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

687 #ià
NODE_MODULE_VERSION
 > 
IOJS_2_0_MODULE_VERSION


688  
	gnode
::
Bufãr
::
New
(

689 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
d©a
, 
Ëngth
, 
ÿÎback
, 
hšt
);

691  
	gnode
::
Bufãr
::
New
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
d©a
, 
Ëngth
, 
ÿÎback
,

692 
hšt
);

696 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
	$CİyBufãr
(

697 cÚ¡ *
d©a


698 , 
ušt32_t
 
size


702 
	`as£¹
(
size
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

703 #ià
NODE_MODULE_VERSION
 > 
IOJS_2_0_MODULE_VERSION


704  
node
::
Bufãr
::
	`Cİy
(

705 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
d©a
, 
size
);

707  
node
::
Bufãr
::
	`New
(
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
d©a
, 
size
);

709 
	}
}

711 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
	$NewBufãr
(
ušt32_t
 
size
) {

714 
	`as£¹
(
size
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

715 #ià
NODE_MODULE_VERSION
 > 
IOJS_2_0_MODULE_VERSION


716  
node
::
Bufãr
::
	`New
(

717 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
size
);

719  
node
::
Bufãr
::
	`New
(
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
size
);

721 
	}
}

723 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
	$NewBufãr
(

724 * 
d©a


725 , 
ušt32_t
 
size


729 
	`as£¹
(
size
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

730 #ià
NODE_MODULE_VERSION
 > 
IOJS_2_0_MODULE_VERSION


731  
node
::
Bufãr
::
	`New
(
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
d©a
, 
size
);

733  
node
::
Bufãr
::
	`U£
(
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
d©a
, 
size
);

735 
	}
}

737 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

738 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

739 
šlše
 
MaybeLoÿl
<
v8
::
SŒšg
>

740 
NewOÃBy‹SŒšg
(cÚ¡ 
ušt8_t
 * 
v®ue
, 
Ëngth
 = -1) {

741  
v8
::
SŒšg
::
NewFromOÃBy‹
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
,

742 
v8
::
NewSŒšgTy³
::
kNÜm®
, 
Ëngth
);

745 
šlše
 
	gMaybeLoÿl
<
	gBoundSüt
> 
CompeSüt
(

746 
v8
::
Loÿl
<v8::
SŒšg
> 
s


747 , cÚ¡ 
v8
::
SütOrigš
& 
Üigš


749 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

750 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

751 
	gv8
::
SütComp”
::
Sourû
 
sourû
(
s
, 
Üigš
);

752  
	gscİe
.
Esÿ³
(

753 
v8
::
SütComp”
::
Compe
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), &
sourû
)

754 .
FromMaybe
(
v8
::
Loÿl
<
BoundSüt
>()));

757 
šlše
 
	gMaybeLoÿl
<
	gBoundSüt
> 
CompeSüt
(

758 
v8
::
Loÿl
<v8::
SŒšg
> 
s


760 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

761 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

762 
	gv8
::
SütComp”
::
Sourû
 
sourû
(
s
);

763  
	gscİe
.
Esÿ³
(

764 
v8
::
SütComp”
::
Compe
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), &
sourû
)

765 .
FromMaybe
(
v8
::
Loÿl
<
BoundSüt
>()));

768 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
RunSüt
(

769 
v8
::
Loÿl
<
UnboundSüt
> 
süt


771 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

772 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

773  
	gscİe
.
Esÿ³
(
süt
->
BšdToCu¼’tCÚ‹xt
()

774 ->
Run
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

775 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

778 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
RunSüt
(

779 
v8
::
Loÿl
<
BoundSüt
> 
süt


781 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

782 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

783  
	gscİe
.
Esÿ³
(
süt
->
Run
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

784 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

787 
šlše
 
	gMaybeLoÿl
<
	gv8
::
SŒšg
>

788 
NewOÃBy‹SŒšg
(cÚ¡ 
ušt8_t
 * 
v®ue
, 
Ëngth
 = -1) {

789  
v8
::
SŒšg
::
NewFromOÃBy‹
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
,

790 
v8
::
SŒšg
::
kNÜm®SŒšg
, 
Ëngth
);

793 
šlše
 
	gMaybeLoÿl
<
	gBoundSüt
> 
CompeSüt
(

794 
v8
::
Loÿl
<v8::
SŒšg
> 
s


795 , cÚ¡ 
v8
::
SütOrigš
& 
Üigš


797 
v8
::
SütComp”
::
Sourû
 
sourû
(
s
, 
Üigš
);

798  
	gv8
::
SütComp”
::
Compe
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
sourû
);

801 
šlše
 
	gMaybeLoÿl
<
	gBoundSüt
> 
CompeSüt
(

802 
v8
::
Loÿl
<v8::
SŒšg
> 
s


804 
v8
::
SütComp”
::
Sourû
 
sourû
(
s
);

805  
	gv8
::
SütComp”
::
Compe
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
sourû
);

808 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
RunSüt
(

809 
v8
::
Loÿl
<
UnboundSüt
> 
süt


811 
Esÿ·bËHªdËScİe
 
scİe
;

812  
	gscİe
.
Esÿ³
(
süt
->
BšdToCu¼’tCÚ‹xt
()->
Run
());

815 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
RunSüt
(

816 
v8
::
Loÿl
<
BoundSüt
> 
süt


818  
süt
->
Run
();

822 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
MakeC®lback
(

823 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


824 , 
v8
::
Loÿl
<v8::
FunùiÚ
> 
func


825 , 
¬gc


826 , 
v8
::
Loÿl
<v8::
V®ue
>* 
¬gv
) {

827 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


828 
Esÿ·bËHªdËScİe
 
scİe
;

829  
	gscİe
.
Esÿ³
(
New
(
node
::
MakeC®lback
(

830 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
rg‘
, 
func
, 
¬gc
, 
¬gv
)));

832  
	gnode
::
MakeC®lback
(

833 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
rg‘
, 
func
, 
¬gc
, 
¬gv
);

837 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
MakeC®lback
(

838 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


839 , 
v8
::
Loÿl
<v8::
SŒšg
> 
symbŞ


840 , 
¬gc


841 , 
v8
::
Loÿl
<v8::
V®ue
>* 
¬gv
) {

842 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


843 
Esÿ·bËHªdËScİe
 
scİe
;

844  
	gscİe
.
Esÿ³
(
New
(
node
::
MakeC®lback
(

845 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
rg‘
, 
symbŞ
, 
¬gc
, 
¬gv
)));

847  
	gnode
::
MakeC®lback
(

848 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
rg‘
, 
symbŞ
, 
¬gc
, 
¬gv
);

852 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
MakeC®lback
(

853 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


854 , cÚ¡ * 
m‘hod


855 , 
¬gc


856 , 
v8
::
Loÿl
<v8::
V®ue
>* 
¬gv
) {

857 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


858 
Esÿ·bËHªdËScİe
 
scİe
;

859  
	gscİe
.
Esÿ³
(
New
(
node
::
MakeC®lback
(

860 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
rg‘
, 
m‘hod
, 
¬gc
, 
¬gv
)));

862  
	gnode
::
MakeC®lback
(

863 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
rg‘
, 
m‘hod
, 
¬gc
, 
¬gv
);

867 
šlše
 
	$F©®Exû±iÚ
(cÚ¡ 
TryC©ch
& 
Œy_ÿtch
) {

868 
node
::
	`F©®Exû±iÚ
(
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
Œy_ÿtch
.
Œy_ÿtch_
);

869 
	}
}

871 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$E¼noExû±iÚ
(

872 
”rÜno


873 , cÚ¡ * 
sysÿÎ
 = 
NULL


874 , cÚ¡ * 
mes§ge
 = 
NULL


875 , cÚ¡ * 
·th
 = 
NULL
) {

876  
node
::
	`E¼noExû±iÚ
(
v8
::
IsŞ©e
::
	`G‘Cu¼’t
(), 
”rÜno
, 
sysÿÎ
,

877 
mes§ge
, 
·th
);

878 
	}
}

880 
NAN_DEPRECATED
 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$NªE¼noExû±iÚ
(

881 
”rÜno


882 , cÚ¡ * 
sysÿÎ
 = 
NULL


883 , cÚ¡ * 
mes§ge
 = 
NULL


884 , cÚ¡ * 
·th
 = 
NULL
) {

885  
	`E¼noExû±iÚ
(
”rÜno
, 
sysÿÎ
, 
mes§ge
, 
·th
);

886 
	}
}

888 
	g‹m¶©e
<
ty³Çme
 
	gT
>

889 
šlše
 
	$S‘IsŞ©eD©a
(

890 
v8
::
IsŞ©e
 *
isŞ©e


891 , 
T
 *
d©a


893 
isŞ©e
->
	`S‘D©a
(0, 
d©a
);

894 
	}
}

896 
	g‹m¶©e
<
ty³Çme
 
	gT
>

897 
šlše
 
T
 *
	$G‘IsŞ©eD©a
(

898 
v8
::
IsŞ©e
 *
isŞ©e


900  
¡©ic_ÿ¡
<
T
*>(
isŞ©e
->
	`G‘D©a
(0));

901 
	}
}

903 şas 
	cUtf8SŒšg
 {

904 
	gpublic
:

905 
šlše
 
ex¶ic™
 
Utf8SŒšg
(
v8
::
Loÿl
<v8::
V®ue
> 
äom
) :

906 
Ëngth_
(0), 
¡r_
(
¡r_¡_
) {

907 
HªdËScİe
 
	gscİe
;

908 ià(!
	gäom
.
IsEm±y
()) {

909 
	gv8
::
Loÿl
<
v8
::
SŒšg
> 
¡ršg
 = 
äom
->
ToSŒšg
();

910 ià(!
	g¡ršg
.
IsEm±y
()) {

911 
size_t
 
	gËn
 = 3 * 
¡ršg
->
L’gth
() + 1;

912 
as£¹
(
Ën
 <ğ
INT_MAX
);

913 ià(
	gËn
 >  (
	g¡r_¡_
)) {

914 
	g¡r_
 = 
¡©ic_ÿ¡
<*>(
m®loc
(
Ën
));

915 
as£¹
(
¡r_
 != 0);

917 cÚ¡ 
	gæags
 =

918 
v8
::
SŒšg
::
NO_NULL_TERMINATION
 | 
imp
::
kR•ÏûInv®idUtf8
;

919 
	gËngth_
 = 
¡ršg
->
Wr™eUtf8
(
¡r_
, 
¡©ic_ÿ¡
<>(
Ën
), 0, 
æags
);

920 
	g¡r_
[
Ëngth_
] = '\0';

925 
šlše
 
Ëngth
() const {

926  
	gËngth_
;

929 
šlše
 * 
	gİ”©Ü
*(è{  
	g¡r_
; }

930 
šlše
 cÚ¡ * 
	gİ”©Ü
*(ècÚ¡ {  
	g¡r_
; }

932 
	gšlše
 ~
Utf8SŒšg
() {

933 ià(
	g¡r_
 !ğ
¡r_¡_
) {

934 
ä“
(
¡r_
);

938 
	g´iv©e
:

939 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
Utf8SŒšg
)

941 
Ëngth_
;

942 *
	g¡r_
;

943 
	g¡r_¡_
[1024];

947 
šlše
 
	gv8
::
Loÿl
<
v8
::
Prim™ive
> 
	$Undefšed
() {

948 
Esÿ·bËHªdËScİe
 
scİe
;

949  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`Undefšed
()));

950 
	}
}

952 
šlše
 
	gv8
::
Loÿl
<
v8
::
Prim™ive
> 
	$NuÎ
() {

953 
Esÿ·bËHªdËScİe
 
scİe
;

954  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`NuÎ
()));

955 
	}
}

957 
šlše
 
	gv8
::
Loÿl
<
v8
::
BoŞ—n
> 
	$True
() {

958 
Esÿ·bËHªdËScİe
 
scİe
;

959  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`True
()));

960 
	}
}

962 
šlše
 
	gv8
::
Loÿl
<
v8
::
BoŞ—n
> 
	$F®£
() {

963 
Esÿ·bËHªdËScİe
 
scİe
;

964  
scİe
.
	`Esÿ³
(
	`New
(
v8
::
	`F®£
()));

965 
	}
}

967 
šlše
 
	gv8
::
Loÿl
<
v8
::
SŒšg
> 
	$Em±ySŒšg
() {

968  
v8
::
SŒšg
::
	`Em±y
();

969 
	}
}

971 
šlše
 
	$Adju¡Ex‹º®MemÜy
(
bc
) {

972  
¡©ic_ÿ¡
<>(
v8
::
V8
::
	`Adju¡AmouÁOfEx‹º®AÎoÿ‹dMemÜy
(
bc
));

973 
	}
}

975 
šlše
 
S‘Tem¶©e
(

976 
v8
::
Loÿl
<v8::
Tem¶©e
> 
‹m¶


977 , cÚ¡ *
Çme


978 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue
) {

979 
‹m¶
->
S‘
(
Çme
, 
v®ue
);

982 
šlše
 
S‘Tem¶©e
(

983 
v8
::
Loÿl
<v8::
Tem¶©e
> 
‹m¶


984 , 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme


985 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue


986 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibu‹s
) {

987 
‹m¶
->
S‘
(
Çme
, 
v®ue
, 
©Œibu‹s
);

990 
šlše
 
	gv8
::
Loÿl
<
v8
::
CÚ‹xt
> 
	$G‘Cu¼’tCÚ‹xt
() {

991  
v8
::
CÚ‹xt
::
	`G‘Cu¼’t
();

992 
	}
}

994 
šlše
 * 
G‘IÁ”ÇlF›ldPoš‹r
(

995 
v8
::
Loÿl
<v8::
Objeù
> 
objeù


996 , 
šdex
) {

997  
	gobjeù
->
G‘Poš‹rFromIÁ”ÇlF›ld
(
šdex
);

1000 
šlše
 
S‘IÁ”ÇlF›ldPoš‹r
(

1001 
v8
::
Loÿl
<v8::
Objeù
> 
objeù


1002 , 
šdex


1003 , * 
v®ue
) {

1004 
	gobjeù
->
S‘Poš‹rInIÁ”ÇlF›ld
(
šdex
, 
v®ue
);

1007 
	#NAN_GC_CALLBACK
(
Çme
) \

1008 
	$Çme
(
v8
::
GCTy³
 
ty³
, v8::
GCC®lbackFÏgs
 
æags
)

	)

1010 
šlše
 
	$AddGCEpogueC®lback
(

1011 
v8
::
GCEpogueC®lback
 
ÿÎback


1012 , 
v8
::
GCTy³
 
gc_ty³_f‹r
 = v8::
kGCTy³AÎ
) {

1013 
v8
::
V8
::
	`AddGCEpogueC®lback
(
ÿÎback
, 
gc_ty³_f‹r
);

1014 
	}
}

1015 
šlše
 
	$RemoveGCEpogueC®lback
(

1016 
v8
::
GCEpogueC®lback
 
ÿÎback
) {

1017 
v8
::
V8
::
	`RemoveGCEpogueC®lback
(
ÿÎback
);

1018 
	}
}

1019 
šlše
 
	$AddGCPrŞogueC®lback
(

1020 
v8
::
GCPrŞogueC®lback
 
ÿÎback


1021 , 
v8
::
GCTy³
 
gc_ty³_f‹r
 = v8::
kGCTy³AÎ
) {

1022 
v8
::
V8
::
	`AddGCPrŞogueC®lback
(
ÿÎback
, 
gc_ty³_f‹r
);

1023 
	}
}

1024 
šlše
 
	$RemoveGCPrŞogueC®lback
(

1025 
v8
::
GCPrŞogueC®lback
 
ÿÎback
) {

1026 
v8
::
V8
::
	`RemoveGCPrŞogueC®lback
(
ÿÎback
);

1027 
	}
}

1028 
šlše
 
	$G‘H—pSti¡ics
(

1029 
v8
::
H—pSti¡ics
 *
h—p_¡©i¡ics
) {

1030 
v8
::
V8
::
	`G‘H—pSti¡ics
(
h—p_¡©i¡ics
);

1031 
	}
}

1033 
	#X
(
NAME
) \

1034 
šlše
 
v8
::
Loÿl
<v8::
V®ue
> 
	$NAME
(cÚ¡ *
msg
) { \

1035 
Esÿ·bËHªdËScİe
 
scİe
; \

1036  
scİe
.
	`Esÿ³
(
v8
::
Exû±iÚ
::
	`NAME
(
	`New
(
msg
).
	`ToLoÿlChecked
())); \

1037 
	}
} \

1039 
šlše
 \

1040 
v8
::
Loÿl
<v8::
V®ue
> 
	`NAME
(v8::Loÿl<v8::
SŒšg
> 
msg
) { \

1041  
v8
::
Exû±iÚ
::
	`NAME
(
msg
); \

1044 
šlše
 
Throw
 ## 
	$NAME
(cÚ¡ *
msg
) { \

1045 
HªdËScİe
 
scİe
; \

1046 
v8
::
	`ThrowExû±iÚ
(v8::
Exû±iÚ
::
	`NAME
(
	`New
(
msg
).
	`ToLoÿlChecked
())); \

1047 
	}
} \

1049 
šlše
 \

1050 
Throw
 ## 
	`NAME
(
v8
::
Loÿl
<v8::
SŒšg
> 
”rmsg
) { \

1051 
HªdËScİe
 
scİe
; \

1052 
v8
::
	`ThrowExû±iÚ
(v8::
Exû±iÚ
::
	`NAME
(
”rmsg
)); \

1053 }

	)

1055 
	$X
(
E¼Ü
)

1056 
	$X
(
RªgeE¼Ü
)

1057 
	$X
(
Reã»nûE¼Ü
)

1058 
	$X
(
SyÁaxE¼Ü
)

1059 
	$X
(
Ty³E¼Ü
)

1061 #undeà
X


1063 
šlše
 
	`ThrowE¼Ü
(
v8
::
Loÿl
<v8::
V®ue
> 
”rÜ
) {

1064 
v8
::
	`ThrowExû±iÚ
(
”rÜ
);

1065 
	}
}

1067 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
	$NewBufãr
(

1068 *
d©a


1069 , 
size_t
 
Ëngth


1070 , 
node
::
Bufãr
::
ä“_ÿÎback
 
ÿÎback


1071 , *
hšt


1073 
Esÿ·bËHªdËScİe
 
scİe
;

1076 
	`as£¹
(
Ëngth
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

1077  
scİe
.
	`Esÿ³
(

1078 
	`New
(
node
::
Bufãr
::New(
d©a
, 
Ëngth
, 
ÿÎback
, 
hšt
)->
hªdË_
));

1079 
	}
}

1081 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
	$CİyBufãr
(

1082 cÚ¡ *
d©a


1083 , 
ušt32_t
 
size


1085 
Esÿ·bËHªdËScİe
 
scİe
;

1088 
	`as£¹
(
size
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

1089 #ià
NODE_MODULE_VERSION
 >ğ
NODE_0_10_MODULE_VERSION


1090  
scİe
.
	`Esÿ³
(
	`New
(
node
::
Bufãr
::New(
d©a
, 
size
)->
hªdË_
));

1092  
scİe
.
	`Esÿ³
(

1093 
	`New
(
node
::
Bufãr
::New(
cÚ¡_ÿ¡
<*>(
d©a
), 
size
)->
hªdË_
));

1095 
	}
}

1097 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
	$NewBufãr
(
ušt32_t
 
size
) {

1100 
Esÿ·bËHªdËScİe
 
scİe
;

1101 
	`as£¹
(
size
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

1102  
scİe
.
	`Esÿ³
(
	`New
(
node
::
Bufãr
::New(
size
)->
hªdË_
));

1103 
	}
}

1105 
šlše
 
	$F»eD©a
(*
d©a
, *
hšt
) {

1106 (è
hšt
;

1107 
d–‘e
[] 
d©a
;

1108 
	}
}

1110 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
	$NewBufãr
(

1111 * 
d©a


1112 , 
ušt32_t
 
size


1114 
Esÿ·bËHªdËScİe
 
scİe
;

1117 
	`as£¹
(
size
 <ğ
imp
::
kMaxL’gth
 && "too†arge buffer");

1118  
scİe
.
	`Esÿ³
(

1119 
	`New
(
node
::
Bufãr
::New(
d©a
, 
size
, 
F»eD©a
, 
NULL
)->
hªdË_
));

1120 
	}
}

1122 
Çme¥aû
 
	gimp
 {

1123 
šlše
 

1124 
wid’SŒšg
(
¡d
::
veùÜ
<
ušt16_t
> *
ws
, cÚ¡ 
ušt8_t
 *
s
, 
l
) {

1125 
size_t
 
	gËn
 = 
¡©ic_ÿ¡
<size_t>(
l
);

1126 ià(
	gl
 < 0) {

1127 
	gËn
 = 
¡¾’
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
));

1129 
as£¹
(
Ën
 <ğ
INT_MAX
 && "stringoo†ong");

1130 
	gws
->
»size
(
Ën
);

1131 
	g¡d
::
cİy
(
s
, s + 
Ën
, 
ws
->
begš
());

1135 
šlše
 
	gMaybeLoÿl
<
	gv8
::
SŒšg
>

1136 
NewOÃBy‹SŒšg
(cÚ¡ 
ušt8_t
 * 
v®ue
, 
Ëngth
 = -1) {

1137 
¡d
::
veùÜ
<
ušt16_t
> 
wideSŒšg
;

1138 
	gimp
::
wid’SŒšg
(&
wideSŒšg
, 
v®ue
, 
Ëngth
);

1139  
	gv8
::
SŒšg
::
New
(
wideSŒšg
.
d©a
(),

1140 
¡©ic_ÿ¡
<>(
wideSŒšg
.
size
()));

1143 
šlše
 
	gMaybeLoÿl
<
	gBoundSüt
> 
CompeSüt
(

1144 
v8
::
Loÿl
<v8::
SŒšg
> 
s


1145 , cÚ¡ 
v8
::
SütOrigš
& 
Üigš


1147  
v8
::
Süt
::
Compe
(
s
, 
cÚ¡_ÿ¡
<v8::
SütOrigš
 *>(&
Üigš
));

1150 
šlše
 
	gMaybeLoÿl
<
	gBoundSüt
> 
CompeSüt
(

1151 
v8
::
Loÿl
<v8::
SŒšg
> 
s


1153  
v8
::
Süt
::
Compe
(
s
);

1156 
šlše


1157 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
RunSüt
(
v8
::
Loÿl
<v8::
Süt
> 
süt
) {

1158  
süt
->
Run
();

1161 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
MakeC®lback
(

1162 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


1163 , 
v8
::
Loÿl
<v8::
FunùiÚ
> 
func


1164 , 
¬gc


1165 , 
v8
::
Loÿl
<v8::
V®ue
>* 
¬gv
) {

1166 
v8
::
HªdËScİe
 
scİe
;

1167  
	gscİe
.
Clo£
(
New
(
node
::
MakeC®lback
(
rg‘
, 
func
, 
¬gc
, 
¬gv
)));

1170 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
MakeC®lback
(

1171 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


1172 , 
v8
::
Loÿl
<v8::
SŒšg
> 
symbŞ


1173 , 
¬gc


1174 , 
v8
::
Loÿl
<v8::
V®ue
>* 
¬gv
) {

1175 
v8
::
HªdËScİe
 
scİe
;

1176  
	gscİe
.
Clo£
(
New
(
node
::
MakeC®lback
(
rg‘
, 
symbŞ
, 
¬gc
, 
¬gv
)));

1179 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
MakeC®lback
(

1180 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


1181 , cÚ¡ * 
m‘hod


1182 , 
¬gc


1183 , 
v8
::
Loÿl
<v8::
V®ue
>* 
¬gv
) {

1184 
v8
::
HªdËScİe
 
scİe
;

1185  
	gscİe
.
Clo£
(
New
(
node
::
MakeC®lback
(
rg‘
, 
m‘hod
, 
¬gc
, 
¬gv
)));

1188 
šlše
 
	$F©®Exû±iÚ
(cÚ¡ 
TryC©ch
& 
Œy_ÿtch
) {

1189 
node
::
	`F©®Exû±iÚ
(
cÚ¡_ÿ¡
<
v8
::
TryC©ch
 &>(
Œy_ÿtch
.
Œy_ÿtch_
));

1190 
	}
}

1192 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$E¼noExû±iÚ
(

1193 
”rÜno


1194 , cÚ¡ * 
sysÿÎ
 = 
NULL


1195 , cÚ¡ * 
mes§ge
 = 
NULL


1196 , cÚ¡ * 
·th
 = 
NULL
) {

1197  
node
::
	`E¼noExû±iÚ
(
”rÜno
, 
sysÿÎ
, 
mes§ge
, 
·th
);

1198 
	}
}

1200 
NAN_DEPRECATED
 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$NªE¼noExû±iÚ
(

1201 
”rÜno


1202 , cÚ¡ * 
sysÿÎ
 = 
NULL


1203 , cÚ¡ * 
mes§ge
 = 
NULL


1204 , cÚ¡ * 
·th
 = 
NULL
) {

1205  
	`E¼noExû±iÚ
(
”rÜno
, 
sysÿÎ
, 
mes§ge
, 
·th
);

1206 
	}
}

1209 
	g‹m¶©e
<
ty³Çme
 
	gT
>

1210 
šlše
 
	$S‘IsŞ©eD©a
(

1211 
v8
::
IsŞ©e
 *
isŞ©e


1212 , 
T
 *
d©a


1214 
isŞ©e
->
	`S‘D©a
(
d©a
);

1215 
	}
}

1217 
	g‹m¶©e
<
ty³Çme
 
	gT
>

1218 
šlše
 
T
 *
	$G‘IsŞ©eD©a
(

1219 
v8
::
IsŞ©e
 *
isŞ©e


1221  
¡©ic_ÿ¡
<
T
*>(
isŞ©e
->
	`G‘D©a
());

1222 
	}
}

1224 şas 
	cUtf8SŒšg
 {

1225 
	gpublic
:

1226 
šlše
 
ex¶ic™
 
Utf8SŒšg
(
v8
::
Loÿl
<v8::
V®ue
> 
äom
) :

1227 
Ëngth_
(0), 
¡r_
(
¡r_¡_
) {

1228 
	gv8
::
HªdËScİe
 
scİe
;

1229 ià(!
	gäom
.
IsEm±y
()) {

1230 
	gv8
::
Loÿl
<
v8
::
SŒšg
> 
¡ršg
 = 
äom
->
ToSŒšg
();

1231 ià(!
	g¡ršg
.
IsEm±y
()) {

1232 
size_t
 
	gËn
 = 3 * 
¡ršg
->
L’gth
() + 1;

1233 
as£¹
(
Ën
 <ğ
INT_MAX
);

1234 ià(
	gËn
 >  (
	g¡r_¡_
)) {

1235 
	g¡r_
 = 
¡©ic_ÿ¡
<*>(
m®loc
(
Ën
));

1236 
as£¹
(
¡r_
 != 0);

1238 cÚ¡ 
	gæags
 =

1239 
v8
::
SŒšg
::
NO_NULL_TERMINATION
 | 
imp
::
kR•ÏûInv®idUtf8
;

1240 
	gËngth_
 = 
¡ršg
->
Wr™eUtf8
(
¡r_
, 
¡©ic_ÿ¡
<>(
Ën
), 0, 
æags
);

1241 
	g¡r_
[
Ëngth_
] = '\0';

1246 
šlše
 
Ëngth
() const {

1247  
	gËngth_
;

1250 
šlše
 * 
	gİ”©Ü
*(è{  
	g¡r_
; }

1251 
šlše
 cÚ¡ * 
	gİ”©Ü
*(ècÚ¡ {  
	g¡r_
; }

1253 
	gšlše
 ~
Utf8SŒšg
() {

1254 ià(
	g¡r_
 !ğ
¡r_¡_
) {

1255 
ä“
(
¡r_
);

1259 
	g´iv©e
:

1260 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
Utf8SŒšg
)

1262 
Ëngth_
;

1263 *
	g¡r_
;

1264 
	g¡r_¡_
[1024];

1269 (*
	tF»eC®lback
)(*
	td©a
, *
	thšt
);

1271 cÚ¡ 
	tFunùiÚC®lbackInfo
<
	tv8
::
	tV®ue
>& 
	tNAN_METHOD_ARGS_TYPE
;

1272 
	tNAN_METHOD_RETURN_TYPE
;

1274 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>& 
	tNAN_GETTER_ARGS_TYPE
;

1275 
	tNAN_GETTER_RETURN_TYPE
;

1277 cÚ¡ 
	tPrİ”tyC®lbackInfo
<>& 
	tNAN_SETTER_ARGS_TYPE
;

1278 
	tNAN_SETTER_RETURN_TYPE
;

1280 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>&

1281 
	tNAN_PROPERTY_GETTER_ARGS_TYPE
;

1282 
	tNAN_PROPERTY_GETTER_RETURN_TYPE
;

1284 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>&

1285 
	tNAN_PROPERTY_SETTER_ARGS_TYPE
;

1286 
	tNAN_PROPERTY_SETTER_RETURN_TYPE
;

1288 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tA¼ay
>&

1289 
	tNAN_PROPERTY_ENUMERATOR_ARGS_TYPE
;

1290 
	tNAN_PROPERTY_ENUMERATOR_RETURN_TYPE
;

1292 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tBoŞ—n
>&

1293 
	tNAN_PROPERTY_DELETER_ARGS_TYPE
;

1294 
	tNAN_PROPERTY_DELETER_RETURN_TYPE
;

1296 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tIÁeg”
>&

1297 
	tNAN_PROPERTY_QUERY_ARGS_TYPE
;

1298 
	tNAN_PROPERTY_QUERY_RETURN_TYPE
;

1300 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>& 
	tNAN_INDEX_GETTER_ARGS_TYPE
;

1301 
	tNAN_INDEX_GETTER_RETURN_TYPE
;

1303 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>& 
	tNAN_INDEX_SETTER_ARGS_TYPE
;

1304 
	tNAN_INDEX_SETTER_RETURN_TYPE
;

1306 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tA¼ay
>&

1307 
	tNAN_INDEX_ENUMERATOR_ARGS_TYPE
;

1308 
	tNAN_INDEX_ENUMERATOR_RETURN_TYPE
;

1310 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tBoŞ—n
>&

1311 
	tNAN_INDEX_DELETER_ARGS_TYPE
;

1312 
	tNAN_INDEX_DELETER_RETURN_TYPE
;

1314 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tIÁeg”
>&

1315 
	tNAN_INDEX_QUERY_ARGS_TYPE
;

1316 
	tNAN_INDEX_QUERY_RETURN_TYPE
;

1318 
	#NAN_METHOD
(
Çme
) \

1319 
Nª
::
NAN_METHOD_RETURN_TYPE
 
	$Çme
(
Nª
::
NAN_METHOD_ARGS_TYPE
 
šfo
)

	)

1320 
	#NAN_GETTER
(
Çme
) \

1321 
Nª
::
NAN_GETTER_RETURN_TYPE
 
	`Çme
( \

1322 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
 \

1323 , 
Nª
::
NAN_GETTER_ARGS_TYPE
 
šfo
)

	)

1324 
	#NAN_SETTER
(
Çme
) \

1325 
Nª
::
NAN_SETTER_RETURN_TYPE
 
	`Çme
( \

1326 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
 \

1327 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue
 \

1328 , 
Nª
::
NAN_SETTER_ARGS_TYPE
 
šfo
)

	)

1329 
	#NAN_PROPERTY_GETTER
(
Çme
) \

1330 
Nª
::
NAN_PROPERTY_GETTER_RETURN_TYPE
 
	`Çme
( \

1331 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
 \

1332 , 
Nª
::
NAN_PROPERTY_GETTER_ARGS_TYPE
 
šfo
)

	)

1333 
	#NAN_PROPERTY_SETTER
(
Çme
) \

1334 
Nª
::
NAN_PROPERTY_SETTER_RETURN_TYPE
 
	`Çme
( \

1335 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
 \

1336 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue
 \

1337 , 
Nª
::
NAN_PROPERTY_SETTER_ARGS_TYPE
 
šfo
)

	)

1338 
	#NAN_PROPERTY_ENUMERATOR
(
Çme
) \

1339 
Nª
::
NAN_PROPERTY_ENUMERATOR_RETURN_TYPE
 
	`Çme
( \

1340 
Nª
::
NAN_PROPERTY_ENUMERATOR_ARGS_TYPE
 
šfo
)

	)

1341 
	#NAN_PROPERTY_DELETER
(
Çme
) \

1342 
Nª
::
NAN_PROPERTY_DELETER_RETURN_TYPE
 
	`Çme
( \

1343 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
 \

1344 , 
Nª
::
NAN_PROPERTY_DELETER_ARGS_TYPE
 
šfo
)

	)

1345 
	#NAN_PROPERTY_QUERY
(
Çme
) \

1346 
Nª
::
NAN_PROPERTY_QUERY_RETURN_TYPE
 
	`Çme
( \

1347 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
 \

1348 , 
Nª
::
NAN_PROPERTY_QUERY_ARGS_TYPE
 
šfo
)

	)

1349 
	#NAN_INDEX_GETTER
(
Çme
) \

1350 
Nª
::
NAN_INDEX_GETTER_RETURN_TYPE
 
	`Çme
( \

1351 
ušt32_t
 
šdex
 \

1352 , 
Nª
::
NAN_INDEX_GETTER_ARGS_TYPE
 
šfo
)

	)

1353 
	#NAN_INDEX_SETTER
(
Çme
) \

1354 
Nª
::
NAN_INDEX_SETTER_RETURN_TYPE
 
	`Çme
( \

1355 
ušt32_t
 
šdex
 \

1356 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue
 \

1357 , 
Nª
::
NAN_INDEX_SETTER_ARGS_TYPE
 
šfo
)

	)

1358 
	#NAN_INDEX_ENUMERATOR
(
Çme
) \

1359 
Nª
::
NAN_INDEX_ENUMERATOR_RETURN_TYPE
 \

1360 
	$Çme
(
Nª
::
NAN_INDEX_ENUMERATOR_ARGS_TYPE
 
šfo
)

	)

1361 
	#NAN_INDEX_DELETER
(
Çme
) \

1362 
Nª
::
NAN_INDEX_DELETER_RETURN_TYPE
 
	`Çme
( \

1363 
ušt32_t
 
šdex
 \

1364 , 
Nª
::
NAN_INDEX_DELETER_ARGS_TYPE
 
šfo
)

	)

1365 
	#NAN_INDEX_QUERY
(
Çme
) \

1366 
Nª
::
NAN_INDEX_QUERY_RETURN_TYPE
 
	`Çme
( \

1367 
ušt32_t
 
šdex
 \

1368 , 
Nª
::
NAN_INDEX_QUERY_ARGS_TYPE
 
šfo
)

	)

1370 şas 
	cC®lback
 {

1371 
public
:

1372 
	`C®lback
() {}

1374 
ex¶ic™
 
	`C®lback
(cÚ¡ 
v8
::
Loÿl
<v8::
FunùiÚ
> &
â
è: 
	`hªdË_
(fn) {}

1376 ~
	`C®lback
() {

1377 
hªdË_
.
	`Re£t
();

1380 
boŞ
 
İ”©Ü
==(cÚ¡ 
C®lback
 &
Ùh”
) const {

1381  
hªdË_
 =ğ
Ùh”
.handle_;

1384 
boŞ
 
İ”©Ü
!=(cÚ¡ 
C®lback
 &
Ùh”
) const {

1385  !
İ”©Ü
==(
Ùh”
);

1388 
šlše


1389 
v8
::
Loÿl
<v8::
FunùiÚ
> 
İ”©Ü
*(ècÚ¡ {  
	`G‘FunùiÚ
(); }

1391 
šlše
 
v8
::
Loÿl
<v8::
V®ue
> 
	`İ”©Ü
()(

1392 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


1393 , 
¬gc
 = 0

1394 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[] = 0) const {

1395  
this
->
	`C®l
(
rg‘
, 
¬gc
, 
¬gv
);

1398 
šlše
 
v8
::
Loÿl
<v8::
V®ue
> 
	`İ”©Ü
()(

1399 
¬gc
 = 0

1400 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[] = 0) const {

1401  
this
->
	`C®l
(
¬gc
, 
¬gv
);

1405 
šlše
 
	`S‘FunùiÚ
(cÚ¡ 
v8
::
Loÿl
<v8::
FunùiÚ
> &
â
) {

1406 
	`Re£t
(
â
);

1409 
šlše
 
	`Re£t
(cÚ¡ 
v8
::
Loÿl
<v8::
FunùiÚ
> &
â
) {

1410 
hªdË_
.
	`Re£t
(
â
);

1413 
šlše
 
	`Re£t
() {

1414 
hªdË_
.
	`Re£t
();

1417 
šlše
 
v8
::
Loÿl
<v8::
FunùiÚ
> 
	`G‘FunùiÚ
() const {

1418  
	`New
(
hªdË_
);

1421 
šlše
 
boŞ
 
	`IsEm±y
() const {

1422  
hªdË_
.
	`IsEm±y
();

1425 
šlše
 
v8
::
Loÿl
<v8::
V®ue
>

1426 
	`C®l
(
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


1427 , 
¬gc


1428 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) const {

1429 #ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

1430 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
	`G‘Cu¼’t
();

1431  
	`C®l_
(
isŞ©e
, 
rg‘
, 
¬gc
, 
¬gv
);

1433  
	`C®l_
(
rg‘
, 
¬gc
, 
¬gv
);

1437 
šlše
 
v8
::
Loÿl
<v8::
V®ue
>

1438 
	`C®l
(
¬gc
, 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) const {

1439 #ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

1440 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
	`G‘Cu¼’t
();

1441 
v8
::
Esÿ·bËHªdËScİe
 
	`scİe
(
isŞ©e
);

1442  
scİe
.
	`Esÿ³
(

1443 
	`C®l_
(
isŞ©e
, isŞ©e->
	`G‘Cu¼’tCÚ‹xt
()->
	`Glob®
(), 
¬gc
, 
¬gv
));

1445 
v8
::
HªdËScİe
 
scİe
;

1446  
scİe
.
	`Clo£
(
	`C®l_
(
v8
::
CÚ‹xt
::
	`G‘Cu¼’t
()->
	`Glob®
(), 
¬gc
, 
¬gv
));

1450 
´iv©e
:

1451 
	`NAN_DISALLOW_ASSIGN_COPY_MOVE
(
C®lback
)

1452 
P”si¡’t
<
v8
::
FunùiÚ
> 
hªdË_
;

1454 #ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

1455 
v8
::
Loÿl
<v8::
V®ue
> 
	`C®l_
(v8::
IsŞ©e
 *
isŞ©e


1456 , 
v8
::
Loÿl
<v8::
Objeù
> 
rg‘


1457 , 
¬gc


1458 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) const {

1459 
Esÿ·bËHªdËScİe
 
scİe
;

1461 
v8
::
Loÿl
<v8::
FunùiÚ
> 
ÿÎback
 = 
	`New
(
hªdË_
);

1462 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


1463  
scİe
.
	`Esÿ³
(
	`New
(
node
::
	`MakeC®lback
(

1464 
isŞ©e


1465 , 
rg‘


1466 , 
ÿÎback


1467 , 
¬gc


1468 , 
¬gv


1471  
scİe
.
	`Esÿ³
(
node
::
	`MakeC®lback
(

1472 
isŞ©e


1473 , 
rg‘


1474 , 
ÿÎback


1475 , 
¬gc


1476 , 
¬gv


1481 
v8
::
Loÿl
<v8::
V®ue
> 
	`C®l_
(v8::Loÿl<v8::
Objeù
> 
rg‘


1482 , 
¬gc


1483 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) const {

1484 
Esÿ·bËHªdËScİe
 
scİe
;

1486 
v8
::
Loÿl
<v8::
FunùiÚ
> 
ÿÎback
 = 
	`New
(
hªdË_
);

1487  
scİe
.
	`Esÿ³
(
	`New
(
node
::
	`MakeC®lback
(

1488 
rg‘


1489 , 
ÿÎback


1490 , 
¬gc


1491 , 
¬gv


1495 
	}
};

1497  cÏs 
	cAsyncWÜk”
 {

1498 
	gpublic
:

1499 
ex¶ic™
 
AsyncWÜk”
(
C®lback
 *
ÿÎback_
)

1500 : 
ÿÎback
(
ÿÎback_
), 
”rmsg_
(
NULL
) {

1501 
	g»que¡
.
	gd©a
 = 
this
;

1503 
HªdËScİe
 
	gscİe
;

1504 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
New
<v8::Object>();

1505 
	g³rsi¡’tHªdË
.
Re£t
(
obj
);

1508 
	gvœtu®
 ~
AsyncWÜk”
() {

1509 
HªdËScİe
 
	gscİe
;

1511 ià(!
	g³rsi¡’tHªdË
.
IsEm±y
())

1512 
	g³rsi¡’tHªdË
.
Re£t
();

1513 
d–‘e
 
	gÿÎback
;

1514 
	gd–‘e
[] 
	g”rmsg_
;

1517 
vœtu®
 
WÜkCom¶‘e
() {

1518 
HªdËScİe
 
	gscİe
;

1520 ià(
	g”rmsg_
 =ğ
NULL
)

1521 
HªdËOKC®lback
();

1523 
HªdËE¼ÜC®lback
();

1524 
d–‘e
 
	gÿÎback
;

1525 
	gÿÎback
 = 
NULL
;

1528 
šlše
 
SaveToP”si¡’t
(

1529 cÚ¡ *
key
, cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> &
v®ue
) {

1530 
HªdËScİe
 
scİe
;

1531 
New
(
³rsi¡’tHªdË
)->
S‘
(New(
key
).
ToLoÿlChecked
(), 
v®ue
);

1534 
šlše
 
SaveToP”si¡’t
(

1535 cÚ¡ 
v8
::
Loÿl
<v8::
SŒšg
> &
key
, cÚ¡ v8::Loÿl<v8::
V®ue
> &
v®ue
) {

1536 
HªdËScİe
 
scİe
;

1537 
New
(
³rsi¡’tHªdË
)->
S‘
(
key
, 
v®ue
);

1540 
šlše
 
SaveToP”si¡’t
(

1541 
ušt32_t
 
šdex
, cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> &
v®ue
) {

1542 
HªdËScİe
 
scİe
;

1543 
New
(
³rsi¡’tHªdË
)->
S‘
(
šdex
, 
v®ue
);

1546 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
G‘FromP”si¡’t
(cÚ¡ *
key
) const {

1547 
Esÿ·bËHªdËScİe
 
scİe
;

1548  
	gscİe
.
Esÿ³
(

1549 
New
(
³rsi¡’tHªdË
)->
G‘
(New(
key
).
ToLoÿlChecked
()));

1552 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
>

1553 
G‘FromP”si¡’t
(cÚ¡ 
v8
::
Loÿl
<v8::
SŒšg
> &
key
) const {

1554 
Esÿ·bËHªdËScİe
 
scİe
;

1555  
	gscİe
.
Esÿ³
(
New
(
³rsi¡’tHªdË
)->
G‘
(
key
));

1558 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
G‘FromP”si¡’t
(
ušt32_t
 
šdex
) const {

1559 
Esÿ·bËHªdËScİe
 
scİe
;

1560  
	gscİe
.
Esÿ³
(
New
(
³rsi¡’tHªdË
)->
G‘
(
šdex
));

1563 
vœtu®
 
Execu‹
() = 0;

1565 
uv_wÜk_t
 
	g»que¡
;

1567 
vœtu®
 
De¡roy
() {

1568 
d–‘e
 
	gthis
;

1571 
	g´Ùeùed
:

1572 
P”si¡’t
<
v8
::
Objeù
> 
³rsi¡’tHªdË
;

1573 
C®lback
 *
	gÿÎback
;

1575 
vœtu®
 
HªdËOKC®lback
() {

1576 
HªdËScİe
 
	gscİe
;

1578 
	gÿÎback
->
C®l
(0, 
NULL
);

1581 
vœtu®
 
HªdËE¼ÜC®lback
() {

1582 
HªdËScİe
 
	gscİe
;

1584 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
¬gv
[] = {

1585 
v8
::
Exû±iÚ
::
E¼Ü
(
New
<v8::
SŒšg
>(
E¼ÜMes§ge
()).
ToLoÿlChecked
())

1587 
	gÿÎback
->
C®l
(1, 
¬gv
);

1590 
S‘E¼ÜMes§ge
(cÚ¡ *
msg
) {

1591 
	gd–‘e
[] 
	g”rmsg_
;

1593 
size_t
 
	gsize
 = 
¡¾’
(
msg
) + 1;

1594 
	g”rmsg_
 = 
Ãw
 [
size
];

1595 
memıy
(
”rmsg_
, 
msg
, 
size
);

1598 cÚ¡ * 
E¼ÜMes§ge
() const {

1599  
	g”rmsg_
;

1602 
	g´iv©e
:

1603 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
AsyncWÜk”
)

1604 *
”rmsg_
;

1608 
	g‹m¶©e
<
şass
 
	gT
>

1609  cÏs 
	cAsyncProg»ssWÜk”Ba£
 : 
public
 
AsyncWÜk”
 {

1610 
public
:

1611 
ex¶ic™
 
AsyncProg»ssWÜk”Ba£
(
C®lback
 *
ÿÎback_
)

1612 : 
AsyncWÜk”
(
ÿÎback_
), 
asyncd©a_
(
NULL
), 
asyncsize_
(0) {

1613 
	gasync
 = 
Ãw
 
uv_async_t
;

1614 
uv_async_š™
(

1615 
uv_deçuÉ_loİ
()

1616 , 
async


1617 , 
AsyncProg»ss_


1619 
	gasync
->
	gd©a
 = 
this
;

1621 
uv_mu‹x_š™
(&
async_lock
);

1624 
	gvœtu®
 ~
AsyncProg»ssWÜk”Ba£
() {

1625 
uv_mu‹x_de¡roy
(&
async_lock
);

1627 
	gd–‘e
[] 
	gasyncd©a_
;

1630 
WÜkProg»ss
() {

1631 
uv_mu‹x_lock
(&
async_lock
);

1632 
T
 *
	gd©a
 = 
asyncd©a_
;

1633 
size_t
 
	gsize
 = 
asyncsize_
;

1634 
	gasyncd©a_
 = 
NULL
;

1635 
uv_mu‹x_uÆock
(&
async_lock
);

1638 ià(
	gÿÎback
) {

1639 
HªdËProg»ssC®lback
(
d©a
, 
size
);

1641 
	gd–‘e
[] 
	gd©a
;

1644 şas 
	cExecutiÚProg»ss
 {

1645 
ä›nd
 
şass
 
	gAsyncProg»ssWÜk”Ba£
;

1646 
	gpublic
:

1647 
SigÇl
() const {

1648 
uv_async_£nd
(
th©_
->
async
);

1651 
S’d
(cÚ¡ 
T
* 
d©a
, 
size_t
 
size
) const {

1652 
	gth©_
->
S’dProg»ss_
(
d©a
, 
size
);

1655 
	g´iv©e
:

1656 
ex¶ic™
 
ExecutiÚProg»ss
(
AsyncProg»ssWÜk”Ba£
 *
th©
è: 
th©_
(that) {}

1657 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
ExecutiÚProg»ss
)

1658 
AsyncProg»ssWÜk”Ba£
* cÚ¡ 
th©_
;

1661 
vœtu®
 
Execu‹
(cÚ¡ 
ExecutiÚProg»ss
& 
´og»ss
) = 0;

1662 
vœtu®
 
HªdËProg»ssC®lback
(cÚ¡ 
T
 *
d©a
, 
size_t
 
size
) = 0;

1664 
vœtu®
 
De¡roy
() {

1665 
uv_şo£
(
»š‹½»t_ÿ¡
<
uv_hªdË_t
*>(
async
), 
AsyncClo£_
);

1668 
	g´iv©e
:

1669 
Execu‹
() {

1670 
ExecutiÚProg»ss
 
´og»ss
(
this
);

1671 
Execu‹
(
´og»ss
);

1674 
S’dProg»ss_
(cÚ¡ 
T
 *
d©a
, 
size_t
 
size
) {

1675 
T
 *
	gÃw_d©a
 = 
Ãw
 T[
size
];

1677 
T
 *
	g™
 = 
Ãw_d©a
;

1678 
	g¡d
::
cİy
(
d©a
, d©¨+ 
size
, 
™
);

1681 
uv_mu‹x_lock
(&
async_lock
);

1682 
T
 *
	gŞd_d©a
 = 
asyncd©a_
;

1683 
	gasyncd©a_
 = 
Ãw_d©a
;

1684 
	gasyncsize_
 = 
size
;

1685 
uv_mu‹x_uÆock
(&
async_lock
);

1687 
	gd–‘e
[] 
	gŞd_d©a
;

1688 
uv_async_£nd
(
async
);

1691 
šlše
 
NAUV_WORK_CB
(
AsyncProg»ss_
) {

1692 
AsyncProg»ssWÜk”Ba£
 *
	gwÜk”
 =

1693 
¡©ic_ÿ¡
<
AsyncProg»ssWÜk”Ba£
*>(
async
->
d©a
);

1694 
	gwÜk”
->
WÜkProg»ss
();

1697 
šlše
 
AsyncClo£_
(
uv_hªdË_t
* 
hªdË
) {

1698 
AsyncProg»ssWÜk”Ba£
 *
	gwÜk”
 =

1699 
¡©ic_ÿ¡
<
AsyncProg»ssWÜk”Ba£
*>(
hªdË
->
d©a
);

1700 
d–‘e
 
	g»š‹½»t_ÿ¡
<
	guv_async_t
*>(
	ghªdË
);

1701 
d–‘e
 
	gwÜk”
;

1704 
uv_async_t
 *
	gasync
;

1705 
uv_mu‹x_t
 
	gasync_lock
;

1706 
T
 *
	gasyncd©a_
;

1707 
size_t
 
	gasyncsize_
;

1712 
	gAsyncProg»ssWÜk”Ba£
<> 
	tAsyncProg»ssWÜk”
;

1714 
šlše
 
	$AsyncExecu‹
 (
uv_wÜk_t
* 
»q
) {

1715 
AsyncWÜk”
 *
wÜk”
 = 
¡©ic_ÿ¡
<AsyncWÜk”*>(
»q
->
d©a
);

1716 
wÜk”
->
	`Execu‹
();

1717 
	}
}

1719 
šlše
 
	$AsyncExecu‹Com¶‘e
 (
uv_wÜk_t
* 
»q
) {

1720 
AsyncWÜk”
* 
wÜk”
 = 
¡©ic_ÿ¡
<AsyncWÜk”*>(
»q
->
d©a
);

1721 
wÜk”
->
	`WÜkCom¶‘e
();

1722 
wÜk”
->
	`De¡roy
();

1723 
	}
}

1725 
šlše
 
	$AsyncQueueWÜk”
 (
AsyncWÜk”
* 
wÜk”
) {

1726 
	`uv_queue_wÜk
(

1727 
	`uv_deçuÉ_loİ
()

1728 , &
wÜk”
->
»que¡


1729 , 
AsyncExecu‹


1730 , 
»š‹½»t_ÿ¡
<
uv_aá”_wÜk_cb
>(
AsyncExecu‹Com¶‘e
)

1732 
	}
}

1734 
Çme¥aû
 
	gimp
 {

1736 
šlše


1737 
Ex‹º®OÃBy‹SŒšgResourû
 const*

1738 
G‘Ex‹º®Resourû
(
v8
::
Loÿl
<v8::
SŒšg
> 
¡r
) {

1739 #ià
NODE_MODULE_VERSION
 < 
ATOM_0_21_MODULE_VERSION


1740  
¡r
->
G‘Ex‹º®AsciiSŒšgResourû
();

1742  
	g¡r
->
G‘Ex‹º®OÃBy‹SŒšgResourû
();

1746 
šlše


1747 
boŞ


1748 
IsEx‹º®
(
v8
::
Loÿl
<v8::
SŒšg
> 
¡r
) {

1749 #ià
NODE_MODULE_VERSION
 < 
ATOM_0_21_MODULE_VERSION


1750  
¡r
->
IsEx‹º®Ascii
();

1752  
	g¡r
->
IsEx‹º®OÃBy‹
();

1758 
	eEncodšg
 {
	gASCII
, 
	gUTF8
, 
	gBASE64
, 
	gUCS2
, 
	gBINARY
, 
	gHEX
, 
	gBUFFER
};

1760 #ià
NODE_MODULE_VERSION
 < 
NODE_0_10_MODULE_VERSION


1761 
	~"Çn_¡ršg_by‹s.h
"

1764 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$Encode
(

1765 cÚ¡ *
buf
, 
size_t
 
Ën
, 
Encodšg
 
’codšg
 = 
BINARY
) {

1766 #ià(
NODE_MODULE_VERSION
 >ğ
ATOM_0_21_MODULE_VERSION
)

1767 
v8
::
IsŞ©e
* 
isŞ©e
 = v8::IsŞ©e::
	`G‘Cu¼’t
();

1768 
node
::
’codšg
 
node_’c
 = 
¡©ic_ÿ¡
<node::encoding>(encoding);

1770 ià(
’codšg
 =ğ
UCS2
) {

1771  
node
::
	`Encode
(

1772 
isŞ©e


1773 , 
»š‹½»t_ÿ¡
<cÚ¡ 
ušt16_t
 *>(
buf
)

1774 , 
Ën
 / 2);

1776  
node
::
	`Encode
(

1777 
isŞ©e


1778 , 
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
)

1779 , 
Ën


1780 , 
node_’c
);

1782 #–ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

1783  
node
::
	`Encode
(

1784 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()

1785 , 
buf
, 
Ën


1786 , 
¡©ic_ÿ¡
<
node
::
’codšg
>(encoding));

1788 #ià
NODE_MODULE_VERSION
 >ğ
NODE_0_10_MODULE_VERSION


1789  
node
::
	`Encode
(
buf
, 
Ën
, 
¡©ic_ÿ¡
<node::
’codšg
>(encoding));

1791  
imp
::
	`Encode
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
), 
Ën
, 
’codšg
);

1794 
	}
}

1796 
šlše
 
ssize_t
 
DecodeBy‹s
(

1797 
v8
::
Loÿl
<v8::
V®ue
> 
v®
, 
Encodšg
 
’codšg
 = 
BINARY
) {

1798 #ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

1799  
node
::
DecodeBy‹s
(

1800 
v8
::
IsŞ©e
::
G‘Cu¼’t
()

1801 , 
v®


1802 , 
¡©ic_ÿ¡
<
node
::
’codšg
>(encoding));

1804 #ià(
NODE_MODULE_VERSION
 < 
NODE_0_10_MODULE_VERSION
)

1805 ià(
	g’codšg
 =ğ
BUFFER
) {

1806  
node
::
DecodeBy‹s
(
v®
,‚ode::
BINARY
);

1809  
	gnode
::
DecodeBy‹s
(
v®
, 
¡©ic_ÿ¡
<
node
::
’codšg
>(encoding));

1813 
šlše
 
ssize_t
 
DecodeWr™e
(

1814 *
buf


1815 , 
size_t
 
Ën


1816 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®


1817 , 
Encodšg
 
’codšg
 = 
BINARY
) {

1818 #ià(
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION
)

1819  
node
::
DecodeWr™e
(

1820 
v8
::
IsŞ©e
::
G‘Cu¼’t
()

1821 , 
buf


1822 , 
Ën


1823 , 
v®


1824 , 
¡©ic_ÿ¡
<
node
::
’codšg
>(encoding));

1826 #ià(
NODE_MODULE_VERSION
 < 
NODE_0_10_MODULE_VERSION
)

1827 ià(
	g’codšg
 =ğ
BUFFER
) {

1828  
node
::
DecodeWr™e
(
buf
, 
Ën
, 
v®
,‚ode::
BINARY
);

1831  
	gnode
::
DecodeWr™e
(

1832 
buf


1833 , 
Ën


1834 , 
v®


1835 , 
¡©ic_ÿ¡
<
node
::
’codšg
>(encoding));

1839 
šlše
 
S‘PrÙÙy³Tem¶©e
(

1840 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
‹m¶


1841 , cÚ¡ *
Çme


1842 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue


1844 
HªdËScİe
 
scİe
;

1845 
S‘Tem¶©e
(
‹m¶
->
PrÙÙy³Tem¶©e
(), 
Çme
, 
v®ue
);

1848 
šlše
 
S‘PrÙÙy³Tem¶©e
(

1849 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
‹m¶


1850 , 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme


1851 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue


1852 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibu‹s


1854 
HªdËScİe
 
scİe
;

1855 
S‘Tem¶©e
(
‹m¶
->
PrÙÙy³Tem¶©e
(), 
Çme
, 
v®ue
, 
©Œibu‹s
);

1858 
šlše
 
S‘In¡ªûTem¶©e
(

1859 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
‹m¶


1860 , cÚ¡ *
Çme


1861 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue


1863 
HªdËScİe
 
scİe
;

1864 
S‘Tem¶©e
(
‹m¶
->
In¡ªûTem¶©e
(), 
Çme
, 
v®ue
);

1867 
šlše
 
S‘In¡ªûTem¶©e
(

1868 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
‹m¶


1869 , 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme


1870 , 
v8
::
Loÿl
<v8::
D©a
> 
v®ue


1871 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibu‹s


1873 
HªdËScİe
 
scİe
;

1874 
S‘Tem¶©e
(
‹m¶
->
In¡ªûTem¶©e
(), 
Çme
, 
v®ue
, 
©Œibu‹s
);

1877 
Çme¥aû
 
	gimp
 {

1883 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1884 
šlše


1886 
S‘M‘hodAux
(
T
 
»cv
,

1887 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme
,

1888 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
l
,

1889 
v8
::
Tem¶©e
 *) {

1890 
»cv
->
S‘
(
Çme
, 
l
);

1893 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

1894 
šlše


1896 
S‘M‘hodAux
(
T
 
»cv
,

1897 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme
,

1898 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
l
,

1900 
	g»cv
->
S‘
(
Çme
, 
G‘FunùiÚ
(
l
).
ToLoÿlChecked
());

1905 
	g‹m¶©e
 <
ty³Çme
 
	gT
,em¶©<
	gty³Çme
> 
şass
 
	gHªdËTy³
>

1906 
šlše
 
S‘M‘hod
(

1907 
HªdËTy³
<
T
> 
»cv


1908 , cÚ¡ *
Çme


1909 , 
FunùiÚC®lback
 
ÿÎback
) {

1910 
HªdËScİe
 
	gscİe
;

1911 
	gv8
::
Loÿl
<
v8
::
FunùiÚTem¶©e
> 
t
 = 
New
<v8::FunùiÚTem¶©e>(
ÿÎback
);

1912 
	gv8
::
Loÿl
<
v8
::
SŒšg
> 
â_Çme
 = 
New
(
Çme
).
ToLoÿlChecked
();

1913 
	gt
->
S‘CÏssName
(
â_Çme
);

1916 
	gimp
::
S‘M‘hodAux
(
»cv
, 
â_Çme
, 
t
, 
¡©ic_ÿ¡
<
T
*>(0));

1919 
šlše
 
S‘PrÙÙy³M‘hod
(

1920 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
»cv


1921 , cÚ¡ * 
Çme
, 
FunùiÚC®lback
 
ÿÎback
) {

1922 
HªdËScİe
 
	gscİe
;

1923 
	gv8
::
Loÿl
<
v8
::
FunùiÚTem¶©e
> 
t
 = 
New
<v8::FunctionTemplate>(

1924 
ÿÎback


1925 , 
	gv8
::
Loÿl
<
v8
::
V®ue
>()

1926 , 
	gNew
<
	gv8
::
SigÇtu»
>(
»cv
));

1927 
	gv8
::
Loÿl
<
v8
::
SŒšg
> 
â_Çme
 = 
New
(
Çme
).
ToLoÿlChecked
();

1928 
	g»cv
->
PrÙÙy³Tem¶©e
()->
S‘
(
â_Çme
, 
t
);

1929 
	gt
->
S‘CÏssName
(
â_Çme
);

1934 
šlše
 
S‘AcûssÜ
(

1935 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
l


1936 , 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme


1937 , 
G‘‹rC®lback
 
g‘‹r


1938 , 
S‘‹rC®lback
 
£‰”
 = 0

1939 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()

1940 , 
v8
::
AcûssCÚŒŞ
 
£‰šgs
 = v8::
DEFAULT


1941 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibu‹
 = v8::
NÚe


1942 , 
imp
::
Sig
 
sigÇtu»
 = imp::
	$Sig
()) {

1943 
HªdËScİe
 
scİe
;

1945 
imp
::
N©iveG‘‹r
 
g‘‹r_
 =

1946 
imp
::
G‘‹rC®lbackW¿µ”
;

1947 
imp
::
N©iveS‘‹r
 
£‰”_
 =

1948 
£‰”
 ? 
imp
::
S‘‹rC®lbackW¿µ”
 : 0;

1950 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
Ù¶
 = 
New
<v8::ObjectTemplate>();

1951 
Ù¶
->
	`S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kAcûssÜF›ldCouÁ
);

1952 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
	`NewIn¡ªû
(
Ù¶
).
	`ToLoÿlChecked
();

1954 
obj
->
	`S‘IÁ”ÇlF›ld
(

1955 
imp
::
kG‘‹rIndex


1956 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
g‘‹r
)));

1958 ià(
£‰”
 != 0) {

1959 
obj
->
	`S‘IÁ”ÇlF›ld
(

1960 
imp
::
kS‘‹rIndex


1961 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
£‰”
)));

1964 ià(!
d©a
.
	`IsEm±y
()) {

1965 
obj
->
	`S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
d©a
);

1968 
l
->
	`S‘AcûssÜ
(

1969 
Çme


1970 , 
g‘‹r_


1971 , 
£‰”_


1972 , 
obj


1973 , 
£‰šgs


1974 , 
©Œibu‹


1975 , 
sigÇtu»
);

1976 
	}
}

1978 
šlše
 
boŞ
 
S‘AcûssÜ
(

1979 
v8
::
Loÿl
<v8::
Objeù
> 
obj


1980 , 
v8
::
Loÿl
<v8::
SŒšg
> 
Çme


1981 , 
G‘‹rC®lback
 
g‘‹r


1982 , 
S‘‹rC®lback
 
£‰”
 = 0

1983 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()

1984 , 
v8
::
AcûssCÚŒŞ
 
£‰šgs
 = v8::
DEFAULT


1985 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibu‹
 = v8::
NÚe
) {

1986 
HªdËScİe
 
scİe
;

1988 
	gimp
::
N©iveG‘‹r
 
g‘‹r_
 =

1989 
imp
::
G‘‹rC®lbackW¿µ”
;

1990 
	gimp
::
N©iveS‘‹r
 
£‰”_
 =

1991 
£‰”
 ? 
imp
::
S‘‹rC®lbackW¿µ”
 : 0;

1993 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
Ù¶
 = 
New
<v8::ObjectTemplate>();

1994 
	gÙ¶
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kAcûssÜF›ldCouÁ
);

1995 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
d©aobj
 = 
NewIn¡ªû
(
Ù¶
).
ToLoÿlChecked
();

1997 
	gd©aobj
->
S‘IÁ”ÇlF›ld
(

1998 
imp
::
kG‘‹rIndex


1999 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
g‘‹r
)));

2001 ià(!
	gd©a
.
IsEm±y
()) {

2002 
	gd©aobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
d©a
);

2005 ià(
	g£‰”
) {

2006 
	gd©aobj
->
S‘IÁ”ÇlF›ld
(

2007 
imp
::
kS‘‹rIndex


2008 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
£‰”
)));

2011 #ià(
NODE_MODULE_VERSION
 >ğ
NODE_6_0_MODULE_VERSION
)

2012  
	gobj
->
S‘AcûssÜ
(

2013 
G‘Cu¼’tCÚ‹xt
()

2014 , 
Çme


2015 , 
g‘‹r_


2016 , 
£‰”_


2017 , 
d©aobj


2018 , 
£‰šgs


2019 , 
©Œibu‹
).
FromMaybe
(
çl£
);

2021  
	gobj
->
S‘AcûssÜ
(

2022 
Çme


2023 , 
g‘‹r_


2024 , 
£‰”_


2025 , 
d©aobj


2026 , 
£‰šgs


2027 , 
©Œibu‹
);

2031 
šlše
 
S‘NamedPrİ”tyHªdËr
(

2032 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
l


2033 , 
Prİ”tyG‘‹rC®lback
 
g‘‹r


2034 , 
Prİ”tyS‘‹rC®lback
 
£‰”
 = 0

2035 , 
Prİ”tyQu”yC®lback
 
qu”y
 = 0

2036 , 
Prİ”tyD–‘”C®lback
 
d–‘”
 = 0

2037 , 
Prİ”tyEnum”©ÜC®lback
 
’um”©Ü
 = 0

2038 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()) {

2039 
HªdËScİe
 
scİe
;

2041 
	gimp
::
N©ivePrİ”tyG‘‹r
 
g‘‹r_
 =

2042 
imp
::
Prİ”tyG‘‹rC®lbackW¿µ”
;

2043 
	gimp
::
N©ivePrİ”tyS‘‹r
 
£‰”_
 =

2044 
£‰”
 ? 
imp
::
Prİ”tyS‘‹rC®lbackW¿µ”
 : 0;

2045 
	gimp
::
N©ivePrİ”tyQu”y
 
qu”y_
 =

2046 
qu”y
 ? 
imp
::
Prİ”tyQu”yC®lbackW¿µ”
 : 0;

2047 
	gimp
::
N©ivePrİ”tyD–‘”
 *
d–‘”_
 =

2048 
d–‘”
 ? 
imp
::
Prİ”tyD–‘”C®lbackW¿µ”
 : 0;

2049 
	gimp
::
N©ivePrİ”tyEnum”©Ü
 
’um”©Ü_
 =

2050 
’um”©Ü
 ? 
imp
::
Prİ”tyEnum”©ÜC®lbackW¿µ”
 : 0;

2052 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
Ù¶
 = 
New
<v8::ObjectTemplate>();

2053 
	gÙ¶
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kPrİ”tyF›ldCouÁ
);

2054 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
NewIn¡ªû
(
Ù¶
).
ToLoÿlChecked
();

2055 
	gobj
->
S‘IÁ”ÇlF›ld
(

2056 
imp
::
kPrİ”tyG‘‹rIndex


2057 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
g‘‹r
)));

2059 ià(
	g£‰”
) {

2060 
	gobj
->
S‘IÁ”ÇlF›ld
(

2061 
imp
::
kPrİ”tyS‘‹rIndex


2062 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
£‰”
)));

2065 ià(
	gqu”y
) {

2066 
	gobj
->
S‘IÁ”ÇlF›ld
(

2067 
imp
::
kPrİ”tyQu”yIndex


2068 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
qu”y
)));

2071 ià(
	gd–‘”
) {

2072 
	gobj
->
S‘IÁ”ÇlF›ld
(

2073 
imp
::
kPrİ”tyD–‘”Index


2074 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
d–‘”
)));

2077 ià(
	g’um”©Ü
) {

2078 
	gobj
->
S‘IÁ”ÇlF›ld
(

2079 
imp
::
kPrİ”tyEnum”©ÜIndex


2080 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
’um”©Ü
)));

2083 ià(!
	gd©a
.
IsEm±y
()) {

2084 
	gobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
d©a
);

2087 #ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


2088 
	gl
->
S‘HªdËr
(
v8
::
NamedPrİ”tyHªdËrCÚfigu¿tiÚ
(

2089 
g‘‹r_
, 
£‰”_
, 
qu”y_
, 
d–‘”_
, 
’um”©Ü_
, 
obj
));

2091 
	gl
->
S‘NamedPrİ”tyHªdËr
(

2092 
g‘‹r_


2093 , 
£‰”_


2094 , 
qu”y_


2095 , 
d–‘”_


2096 , 
’um”©Ü_


2097 , 
obj
);

2101 
šlše
 
S‘IndexedPrİ”tyHªdËr
(

2102 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
l


2103 , 
IndexG‘‹rC®lback
 
g‘‹r


2104 , 
IndexS‘‹rC®lback
 
£‰”
 = 0

2105 , 
IndexQu”yC®lback
 
qu”y
 = 0

2106 , 
IndexD–‘”C®lback
 
d–‘”
 = 0

2107 , 
IndexEnum”©ÜC®lback
 
’um”©Ü
 = 0

2108 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()) {

2109 
HªdËScİe
 
scİe
;

2111 
	gimp
::
N©iveIndexG‘‹r
 
g‘‹r_
 =

2112 
imp
::
IndexG‘‹rC®lbackW¿µ”
;

2113 
	gimp
::
N©iveIndexS‘‹r
 
£‰”_
 =

2114 
£‰”
 ? 
imp
::
IndexS‘‹rC®lbackW¿µ”
 : 0;

2115 
	gimp
::
N©iveIndexQu”y
 
qu”y_
 =

2116 
qu”y
 ? 
imp
::
IndexQu”yC®lbackW¿µ”
 : 0;

2117 
	gimp
::
N©iveIndexD–‘”
 
d–‘”_
 =

2118 
d–‘”
 ? 
imp
::
IndexD–‘”C®lbackW¿µ”
 : 0;

2119 
	gimp
::
N©iveIndexEnum”©Ü
 
’um”©Ü_
 =

2120 
’um”©Ü
 ? 
imp
::
IndexEnum”©ÜC®lbackW¿µ”
 : 0;

2122 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
Ù¶
 = 
New
<v8::ObjectTemplate>();

2123 
	gÙ¶
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kIndexPrİ”tyF›ldCouÁ
);

2124 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
NewIn¡ªû
(
Ù¶
).
ToLoÿlChecked
();

2125 
	gobj
->
S‘IÁ”ÇlF›ld
(

2126 
imp
::
kIndexPrİ”tyG‘‹rIndex


2127 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
g‘‹r
)));

2129 ià(
	g£‰”
) {

2130 
	gobj
->
S‘IÁ”ÇlF›ld
(

2131 
imp
::
kIndexPrİ”tyS‘‹rIndex


2132 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
£‰”
)));

2135 ià(
	gqu”y
) {

2136 
	gobj
->
S‘IÁ”ÇlF›ld
(

2137 
imp
::
kIndexPrİ”tyQu”yIndex


2138 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
qu”y
)));

2141 ià(
	gd–‘”
) {

2142 
	gobj
->
S‘IÁ”ÇlF›ld
(

2143 
imp
::
kIndexPrİ”tyD–‘”Index


2144 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
d–‘”
)));

2147 ià(
	g’um”©Ü
) {

2148 
	gobj
->
S‘IÁ”ÇlF›ld
(

2149 
imp
::
kIndexPrİ”tyEnum”©ÜIndex


2150 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
’um”©Ü
)));

2153 ià(!
	gd©a
.
IsEm±y
()) {

2154 
	gobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
d©a
);

2157 #ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


2158 
	gl
->
S‘HªdËr
(
v8
::
IndexedPrİ”tyHªdËrCÚfigu¿tiÚ
(

2159 
g‘‹r_
, 
£‰”_
, 
qu”y_
, 
d–‘”_
, 
’um”©Ü_
, 
obj
));

2161 
	gl
->
S‘IndexedPrİ”tyHªdËr
(

2162 
g‘‹r_


2163 , 
£‰”_


2164 , 
qu”y_


2165 , 
d–‘”_


2166 , 
’um”©Ü_


2167 , 
obj
);

2171 
šlše
 
S‘C®lHªdËr
(

2172 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
l


2173 , 
FunùiÚC®lback
 
ÿÎback


2174 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()) {

2175 
HªdËScİe
 
scİe
;

2177 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
Ù¶
 = 
New
<v8::ObjectTemplate>();

2178 
	gÙ¶
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kFunùiÚF›ldCouÁ
);

2179 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
NewIn¡ªû
(
Ù¶
).
ToLoÿlChecked
();

2181 
	gobj
->
S‘IÁ”ÇlF›ld
(

2182 
imp
::
kFunùiÚIndex


2183 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
ÿÎback
)));

2185 ià(!
	gd©a
.
IsEm±y
()) {

2186 
	gobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
d©a
);

2189 
	gl
->
S‘C®lHªdËr
(
imp
::
FunùiÚC®lbackW¿µ”
, 
obj
);

2193 
šlše
 
S‘C®lAsFunùiÚHªdËr
(

2194 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
l
,

2195 
FunùiÚC®lback
 
ÿÎback
,

2196 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()) {

2197 
HªdËScİe
 
scİe
;

2199 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
Ù¶
 = 
New
<v8::ObjectTemplate>();

2200 
	gÙ¶
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kFunùiÚF›ldCouÁ
);

2201 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
NewIn¡ªû
(
Ù¶
).
ToLoÿlChecked
();

2203 
	gobj
->
S‘IÁ”ÇlF›ld
(

2204 
imp
::
kFunùiÚIndex


2205 , 
New
<
v8
::
Ex‹º®
>(
»š‹½»t_ÿ¡
<*>(
ÿÎback
)));

2207 ià(!
	gd©a
.
IsEm±y
()) {

2208 
	gobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
d©a
);

2211 
	gl
->
S‘C®lAsFunùiÚHªdËr
(
imp
::
FunùiÚC®lbackW¿µ”
, 
obj
);

2216 
	~"Çn_w—k.h
"

2220 
	~"Çn_objeù_w¿p.h
"

2224 
	~"Çn_´iv©e.h
"

2228 
šlše


2230 
	$ExpÜt
(
ADDON_REGISTER_FUNCTION_ARGS_TYPE
 
rg‘
, cÚ¡ *
Çme
,

2231 
FunùiÚC®lback
 
f
) {

2232 
HªdËScİe
 
scİe
;

2234 
	`S‘
(
rg‘
, 
New
<
v8
::
SŒšg
>(
Çme
).
	`ToLoÿlChecked
(),

2235 
	`G‘FunùiÚ
(
New
<
v8
::
FunùiÚTem¶©e
>(
f
)).
	`ToLoÿlChecked
());

2236 
	}
}

2240 
	sT­
 {

2241 
ex¶ic™
 
T­
(
v8
::
Loÿl
<v8::
V®ue
> 
t
è: 
t_
() {

2242 
HªdËScİe
 
scİe
;

2244 
	gt_
.
Re£t
(
To
<
v8
::
Objeù
>(
t
).
ToLoÿlChecked
());

2247 ~
T­
(è{ 
	gt_
.
Re£t
(); }

2249 
šlše
 
¶ª
(
i
) {

2250 
HªdËScİe
 
	gscİe
;

2251 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
¬g
 = 
New
(
i
);

2252 
MakeC®lback
(
New
(
t_
), "¶ª", 1, &
¬g
);

2255 
šlše
 
ok
(
boŞ
 
isOk
, cÚ¡ *
msg
 = 
NULL
) {

2256 
HªdËScİe
 
scİe
;

2257 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
¬gs
[2];

2258 
	g¬gs
[0] = 
New
(
isOk
);

2259 ià(
	gmsg
è
	g¬gs
[1] = 
New
(
msg
).
ToLoÿlChecked
();

2260 
MakeC®lback
(
New
(
t_
), "ok", 
msg
 ? 2 : 1, 
¬gs
);

2263 
šlše
 
·ss
(cÚ¡ * 
msg
 = 
NULL
) {

2264 
HªdËScİe
 
scİe
;

2265 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
hmsg
;

2266 ià(
	gmsg
è
	ghmsg
 = 
New
(
msg
).
ToLoÿlChecked
();

2267 
MakeC®lback
(
New
(
t_
), "·ss", 
msg
 ? 1 : 0, &
hmsg
);

2270 
	g´iv©e
:

2271 
P”si¡’t
<
v8
::
Objeù
> 
t_
;

2274 
	#NAN_STRINGIZE2
(
x
è#x

	)

2275 
	#NAN_STRINGIZE
(
x
è
	$NAN_STRINGIZE2
(
x
)

	)

2276 
	#NAN_TEST_EXPRESSION
(
ex´essiÚ
) \

2277 Ğ
ex´essiÚ
 ), 
__FILE__
 ":" 
	`NAN_STRINGIZE
(
__LINE__
è": " #ex´essiÚ

	)

2279 
	#NAN_EXPORT
(
rg‘
, 
funùiÚ
è
	`ExpÜt
Ñ¬g‘, #funùiÚ, funùiÚ)

	)

2281 #undeà
TYPE_CHECK


2285 
Çme¥aû
 
imp
 {

2287 
‹m¶©e
 <
ty³Çme
 
T
> 
Maybef›r
;

2289 
‹m¶©e
 <
ty³Çme
 
T
> 
Maybef›r
<
v8
::
Loÿl
<T> > {

2290 
šlše
 
MaybeLoÿl
<
T
> 
	`cÚv”t
(
v8
::
Loÿl
<T> 
v
) {

2291  
v
;

2295 
‹m¶©e
 <
ty³Çme
 
T
> 
Maybef›r
<
MaybeLoÿl
<T> > {

2296 
šlše
 
MaybeLoÿl
<
T
> 
	`cÚv”t
(MaybeLoÿl<T> 
v
) {

2297  
v
;

2301 
	}
}

2303 
	g‹m¶©e
 <
ty³Çme
 
	gT
,em¶©<
	gty³Çme
> 
şass
 
	gMaybeMaybe
>

2304 
šlše
 
	gMaybeLoÿl
<
	gT
>

2305 
MakeMaybe
(
MaybeMaybe
<
T
> 
v
) {

2306  
	gimp
::
Maybef›r
<
MaybeMaybe
<
T
> >::
cÚv”t
(
v
);

2311 
	~"Çn_ty³d¬¿y_cÚ‹Ás.h
"

	@utils/webnao/node_modules/nan/nan_callbacks.h

9 #iâdeà
NAN_CALLBACKS_H_


10 
	#NAN_CALLBACKS_H_


	)

12 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
şass
 
	gFunùiÚC®lbackInfo
;

13 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
şass
 
	gPrİ”tyC®lbackInfo
;

14 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
şass
 
	gGlob®
;

16 (*
	tFunùiÚC®lback
)(cÚ¡ 
	tFunùiÚC®lbackInfo
<
	tv8
::
	tV®ue
>&);

17 (*
	tG‘‹rC®lback
)

18 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ 
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
>&);

19 (*
	tS‘‹rC®lback
)(

20 
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>,

21 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>,

22 cÚ¡ 
	tPrİ”tyC®lbackInfo
<>&);

23 (*
	tPrİ”tyG‘‹rC®lback
)(

24 
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>,

25 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>&);

26 (*
	tPrİ”tyS‘‹rC®lback
)(

27 
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>,

28 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>,

29 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>&);

30 (*
	tPrİ”tyEnum”©ÜC®lback
)

31 (cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tA¼ay
>&);

32 (*
	tPrİ”tyD–‘”C®lback
)(

33 
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>,

34 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tBoŞ—n
>&);

35 (*
	tPrİ”tyQu”yC®lback
)(

36 
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>,

37 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tIÁeg”
>&);

38 (*
	tIndexG‘‹rC®lback
)(

39 
	tušt32_t
,

40 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>&);

41 (*
	tIndexS‘‹rC®lback
)(

42 
	tušt32_t
,

43 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>,

44 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tV®ue
>&);

45 (*
	tIndexEnum”©ÜC®lback
)

46 (cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tA¼ay
>&);

47 (*
	tIndexD–‘”C®lback
)(

48 
	tušt32_t
,

49 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tBoŞ—n
>&);

50 (*
	tIndexQu”yC®lback
)(

51 
	tušt32_t
,

52 cÚ¡ 
	tPrİ”tyC®lbackInfo
<
	tv8
::
	tIÁeg”
>&);

54 
Çme¥aû
 
imp
 {

55 
v8
::
	tLoÿl
<
	tv8
::
	tAcûssÜSigÇtu»
> 
	tSig
;

57 cÚ¡ 
kD©aIndex
 = 0;

59 cÚ¡ 
kFunùiÚIndex
 = 1;

60 cÚ¡ 
kFunùiÚF›ldCouÁ
 = 2;

62 cÚ¡ 
kG‘‹rIndex
 = 1;

63 cÚ¡ 
kS‘‹rIndex
 = 2;

64 cÚ¡ 
kAcûssÜF›ldCouÁ
 = 3;

66 cÚ¡ 
kPrİ”tyG‘‹rIndex
 = 1;

67 cÚ¡ 
kPrİ”tyS‘‹rIndex
 = 2;

68 cÚ¡ 
kPrİ”tyEnum”©ÜIndex
 = 3;

69 cÚ¡ 
kPrİ”tyD–‘”Index
 = 4;

70 cÚ¡ 
kPrİ”tyQu”yIndex
 = 5;

71 cÚ¡ 
kPrİ”tyF›ldCouÁ
 = 6;

73 cÚ¡ 
kIndexPrİ”tyG‘‹rIndex
 = 1;

74 cÚ¡ 
kIndexPrİ”tyS‘‹rIndex
 = 2;

75 cÚ¡ 
kIndexPrİ”tyEnum”©ÜIndex
 = 3;

76 cÚ¡ 
kIndexPrİ”tyD–‘”Index
 = 4;

77 cÚ¡ 
kIndexPrİ”tyQu”yIndex
 = 5;

78 cÚ¡ 
kIndexPrİ”tyF›ldCouÁ
 = 6;

80 
	}
}

82 #ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


83 
	~"Çn_ÿÎbacks_12_šl.h
"

85 
	~"Çn_ÿÎbacks_´e_12_šl.h
"

	@utils/webnao/node_modules/nan/nan_callbacks_12_inl.h

9 #iâdeà
NAN_CALLBACKS_12_INL_H_


10 
	#NAN_CALLBACKS_12_INL_H_


	)

12 
	g‹m¶©e
<
ty³Çme
 
	gT
>

13 şas 
	cR‘uºV®ue
 {

14 
	mv8
::
R‘uºV®ue
<
T
> 
v®ue_
;

16 
	mpublic
:

17 
‹m¶©e
 <
şass
 
S
>

18 
ex¶ic™
 
šlše
 
R‘uºV®ue
(cÚ¡ 
v8
::R‘uºV®ue<
S
> &
v®ue
) :

19 
	$v®ue_
(
v®ue
) {}

20 
‹m¶©e
 <
şass
 
S
>

21 
ex¶ic™
 
šlše
 
	`R‘uºV®ue
(cÚ¡ 
R‘uºV®ue
<
S
>& 
th©
)

22 : 
	$v®ue_
(
th©
.
v®ue_
) {

23 
	`TYPE_CHECK
(
T
, 
S
);

24 
	}
}

27 
	g‹m¶©e
 <
ty³Çme
 
	gS
> 
šlše
 
S‘
(cÚ¡ 
v8
::
Loÿl
<
S
> &
hªdË
) {

28 
TYPE_CHECK
(
T
, 
S
);

29 
	gv®ue_
.
S‘
(
hªdË
);

32 
	g‹m¶©e
 <
ty³Çme
 
	gS
> 
šlše
 
S‘
(cÚ¡ 
Glob®
<
S
> &
hªdË
) {

33 
TYPE_CHECK
(
T
, 
S
);

34 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

35 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && \

36 (
V8_MINOR_VERSION
 > 5 || (V8_MINOR_VERSION == 5 && \

37 
defšed
(
V8_BUILD_NUMBER
) && V8_BUILD_NUMBER >= 8))))

38 
v®ue_
.
S‘
(
hªdË
);

40 
	gv®ue_
.
S‘
(*
»š‹½»t_ÿ¡
<cÚ¡ 
v8
::
P”si¡’t
<
S
>*>(&
hªdË
));

41 
	gcÚ¡_ÿ¡
<
	gGlob®
<
	gS
> &>(
	ghªdË
).
Re£t
();

46 
šlše
 
	$S‘
(
boŞ
 
v®ue
) {

47 
	`TYPE_CHECK
(
T
, 
v8
::
BoŞ—n
);

48 
v®ue_
.
	`S‘
(
v®ue
);

49 
	}
}

51 
šlše
 
	$S‘
(
i
) {

52 
	`TYPE_CHECK
(
T
, 
v8
::
Numb”
);

53 
v®ue_
.
	`S‘
(
i
);

54 
	}
}

56 
šlše
 
	$S‘
(
št32_t
 
i
) {

57 
	`TYPE_CHECK
(
T
, 
v8
::
IÁeg”
);

58 
v®ue_
.
	`S‘
(
i
);

59 
	}
}

61 
šlše
 
	$S‘
(
ušt32_t
 
i
) {

62 
	`TYPE_CHECK
(
T
, 
v8
::
IÁeg”
);

63 
v®ue_
.
	`S‘
(
i
);

64 
	}
}

67 
šlše
 
	$S‘NuÎ
() {

68 
	`TYPE_CHECK
(
T
, 
v8
::
Prim™ive
);

69 
v®ue_
.
	`S‘NuÎ
();

70 
	}
}

72 
šlše
 
	$S‘Undefšed
() {

73 
	`TYPE_CHECK
(
T
, 
v8
::
Prim™ive
);

74 
v®ue_
.
	`S‘Undefšed
();

75 
	}
}

77 
šlše
 
	$S‘Em±ySŒšg
() {

78 
	`TYPE_CHECK
(
T
, 
v8
::
SŒšg
);

79 
v®ue_
.
	`S‘Em±ySŒšg
();

80 
	}
}

83 
šlše
 
	gv8
::
IsŞ©e
 *
	$G‘IsŞ©e
() const {

84  
v®ue_
.
	`G‘IsŞ©e
();

85 
	}
}

88 
	g‹m¶©e
<
ty³Çme
 
	gS
>

89 
šlše
 
	$S‘
(
S
 *
wh©ev”
è{ 
	`TYPE_CHECK
(S*, 
v8
::
Prim™ive
); 
	}
}

92 
	g‹m¶©e
<
ty³Çme
 
	gT
>

93 şas 
	cFunùiÚC®lbackInfo
 {

94 cÚ¡ 
	mv8
::
FunùiÚC®lbackInfo
<
T
> &
šfo_
;

95 cÚ¡ 
	mv8
::
Loÿl
<
v8
::
V®ue
> 
d©a_
;

97 
	mpublic
:

98 
ex¶ic™
 
šlše
 
FunùiÚC®lbackInfo
(

99 cÚ¡ 
v8
::
FunùiÚC®lbackInfo
<
T
> &
šfo


100 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

101 
šfo_
(
šfo
)

102 , 
	$d©a_
(
d©a
) {}

104 
šlše
 
R‘uºV®ue
<
T
> 
	$G‘R‘uºV®ue
() const {

105  
R‘uºV®ue
<
T
>(
šfo_
.
	`G‘R‘uºV®ue
());

106 
	}
}

108 
šlše
 
	gv8
::
Loÿl
<
v8
::
FunùiÚ
> 
	$C®Ëe
(ècÚ¡ {  
šfo_
.
	`C®Ëe
(); 
	}
}

109 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$D©a
(ècÚ¡ {  
d©a_
; 
	}
}

110 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$HŞd”
(ècÚ¡ {  
šfo_
.
	`HŞd”
(); 
	}
}

111 
šlše
 
boŞ
 
	$IsCÚ¡ruùC®l
(ècÚ¡ {  
šfo_
.
	`IsCÚ¡ruùC®l
(); 
	}
}

112 
šlše
 
	$L’gth
(ècÚ¡ {  
šfo_
.
	`L’gth
(); 
	}
}

113 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
İ”©Ü
[](
i
ècÚ¡ {  
šfo_
[i]; }

114 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$This
(ècÚ¡ {  
šfo_
.
	`This
(); 
	}
}

115 
šlše
 
	gv8
::
IsŞ©e
 *
	$G‘IsŞ©e
(ècÚ¡ {  
šfo_
.
	`G‘IsŞ©e
(); 
	}
}

118 
	g´Ùeùed
:

119 cÚ¡ 
kHŞd”Index
 = 0;

120 cÚ¡ 
	gkIsŞ©eIndex
 = 1;

121 cÚ¡ 
	gkR‘uºV®ueDeçuÉV®ueIndex
 = 2;

122 cÚ¡ 
	gkR‘uºV®ueIndex
 = 3;

123 cÚ¡ 
	gkD©aIndex
 = 4;

124 cÚ¡ 
	gkC®ËeIndex
 = 5;

125 cÚ¡ 
	gkCÚ‹xtSaveIndex
 = 6;

126 cÚ¡ 
	gkArgsL’gth
 = 7;

128 
	g´iv©e
:

129 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
FunùiÚC®lbackInfo
)

132 
	g‹m¶©e
<
ty³Çme
 
	gT
>

133 şas 
	cPrİ”tyC®lbackInfo
 {

134 cÚ¡ 
	mv8
::
Prİ”tyC®lbackInfo
<
T
> &
šfo_
;

135 cÚ¡ 
	mv8
::
Loÿl
<
v8
::
V®ue
> 
d©a_
;

137 
	mpublic
:

138 
ex¶ic™
 
šlše
 
Prİ”tyC®lbackInfo
(

139 cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<
T
> &
šfo


140 , cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

141 
šfo_
(
šfo
)

142 , 
	$d©a_
(
d©a
) {}

144 
šlše
 
v8
::
IsŞ©e
* 
	$G‘IsŞ©e
(ècÚ¡ {  
šfo_
.
	`G‘IsŞ©e
(); 
	}
}

145 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$D©a
(ècÚ¡ {  
d©a_
; 
	}
}

146 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$This
(ècÚ¡ {  
šfo_
.
	`This
(); 
	}
}

147 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$HŞd”
(ècÚ¡ {  
šfo_
.
	`HŞd”
(); 
	}
}

148 
šlše
 
	gR‘uºV®ue
<
	gT
> 
	$G‘R‘uºV®ue
() const {

149  
R‘uºV®ue
<
T
>(
šfo_
.
	`G‘R‘uºV®ue
());

150 
	}
}

152 
	g´Ùeùed
:

153 cÚ¡ 
kHŞd”Index
 = 0;

154 cÚ¡ 
	gkIsŞ©eIndex
 = 1;

155 cÚ¡ 
	gkR‘uºV®ueDeçuÉV®ueIndex
 = 2;

156 cÚ¡ 
	gkR‘uºV®ueIndex
 = 3;

157 cÚ¡ 
	gkD©aIndex
 = 4;

158 cÚ¡ 
	gkThisIndex
 = 5;

159 cÚ¡ 
	gkArgsL’gth
 = 6;

161 
	g´iv©e
:

162 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
Prİ”tyC®lbackInfo
)

165 
Çme¥aû
 
	gimp
 {

167 
FunùiÚC®lbackW¿µ”
(cÚ¡ 
v8
::
FunùiÚC®lbackInfo
<v8::
V®ue
> &
šfo
) {

168 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

169 
FunùiÚC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<FunctionCallback>(

170 
»š‹½»t_ÿ¡
<
šŒ_t
>(

171 
obj
->
G‘IÁ”ÇlF›ld
(
kFunùiÚIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

172 
	gFunùiÚC®lbackInfo
<
	gv8
::
V®ue
>

173 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

174 
ÿÎback
(
cbšfo
);

177 (*
	gN©iveFunùiÚ
)(cÚ¡ 
	tv8
::
	tFunùiÚC®lbackInfo
<v8::
	tV®ue
> &);

179 #ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


181 
G‘‹rC®lbackW¿µ”
(

182 
v8
::
Loÿl
<v8::
Name
> 
´İ”ty


183 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

184 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

185 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

186 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

187 
G‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<GetterCallback>(

188 
»š‹½»t_ÿ¡
<
šŒ_t
>(

189 
obj
->
G‘IÁ”ÇlF›ld
(
kG‘‹rIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

190 
ÿÎback
(
´İ”ty
.
As
<
v8
::
SŒšg
>(), 
cbšfo
);

193 (*
	gN©iveG‘‹r
)

194 (
	tv8
::
	tLoÿl
<v8::
	tName
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

197 
S‘‹rC®lbackW¿µ”
(

198 
v8
::
Loÿl
<v8::
Name
> 
´İ”ty


199 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


200 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<> &
šfo
) {

201 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

202 
	gPrİ”tyC®lbackInfo
<>

203 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

204 
S‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<SetterCallback>(

205 
»š‹½»t_ÿ¡
<
šŒ_t
>(

206 
obj
->
G‘IÁ”ÇlF›ld
(
kS‘‹rIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

207 
ÿÎback
(
´İ”ty
.
As
<
v8
::
SŒšg
>(), 
v®ue
, 
cbšfo
);

210 (*
	gN©iveS‘‹r
)(

211 
	tv8
::
	tLoÿl
<v8::
	tName
>

212 , 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>

213 , cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<> &);

216 
G‘‹rC®lbackW¿µ”
(

217 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


218 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

219 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

220 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

221 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

222 
G‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<GetterCallback>(

223 
»š‹½»t_ÿ¡
<
šŒ_t
>(

224 
obj
->
G‘IÁ”ÇlF›ld
(
kG‘‹rIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

225 
ÿÎback
(
´İ”ty
, 
cbšfo
);

228 (*
	gN©iveG‘‹r
)

229 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

232 
S‘‹rC®lbackW¿µ”
(

233 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


234 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


235 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<> &
šfo
) {

236 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

237 
	gPrİ”tyC®lbackInfo
<>

238 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

239 
S‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<SetterCallback>(

240 
»š‹½»t_ÿ¡
<
šŒ_t
>(

241 
obj
->
G‘IÁ”ÇlF›ld
(
kS‘‹rIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

242 
ÿÎback
(
´İ”ty
, 
v®ue
, 
cbšfo
);

245 (*
	gN©iveS‘‹r
)(

246 
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>

247 , 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>

248 , cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<> &);

251 #ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


253 
Prİ”tyG‘‹rC®lbackW¿µ”
(

254 
v8
::
Loÿl
<v8::
Name
> 
´İ”ty


255 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

256 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

257 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

258 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

259 
Prİ”tyG‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyGetterCallback>(

260 
»š‹½»t_ÿ¡
<
šŒ_t
>(

261 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyG‘‹rIndex
)

262 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

263 
ÿÎback
(
´İ”ty
.
As
<
v8
::
SŒšg
>(), 
cbšfo
);

266 (*
	gN©ivePrİ”tyG‘‹r
)

267 (
	tv8
::
	tLoÿl
<v8::
	tName
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

270 
Prİ”tyS‘‹rC®lbackW¿µ”
(

271 
v8
::
Loÿl
<v8::
Name
> 
´İ”ty


272 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


273 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

274 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

275 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

276 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

277 
Prİ”tyS‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertySetterCallback>(

278 
»š‹½»t_ÿ¡
<
šŒ_t
>(

279 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyS‘‹rIndex
)

280 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

281 
ÿÎback
(
´İ”ty
.
As
<
v8
::
SŒšg
>(), 
v®ue
, 
cbšfo
);

284 (*
	gN©ivePrİ”tyS‘‹r
)(

285 
	tv8
::
	tLoÿl
<v8::
	tName
>

286 , 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>

287 , cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

290 
Prİ”tyEnum”©ÜC®lbackW¿µ”
(

291 cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
A¼ay
> &
šfo
) {

292 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

293 
	gPrİ”tyC®lbackInfo
<
	gv8
::
A¼ay
>

294 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

295 
Prİ”tyEnum”©ÜC®lback
 
	gÿÎback
 =

296 
»š‹½»t_ÿ¡
<
Prİ”tyEnum”©ÜC®lback
>Ôeš‹½»t_ÿ¡<
šŒ_t
>(

297 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyEnum”©ÜIndex
)

298 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

299 
ÿÎback
(
cbšfo
);

302 (*
	gN©ivePrİ”tyEnum”©Ü
)

303 (cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tA¼ay
> &);

306 
Prİ”tyD–‘”C®lbackW¿µ”
(

307 
v8
::
Loÿl
<v8::
Name
> 
´İ”ty


308 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
BoŞ—n
> &
šfo
) {

309 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

310 
	gPrİ”tyC®lbackInfo
<
	gv8
::
BoŞ—n
>

311 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

312 
Prİ”tyD–‘”C®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyDeleterCallback>(

313 
»š‹½»t_ÿ¡
<
šŒ_t
>(

314 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyD–‘”Index
)

315 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

316 
ÿÎback
(
´İ”ty
.
As
<
v8
::
SŒšg
>(), 
cbšfo
);

319 (
	gN©ivePrİ”tyD–‘”
)

320 (
	tv8
::
	tLoÿl
<v8::
	tName
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tBoŞ—n
> &);

323 
Prİ”tyQu”yC®lbackW¿µ”
(

324 
v8
::
Loÿl
<v8::
Name
> 
´İ”ty


325 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
IÁeg”
> &
šfo
) {

326 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

327 
	gPrİ”tyC®lbackInfo
<
	gv8
::
IÁeg”
>

328 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

329 
Prİ”tyQu”yC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyQueryCallback>(

330 
»š‹½»t_ÿ¡
<
šŒ_t
>(

331 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyQu”yIndex
)

332 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

333 
ÿÎback
(
´İ”ty
.
As
<
v8
::
SŒšg
>(), 
cbšfo
);

336 (*
	gN©ivePrİ”tyQu”y
)

337 (
	tv8
::
	tLoÿl
<v8::
	tName
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tIÁeg”
> &);

340 
Prİ”tyG‘‹rC®lbackW¿µ”
(

341 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


342 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

343 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

344 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

345 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

346 
Prİ”tyG‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyGetterCallback>(

347 
»š‹½»t_ÿ¡
<
šŒ_t
>(

348 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyG‘‹rIndex
)

349 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

350 
ÿÎback
(
´İ”ty
, 
cbšfo
);

353 (*
	gN©ivePrİ”tyG‘‹r
)

354 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

357 
Prİ”tyS‘‹rC®lbackW¿µ”
(

358 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


359 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


360 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

361 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

362 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

363 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

364 
Prİ”tyS‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertySetterCallback>(

365 
»š‹½»t_ÿ¡
<
šŒ_t
>(

366 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyS‘‹rIndex
)

367 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

368 
ÿÎback
(
´İ”ty
, 
v®ue
, 
cbšfo
);

371 (*
	gN©ivePrİ”tyS‘‹r
)(

372 
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>

373 , 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>

374 , cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

377 
Prİ”tyEnum”©ÜC®lbackW¿µ”
(

378 cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
A¼ay
> &
šfo
) {

379 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

380 
	gPrİ”tyC®lbackInfo
<
	gv8
::
A¼ay
>

381 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

382 
Prİ”tyEnum”©ÜC®lback
 
	gÿÎback
 =

383 
»š‹½»t_ÿ¡
<
Prİ”tyEnum”©ÜC®lback
>Ôeš‹½»t_ÿ¡<
šŒ_t
>(

384 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyEnum”©ÜIndex
)

385 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

386 
ÿÎback
(
cbšfo
);

389 (*
	gN©ivePrİ”tyEnum”©Ü
)

390 (cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tA¼ay
> &);

393 
Prİ”tyD–‘”C®lbackW¿µ”
(

394 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


395 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
BoŞ—n
> &
šfo
) {

396 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

397 
	gPrİ”tyC®lbackInfo
<
	gv8
::
BoŞ—n
>

398 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

399 
Prİ”tyD–‘”C®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyDeleterCallback>(

400 
»š‹½»t_ÿ¡
<
šŒ_t
>(

401 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyD–‘”Index
)

402 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

403 
ÿÎback
(
´İ”ty
, 
cbšfo
);

406 (
	gN©ivePrİ”tyD–‘”
)

407 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tBoŞ—n
> &);

410 
Prİ”tyQu”yC®lbackW¿µ”
(

411 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


412 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
IÁeg”
> &
šfo
) {

413 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

414 
	gPrİ”tyC®lbackInfo
<
	gv8
::
IÁeg”
>

415 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

416 
Prİ”tyQu”yC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyQueryCallback>(

417 
»š‹½»t_ÿ¡
<
šŒ_t
>(

418 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyQu”yIndex
)

419 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

420 
ÿÎback
(
´İ”ty
, 
cbšfo
);

423 (*
	gN©ivePrİ”tyQu”y
)

424 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tPrİ”tyC®lbackInfo
<v8::
	tIÁeg”
> &);

428 
IndexG‘‹rC®lbackW¿µ”
(

429 
ušt32_t
 
šdex
, cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

430 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

431 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

432 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

433 
IndexG‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexGetterCallback>(

434 
»š‹½»t_ÿ¡
<
šŒ_t
>(

435 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyG‘‹rIndex
)

436 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

437 
ÿÎback
(
šdex
, 
cbšfo
);

440 (*
	gN©iveIndexG‘‹r
)

441 (
	tušt32_t
, cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

444 
IndexS‘‹rC®lbackW¿µ”
(

445 
ušt32_t
 
šdex


446 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


447 , cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
V®ue
> &
šfo
) {

448 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

449 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

450 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

451 
IndexS‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexSetterCallback>(

452 
»š‹½»t_ÿ¡
<
šŒ_t
>(

453 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyS‘‹rIndex
)

454 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

455 
ÿÎback
(
šdex
, 
v®ue
, 
cbšfo
);

458 (*
	gN©iveIndexS‘‹r
)(

459 
	tušt32_t


460 , 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>

461 , cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tV®ue
> &);

464 
IndexEnum”©ÜC®lbackW¿µ”
(

465 cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
A¼ay
> &
šfo
) {

466 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

467 
	gPrİ”tyC®lbackInfo
<
	gv8
::
A¼ay
>

468 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

469 
IndexEnum”©ÜC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexEnumeratorCallback>(

470 
»š‹½»t_ÿ¡
<
šŒ_t
>(

471 
obj
->
G‘IÁ”ÇlF›ld
(

472 
kIndexPrİ”tyEnum”©ÜIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

473 
ÿÎback
(
cbšfo
);

476 (*
	gN©iveIndexEnum”©Ü
)

477 (cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tA¼ay
> &);

480 
IndexD–‘”C®lbackW¿µ”
(

481 
ušt32_t
 
šdex
, cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
BoŞ—n
> &
šfo
) {

482 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

483 
	gPrİ”tyC®lbackInfo
<
	gv8
::
BoŞ—n
>

484 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

485 
IndexD–‘”C®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexDeleterCallback>(

486 
»š‹½»t_ÿ¡
<
šŒ_t
>(

487 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyD–‘”Index
)

488 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

489 
ÿÎback
(
šdex
, 
cbšfo
);

492 (*
	gN©iveIndexD–‘”
)

493 (
	tušt32_t
, cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tBoŞ—n
> &);

496 
IndexQu”yC®lbackW¿µ”
(

497 
ušt32_t
 
šdex
, cÚ¡ 
v8
::
Prİ”tyC®lbackInfo
<v8::
IÁeg”
> &
šfo
) {

498 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

499 
	gPrİ”tyC®lbackInfo
<
	gv8
::
IÁeg”
>

500 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

501 
IndexQu”yC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexQueryCallback>(

502 
»š‹½»t_ÿ¡
<
šŒ_t
>(

503 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyQu”yIndex
)

504 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

505 
ÿÎback
(
šdex
, 
cbšfo
);

508 (*
	gN©iveIndexQu”y
)

509 (
	tušt32_t
, cÚ¡ 
	tv8
::
	tPrİ”tyC®lbackInfo
<v8::
	tIÁeg”
> &);

	@utils/webnao/node_modules/nan/nan_callbacks_pre_12_inl.h

9 #iâdeà
NAN_CALLBACKS_PRE_12_INL_H_


10 
	#NAN_CALLBACKS_PRE_12_INL_H_


	)

12 
Çme¥aû
 
	gimp
 {

13 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
şass
 
	gR‘uºV®ueImp
;

16 
	g‹m¶©e
<
ty³Çme
 
	gT
>

17 şas 
	cR‘uºV®ue
 {

18 
	mv8
::
IsŞ©e
 *
isŞ©e_
;

19 
	mv8
::
P”si¡’t
<
T
> *
v®ue_
;

20 
ä›nd
 
şass
 
	mimp
::
R‘uºV®ueImp
<
T
>;

22 
	mpublic
:

23 
‹m¶©e
 <
şass
 
S
>

24 
ex¶ic™
 
šlše
 
R‘uºV®ue
(
v8
::
IsŞ©e
 *
isŞ©e
, v8::
P”si¡’t
<
S
> *
p
) :

25 
isŞ©e_
(
isŞ©e
), 
	$v®ue_
(
p
) {}

26 
‹m¶©e
 <
şass
 
S
>

27 
ex¶ic™
 
šlše
 
	`R‘uºV®ue
(cÚ¡ 
R‘uºV®ue
<
S
>& 
th©
)

28 : 
	`isŞ©e_
(
th©
.
isŞ©e_
), 
	$v®ue_
(
th©
.
v®ue_
) {

29 
	`TYPE_CHECK
(
T
, 
S
);

30 
	}
}

33 
	g‹m¶©e
 <
ty³Çme
 
	gS
> 
šlše
 
S‘
(cÚ¡ 
v8
::
Loÿl
<
S
> &
hªdË
) {

34 
TYPE_CHECK
(
T
, 
S
);

35 
	gv®ue_
->
Di¥o£
();

36 *
	gv®ue_
 = 
v8
::
P”si¡’t
<
T
>::
New
(
hªdË
);

39 
	g‹m¶©e
 <
ty³Çme
 
	gS
> 
šlše
 
S‘
(cÚ¡ 
Glob®
<
S
> &
hªdË
) {

40 
TYPE_CHECK
(
T
, 
S
);

41 
	gv®ue_
->
Di¥o£
();

42 *
	gv®ue_
 = 
v8
::
P”si¡’t
<
T
>::
New
(
hªdË
.
³rsi¡’t
);

43 
	gcÚ¡_ÿ¡
<
	gGlob®
<
	gS
> &>(
	ghªdË
).
Re£t
();

47 
šlše
 
	$S‘
(
boŞ
 
v®ue
) {

48 
v8
::
HªdËScİe
 
scİe
;

50 
	`TYPE_CHECK
(
T
, 
v8
::
BoŞ—n
);

51 
v®ue_
->
	`Di¥o£
();

52 *
v®ue_
 = 
v8
::
P”si¡’t
<
T
>::
	`New
(v8::
BoŞ—n
::New(
v®ue
));

53 
	}
}

55 
šlše
 
	$S‘
(
i
) {

56 
v8
::
HªdËScİe
 
scİe
;

58 
	`TYPE_CHECK
(
T
, 
v8
::
Numb”
);

59 
v®ue_
->
	`Di¥o£
();

60 *
v®ue_
 = 
v8
::
P”si¡’t
<
T
>::
	`New
(v8::
Numb”
::New(
i
));

61 
	}
}

63 
šlše
 
	$S‘
(
št32_t
 
i
) {

64 
v8
::
HªdËScİe
 
scİe
;

66 
	`TYPE_CHECK
(
T
, 
v8
::
IÁeg”
);

67 
v®ue_
->
	`Di¥o£
();

68 *
v®ue_
 = 
v8
::
P”si¡’t
<
T
>::
	`New
(v8::
IÁ32
::New(
i
));

69 
	}
}

71 
šlše
 
	$S‘
(
ušt32_t
 
i
) {

72 
v8
::
HªdËScİe
 
scİe
;

74 
	`TYPE_CHECK
(
T
, 
v8
::
IÁeg”
);

75 
v®ue_
->
	`Di¥o£
();

76 *
v®ue_
 = 
v8
::
P”si¡’t
<
T
>::
	`New
(v8::
Ušt32
::
	`NewFromUnsigÃd
(
i
));

77 
	}
}

80 
šlše
 
	$S‘NuÎ
() {

81 
v8
::
HªdËScİe
 
scİe
;

83 
	`TYPE_CHECK
(
T
, 
v8
::
Prim™ive
);

84 
v®ue_
->
	`Di¥o£
();

85 *
v®ue_
 = 
v8
::
P”si¡’t
<
T
>::
	`New
(v8::
	`NuÎ
());

86 
	}
}

88 
šlše
 
	$S‘Undefšed
() {

89 
v8
::
HªdËScİe
 
scİe
;

91 
	`TYPE_CHECK
(
T
, 
v8
::
Prim™ive
);

92 
v®ue_
->
	`Di¥o£
();

93 *
v®ue_
 = 
v8
::
P”si¡’t
<
T
>::
	`New
(v8::
	`Undefšed
());

94 
	}
}

96 
šlše
 
	$S‘Em±ySŒšg
() {

97 
v8
::
HªdËScİe
 
scİe
;

99 
	`TYPE_CHECK
(
T
, 
v8
::
SŒšg
);

100 
v®ue_
->
	`Di¥o£
();

101 *
v®ue_
 = 
v8
::
P”si¡’t
<
T
>::
	`New
(v8::
SŒšg
::
	`Em±y
());

102 
	}
}

105 
šlše
 
	gv8
::
IsŞ©e
 *
	$G‘IsŞ©e
() const {

106  
isŞ©e_
;

107 
	}
}

110 
	g‹m¶©e
<
ty³Çme
 
	gS
>

111 
šlše
 
	$S‘
(
S
 *
wh©ev”
è{ 
	`TYPE_CHECK
(S*, 
v8
::
Prim™ive
); 
	}
}

114 
	g‹m¶©e
<
ty³Çme
 
	gT
>

115 şas 
	cFunùiÚC®lbackInfo
 {

116 cÚ¡ 
	mv8
::
Argum’ts
 &
¬gs_
;

117 
	mv8
::
Loÿl
<
v8
::
V®ue
> 
d©a_
;

118 
	mR‘uºV®ue
<
	mT
> 
	m»tuº_v®ue_
;

119 
	mv8
::
P”si¡’t
<
T
> 
»tv®_
;

121 
	mpublic
:

122 
ex¶ic™
 
šlše
 
FunùiÚC®lbackInfo
(

123 cÚ¡ 
v8
::
Argum’ts
 &
¬gs


124 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

125 
¬gs_
(
¬gs
)

126 , 
d©a_
(
d©a
)

127 , 
»tuº_v®ue_
(
¬gs
.
G‘IsŞ©e
(), &
»tv®_
)

128 , 
»tv®_
(
v8
::
P”si¡’t
<
T
>::
New
(v8::
	$Undefšed
())) {}

130 
šlše
 ~
	$FunùiÚC®lbackInfo
() {

131 
»tv®_
.
	`Di¥o£
();

132 
»tv®_
.
	`CË¬
();

133 
	}
}

135 
šlše
 
	gR‘uºV®ue
<
	gT
> 
	$G‘R‘uºV®ue
() const {

136  
R‘uºV®ue
<
T
>(
»tuº_v®ue_
);

137 
	}
}

139 
šlše
 
	gv8
::
Loÿl
<
v8
::
FunùiÚ
> 
	$C®Ëe
(ècÚ¡ {  
¬gs_
.
	`C®Ëe
(); 
	}
}

140 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$D©a
(ècÚ¡ {  
d©a_
; 
	}
}

141 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$HŞd”
(ècÚ¡ {  
¬gs_
.
	`HŞd”
(); 
	}
}

142 
šlše
 
boŞ
 
	$IsCÚ¡ruùC®l
(ècÚ¡ {  
¬gs_
.
	`IsCÚ¡ruùC®l
(); 
	}
}

143 
šlše
 
	$L’gth
(ècÚ¡ {  
¬gs_
.
	`L’gth
(); 
	}
}

144 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
İ”©Ü
[](
i
ècÚ¡ {  
¬gs_
[i]; }

145 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$This
(ècÚ¡ {  
¬gs_
.
	`This
(); 
	}
}

146 
šlše
 
	gv8
::
IsŞ©e
 *
	$G‘IsŞ©e
(ècÚ¡ {  
¬gs_
.
	`G‘IsŞ©e
(); 
	}
}

149 
	g´Ùeùed
:

150 cÚ¡ 
kHŞd”Index
 = 0;

151 cÚ¡ 
	gkIsŞ©eIndex
 = 1;

152 cÚ¡ 
	gkR‘uºV®ueDeçuÉV®ueIndex
 = 2;

153 cÚ¡ 
	gkR‘uºV®ueIndex
 = 3;

154 cÚ¡ 
	gkD©aIndex
 = 4;

155 cÚ¡ 
	gkC®ËeIndex
 = 5;

156 cÚ¡ 
	gkCÚ‹xtSaveIndex
 = 6;

157 cÚ¡ 
	gkArgsL’gth
 = 7;

159 
	g´iv©e
:

160 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
FunùiÚC®lbackInfo
)

163 
	g‹m¶©e
<
ty³Çme
 
	gT
>

164 şas 
	cPrİ”tyC®lbackInfoBa£
 {

165 cÚ¡ 
	mv8
::
AcûssÜInfo
 &
šfo_
;

166 cÚ¡ 
	mv8
::
Loÿl
<
v8
::
V®ue
> 
d©a_
;

168 
	mpublic
:

169 
ex¶ic™
 
šlše
 
Prİ”tyC®lbackInfoBa£
(

170 cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo


171 , cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

172 
šfo_
(
šfo
)

173 , 
	$d©a_
(
d©a
) {}

175 
šlše
 
v8
::
IsŞ©e
* 
	$G‘IsŞ©e
(ècÚ¡ {  
šfo_
.
	`G‘IsŞ©e
(); 
	}
}

176 
šlše
 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
	$D©a
(ècÚ¡ {  
d©a_
; 
	}
}

177 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$This
(ècÚ¡ {  
šfo_
.
	`This
(); 
	}
}

178 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$HŞd”
(ècÚ¡ {  
šfo_
.
	`HŞd”
(); 
	}
}

180 
	g´Ùeùed
:

181 cÚ¡ 
kHŞd”Index
 = 0;

182 cÚ¡ 
	gkIsŞ©eIndex
 = 1;

183 cÚ¡ 
	gkR‘uºV®ueDeçuÉV®ueIndex
 = 2;

184 cÚ¡ 
	gkR‘uºV®ueIndex
 = 3;

185 cÚ¡ 
	gkD©aIndex
 = 4;

186 cÚ¡ 
	gkThisIndex
 = 5;

187 cÚ¡ 
	gkArgsL’gth
 = 6;

189 
	g´iv©e
:

190 
NAN_DISALLOW_ASSIGN_COPY_MOVE
(
Prİ”tyC®lbackInfoBa£
)

193 
	g‹m¶©e
<
ty³Çme
 
	gT
>

194 
şass
 
	gPrİ”tyC®lbackInfo
 : 
public
 
Prİ”tyC®lbackInfoBa£
<
T
> {

195 
R‘uºV®ue
<
T
> 
»tuº_v®ue_
;

196 
	gv8
::
P”si¡’t
<
T
> 
»tv®_
;

198 
	gpublic
:

199 
ex¶ic™
 
šlše
 
Prİ”tyC®lbackInfo
(

200 cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo


201 , cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

202 
Prİ”tyC®lbackInfoBa£
<
T
>(
šfo
, 
	gd©a
)

203 , 
»tuº_v®ue_
(
šfo
.
G‘IsŞ©e
(), &
»tv®_
)

204 , 
»tv®_
(
v8
::
P”si¡’t
<
T
>::
New
(v8::
Undefšed
())) {}

206 
šlše
 ~
Prİ”tyC®lbackInfo
() {

207 
»tv®_
.
Di¥o£
();

208 
	g»tv®_
.
CË¬
();

211 
šlše
 
	gR‘uºV®ue
<
	gT
> 
G‘R‘uºV®ue
(ècÚ¡ {  
	g»tuº_v®ue_
; }

214 
	g‹m¶©e
<>

215 
şass
 
	gPrİ”tyC®lbackInfo
<
	gv8
::
A¼ay
> :

216 
public
 
Prİ”tyC®lbackInfoBa£
<
v8
::
A¼ay
> {

217 
R‘uºV®ue
<
v8
::
A¼ay
> 
»tuº_v®ue_
;

218 
	gv8
::
P”si¡’t
<
v8
::
A¼ay
> 
»tv®_
;

220 
	gpublic
:

221 
ex¶ic™
 
šlše
 
Prİ”tyC®lbackInfo
(

222 cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo


223 , cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

224 
Prİ”tyC®lbackInfoBa£
<
v8
::
A¼ay
>(
šfo
, 
	gd©a
)

225 , 
»tuº_v®ue_
(
šfo
.
G‘IsŞ©e
(), &
»tv®_
)

226 , 
»tv®_
(
v8
::
P”si¡’t
<v8::
A¼ay
>::
New
(v8::
Loÿl
<v8::Array>())) {}

228 
šlše
 ~
Prİ”tyC®lbackInfo
() {

229 
»tv®_
.
Di¥o£
();

230 
	g»tv®_
.
CË¬
();

233 
šlše
 
	gR‘uºV®ue
<
	gv8
::
A¼ay
> 
G‘R‘uºV®ue
() const {

234  
»tuº_v®ue_
;

238 
	g‹m¶©e
<>

239 
şass
 
	gPrİ”tyC®lbackInfo
<
	gv8
::
BoŞ—n
> :

240 
public
 
Prİ”tyC®lbackInfoBa£
<
v8
::
BoŞ—n
> {

241 
R‘uºV®ue
<
v8
::
BoŞ—n
> 
»tuº_v®ue_
;

242 
	gv8
::
P”si¡’t
<
v8
::
BoŞ—n
> 
»tv®_
;

244 
	gpublic
:

245 
ex¶ic™
 
šlše
 
Prİ”tyC®lbackInfo
(

246 cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo


247 , cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

248 
Prİ”tyC®lbackInfoBa£
<
v8
::
BoŞ—n
>(
šfo
, 
	gd©a
)

249 , 
»tuº_v®ue_
(
šfo
.
G‘IsŞ©e
(), &
»tv®_
)

250 , 
»tv®_
(
v8
::
P”si¡’t
<v8::
BoŞ—n
>::
New
(v8::
Loÿl
<v8::Boolean>())) {}

252 
šlše
 ~
Prİ”tyC®lbackInfo
() {

253 
»tv®_
.
Di¥o£
();

254 
	g»tv®_
.
CË¬
();

257 
šlše
 
	gR‘uºV®ue
<
	gv8
::
BoŞ—n
> 
G‘R‘uºV®ue
() const {

258  
»tuº_v®ue_
;

262 
	g‹m¶©e
<>

263 
şass
 
	gPrİ”tyC®lbackInfo
<
	gv8
::
IÁeg”
> :

264 
public
 
Prİ”tyC®lbackInfoBa£
<
v8
::
IÁeg”
> {

265 
R‘uºV®ue
<
v8
::
IÁeg”
> 
»tuº_v®ue_
;

266 
	gv8
::
P”si¡’t
<
v8
::
IÁeg”
> 
»tv®_
;

268 
	gpublic
:

269 
ex¶ic™
 
šlše
 
Prİ”tyC®lbackInfo
(

270 cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo


271 , cÚ¡ 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) :

272 
Prİ”tyC®lbackInfoBa£
<
v8
::
IÁeg”
>(
šfo
, 
	gd©a
)

273 , 
»tuº_v®ue_
(
šfo
.
G‘IsŞ©e
(), &
»tv®_
)

274 , 
»tv®_
(
v8
::
P”si¡’t
<v8::
IÁeg”
>::
New
(v8::
Loÿl
<v8::Integer>())) {}

276 
šlše
 ~
Prİ”tyC®lbackInfo
() {

277 
»tv®_
.
Di¥o£
();

278 
	g»tv®_
.
CË¬
();

281 
šlše
 
	gR‘uºV®ue
<
	gv8
::
IÁeg”
> 
G‘R‘uºV®ue
() const {

282  
»tuº_v®ue_
;

286 
Çme¥aû
 
	gimp
 {

287 
	g‹m¶©e
<
ty³Çme
 
	gT
>

288 
şass
 
	gR‘uºV®ueImp
 : 
public
 
R‘uºV®ue
<
T
> {

289 
public
:

290 
ex¶ic™
 
R‘uºV®ueImp
(
R‘uºV®ue
<
T
> 
th©
) :

291 
R‘uºV®ue
<
T
>(
th©
) {}

292 
šlše
 
v8
::
HªdË
<
T
> 
V®ue
() {

293  *
R‘uºV®ue
<
T
>::
v®ue_
;

298 
	gv8
::
HªdË
<
v8
::
V®ue
> 
FunùiÚC®lbackW¿µ”
(cÚ¡ v8::
Argum’ts
 &
¬gs
) {

299 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
¬gs
.
D©a
().
As
<v8::Object>();

300 
FunùiÚC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<FunctionCallback>(

301 
»š‹½»t_ÿ¡
<
šŒ_t
>(

302 
obj
->
G‘IÁ”ÇlF›ld
(
kFunùiÚIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

303 
	gFunùiÚC®lbackInfo
<
	gv8
::
V®ue
>

304 
cbšfo
(
¬gs
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

305 
ÿÎback
(
cbšfo
);

306  
	gR‘uºV®ueImp
<
	gv8
::
V®ue
>(
cbšfo
.
G‘R‘uºV®ue
()).Value();

309 
	gv8
::
	tHªdË
<
	tv8
::
	tV®ue
> (*
	tN©iveFunùiÚ
)(cÚ¡ v8::
	tArgum’ts
 &);

312 
	gv8
::
HªdË
<
v8
::
V®ue
> 
G‘‹rC®lbackW¿µ”
(

313 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
, cÚ¡ v8::
AcûssÜInfo
 &
šfo
) {

314 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

315 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

316 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

317 
G‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<GetterCallback>(

318 
»š‹½»t_ÿ¡
<
šŒ_t
>(

319 
obj
->
G‘IÁ”ÇlF›ld
(
kG‘‹rIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

320 
ÿÎback
(
´İ”ty
, 
cbšfo
);

321  
	gR‘uºV®ueImp
<
	gv8
::
V®ue
>(
cbšfo
.
G‘R‘uºV®ue
()).Value();

324 
	gv8
::
	tHªdË
<
	tv8
::
	tV®ue
> (*
	tN©iveG‘‹r
)

325 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tAcûssÜInfo
 &);

328 
S‘‹rC®lbackW¿µ”
(

329 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


330 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


331 , cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

332 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

333 
	gPrİ”tyC®lbackInfo
<>

334 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

335 
S‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<SetterCallback>(

336 
»š‹½»t_ÿ¡
<
šŒ_t
>(

337 
obj
->
G‘IÁ”ÇlF›ld
(
kS‘‹rIndex
).
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

338 
ÿÎback
(
´İ”ty
, 
v®ue
, 
cbšfo
);

341 (*
	gN©iveS‘‹r
)

342 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, v8::Loÿl<v8::
	tV®ue
>, cÚ¡ v8::
	tAcûssÜInfo
 &);

345 
	gv8
::
HªdË
<
v8
::
V®ue
> 
Prİ”tyG‘‹rC®lbackW¿µ”
(

346 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
, cÚ¡ v8::
AcûssÜInfo
 &
šfo
) {

347 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

348 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

349 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

350 
Prİ”tyG‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyGetterCallback>(

351 
»š‹½»t_ÿ¡
<
šŒ_t
>(

352 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyG‘‹rIndex
)

353 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

354 
ÿÎback
(
´İ”ty
, 
cbšfo
);

355  
	gR‘uºV®ueImp
<
	gv8
::
V®ue
>(
cbšfo
.
G‘R‘uºV®ue
()).Value();

358 
	gv8
::
	tHªdË
<
	tv8
::
	tV®ue
> (*
	tN©ivePrİ”tyG‘‹r
)

359 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tAcûssÜInfo
 &);

362 
	gv8
::
HªdË
<
v8
::
V®ue
> 
Prİ”tyS‘‹rC®lbackW¿µ”
(

363 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


364 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


365 , cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

366 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

367 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

368 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

369 
Prİ”tyS‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertySetterCallback>(

370 
»š‹½»t_ÿ¡
<
šŒ_t
>(

371 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyS‘‹rIndex
)

372 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

373 
ÿÎback
(
´İ”ty
, 
v®ue
, 
cbšfo
);

374  
	gR‘uºV®ueImp
<
	gv8
::
V®ue
>(
cbšfo
.
G‘R‘uºV®ue
()).Value();

377 
	gv8
::
	tHªdË
<
	tv8
::
	tV®ue
> (*
	tN©ivePrİ”tyS‘‹r
)

378 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, v8::Loÿl<v8::
	tV®ue
>, cÚ¡ v8::
	tAcûssÜInfo
 &);

381 
	gv8
::
HªdË
<
v8
::
A¼ay
> 
Prİ”tyEnum”©ÜC®lbackW¿µ”
(

382 cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

383 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

384 
	gPrİ”tyC®lbackInfo
<
	gv8
::
A¼ay
>

385 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

386 
Prİ”tyEnum”©ÜC®lback
 
	gÿÎback
 =

387 
»š‹½»t_ÿ¡
<
Prİ”tyEnum”©ÜC®lback
>Ôeš‹½»t_ÿ¡<
šŒ_t
>(

388 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyEnum”©ÜIndex
)

389 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

390 
ÿÎback
(
cbšfo
);

391  
	gR‘uºV®ueImp
<
	gv8
::
A¼ay
>(
cbšfo
.
G‘R‘uºV®ue
()).
V®ue
();

394 
	gv8
::
	tHªdË
<
	tv8
::
	tA¼ay
> (*
	tN©ivePrİ”tyEnum”©Ü
)

395 (cÚ¡ 
	tv8
::
	tAcûssÜInfo
 &);

398 
	gv8
::
HªdË
<
v8
::
BoŞ—n
> 
Prİ”tyD–‘”C®lbackW¿µ”
(

399 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty


400 , cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

401 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

402 
	gPrİ”tyC®lbackInfo
<
	gv8
::
BoŞ—n
>

403 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

404 
Prİ”tyD–‘”C®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyDeleterCallback>(

405 
»š‹½»t_ÿ¡
<
šŒ_t
>(

406 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyD–‘”Index
)

407 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

408 
ÿÎback
(
´İ”ty
, 
cbšfo
);

409  
	gR‘uºV®ueImp
<
	gv8
::
BoŞ—n
>(
cbšfo
.
G‘R‘uºV®ue
()).
V®ue
();

412 
	gv8
::
	tHªdË
<
	tv8
::
	tBoŞ—n
> (
	tN©ivePrİ”tyD–‘”
)

413 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tAcûssÜInfo
 &);

416 
	gv8
::
HªdË
<
v8
::
IÁeg”
> 
Prİ”tyQu”yC®lbackW¿µ”
(

417 
v8
::
Loÿl
<v8::
SŒšg
> 
´İ”ty
, cÚ¡ v8::
AcûssÜInfo
 &
šfo
) {

418 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

419 
	gPrİ”tyC®lbackInfo
<
	gv8
::
IÁeg”
>

420 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

421 
Prİ”tyQu”yC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<PropertyQueryCallback>(

422 
»š‹½»t_ÿ¡
<
šŒ_t
>(

423 
obj
->
G‘IÁ”ÇlF›ld
(
kPrİ”tyQu”yIndex
)

424 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

425 
ÿÎback
(
´İ”ty
, 
cbšfo
);

426  
	gR‘uºV®ueImp
<
	gv8
::
IÁeg”
>(
cbšfo
.
G‘R‘uºV®ue
()).
V®ue
();

429 
	gv8
::
	tHªdË
<
	tv8
::
	tIÁeg”
> (*
	tN©ivePrİ”tyQu”y
)

430 (
	tv8
::
	tLoÿl
<v8::
	tSŒšg
>, cÚ¡ v8::
	tAcûssÜInfo
 &);

433 
	gv8
::
HªdË
<
v8
::
V®ue
> 
IndexG‘‹rC®lbackW¿µ”
(

434 
ušt32_t
 
šdex
, cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

435 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

436 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

437 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

438 
IndexG‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexGetterCallback>(

439 
»š‹½»t_ÿ¡
<
šŒ_t
>(

440 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyG‘‹rIndex
)

441 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

442 
ÿÎback
(
šdex
, 
cbšfo
);

443  
	gR‘uºV®ueImp
<
	gv8
::
V®ue
>(
cbšfo
.
G‘R‘uºV®ue
()).Value();

446 
	gv8
::
	tHªdË
<
	tv8
::
	tV®ue
> (*
	tN©iveIndexG‘‹r
)

447 (
	tušt32_t
, cÚ¡ 
	tv8
::
	tAcûssÜInfo
 &);

450 
	gv8
::
HªdË
<
v8
::
V®ue
> 
IndexS‘‹rC®lbackW¿µ”
(

451 
ušt32_t
 
šdex


452 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


453 , cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

454 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

455 
	gPrİ”tyC®lbackInfo
<
	gv8
::
V®ue
>

456 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

457 
IndexS‘‹rC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexSetterCallback>(

458 
»š‹½»t_ÿ¡
<
šŒ_t
>(

459 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyS‘‹rIndex
)

460 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

461 
ÿÎback
(
šdex
, 
v®ue
, 
cbšfo
);

462  
	gR‘uºV®ueImp
<
	gv8
::
V®ue
>(
cbšfo
.
G‘R‘uºV®ue
()).Value();

465 
	gv8
::
	tHªdË
<
	tv8
::
	tV®ue
> (*
	tN©iveIndexS‘‹r
)

466 (
	tušt32_t
, 
	tv8
::
	tLoÿl
<v8::
	tV®ue
>, cÚ¡ v8::
	tAcûssÜInfo
 &);

469 
	gv8
::
HªdË
<
v8
::
A¼ay
> 
IndexEnum”©ÜC®lbackW¿µ”
(

470 cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

471 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

472 
	gPrİ”tyC®lbackInfo
<
	gv8
::
A¼ay
>

473 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

474 
IndexEnum”©ÜC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexEnumeratorCallback>(

475 
»š‹½»t_ÿ¡
<
šŒ_t
>(

476 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyEnum”©ÜIndex
)

477 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

478 
ÿÎback
(
cbšfo
);

479  
	gR‘uºV®ueImp
<
	gv8
::
A¼ay
>(
cbšfo
.
G‘R‘uºV®ue
()).
V®ue
();

482 
	gv8
::
	tHªdË
<
	tv8
::
	tA¼ay
> (*
	tN©iveIndexEnum”©Ü
)

483 (cÚ¡ 
	tv8
::
	tAcûssÜInfo
 &);

486 
	gv8
::
HªdË
<
v8
::
BoŞ—n
> 
IndexD–‘”C®lbackW¿µ”
(

487 
ušt32_t
 
šdex
, cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

488 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

489 
	gPrİ”tyC®lbackInfo
<
	gv8
::
BoŞ—n
>

490 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

491 
IndexD–‘”C®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexDeleterCallback>(

492 
»š‹½»t_ÿ¡
<
šŒ_t
>(

493 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyD–‘”Index
)

494 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

495 
ÿÎback
(
šdex
, 
cbšfo
);

496  
	gR‘uºV®ueImp
<
	gv8
::
BoŞ—n
>(
cbšfo
.
G‘R‘uºV®ue
()).
V®ue
();

499 
	gv8
::
	tHªdË
<
	tv8
::
	tBoŞ—n
> (*
	tN©iveIndexD–‘”
)

500 (
	tušt32_t
, cÚ¡ 
	tv8
::
	tAcûssÜInfo
 &);

503 
	gv8
::
HªdË
<
v8
::
IÁeg”
> 
IndexQu”yC®lbackW¿µ”
(

504 
ušt32_t
 
šdex
, cÚ¡ 
v8
::
AcûssÜInfo
 &
šfo
) {

505 
v8
::
Loÿl
<v8::
Objeù
> 
obj
 = 
šfo
.
D©a
().
As
<v8::Object>();

506 
	gPrİ”tyC®lbackInfo
<
	gv8
::
IÁeg”
>

507 
cbšfo
(
šfo
, 
obj
->
G‘IÁ”ÇlF›ld
(
kD©aIndex
));

508 
IndexQu”yC®lback
 
	gÿÎback
 = 
»š‹½»t_ÿ¡
<IndexQueryCallback>(

509 
»š‹½»t_ÿ¡
<
šŒ_t
>(

510 
obj
->
G‘IÁ”ÇlF›ld
(
kIndexPrİ”tyQu”yIndex
)

511 .
As
<
v8
::
Ex‹º®
>()->
V®ue
()));

512 
ÿÎback
(
šdex
, 
cbšfo
);

513  
	gR‘uºV®ueImp
<
	gv8
::
IÁeg”
>(
cbšfo
.
G‘R‘uºV®ue
()).
V®ue
();

516 
	gv8
::
	tHªdË
<
	tv8
::
	tIÁeg”
> (*
	tN©iveIndexQu”y
)

517 (
	tušt32_t
, cÚ¡ 
	tv8
::
	tAcûssÜInfo
 &);

	@utils/webnao/node_modules/nan/nan_converters.h

9 #iâdeà
NAN_CONVERTERS_H_


10 
	#NAN_CONVERTERS_H_


	)

12 
Çme¥aû
 
	gimp
 {

13 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sToFaùÜyBa£
 {

14 
	gMaybeLoÿl
<
	tT
> 
	t»tuº_t
;

16 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	sV®ueFaùÜyBa£
 { 
	gMaybe
<
	tT
> 
	t»tuº_t
; };

18 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
	gToFaùÜy
;

20 
	#X
(
TYPE
) \

21 
‹m¶©e
<> \

22 
ToFaùÜy
<
v8
::
TYPE
> : 
ToFaùÜyBa£
<v8::TYPE> { \

23 
šlše
 
»tuº_t
 
	`cÚv”t
(
v8
::
Loÿl
<v8::
V®ue
> 
v®
); \

24 };

	)

26 
X
(
BoŞ—n
)

27 
X
(
Numb”
)

28 
X
(
SŒšg
)

29 
X
(
Objeù
)

30 
X
(
IÁeg”
)

31 
X
(
Ušt32
)

32 
X
(
IÁ32
)

34 #undeà
X


36 
	#X
(
TYPE
) \

37 
‹m¶©e
<> \

38 
ToFaùÜy
<
TYPE
> : 
V®ueFaùÜyBa£
<TYPE> { \

39 
šlše
 
»tuº_t
 
	`cÚv”t
(
v8
::
Loÿl
<v8::
V®ue
> 
v®
); \

40 };

	)

42 
X
(
boŞ
)

43 
X
()

44 
X
(
št64_t
)

45 
X
(
ušt32_t
)

46 
X
(
št32_t
)

48 #undeà
X


51 
	g‹m¶©e
<
ty³Çme
 
	gT
>

52 
šlše


53 
ty³Çme
 
	gimp
::
ToFaùÜy
<
T
>::
»tuº_t
 
To
(
v8
::
Loÿl
<v8::
V®ue
> 
v®
) {

54  
imp
::
ToFaùÜy
<
T
>::
cÚv”t
(
v®
);

57 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

58 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

59 
	~"Çn_cÚv”‹rs_43_šl.h
"

61 
	~"Çn_cÚv”‹rs_´e_43_šl.h
"

	@utils/webnao/node_modules/nan/nan_converters_43_inl.h

9 #iâdeà
NAN_CONVERTERS_43_INL_H_


10 
	#NAN_CONVERTERS_43_INL_H_


	)

12 
	#X
(
TYPE
) \

13 
imp
::
ToFaùÜy
<
v8
::
TYPE
>::
»tuº_t
 \

14 
imp
::
ToFaùÜy
<
v8
::
TYPE
>::
	`cÚv”t
(v8::
Loÿl
<v8::
V®ue
> 
v®
) { \

15 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
	`G‘Cu¼’t
(); \

16 
v8
::
Esÿ·bËHªdËScİe
 
	`scİe
(
isŞ©e
); \

17  
scİe
.
	`Esÿ³
( \

18 
v®
->
To
 ## 
	`TYPE
(
v8
::
IsŞ©e
::
	`G‘Cu¼’t
()->
	`G‘Cu¼’tCÚ‹xt
()) \

19 .
	`FromMaybe
(
v8
::
Loÿl
<v8::
TYPE
>())); \

20 }

	)

22 
	$X
(
BoŞ—n
)

23 
	$X
(
Numb”
)

24 
	$X
(
SŒšg
)

25 
	$X
(
Objeù
)

26 
	$X
(
IÁeg”
)

27 
	$X
(
Ušt32
)

28 
	$X
(
IÁ32
)

30 #undeà
X


32 
	#X
(
TYPE
, 
NAME
) \

33 
imp
::
ToFaùÜy
<
TYPE
>::
»tuº_t
 \

34 
imp
::
ToFaùÜy
<
TYPE
>::
	`cÚv”t
(
v8
::
Loÿl
<v8::
V®ue
> 
v®
) { \

35 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
	`G‘Cu¼’t
(); \

36 
v8
::
HªdËScİe
 
	`scİe
(
isŞ©e
); \

37  
v®
->
NAME
 ## 
	`V®ue
(
isŞ©e
->
	`G‘Cu¼’tCÚ‹xt
()); \

38 
	}

	)
}

40 
	$X
(
boŞ
, 
BoŞ—n
)

41 
	$X
(, 
Numb”
)

42 
	$X
(
št64_t
, 
IÁeg”
)

43 
	$X
(
ušt32_t
, 
Ušt32
)

44 
	$X
(
št32_t
, 
IÁ32
)

46 #undeà
X


	@utils/webnao/node_modules/nan/nan_converters_pre_43_inl.h

9 #iâdeà
NAN_CONVERTERS_PRE_43_INL_H_


10 
	#NAN_CONVERTERS_PRE_43_INL_H_


	)

12 
	#X
(
TYPE
) \

13 
imp
::
ToFaùÜy
<
v8
::
TYPE
>::
»tuº_t
 \

14 
imp
::
ToFaùÜy
<
v8
::
TYPE
>::
	`cÚv”t
(v8::
Loÿl
<v8::
V®ue
> 
v®
) { \

15  
v®
->
To
 ## 
	`TYPE
(); \

16 }

	)

18 
	$X
(
BoŞ—n
)

19 
	$X
(
Numb”
)

20 
	$X
(
SŒšg
)

21 
	$X
(
Objeù
)

22 
	$X
(
IÁeg”
)

23 
	$X
(
Ušt32
)

24 
	$X
(
IÁ32
)

26 #undeà
X


28 
	#X
(
TYPE
, 
NAME
) \

29 
imp
::
ToFaùÜy
<
TYPE
>::
»tuº_t
 \

30 
imp
::
ToFaùÜy
<
TYPE
>::
	`cÚv”t
(
v8
::
Loÿl
<v8::
V®ue
> 
v®
) { \

31  
	`Ju¡
(
v®
->
NAME
 ## 
	`V®ue
()); \

32 
	}

	)
}

34 
	$X
(
boŞ
, 
BoŞ—n
)

35 
	$X
(, 
Numb”
)

36 
	$X
(
št64_t
, 
IÁeg”
)

37 
	$X
(
ušt32_t
, 
Ušt32
)

38 
	$X
(
št32_t
, 
IÁ32
)

40 #undeà
X


	@utils/webnao/node_modules/nan/nan_implementation_12_inl.h

9 #iâdeà
NAN_IMPLEMENTATION_12_INL_H_


10 
	#NAN_IMPLEMENTATION_12_INL_H_


	)

15 
Çme¥aû
 
	gimp
 {

19 
	gFaùÜy
<
	gv8
::
A¼ay
>::
»tuº_t


20 
FaùÜy
<
v8
::
A¼ay
>::
New
() {

21  
v8
::
A¼ay
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
());

24 
	gFaùÜy
<
	gv8
::
A¼ay
>::
»tuº_t


25 
FaùÜy
<
v8
::
A¼ay
>::
New
(
Ëngth
) {

26  
v8
::
A¼ay
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
Ëngth
);

31 
	gFaùÜy
<
	gv8
::
BoŞ—n
>::
»tuº_t


32 
FaùÜy
<
v8
::
BoŞ—n
>::
New
(
boŞ
 
v®ue
) {

33  
v8
::
BoŞ—n
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
);

38 
	gFaùÜy
<
	gv8
::
BoŞ—nObjeù
>::
»tuº_t


39 
FaùÜy
<
v8
::
BoŞ—nObjeù
>::
New
(
boŞ
 
v®ue
) {

40 #ià(
NODE_MODULE_VERSION
 >ğ
NODE_6_0_MODULE_VERSION
)

41  
v8
::
BoŞ—nObjeù
::
New
(

42 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
).
	gAs
<
	gv8
::
BoŞ—nObjeù
>();

44  
	gv8
::
BoŞ—nObjeù
::
New
(
v®ue
).
As
<
v8
::BooleanObject>();

50 
	gFaùÜy
<
	gv8
::
CÚ‹xt
>::
»tuº_t


51 
FaùÜy
<
v8
::
CÚ‹xt
>::
New
Ğv8::
Ex‹nsiÚCÚfigu¿tiÚ
* 
ex‹nsiÚs


52 , 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
tm¶


53 , 
v8
::
Loÿl
<v8::
V®ue
> 
obj
) {

54  
v8
::
CÚ‹xt
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
ex‹nsiÚs
, 
tm¶
, 
obj
);

59 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

60 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

61 
FaùÜy
<
v8
::
D©e
>::
»tuº_t


62 
FaùÜy
<
v8
::
D©e
>::
New
(
v®ue
) {

63 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

64 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

65  
	gscİe
.
Esÿ³
(
v8
::
D©e
::
New
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
v®ue
)

66 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()).
As
<v8::
D©e
>());

69 
	gFaùÜy
<
	gv8
::
D©e
>::
»tuº_t


70 
FaùÜy
<
v8
::
D©e
>::
New
(
v®ue
) {

71  
v8
::
D©e
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
).
	gAs
<
	gv8
::Date>();

77 
	gFaùÜy
<
	gv8
::
Ex‹º®
>::
»tuº_t


78 
FaùÜy
<
v8
::
Ex‹º®
>::
New
(* 
v®ue
) {

79  
v8
::
Ex‹º®
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
);

84 
	gFaùÜy
<
	gv8
::
FunùiÚ
>::
»tuº_t


85 
FaùÜy
<
v8
::
FunùiÚ
>::
New
Ğ
FunùiÚC®lback
 
ÿÎback


86 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) {

87 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

88 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

89 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
l
 = v8::ObjeùTem¶©e::
New
(
isŞ©e
);

90 
	gl
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kFunùiÚF›ldCouÁ
);

91 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
NewIn¡ªû
(
l
).
ToLoÿlChecked
();

93 
	gobj
->
S‘IÁ”ÇlF›ld
(

94 
imp
::
kFunùiÚIndex


95 , 
v8
::
Ex‹º®
::
New
(
isŞ©e
, 
»š‹½»t_ÿ¡
<*>(
ÿÎback
)));

97 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
v®
 = v8::Loÿl<v8::V®ue>::
New
(
isŞ©e
, 
d©a
);

99 ià(!
	gv®
.
IsEm±y
()) {

100 
	gobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
v®
);

103  
	gscİe
.
Esÿ³
(
v8
::
FunùiÚ
::
New
Ğ
isŞ©e


104 , 
imp
::
FunùiÚC®lbackW¿µ”


105 , 
obj
));

110 
	gFaùÜy
<
	gv8
::
FunùiÚTem¶©e
>::
»tuº_t


111 
FaùÜy
<
v8
::
FunùiÚTem¶©e
>::
New
Ğ
FunùiÚC®lback
 
ÿÎback


112 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a


113 , 
v8
::
Loÿl
<v8::
SigÇtu»
> 
sigÇtu»
) {

114 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

115 ià(
	gÿÎback
) {

116 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

117 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
l
 = v8::ObjeùTem¶©e::
New
(
isŞ©e
);

118 
	gl
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kFunùiÚF›ldCouÁ
);

119 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
NewIn¡ªû
(
l
).
ToLoÿlChecked
();

121 
	gobj
->
S‘IÁ”ÇlF›ld
(

122 
imp
::
kFunùiÚIndex


123 , 
v8
::
Ex‹º®
::
New
(
isŞ©e
, 
»š‹½»t_ÿ¡
<*>(
ÿÎback
)));

124 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
v®
 = v8::Loÿl<v8::V®ue>::
New
(
isŞ©e
, 
d©a
);

126 ià(!
	gv®
.
IsEm±y
()) {

127 
	gobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
v®
);

130  
	gscİe
.
Esÿ³
(
v8
::
FunùiÚTem¶©e
::
New
Ğ
isŞ©e


131 , 
imp
::
FunùiÚC®lbackW¿µ”


132 , 
obj


133 , 
sigÇtu»
));

135  
	gv8
::
FunùiÚTem¶©e
::
New
(
isŞ©e
, 0, 
d©a
, 
sigÇtu»
);

141 
	gFaùÜy
<
	gv8
::
Numb”
>::
»tuº_t


142 
FaùÜy
<
v8
::
Numb”
>::
New
(
v®ue
) {

143  
v8
::
Numb”
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
);

148 
	gFaùÜy
<
	gv8
::
Numb”Objeù
>::
»tuº_t


149 
FaùÜy
<
v8
::
Numb”Objeù
>::
New
(
v®ue
) {

150  
v8
::
Numb”Objeù
::
New
Ğv8::
IsŞ©e
::
G‘Cu¼’t
()

151 , 
v®ue
).
	gAs
<
	gv8
::
Numb”Objeù
>();

156 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

157 
ty³Çme
 
	gIÁeg”FaùÜy
<
	gT
>::
»tuº_t


158 
IÁeg”FaùÜy
<
T
>::
New
(
št32_t
 
v®ue
) {

159  
To
<
T
>(T::
New
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
));

162 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

163 
ty³Çme
 
	gIÁeg”FaùÜy
<
	gT
>::
»tuº_t


164 
IÁeg”FaùÜy
<
T
>::
New
(
ušt32_t
 
v®ue
) {

165  
To
<
T
>(T::
NewFromUnsigÃd
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
));

168 
	gFaùÜy
<
	gv8
::
Ušt32
>::
»tuº_t


169 
FaùÜy
<
v8
::
Ušt32
>::
New
(
št32_t
 
v®ue
) {

170  
To
<
v8
::
Ušt32
>(

171 
v8
::
Ušt32
::
NewFromUnsigÃd
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
));

174 
	gFaùÜy
<
	gv8
::
Ušt32
>::
»tuº_t


175 
FaùÜy
<
v8
::
Ušt32
>::
New
(
ušt32_t
 
v®ue
) {

176  
To
<
v8
::
Ušt32
>(

177 
v8
::
Ušt32
::
NewFromUnsigÃd
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
));

182 
	gFaùÜy
<
	gv8
::
Objeù
>::
»tuº_t


183 
FaùÜy
<
v8
::
Objeù
>::
New
() {

184  
v8
::
Objeù
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
());

189 
	gFaùÜy
<
	gv8
::
ObjeùTem¶©e
>::
»tuº_t


190 
FaùÜy
<
v8
::
ObjeùTem¶©e
>::
New
() {

191  
v8
::
ObjeùTem¶©e
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
());

196 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

197 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

198 
FaùÜy
<
v8
::
RegExp
>::
»tuº_t


199 
FaùÜy
<
v8
::
RegExp
>::
New
(

200 
v8
::
Loÿl
<v8::
SŒšg
> 
·‰”n


201 , 
v8
::
RegExp
::
FÏgs
 
æags
) {

202 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

203 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

204  
	gscİe
.
Esÿ³
(

205 
v8
::
RegExp
::
New
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
·‰”n
, 
æags
)

206 .
FromMaybe
(
v8
::
Loÿl
<v8::
RegExp
>()));

209 
	gFaùÜy
<
	gv8
::
RegExp
>::
»tuº_t


210 
FaùÜy
<
v8
::
RegExp
>::
New
(

211 
v8
::
Loÿl
<v8::
SŒšg
> 
·‰”n


212 , 
v8
::
RegExp
::
FÏgs
 
æags
) {

213  
v8
::
RegExp
::
New
(
·‰”n
, 
æags
);

219 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

220 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

221 
FaùÜy
<
v8
::
Süt
>::
»tuº_t


222 
FaùÜy
<
v8
::
Süt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû
) {

223 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

224 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

225 
	gv8
::
SütComp”
::
Sourû
 
¤c
(
sourû
);

226  
	gscİe
.
Esÿ³
(

227 
v8
::
SütComp”
::
Compe
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), &
¤c
)

228 .
FromMaybe
(
v8
::
Loÿl
<v8::
Süt
>()));

231 
	gFaùÜy
<
	gv8
::
Süt
>::
»tuº_t


232 
FaùÜy
<
v8
::
Süt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû


233 , 
v8
::
SütOrigš
 cÚ¡& 
Üigš
) {

234 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

235 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

236 
	gv8
::
SütComp”
::
Sourû
 
¤c
(
sourû
, 
Üigš
);

237  
	gscİe
.
Esÿ³
(

238 
v8
::
SütComp”
::
Compe
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), &
¤c
)

239 .
FromMaybe
(
v8
::
Loÿl
<v8::
Süt
>()));

242 
	gFaùÜy
<
	gv8
::
Süt
>::
»tuº_t


243 
FaùÜy
<
v8
::
Süt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû
) {

244 
v8
::
SütComp”
::
Sourû
 
¤c
(
sourû
);

245  
	gv8
::
SütComp”
::
Compe
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
¤c
);

248 
	gFaùÜy
<
	gv8
::
Süt
>::
»tuº_t


249 
FaùÜy
<
v8
::
Süt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû


250 , 
v8
::
SütOrigš
 cÚ¡& 
Üigš
) {

251 
v8
::
SütComp”
::
Sourû
 
¤c
(
sourû
, 
Üigš
);

252  
	gv8
::
SütComp”
::
Compe
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
¤c
);

258 
	gFaùÜy
<
	gv8
::
SigÇtu»
>::
»tuº_t


259 
FaùÜy
<
v8
::
SigÇtu»
>::
New
(FaùÜy<v8::SigÇtu»>::
FTH
 
»ûiv”
) {

260  
v8
::
SigÇtu»
::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
»ûiv”
);

265 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


266 
FaùÜy
<
v8
::
SŒšg
>::
New
() {

267  
v8
::
SŒšg
::
Em±y
(v8::
IsŞ©e
::
G‘Cu¼’t
());

270 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

271 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

272 
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


273 
FaùÜy
<
v8
::
SŒšg
>::
New
(cÚ¡ * 
v®ue
, 
Ëngth
) {

274  
	gv8
::
SŒšg
::
NewFromUtf8
(

275 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
, v8::
NewSŒšgTy³
::
kNÜm®
, 
Ëngth
);

278 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


279 
FaùÜy
<
v8
::
SŒšg
>::
New
(
¡d
::
¡ršg
 cÚ¡& 
v®ue
) {

280 
as£¹
(
v®ue
.
size
(è<ğ
INT_MAX
 && "stringoo†ong");

281  
	gv8
::
SŒšg
::
NewFromUtf8
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(),

282 
v®ue
.
d©a
(), 
v8
::
NewSŒšgTy³
::
kNÜm®
, 
¡©ic_ÿ¡
<>(v®ue.
size
()));

285 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


286 
FaùÜy
<
v8
::
SŒšg
>::
New
(cÚ¡ 
ušt16_t
 * 
v®ue
, 
Ëngth
) {

287  
	gv8
::
SŒšg
::
NewFromTwoBy‹
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
,

288 
v8
::
NewSŒšgTy³
::
kNÜm®
, 
Ëngth
);

291 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


292 
FaùÜy
<
v8
::
SŒšg
>::
New
(v8::SŒšg::
Ex‹º®SŒšgResourû
 * 
v®ue
) {

293  
v8
::
SŒšg
::
NewEx‹º®TwoBy‹
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
);

296 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


297 
FaùÜy
<
v8
::
SŒšg
>::
New
(
Ex‹º®OÃBy‹SŒšgResourû
 * 
v®ue
) {

298  
v8
::
SŒšg
::
NewEx‹º®OÃBy‹
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
);

301 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


302 
FaùÜy
<
v8
::
SŒšg
>::
New
(cÚ¡ * 
v®ue
, 
Ëngth
) {

303  
	gv8
::
SŒšg
::
NewFromUtf8
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
,

304 
v8
::
SŒšg
::
kNÜm®SŒšg
, 
Ëngth
);

307 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


308 
FaùÜy
<
v8
::
SŒšg
>::
New
(

309 
¡d
::
¡ršg
 cÚ¡& 
v®ue
) {

310 
as£¹
(
v®ue
.
size
(è<ğ
INT_MAX
 && "stringoo†ong");

311  
	gv8
::
SŒšg
::
NewFromUtf8
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
.
d©a
(),

312 
v8
::
SŒšg
::
kNÜm®SŒšg
,

313 
¡©ic_ÿ¡
<>(
v®ue
.
size
()));

316 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


317 
FaùÜy
<
v8
::
SŒšg
>::
New
(cÚ¡ 
ušt16_t
 * 
v®ue
, 
Ëngth
) {

318  
	gv8
::
SŒšg
::
NewFromTwoBy‹
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
,

319 
v8
::
SŒšg
::
kNÜm®SŒšg
, 
Ëngth
);

322 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


323 
FaùÜy
<
v8
::
SŒšg
>::
New
(v8::SŒšg::
Ex‹º®SŒšgResourû
 * 
v®ue
) {

324  
v8
::
SŒšg
::
NewEx‹º®
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
);

327 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


328 
FaùÜy
<
v8
::
SŒšg
>::
New
(
Ex‹º®OÃBy‹SŒšgResourû
 * 
v®ue
) {

329  
v8
::
SŒšg
::
NewEx‹º®
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
v®ue
);

335 
	gFaùÜy
<
	gv8
::
SŒšgObjeù
>::
»tuº_t


336 
FaùÜy
<
v8
::
SŒšgObjeù
>::
New
(v8::
Loÿl
<v8::
SŒšg
> 
v®ue
) {

337  
v8
::
SŒšgObjeù
::
New
(
v®ue
).
As
<v8::StringObject>();

342 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

343 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

344 
FaùÜy
<
v8
::
UnboundSüt
>::
»tuº_t


345 
FaùÜy
<
v8
::
UnboundSüt
>::
New
(v8::
Loÿl
<v8::
SŒšg
> 
sourû
) {

346 
v8
::
SütComp”
::
Sourû
 
¤c
(
sourû
);

347  
	gv8
::
SütComp”
::
CompeUnboundSüt
(

348 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
¤c
);

351 
	gFaùÜy
<
	gv8
::
UnboundSüt
>::
»tuº_t


352 
FaùÜy
<
v8
::
UnboundSüt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû


353 , 
v8
::
SütOrigš
 cÚ¡& 
Üigš
) {

354 
v8
::
SütComp”
::
Sourû
 
¤c
(
sourû
, 
Üigš
);

355  
	gv8
::
SütComp”
::
CompeUnboundSüt
(

356 
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
¤c
);

359 
	gFaùÜy
<
	gv8
::
UnboundSüt
>::
»tuº_t


360 
FaùÜy
<
v8
::
UnboundSüt
>::
New
(v8::
Loÿl
<v8::
SŒšg
> 
sourû
) {

361 
v8
::
SütComp”
::
Sourû
 
¤c
(
sourû
);

362  
	gv8
::
SütComp”
::
CompeUnbound
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
¤c
);

365 
	gFaùÜy
<
	gv8
::
UnboundSüt
>::
»tuº_t


366 
FaùÜy
<
v8
::
UnboundSüt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû


367 , 
v8
::
SütOrigš
 cÚ¡& 
Üigš
) {

368 
v8
::
SütComp”
::
Sourû
 
¤c
(
sourû
, 
Üigš
);

369  
	gv8
::
SütComp”
::
CompeUnbound
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), &
¤c
);

377 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


378 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

379 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
HªdË
<T> 
h
) {

380  
v8
::
Loÿl
<
T
>::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
h
);

384 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gM
>

385 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
P”si¡’t
<T, 
M
> cÚ¡& 
p
) {

386  
	gv8
::
Loÿl
<
T
>::
New
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
p
);

389 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gM
>

390 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
P”si¡’t
<T, 
M
> cÚ¡& 
p
) {

391  
	gv8
::
Loÿl
<
T
>::
New
(
v8
::
IsŞ©e
::
G‘Cu¼’t
(), 
p
);

394 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

395 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
Glob®
<T> cÚ¡& 
p
) {

396  
v8
::
Loÿl
<
T
>::
New
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
p
);

	@utils/webnao/node_modules/nan/nan_implementation_pre_12_inl.h

9 #iâdeà
NAN_IMPLEMENTATION_PRE_12_INL_H_


10 
	#NAN_IMPLEMENTATION_PRE_12_INL_H_


	)

16 
Çme¥aû
 
	gimp
 {

20 
	gFaùÜy
<
	gv8
::
A¼ay
>::
»tuº_t


21 
FaùÜy
<
v8
::
A¼ay
>::
New
() {

22  
v8
::
A¼ay
::
New
();

25 
	gFaùÜy
<
	gv8
::
A¼ay
>::
»tuº_t


26 
FaùÜy
<
v8
::
A¼ay
>::
New
(
Ëngth
) {

27  
v8
::
A¼ay
::
New
(
Ëngth
);

32 
	gFaùÜy
<
	gv8
::
BoŞ—n
>::
»tuº_t


33 
FaùÜy
<
v8
::
BoŞ—n
>::
New
(
boŞ
 
v®ue
) {

34  
v8
::
BoŞ—n
::
New
(
v®ue
)->
ToBoŞ—n
();

39 
	gFaùÜy
<
	gv8
::
BoŞ—nObjeù
>::
»tuº_t


40 
FaùÜy
<
v8
::
BoŞ—nObjeù
>::
New
(
boŞ
 
v®ue
) {

41  
v8
::
BoŞ—nObjeù
::
New
(
v®ue
).
As
<v8::BooleanObject>();

46 
	gFaùÜy
<
	gv8
::
CÚ‹xt
>::
»tuº_t


47 
FaùÜy
<
v8
::
CÚ‹xt
>::
New
Ğv8::
Ex‹nsiÚCÚfigu¿tiÚ
* 
ex‹nsiÚs


48 , 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
tm¶


49 , 
v8
::
Loÿl
<v8::
V®ue
> 
obj
) {

50 
v8
::
P”si¡’t
<v8::
CÚ‹xt
> 
ùx
 = v8::CÚ‹xt::
New
(
ex‹nsiÚs
, 
tm¶
, 
obj
);

51 
	gv8
::
Loÿl
<
v8
::
CÚ‹xt
> 
lùx
 = v8::Loÿl<v8::CÚ‹xt>::
New
(
ùx
);

52 
	gùx
.
Di¥o£
();

53  
	glùx
;

58 
	gFaùÜy
<
	gv8
::
D©e
>::
»tuº_t


59 
FaùÜy
<
v8
::
D©e
>::
New
(
v®ue
) {

60  
v8
::
D©e
::
New
(
v®ue
).
As
<v8::Date>();

65 
	gFaùÜy
<
	gv8
::
Ex‹º®
>::
»tuº_t


66 
FaùÜy
<
v8
::
Ex‹º®
>::
New
(* 
v®ue
) {

67  
v8
::
Ex‹º®
::
New
(
v®ue
);

72 
	gFaùÜy
<
	gv8
::
FunùiÚ
>::
»tuº_t


73 
FaùÜy
<
v8
::
FunùiÚ
>::
New
Ğ
FunùiÚC®lback
 
ÿÎback


74 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
) {

75 
v8
::
HªdËScİe
 
scİe
;

77  
	gscİe
.
Clo£
(
FaùÜy
<
v8
::
FunùiÚTem¶©e
>::
New
(

78 
ÿÎback
, 
d©a
, 
v8
::
Loÿl
<v8::
SigÇtu»
>())

79 ->
G‘FunùiÚ
());

85 
	gFaùÜy
<
	gv8
::
FunùiÚTem¶©e
>::
»tuº_t


86 
FaùÜy
<
v8
::
FunùiÚTem¶©e
>::
New
Ğ
FunùiÚC®lback
 
ÿÎback


87 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a


88 , 
v8
::
Loÿl
<v8::
SigÇtu»
> 
sigÇtu»
) {

89 ià(
ÿÎback
) {

90 
v8
::
HªdËScİe
 
scİe
;

92 
	gv8
::
Loÿl
<
v8
::
ObjeùTem¶©e
> 
l
 = v8::ObjeùTem¶©e::
New
();

93 
	gl
->
S‘IÁ”ÇlF›ldCouÁ
(
imp
::
kFunùiÚF›ldCouÁ
);

94 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
 = 
l
->
NewIn¡ªû
();

96 
	gobj
->
S‘IÁ”ÇlF›ld
(

97 
imp
::
kFunùiÚIndex


98 , 
v8
::
Ex‹º®
::
New
(
»š‹½»t_ÿ¡
<*>(
ÿÎback
)));

100 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
v®
 = v8::Loÿl<v8::V®ue>::
New
(
d©a
);

102 ià(!
	gv®
.
IsEm±y
()) {

103 
	gobj
->
S‘IÁ”ÇlF›ld
(
imp
::
kD©aIndex
, 
v®
);

108  
	gscİe
.
Clo£
(

109 
v8
::
FunùiÚTem¶©e
::
New
(
imp
::
FunùiÚC®lbackW¿µ”


110 , 
obj


111 , 
sigÇtu»
));

113  
	gv8
::
FunùiÚTem¶©e
::
New
(0, 
d©a
, 
sigÇtu»
);

119 
	gFaùÜy
<
	gv8
::
Numb”
>::
»tuº_t


120 
FaùÜy
<
v8
::
Numb”
>::
New
(
v®ue
) {

121  
v8
::
Numb”
::
New
(
v®ue
);

126 
	gFaùÜy
<
	gv8
::
Numb”Objeù
>::
»tuº_t


127 
FaùÜy
<
v8
::
Numb”Objeù
>::
New
(
v®ue
) {

128  
v8
::
Numb”Objeù
::
New
(
v®ue
).
As
<v8::NumberObject>();

133 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

134 
ty³Çme
 
	gIÁeg”FaùÜy
<
	gT
>::
»tuº_t


135 
IÁeg”FaùÜy
<
T
>::
New
(
št32_t
 
v®ue
) {

136  
To
<
T
>(T::
New
(
v®ue
));

139 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

140 
ty³Çme
 
	gIÁeg”FaùÜy
<
	gT
>::
»tuº_t


141 
IÁeg”FaùÜy
<
T
>::
New
(
ušt32_t
 
v®ue
) {

142  
To
<
T
>(T::
NewFromUnsigÃd
(
v®ue
));

145 
	gFaùÜy
<
	gv8
::
Ušt32
>::
»tuº_t


146 
FaùÜy
<
v8
::
Ušt32
>::
New
(
št32_t
 
v®ue
) {

147  
To
<
v8
::
Ušt32
>(v8::Ušt32::
NewFromUnsigÃd
(
v®ue
));

150 
	gFaùÜy
<
	gv8
::
Ušt32
>::
»tuº_t


151 
FaùÜy
<
v8
::
Ušt32
>::
New
(
ušt32_t
 
v®ue
) {

152  
To
<
v8
::
Ušt32
>(v8::Ušt32::
NewFromUnsigÃd
(
v®ue
));

158 
	gFaùÜy
<
	gv8
::
Objeù
>::
»tuº_t


159 
FaùÜy
<
v8
::
Objeù
>::
New
() {

160  
v8
::
Objeù
::
New
();

165 
	gFaùÜy
<
	gv8
::
ObjeùTem¶©e
>::
»tuº_t


166 
FaùÜy
<
v8
::
ObjeùTem¶©e
>::
New
() {

167  
v8
::
ObjeùTem¶©e
::
New
();

172 
	gFaùÜy
<
	gv8
::
RegExp
>::
»tuº_t


173 
FaùÜy
<
v8
::
RegExp
>::
New
(

174 
v8
::
Loÿl
<v8::
SŒšg
> 
·‰”n


175 , 
v8
::
RegExp
::
FÏgs
 
æags
) {

176  
v8
::
RegExp
::
New
(
·‰”n
, 
æags
);

181 
	gFaùÜy
<
	gv8
::
Süt
>::
»tuº_t


182 
FaùÜy
<
v8
::
Süt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû
) {

183  
v8
::
Süt
::
New
(
sourû
);

185 
	gFaùÜy
<
	gv8
::
Süt
>::
»tuº_t


186 
FaùÜy
<
v8
::
Süt
>::
New
Ğv8::
Loÿl
<v8::
SŒšg
> 
sourû


187 , 
v8
::
SütOrigš
 cÚ¡& 
Üigš
) {

188  
v8
::
Süt
::
New
(
sourû
, 
cÚ¡_ÿ¡
<v8::
SütOrigš
*>(&
Üigš
));

193 
	gFaùÜy
<
	gv8
::
SigÇtu»
>::
»tuº_t


194 
FaùÜy
<
v8
::
SigÇtu»
>::
New
(FaùÜy<v8::SigÇtu»>::
FTH
 
»ûiv”
) {

195  
v8
::
SigÇtu»
::
New
(
»ûiv”
);

200 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


201 
FaùÜy
<
v8
::
SŒšg
>::
New
() {

202  
v8
::
SŒšg
::
Em±y
();

205 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


206 
FaùÜy
<
v8
::
SŒšg
>::
New
(cÚ¡ * 
v®ue
, 
Ëngth
) {

207  
	gv8
::
SŒšg
::
New
(
v®ue
, 
Ëngth
);

210 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


211 
FaùÜy
<
v8
::
SŒšg
>::
New
(

212 
¡d
::
¡ršg
 cÚ¡& 
v®ue
) {

213 
as£¹
(
v®ue
.
size
(è<ğ
INT_MAX
 && "stringoo†ong");

214  
	gv8
::
SŒšg
::
New
(
v®ue
.
d©a
(), 
¡©ic_ÿ¡
<>(v®ue.
size
()));

217 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


218 
FaùÜy
<
v8
::
SŒšg
>::
New
(cÚ¡ 
ušt16_t
 * 
v®ue
, 
Ëngth
) {

219  
	gv8
::
SŒšg
::
New
(
v®ue
, 
Ëngth
);

222 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


223 
FaùÜy
<
v8
::
SŒšg
>::
New
(v8::SŒšg::
Ex‹º®SŒšgResourû
 * 
v®ue
) {

224  
v8
::
SŒšg
::
NewEx‹º®
(
v®ue
);

227 
	gFaùÜy
<
	gv8
::
SŒšg
>::
»tuº_t


228 
FaùÜy
<
v8
::
SŒšg
>::
New
(v8::SŒšg::
Ex‹º®AsciiSŒšgResourû
 * 
v®ue
) {

229  
v8
::
SŒšg
::
NewEx‹º®
(
v®ue
);

234 
	gFaùÜy
<
	gv8
::
SŒšgObjeù
>::
»tuº_t


235 
FaùÜy
<
v8
::
SŒšgObjeù
>::
New
(v8::
Loÿl
<v8::
SŒšg
> 
v®ue
) {

236  
v8
::
SŒšgObjeù
::
New
(
v®ue
).
As
<v8::StringObject>();

243 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

244 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
HªdË
<T> 
h
) {

245  
v8
::
Loÿl
<
T
>::
New
(
h
);

248 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

249 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
P”si¡’t
<T> cÚ¡& 
p
) {

250  
v8
::
Loÿl
<
T
>::
New
(
p
);

253 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gM
>

254 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
P”si¡’t
<T, 
M
> cÚ¡& 
p
) {

255  
	gv8
::
Loÿl
<
T
>::
New
(
p
.
³rsi¡’t
);

258 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

259 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
Glob®
<T> cÚ¡& 
p
) {

260  
v8
::
Loÿl
<
T
>::
New
(
p
.
³rsi¡’t
);

	@utils/webnao/node_modules/nan/nan_maybe_43_inl.h

9 #iâdeà
NAN_MAYBE_43_INL_H_


10 
	#NAN_MAYBE_43_INL_H_


	)

12 
	g‹m¶©e
<
ty³Çme
 
	gT
>

13 
usšg
 
	gMaybeLoÿl
 = 
v8
::
MaybeLoÿl
<
T
>;

15 
	g‹m¶©e
<
ty³Çme
 
	gT
>

16 
usšg
 
	gMaybe
 = 
v8
::
Maybe
<
T
>;

18 
	g‹m¶©e
<
ty³Çme
 
	gT
>

19 
šlše
 
	gMaybe
<
	gT
> 
	$NÙhšg
() {

20  
v8
::
NÙhšg
<
T
>();

21 
	}
}

23 
	g‹m¶©e
<
ty³Çme
 
	gT
>

24 
šlše
 
	gMaybe
<
	gT
> 
	$Ju¡
(cÚ¡ 
T
& 
t
) {

25  
v8
::
Ju¡
<
T
>(
t
);

26 
	}
}

28 
šlše


29 
	gMaybeLoÿl
<
	gv8
::
SŒšg
> 
ToD‘aSŒšg
(
v8
::
Loÿl
<v8::
V®ue
> 
v®
) {

30 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

31 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

32  
	gscİe
.
Esÿ³
(
v®
->
ToD‘aSŒšg
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

33 .
FromMaybe
(
v8
::
Loÿl
<v8::
SŒšg
>()));

36 
šlše


37 
	gMaybeLoÿl
<
	gv8
::
Ušt32
> 
ToA¼ayIndex
(
v8
::
Loÿl
<v8::
V®ue
> 
v®
) {

38 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

39 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

40  
	gscİe
.
Esÿ³
(
v®
->
ToA¼ayIndex
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

41 .
FromMaybe
(
v8
::
Loÿl
<v8::
Ušt32
>()));

44 
šlše


45 
	gMaybe
<
	gboŞ
> 
Equ®s
(
v8
::
Loÿl
<v8::
V®ue
> 
a
, v8::Loÿl<v8::V®ue>(
b
)) {

46 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

47 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

48  
	ga
->
Equ®s
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
b
);

51 
šlše


52 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
NewIn¡ªû
(
v8
::
Loÿl
<v8::
FunùiÚ
> 
h
) {

53 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

54 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

55  
	gscİe
.
Esÿ³
(
h
->
NewIn¡ªû
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

56 .
FromMaybe
(
v8
::
Loÿl
<v8::
Objeù
>()));

59 
šlše


60 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
NewIn¡ªû
(

61 
v8
::
Loÿl
<v8::
FunùiÚ
> 
h


62 , 
¬gc


63 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) {

64 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

65 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

66  
	gscİe
.
Esÿ³
(
h
->
NewIn¡ªû
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
¬gc
, 
¬gv
)

67 .
FromMaybe
(
v8
::
Loÿl
<v8::
Objeù
>()));

70 
šlše


71 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
NewIn¡ªû
(
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
h
) {

72 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

73 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

74  
	gscİe
.
Esÿ³
(
h
->
NewIn¡ªû
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

75 .
FromMaybe
(
v8
::
Loÿl
<v8::
Objeù
>()));

79 
šlše
 
	gMaybeLoÿl
<
	gv8
::
FunùiÚ
> 
G‘FunùiÚ
(

80 
v8
::
Loÿl
<v8::
FunùiÚTem¶©e
> 
t
) {

81 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

82 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

83  
	gscİe
.
Esÿ³
(
t
->
G‘FunùiÚ
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

84 .
FromMaybe
(
v8
::
Loÿl
<v8::
FunùiÚ
>()));

87 
šlše
 
	gMaybe
<
	gboŞ
> 
S‘
(

88 
v8
::
Loÿl
<v8::
Objeù
> 
obj


89 , 
v8
::
Loÿl
<v8::
V®ue
> 
key


90 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue
) {

91 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

92 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

93  
	gobj
->
S‘
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
, 
v®ue
);

96 
šlše
 
	gMaybe
<
	gboŞ
> 
S‘
(

97 
v8
::
Loÿl
<v8::
Objeù
> 
obj


98 , 
ušt32_t
 
šdex


99 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue
) {

100 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

101 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

102  
	gobj
->
S‘
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
šdex
, 
v®ue
);

105 
šlše
 
	gMaybe
<
	gboŞ
> 
FÜûS‘
(

106 
v8
::
Loÿl
<v8::
Objeù
> 
obj


107 , 
v8
::
Loÿl
<v8::
V®ue
> 
key


108 , 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue


109 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibs
 = v8::
NÚe
) {

110 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

111 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

112  
	gobj
->
FÜûS‘
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
, 
v®ue
, 
©Œibs
);

115 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘
(

116 
v8
::
Loÿl
<v8::
Objeù
> 
obj


117 , 
v8
::
Loÿl
<v8::
V®ue
> 
key
) {

118 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

119 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

120  
	gscİe
.
Esÿ³
(
obj
->
G‘
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
)

121 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

124 
šlše


125 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘
(
v8
::
Loÿl
<v8::
Objeù
> 
obj
, 
ušt32_t
 
šdex
) {

126 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

127 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

128  
	gscİe
.
Esÿ³
(
obj
->
G‘
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
šdex
)

129 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

132 
šlše
 
	gv8
::
Prİ”tyA‰ribu‹
 
G‘Prİ”tyA‰ribu‹s
(

133 
v8
::
Loÿl
<v8::
Objeù
> 
obj


134 , 
v8
::
Loÿl
<v8::
V®ue
> 
key
) {

135 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

136 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

137  
	gobj
->
G‘Prİ”tyA‰ribu‹s
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
)

138 .
FromJu¡
();

141 
šlše
 
	gMaybe
<
	gboŞ
> 
Has
(

142 
v8
::
Loÿl
<v8::
Objeù
> 
obj


143 , 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

144 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

145 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

146  
	gobj
->
Has
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
);

149 
šlše
 
	gMaybe
<
	gboŞ
> 
Has
(
v8
::
Loÿl
<v8::
Objeù
> 
obj
, 
ušt32_t
 
šdex
) {

150 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

151 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

152  
	gobj
->
Has
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
šdex
);

155 
šlše
 
	gMaybe
<
	gboŞ
> 
D–‘e
(

156 
v8
::
Loÿl
<v8::
Objeù
> 
obj


157 , 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

158 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

159 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

160  
	gobj
->
D–‘e
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
);

163 
šlše


164 
	gMaybe
<
	gboŞ
> 
D–‘e
(
v8
::
Loÿl
<v8::
Objeù
> 
obj
, 
ušt32_t
 
šdex
) {

165 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

166 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

167  
	gobj
->
D–‘e
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
šdex
);

170 
šlše


171 
	gMaybeLoÿl
<
	gv8
::
A¼ay
> 
G‘Prİ”tyNames
(
v8
::
Loÿl
<v8::
Objeù
> 
obj
) {

172 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

173 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

174  
	gscİe
.
Esÿ³
(
obj
->
G‘Prİ”tyNames
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

175 .
FromMaybe
(
v8
::
Loÿl
<v8::
A¼ay
>()));

178 
šlše


179 
	gMaybeLoÿl
<
	gv8
::
A¼ay
> 
G‘OwnPrİ”tyNames
(
v8
::
Loÿl
<v8::
Objeù
> 
obj
) {

180 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

181 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

182  
	gscİe
.
Esÿ³
(
obj
->
G‘OwnPrİ”tyNames
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

183 .
FromMaybe
(
v8
::
Loÿl
<v8::
A¼ay
>()));

186 
šlše
 
	gMaybe
<
	gboŞ
> 
S‘PrÙÙy³
(

187 
v8
::
Loÿl
<v8::
Objeù
> 
obj


188 , 
v8
::
Loÿl
<v8::
V®ue
> 
´ÙÙy³
) {

189 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

190 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

191  
	gobj
->
S‘PrÙÙy³
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
´ÙÙy³
);

194 
šlše
 
	gMaybeLoÿl
<
	gv8
::
SŒšg
> 
ObjeùPrÙoToSŒšg
(

195 
v8
::
Loÿl
<v8::
Objeù
> 
obj
) {

196 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

197 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

198  
	gscİe
.
Esÿ³
(
obj
->
ObjeùPrÙoToSŒšg
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

199 .
FromMaybe
(
v8
::
Loÿl
<v8::
SŒšg
>()));

202 
šlše
 
	gMaybe
<
	gboŞ
> 
HasOwnPrİ”ty
(

203 
v8
::
Loÿl
<v8::
Objeù
> 
obj


204 , 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

205 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

206 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

207  
	gobj
->
HasOwnPrİ”ty
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
);

210 
šlše
 
	gMaybe
<
	gboŞ
> 
HasR—lNamedPrİ”ty
(

211 
v8
::
Loÿl
<v8::
Objeù
> 
obj


212 , 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

213 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

214 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

215  
	gobj
->
HasR—lNamedPrİ”ty
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
);

218 
šlše
 
	gMaybe
<
	gboŞ
> 
HasR—lIndexedPrİ”ty
(

219 
v8
::
Loÿl
<v8::
Objeù
> 
obj


220 , 
ušt32_t
 
šdex
) {

221 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

222 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

223  
	gobj
->
HasR—lIndexedPrİ”ty
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
šdex
);

226 
šlše
 
	gMaybe
<
	gboŞ
> 
HasR—lNamedC®lbackPrİ”ty
(

227 
v8
::
Loÿl
<v8::
Objeù
> 
obj


228 , 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

229 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

230 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

231  
	gobj
->
HasR—lNamedC®lbackPrİ”ty
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
);

234 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘R—lNamedPrİ”tyInPrÙÙy³Chaš
(

235 
v8
::
Loÿl
<v8::
Objeù
> 
obj


236 , 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

237 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

238 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

239  
	gscİe
.
Esÿ³
(
obj
->
G‘R—lNamedPrİ”tyInPrÙÙy³Chaš
(

240 
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
)

241 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

244 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘R—lNamedPrİ”ty
(

245 
v8
::
Loÿl
<v8::
Objeù
> 
obj


246 , 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

247 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

248 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

249  
	gscİe
.
Esÿ³
(

250 
obj
->
G‘R—lNamedPrİ”ty
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
key
)

251 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

254 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
C®lAsFunùiÚ
(

255 
v8
::
Loÿl
<v8::
Objeù
> 
obj


256 , 
v8
::
Loÿl
<v8::
Objeù
> 
»cv


257 , 
¬gc


258 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) {

259 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

260 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

261  
	gscİe
.
Esÿ³
(

262 
obj
->
C®lAsFunùiÚ
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
»cv
, 
¬gc
, 
¬gv
)

263 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

266 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
C®lAsCÚ¡ruùÜ
(

267 
v8
::
Loÿl
<v8::
Objeù
> 
obj


268 , 
¬gc
, 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) {

269 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

270 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

271  
	gscİe
.
Esÿ³
(

272 
obj
->
C®lAsCÚ¡ruùÜ
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
¬gc
, 
¬gv
)

273 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

276 
šlše


277 
	gMaybeLoÿl
<
	gv8
::
SŒšg
> 
G‘SourûLše
(
v8
::
Loÿl
<v8::
Mes§ge
> 
msg
) {

278 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

279 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

280  
	gscİe
.
Esÿ³
(
msg
->
G‘SourûLše
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
())

281 .
FromMaybe
(
v8
::
Loÿl
<v8::
SŒšg
>()));

284 
šlše
 
	gMaybe
<> 
G‘LšeNumb”
(
v8
::
Loÿl
<v8::
Mes§ge
> 
msg
) {

285 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

286 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

287  
	gmsg
->
G‘LšeNumb”
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
());

290 
šlše
 
	gMaybe
<> 
G‘S¹CŞumn
(
v8
::
Loÿl
<v8::
Mes§ge
> 
msg
) {

291 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

292 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

293  
	gmsg
->
G‘S¹CŞumn
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
());

296 
šlše
 
	gMaybe
<> 
G‘EndCŞumn
(
v8
::
Loÿl
<v8::
Mes§ge
> 
msg
) {

297 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

298 
	gv8
::
HªdËScİe
 
scİe
(
isŞ©e
);

299  
	gmsg
->
G‘EndCŞumn
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
());

302 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
ClÚeEËm’tAt
(

303 
v8
::
Loÿl
<v8::
A¼ay
> 
¬¿y


304 , 
ušt32_t
 
šdex
) {

305 #ià(
NODE_MODULE_VERSION
 >ğ
NODE_6_0_MODULE_VERSION
)

306 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

307 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

308 
	gv8
::
Loÿl
<
v8
::
CÚ‹xt
> 
cÚ‹xt
 = 
isŞ©e
->
G‘Cu¼’tCÚ‹xt
();

309 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
–em
;

310 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
obj
;

311 ià(!
	g¬¿y
->
G‘
(
cÚ‹xt
, 
šdex
).
ToLoÿl
(&
–em
)) {

312  
	gscİe
.
Esÿ³
(
obj
);

314 ià(!
	g–em
->
ToObjeù
(
cÚ‹xt
).
ToLoÿl
(&
obj
)) {

315  
	gscİe
.
Esÿ³
(
v8
::
Loÿl
<v8::
Objeù
>());

317  
	gscİe
.
Esÿ³
(
obj
->
ClÚe
());

319 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

320 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

321  
	gscİe
.
Esÿ³
(
¬¿y
->
ClÚeEËm’tAt
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
šdex
)

322 .
FromMaybe
(
v8
::
Loÿl
<v8::
Objeù
>()));

326 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
C®l
(

327 
v8
::
Loÿl
<v8::
FunùiÚ
> 
fun


328 , 
v8
::
Loÿl
<v8::
Objeù
> 
»cv


329 , 
¬gc


330 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) {

331 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

332 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

333  
	gscİe
.
Esÿ³
(
fun
->
C®l
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
»cv
, 
¬gc
, 
¬gv
)

334 .
FromMaybe
(
v8
::
Loÿl
<v8::
V®ue
>()));

	@utils/webnao/node_modules/nan/nan_maybe_pre_43_inl.h

9 #iâdeà
NAN_MAYBE_PRE_43_INL_H_


10 
	#NAN_MAYBE_PRE_43_INL_H_


	)

12 
	g‹m¶©e
<
ty³Çme
 
	gT
>

13 şas 
	cMaybeLoÿl
 {

14 
	mpublic
:

15 
šlše
 
	$MaybeLoÿl
(è: 
	`v®_
(
v8
::
Loÿl
<
T
>()) {}

17 
‹m¶©e
<
ty³Çme
 
S
>

18 #ià
NODE_MODULE_VERSION
 >ğ
NODE_0_12_MODULE_VERSION


19 
šlše


20 
	`MaybeLoÿl
(
v8
::
Loÿl
<
S
> 
th©
è: 
	$v®_
(
th©
è{
	}
}

22 
šlše


23 
MaybeLoÿl
(
v8
::
Loÿl
<
S
> 
th©
) :

24 
v®_
(*
»š‹½»t_ÿ¡
<
v8
::
Loÿl
<
T
>*>(&
th©
)) {}

27 
šlše
 
boŞ
 
	$IsEm±y
(ècÚ¡ {  
v®_
.
	`IsEm±y
(); 
	}
}

29 
	g‹m¶©e
<
ty³Çme
 
	gS
>

30 
šlše
 
boŞ
 
ToLoÿl
(
v8
::
Loÿl
<
S
> *
out
) const {

31 *
out
 = 
v®_
;

32  !
IsEm±y
();

35 
šlše
 
	gv8
::
Loÿl
<
T
> 
	$ToLoÿlChecked
() const {

36 #ià
	`defšed
(
V8_ENABLE_CHECKS
)

37 
	`as£¹
(!
	`IsEm±y
() && "ToLocalChecked is Empty");

39  
v®_
;

40 
	}
}

42 
	g‹m¶©e
<
ty³Çme
 
	gS
>

43 
šlše
 
	gv8
::
Loÿl
<
S
> 
FromMaybe
(
v8
::Loÿl<S> 
deçuÉ_v®ue
) const {

44  
IsEm±y
(è? 
deçuÉ_v®ue
 : 
v®_
;

47 
	g´iv©e
:

48 
v8
::
Loÿl
<
T
> 
v®_
;

51 
	g‹m¶©e
<
ty³Çme
 
	gT
>

52 şas 
	cMaybe
 {

53 
	mpublic
:

54 
šlše
 
boŞ
 
	$IsNÙhšg
(ècÚ¡ {  !
has_v®ue_
; }

55 
šlše
 
boŞ
 
	$IsJu¡
(ècÚ¡ {  
has_v®ue_
; 
	}
}

57 
šlše
 
T
 
	$FromJu¡
() const {

58 #ià
	`defšed
(
V8_ENABLE_CHECKS
)

59 
	`as£¹
(
	`IsJu¡
() && "FromJust is Nothing");

61  
v®ue_
;

62 
	}
}

64 
šlše
 
T
 
	$FromMaybe
(cÚ¡ 
T
& 
deçuÉ_v®ue
) const {

65  
has_v®ue_
 ? 
v®ue_
 : 
deçuÉ_v®ue
;

66 
	}
}

68 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Maybe
 &
Ùh”
) const {

69  (
IsJu¡
(è=ğ
Ùh”
.IsJust()) &&

70 (!
IsJu¡
(è|| 
FromJu¡
(è=ğ
Ùh”
.FromJust());

73 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Maybe
 &
Ùh”
) const {

74  !
İ”©Ü
==(
Ùh”
);

77 
	g´iv©e
:

78 
	$Maybe
(è: 
	$has_v®ue_
(
çl£
è{
	}
}

79 
ex¶ic™
 
	$Maybe
(cÚ¡ 
T
& 
t
è: 
	`has_v®ue_
(
Œue
), 
	$v®ue_
(
t
è{
	}
}

80 
boŞ
 
	ghas_v®ue_
;

81 
T
 
	gv®ue_
;

83 
	g‹m¶©e
<
ty³Çme
 
	gU
>

84 
ä›nd
 
	gMaybe
<
	gU
> 
NÙhšg
();

85 
	g‹m¶©e
<
ty³Çme
 
	gU
>

86 
ä›nd
 
	gMaybe
<
	gU
> 
Ju¡
(cÚ¡ 
U
& 
u
);

89 
	g‹m¶©e
<
ty³Çme
 
	gT
>

90 
šlše
 
	gMaybe
<
	gT
> 
	$NÙhšg
() {

91  
Maybe
<
T
>();

92 
	}
}

94 
	g‹m¶©e
<
ty³Çme
 
	gT
>

95 
šlše
 
	gMaybe
<
	gT
> 
	$Ju¡
(cÚ¡ 
T
& 
t
) {

96  
Maybe
<
T
>(
t
);

97 
	}
}

99 
šlše


100 
	gMaybeLoÿl
<
	gv8
::
SŒšg
> 
ToD‘aSŒšg
(
v8
::
HªdË
<v8::
V®ue
> 
v®
) {

101  
MaybeLoÿl
<
v8
::
SŒšg
>(
v®
->
ToD‘aSŒšg
());

104 
šlše


105 
	gMaybeLoÿl
<
	gv8
::
Ušt32
> 
ToA¼ayIndex
(
v8
::
HªdË
<v8::
V®ue
> 
v®
) {

106  
MaybeLoÿl
<
v8
::
Ušt32
>(
v®
->
ToA¼ayIndex
());

109 
šlše


110 
	gMaybe
<
	gboŞ
> 
Equ®s
(
v8
::
HªdË
<v8::
V®ue
> 
a
, v8::HªdË<v8::V®ue>(
b
)) {

111  
Ju¡
<
boŞ
>(
a
->
Equ®s
(
b
));

114 
šlše


115 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
NewIn¡ªû
(
v8
::
HªdË
<v8::
FunùiÚ
> 
h
) {

116  
MaybeLoÿl
<
v8
::
Objeù
>(
h
->
NewIn¡ªû
());

119 
šlše


120 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
NewIn¡ªû
(

121 
v8
::
Loÿl
<v8::
FunùiÚ
> 
h


122 , 
¬gc


123 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) {

124  
MaybeLoÿl
<
v8
::
Objeù
>(
h
->
NewIn¡ªû
(
¬gc
, 
¬gv
));

127 
šlše


128 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
NewIn¡ªû
(
v8
::
HªdË
<v8::
ObjeùTem¶©e
> 
h
) {

129  
MaybeLoÿl
<
v8
::
Objeù
>(
h
->
NewIn¡ªû
());

132 
šlše


133 
	gMaybeLoÿl
<
	gv8
::
FunùiÚ
> 
G‘FunùiÚ
(
v8
::
HªdË
<v8::
FunùiÚTem¶©e
> 
t
) {

134  
MaybeLoÿl
<
v8
::
FunùiÚ
>(
t
->
G‘FunùiÚ
());

137 
šlše
 
	gMaybe
<
	gboŞ
> 
S‘
(

138 
v8
::
HªdË
<v8::
Objeù
> 
obj


139 , 
v8
::
HªdË
<v8::
V®ue
> 
key


140 , 
v8
::
HªdË
<v8::
V®ue
> 
v®ue
) {

141  
Ju¡
<
boŞ
>(
obj
->
S‘
(
key
, 
v®ue
));

144 
šlše
 
	gMaybe
<
	gboŞ
> 
S‘
(

145 
v8
::
HªdË
<v8::
Objeù
> 
obj


146 , 
ušt32_t
 
šdex


147 , 
v8
::
HªdË
<v8::
V®ue
> 
v®ue
) {

148  
Ju¡
<
boŞ
>(
obj
->
S‘
(
šdex
, 
v®ue
));

151 
šlše
 
	gMaybe
<
	gboŞ
> 
FÜûS‘
(

152 
v8
::
HªdË
<v8::
Objeù
> 
obj


153 , 
v8
::
HªdË
<v8::
V®ue
> 
key


154 , 
v8
::
HªdË
<v8::
V®ue
> 
v®ue


155 , 
v8
::
Prİ”tyA‰ribu‹
 
©Œibs
 = v8::
NÚe
) {

156  
Ju¡
<
boŞ
>(
obj
->
FÜûS‘
(
key
, 
v®ue
, 
©Œibs
));

159 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘
(

160 
v8
::
HªdË
<v8::
Objeù
> 
obj


161 , 
v8
::
HªdË
<v8::
V®ue
> 
key
) {

162  
MaybeLoÿl
<
v8
::
V®ue
>(
obj
->
G‘
(
key
));

165 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘
(

166 
v8
::
HªdË
<v8::
Objeù
> 
obj


167 , 
ušt32_t
 
šdex
) {

168  
	gMaybeLoÿl
<
	gv8
::
V®ue
>(
obj
->
G‘
(
šdex
));

171 
šlše
 
	gMaybe
<
	gv8
::
Prİ”tyA‰ribu‹
> 
G‘Prİ”tyA‰ribu‹s
(

172 
v8
::
HªdË
<v8::
Objeù
> 
obj


173 , 
v8
::
HªdË
<v8::
V®ue
> 
key
) {

174  
Ju¡
<
v8
::
Prİ”tyA‰ribu‹
>(
obj
->
G‘Prİ”tyA‰ribu‹s
(
key
));

177 
šlše
 
	gMaybe
<
	gboŞ
> 
Has
(

178 
v8
::
HªdË
<v8::
Objeù
> 
obj


179 , 
v8
::
HªdË
<v8::
SŒšg
> 
key
) {

180  
Ju¡
<
boŞ
>(
obj
->
Has
(
key
));

183 
šlše
 
	gMaybe
<
	gboŞ
> 
Has
(

184 
v8
::
HªdË
<v8::
Objeù
> 
obj


185 , 
ušt32_t
 
šdex
) {

186  
	gJu¡
<
	gboŞ
>(
	gobj
->
Has
(
šdex
));

189 
šlše
 
	gMaybe
<
	gboŞ
> 
D–‘e
(

190 
v8
::
HªdË
<v8::
Objeù
> 
obj


191 , 
v8
::
HªdË
<v8::
SŒšg
> 
key
) {

192  
Ju¡
<
boŞ
>(
obj
->
D–‘e
(
key
));

195 
šlše
 
	gMaybe
<
	gboŞ
> 
D–‘e
(

196 
v8
::
HªdË
<v8::
Objeù
> 
obj


197 , 
ušt32_t
 
šdex
) {

198  
	gJu¡
<
	gboŞ
>(
	gobj
->
D–‘e
(
šdex
));

201 
šlše


202 
	gMaybeLoÿl
<
	gv8
::
A¼ay
> 
G‘Prİ”tyNames
(
v8
::
HªdË
<v8::
Objeù
> 
obj
) {

203  
MaybeLoÿl
<
v8
::
A¼ay
>(
obj
->
G‘Prİ”tyNames
());

206 
šlše


207 
	gMaybeLoÿl
<
	gv8
::
A¼ay
> 
G‘OwnPrİ”tyNames
(
v8
::
HªdË
<v8::
Objeù
> 
obj
) {

208  
MaybeLoÿl
<
v8
::
A¼ay
>(
obj
->
G‘OwnPrİ”tyNames
());

211 
šlše
 
	gMaybe
<
	gboŞ
> 
S‘PrÙÙy³
(

212 
v8
::
HªdË
<v8::
Objeù
> 
obj


213 , 
v8
::
HªdË
<v8::
V®ue
> 
´ÙÙy³
) {

214  
Ju¡
<
boŞ
>(
obj
->
S‘PrÙÙy³
(
´ÙÙy³
));

217 
šlše
 
	gMaybeLoÿl
<
	gv8
::
SŒšg
> 
ObjeùPrÙoToSŒšg
(

218 
v8
::
HªdË
<v8::
Objeù
> 
obj
) {

219  
MaybeLoÿl
<
v8
::
SŒšg
>(
obj
->
ObjeùPrÙoToSŒšg
());

222 
šlše
 
	gMaybe
<
	gboŞ
> 
HasOwnPrİ”ty
(

223 
v8
::
HªdË
<v8::
Objeù
> 
obj


224 , 
v8
::
HªdË
<v8::
SŒšg
> 
key
) {

225  
Ju¡
<
boŞ
>(
obj
->
HasOwnPrİ”ty
(
key
));

228 
šlše
 
	gMaybe
<
	gboŞ
> 
HasR—lNamedPrİ”ty
(

229 
v8
::
HªdË
<v8::
Objeù
> 
obj


230 , 
v8
::
HªdË
<v8::
SŒšg
> 
key
) {

231  
Ju¡
<
boŞ
>(
obj
->
HasR—lNamedPrİ”ty
(
key
));

234 
šlše
 
	gMaybe
<
	gboŞ
> 
HasR—lIndexedPrİ”ty
(

235 
v8
::
HªdË
<v8::
Objeù
> 
obj


236 , 
ušt32_t
 
šdex
) {

237  
	gJu¡
<
	gboŞ
>(
	gobj
->
HasR—lIndexedPrİ”ty
(
šdex
));

240 
šlše
 
	gMaybe
<
	gboŞ
> 
HasR—lNamedC®lbackPrİ”ty
(

241 
v8
::
HªdË
<v8::
Objeù
> 
obj


242 , 
v8
::
HªdË
<v8::
SŒšg
> 
key
) {

243  
Ju¡
<
boŞ
>(
obj
->
HasR—lNamedC®lbackPrİ”ty
(
key
));

246 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘R—lNamedPrİ”tyInPrÙÙy³Chaš
(

247 
v8
::
HªdË
<v8::
Objeù
> 
obj


248 , 
v8
::
HªdË
<v8::
SŒšg
> 
key
) {

249  
MaybeLoÿl
<
v8
::
V®ue
>(

250 
obj
->
G‘R—lNamedPrİ”tyInPrÙÙy³Chaš
(
key
));

253 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
G‘R—lNamedPrİ”ty
(

254 
v8
::
HªdË
<v8::
Objeù
> 
obj


255 , 
v8
::
HªdË
<v8::
SŒšg
> 
key
) {

256  
MaybeLoÿl
<
v8
::
V®ue
>(
obj
->
G‘R—lNamedPrİ”ty
(
key
));

259 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
C®lAsFunùiÚ
(

260 
v8
::
HªdË
<v8::
Objeù
> 
obj


261 , 
v8
::
HªdË
<v8::
Objeù
> 
»cv


262 , 
¬gc


263 , 
v8
::
HªdË
<v8::
V®ue
> 
¬gv
[]) {

264  
MaybeLoÿl
<
v8
::
V®ue
>(
obj
->
C®lAsFunùiÚ
(
»cv
, 
¬gc
, 
¬gv
));

267 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
C®lAsCÚ¡ruùÜ
(

268 
v8
::
HªdË
<v8::
Objeù
> 
obj


269 , 
¬gc


270 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) {

271  
MaybeLoÿl
<
v8
::
V®ue
>(
obj
->
C®lAsCÚ¡ruùÜ
(
¬gc
, 
¬gv
));

274 
šlše


275 
	gMaybeLoÿl
<
	gv8
::
SŒšg
> 
G‘SourûLše
(
v8
::
HªdË
<v8::
Mes§ge
> 
msg
) {

276  
MaybeLoÿl
<
v8
::
SŒšg
>(
msg
->
G‘SourûLše
());

279 
šlše
 
	gMaybe
<> 
G‘LšeNumb”
(
v8
::
HªdË
<v8::
Mes§ge
> 
msg
) {

280  
Ju¡
<>(
msg
->
G‘LšeNumb”
());

283 
šlše
 
	gMaybe
<> 
G‘S¹CŞumn
(
v8
::
HªdË
<v8::
Mes§ge
> 
msg
) {

284  
Ju¡
<>(
msg
->
G‘S¹CŞumn
());

287 
šlše
 
	gMaybe
<> 
G‘EndCŞumn
(
v8
::
HªdË
<v8::
Mes§ge
> 
msg
) {

288  
Ju¡
<>(
msg
->
G‘EndCŞumn
());

291 
šlše
 
	gMaybeLoÿl
<
	gv8
::
Objeù
> 
ClÚeEËm’tAt
(

292 
v8
::
HªdË
<v8::
A¼ay
> 
¬¿y


293 , 
ušt32_t
 
šdex
) {

294  
	gMaybeLoÿl
<
	gv8
::
Objeù
>(
¬¿y
->
ClÚeEËm’tAt
(
šdex
));

297 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
> 
C®l
(

298 
v8
::
Loÿl
<v8::
FunùiÚ
> 
fun


299 , 
v8
::
Loÿl
<v8::
Objeù
> 
»cv


300 , 
¬gc


301 , 
v8
::
Loÿl
<v8::
V®ue
> 
¬gv
[]) {

302  
MaybeLoÿl
<
v8
::
V®ue
>(
fun
->
C®l
(
»cv
, 
¬gc
, 
¬gv
));

	@utils/webnao/node_modules/nan/nan_new.h

9 #iâdeà
NAN_NEW_H_


10 
	#NAN_NEW_H_


	)

12 
Çme¥aû
 
	gimp
 {

15 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
	gv8
::
Loÿl
<
T
> 
To
(
v8
::Loÿl<v8::
IÁeg”
> 
i
);

17 
	g‹m¶©e
 <>

18 
šlše


19 
	gv8
::
Loÿl
<
v8
::
IÁeg”
>

20 
To
<
v8
::
IÁeg”
>(v8::
Loÿl
<v8::IÁeg”> 
i
) {

21  
Nª
::
To
<
v8
::
IÁeg”
>(
i
).
ToLoÿlChecked
();

24 
	g‹m¶©e
 <>

25 
šlše


26 
	gv8
::
Loÿl
<
v8
::
IÁ32
>

27 
To
<
v8
::
IÁ32
>(v8::
Loÿl
<v8::
IÁeg”
> 
i
) {

28  
Nª
::
To
<
v8
::
IÁ32
>(
i
).
ToLoÿlChecked
();

31 
	g‹m¶©e
 <>

32 
šlše


33 
	gv8
::
Loÿl
<
v8
::
Ušt32
>

34 
To
<
v8
::
Ušt32
>(v8::
Loÿl
<v8::
IÁeg”
> 
i
) {

35  
Nª
::
To
<
v8
::
Ušt32
>(
i
).
ToLoÿlChecked
();

38 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
	sFaùÜyBa£
 {

39 
	gv8
::
	tLoÿl
<
	tT
> 
	t»tuº_t
;

42 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
	sMaybeFaùÜyBa£
 {

43 
	gMaybeLoÿl
<
	tT
> 
	t»tuº_t
;

46 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
	gFaùÜy
;

48 
	g‹m¶©e
 <>

49 
	gFaùÜy
<
	gv8
::
A¼ay
> : 
FaùÜyBa£
<
v8
::Array> {

50 
šlše
 
»tuº_t
 
New
();

51 
šlše
 
»tuº_t
 
New
(
Ëngth
);

54 
	g‹m¶©e
 <>

55 
	gFaùÜy
<
	gv8
::
BoŞ—n
> : 
FaùÜyBa£
<
v8
::Boolean> {

56 
šlše
 
»tuº_t
 
New
(
boŞ
 
v®ue
);

59 
	g‹m¶©e
 <>

60 
	gFaùÜy
<
	gv8
::
BoŞ—nObjeù
> : 
FaùÜyBa£
<
v8
::BooleanObject> {

61 
šlše
 
»tuº_t
 
New
(
boŞ
 
v®ue
);

64 
	g‹m¶©e
 <>

65 
	gFaùÜy
<
	gv8
::
CÚ‹xt
> : 
FaùÜyBa£
<
v8
::Context> {

66 
šlše


67 
»tuº_t


68 
New
Ğ
v8
::
Ex‹nsiÚCÚfigu¿tiÚ
* 
ex‹nsiÚs
 = 
NULL


69 , 
v8
::
Loÿl
<v8::
ObjeùTem¶©e
> 
tm¶
 = v8::Local<v8::ObjectTemplate>()

70 , 
v8
::
Loÿl
<v8::
V®ue
> 
obj
 = v8::Local<v8::Value>());

73 
	g‹m¶©e
 <>

74 
	gFaùÜy
<
	gv8
::
D©e
> : 
MaybeFaùÜyBa£
<
v8
::Date> {

75 
šlše
 
»tuº_t
 
New
(
v®ue
);

78 
	g‹m¶©e
 <>

79 
	gFaùÜy
<
	gv8
::
Ex‹º®
> : 
FaùÜyBa£
<
v8
::External> {

80 
šlše
 
»tuº_t
 
New
(*
v®ue
);

83 
	g‹m¶©e
 <>

84 
	gFaùÜy
<
	gv8
::
FunùiÚ
> : 
FaùÜyBa£
<
v8
::Function> {

85 
šlše


86 
»tuº_t


87 
New
Ğ
FunùiÚC®lback
 
ÿÎback


88 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>());

91 
	g‹m¶©e
 <>

92 
	gFaùÜy
<
	gv8
::
FunùiÚTem¶©e
> : 
FaùÜyBa£
<
v8
::FunctionTemplate> {

93 
šlše


94 
»tuº_t


95 
New
Ğ
FunùiÚC®lback
 
ÿÎback
 = 
NULL


96 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()

97 , 
v8
::
Loÿl
<v8::
SigÇtu»
> 
sigÇtu»
 = v8::Local<v8::Signature>());

100 
	g‹m¶©e
 <>

101 
	gFaùÜy
<
	gv8
::
Numb”
> : 
FaùÜyBa£
<
v8
::Number> {

102 
šlše
 
»tuº_t
 
New
(
v®ue
);

105 
	g‹m¶©e
 <>

106 
	gFaùÜy
<
	gv8
::
Numb”Objeù
> : 
FaùÜyBa£
<
v8
::NumberObject> {

107 
šlše
 
»tuº_t
 
New
(
v®ue
);

110 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

111 
	gIÁeg”FaùÜy
 : 
FaùÜyBa£
<
T
> {

112 
ty³Çme
 
	tFaùÜyBa£
<
	tT
>::
	t»tuº_t
„eturn_t;

113 
šlše
 
»tuº_t
 
New
(
št32_t
 
v®ue
);

114 
šlše
 
»tuº_t
 
New
(
ušt32_t
 
v®ue
);

117 
	g‹m¶©e
 <>

118 
	gFaùÜy
<
	gv8
::
IÁeg”
> : 
IÁeg”FaùÜy
<
v8
::Integer> {};

120 
	g‹m¶©e
 <>

121 
	gFaùÜy
<
	gv8
::
IÁ32
> : 
IÁeg”FaùÜy
<
v8
::Int32> {};

123 
	g‹m¶©e
 <>

124 
	gFaùÜy
<
	gv8
::
Ušt32
> : 
FaùÜyBa£
<
v8
::Uint32> {

125 
šlše
 
»tuº_t
 
New
(
št32_t
 
v®ue
);

126 
šlše
 
»tuº_t
 
New
(
ušt32_t
 
v®ue
);

129 
	g‹m¶©e
 <>

130 
	gFaùÜy
<
	gv8
::
Objeù
> : 
FaùÜyBa£
<
v8
::Object> {

131 
šlše
 
»tuº_t
 
New
();

134 
	g‹m¶©e
 <>

135 
	gFaùÜy
<
	gv8
::
ObjeùTem¶©e
> : 
FaùÜyBa£
<
v8
::ObjectTemplate> {

136 
šlše
 
»tuº_t
 
New
();

139 
	g‹m¶©e
 <>

140 
	gFaùÜy
<
	gv8
::
RegExp
> : 
MaybeFaùÜyBa£
<
v8
::RegExp> {

141 
šlše
 
»tuº_t
 
New
(

142 
v8
::
Loÿl
<v8::
SŒšg
> 
·‰”n
, v8::
RegExp
::
FÏgs
 
æags
);

145 
	g‹m¶©e
 <>

146 
	gFaùÜy
<
	gv8
::
Süt
> : 
MaybeFaùÜyBa£
<
v8
::Script> {

147 
šlše
 
»tuº_t
 
New
Ğ
v8
::
Loÿl
<v8::
SŒšg
> 
sourû
);

148 
šlše
 
»tuº_t
 
New
Ğ
v8
::
Loÿl
<v8::
SŒšg
> 
sourû


149 , 
v8
::
SütOrigš
 cÚ¡& 
Üigš
);

152 
	g‹m¶©e
 <>

153 
	gFaùÜy
<
	gv8
::
SigÇtu»
> : 
FaùÜyBa£
<
v8
::Signature> {

154 
v8
::
	tLoÿl
<
	tv8
::
	tFunùiÚTem¶©e
> 
	tFTH
;

155 
šlše
 
»tuº_t
 
New
(
FTH
 
»ûiv”
 = FTH());

158 
	g‹m¶©e
 <>

159 
	gFaùÜy
<
	gv8
::
SŒšg
> : 
MaybeFaùÜyBa£
<
v8
::String> {

160 
šlše
 
»tuº_t
 
New
();

161 
šlše
 
»tuº_t
 
New
(cÚ¡ *
v®ue
, 
Ëngth
 = -1);

162 
šlše
 
»tuº_t
 
New
(cÚ¡ 
ušt16_t
 *
v®ue
, 
Ëngth
 = -1);

163 
šlše
 
»tuº_t
 
New
(
¡d
::
¡ršg
 cÚ¡& 
v®ue
);

165 
šlše
 
»tuº_t
 
New
(
v8
::
SŒšg
::
Ex‹º®SŒšgResourû
 * 
v®ue
);

166 
šlše
 
»tuº_t
 
New
(
Ex‹º®OÃBy‹SŒšgResourû
 * 
v®ue
);

169 
	g‹m¶©e
 <>

170 
	gFaùÜy
<
	gv8
::
SŒšgObjeù
> : 
FaùÜyBa£
<
v8
::StringObject> {

171 
šlše
 
»tuº_t
 
New
(
v8
::
Loÿl
<v8::
SŒšg
> 
v®ue
);

176 #ià(
NODE_MODULE_VERSION
 >= 12)

178 
Çme¥aû
 
	gimp
 {

180 
	g‹m¶©e
 <>

181 
	gFaùÜy
<
	gv8
::
UnboundSüt
> : 
MaybeFaùÜyBa£
<
v8
::UnboundScript> {

182 
šlše
 
»tuº_t
 
New
Ğ
v8
::
Loÿl
<v8::
SŒšg
> 
sourû
);

183 
šlše
 
»tuº_t
 
New
Ğ
v8
::
Loÿl
<v8::
SŒšg
> 
sourû


184 , 
v8
::
SütOrigš
 cÚ¡& 
Üigš
);

189 
	~"Çn_im¶em’tiÚ_12_šl.h
"

193 
	~"Çn_im¶em’tiÚ_´e_12_šl.h
"

199 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

200 
ty³Çme
 
	gimp
::
FaùÜy
<
T
>::
»tuº_t


201 
	$New
() {

202  
imp
::
FaùÜy
<
T
>::
	`New
();

203 
	}
}

205 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gA0
>

206 
ty³Çme
 
	gimp
::
FaùÜy
<
T
>::
»tuº_t


207 
	$New
(
A0
 
¬g0
) {

208  
imp
::
FaùÜy
<
T
>::
	`New
(
¬g0
);

209 
	}
}

211 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gA0
,y³Çm
	gA1
>

212 
ty³Çme
 
	gimp
::
FaùÜy
<
T
>::
»tuº_t


213 
	$New
(
A0
 
¬g0
, 
A1
 
¬g1
) {

214  
imp
::
FaùÜy
<
T
>::
	`New
(
¬g0
, 
¬g1
);

215 
	}
}

217 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gA0
,y³Çm
	gA1
,y³Çm
	gA2
>

218 
ty³Çme
 
	gimp
::
FaùÜy
<
T
>::
»tuº_t


219 
	$New
(
A0
 
¬g0
, 
A1
 
¬g1
, 
A2
 
¬g2
) {

220  
imp
::
FaùÜy
<
T
>::
	`New
(
¬g0
, 
¬g1
, 
¬g2
);

221 
	}
}

223 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gA0
,y³Çm
	gA1
,y³Çm
	gA2
,y³Çm
	gA3
>

224 
ty³Çme
 
	gimp
::
FaùÜy
<
T
>::
»tuº_t


225 
	$New
(
A0
 
¬g0
, 
A1
 
¬g1
, 
A2
 
¬g2
, 
A3
 
¬g3
) {

226  
imp
::
FaùÜy
<
T
>::
	`New
(
¬g0
, 
¬g1
, 
¬g2
, 
¬g3
);

227 
	}
}

235 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

236 
ty³Çme
 
	gimp
::
FaùÜy
<
T
>::
»tuº_t


237 
New
Ğ
FunùiÚC®lback
 
ÿÎback


238 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()) {

239  
imp
::
FaùÜy
<
T
>::
New
(
ÿÎback
, 
d©a
);

243 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gA2
>

244 
ty³Çme
 
	gimp
::
FaùÜy
<
T
>::
»tuº_t


245 
New
Ğ
FunùiÚC®lback
 
ÿÎback


246 , 
v8
::
Loÿl
<v8::
V®ue
> 
d©a
 = v8::Local<v8::Value>()

247 , 
A2
 
a2
 = 
	$A2
()) {

248  
imp
::
FaùÜy
<
T
>::
	`New
(
ÿÎback
, 
d©a
, 
a2
);

249 
	}
}

253 #ià
NODE_MODULE_VERSION
 < 
IOJS_3_0_MODULE_VERSION


254 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
HªdË
<T> 
h
);

257 #ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


258 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gM
>

259 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
P”si¡’t
<T, 
M
> cÚ¡& 
p
);

261 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
v8
::
P”si¡’t
<T> cÚ¡& 
p
);

263 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gM
>

264 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
P”si¡’t
<T, 
M
> cÚ¡& 
p
);

265 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

266 
šlše
 
	gv8
::
Loÿl
<
T
> 
New
(
Glob®
<T> cÚ¡& 
p
);

268 
šlše


269 
	gimp
::
FaùÜy
<
v8
::
BoŞ—n
>::
»tuº_t


270 
	$New
(
boŞ
 
v®ue
) {

271  
New
<
v8
::
BoŞ—n
>(
v®ue
);

272 
	}
}

274 
šlše


275 
	gimp
::
FaùÜy
<
v8
::
IÁ32
>::
»tuº_t


276 
	$New
(
št32_t
 
v®ue
) {

277  
New
<
v8
::
IÁ32
>(
v®ue
);

278 
	}
}

280 
šlše


281 
	gimp
::
FaùÜy
<
v8
::
Ušt32
>::
»tuº_t


282 
	$New
(
ušt32_t
 
v®ue
) {

283  
New
<
v8
::
Ušt32
>(
v®ue
);

284 
	}
}

286 
šlše


287 
	gimp
::
FaùÜy
<
v8
::
Numb”
>::
»tuº_t


288 
	$New
(
v®ue
) {

289  
New
<
v8
::
Numb”
>(
v®ue
);

290 
	}
}

292 
šlše


293 
	gimp
::
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


294 
	$New
(
¡d
::
¡ršg
 cÚ¡& 
v®ue
) {

295  
New
<
v8
::
SŒšg
>(
v®ue
);

296 
	}
}

298 
šlše


299 
	gimp
::
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


300 
	$New
(cÚ¡ * 
v®ue
, 
Ëngth
) {

301  
New
<
v8
::
SŒšg
>(
v®ue
, 
Ëngth
);

302 
	}
}

304 
šlše


305 
	gimp
::
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


306 
	$New
(cÚ¡ 
ušt16_t
 * 
v®ue
, 
Ëngth
) {

307  
New
<
v8
::
SŒšg
>(
v®ue
, 
Ëngth
);

308 
	}
}

310 
šlše


311 
	gimp
::
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


312 
	$New
(cÚ¡ * 
v®ue
) {

313  
New
<
v8
::
SŒšg
>(
v®ue
);

314 
	}
}

316 
šlše


317 
	gimp
::
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


318 
	$New
(cÚ¡ 
ušt16_t
 * 
v®ue
) {

319  
New
<
v8
::
SŒšg
>(
v®ue
);

320 
	}
}

322 
šlše


323 
	gimp
::
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


324 
	$New
(
v8
::
SŒšg
::
Ex‹º®SŒšgResourû
 * 
v®ue
) {

325  
New
<
v8
::
SŒšg
>(
v®ue
);

326 
	}
}

328 
šlše


329 
	gimp
::
FaùÜy
<
v8
::
SŒšg
>::
»tuº_t


330 
	$New
(
Ex‹º®OÃBy‹SŒšgResourû
 * 
v®ue
) {

331  
New
<
v8
::
SŒšg
>(
v®ue
);

332 
	}
}

334 
šlše


335 
	gimp
::
FaùÜy
<
v8
::
RegExp
>::
»tuº_t


336 
New
(
v8
::
Loÿl
<v8::
SŒšg
> 
·‰”n
, v8::
RegExp
::
FÏgs
 
æags
) {

337  
New
<
v8
::
RegExp
>(
·‰”n
, 
	gæags
);

	@utils/webnao/node_modules/nan/nan_object_wrap.h

9 #iâdeà
NAN_OBJECT_WRAP_H_


10 
	#NAN_OBJECT_WRAP_H_


	)

12 şas 
	cObjeùW¿p
 {

13 
	mpublic
:

14 
	$ObjeùW¿p
() {

15 
»fs_
 = 0;

19 
vœtu®
 ~
	$ObjeùW¿p
() {

20 ià(
	`³rsi¡’t
().
	`IsEm±y
()) {

24 
	`as£¹
(
	`³rsi¡’t
().
	`IsN—rD—th
());

25 
	`³rsi¡’t
().
	`CË¬W—k
();

26 
	`³rsi¡’t
().
	`Re£t
();

27 
	}
}

30 
	g‹m¶©e
 <
şass
 
	gT
>

31 
šlše
 
T
* 
Unw¿p
(
v8
::
Loÿl
<v8::
Objeù
> 
objeù
) {

32 
as£¹
(!
objeù
.
IsEm±y
());

33 
as£¹
(
objeù
->
IÁ”ÇlF›ldCouÁ
() > 0);

36 * 
	g±r
 = 
G‘IÁ”ÇlF›ldPoš‹r
(
objeù
, 0);

37 
ObjeùW¿p
* 
	gw¿p
 = 
¡©ic_ÿ¡
<ObjeùW¿p*>(
±r
);

38  
	g¡©ic_ÿ¡
<
	gT
*>(
	gw¿p
);

42 
šlše
 
	gv8
::
Loÿl
<
v8
::
Objeù
> 
	$hªdË
() const {

43  
	`New
(
hªdË_
);

44 
	}
}

47 
šlše
 
	gP”si¡’t
<
	gv8
::
Objeù
>& 
	$³rsi¡’t
() {

48  
hªdË_
;

49 
	}
}

52 
	g´Ùeùed
:

53 
šlše
 
W¿p
(
v8
::
Loÿl
<v8::
Objeù
> 
objeù
) {

54 
as£¹
(
³rsi¡’t
().
IsEm±y
());

55 
as£¹
(
objeù
->
IÁ”ÇlF›ldCouÁ
() > 0);

56 
S‘IÁ”ÇlF›ldPoš‹r
(
objeù
, 0, 
this
);

57 
³rsi¡’t
().
Re£t
(
objeù
);

58 
MakeW—k
();

61 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

62 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

64 
šlše
 
	$MakeW—k
() {

65 
	`³rsi¡’t
().
v8
::
P”si¡’tBa£
<v8::
Objeù
>::
	`S‘W—k
(

66 
this
, 
W—kC®lback
, 
v8
::
W—kC®lbackTy³
::
kP¬am‘”
);

67 
	`³rsi¡’t
().
	`M¬kInd•’d’t
();

68 
	}
}

70 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


72 
šlše
 
	$MakeW—k
() {

73 
	`³rsi¡’t
().
v8
::
P”si¡’tBa£
<v8::
Objeù
>::
	`S‘W—k
(
this
, 
W—kC®lback
);

74 
	`³rsi¡’t
().
	`M¬kInd•’d’t
();

75 
	}
}

79 
šlše
 
	$MakeW—k
() {

80 
	`³rsi¡’t
().
³rsi¡’t
.
	`MakeW—k
(
this
, 
W—kC®lback
);

81 
	`³rsi¡’t
().
	`M¬kInd•’d’t
();

82 
	}
}

90 
vœtu®
 
	$Ref
() {

91 
	`as£¹
(!
	`³rsi¡’t
().
	`IsEm±y
());

92 
	`³rsi¡’t
().
	`CË¬W—k
();

93 
»fs_
++;

94 
	}
}

105 
vœtu®
 
	$UÄef
() {

106 
	`as£¹
(!
	`³rsi¡’t
().
	`IsEm±y
());

107 
	`as£¹
(!
	`³rsi¡’t
().
	`IsW—k
());

108 
	`as£¹
(
»fs_
 > 0);

109 ià(--
»fs_
 == 0)

110 
	`MakeW—k
();

111 
	}
}

113 
	g»fs_
;

115 
	g´iv©e
:

116 
	$NAN_DISALLOW_ASSIGN_COPY_MOVE
(
ObjeùW¿p
)

117 #ià
	`defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

118 (
V8_MAJOR_VERSION
 =ğ4 && 
	`defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

121 
	`W—kC®lback
(
v8
::
W—kC®lbackInfo
<
ObjeùW¿p
> cÚ¡& 
šfo
) {

122 
ObjeùW¿p
* 
w¿p
 = 
šfo
.
	`G‘P¬am‘”
();

123 
	`as£¹
(
w¿p
->
»fs_
 == 0);

124 
	`as£¹
(
w¿p
->
hªdË_
.
	`IsN—rD—th
());

125 
w¿p
->
hªdË_
.
	`Re£t
();

126 
d–‘e
 
w¿p
;

127 
	}
}

129 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


132 
W—kC®lback
(
v8
::
W—kC®lbackD©a
<v8::
Objeù
, 
ObjeùW¿p
> cÚ¡& 
d©a
) {

133 
ObjeùW¿p
* 
	gw¿p
 = 
d©a
.
G‘P¬am‘”
();

134 
as£¹
(
w¿p
->
»fs_
 == 0);

135 
as£¹
(
w¿p
->
hªdË_
.
IsN—rD—th
());

136 
	gw¿p
->
	ghªdË_
.
Re£t
();

137 
d–‘e
 
	gw¿p
;

142 
W—kC®lback
(
v8
::
P”si¡’t
<v8::
V®ue
> 
v®ue
, *
d©a
) {

143 
ObjeùW¿p
 *
	gw¿p
 = 
¡©ic_ÿ¡
<ObjeùW¿p*>(
d©a
);

144 
as£¹
(
w¿p
->
»fs_
 == 0);

145 
as£¹
(
w¿p
->
hªdË_
.
IsN—rD—th
());

146 
	gw¿p
->
	ghªdË_
.
Re£t
();

147 
d–‘e
 
	gw¿p
;

151 
	gP”si¡’t
<
	gv8
::
Objeù
> 
hªdË_
;

	@utils/webnao/node_modules/nan/nan_persistent_12_inl.h

9 #iâdeà
NAN_PERSISTENT_12_INL_H_


10 
	#NAN_PERSISTENT_12_INL_H_


	)

12 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gM
> 
şass
 
	gP”si¡’t
 :

13 
public
 
v8
::
P”si¡’t
<
T
, 
	gM
> {

14 
	gpublic
:

15 
šlše
 
P”si¡’t
(è: 
v8
::P”si¡’t<
T
, 
	gM
>() {}

17 
	g‹m¶©e
<
ty³Çme
 
	gS
> 
šlše
 
P”si¡’t
(
v8
::
Loÿl
<
S
> 
th©
) :

18 
v8
::
P”si¡’t
<
T
, 
	gM
>(
	gv8
::
IsŞ©e
::
G‘Cu¼’t
(), 
	gth©
) {}

20 
	g‹m¶©e
<
ty³Çme
 
	gS
,y³Çm
	gM2
>

21 
šlše


22 
P”si¡’t
(cÚ¡ 
v8
::P”si¡’t<
S
, 
M2
> &
th©
) :

23 
v8
::
P”si¡’t
<
T
, 
	gM2
>(
	gv8
::
IsŞ©e
::
G‘Cu¼’t
(), 
	gth©
) {}

25 
šlše
 
Re£t
(è{ 
	gv8
::
P”si¡’tBa£
<
T
>::Reset(); }

27 
	g‹m¶©e
 <
ty³Çme
 
	gS
>

28 
šlše
 
Re£t
(cÚ¡ 
v8
::
Loÿl
<
S
> &
Ùh”
) {

29 
v8
::
P”si¡’tBa£
<
T
>::
Re£t
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
Ùh”
);

32 
	g‹m¶©e
 <
ty³Çme
 
	gS
>

33 
šlše
 
Re£t
(cÚ¡ 
v8
::
P”si¡’tBa£
<
S
> &
Ùh”
) {

34 
v8
::
P”si¡’tBa£
<
T
>::
Re£t
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
Ùh”
);

37 
	g‹m¶©e
<
ty³Çme
 
	gP
>

38 
šlše
 
S‘W—k
(

39 
P
 *
·¿m‘”


40 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


41 , 
W—kC®lbackTy³
 
ty³
);

43 
	g´iv©e
:

44 
šlše
 
T
 *
İ”©Ü
*(ècÚ¡ {  *
P”si¡’tBa£
<T>::
³rsi¡’t
; }

46 
	g‹m¶©e
<
ty³Çme
 
	gS
,y³Çm
	gM2
>

47 
šlše
 
Cİy
(cÚ¡ 
P”si¡’t
<
S
, 
M2
> &
th©
) {

48 
TYPE_CHECK
(
T
, 
S
);

50 
	gthis
->
Re£t
();

52 ià(!
	gth©
.
IsEm±y
()) {

53 
	gthis
->
Re£t
(
th©
);

54 
	gM
::
Cİy
(
th©
, 
this
);

59 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

60 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

61 
‹m¶©e
<
ty³Çme
 
T
>

62 
şass
 
Glob®
 : 
public
 
v8
::Glob®<
T
> {

63 
public
:

64 
šlše
 
Glob®
(è: 
v8
::Glob®<
T
>() {}

66 
‹m¶©e
<
ty³Çme
 
S
> 
šlše
 
Glob®
(
v8
::
Loÿl
<S> 
th©
) :

67 
v8
::
Glob®
<
T
>(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
th©
) {}

69 
‹m¶©e
<
ty³Çme
 
S
>

70 
šlše


71 
Glob®
(cÚ¡ 
v8
::
P”si¡’tBa£
<
S
> &
th©
) :

72 
v8
::
Glob®
<
S
>(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
th©
) {}

74 
šlše
 
Re£t
(è{ 
v8
::
P”si¡’tBa£
<
T
>::Reset(); }

76 
	g‹m¶©e
 <
ty³Çme
 
	gS
>

77 
šlše
 
Re£t
(cÚ¡ 
v8
::
Loÿl
<
S
> &
Ùh”
) {

78 
v8
::
P”si¡’tBa£
<
T
>::
Re£t
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
Ùh”
);

81 
	g‹m¶©e
 <
ty³Çme
 
	gS
>

82 
šlše
 
Re£t
(cÚ¡ 
v8
::
P”si¡’tBa£
<
S
> &
Ùh”
) {

83 
v8
::
P”si¡’tBa£
<
T
>::
Re£t
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
Ùh”
);

86 
	g‹m¶©e
<
ty³Çme
 
	gP
>

87 
šlše
 
S‘W—k
(

88 
P
 *
·¿m‘”


89 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


90 , 
W—kC®lbackTy³
 
ty³
) {

91 
	g»š‹½»t_ÿ¡
<
	gP”si¡’t
<
	gT
>*>(
	gthis
)->
S‘W—k
(

92 
·¿m‘”
, 
ÿÎback
, 
ty³
);

96 
	g‹m¶©e
<
ty³Çme
 
	gT
>

97 
şass
 
	gGlob®
 : 
public
 
v8
::
UniqueP”si¡’t
<
T
> {

98 
public
:

99 
šlše
 
Glob®
(è: 
v8
::
UniqueP”si¡’t
<
T
>() {}

101 
‹m¶©e
<
ty³Çme
 
S
> 
šlše
 
Glob®
(
v8
::
Loÿl
<S> 
th©
) :

102 
v8
::
UniqueP”si¡’t
<
T
>(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
	gth©
) {}

104 
	g‹m¶©e
<
ty³Çme
 
	gS
>

105 
šlše


106 
Glob®
(cÚ¡ 
v8
::
P”si¡’tBa£
<
S
> &
th©
) :

107 
v8
::
UniqueP”si¡’t
<
S
>(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
	gth©
) {}

109 
šlše
 
Re£t
(è{ 
	gv8
::
P”si¡’tBa£
<
T
>::Reset(); }

111 
	g‹m¶©e
 <
ty³Çme
 
	gS
>

112 
šlše
 
Re£t
(cÚ¡ 
v8
::
Loÿl
<
S
> &
Ùh”
) {

113 
v8
::
P”si¡’tBa£
<
T
>::
Re£t
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
Ùh”
);

116 
	g‹m¶©e
 <
ty³Çme
 
	gS
>

117 
šlše
 
Re£t
(cÚ¡ 
v8
::
P”si¡’tBa£
<
S
> &
Ùh”
) {

118 
v8
::
P”si¡’tBa£
<
T
>::
Re£t
(v8::
IsŞ©e
::
G‘Cu¼’t
(), 
Ùh”
);

121 
	g‹m¶©e
<
ty³Çme
 
	gP
>

122 
šlše
 
S‘W—k
(

123 
P
 *
·¿m‘”


124 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


125 , 
W—kC®lbackTy³
 
ty³
) {

126 
	g»š‹½»t_ÿ¡
<
	gP”si¡’t
<
	gT
>*>(
	gthis
)->
S‘W—k
(

127 
·¿m‘”
, 
ÿÎback
, 
ty³
);

	@utils/webnao/node_modules/nan/nan_persistent_pre_12_inl.h

9 #iâdeà
NAN_PERSISTENT_PRE_12_INL_H_


10 
	#NAN_PERSISTENT_PRE_12_INL_H_


	)

12 
	g‹m¶©e
<
ty³Çme
 
	gT
>

13 şas 
	cP”si¡’tBa£
 {

14 
	mv8
::
P”si¡’t
<
T
> 
³rsi¡’t
;

15 
	m‹m¶©e
<
ty³Çme
 
	mU
>

16 
ä›nd
 
	mv8
::
Loÿl
<
U
> 
New
(cÚ¡ 
P”si¡’tBa£
<U> &
p
);

17 
	m‹m¶©e
<
ty³Çme
 
	mU
,y³Çm
	mM
>

18 
ä›nd
 
	mv8
::
Loÿl
<
U
> 
New
(cÚ¡ 
P”si¡’t
<U, 
M
> &
p
);

19 
	m‹m¶©e
<
ty³Çme
 
	mU
>

20 
ä›nd
 
	mv8
::
Loÿl
<
U
> 
New
(cÚ¡ 
Glob®
<U> &
p
);

21 
	m‹m¶©e
<
ty³Çme
 
	mS
> 
ä›nd
 
şass
 
	mR‘uºV®ue
;

23 
	mpublic
:

24 
šlše
 
	$P”si¡’tBa£
() :

25 
	$³rsi¡’t
() {}

27 
šlše
 
	$Re£t
() {

28 
³rsi¡’t
.
	`Di¥o£
();

29 
³rsi¡’t
.
	`CË¬
();

30 
	}
}

32 
	g‹m¶©e
<
ty³Çme
 
	gS
>

33 
šlše
 
Re£t
(cÚ¡ 
v8
::
Loÿl
<
S
> &
Ùh”
) {

34 
TYPE_CHECK
(
T
, 
S
);

36 ià(!
	g³rsi¡’t
.
IsEm±y
()) {

37 
	g³rsi¡’t
.
Di¥o£
();

40 ià(
	gÙh”
.
IsEm±y
()) {

41 
	g³rsi¡’t
.
CË¬
();

43 
	g³rsi¡’t
 = 
v8
::
P”si¡’t
<
T
>::
New
(
Ùh”
);

47 
	g‹m¶©e
<
ty³Çme
 
	gS
>

48 
šlše
 
Re£t
(cÚ¡ 
P”si¡’tBa£
<
S
> &
Ùh”
) {

49 
TYPE_CHECK
(
T
, 
S
);

51 ià(!
	g³rsi¡’t
.
IsEm±y
()) {

52 
	g³rsi¡’t
.
Di¥o£
();

55 ià(
	gÙh”
.
IsEm±y
()) {

56 
	g³rsi¡’t
.
CË¬
();

58 
	g³rsi¡’t
 = 
v8
::
P”si¡’t
<
T
>::
New
(
Ùh”
.
³rsi¡’t
);

62 
šlše
 
boŞ
 
	$IsEm±y
(ècÚ¡ {  
³rsi¡’t
.
	`IsEm±y
(); 
	}
}

64 
šlše
 
	$Em±y
(è{ 
³rsi¡’t
.
	`CË¬
(); 
	}
}

66 
	g‹m¶©e
<
ty³Çme
 
	gS
>

67 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
P”si¡’tBa£
<
S
> &
th©
) const {

68  
this
->
³rsi¡’t
 =ğ
th©
.persistent;

71 
	g‹m¶©e
<
ty³Çme
 
	gS
>

72 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
v8
::
Loÿl
<
S
> &
th©
) const {

73  
this
->
³rsi¡’t
 =ğ
th©
;

76 
	g‹m¶©e
<
ty³Çme
 
	gS
>

77 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
P”si¡’tBa£
<
S
> &
th©
) const {

78  !
İ”©Ü
==(
th©
);

81 
	g‹m¶©e
<
ty³Çme
 
	gS
>

82 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
v8
::
Loÿl
<
S
> &
th©
) const {

83  !
İ”©Ü
==(
th©
);

86 
	g‹m¶©e
<
ty³Çme
 
	gP
>

87 
šlše
 
S‘W—k
(

88 
P
 *
·¿m‘”


89 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


90 , 
W—kC®lbackTy³
 
ty³
);

92 
šlše
 
	$CË¬W—k
(è{ 
³rsi¡’t
.
	`CË¬W—k
(); 
	}
}

94 
šlše
 
	$M¬kInd•’d’t
(è{ 
³rsi¡’t
.
	`M¬kInd•’d’t
(); 
	}
}

96 
šlše
 
boŞ
 
	$IsInd•’d’t
(ècÚ¡ {  
³rsi¡’t
.
	`IsInd•’d’t
(); 
	}
}

98 
šlše
 
boŞ
 
	$IsN—rD—th
(ècÚ¡ {  
³rsi¡’t
.
	`IsN—rD—th
(); 
	}
}

100 
šlše
 
boŞ
 
	$IsW—k
(ècÚ¡ {  
³rsi¡’t
.
	`IsW—k
(); 
	}
}

102 
	g´iv©e
:

103 
šlše
 
ex¶ic™
 
P”si¡’tBa£
(
v8
::
P”si¡’t
<
T
> 
th©
) :

104 
	$³rsi¡’t
(
th©
è{ 
	}
}

105 
šlše
 
ex¶ic™
 
	$P”si¡’tBa£
(
T
 *
v®
è: 
	$³rsi¡’t
(
v®
è{
	}
}

106 
‹m¶©e
<
ty³Çme
 
S
,y³Çm
	gM
> 
ä›nd
 
şass
 
	gP”si¡’t
;

107 
	g‹m¶©e
<
ty³Çme
 
	gS
> 
ä›nd
 
şass
 
	gGlob®
;

108 
ä›nd
 
şass
 
	gObjeùW¿p
;

111 
	g‹m¶©e
<
ty³Çme
 
	gT
>

112 şas 
	cNÚCİyabËP”si¡’tT¿™s
 {

113 
	mpublic
:

114 
P”si¡’t
<
	tT
, 
	tNÚCİyabËP”si¡’tT¿™s
<T> >

115 
	tNÚCİyabËP”si¡’t
;

116 cÚ¡ 
boŞ
 
	mkRe£tInDe¡ruùÜ
 = 
çl£
;

117 
	m‹m¶©e
<
ty³Çme
 
	mS
,y³Çm
	mM
>

118 
šlše
 
Cİy
(cÚ¡ 
P”si¡’t
<
S
, 
M
> &
sourû
,

119 
NÚCİyabËP”si¡’t
 *
de¡
) {

120 
	mUncompabË
<
	mv8
::
Objeù
>();

123 
	g‹m¶©e
<
ty³Çme
 
	gO
> 
šlše
 
	$UncompabË
() {

124 
	`TYPE_CHECK
(
O
, 
v8
::
Prim™ive
);

125 
	}
}

128 
	g‹m¶©e
<
ty³Çme
 
	gT
>

129 
	sCİyabËP”si¡’tT¿™s
 {

130 
	mP”si¡’t
<
	tT
, 
	tCİyabËP”si¡’tT¿™s
<T> > 
	tCİyabËP”si¡’t
;

131 cÚ¡ 
boŞ
 
	mkRe£tInDe¡ruùÜ
 = 
Œue
;

132 
	m‹m¶©e
<
ty³Çme
 
	mS
,y³Çm
	mM
>

133 
šlše
 
Cİy
(cÚ¡ 
P”si¡’t
<
S
, 
M
> &
sourû
,

134 
CİyabËP”si¡’t
 *
de¡
) {}

137 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gM
> 
şass
 
	gP”si¡’t
 :

138 
public
 
P”si¡’tBa£
<
T
> {

139 
public
:

140 
šlše
 
P”si¡’t
() {}

142 
‹m¶©e
<
ty³Çme
 
S
> 
šlše
 
P”si¡’t
(
v8
::
HªdË
<S> 
th©
)

143 : 
P”si¡’tBa£
<
T
>(
v8
::
P”si¡’t
<T>::
New
(
th©
)) {

144 
TYPE_CHECK
(
T
, 
S
);

147 
šlše
 
P”si¡’t
(cÚ¡ P”si¡’ˆ&
th©
è: 
P”si¡’tBa£
<
T
>() {

148 
Cİy
(
th©
);

151 
	g‹m¶©e
<
ty³Çme
 
	gS
,y³Çm
	gM2
>

152 
šlše
 
P”si¡’t
(cÚ¡ P”si¡’t<
S
, 
M2
> &
th©
) :

153 
P”si¡’tBa£
<
T
>() {

154 
Cİy
(
th©
);

157 
šlše
 
	gP”si¡’t
 &
	gİ”©Ü
=(cÚ¡ 
P”si¡’t
 &
th©
) {

158 
Cİy
(
th©
);

159  *
	gthis
;

162 
	g‹m¶©e
 <
şass
 
	gS
, cÏs 
	gM2
>

163 
šlše
 
	gP”si¡’t
 &
	gİ”©Ü
=(cÚ¡ 
P”si¡’t
<
S
, 
	gM2
> &
	gth©
) {

164 
Cİy
(
th©
);

165  *
	gthis
;

168 
	gšlše
 ~
P”si¡’t
() {

169 ià(
	gM
::
kRe£tInDe¡ruùÜ
è
this
->
Re£t
();

172 
	g´iv©e
:

173 
šlše
 
T
 *
İ”©Ü
*(ècÚ¡ {  *
P”si¡’tBa£
<T>::
³rsi¡’t
; }

175 
	g‹m¶©e
<
ty³Çme
 
	gS
,y³Çm
	gM2
>

176 
šlše
 
Cİy
(cÚ¡ 
P”si¡’t
<
S
, 
M2
> &
th©
) {

177 
TYPE_CHECK
(
T
, 
S
);

179 
	gthis
->
Re£t
();

181 ià(!
	gth©
.
IsEm±y
()) {

182 
	gthis
->
	g³rsi¡’t
 = 
v8
::
P”si¡’t
<
T
>::
New
(
th©
.
³rsi¡’t
);

183 
	gM
::
Cİy
(
th©
, 
this
);

188 
	g‹m¶©e
<
ty³Çme
 
	gT
>

189 
şass
 
	gGlob®
 : 
public
 
P”si¡’tBa£
<
T
> {

190 
	sRV®ue
 {

191 
šlše
 
ex¶ic™
 
RV®ue
(
Glob®
* 
obj
è: 
objeù
(obj) {}

192 
Glob®
* 
objeù
;

195 
	gpublic
:

196 
šlše
 
Glob®
(è: 
P”si¡’tBa£
<
T
>(0) { }

198 
‹m¶©e
 <
ty³Çme
 
S
>

199 
šlše
 
Glob®
(
v8
::
Loÿl
<
S
> 
th©
)

200 : 
P”si¡’tBa£
<
T
>(
v8
::
P”si¡’t
<T>::
New
(
th©
)) {

201 
TYPE_CHECK
(
T
, 
S
);

204 
	g‹m¶©e
 <
ty³Çme
 
	gS
>

205 
šlše
 
Glob®
(cÚ¡ 
P”si¡’tBa£
<
S
> &
th©
)

206 : 
P”si¡’tBa£
<
T
>(
th©
) {

207 
TYPE_CHECK
(
T
, 
S
);

212 
šlše
 
Glob®
(
RV®ue
 
rv®ue
)

213 : 
P”si¡’tBa£
<
T
>(
rv®ue
.
objeù
->
³rsi¡’t
) {

214 
rv®ue
.
objeù
->
Re£t
();

216 
	gšlše
 ~
Glob®
(è{ 
	gthis
->
Re£t
(); }

220 
	g‹m¶©e
<
ty³Çme
 
	gS
>

221 
šlše
 
	gGlob®
 &
	gİ”©Ü
=(
Glob®
<
S
> 
rhs
) {

222 
TYPE_CHECK
(
T
, 
S
);

223 
	gthis
->
Re£t
(
rhs
.
³rsi¡’t
);

224 
	grhs
.
Re£t
();

225  *
	gthis
;

230 
šlše
 
İ”©Ü
 
RV®ue
(è{  RV®ue(
this
); }

234 
Glob®
 
Pass
(è{  Glob®(
RV®ue
(
this
)); }

236 
	g´iv©e
:

237 
Glob®
(Global &);

238 
	gİ”©Ü
=(
Glob®
 &);

239 
	g‹m¶©e
<
ty³Çme
 
	gS
> 
ä›nd
 
şass
 
	gR‘uºV®ue
;

	@utils/webnao/node_modules/nan/nan_private.h

9 #iâdeà
NAN_PRIVATE_H_


10 
	#NAN_PRIVATE_H_


	)

12 
šlše
 
	gMaybe
<
	gboŞ
>

13 
HasPriv©e
(
v8
::
Loÿl
<v8::
Objeù
> 
objeù
, v8::Loÿl<v8::
SŒšg
> 
key
) {

14 
HªdËScİe
 
scİe
;

15 #ià
NODE_MODULE_VERSION
 >ğ
NODE_6_0_MODULE_VERSION


16 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

17 
	gv8
::
Loÿl
<
v8
::
CÚ‹xt
> 
cÚ‹xt
 = 
isŞ©e
->
G‘Cu¼’tCÚ‹xt
();

18 
	gv8
::
Loÿl
<
v8
::
Priv©e
> 
´iv©e_key
 = v8::Priv©e::
FÜApi
(
isŞ©e
, 
key
);

19  
	gobjeù
->
HasPriv©e
(
cÚ‹xt
, 
´iv©e_key
);

21  
Ju¡
(!
objeù
->
G‘Hidd’V®ue
(
key
).
IsEm±y
());

25 
šlše
 
	gMaybeLoÿl
<
	gv8
::
V®ue
>

26 
G‘Priv©e
(
v8
::
Loÿl
<v8::
Objeù
> 
objeù
, v8::Loÿl<v8::
SŒšg
> 
key
) {

27 #ià
NODE_MODULE_VERSION
 >ğ
NODE_6_0_MODULE_VERSION


28 
v8
::
IsŞ©e
 *
isŞ©e
 = v8::IsŞ©e::
G‘Cu¼’t
();

29 
	gv8
::
Esÿ·bËHªdËScİe
 
scİe
(
isŞ©e
);

30 
	gv8
::
Loÿl
<
v8
::
CÚ‹xt
> 
cÚ‹xt
 = 
isŞ©e
->
G‘Cu¼’tCÚ‹xt
();

31 
	gv8
::
Loÿl
<
v8
::
Priv©e
> 
´iv©e_key
 = v8::Priv©e::
FÜApi
(
isŞ©e
, 
key
);

32 
	gv8
::
MaybeLoÿl
<
v8
::
V®ue
> 
v
 = 
objeù
->
G‘Priv©e
(
cÚ‹xt
, 
´iv©e_key
);

33  
	gscİe
.
Esÿ³
(
v
.
ToLoÿlChecked
());

35 
Esÿ·bËHªdËScİe
 
	gscİe
;

36 
	gv8
::
Loÿl
<
v8
::
V®ue
> 
v
 = 
objeù
->
G‘Hidd’V®ue
(
key
);

37 ià(
	gv
.
IsEm±y
()) {

38 
	gv
 = 
Undefšed
();

40  
	gscİe
.
Esÿ³
(
v
);

44 
šlše
 
	gMaybe
<
	gboŞ
> 
S‘Priv©e
(

45 
v8
::
Loÿl
<v8::
Objeù
> 
objeù
,

46 
v8
::
Loÿl
<v8::
SŒšg
> 
key
,

47 
v8
::
Loÿl
<v8::
V®ue
> 
v®ue
) {

48 #ià
NODE_MODULE_VERSION
 >ğ
NODE_6_0_MODULE_VERSION


49 
HªdËScİe
 
scİe
;

50 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

51 
	gv8
::
Loÿl
<
v8
::
CÚ‹xt
> 
cÚ‹xt
 = 
isŞ©e
->
G‘Cu¼’tCÚ‹xt
();

52 
	gv8
::
Loÿl
<
v8
::
Priv©e
> 
´iv©e_key
 = v8::Priv©e::
FÜApi
(
isŞ©e
, 
key
);

53  
	gobjeù
->
S‘Priv©e
(
cÚ‹xt
, 
´iv©e_key
, 
v®ue
);

55  
Ju¡
(
objeù
->
S‘Hidd’V®ue
(
key
, 
v®ue
));

59 
šlše
 
	gMaybe
<
	gboŞ
> 
D–‘ePriv©e
(

60 
v8
::
Loÿl
<v8::
Objeù
> 
objeù
,

61 
v8
::
Loÿl
<v8::
SŒšg
> 
key
) {

62 #ià
NODE_MODULE_VERSION
 >ğ
NODE_6_0_MODULE_VERSION


63 
HªdËScİe
 
scİe
;

64 
	gv8
::
IsŞ©e
 *
isŞ©e
 = 
v8
::IsŞ©e::
G‘Cu¼’t
();

65 
	gv8
::
Loÿl
<
v8
::
Priv©e
> 
´iv©e_key
 = v8::Priv©e::
FÜApi
(
isŞ©e
, 
key
);

66  
	gobjeù
->
D–‘ePriv©e
(
isŞ©e
->
G‘Cu¼’tCÚ‹xt
(), 
´iv©e_key
);

68  
Ju¡
(
objeù
->
D–‘eHidd’V®ue
(
key
));

	@utils/webnao/node_modules/nan/nan_string_bytes.h

22 #iâdeà
NAN_STRING_BYTES_H_


23 
	#NAN_STRING_BYTES_H_


	)

27 
Çme¥aû
 
	gimp
 {

29 
usšg
 
	gv8
::
Loÿl
;

30 
usšg
 
	gv8
::
Objeù
;

31 
usšg
 
	gv8
::
SŒšg
;

32 
usšg
 
	gv8
::
V®ue
;

37 
	#ba£64_’coded_size
(
size
è((siz+ 2 - ((siz+ 2è% 3)è/ 3 * 4)

	)

43 
boŞ
 
cÚšs_nÚ_ascii_¦ow
(cÚ¡ * 
buf
, 
size_t
 
Ën
) {

44 
size_t
 
	gi
 = 0; i < 
	gËn
; ++i) {

45 ià(
	gbuf
[
i
] & 0x80è 
	gŒue
;

47  
	gçl£
;

51 
boŞ
 
cÚšs_nÚ_ascii
(cÚ¡ * 
¤c
, 
size_t
 
Ën
) {

52 ià(
	gËn
 < 16) {

53  
cÚšs_nÚ_ascii_¦ow
(
¤c
, 
Ën
);

56 cÚ¡ 
	gby‹s_³r_wÜd
 = (*);

57 cÚ¡ 
	g®ign_mask
 = 
by‹s_³r_wÜd
 - 1;

58 cÚ¡ 
	guÇligÃd
 = 
»š‹½»t_ÿ¡
<
ušŒ_t
>(
¤c
è& 
®ign_mask
;

60 ià(
	guÇligÃd
 > 0) {

61 cÚ¡ 
	gn
 = 
by‹s_³r_wÜd
 - 
uÇligÃd
;

62 ià(
cÚšs_nÚ_ascii_¦ow
(
¤c
, 
n
)è 
	gŒue
;

63 
	g¤c
 +ğ
n
;

64 
	gËn
 -ğ
n
;

68 #ià
defšed
(
__x86_64__
è|| defšed(
_WIN64
)

69 cÚ¡ 
ušŒ_t
 
	gmask
 = 0x8080808080808080ll;

71 cÚ¡ 
ušŒ_t
 
	gmask
 = 0x80808080l;

74 cÚ¡ 
ušŒ_t
* 
	g¤cw
 = 
»š‹½»t_ÿ¡
<cÚ¡ ušŒ_t*>(
¤c
);

76 
size_t
 
	gi
 = 0, 
	gn
 = 
Ën
 / 
by‹s_³r_wÜd
; i <‚; ++i) {

77 ià(
	g¤cw
[
i
] & 
	gmask
è 
	gŒue
;

80 cÚ¡ 
	g»mašd”
 = 
Ën
 & 
®ign_mask
;

81 ià(
	g»mašd”
 > 0) {

82 cÚ¡ 
size_t
 
	goff£t
 = 
Ën
 - 
»mašd”
;

83 ià(
cÚšs_nÚ_ascii_¦ow
(
¤c
 + 
off£t
, 
»mašd”
)è 
	gŒue
;

86  
	gçl£
;

90 
fÜû_ascii_¦ow
(cÚ¡ * 
¤c
, * 
d¡
, 
size_t
 
Ën
) {

91 
size_t
 
	gi
 = 0; i < 
	gËn
; ++i) {

92 
	gd¡
[
i
] = 
¤c
[i] & 0x7f;

97 
fÜû_ascii
(cÚ¡ * 
¤c
, * 
d¡
, 
size_t
 
Ën
) {

98 ià(
	gËn
 < 16) {

99 
fÜû_ascii_¦ow
(
¤c
, 
d¡
, 
Ën
);

103 cÚ¡ 
	gby‹s_³r_wÜd
 = (*);

104 cÚ¡ 
	g®ign_mask
 = 
by‹s_³r_wÜd
 - 1;

105 cÚ¡ 
	g¤c_uÇlign
 = 
»š‹½»t_ÿ¡
<
ušŒ_t
>(
¤c
è& 
®ign_mask
;

106 cÚ¡ 
	gd¡_uÇlign
 = 
»š‹½»t_ÿ¡
<
ušŒ_t
>(
d¡
è& 
®ign_mask
;

108 ià(
	g¤c_uÇlign
 > 0) {

109 ià(
	g¤c_uÇlign
 =ğ
d¡_uÇlign
) {

110 cÚ¡ 
uÇlign
 = 
by‹s_³r_wÜd
 - 
¤c_uÇlign
;

111 
fÜû_ascii_¦ow
(
¤c
, 
d¡
, 
uÇlign
);

112 
	g¤c
 +ğ
uÇlign
;

113 
	gd¡
 +ğ
uÇlign
;

114 
	gËn
 -ğ
¤c_uÇlign
;

116 
fÜû_ascii_¦ow
(
¤c
, 
d¡
, 
Ën
);

121 #ià
defšed
(
__x86_64__
è|| defšed(
_WIN64
)

122 cÚ¡ 
ušŒ_t
 
	gmask
 = ~0x8080808080808080ll;

124 cÚ¡ 
ušŒ_t
 
	gmask
 = ~0x80808080l;

127 cÚ¡ 
ušŒ_t
* 
	g¤cw
 = 
»š‹½»t_ÿ¡
<cÚ¡ ušŒ_t*>(
¤c
);

128 
ušŒ_t
* 
	gd¡w
 = 
»š‹½»t_ÿ¡
<ušŒ_t*>(
d¡
);

130 
size_t
 
	gi
 = 0, 
	gn
 = 
Ën
 / 
by‹s_³r_wÜd
; i <‚; ++i) {

131 
	gd¡w
[
i
] = 
¤cw
[i] & 
mask
;

134 cÚ¡ 
	g»mašd”
 = 
Ën
 & 
®ign_mask
;

135 ià(
	g»mašd”
 > 0) {

136 cÚ¡ 
size_t
 
	goff£t
 = 
Ën
 - 
»mašd”
;

137 
fÜû_ascii_¦ow
(
¤c
 + 
off£t
, 
d¡
 + off£t, 
»mašd”
);

142 
size_t
 
ba£64_’code
(cÚ¡ * 
¤c
,

143 
size_t
 
¦’
,

144 * 
d¡
,

145 
size_t
 
dËn
) {

147 
as£¹
(
dËn
 >ğ
ba£64_’coded_size
(
¦’
) &&

150 
	gdËn
 = 
ba£64_’coded_size
(
¦’
);

152 
	ga
;

153 
	gb
;

154 
	gc
;

155 
	gi
;

156 
	gk
;

157 
	gn
;

159 cÚ¡ 
	gbË
[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"

163 
	gi
 = 0;

164 
	gk
 = 0;

165 
	gn
 = 
¦’
 / 3 * 3;

167 
	gi
 < 
	gn
) {

168 
	ga
 = 
¤c
[
i
 + 0] & 0xff;

169 
	gb
 = 
¤c
[
i
 + 1] & 0xff;

170 
	gc
 = 
¤c
[
i
 + 2] & 0xff;

172 
	gd¡
[
k
 + 0] = 
bË
[
a
 >> 2];

173 
	gd¡
[
k
 + 1] = 
bË
[((
a
 & 3è<< 4è| (
b
 >> 4)];

174 
	gd¡
[
k
 + 2] = 
bË
[((
b
 & 0x0fè<< 2è| (
c
 >> 6)];

175 
	gd¡
[
k
 + 3] = 
bË
[
c
 & 0x3f];

177 
	gi
 += 3;

178 
	gk
 += 4;

181 ià(
	gn
 !ğ
¦’
) {

182 
¦’
 - 
n
) {

184 
a
 = 
¤c
[
i
 + 0] & 0xff;

185 
	gd¡
[
k
 + 0] = 
bË
[
a
 >> 2];

186 
	gd¡
[
k
 + 1] = 
bË
[(
a
 & 3) << 4];

187 
	gd¡
[
k
 + 2] = '=';

188 
	gd¡
[
k
 + 3] = '=';

192 
a
 = 
¤c
[
i
 + 0] & 0xff;

193 
	gb
 = 
¤c
[
i
 + 1] & 0xff;

194 
	gd¡
[
k
 + 0] = 
bË
[
a
 >> 2];

195 
	gd¡
[
k
 + 1] = 
bË
[((
a
 & 3è<< 4è| (
b
 >> 4)];

196 
	gd¡
[
k
 + 2] = 
bË
[(
b
 & 0x0f) << 2];

197 
	gd¡
[
k
 + 3] = '=';

202  
	gdËn
;

206 
size_t
 
hex_’code
(cÚ¡ * 
¤c
, size_ˆ
¦’
, * 
d¡
, size_ˆ
dËn
) {

208 
as£¹
(
dËn
 >ğ
¦’
 * 2 &&

211 
	gdËn
 = 
¦’
 * 2;

212 
ušt32_t
 
	gi
 = 0, 
	gk
 = 0; k < 
	gdËn
; i += 1, k += 2) {

213 cÚ¡ 
hex
[] = "0123456789abcdef";

214 
ušt8_t
 
	gv®
 = 
¡©ic_ÿ¡
<ušt8_t>(
¤c
[
i
]);

215 
	gd¡
[
k
 + 0] = 
hex
[
v®
 >> 4];

216 
	gd¡
[
k
 + 1] = 
hex
[
v®
 & 15];

219  
	gdËn
;

224 
	gLoÿl
<
	gV®ue
> 
Encode
(cÚ¡ * 
buf
,

225 
size_t
 
buæ’
,

226 
Encodšg
 
’codšg
) {

227 
as£¹
(
buæ’
 <ğ
node
::
Bufãr
::
kMaxL’gth
);

228 ià(!
	gbuæ’
 && 
	g’codšg
 !ğ
BUFFER
)

229  
New
("").
ToLoÿlChecked
();

231 
	gLoÿl
<
	gSŒšg
> 
	gv®
;

232 
	g’codšg
) {

233 
	gBUFFER
:

234  
CİyBufãr
(
buf
, 
buæ’
).
ToLoÿlChecked
();

236 
	gASCII
:

237 ià(
cÚšs_nÚ_ascii
(
buf
, 
buæ’
)) {

238 * 
	gout
 = 
Ãw
 [
buæ’
];

239 
fÜû_ascii
(
buf
, 
out
, 
buæ’
);

240 
	gv®
 = 
New
<
SŒšg
>(
out
, 
	gbuæ’
).
ToLoÿlChecked
();

241 
	gd–‘e
[] 
	gout
;

243 
	gv®
 = 
New
<
SŒšg
>(
buf
, 
	gbuæ’
).
ToLoÿlChecked
();

247 
	gUTF8
:

248 
v®
 = 
New
<
SŒšg
>(
buf
, 
	gbuæ’
).
ToLoÿlChecked
();

251 
	gBINARY
: {

253 cÚ¡ *
cbuf
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
);

254 
ušt16_t
 * 
	gtwoby‹buf
 = 
Ãw
 ušt16_t[
buæ’
];

255 
size_t
 
	gi
 = 0; i < 
	gbuæ’
; i++) {

257 
	gtwoby‹buf
[
i
] = 
cbuf
[i];

259 
	gv®
 = 
New
<
SŒšg
>(
twoby‹buf
, 
	gbuæ’
).
ToLoÿlChecked
();

260 
	gd–‘e
[] 
	gtwoby‹buf
;

264 
	gBASE64
: {

265 
size_t
 
dËn
 = 
ba£64_’coded_size
(
buæ’
);

266 * 
	gd¡
 = 
Ãw
 [
dËn
];

268 
size_t
 
	gwr™‹n
 = 
ba£64_’code
(
buf
, 
buæ’
, 
d¡
, 
dËn
);

269 
as£¹
(
wr™‹n
 =ğ
dËn
);

271 
	gv®
 = 
New
<
SŒšg
>(
d¡
, 
	gdËn
).
ToLoÿlChecked
();

272 
	gd–‘e
[] 
	gd¡
;

276 
	gUCS2
: {

277 cÚ¡ 
ušt16_t
* 
d©a
 = 
»š‹½»t_ÿ¡
<cÚ¡ ušt16_t*>(
buf
);

278 
	gv®
 = 
New
<
SŒšg
>(
d©a
, 
	gbuæ’
 / 2).
ToLoÿlChecked
();

282 
	gHEX
: {

283 
size_t
 
dËn
 = 
buæ’
 * 2;

284 * 
	gd¡
 = 
Ãw
 [
dËn
];

285 
size_t
 
	gwr™‹n
 = 
hex_’code
(
buf
, 
buæ’
, 
d¡
, 
dËn
);

286 
as£¹
(
wr™‹n
 =ğ
dËn
);

288 
	gv®
 = 
New
<
SŒšg
>(
d¡
, 
	gdËn
).
ToLoÿlChecked
();

289 
	gd–‘e
[] 
	gd¡
;

294 
as£¹
(0 && "unknownƒncoding");

298  
	gv®
;

301 #undeà
ba£64_’coded_size


	@utils/webnao/node_modules/nan/nan_typedarray_contents.h

9 #iâdeà
NAN_TYPEDARRAY_CONTENTS_H_


10 
	#NAN_TYPEDARRAY_CONTENTS_H_


	)

12 
	g‹m¶©e
<
ty³Çme
 
	gT
>

13 şas 
	cTy³dA¼ayCÚ‹Ás
 {

14 
	mpublic
:

15 
šlše
 
ex¶ic™
 
Ty³dA¼ayCÚ‹Ás
(
v8
::
Loÿl
<v8::
V®ue
> 
äom
) :

16 
Ëngth_
(0), 
	$d©a_
(
NULL
) {

17 
HªdËScİe
 
scİe
;

19 
size_t
 
Ëngth
 = 0;

20 * 
d©a
 = 
NULL
;

22 #ià
	`defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

23 (
V8_MAJOR_VERSION
 =ğ4 && 
	`defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

25 ià(
äom
->
	`IsA¼ayBufãrV›w
()) {

26 
v8
::
Loÿl
<v8::
A¼ayBufãrV›w
> 
¬¿y
 =

27 
v8
::
Loÿl
<v8::
A¼ayBufãrV›w
>::
	`Ca¡
(
äom
);

29 cÚ¡ 
size_t
 
by‹_Ëngth
 = 
¬¿y
->
	`By‹L’gth
();

30 cÚ¡ 
±rdiff_t
 
by‹_off£t
 = 
¬¿y
->
	`By‹Off£t
();

31 
v8
::
Loÿl
<v8::
A¼ayBufãr
> 
bufãr
 = 
¬¿y
->
	`Bufãr
();

33 
Ëngth
 = 
by‹_Ëngth
 / (
T
);

34 
d©a
 = 
¡©ic_ÿ¡
<*>(
bufãr
->
	`G‘CÚ‹Ás
().
	`D©a
()è+ 
by‹_off£t
;

39 ià(
äom
->
	`IsObjeù
(è&& !äom->
	`IsNuÎ
()) {

40 
v8
::
Loÿl
<v8::
Objeù
> 
¬¿y
 = v8::Loÿl<v8::Objeù>::
	`Ca¡
(
äom
);

42 
MaybeLoÿl
<
v8
::
V®ue
> 
bufãr
 = 
	`G‘
(
¬¿y
,

43 
New
<
v8
::
SŒšg
>("bufãr").
	`ToLoÿlChecked
());

44 
MaybeLoÿl
<
v8
::
V®ue
> 
by‹_Ëngth
 = 
	`G‘
(
¬¿y
,

45 
New
<
v8
::
SŒšg
>("by‹L’gth").
	`ToLoÿlChecked
());

46 
MaybeLoÿl
<
v8
::
V®ue
> 
by‹_off£t
 = 
	`G‘
(
¬¿y
,

47 
New
<
v8
::
SŒšg
>("by‹Off£t").
	`ToLoÿlChecked
());

49 ià(!
bufãr
.
	`IsEm±y
() &&

50 !
by‹_Ëngth
.
	`IsEm±y
(è&& by‹_Ëngth.
	`ToLoÿlChecked
()->
	`IsUšt32
() &&

51 !
by‹_off£t
.
	`IsEm±y
(è&& by‹_off£t.
	`ToLoÿlChecked
()->
	`IsUšt32
()) {

52 
d©a
 = 
¬¿y
->
	`G‘IndexedPrİ”t›sEx‹º®A¼ayD©a
();

53 if(
d©a
) {

54 
Ëngth
 = 
by‹_Ëngth
.
	`ToLoÿlChecked
()->
	`Ušt32V®ue
(è/ (
T
);

61 #ià
	`defšed
(
_MSC_VER
è&& _MSC_VER >ğ1900 || 
__ılu¥lus
 >= 201103L

62 
	`as£¹
(
»š‹½»t_ÿ¡
<
ušŒ_t
>(
d©a
è% 
	`®ignof
 (
T
) == 0);

63 #–ià
	`defšed
(
_MSC_VER
è&& _MSC_VER >ğ1600 || defšed(
__GNUC__
)

64 
	`as£¹
(
»š‹½»t_ÿ¡
<
ušŒ_t
>(
d©a
è% 
	`__®ignof
(
T
) == 0);

66 
	`as£¹
(
»š‹½»t_ÿ¡
<
ušŒ_t
>(
d©a
è%  (
T
) == 0);

69 
Ëngth_
 = 
Ëngth
;

70 
d©a_
 = 
¡©ic_ÿ¡
<
T
*>(
d©a
);

73 
šlše
 
size_t
 
	$Ëngth
(ècÚ¡ {  
Ëngth_
; 
	}
}

74 
šlše
 
T
* 
	gİ”©Ü
*(è{  
	gd©a_
; }

75 
šlše
 cÚ¡ 
T
* 
	gİ”©Ü
*(ècÚ¡ {  
	gd©a_
; }

77 
	g´iv©e
:

78 
	$NAN_DISALLOW_ASSIGN_COPY_MOVE
(
Ty³dA¼ayCÚ‹Ás
)

81 *
İ”©Ü
 
	`Ãw
(
size_t
 
size
);

82 
İ”©Ü
 
	$d–‘e
(*, 
size_t
) {

83 
	`abÜt
();

84 
	}
}

86 
size_t
 
	gËngth_
;

87 
T
* 
	gd©a_
;

	@utils/webnao/node_modules/nan/nan_weak.h

9 #iâdeà
NAN_WEAK_H_


10 
	#NAN_WEAK_H_


	)

12 cÚ¡ 
	gkIÁ”ÇlF›ldsInW—kC®lback
 = 2;

13 cÚ¡ 
	gkNoIÁ”ÇlF›ldIndex
 = -1;

15 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

16 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

17 
	#NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_
 \

18 
v8
::
W—kC®lbackInfo
<W—kC®lbackInfo<
T
> > cÚ¡&

	)

19 
	#NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_
 \

20 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_


	)

21 
	#NAN_WEAK_PARAMETER_CALLBACK_SIG_
 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_


	)

22 
	#NAN_WEAK_TWOFIELD_CALLBACK_SIG_
 
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_


	)

23 #–ià
NODE_MODULE_VERSION
 > 
IOJS_1_1_MODULE_VERSION


24 
	#NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_
 \

25 
v8
::
PhªtomC®lbackD©a
<
W—kC®lbackInfo
<
T
> > cÚ¡&

	)

26 
	#NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_
 \

27 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_


	)

28 
	#NAN_WEAK_PARAMETER_CALLBACK_SIG_
 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_


	)

29 
	#NAN_WEAK_TWOFIELD_CALLBACK_SIG_
 
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_


	)

30 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


31 
	#NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_
 \

32 
v8
::
PhªtomC®lbackD©a
<
W—kC®lbackInfo
<
T
> > cÚ¡&

	)

33 
	#NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_
 \

34 
v8
::
IÁ”ÇlF›ldsC®lbackD©a
<
W—kC®lbackInfo
<
T
>, > cÚ¡&

	)

35 
	#NAN_WEAK_PARAMETER_CALLBACK_SIG_
 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_


	)

36 
	#NAN_WEAK_TWOFIELD_CALLBACK_SIG_
 
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_


	)

37 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


38 
	#NAN_WEAK_CALLBACK_DATA_TYPE_
 \

39 
v8
::
W—kC®lbackD©a
<
S
, 
W—kC®lbackInfo
<
T
> > cÚ¡&

	)

40 
	#NAN_WEAK_CALLBACK_SIG_
 
NAN_WEAK_CALLBACK_DATA_TYPE_


	)

42 
	#NAN_WEAK_CALLBACK_DATA_TYPE_
 *

	)

43 
	#NAN_WEAK_CALLBACK_SIG_
 \

44 
v8
::
P”si¡’t
<v8::
V®ue
>, 
NAN_WEAK_CALLBACK_DATA_TYPE_


	)

47 
	g‹m¶©e
<
ty³Çme
 
	gT
>

48 şas 
	cW—kC®lbackInfo
 {

49 
	mpublic
:

50 (*
	tC®lback
)(cÚ¡ 
	tW—kC®lbackInfo
<
	tT
>& 
	td©a
);

51 
	`W—kC®lbackInfo
(

52 
P”si¡’t
<
v8
::
V®ue
> *
³rsi¡’t


53 , 
C®lback
 
ÿÎback


54 , *
·¿m‘”


55 , *
f›ld1
 = 0

56 , *
f›ld2
 = 0) :

57 
	`ÿÎback_
(
ÿÎback
), 
	`isŞ©e_
(0), 
	$·¿m‘”_
(
·¿m‘”
) {

58 
¡d
::
	`memıy
(&
³rsi¡’t_
, 
³rsi¡’t
,  (
v8
::
P”si¡’t
<v8::
V®ue
>));

59 
š‹º®_f›lds_
[0] = 
f›ld1
;

60 
š‹º®_f›lds_
[1] = 
f›ld2
;

62 
šlše
 
v8
::
IsŞ©e
 *
	$G‘IsŞ©e
(ècÚ¡ {  
isŞ©e_
; 
	}
}

63 
šlše
 
T
 *
	$G‘P¬am‘”
(ècÚ¡ {  
¡©ic_ÿ¡
<
T
*>(
·¿m‘”_
); 
	}
}

64 
šlše
 *
	$G‘IÁ”ÇlF›ld
(
šdex
) const {

65 
	`as£¹
((
šdex
 == 0 || index == 1) && "internal field index out of bounds");

66 ià(
šdex
 == 0) {

67  
š‹º®_f›lds_
[0];

69  
š‹º®_f›lds_
[1];

71 
	}
}

73 
	g´iv©e
:

74 
	$NAN_DISALLOW_ASSIGN_COPY_MOVE
(
W—kC®lbackInfo
)

75 
C®lback
 
ÿÎback_
;

76 
v8
::
IsŞ©e
 *
isŞ©e_
;

77 *
·¿m‘”_
;

78 *
š‹º®_f›lds_
[
kIÁ”ÇlF›ldsInW—kC®lback
];

79 
v8
::
P”si¡’t
<v8::
V®ue
> 
³rsi¡’t_
;

80 
‹m¶©e
<
ty³Çme
 
S
,y³Çm
M
> 
ä›nd
 
şass
 
P”si¡’t
;

81 
‹m¶©e
<
ty³Çme
 
S
> 
ä›nd
 
şass
 
P”si¡’tBa£
;

82 #ià
NODE_MODULE_VERSION
 <ğ
NODE_0_12_MODULE_VERSION


83 #ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


84 
‹m¶©e
<
ty³Çme
 
S
>

85 
	`švoke
(
NAN_WEAK_CALLBACK_SIG_
 
d©a
);

86 
‹m¶©e
<
ty³Çme
 
S
>

87 
W—kC®lbackInfo
 *
	`unw¿p
(
NAN_WEAK_CALLBACK_DATA_TYPE_
 
d©a
);

89 
	`švoke
(
NAN_WEAK_CALLBACK_SIG_
 
d©a
);

90 
W—kC®lbackInfo
 *
	`unw¿p
(
NAN_WEAK_CALLBACK_DATA_TYPE_
 
d©a
);

93 #ià
	`defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

94 (
V8_MAJOR_VERSION
 =ğ4 && 
	`defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

95 
‹m¶©e
<
boŞ
 
isFœ¡Pass
>

96 
	`švok•¬am‘”
(
NAN_WEAK_PARAMETER_CALLBACK_SIG_
 
d©a
);

97 
‹m¶©e
<
boŞ
 
isFœ¡Pass
>

98 
	`švok‘wof›ld
(
NAN_WEAK_TWOFIELD_CALLBACK_SIG_
 
d©a
);

100 
	`švok•¬am‘”
(
NAN_WEAK_PARAMETER_CALLBACK_SIG_
 
d©a
);

101 
	`švok‘wof›ld
(
NAN_WEAK_TWOFIELD_CALLBACK_SIG_
 
d©a
);

103 
W—kC®lbackInfo
 *
	`unw¿µ¬am‘”
(

104 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_
 
d©a
);

105 
W—kC®lbackInfo
 *
	`unw¿±wof›ld
(

106 
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_
 
d©a
);

108 
	}
};

111 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

112 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

114 
‹m¶©e
<
ty³Çme
 
T
>

115 
‹m¶©e
<
boŞ
 
isFœ¡Pass
>

117 
W—kC®lbackInfo
<
T
>::
	$švok•¬am‘”
(
NAN_WEAK_PARAMETER_CALLBACK_SIG_
 
d©a
) {

118 
W—kC®lbackInfo
<
T
> *
cbšfo
 = 
	`unw¿µ¬am‘”
(
d©a
);

119 ià(
isFœ¡Pass
) {

120 
cbšfo
->
³rsi¡’t_
.
	`Re£t
();

121 
d©a
.
	`S‘SecÚdPassC®lback
(
švok•¬am‘”
<
çl£
>);

123 
cbšfo
->
	`ÿÎback_
(*cbinfo);

124 
d–‘e
 
cbšfo
;

126 
	}
}

128 
	g‹m¶©e
<
ty³Çme
 
	gT
>

129 
	g‹m¶©e
<
boŞ
 
	gisFœ¡Pass
>

131 
	gW—kC®lbackInfo
<
	gT
>::
	$švok‘wof›ld
(
NAN_WEAK_TWOFIELD_CALLBACK_SIG_
 
d©a
) {

132 
W—kC®lbackInfo
<
T
> *
cbšfo
 = 
	`unw¿±wof›ld
(
d©a
);

133 ià(
isFœ¡Pass
) {

134 
cbšfo
->
³rsi¡’t_
.
	`Re£t
();

135 
d©a
.
	`S‘SecÚdPassC®lback
(
švok‘wof›ld
<
çl£
>);

137 
cbšfo
->
	`ÿÎback_
(*cbinfo);

138 
d–‘e
 
cbšfo
;

140 
	}
}

142 
	g‹m¶©e
<
ty³Çme
 
	gT
>

143 
	gW—kC®lbackInfo
<
	gT
> *W—kC®lbackInfo<T>::
	$unw¿µ¬am‘”
(

144 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_
 
d©a
) {

145 
W—kC®lbackInfo
<
T
> *
cbšfo
 =

146 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
T
>*>(
d©a
.
	`G‘P¬am‘”
());

147 
cbšfo
->
isŞ©e_
 = 
d©a
.
	`G‘IsŞ©e
();

148  
cbšfo
;

149 
	}
}

151 
	g‹m¶©e
<
ty³Çme
 
	gT
>

152 
	gW—kC®lbackInfo
<
	gT
> *W—kC®lbackInfo<T>::
	$unw¿±wof›ld
(

153 
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_
 
d©a
) {

154 
W—kC®lbackInfo
<
T
> *
cbšfo
 =

155 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
T
>*>(
d©a
.
	`G‘IÁ”ÇlF›ld
(0));

156 
cbšfo
->
isŞ©e_
 = 
d©a
.
	`G‘IsŞ©e
();

157  
cbšfo
;

158 
	}
}

160 #undeà
NAN_WEAK_PARAMETER_CALLBACK_SIG_


161 #undeà
NAN_WEAK_TWOFIELD_CALLBACK_SIG_


162 #undeà
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_


163 #undeà
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_


164 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


166 
	g‹m¶©e
<
ty³Çme
 
	gT
>

168 
	gW—kC®lbackInfo
<
	gT
>::
	$švok•¬am‘”
(
NAN_WEAK_PARAMETER_CALLBACK_SIG_
 
d©a
) {

169 
W—kC®lbackInfo
<
T
> *
cbšfo
 = 
	`unw¿µ¬am‘”
(
d©a
);

170 
cbšfo
->
³rsi¡’t_
.
	`Re£t
();

171 
cbšfo
->
	`ÿÎback_
(*cbinfo);

172 
d–‘e
 
cbšfo
;

173 
	}
}

175 
	g‹m¶©e
<
ty³Çme
 
	gT
>

177 
	gW—kC®lbackInfo
<
	gT
>::
	$švok‘wof›ld
(
NAN_WEAK_TWOFIELD_CALLBACK_SIG_
 
d©a
) {

178 
W—kC®lbackInfo
<
T
> *
cbšfo
 = 
	`unw¿±wof›ld
(
d©a
);

179 
cbšfo
->
³rsi¡’t_
.
	`Re£t
();

180 
cbšfo
->
	`ÿÎback_
(*cbinfo);

181 
d–‘e
 
cbšfo
;

182 
	}
}

184 
	g‹m¶©e
<
ty³Çme
 
	gT
>

185 
	gW—kC®lbackInfo
<
	gT
> *W—kC®lbackInfo<T>::
	$unw¿µ¬am‘”
(

186 
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_
 
d©a
) {

187 
W—kC®lbackInfo
<
T
> *
cbšfo
 =

188 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
T
>*>(
d©a
.
	`G‘P¬am‘”
());

189 
cbšfo
->
isŞ©e_
 = 
d©a
.
	`G‘IsŞ©e
();

190  
cbšfo
;

191 
	}
}

193 
	g‹m¶©e
<
ty³Çme
 
	gT
>

194 
	gW—kC®lbackInfo
<
	gT
> *W—kC®lbackInfo<T>::
	$unw¿±wof›ld
(

195 
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_
 
d©a
) {

196 
W—kC®lbackInfo
<
T
> *
cbšfo
 =

197 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
T
>*>(
d©a
.
	`G‘IÁ”ÇlF›ld1
());

198 
cbšfo
->
isŞ©e_
 = 
d©a
.
	`G‘IsŞ©e
();

199  
cbšfo
;

200 
	}
}

202 #undeà
NAN_WEAK_PARAMETER_CALLBACK_SIG_


203 #undeà
NAN_WEAK_TWOFIELD_CALLBACK_SIG_


204 #undeà
NAN_WEAK_PARAMETER_CALLBACK_DATA_TYPE_


205 #undeà
NAN_WEAK_TWOFIELD_CALLBACK_DATA_TYPE_


206 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


208 
	g‹m¶©e
<
ty³Çme
 
	gT
>

209 
	g‹m¶©e
<
ty³Çme
 
	gS
>

210 
	gW—kC®lbackInfo
<
	gT
>::
	$švoke
(
NAN_WEAK_CALLBACK_SIG_
 
d©a
) {

211 
W—kC®lbackInfo
<
T
> *
cbšfo
 = 
	`unw¿p
(
d©a
);

212 
cbšfo
->
³rsi¡’t_
.
	`Re£t
();

213 
cbšfo
->
	`ÿÎback_
(*cbinfo);

214 
d–‘e
 
cbšfo
;

215 
	}
}

217 
	g‹m¶©e
<
ty³Çme
 
	gT
>

218 
	g‹m¶©e
<
ty³Çme
 
	gS
>

219 
	gW—kC®lbackInfo
<
	gT
> *W—kC®lbackInfo<T>::
	$unw¿p
(

220 
NAN_WEAK_CALLBACK_DATA_TYPE_
 
d©a
) {

221 *
·¿m‘”
 = 
d©a
.
	`G‘P¬am‘”
();

222 
W—kC®lbackInfo
<
T
> *
cbšfo
 =

223 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
T
>*>(
·¿m‘”
);

224 
cbšfo
->
isŞ©e_
 = 
d©a
.
	`G‘IsŞ©e
();

225  
cbšfo
;

226 
	}
}

228 #undeà
NAN_WEAK_CALLBACK_SIG_


229 #undeà
NAN_WEAK_CALLBACK_DATA_TYPE_


232 
	g‹m¶©e
<
ty³Çme
 
	gT
>

233 
	gW—kC®lbackInfo
<
	gT
>::
	$švoke
(
NAN_WEAK_CALLBACK_SIG_
 
d©a
) {

234 
W—kC®lbackInfo
<
T
> *
cbšfo
 = 
	`unw¿p
(
d©a
);

235 
cbšfo
->
³rsi¡’t_
.
	`Di¥o£
();

236 
cbšfo
->
³rsi¡’t_
.
	`CË¬
();

237 
cbšfo
->
	`ÿÎback_
(*cbinfo);

238 
d–‘e
 
cbšfo
;

239 
	}
}

241 
	g‹m¶©e
<
ty³Çme
 
	gT
>

242 
	gW—kC®lbackInfo
<
	gT
> *W—kC®lbackInfo<T>::
	$unw¿p
(

243 
NAN_WEAK_CALLBACK_DATA_TYPE_
 
d©a
) {

244 
W—kC®lbackInfo
<
T
> *
cbšfo
 =

245 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
T
>*>(
d©a
);

246 
cbšfo
->
isŞ©e_
 = 
v8
::
IsŞ©e
::
	`G‘Cu¼’t
();

247  
cbšfo
;

248 
	}
}

250 #undeà
NAN_WEAK_CALLBACK_SIG_


251 #undeà
NAN_WEAK_CALLBACK_DATA_TYPE_


254 #ià
defšed
(
V8_MAJOR_VERSION
) && (V8_MAJOR_VERSION > 4 || \

255 (
	gV8_MAJOR_VERSION
 =ğ4 && 
defšed
(
V8_MINOR_VERSION
) && V8_MINOR_VERSION >= 3))

256 
‹m¶©e
<
ty³Çme
 
T
,y³Çm
	gM
>

257 
	g‹m¶©e
<
ty³Çme
 
	gP
>

258 
šlše
 
	gP”si¡’t
<
	gT
, 
	gM
>::
S‘W—k
(

259 
P
 *
·¿m‘”


260 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


261 , 
W—kC®lbackTy³
 
ty³
) {

262 
	gW—kC®lbackInfo
<
	gP
> *
	gwcbd
;

263 ià(
	gty³
 =ğ
W—kC®lbackTy³
::
kP¬am‘”
) {

264 
wcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

265 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

266 , 
	gÿÎback


267 , 
	g·¿m‘”
);

268 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘W—k
(

269 
wcbd


270 , 
W—kC®lbackInfo
<
P
>::
‹m¶©e
 
švok•¬am‘”
<
Œue
>

271 , 
ty³
);

273 
	gv8
::
Loÿl
<
T
>* 
£lf
 = 
»š‹½»t_ÿ¡
<
v8
::Loÿl<T>*>(
this
);

274 
as£¹
((*
£lf
)->
IsObjeù
());

275 
	gcouÁ
 = (*
£lf
)->
IÁ”ÇlF›ldCouÁ
();

276 *
	gš‹º®_f›lds
[
kIÁ”ÇlF›ldsInW—kC®lback
] = {0, 0};

277 
	gi
 = 0; i < 
	gcouÁ
 && i < 
	gkIÁ”ÇlF›ldsInW—kC®lback
; i++) {

278 
	gš‹º®_f›lds
[
i
] = (*
£lf
)->
G‘AligÃdPoš‹rFromIÁ”ÇlF›ld
(i);

280 
	gwcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

281 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

282 , 
	gÿÎback


284 , 
	gš‹º®_f›lds
[0]

285 , 
	gš‹º®_f›lds
[1]);

286 (*
	g£lf
)->
S‘AligÃdPoš‹rInIÁ”ÇlF›ld
(0, 
wcbd
);

287 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘W—k
(

288 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
P
>*>(0)

289 , 
W—kC®lbackInfo
<
P
>::
‹m¶©e
 
švok‘wof›ld
<
Œue
>

290 , 
ty³
);

293 #–ià
NODE_MODULE_VERSION
 > 
IOJS_1_1_MODULE_VERSION


294 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gM
>

295 
	g‹m¶©e
<
ty³Çme
 
	gP
>

296 
šlše
 
	gP”si¡’t
<
	gT
, 
	gM
>::
S‘W—k
(

297 
P
 *
·¿m‘”


298 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


299 , 
W—kC®lbackTy³
 
ty³
) {

300 
	gW—kC®lbackInfo
<
	gP
> *
	gwcbd
;

301 ià(
	gty³
 =ğ
W—kC®lbackTy³
::
kP¬am‘”
) {

302 
wcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

303 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

304 , 
	gÿÎback


305 , 
	g·¿m‘”
);

306 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘Phªtom
(

307 
wcbd


308 , 
W—kC®lbackInfo
<
P
>::
švok•¬am‘”
);

310 
	gv8
::
Loÿl
<
T
>* 
£lf
 = 
»š‹½»t_ÿ¡
<
v8
::Loÿl<T>*>(
this
);

311 
as£¹
((*
£lf
)->
IsObjeù
());

312 
	gcouÁ
 = (*
£lf
)->
IÁ”ÇlF›ldCouÁ
();

313 *
	gš‹º®_f›lds
[
kIÁ”ÇlF›ldsInW—kC®lback
] = {0, 0};

314 
	gi
 = 0; i < 
	gcouÁ
 && i < 
	gkIÁ”ÇlF›ldsInW—kC®lback
; i++) {

315 
	gš‹º®_f›lds
[
i
] = (*
£lf
)->
G‘AligÃdPoš‹rFromIÁ”ÇlF›ld
(i);

317 
	gwcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

318 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

319 , 
	gÿÎback


321 , 
	gš‹º®_f›lds
[0]

322 , 
	gš‹º®_f›lds
[1]);

323 (*
	g£lf
)->
S‘AligÃdPoš‹rInIÁ”ÇlF›ld
(0, 
wcbd
);

324 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘Phªtom
(

325 
¡©ic_ÿ¡
<
W—kC®lbackInfo
<
P
>*>(0)

326 , 
W—kC®lbackInfo
<
P
>::
švok‘wof›ld


328 , 
couÁ
 > 1 ? 1 : 
kNoIÁ”ÇlF›ldIndex
);

331 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_12_MODULE_VERSION


332 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gM
>

333 
	g‹m¶©e
<
ty³Çme
 
	gP
>

334 
šlše
 
	gP”si¡’t
<
	gT
, 
	gM
>::
S‘W—k
(

335 
P
 *
·¿m‘”


336 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


337 , 
W—kC®lbackTy³
 
ty³
) {

338 
	gW—kC®lbackInfo
<
	gP
> *
	gwcbd
;

339 ià(
	gty³
 =ğ
W—kC®lbackTy³
::
kP¬am‘”
) {

340 
wcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

341 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

342 , 
	gÿÎback


343 , 
	g·¿m‘”
);

344 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘Phªtom
(

345 
wcbd


346 , 
W—kC®lbackInfo
<
P
>::
švok•¬am‘”
);

348 
	gv8
::
Loÿl
<
T
>* 
£lf
 = 
»š‹½»t_ÿ¡
<
v8
::Loÿl<T>*>(
this
);

349 
as£¹
((*
£lf
)->
IsObjeù
());

350 
	gcouÁ
 = (*
£lf
)->
IÁ”ÇlF›ldCouÁ
();

351 *
	gš‹º®_f›lds
[
kIÁ”ÇlF›ldsInW—kC®lback
] = {0, 0};

352 
	gi
 = 0; i < 
	gcouÁ
 && i < 
	gkIÁ”ÇlF›ldsInW—kC®lback
; i++) {

353 
	gš‹º®_f›lds
[
i
] = (*
£lf
)->
G‘AligÃdPoš‹rFromIÁ”ÇlF›ld
(i);

355 
	gwcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

356 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

357 , 
	gÿÎback


359 , 
	gš‹º®_f›lds
[0]

360 , 
	gš‹º®_f›lds
[1]);

361 (*
	g£lf
)->
S‘AligÃdPoš‹rInIÁ”ÇlF›ld
(0, 
wcbd
);

362 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘Phªtom
(

363 
W—kC®lbackInfo
<
P
>::
švok‘wof›ld


365 , 
couÁ
 > 1 ? 1 : 
kNoIÁ”ÇlF›ldIndex
);

368 #–ià
NODE_MODULE_VERSION
 > 
NODE_0_10_MODULE_VERSION


369 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gM
>

370 
	g‹m¶©e
<
ty³Çme
 
	gP
>

371 
šlše
 
	gP”si¡’t
<
	gT
, 
	gM
>::
S‘W—k
(

372 
P
 *
·¿m‘”


373 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


374 , 
W—kC®lbackTy³
 
ty³
) {

375 
	gW—kC®lbackInfo
<
	gP
> *
	gwcbd
;

376 ià(
	gty³
 =ğ
W—kC®lbackTy³
::
kP¬am‘”
) {

377 
wcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

378 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

379 , 
	gÿÎback


380 , 
	g·¿m‘”
);

381 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘W—k
(
wcbd
, 
W—kC®lbackInfo
<
P
>::
švoke
);

383 
	gv8
::
Loÿl
<
T
>* 
£lf
 = 
»š‹½»t_ÿ¡
<
v8
::Loÿl<T>*>(
this
);

384 
as£¹
((*
£lf
)->
IsObjeù
());

385 
	gcouÁ
 = (*
£lf
)->
IÁ”ÇlF›ldCouÁ
();

386 *
	gš‹º®_f›lds
[
kIÁ”ÇlF›ldsInW—kC®lback
] = {0, 0};

387 
	gi
 = 0; i < 
	gcouÁ
 && i < 
	gkIÁ”ÇlF›ldsInW—kC®lback
; i++) {

388 
	gš‹º®_f›lds
[
i
] = (*
£lf
)->
G‘AligÃdPoš‹rFromIÁ”ÇlF›ld
(i);

390 
	gwcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

391 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

392 , 
	gÿÎback


394 , 
	gš‹º®_f›lds
[0]

395 , 
	gš‹º®_f›lds
[1]);

396 
	gv8
::
P”si¡’tBa£
<
T
>::
S‘W—k
(
wcbd
, 
W—kC®lbackInfo
<
P
>::
švoke
);

400 
	g‹m¶©e
<
ty³Çme
 
	gT
>

401 
	g‹m¶©e
<
ty³Çme
 
	gP
>

402 
šlše
 
	gP”si¡’tBa£
<
	gT
>::
S‘W—k
(

403 
P
 *
·¿m‘”


404 , 
ty³Çme
 
W—kC®lbackInfo
<
P
>::
C®lback
 
ÿÎback


405 , 
W—kC®lbackTy³
 
ty³
) {

406 
	gW—kC®lbackInfo
<
	gP
> *
	gwcbd
;

407 ià(
	gty³
 =ğ
W—kC®lbackTy³
::
kP¬am‘”
) {

408 
wcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

409 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

410 , 
	gÿÎback


411 , 
	g·¿m‘”
);

412 
	g³rsi¡’t
.
MakeW—k
(
wcbd
, 
W—kC®lbackInfo
<
P
>::
švoke
);

414 
	gv8
::
Loÿl
<
T
>* 
£lf
 = 
»š‹½»t_ÿ¡
<
v8
::Loÿl<T>*>(
this
);

415 
as£¹
((*
£lf
)->
IsObjeù
());

416 
	gcouÁ
 = (*
£lf
)->
IÁ”ÇlF›ldCouÁ
();

417 *
	gš‹º®_f›lds
[
kIÁ”ÇlF›ldsInW—kC®lback
] = {0, 0};

418 
	gi
 = 0; i < 
	gcouÁ
 && i < 
	gkIÁ”ÇlF›ldsInW—kC®lback
; i++) {

419 
	gš‹º®_f›lds
[
i
] = (*
£lf
)->
G‘Poš‹rFromIÁ”ÇlF›ld
(i);

421 
	gwcbd
 = 
Ãw
 
W—kC®lbackInfo
<
P
>(

422 
»š‹½»t_ÿ¡
<
P”si¡’t
<
v8
::
V®ue
>*>(
this
)

423 , 
	gÿÎback


425 , 
	gš‹º®_f›lds
[0]

426 , 
	gš‹º®_f›lds
[1]);

427 
	g³rsi¡’t
.
MakeW—k
(
wcbd
, 
W—kC®lbackInfo
<
P
>::
švoke
);

	@
1
.
0
592
23396
robot/Eigen/src/Array/BooleanRedux.h
robot/Eigen/src/Array/CwiseOperators.h
robot/Eigen/src/Array/Functors.h
robot/Eigen/src/Array/Norms.h
robot/Eigen/src/Array/PartialRedux.h
robot/Eigen/src/Array/Random.h
robot/Eigen/src/Array/Select.h
robot/Eigen/src/Cholesky/CholeskyInstantiations.cpp
robot/Eigen/src/Cholesky/LDLT.h
robot/Eigen/src/Cholesky/LLT.h
robot/Eigen/src/Core/Assign.h
robot/Eigen/src/Core/Block.h
robot/Eigen/src/Core/CacheFriendlyProduct.h
robot/Eigen/src/Core/Coeffs.h
robot/Eigen/src/Core/CommaInitializer.h
robot/Eigen/src/Core/CoreInstantiations.cpp
robot/Eigen/src/Core/Cwise.h
robot/Eigen/src/Core/CwiseBinaryOp.h
robot/Eigen/src/Core/CwiseNullaryOp.h
robot/Eigen/src/Core/CwiseUnaryOp.h
robot/Eigen/src/Core/DiagonalCoeffs.h
robot/Eigen/src/Core/DiagonalMatrix.h
robot/Eigen/src/Core/DiagonalProduct.h
robot/Eigen/src/Core/Dot.h
robot/Eigen/src/Core/Flagged.h
robot/Eigen/src/Core/Functors.h
robot/Eigen/src/Core/Fuzzy.h
robot/Eigen/src/Core/GenericPacketMath.h
robot/Eigen/src/Core/IO.h
robot/Eigen/src/Core/Map.h
robot/Eigen/src/Core/MapBase.h
robot/Eigen/src/Core/MathFunctions.h
robot/Eigen/src/Core/Matrix.h
robot/Eigen/src/Core/MatrixBase.h
robot/Eigen/src/Core/MatrixStorage.h
robot/Eigen/src/Core/Minor.h
robot/Eigen/src/Core/NestByValue.h
robot/Eigen/src/Core/NumTraits.h
robot/Eigen/src/Core/Part.h
robot/Eigen/src/Core/Product.h
robot/Eigen/src/Core/Redux.h
robot/Eigen/src/Core/SolveTriangular.h
robot/Eigen/src/Core/Sum.h
robot/Eigen/src/Core/Swap.h
robot/Eigen/src/Core/Transpose.h
robot/Eigen/src/Core/Visitor.h
robot/Eigen/src/Core/arch/AltiVec/PacketMath.h
robot/Eigen/src/Core/arch/SSE/PacketMath.h
robot/Eigen/src/Core/util/Constants.h
robot/Eigen/src/Core/util/DisableMSVCWarnings.h
robot/Eigen/src/Core/util/EnableMSVCWarnings.h
robot/Eigen/src/Core/util/ForwardDeclarations.h
robot/Eigen/src/Core/util/Macros.h
robot/Eigen/src/Core/util/Memory.h
robot/Eigen/src/Core/util/Meta.h
robot/Eigen/src/Core/util/StaticAssert.h
robot/Eigen/src/Core/util/XprHelper.h
robot/Eigen/src/Geometry/AlignedBox.h
robot/Eigen/src/Geometry/AngleAxis.h
robot/Eigen/src/Geometry/EulerAngles.h
robot/Eigen/src/Geometry/Hyperplane.h
robot/Eigen/src/Geometry/OrthoMethods.h
robot/Eigen/src/Geometry/ParametrizedLine.h
robot/Eigen/src/Geometry/Quaternion.h
robot/Eigen/src/Geometry/Rotation2D.h
robot/Eigen/src/Geometry/RotationBase.h
robot/Eigen/src/Geometry/Scaling.h
robot/Eigen/src/Geometry/Transform.h
robot/Eigen/src/Geometry/Translation.h
robot/Eigen/src/LU/Determinant.h
robot/Eigen/src/LU/Inverse.h
robot/Eigen/src/LU/LU.h
robot/Eigen/src/LeastSquares/LeastSquares.h
robot/Eigen/src/QR/EigenSolver.h
robot/Eigen/src/QR/HessenbergDecomposition.h
robot/Eigen/src/QR/QR.h
robot/Eigen/src/QR/QrInstantiations.cpp
robot/Eigen/src/QR/SelfAdjointEigenSolver.h
robot/Eigen/src/QR/Tridiagonalization.h
robot/Eigen/src/SVD/SVD.h
robot/Eigen/src/Sparse/AmbiVector.h
robot/Eigen/src/Sparse/CholmodSupport.h
robot/Eigen/src/Sparse/CompressedStorage.h
robot/Eigen/src/Sparse/CoreIterators.h
robot/Eigen/src/Sparse/DynamicSparseMatrix.h
robot/Eigen/src/Sparse/MappedSparseMatrix.h
robot/Eigen/src/Sparse/RandomSetter.h
robot/Eigen/src/Sparse/SparseAssign.h
robot/Eigen/src/Sparse/SparseBlock.h
robot/Eigen/src/Sparse/SparseCwise.h
robot/Eigen/src/Sparse/SparseCwiseBinaryOp.h
robot/Eigen/src/Sparse/SparseCwiseUnaryOp.h
robot/Eigen/src/Sparse/SparseDiagonalProduct.h
robot/Eigen/src/Sparse/SparseDot.h
robot/Eigen/src/Sparse/SparseFlagged.h
robot/Eigen/src/Sparse/SparseFuzzy.h
robot/Eigen/src/Sparse/SparseLDLT.h
robot/Eigen/src/Sparse/SparseLLT.h
robot/Eigen/src/Sparse/SparseLU.h
robot/Eigen/src/Sparse/SparseMatrix.h
robot/Eigen/src/Sparse/SparseMatrixBase.h
robot/Eigen/src/Sparse/SparseProduct.h
robot/Eigen/src/Sparse/SparseRedux.h
robot/Eigen/src/Sparse/SparseTranspose.h
robot/Eigen/src/Sparse/SparseUtil.h
robot/Eigen/src/Sparse/SparseVector.h
robot/Eigen/src/Sparse/SuperLUSupport.h
robot/Eigen/src/Sparse/TaucsSupport.h
robot/Eigen/src/Sparse/TriangularSolver.h
robot/Eigen/src/Sparse/UmfPackSupport.h
robot/FADBAD++/badiff.h
robot/FADBAD++/examples/ExampleBAD.cpp
robot/FADBAD++/examples/ExampleBADFAD1.cpp
robot/FADBAD++/examples/ExampleBADFAD2.cpp
robot/FADBAD++/examples/ExampleBADFAD3.cpp
robot/FADBAD++/examples/ExampleBADFAD4.cpp
robot/FADBAD++/examples/ExampleFAD.cpp
robot/FADBAD++/examples/ExampleTAD1.cpp
robot/FADBAD++/examples/ExampleTAD2.cpp
robot/FADBAD++/examples/ExampleTAD3.cpp
robot/FADBAD++/examples/MonteCarlo.cpp
robot/FADBAD++/extra/atan2ad.h
robot/FADBAD++/extra/ndf.h
robot/FADBAD++/extra/ndfad.h
robot/FADBAD++/fadbad.h
robot/FADBAD++/fadiff.h
robot/FADBAD++/tadiff.h
robot/FADBAD++/test/IReportLogger.h
robot/FADBAD++/test/STDReportLog.h
robot/FADBAD++/test/TestAll.cpp
robot/FADBAD++/test/TestFADBAD.cpp
robot/FADBAD++/test/TestFADBAD.h
robot/FADBAD++/test/TestTAD.cpp
robot/FADBAD++/test/TestTAD.h
robot/FADBAD++/test/TestUDT.cpp
robot/FADBAD++/test/TestUDT.h
robot/SimRobot.cpp
robot/SimRobot.hpp
robot/blackboard/Adapter.hpp
robot/blackboard/Blackboard.cpp
robot/blackboard/Blackboard.hpp
robot/blackboard/Blackboard.tcc
robot/gamecontroller/GameController.cpp
robot/gamecontroller/GameController.hpp
robot/gamecontroller/RoboCupGameControlData.cpp
robot/gamecontroller/RoboCupGameControlData.hpp
robot/gamecontroller/SPLCoachMessage.h
robot/libagent/AgentData.hpp
robot/libagent/libagent.cpp
robot/libagent/libagent.hpp
robot/main.cpp
robot/motion/IKinematics.cpp
robot/motion/IKinematics.hpp
robot/motion/MotionAdapter.cpp
robot/motion/MotionAdapter.hpp
robot/motion/MotionOdometry.cpp
robot/motion/MotionOdometry.hpp
robot/motion/SonarRecorder.cpp
robot/motion/SonarRecorder.hpp
robot/motion/effector/AgentEffector.cpp
robot/motion/effector/AgentEffector.hpp
robot/motion/effector/Effector.hpp
robot/motion/effector/NullEffector.hpp
robot/motion/effector/SimEffector.cpp
robot/motion/effector/SimEffector.hpp
robot/motion/generator/Action.hpp
robot/motion/generator/ActionGenerator.cpp
robot/motion/generator/ActionGenerator.hpp
robot/motion/generator/BodyModel.cpp
robot/motion/generator/BodyModel.hpp
robot/motion/generator/ClippedGenerator.cpp
robot/motion/generator/ClippedGenerator.hpp
robot/motion/generator/DeadGenerator.cpp
robot/motion/generator/DeadGenerator.hpp
robot/motion/generator/DistributedGenerator.cpp
robot/motion/generator/DistributedGenerator.hpp
robot/motion/generator/FallAvoidanceGenerator.cpp
robot/motion/generator/FallAvoidanceGenerator.hpp
robot/motion/generator/Generator.hpp
robot/motion/generator/GetupGenerator.cpp
robot/motion/generator/GetupGenerator.hpp
robot/motion/generator/HeadGenerator.cpp
robot/motion/generator/HeadGenerator.hpp
robot/motion/generator/NullGenerator.cpp
robot/motion/generator/NullGenerator.hpp
robot/motion/generator/PendulumModel.cpp
robot/motion/generator/PendulumModel.hpp
robot/motion/generator/Planner.hpp
robot/motion/generator/RLPlanner.cpp
robot/motion/generator/RLPlanner.hpp
robot/motion/generator/RefPickupGenerator.cpp
robot/motion/generator/RefPickupGenerator.hpp
robot/motion/generator/StandGenerator.cpp
robot/motion/generator/StandGenerator.hpp
robot/motion/generator/Walk2014Generator.cpp
robot/motion/generator/Walk2014Generator.hpp
robot/motion/generator/WalkCycle.cpp
robot/motion/generator/WalkCycle.hpp
robot/motion/generator/WalkEnginePreProcessor.cpp
robot/motion/generator/WalkEnginePreProcessor.hpp
robot/motion/touch/AgentTouch.cpp
robot/motion/touch/AgentTouch.hpp
robot/motion/touch/FeetState.cpp
robot/motion/touch/FeetState.hpp
robot/motion/touch/FilteredTouch.cpp
robot/motion/touch/FilteredTouch.hpp
robot/motion/touch/NullTouch.cpp
robot/motion/touch/NullTouch.hpp
robot/motion/touch/SensorOutput.cpp
robot/motion/touch/SensorOutput.hpp
robot/motion/touch/SimTouch.cpp
robot/motion/touch/SimTouch.hpp
robot/motion/touch/TorsoStateFilter.cpp
robot/motion/touch/TorsoStateFilter.hpp
robot/motion/touch/Touch.hpp
robot/perception/PerceptionThread.cpp
robot/perception/PerceptionThread.hpp
robot/perception/audio/whistle/pyalsaaudio-0.7/alsaaudio.c
robot/perception/behaviour/BehaviourAdapter.cpp
robot/perception/behaviour/BehaviourAdapter.hpp
robot/perception/behaviour/BehaviourHelpers.cpp
robot/perception/behaviour/BehaviourHelpers.hpp
robot/perception/behaviour/KinematicsCalibrationSkill.cpp
robot/perception/behaviour/KinematicsCalibrationSkill.hpp
robot/perception/behaviour/ReadySkillPositionAllocation.cpp
robot/perception/behaviour/ReadySkillPositionAllocation.hpp
robot/perception/behaviour/SafetySkill.cpp
robot/perception/behaviour/SafetySkill.hpp
robot/perception/behaviour/python/PythonSkill.cpp
robot/perception/behaviour/python/PythonSkill.hpp
robot/perception/behaviour/python/RegisterConverters.cpp
robot/perception/behaviour/python/RegisterConverters.hpp
robot/perception/behaviour/python/RobotModule.cpp
robot/perception/behaviour/python/converters/EigenM33f_conv.hpp
robot/perception/behaviour/python/converters/Point_conv.hpp
robot/perception/behaviour/python/converters/Vector_conv.hpp
robot/perception/behaviour/python/converters/array_conv.hpp
robot/perception/behaviour/python/converters/array_conv.tcc
robot/perception/behaviour/python/wrappers/AbsCoord_wrap.cpp
robot/perception/behaviour/python/wrappers/ActionCommand_wrap.cpp
robot/perception/behaviour/python/wrappers/BBox_wrap.cpp
robot/perception/behaviour/python/wrappers/BallInfo_wrap.cpp
robot/perception/behaviour/python/wrappers/BehaviourBlackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/BehaviourRequest_wrap.cpp
robot/perception/behaviour/python/wrappers/BehaviourSharedData_wrap.cpp
robot/perception/behaviour/python/wrappers/Blackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/BroadcastData_wrap.cpp
robot/perception/behaviour/python/wrappers/FootInfo_wrap.cpp
robot/perception/behaviour/python/wrappers/GameControllerBlackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/GameController_wrap.cpp
robot/perception/behaviour/python/wrappers/JointValues_wrap.cpp
robot/perception/behaviour/python/wrappers/KinematicsBlackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/LocalisationBlackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/MotionBlackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/PostInfo_wrap.cpp
robot/perception/behaviour/python/wrappers/RRCoord_wrap.cpp
robot/perception/behaviour/python/wrappers/ReadySkillPositionAllocation_wrap.cpp
robot/perception/behaviour/python/wrappers/ReceiverBlackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/RobotInfo_wrap.cpp
robot/perception/behaviour/python/wrappers/RobotObstacle_wrap.cpp
robot/perception/behaviour/python/wrappers/SPLDefs_wrap.cpp
robot/perception/behaviour/python/wrappers/SPLStandardMessage_wrap.cpp
robot/perception/behaviour/python/wrappers/SensorValues_wrap.cpp
robot/perception/behaviour/python/wrappers/TeamBallInfo_wrap.cpp
robot/perception/behaviour/python/wrappers/VisionBlackboard_wrap.cpp
robot/perception/behaviour/python/wrappers/VisionDefs_wrap.cpp
robot/perception/behaviour/python/wrappers/XYZ_Coord_wrap.cpp
robot/perception/behaviour/python/wrappers/body_wrap.cpp
robot/perception/behaviour/python/wrappers/say_wrap.cpp
robot/perception/behaviour/python/wrappers/vector_wrap.cpp
robot/perception/dumper/PerceptionDumper.cpp
robot/perception/dumper/PerceptionDumper.hpp
robot/perception/kinematics/CKF.cpp
robot/perception/kinematics/CKF.hpp
robot/perception/kinematics/Kinematics.cpp
robot/perception/kinematics/Kinematics.hpp
robot/perception/kinematics/KinematicsAdapter.cpp
robot/perception/kinematics/KinematicsAdapter.hpp
robot/perception/kinematics/Parameters.cpp
robot/perception/kinematics/Parameters.hpp
robot/perception/kinematics/Pose.cpp
robot/perception/kinematics/Pose.hpp
robot/perception/kinematics/Pose.tcc
robot/perception/kinematics/SonarFilter.cpp
robot/perception/kinematics/SonarFilter.hpp
robot/perception/localisation/GaussianUpdateDebugData.hpp
robot/perception/localisation/ICP.cpp
robot/perception/localisation/ICP.hpp
robot/perception/localisation/LocalisationAdapter.cpp
robot/perception/localisation/LocalisationAdapter.hpp
robot/perception/localisation/LocalisationConstantsProvider.cpp
robot/perception/localisation/LocalisationConstantsProvider.hpp
robot/perception/localisation/LocalisationDefs.hpp
robot/perception/localisation/LocalisationUtils.cpp
robot/perception/localisation/LocalisationUtils.hpp
robot/perception/localisation/Localiser.cpp
robot/perception/localisation/Localiser.hpp
robot/perception/localisation/MultiGaussianDistribution.cpp
robot/perception/localisation/MultiGaussianDistribution.hpp
robot/perception/localisation/ObservedPostsHistory.cpp
robot/perception/localisation/ObservedPostsHistory.hpp
robot/perception/localisation/PostType.hpp
robot/perception/localisation/SharedDistribution.cpp
robot/perception/localisation/SharedDistribution.hpp
robot/perception/localisation/SharedLocalisationUpdateBundle.hpp
robot/perception/localisation/SimpleGaussian.cpp
robot/perception/localisation/SimpleGaussian.hpp
robot/perception/localisation/TeamBallTracker.cpp
robot/perception/localisation/TeamBallTracker.hpp
robot/perception/localisation/VarianceProvider.cpp
robot/perception/localisation/VarianceProvider.hpp
robot/perception/localisation/VisionUpdateBundle.hpp
robot/perception/localisation/robotfilter/RobotFilter.cpp
robot/perception/localisation/robotfilter/RobotFilter.hpp
robot/perception/localisation/robotfilter/types/GroupedRobots.cpp
robot/perception/localisation/robotfilter/types/GroupedRobots.hpp
robot/perception/localisation/robotfilter/types/RobotFilterUpdate.hpp
robot/perception/localisation/robotfilter/types/RobotObservation.cpp
robot/perception/localisation/robotfilter/types/RobotObservation.hpp
robot/perception/vision/Fovea.cpp
robot/perception/vision/Fovea.hpp
robot/perception/vision/Region.cpp
robot/perception/vision/Region.hpp
robot/perception/vision/Vision.cpp
robot/perception/vision/Vision.hpp
robot/perception/vision/VisionAdapter.cpp
robot/perception/vision/VisionAdapter.hpp
robot/perception/vision/VisionDefinitions.hpp
robot/perception/vision/camera/Camera.cpp
robot/perception/vision/camera/Camera.hpp
robot/perception/vision/camera/CameraDefinitions.hpp
robot/perception/vision/camera/CameraToRR.cpp
robot/perception/vision/camera/CameraToRR.hpp
robot/perception/vision/camera/CombinedCamera.cpp
robot/perception/vision/camera/CombinedCamera.hpp
robot/perception/vision/camera/NaoCamera.cpp
robot/perception/vision/camera/NaoCamera.hpp
robot/perception/vision/camera/NaoCameraDefinitions.cpp
robot/perception/vision/camera/NaoCameraDefinitions.hpp
robot/perception/vision/camera/NaoCameraV4.cpp
robot/perception/vision/camera/NaoCameraV4.hpp
robot/perception/vision/colour/ColourClassifierInterface.hpp
robot/perception/vision/colour/DynamicColourClassifier.cpp
robot/perception/vision/colour/DynamicColourClassifier.hpp
robot/perception/vision/detector/BallDetector2016.cpp
robot/perception/vision/detector/BallDetector2016.hpp
robot/perception/vision/detector/DetectorInterface.hpp
robot/perception/vision/fullfinder/FieldBoundaryFinder.cpp
robot/perception/vision/fullfinder/FieldBoundaryFinder.hpp
robot/perception/vision/fullfinder/FieldFeatureFinder.cpp
robot/perception/vision/fullfinder/FieldFeatureFinder.hpp
robot/perception/vision/fullfinder/FullFinderInterface.hpp
robot/perception/vision/other/ImageRegion.hpp
robot/perception/vision/other/RobotRegion.hpp
robot/perception/vision/other/VarianceCalculator.cpp
robot/perception/vision/other/VarianceCalculator.hpp
robot/perception/vision/other/YUV.cpp
robot/perception/vision/other/YUV.hpp
robot/perception/vision/regionfinder/RegionFinderInterface.hpp
robot/receiver/Nao.cpp
robot/receiver/Nao.hpp
robot/receiver/Nao.tcc
robot/receiver/RemoteControl.cpp
robot/receiver/RemoteControl.hpp
robot/receiver/Team.cpp
robot/receiver/Team.hpp
robot/soccer.cpp
robot/soccer.hpp
robot/tests/TestBresenhamPtr.cpp
robot/tests/TestFovea.cpp
robot/tests/TestHistogram.cpp
robot/tests/TestIKinematics.cpp
robot/tests/TestProjections.cpp
robot/tests/TestRANSACTypes.cpp
robot/tests/TestRansac.cpp
robot/tests/perception/localisation/robotfilter/TestRobotFilter.cpp
robot/tests/perception/localisation/robotfilter/types/TestGroupedRobots.cpp
robot/tests/perception/localisation/robotfilter/types/TestRobotObservation.cpp
robot/thread/Thread.cpp
robot/thread/Thread.hpp
robot/thread/ThreadManager.cpp
robot/thread/ThreadManager.hpp
robot/thread/ThreadManager.tcc
robot/transmitter/Nao.cpp
robot/transmitter/Nao.hpp
robot/transmitter/NaturalLandmarks.cpp
robot/transmitter/NaturalLandmarks.hpp
robot/transmitter/OffNao.cpp
robot/transmitter/OffNao.hpp
robot/transmitter/Team.cpp
robot/transmitter/Team.hpp
robot/transmitter/TransmitterDefs.hpp
robot/types/AbsCoord.hpp
robot/types/ActionCommand.hpp
robot/types/BBox.hpp
robot/types/BallInfo.cpp
robot/types/BallInfo.hpp
robot/types/BehaviourRequest.hpp
robot/types/BehaviourSharedData.hpp
robot/types/BroadcastData.hpp
robot/types/ButtonPresses.hpp
robot/types/CameraSettings.hpp
robot/types/Cluster.hpp
robot/types/CombinedCameraSettings.hpp
robot/types/CombinedFovea.hpp
robot/types/CombinedFrame.hpp
robot/types/FieldBoundaryInfo.hpp
robot/types/FieldFeatureInfo.cpp
robot/types/FieldFeatureInfo.hpp
robot/types/FootInfo.hpp
robot/types/FrameInfo.hpp
robot/types/Ipoint.hpp
robot/types/JointValues.hpp
robot/types/Line.hpp
robot/types/Line.tcc
robot/types/MapEntry.hpp
robot/types/Odometry.hpp
robot/types/Point.hpp
robot/types/PostInfo.cpp
robot/types/PostInfo.hpp
robot/types/RRCoord.hpp
robot/types/RRCoord.tcc
robot/types/RansacTypes.hpp
robot/types/RobotInfo.cpp
robot/types/RobotInfo.hpp
robot/types/RobotObstacle.hpp
robot/types/SPLStandardMessage.hpp
robot/types/SensorValues.hpp
robot/types/TeamBallInfo.cpp
robot/types/TeamBallInfo.hpp
robot/types/VisionBlackboardInfo.hpp
robot/types/XYZ_Coord.hpp
robot/types/boostSerializationEigenTypes.hpp
robot/utils/BresenhamPtr.hpp
robot/utils/Cluster.cpp
robot/utils/Cluster.hpp
robot/utils/ConcurrentMap.hpp
robot/utils/ConcurrentMap.tcc
robot/utils/Connection.cpp
robot/utils/Connection.hpp
robot/utils/Connection.tcc
robot/utils/Garbage.hpp
robot/utils/Histogram.hpp
robot/utils/Histogram.tcc
robot/utils/LeastSquaresLine.cpp
robot/utils/LeastSquaresLine.hpp
robot/utils/LeastSquaresLineInline.hpp
robot/utils/Logger.cpp
robot/utils/Logger.hpp
robot/utils/NaoVersion.cpp
robot/utils/NaoVersion.hpp
robot/utils/ParameterOptimiser/Common.h
robot/utils/ParameterOptimiser/NelderMead.cpp
robot/utils/ParameterOptimiser/NelderMead.h
robot/utils/ParameterOptimiser/Optimiser.h
robot/utils/ParameterOptimiser/ParticleSwarm.cpp
robot/utils/ParameterOptimiser/ParticleSwarm.h
robot/utils/SPLDefs.hpp
robot/utils/Timer.hpp
robot/utils/angles.hpp
robot/utils/basic_maths.hpp
robot/utils/basic_onullstream.hpp
robot/utils/body.hpp
robot/utils/boostSerializationVariablesMap.hpp
robot/utils/bzip_compress.cpp
robot/utils/bzip_compress.hpp
robot/utils/clip.hpp
robot/utils/compress.cpp
robot/utils/compress.hpp
robot/utils/i2c-dev.h
robot/utils/incapacitated.hpp
robot/utils/matrix_helpers.hpp
robot/utils/matrix_helpers.tcc
robot/utils/options.cpp
robot/utils/options.hpp
robot/utils/snappy/snappy-c.cc
robot/utils/snappy/snappy-c.h
robot/utils/snappy/snappy-internal.h
robot/utils/snappy/snappy-sinksource.cc
robot/utils/snappy/snappy-sinksource.h
robot/utils/snappy/snappy-stubs-internal.cc
robot/utils/snappy/snappy-stubs-internal.h
robot/utils/snappy/snappy-stubs-public.h
robot/utils/snappy/snappy.cc
robot/utils/snappy/snappy.h
robot/utils/speech.hpp
utils/cameraCalibrator/main.c
utils/offnao/externaldata/ExternalData.hpp
utils/offnao/fields.hpp
utils/offnao/frame.hpp
utils/offnao/frame.tcc
utils/offnao/main.cpp
utils/offnao/mediaPanel.cpp
utils/offnao/mediaPanel.hpp
utils/offnao/naoData.hpp
utils/offnao/naoData.tcc
utils/offnao/progopts.hpp
utils/offnao/qt_serialisation/boostSerializationQPoint.hpp
utils/offnao/readers/bbdReader.cpp
utils/offnao/readers/bbdReader.hpp
utils/offnao/readers/dumpReader.cpp
utils/offnao/readers/dumpReader.hpp
utils/offnao/readers/networkReader.cpp
utils/offnao/readers/networkReader.hpp
utils/offnao/readers/reader.cpp
utils/offnao/readers/reader.hpp
utils/offnao/readers/recordReader.cpp
utils/offnao/readers/recordReader.hpp
utils/offnao/tabs/LogTab.cpp
utils/offnao/tabs/LogTab.hpp
utils/offnao/tabs/LogsTab.cpp
utils/offnao/tabs/LogsTab.hpp
utils/offnao/tabs/PointCloud.cpp
utils/offnao/tabs/PointCloud.hpp
utils/offnao/tabs/cameraPoseTab.cpp
utils/offnao/tabs/cameraPoseTab.hpp
utils/offnao/tabs/cameraTab.cpp
utils/offnao/tabs/cameraTab.hpp
utils/offnao/tabs/classifier.cpp
utils/offnao/tabs/classifier.hpp
utils/offnao/tabs/controlTab.cpp
utils/offnao/tabs/controlTab.hpp
utils/offnao/tabs/fieldView.cpp
utils/offnao/tabs/fieldView.hpp
utils/offnao/tabs/graphTab.cpp
utils/offnao/tabs/graphTab.hpp
utils/offnao/tabs/icpFieldView.cpp
utils/offnao/tabs/icpFieldView.hpp
utils/offnao/tabs/icpTab.cpp
utils/offnao/tabs/icpTab.hpp
utils/offnao/tabs/localisationTab.cpp
utils/offnao/tabs/localisationTab.hpp
utils/offnao/tabs/overviewTab.cpp
utils/offnao/tabs/overviewTab.hpp
utils/offnao/tabs/plots.cpp
utils/offnao/tabs/plots.hpp
utils/offnao/tabs/sensorTab.cpp
utils/offnao/tabs/sensorTab.hpp
utils/offnao/tabs/surfTab.cpp
utils/offnao/tabs/surfTab.hpp
utils/offnao/tabs/tab.cpp
utils/offnao/tabs/tab.hpp
utils/offnao/tabs/teamBallTab.cpp
utils/offnao/tabs/teamBallTab.hpp
utils/offnao/tabs/teamTab.cpp
utils/offnao/tabs/teamTab.hpp
utils/offnao/tabs/variableView.cpp
utils/offnao/tabs/variableView.hpp
utils/offnao/tabs/visionTab.cpp
utils/offnao/tabs/visionTab.hpp
utils/offnao/tabs/walkTab.cpp
utils/offnao/tabs/walkTab.hpp
utils/offnao/tabs/yuvHistogram.cpp
utils/offnao/tabs/yuvHistogram.hpp
utils/offnao/tabs/zmpTab.cpp
utils/offnao/tabs/zmpTab.hpp
utils/offnao/utils/CPlaneColours.cpp
utils/offnao/utils/CPlaneColours.hpp
utils/offnao/utils/FieldObject.hpp
utils/offnao/utils/FieldPainter.cpp
utils/offnao/utils/FieldPainter.hpp
utils/offnao/utils/OverlayPainter.cpp
utils/offnao/utils/OverlayPainter.hpp
utils/offnao/visualiser.cpp
utils/offnao/visualiser.hpp
utils/offnao/visualiser.tcc
utils/webnao/node_modules/fsevents/fsevents.cc
utils/webnao/node_modules/fsevents/src/async.cc
utils/webnao/node_modules/fsevents/src/constants.cc
utils/webnao/node_modules/fsevents/src/locking.cc
utils/webnao/node_modules/fsevents/src/methods.cc
utils/webnao/node_modules/fsevents/src/storage.cc
utils/webnao/node_modules/fsevents/src/thread.cc
utils/webnao/node_modules/nan/nan.h
utils/webnao/node_modules/nan/nan_callbacks.h
utils/webnao/node_modules/nan/nan_callbacks_12_inl.h
utils/webnao/node_modules/nan/nan_callbacks_pre_12_inl.h
utils/webnao/node_modules/nan/nan_converters.h
utils/webnao/node_modules/nan/nan_converters_43_inl.h
utils/webnao/node_modules/nan/nan_converters_pre_43_inl.h
utils/webnao/node_modules/nan/nan_implementation_12_inl.h
utils/webnao/node_modules/nan/nan_implementation_pre_12_inl.h
utils/webnao/node_modules/nan/nan_maybe_43_inl.h
utils/webnao/node_modules/nan/nan_maybe_pre_43_inl.h
utils/webnao/node_modules/nan/nan_new.h
utils/webnao/node_modules/nan/nan_object_wrap.h
utils/webnao/node_modules/nan/nan_persistent_12_inl.h
utils/webnao/node_modules/nan/nan_persistent_pre_12_inl.h
utils/webnao/node_modules/nan/nan_private.h
utils/webnao/node_modules/nan/nan_string_bytes.h
utils/webnao/node_modules/nan/nan_typedarray_contents.h
utils/webnao/node_modules/nan/nan_weak.h
